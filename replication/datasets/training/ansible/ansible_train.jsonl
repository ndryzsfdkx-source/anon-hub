{"smell": "hard_coded_secret", "file": "Bhanuprakash-ch_platform-ansible-defaults-hgm.yml", "content": "hgm_zookeeper_pass: hgm_masterpw", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: Bhanuprakash-ch_platform-ansible-defaults-hgm.yml\n\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\nhgm_zookeeper_user: hgm_user\n17: hgm_zookeeper_pass: hgm_masterpw\nhgm_basic_user: hgm_basic_user\nhgm_basic_pass: hgm_basic_pass", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Bhanuprakash-ch_platform-ansible-defaults-hgm.yml\n# Target line: 17\n\n     12: # See the License for the specific language governing permissions and\n     13: # limitations under the License.\n     14: #\n     15: \n     16: hgm_zookeeper_user: hgm_user\n>>>  17: hgm_zookeeper_pass: hgm_masterpw\n     18: hgm_basic_user: hgm_basic_user\n     19: hgm_basic_pass: hgm_basic_pass\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml", "content": "become_user: sysadmin", "line": 176, "detection_span": [171, 181], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n\n--values /tmp/armada-overrides.yaml\n--wait\n--debug\nwhen: mode == \"upgrade_k8s_armada_helm\"\n175:\n176:   become_user: sysadmin\n177:   environment:\nKUBECONFIG: /etc/kubernetes/admin.conf\nHOME: /home/sysadmin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n# Target line: 176\n\n    171:       --values /tmp/armada-overrides.yaml\n    172:       --wait\n    173:       --debug\n    174:     when: mode == \"upgrade_k8s_armada_helm\"\n    175: \n>>> 176:   become_user: sysadmin\n    177:   environment:\n    178:     KUBECONFIG: /etc/kubernetes/admin.conf\n    179:     HOME: /home/sysadmin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CentOS-PaaS-SIG_linchpin-docs-source-examples-workspace-PinFile.libvirt.yml", "content": "ssh_key: libvirt", "line": 29, "detection_span": [24, 34], "with_context": "# Ansible file: CentOS-PaaS-SIG_linchpin-docs-source-examples-workspace-PinFile.libvirt.yml\n\nmemory: 1024\nvcpus: 1\narch: x86_64\nnetworks:\n- name: default\n29:             ssh_key: libvirt\nadditional_storage: 10G\ncloud_config:\nvirt_type: virt-customize\nroot_password: \"testrootpwd\" # insecure plaintext password\nusers:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: CentOS-PaaS-SIG_linchpin-docs-source-examples-workspace-PinFile.libvirt.yml\n# Target line: 29\n\n     24:             memory: 1024\n     25:             vcpus: 1\n     26:             arch: x86_64\n     27:             networks:\n     28:               - name: default\n>>>  29:             ssh_key: libvirt\n     30:             additional_storage: 10G\n     31:             cloud_config:\n     32:               virt_type: virt-customize\n     33:               root_password: \"testrootpwd\" # insecure plaintext password\n     34:               users:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "imusyed_Ansible-language_features-ansible_pull.yml", "content": "cron_user: root", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: imusyed_Ansible-language_features-ansible_pull.yml\n\n\n# schedule is fed directly to cron\nschedule: '*/15 * * * *'\n\n# User to run ansible-pull as from cron\n27:     cron_user: root\n\n# File that ansible will use for logs\nlogfile: /var/log/ansible-pull.log\n\n# Directory to where repository will be cloned", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: imusyed_Ansible-language_features-ansible_pull.yml\n# Target line: 27\n\n     22: \n     23:     # schedule is fed directly to cron\n     24:     schedule: '*/15 * * * *'\n     25: \n     26:     # User to run ansible-pull as from cron\n>>>  27:     cron_user: root\n     28: \n     29:     # File that ansible will use for logs\n     30:     logfile: /var/log/ansible-pull.log\n     31: \n     32:     # Directory to where repository will be cloned\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "folio-org_folio-ansible-roles-post-config-entries-tasks-main.yml", "content": "Authtoken-Refresh-Cache: \"true\"", "line": 66, "detection_span": [61, 71], "with_context": "# Ansible file: folio-org_folio-ansible-roles-post-config-entries-tasks-main.yml\n\nuri:\nurl: \"{{ okapi_url }}/configurations/entries\"\nmethod: POST\nbody_format: json\nheaders:\n66:           Authtoken-Refresh-Cache: \"true\"\nX-Okapi-Tenant: \"{{ tenant }}\"\nAccept: application/json\nX-Okapi-Token: \"{{ tenant_token | default('') }}\"\nbody: \"{{ lookup('template', 'suppress_edit.json.j2') }}\"\nstatus_code: 201, 422", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: folio-org_folio-ansible-roles-post-config-entries-tasks-main.yml\n# Target line: 66\n\n     61:       uri: \n     62:         url: \"{{ okapi_url }}/configurations/entries\"\n     63:         method: POST\n     64:         body_format: json\n     65:         headers: \n>>>  66:           Authtoken-Refresh-Cache: \"true\"\n     67:           X-Okapi-Tenant: \"{{ tenant }}\"\n     68:           Accept: application/json\n     69:           X-Okapi-Token: \"{{ tenant_token | default('') }}\"\n     70:         body: \"{{ lookup('template', 'suppress_edit.json.j2') }}\"\n     71:         status_code: 201, 422\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "geerlingguy_ansible-role-apache-molecule-default-converge.yml", "content": "documentroot: \"/var/www/vhosts/example_com\"", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: geerlingguy_ansible-role-apache-molecule-default-converge.yml\n\napache_listen_port_ssl: 443\napache_create_vhosts: true\napache_vhosts_filename: \"vhosts.conf\"\napache_vhosts:\n- servername: \"example.com\"\n12:         documentroot: \"/var/www/vhosts/example_com\"\n\npre_tasks:\n- name: Update apt cache.\napt: update_cache=yes cache_valid_time=600\nwhen: ansible_os_family == 'Debian'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_ansible-role-apache-molecule-default-converge.yml\n# Target line: 12\n\n      7:     apache_listen_port_ssl: 443\n      8:     apache_create_vhosts: true\n      9:     apache_vhosts_filename: \"vhosts.conf\"\n     10:     apache_vhosts:\n     11:       - servername: \"example.com\"\n>>>  12:         documentroot: \"/var/www/vhosts/example_com\"\n     13: \n     14:   pre_tasks:\n     15:     - name: Update apt cache.\n     16:       apt: update_cache=yes cache_valid_time=600\n     17:       when: ansible_os_family == 'Debian'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml", "content": "cert: this-file-does-not-exist-and-must-be-overridden", "line": 1, "detection_span": [1, 6], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n\n1: cert: this-file-does-not-exist-and-must-be-overridden\nkey: this-file-does-not-exist-and-must-be-overridden", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n# Target line: 1\n\n>>>   1: cert: this-file-does-not-exist-and-must-be-overridden\n      2: key: this-file-does-not-exist-and-must-be-overridden\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-main.yml", "content": "login_user: root", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-main.yml\n\n- name: Ensure  that the db is present\nmysql_db:\nname: fgapiserver\n#login_host: \"{{ db_config.ansible_facts.ansible_docker_container.NetworkSettings.IPAddress }}\"\nlogin_host: \"{{ hostvars['db']['ansible_default_ipv4']['address'] }}\"\n34:         login_user: root\nlogin_password: \"{{ db_root_password }}\"\nstate: import\ntarget: \"{{ lookup('env','PWD')}}/roles/fgapi-db/files/fgapiserver_db.sql\"\nretries: 3\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-main.yml\n# Target line: 34\n\n     29:     - name: Ensure  that the db is present\n     30:       mysql_db:\n     31:         name: fgapiserver\n     32:         #login_host: \"{{ db_config.ansible_facts.ansible_docker_container.NetworkSettings.IPAddress }}\"\n     33:         login_host: \"{{ hostvars['db']['ansible_default_ipv4']['address'] }}\"\n>>>  34:         login_user: root\n     35:         login_password: \"{{ db_root_password }}\"\n     36:         state: import\n     37:         target: \"{{ lookup('env','PWD')}}/roles/fgapi-db/files/fgapiserver_db.sql\"\n     38:       retries: 3\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulp_pulp-operator-playbooks-pulp.yml", "content": "redis_password: \"\"", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: pulp_pulp-operator-playbooks-pulp.yml\n\nCONN_MAX_AGE: 0\nOPTIONS:\nsslmode: '{{ postgres_sslmode }}'\nredis_host: \"{{ ansible_operator_meta.name }}-redis-svc\"\nredis_port: 6379\n26:       redis_password: \"\"\ndeployment_state: present\n_image: quay.io/pulp/pulp\n_image_version: stable\n_image_web: quay.io/pulp/pulp-web\n_image_web_version: stable", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulp_pulp-operator-playbooks-pulp.yml\n# Target line: 26\n\n     21:           CONN_MAX_AGE: 0\n     22:           OPTIONS:\n     23:             sslmode: '{{ postgres_sslmode }}'\n     24:       redis_host: \"{{ ansible_operator_meta.name }}-redis-svc\"\n     25:       redis_port: 6379\n>>>  26:       redis_password: \"\"\n     27:     deployment_state: present\n     28:     _image: quay.io/pulp/pulp\n     29:     _image_version: stable\n     30:     _image_web: quay.io/pulp/pulp-web\n     31:     _image_web_version: stable\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "enthought_edx_ansible-playbooks-roles-antivirus-defaults-main.yml", "content": "ANTIVIRUS_AWS_SECRET: \"\"", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-antivirus-defaults-main.yml\n\n\nANTIVIRUS_BUCKETS: !!null\nANTIVIRUS_MAILTO: \"{{ EDXAPP_TECH_SUPPORT_EMAIL  }}\"\nANTIVIRUS_MAILFROM: \"{{ EDXAPP_DEFAULT_FROM_EMAIL }}\"\nANTIVIRUS_AWS_KEY: \"\"\n34: ANTIVIRUS_AWS_SECRET: \"\"\nANTIVIRUS_S3_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\nANTIVIRUS_SES_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\nANTIVIRUS_S3_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"\nANTIVIRUS_SES_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-antivirus-defaults-main.yml\n# Target line: 34\n\n     29: \n     30: ANTIVIRUS_BUCKETS: !!null\n     31: ANTIVIRUS_MAILTO: \"{{ EDXAPP_TECH_SUPPORT_EMAIL  }}\"\n     32: ANTIVIRUS_MAILFROM: \"{{ EDXAPP_DEFAULT_FROM_EMAIL }}\"\n     33: ANTIVIRUS_AWS_KEY: \"\"\n>>>  34: ANTIVIRUS_AWS_SECRET: \"\"\n     35: ANTIVIRUS_S3_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\n     36: ANTIVIRUS_SES_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\n     37: ANTIVIRUS_S3_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"\n     38: ANTIVIRUS_SES_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dimagi_commcare-cloud-commcare-cloud-bootstrap-environment-public.yml", "content": "commcare_cloud_strict_host_key_checking: no", "line": 77, "detection_span": [72, 82], "with_context": "# Ansible file: dimagi_commcare-cloud-commcare-cloud-bootstrap-environment-public.yml\n\nSTATIC_CDN: \"\"\n\nroot_email: /dev/null\n\ncommcare_cloud_root_user: ubuntu\n77: commcare_cloud_strict_host_key_checking: no\ncommcare_cloud_use_vault: no", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dimagi_commcare-cloud-commcare-cloud-bootstrap-environment-public.yml\n# Target line: 77\n\n     72:   STATIC_CDN: \"\"\n     73: \n     74: root_email: /dev/null\n     75: \n     76: commcare_cloud_root_user: ubuntu\n>>>  77: commcare_cloud_strict_host_key_checking: no\n     78: commcare_cloud_use_vault: no\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "hussainaphroj_ansible_examples-lamp_haproxy-site.yml", "content": "remote_user: root", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: hussainaphroj_ansible_examples-lamp_haproxy-site.yml\n\nroles:\n- common\n\n# Configure and deploy database servers.\n- hosts: dbservers\n12:   remote_user: root\nroles:\n- db\n\n# Configure and deploy the web servers. Note that we include two roles here,\n# the 'base-apache' role which simply sets up Apache, and 'web' which includes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: hussainaphroj_ansible_examples-lamp_haproxy-site.yml\n# Target line: 12\n\n      7:   roles:\n      8:   - common\n      9: \n     10: # Configure and deploy database servers.\n     11: - hosts: dbservers\n>>>  12:   remote_user: root\n     13:   roles:\n     14:   - db\n     15: \n     16: # Configure and deploy the web servers. Note that we include two roles here, \n     17: # the 'base-apache' role which simply sets up Apache, and 'web' which includes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml", "content": "key: key", "line": 94, "detection_span": [89, 99], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n\nkey: ca\n- name: EC_KEY\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\n94:                 key: key\n- name: JAVA_OPTS\nvalue:\n-Xmx1G\n-Dcommons.db.connection.host=$MARIADB_101_RHEL7_PORT_3306_TCP_ADDR\n-Dcommons.db.connection.port=$MARIADB_101_RHEL7_PORT_3306_TCP_PORT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n# Target line: 94\n\n     89:                 key: ca\n     90:           - name: EC_KEY\n     91:             valueFrom:\n     92:               secretKeyRef:\n     93:                 name: \"${EC_SECRET_CRT}\"\n>>>  94:                 key: key\n     95:           - name: JAVA_OPTS\n     96:             value:\n     97:               -Xmx1G\n     98:               -Dcommons.db.connection.host=$MARIADB_101_RHEL7_PORT_3306_TCP_ADDR\n     99:               -Dcommons.db.connection.port=$MARIADB_101_RHEL7_PORT_3306_TCP_PORT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "w3f_polkadot-validator-setup-ansible-roles-nginx-auth-defaults-main.yml", "content": "nginx_password: nginx_password", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: w3f_polkadot-validator-setup-ansible-roles-nginx-auth-defaults-main.yml\n\nnginx_user: prometheus\n2: nginx_password: nginx_password", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: w3f_polkadot-validator-setup-ansible-roles-nginx-auth-defaults-main.yml\n# Target line: 2\n\n      1: nginx_user: prometheus\n>>>   2: nginx_password: nginx_password\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cjeanner_tripleo-lab-roles-undercloud-tasks-install-built-rpms.yaml", "content": "become_user: root", "line": 11, "detection_span": [6, 16], "with_context": "# Ansible file: cjeanner_tripleo-lab-roles-undercloud-tasks-install-built-rpms.yaml\n\nrecurse: false\nregister: rpm_to_install\n\n- name: install custom RPMs\nbecome: true\n11:   become_user: root\nwhen: rpm_to_install['files'] !=  []\ncommand: \"yum install -y {{ rpm_to_install['files'] |map(attribute='path') | join(' ') }}\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cjeanner_tripleo-lab-roles-undercloud-tasks-install-built-rpms.yaml\n# Target line: 11\n\n      6:     recurse: false\n      7:   register: rpm_to_install\n      8: \n      9: - name: install custom RPMs\n     10:   become: true\n>>>  11:   become_user: root\n     12:   when: rpm_to_install['files'] !=  []\n     13:   command: \"yum install -y {{ rpm_to_install['files'] |map(attribute='path') | join(' ') }}\"\n     14: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-playbooks-installer-rdo-manager-cleanup_virthost.yml", "content": "- ansible_ssh_user: root", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-cleanup_virthost.yml\n\n---\n- include: \"{{base_dir}}/khaleesi/playbooks/provisioner/manual/main.yml\"\n- name: clean up rdo-manager virthost\nhosts: virthost\nvars:\n6:       - ansible_ssh_user: root\nroles:\n- { role: cleanup_nodes/rdo-manager,\nwhen: (installer.type == \"rdo-manager\" and provisioner.type == \"manual\")\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-cleanup_virthost.yml\n# Target line: 6\n\n      1: ---\n      2: - include: \"{{base_dir}}/khaleesi/playbooks/provisioner/manual/main.yml\"\n      3: - name: clean up rdo-manager virthost\n      4:   hosts: virthost\n      5:   vars:\n>>>   6:       - ansible_ssh_user: root\n      7:   roles:\n      8:       - { role: cleanup_nodes/rdo-manager,\n      9:           when: (installer.type == \"rdo-manager\" and provisioner.type == \"manual\")\n     10:         }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nnova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\nnova_service_password: 054e7b1078a9f2cd\nnova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\nrabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\nrabbitmq_password: b763ef86fce7338e145c9c8c\nswift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\nswift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\nswift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 36\n\n     31: nova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n     34: nova_service_password: 054e7b1078a9f2cd\n     35: nova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n>>>  36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n     37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\n     38: rabbitmq_password: b763ef86fce7338e145c9c8c\n     39: swift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\n     40: swift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\n     41: swift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-arkcase-ldap-config-tasks-main.yml", "content": "become_user: arkcase", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-arkcase-ldap-config-tasks-main.yml\n\n- set_fact:\nldap_server_configuration: \"{{ lookup('template', 'templates/ldap.yaml') }}\"\n\n- name: Server ldap configuration {{ ldap_user_domain_bean_name }}\nbecome: yes\n64:   become_user: arkcase\nblockinfile:\npath: /home/arkcase/.arkcase/acm/acm-config-server-repo/ldap/ldap-server.yaml\nblock: \"{{ ldap_server_configuration }}\"\nmarker: \"# {mark} ANSIBLE MANAGED BLOCK {{ ldap_user_domain_bean_name }}\"\nwhen: arkcase_version == \"\" or arkcase_version is version('3.3.7', '>=')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-arkcase-ldap-config-tasks-main.yml\n# Target line: 64\n\n     59: - set_fact:\n     60:     ldap_server_configuration: \"{{ lookup('template', 'templates/ldap.yaml') }}\"\n     61: \n     62: - name: Server ldap configuration {{ ldap_user_domain_bean_name }}\n     63:   become: yes\n>>>  64:   become_user: arkcase\n     65:   blockinfile:\n     66:     path: /home/arkcase/.arkcase/acm/acm-config-server-repo/ldap/ldap-server.yaml\n     67:     block: \"{{ ldap_server_configuration }}\"\n     68:     marker: \"# {mark} ANSIBLE MANAGED BLOCK {{ ldap_user_domain_bean_name }}\"\n     69:   when: arkcase_version == \"\" or arkcase_version is version('3.3.7', '>=')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcalvaga_examples-ansible-language_features-rabbitmq.yml", "content": "apt_key: url=https://www.rabbitmq.com/rabbitmq-signing-key-public.asc state=present", "line": 16, "detection_span": [11, 21], "with_context": "# Ansible file: rcalvaga_examples-ansible-language_features-rabbitmq.yml\n\n\n- name: add rabbitmq official apt repository\napt_repository: repo='deb http://www.rabbitmq.com/debian/ testing main' state=present\n\n- name: add trusted key\n16:     apt_key: url=https://www.rabbitmq.com/rabbitmq-signing-key-public.asc state=present\n\n- name: install package\napt: name={{ item }} update_cache=yes state=installed\nwith_items:\n- rabbitmq-server", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: rcalvaga_examples-ansible-language_features-rabbitmq.yml\n# Target line: 16\n\n     11: \n     12:   - name: add rabbitmq official apt repository\n     13:     apt_repository: repo='deb http://www.rabbitmq.com/debian/ testing main' state=present\n     14: \n     15:   - name: add trusted key\n>>>  16:     apt_key: url=https://www.rabbitmq.com/rabbitmq-signing-key-public.asc state=present\n     17: \n     18:   - name: install package\n     19:     apt: name={{ item }} update_cache=yes state=installed\n     20:     with_items:\n     21:       - rabbitmq-server\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-agile-integration-enterprise-files-postgresql-seed.yaml", "content": "key: database-name", "line": 102, "detection_span": [97, 107], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-agile-integration-enterprise-files-postgresql-seed.yaml\n\nkey: database-password\nname: ${DATABASE_SERVICE_NAME}\n- name: POSTGRESQL_DATABASE\nvalueFrom:\nsecretKeyRef:\n102:                   key: database-name\nname: ${DATABASE_SERVICE_NAME}\n- name: POSTGRESQL_SERVICE\nvalue: ${DATABASE_SERVICE_NAME}\nvolumeMounts:\n- name: seed-volume", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-agile-integration-enterprise-files-postgresql-seed.yaml\n# Target line: 102\n\n     97:                   key: database-password\n     98:                   name: ${DATABASE_SERVICE_NAME}\n     99:             - name: POSTGRESQL_DATABASE\n    100:               valueFrom:\n    101:                 secretKeyRef:\n>>> 102:                   key: database-name\n    103:                   name: ${DATABASE_SERVICE_NAME}\n    104:             - name: POSTGRESQL_SERVICE\n    105:               value: ${DATABASE_SERVICE_NAME}\n    106:           volumeMounts:\n    107:             - name: seed-volume\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml", "content": "- user: devops", "line": 111, "detection_span": [106, 116], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n\n106: tower_version: 3.7.3-1\n107: tower_hostname: \"tower.{{ guid }}.{{ osp_cluster_dns_zone }}\"\n108:\n109: # Tower Configuration Dictionaries, correspond with configure_tower.yml\n110: tower_user_accounts:\n111:   - user: devops\npassword: \"{{ devops_password_tower }}\"\nemail: devops@example.com\nfirstname: Devon\nlastname: Operations\nsuperuser: yes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n# Target line: 111\n\n    106: tower_version: 3.7.3-1\n    107: tower_hostname: \"tower.{{ guid }}.{{ osp_cluster_dns_zone }}\"\n    108: \n    109: # Tower Configuration Dictionaries, correspond with configure_tower.yml\n    110: tower_user_accounts: \n>>> 111:   - user: devops\n    112:     password: \"{{ devops_password_tower }}\"\n    113:     email: devops@example.com\n    114:     firstname: Devon\n    115:     lastname: Operations\n    116:     superuser: yes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cchheda1_https-github.com-PaloAltoNetworks-ansible-pan-ansible-playbooks-terraform_integration-vars-sample.yml", "content": "admin_username: \"admin\"", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: cchheda1_https-github.com-PaloAltoNetworks-ansible-pan-ansible-playbooks-terraform_integration-vars-sample.yml\n\n# vars.yml\n2: admin_username: \"admin\"\nadmin_password: \"admin\"\nmgmt_ip: \"127.0.0.1\"\nkey_name: \"/home/creds/my-key.pem\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cchheda1_https-github.com-PaloAltoNetworks-ansible-pan-ansible-playbooks-terraform_integration-vars-sample.yml\n# Target line: 2\n\n      1: # vars.yml\n>>>   2: admin_username: \"admin\"\n      3: admin_password: \"admin\"\n      4: mgmt_ip: \"127.0.0.1\"\n      5: key_name: \"/home/creds/my-key.pem\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "manala_ansible-roles-molecule-mysql.galera.4.10.mysql_wsrep.8.0.26-converge.yml", "content": "password: foo", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: manala_ansible-roles-molecule-mysql.galera.4.10.mysql_wsrep.8.0.26-converge.yml\n\n- galera-arbitrator-4\n- mysql-wsrep-server\n- mysql-wsrep-client\nmanala_mysql_users:\n- name: foo\n25:                 password: foo\nhost: localhost\npriv: \"*.*:ALL,GRANT\"\n- name: bar\nstate: ignore\n# Flatten", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: manala_ansible-roles-molecule-mysql.galera.4.10.mysql_wsrep.8.0.26-converge.yml\n# Target line: 25\n\n     20:               - galera-arbitrator-4\n     21:               - mysql-wsrep-server\n     22:               - mysql-wsrep-client\n     23:             manala_mysql_users:\n     24:               - name: foo\n>>>  25:                 password: foo\n     26:                 host: localhost\n     27:                 priv: \"*.*:ALL,GRANT\"\n     28:               - name: bar\n     29:                 state: ignore\n     30:               # Flatten\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml", "content": "key_usage_critical: yes", "line": 90, "detection_span": [85, 95], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n\nopenssl_csr:\nbasic_constraints_critical: yes\nbasic_constraints:\n- CA:TRUE\n- pathlen:0\n90:     key_usage_critical: yes\nkey_usage:\n- Digital Signature\n- Certificate Sign\n- CRL Sign\ndigest: sha256", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n# Target line: 90\n\n     85:   openssl_csr:\n     86:     basic_constraints_critical: yes\n     87:     basic_constraints:\n     88:       - CA:TRUE\n     89:       - pathlen:0\n>>>  90:     key_usage_critical: yes\n     91:     key_usage:\n     92:       - Digital Signature\n     93:       - Certificate Sign\n     94:       - CRL Sign\n     95:     digest: sha256\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml", "content": "become_user: barman", "line": 56, "detection_span": [51, 61], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n\nchanged_when: no\ntags: keys\n\n- name: ensure we have postgres key in known hosts file for barman\nlineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ postgres_host }}\\s+ssh-rsa\\s+.*\" line=\"{{ postgres_rsa_key.stdout }}\"\n56:   become_user: barman\ntags: keys\n\n- name: ensure we have barman key in known hosts file for postgres\nlineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ barman_ip }}\\s+ssh-rsa\\s+.*\" line=\"{{ barman_rsa_key.stdout }}\"\nbecome_user: postgres", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n# Target line: 56\n\n     51:   changed_when: no\n     52:   tags: keys\n     53: \n     54: - name: ensure we have postgres key in known hosts file for barman\n     55:   lineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ postgres_host }}\\s+ssh-rsa\\s+.*\" line=\"{{ postgres_rsa_key.stdout }}\"\n>>>  56:   become_user: barman\n     57:   tags: keys\n     58: \n     59: - name: ensure we have barman key in known hosts file for postgres\n     60:   lineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ barman_ip }}\\s+ssh-rsa\\s+.*\" line=\"{{ barman_rsa_key.stdout }}\"\n     61:   become_user: postgres\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml", "content": "user: name=barman generate_ssh_key=yes", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n\n- name: generate ssh key for user barman\n2:   user: name=barman generate_ssh_key=yes\n\n- name: generate ssh key for user postgres\nuser: name=postgres generate_ssh_key=yes\ndelegate_to: \"{{ postgres_host }}\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n# Target line: 2\n\n      1: - name: generate ssh key for user barman\n>>>   2:   user: name=barman generate_ssh_key=yes\n      3: \n      4: - name: generate ssh key for user postgres\n      5:   user: name=postgres generate_ssh_key=yes\n      6:   delegate_to: \"{{ postgres_host }}\"\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ansible-tower-implementation-default_vars_ec2.yml", "content": "- key: \"AnsibleGroup\"", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-tower-implementation-default_vars_ec2.yml\n\nfloating_ip: true\nimage: \"{{ bastion_instance_image | default(__image) }}\"\nflavor:\nec2: \"{{ bastion_instance_type | default(__instance_type) }}\"\ntags:\n64:       - key: \"AnsibleGroup\"\nvalue: \"bastions\"\n- key: \"ostype\"\nvalue: \"linux\"\n- key: \"instance_filter\"\nvalue: \"{{ env_type }}-{{ email }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-tower-implementation-default_vars_ec2.yml\n# Target line: 64\n\n     59:     floating_ip: true\n     60:     image: \"{{ bastion_instance_image | default(__image) }}\"\n     61:     flavor:\n     62:       ec2: \"{{ bastion_instance_type | default(__instance_type) }}\"\n     63:     tags:\n>>>  64:       - key: \"AnsibleGroup\"\n     65:         value: \"bastions\"\n     66:       - key: \"ostype\"\n     67:         value: \"linux\"\n     68:       - key: \"instance_filter\"\n     69:         value: \"{{ env_type }}-{{ email }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloudera_cloudera-playbook-group_vars-db_server.yml", "content": "user: 'scm'", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n\ndatabase_type: mysql\n\ndatabases:\nscm:\nname: 'scm'\n20:     user: 'scm'\npass: 'scm_password'\ntype: '{{ database_type }}'\namon:\nname: 'amon'\nuser: 'amon'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n# Target line: 20\n\n     15: database_type: mysql\n     16: \n     17: databases:\n     18:   scm:\n     19:     name: 'scm'\n>>>  20:     user: 'scm'\n     21:     pass: 'scm_password'\n     22:     type: '{{ database_type }}'\n     23:   amon:\n     24:     name: 'amon'\n     25:     user: 'amon'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ansible_workshops-roles-f5_setup-tasks-main.yml", "content": "key: provision.extramb", "line": 45, "detection_span": [40, 50], "with_context": "# Ansible file: ansible_workshops-roles-f5_setup-tasks-main.yml\n\n- name: install AS3 RPM\ninclude_tasks: install_as3.yml\n\n- name: Set db provision.extramb\nf5networks.f5_modules.bigip_sys_db:\n45:     key: provision.extramb\nvalue: \"1024\"\nprovider: \"{{ provider }}\"\n\n- name: Set db restjavad.useextramb\nf5networks.f5_modules.bigip_sys_db:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ansible_workshops-roles-f5_setup-tasks-main.yml\n# Target line: 45\n\n     40: - name: install AS3 RPM\n     41:   include_tasks: install_as3.yml\n     42: \n     43: - name: Set db provision.extramb\n     44:   f5networks.f5_modules.bigip_sys_db:\n>>>  45:     key: provision.extramb\n     46:     value: \"1024\"\n     47:     provider: \"{{ provider }}\"\n     48: \n     49: - name: Set db restjavad.useextramb\n     50:   f5networks.f5_modules.bigip_sys_db:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml", "content": "- doc_root: '/var/local/firestone-renovations'", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n\nsite_name: \"milberg-staging\"\ndoc_root: \"/var/local/milberg\"\ngit_repo: 'https://github.com/pulibrary/milberg-wp.git'\nversion: 'main'\nsites:\n13:     - doc_root: '/var/local/firestone-renovations'\ngit_repo: 'https://github.com/pulibrary/firestone_renovations_archive.git'\nalias: 'renovations'\nversion: 'main'\n- doc_root: '/var/local/republic'\ngit_repo: 'https://github.com/pulibrary/republic_exhibit_archive.git'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n# Target line: 13\n\n      8:       site_name: \"milberg-staging\"\n      9:       doc_root: \"/var/local/milberg\"\n     10:       git_repo: 'https://github.com/pulibrary/milberg-wp.git'\n     11:       version: 'main'\n     12: sites:\n>>>  13:     - doc_root: '/var/local/firestone-renovations'\n     14:       git_repo: 'https://github.com/pulibrary/firestone_renovations_archive.git'\n     15:       alias: 'renovations'\n     16:       version: 'main'\n     17:     - doc_root: '/var/local/republic'\n     18:       git_repo: 'https://github.com/pulibrary/republic_exhibit_archive.git'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_casl-ansible-roles-openshift-login-tasks-main.yml", "content": "openshift_password: ''", "line": 24, "detection_span": [19, 29], "with_context": "# Ansible file: redhat-cop_casl-ansible-roles-openshift-login-tasks-main.yml\n\nopenshift_user: ''\nwhen: openshift_user is not defined\n\n- name: \"Set variable openshift_password when not set\"\nset_fact:\n24:     openshift_password: ''\nwhen: openshift_password is not defined\n\n- name: \"Set variable openshift_token when not set\"\nset_fact:\nopenshift_token: ''", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_casl-ansible-roles-openshift-login-tasks-main.yml\n# Target line: 24\n\n     19:     openshift_user: ''\n     20:   when: openshift_user is not defined\n     21: \n     22: - name: \"Set variable openshift_password when not set\"\n     23:   set_fact:\n>>>  24:     openshift_password: ''\n     25:   when: openshift_password is not defined\n     26: \n     27: - name: \"Set variable openshift_token when not set\"\n     28:   set_fact:\n     29:     openshift_token: ''\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-user-rhos-dev-ci.yml", "content": "key_name: rhos-jenkins", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-user-rhos-dev-ci.yml\n\n\nprovisioner:\nusername: rhos-dev-ci\npassword: !lookup private.provisioner.qeos7.rhos-dev-ci.password\nkey_file: !join [ !env HOME , /.ssh/rhos-jenkins/id_rsa ]\n7:     key_name: rhos-jenkins", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-user-rhos-dev-ci.yml\n# Target line: 7\n\n      2: \n      3: provisioner:\n      4:     username: rhos-dev-ci\n      5:     password: !lookup private.provisioner.qeos7.rhos-dev-ci.password\n      6:     key_file: !join [ !env HOME , /.ssh/rhos-jenkins/id_rsa ]\n>>>   7:     key_name: rhos-jenkins\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml", "content": "smtp_passwd: changeme", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n\n# smtp\nsmtp_host: \"smtp.sendgrid.net\"\nsmtp_port: 587\nsmtp_authentication: plain\nsmtp_userid: changeme\n26: smtp_passwd: changeme\nsmtp_domain: \"redhat.com\"\n\n# CMS\nuse_rwo_for_cms: false\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n# Target line: 26\n\n     21: # smtp\n     22: smtp_host: \"smtp.sendgrid.net\"\n     23: smtp_port: 587\n     24: smtp_authentication: plain\n     25: smtp_userid: changeme\n>>>  26: smtp_passwd: changeme\n     27: smtp_domain: \"redhat.com\"\n     28: \n     29: # CMS\n     30: use_rwo_for_cms: false\n     31: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_ansible-nfv-roles-post_install-dynamic_host_inventory-vars-main.yml", "content": "private_key_fetch_location: /tmp", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: redhat-openstack_ansible-nfv-roles-post_install-dynamic_host_inventory-vars-main.yml\n\n# Refer to docs/tripleo/post_install/dynamic_host_inventory.md to see the full list of capabilities\ndiscover_instance_external_ip: True # Whether to attempt to discover external IP\n3: private_key_fetch_location: /tmp", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_ansible-nfv-roles-post_install-dynamic_host_inventory-vars-main.yml\n# Target line: 3\n\n      1: # Refer to docs/tripleo/post_install/dynamic_host_inventory.md to see the full list of capabilities\n      2: discover_instance_external_ip: True # Whether to attempt to discover external IP\n>>>   3: private_key_fetch_location: /tmp\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "manage_dashboard_secret: secret", "line": 96, "detection_span": [91, 101], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmonitoring_tests_oidcng_client_secret: secret\nmonitoring_tests_oidcng_resource_server_secret: secret\n\nmanage_internal_api_password: secret\nmanage_backdoor_api_password: secret\n96: manage_dashboard_secret: secret\nmanage_myconext_secret: secret\nmanage_pdp_secret: secret\nmanage_sp_dashboard_secret: secret\n100: manage_sysadmin_secret: secret\n101:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 96\n\n     91: monitoring_tests_oidcng_client_secret: secret\n     92: monitoring_tests_oidcng_resource_server_secret: secret\n     93: \n     94: manage_internal_api_password: secret\n     95: manage_backdoor_api_password: secret\n>>>  96: manage_dashboard_secret: secret\n     97: manage_myconext_secret: secret\n     98: manage_pdp_secret: secret\n     99: manage_sp_dashboard_secret: secret\n    100: manage_sysadmin_secret: secret\n    101: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-roles-abrt-faf-tasks-cron.yml", "content": "user: faf", "line": 30, "detection_span": [25, 35], "with_context": "# Ansible file: tmzullinger_fedora-ansible-roles-abrt-faf-tasks-cron.yml\n\n- \"ruby\"\n\n- name: cron create-problems\ncron:\nname: \"faf create-problems with type {{ item}}\"\n30:     user: faf\njob: \"faf create-problems -p {{ item }} >> /var/log/faf/create-problems.log 2>&1\"\nday: \"15\"\nminute: 30\nhour: \"14\"\nstate: present", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-roles-abrt-faf-tasks-cron.yml\n# Target line: 30\n\n     25:     - \"ruby\"\n     26: \n     27: - name: cron create-problems\n     28:   cron:\n     29:     name: \"faf create-problems with type {{ item}}\"\n>>>  30:     user: faf\n     31:     job: \"faf create-problems -p {{ item }} >> /var/log/faf/create-problems.log 2>&1\"\n     32:     day: \"15\"\n     33:     minute: 30\n     34:     hour: \"14\"\n     35:     state: present\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "hussainaphroj_ansible_examples-language_features-rabbitmq.yml", "content": "rabbitmq_user: user=guest state=absent", "line": 29, "detection_span": [24, 34], "with_context": "# Ansible file: hussainaphroj_ansible_examples-language_features-rabbitmq.yml\n\nwith_items:\n- user1\n- user2\n\n- name: remove default guest user\n29:     rabbitmq_user: user=guest state=absent\n\n- name: ensure vhost /test is present\nrabbitmq_vhost: name=/test state=present\n\n- name: set federation local-username", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: hussainaphroj_ansible_examples-language_features-rabbitmq.yml\n# Target line: 29\n\n     24:     with_items:\n     25:     - user1\n     26:     - user2\n     27: \n     28:   - name: remove default guest user\n>>>  29:     rabbitmq_user: user=guest state=absent\n     30: \n     31:   - name: ensure vhost /test is present\n     32:     rabbitmq_vhost: name=/test state=present\n     33: \n     34:   - name: set federation local-username\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml", "content": "aws_access_key_id: FROM_SECRET", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n\n# -------------------------------------------------------------------\n# AWS specific settings (from secrets usually)\n# -------------------------------------------------------------------\n\n# AWS Credentials\n64: aws_access_key_id: FROM_SECRET\naws_secret_access_key: FROM_SECRET\n\n# HostedZoneId must match subdomain_base_suffix\n#HostedZoneId: FROM_SECRET\nsubdomain_base_suffix: .example.com", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n# Target line: 64\n\n     59: # -------------------------------------------------------------------\n     60: # AWS specific settings (from secrets usually)\n     61: # -------------------------------------------------------------------\n     62: \n     63: # AWS Credentials\n>>>  64: aws_access_key_id: FROM_SECRET\n     65: aws_secret_access_key: FROM_SECRET\n     66: \n     67: # HostedZoneId must match subdomain_base_suffix\n     68: #HostedZoneId: FROM_SECRET\n     69: subdomain_base_suffix: .example.com\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "mongo_admin_password: secret", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmongo_passwords:\nmanage: secret\noidcng: secret\nmyconext: secret\n\n23: mongo_admin_password: secret\n\nengine_api_metadata_push_password: secret\noidcng_api_metadata_push_password: secret\noidcng_api_tokens_profile_password: secret\noidcng_api_tokens_eduid_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 23\n\n     18: mongo_passwords:\n     19:    manage: secret\n     20:    oidcng: secret\n     21:    myconext: secret\n     22: \n>>>  23: mongo_admin_password: secret\n     24: \n     25: engine_api_metadata_push_password: secret\n     26: oidcng_api_metadata_push_password: secret\n     27: oidcng_api_tokens_profile_password: secret\n     28: oidcng_api_tokens_eduid_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml", "content": "- { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }", "line": 77, "detection_span": [72, 82], "with_context": "# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n\n- { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n- { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n- { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n77:     - { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'authgateway/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hgm/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hive', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n- { name: 'cf', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }\n- { name: 'vcap', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n# Target line: 77\n\n     72:     - { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n     73:     - { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n     74:     - { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n     75:     - { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n     76:     - { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n>>>  77:     - { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }\n     78:     - { name: 'authgateway/sys', pass: '', params: '-randkey -requires_preauth' }\n     79:     - { name: 'hgm/sys', pass: '', params: '-randkey -requires_preauth' }\n     80:     - { name: 'hive', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n     81:     - { name: 'cf', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }\n     82:     - { name: 'vcap', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml", "content": "api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n\n# root password of the db - put this in your group_vars and then in a vault in production\ndb_root_password: \"changeme\"\n# API Server db config\n# API Server user name and password - should be kept in group_vars\napi_db_username: \"fgapiserver\"\n15: api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\napi_db_name: fgapiserver\n# where will we store the SQL data ?\nsql_data_dir: /tmp/fgapi-server-db-data/\n# Repos\nrepos:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n# Target line: 15\n\n     10: # root password of the db - put this in your group_vars and then in a vault in production\n     11: db_root_password: \"changeme\"\n     12: # API Server db config\n     13: # API Server user name and password - should be kept in group_vars\n     14: api_db_username: \"fgapiserver\"\n>>>  15: api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\n     16: api_db_name: fgapiserver\n     17: # where will we store the SQL data ?\n     18: sql_data_dir: /tmp/fgapi-server-db-data/\n     19: # Repos\n     20: repos:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml", "content": "lab_user:                     devops                        # Ansible Service Account", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n\n\ncloud_provider:               osp\n\nkey_name:                     ocpkey\nstudent_name:                 student                       # Default ssh account\n19: lab_user:                     devops                        # Ansible Service Account\n\nstudent_password: r3dh4t1!\ndevops_password_tower: r3dh4t1!\n\n###### VARIABLES YOU SHOULD CONFIGURE FOR YOUR DEPLOYEMNT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n# Target line: 19\n\n     14: \n     15: cloud_provider:               osp\n     16: \n     17: key_name:                     ocpkey\n     18: student_name:                 student                       # Default ssh account\n>>>  19: lab_user:                     devops                        # Ansible Service Account\n     20: \n     21: student_password: r3dh4t1!\n     22: devops_password_tower: r3dh4t1!\n     23: \n     24: ###### VARIABLES YOU SHOULD CONFIGURE FOR YOUR DEPLOYEMNT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "os-cloud_openstack-ansible-lxc_hosts-tasks-main.yml", "content": "path: /root/.ssh/id_rsa.pub", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: os-cloud_openstack-ansible-lxc_hosts-tasks-main.yml\n\n# limitations under the License.\n\n- name: Check for the presence of a public key file on the deployment host\nlocal_action:\nmodule: stat\n19:     path: /root/.ssh/id_rsa.pub\nregister: _ssh_key\nwhen: lxc_container_ssh_key is undefined\ntags:\n- always\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: os-cloud_openstack-ansible-lxc_hosts-tasks-main.yml\n# Target line: 19\n\n     14: # limitations under the License.\n     15: \n     16: - name: Check for the presence of a public key file on the deployment host\n     17:   local_action:\n     18:     module: stat\n>>>  19:     path: /root/.ssh/id_rsa.pub\n     20:   register: _ssh_key\n     21:   when: lxc_container_ssh_key is undefined\n     22:   tags:\n     23:     - always\n     24: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-taxon-overflow-tasks-main.yml", "content": "become_user: postgres", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-taxon-overflow-tasks-main.yml\n\ntags:\n- taxonoverflow\n\n- name: create DB\npostgresql_db: name={{taxonoverflow_db_name | default('taxonoverflow') }} state=present\n7:   become_user: postgres\nbecome: yes\ntags:\n- db\n- taxonoverflow\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-taxon-overflow-tasks-main.yml\n# Target line: 7\n\n      2:   tags:\n      3:     - taxonoverflow\n      4: \n      5: - name: create DB\n      6:   postgresql_db: name={{taxonoverflow_db_name | default('taxonoverflow') }} state=present\n>>>   7:   become_user: postgres\n      8:   become: yes\n      9:   tags:\n     10:     - db\n     11:     - taxonoverflow\n     12: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-eu_infrastructure-playbook-galaxy-test.yml", "content": "galaxy_create_user: true", "line": 112, "detection_span": [107, 117], "with_context": "# Ansible file: usegalaxy-eu_infrastructure-playbook-galaxy-test.yml\n\n- usegalaxy-eu.google-verification\n- usegalaxy-eu.nginx\n# The REAL galaxy role\n- role: galaxyproject.galaxy\nvars:\n112:         galaxy_create_user: true\ngalaxy_manage_clone: true\ngalaxy_manage_static_setup: true\ngalaxy_manage_mutable_setup: true\ngalaxy_manage_database: true\ngalaxy_fetch_dependencies: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-eu_infrastructure-playbook-galaxy-test.yml\n# Target line: 112\n\n    107:     - usegalaxy-eu.google-verification\n    108:     - usegalaxy-eu.nginx\n    109:     # The REAL galaxy role\n    110:     - role: galaxyproject.galaxy\n    111:       vars:\n>>> 112:         galaxy_create_user: true\n    113:         galaxy_manage_clone: true\n    114:         galaxy_manage_static_setup: true\n    115:         galaxy_manage_mutable_setup: true\n    116:         galaxy_manage_database: true\n    117:         galaxy_fetch_dependencies: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "IBM_z_ansible_collections_samples-zos_subsystems-db2-db2_schema_provisioning-roles-db2_delete_app_instance-defaults-main.yml", "content": "password: valid_password", "line": 18, "detection_span": [13, 23], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-db2-db2_schema_provisioning-roles-db2_delete_app_instance-defaults-main.yml\n\n\n# Username used to access the DOE REST API\nusername: valid_username\n\n# Password used to access the DOE REST API\n18: password: valid_password", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-db2-db2_schema_provisioning-roles-db2_delete_app_instance-defaults-main.yml\n# Target line: 18\n\n     13: \n     14: # Username used to access the DOE REST API\n     15: username: valid_username\n     16: \n     17: # Password used to access the DOE REST API\n>>>  18: password: valid_password\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "epiphany-platform_epiphany-schema-common-defaults-configuration-kafka.yml", "content": "cert_validity: 365", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: epiphany-platform_epiphany-schema-common-defaults-configuration-kafka.yml\n\nport: 9093\nserver:\nlocal_cert_download_path: kafka-certs\nkeystore_location: /var/private/ssl/kafka.server.keystore.jks\ntruststore_location: /var/private/ssl/kafka.server.truststore.jks\n17:         cert_validity: 365\npasswords:\nkeystore: PasswordToChange\ntruststore: PasswordToChange\nkey: PasswordToChange\nendpoint_identification_algorithm: HTTPS", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: epiphany-platform_epiphany-schema-common-defaults-configuration-kafka.yml\n# Target line: 17\n\n     12:       port: 9093\n     13:       server:\n     14:         local_cert_download_path: kafka-certs\n     15:         keystore_location: /var/private/ssl/kafka.server.keystore.jks\n     16:         truststore_location: /var/private/ssl/kafka.server.truststore.jks\n>>>  17:         cert_validity: 365\n     18:         passwords:\n     19:           keystore: PasswordToChange\n     20:           truststore: PasswordToChange\n     21:           key: PasswordToChange\n     22:       endpoint_identification_algorithm: HTTPS\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_cephadm-defaults-main.yml", "content": "tripleo_cephadm_registry_username: ''", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_cephadm-defaults-main.yml\n\ntripleo_cephadm_container_image: \"ceph\"\ntripleo_cephadm_container_tag: \"v16\"\ntripleo_cephadm_container_cli: \"podman\"\ntripleo_cephadm_container_options: \"--net=host --ipc=host\"\ntripleo_cephadm_registry_password: ''\n15: tripleo_cephadm_registry_username: ''\ntripleo_cephadm_registry_url: ''\ntripleo_cephadm_keyring_prefix: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.client\"\ntripleo_cephadm_admin_keyring: \"{{ tripleo_cephadm_keyring_prefix }}.admin.keyring\"\ntripleo_cephadm_conf: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.conf\"\ntripleo_cephadm_assimilate_conf: \"/home/{{ tripleo_cephadm_ssh_user }}/assimilate_{{ tripleo_cephadm_cluster }}.conf\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_cephadm-defaults-main.yml\n# Target line: 15\n\n     10: tripleo_cephadm_container_image: \"ceph\"\n     11: tripleo_cephadm_container_tag: \"v16\"\n     12: tripleo_cephadm_container_cli: \"podman\"\n     13: tripleo_cephadm_container_options: \"--net=host --ipc=host\"\n     14: tripleo_cephadm_registry_password: ''\n>>>  15: tripleo_cephadm_registry_username: ''\n     16: tripleo_cephadm_registry_url: ''\n     17: tripleo_cephadm_keyring_prefix: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.client\"\n     18: tripleo_cephadm_admin_keyring: \"{{ tripleo_cephadm_keyring_prefix }}.admin.keyring\"\n     19: tripleo_cephadm_conf: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.conf\"\n     20: tripleo_cephadm_assimilate_conf: \"/home/{{ tripleo_cephadm_ssh_user }}/assimilate_{{ tripleo_cephadm_cluster }}.conf\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-tenant-common-image.yml", "content": "remote_user: cloud-user", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-tenant-common-image.yml\n\nremote_user: fedora\nrhel:\n'6.6':\nid: faae17d6-371f-4911-a8ea-ed04578b49d1\nname: rhel-guest-image-6.6-20150127.0\n25:                 remote_user: cloud-user\n'6.7':\nid: 183d828c-8801-444f-b834-feebd9f6510f\nname: rhel-guest-image-6.7-20150702.0\nremote_user: cloud-user\n'6.8':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-tenant-common-image.yml\n# Target line: 25\n\n     20:                 remote_user: fedora\n     21:         rhel:\n     22:             '6.6':\n     23:                 id: faae17d6-371f-4911-a8ea-ed04578b49d1\n     24:                 name: rhel-guest-image-6.6-20150127.0\n>>>  25:                 remote_user: cloud-user\n     26:             '6.7':\n     27:                 id: 183d828c-8801-444f-b834-feebd9f6510f\n     28:                 name: rhel-guest-image-6.7-20150702.0\n     29:                 remote_user: cloud-user\n     30:             '6.8':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.fits-defaults-main.yml", "content": "fits_install_root: /opt", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.fits-defaults-main.yml\n\n---\nfits_download_dir: /usr/local/src\nfits_version: 1.4.1\nfits_ws_version: 1.2.0\n5: fits_install_root: /opt\nfits_install_symlink: /opt/fits\nfits_user: tomcat\nfits_group: tomcat\nfits_ws: yes\ncrayfits_home: /var/www/html", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.fits-defaults-main.yml\n# Target line: 5\n\n      1: ---\n      2: fits_download_dir: /usr/local/src\n      3: fits_version: 1.4.1\n      4: fits_ws_version: 1.2.0\n>>>   5: fits_install_root: /opt\n      6: fits_install_symlink: /opt/fits\n      7: fits_user: tomcat\n      8: fits_group: tomcat\n      9: fits_ws: yes\n     10: crayfits_home: /var/www/html\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-sample_vars_ec2.yml", "content": "consumer_key:  \"cuBfSo9NhB338aSwvRC5VKgZt5Sqhez5\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-sample_vars_ec2.yml\n\n\nsatellite_public_fqdn: satellite1.cap01.example.opentlc.com\ncapsule_activationkey: capsule_key\ncapsule_org: gpte\n\n20: consumer_key:  \"cuBfSo9NhB338aSwvRC5VKgZt5Sqhez5\"\nconsumer_secret: \"mpYncnDHkRq9XrHDoereQ3Hwejyyed6c\"\n\ncapsule_cert_path:  /tmp/capsule-cert.tar", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-sample_vars_ec2.yml\n# Target line: 20\n\n     15: \n     16: satellite_public_fqdn: satellite1.cap01.example.opentlc.com\n     17: capsule_activationkey: capsule_key\n     18: capsule_org: gpte\n     19: \n>>>  20: consumer_key:  \"cuBfSo9NhB338aSwvRC5VKgZt5Sqhez5\"\n     21: consumer_secret: \"mpYncnDHkRq9XrHDoereQ3Hwejyyed6c\"\n     22: \n     23: capsule_cert_path:  /tmp/capsule-cert.tar \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "georgegoh_openshift-ansible-playbooks-common-openshift-cluster-redeploy-certificates-etcd.yml", "content": "etcd_cert_prefix: \"master.etcd-\"", "line": 63, "detection_span": [58, 68], "with_context": "# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-redeploy-certificates-etcd.yml\n\n- role: openshift_etcd_client_certificates\netcd_certificates_redeploy: true\netcd_ca_host: \"{{ groups.oo_etcd_to_config.0 }}\"\netcd_cert_subdir: \"openshift-master-{{ openshift.common.hostname }}\"\netcd_cert_config_dir: \"{{ openshift.common.config_base }}/master\"\n63:       etcd_cert_prefix: \"master.etcd-\"\nopenshift_ca_host: \"{{ groups.oo_first_master.0 }}\"\nopenshift_master_count: \"{{ openshift.master.master_count | default(groups.oo_masters | length) }}\"\nwhen: groups.oo_etcd_to_config is defined and groups.oo_etcd_to_config", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-redeploy-certificates-etcd.yml\n# Target line: 63\n\n     58:     - role: openshift_etcd_client_certificates\n     59:       etcd_certificates_redeploy: true\n     60:       etcd_ca_host: \"{{ groups.oo_etcd_to_config.0 }}\"\n     61:       etcd_cert_subdir: \"openshift-master-{{ openshift.common.hostname }}\"\n     62:       etcd_cert_config_dir: \"{{ openshift.common.config_base }}/master\"\n>>>  63:       etcd_cert_prefix: \"master.etcd-\"\n     64:       openshift_ca_host: \"{{ groups.oo_first_master.0 }}\"\n     65:       openshift_master_count: \"{{ openshift.master.master_count | default(groups.oo_masters | length) }}\"\n     66:       when: groups.oo_etcd_to_config is defined and groups.oo_etcd_to_config\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_kolla-ansible-roles-cephadm-defaults-main.yml", "content": "cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n- shortname: \"ceph-noarch\"\nname: \"Ceph noarch repository\"\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n\n13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n\ncephadm_ceph_osd_devices:\n- primary:/dev/cephvg/cephlv\n- secondary1:/dev/cephvg/cephlv\n- secondary2:/dev/cephvg/cephlv", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n# Target line: 13\n\n      8:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n      9:   - shortname: \"ceph-noarch\"\n     10:     name: \"Ceph noarch repository\"\n     11:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n     12: \n>>>  13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n     14: \n     15: cephadm_ceph_osd_devices:\n     16:   - primary:/dev/cephvg/cephlv\n     17:   - secondary1:/dev/cephvg/cephlv\n     18:   - secondary2:/dev/cephvg/cephlv\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml", "content": "REGISTRY_HTTP_TLS_CERTIFICATE: /etc/secrets/registry.crt", "line": 98, "detection_span": [93, 103], "with_context": "# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n\n- name: registry-certificates\npath: /etc/secrets\ntype: secret\nsecret_name: registry-certificates\nregistry_secure_env_vars:\n98:       REGISTRY_HTTP_TLS_CERTIFICATE: /etc/secrets/registry.crt\nREGISTRY_HTTP_TLS_KEY: /etc/secrets/registry.key\nregistry_secure_edits:\n- key: spec.template.spec.containers[0].livenessProbe.httpGet.scheme\nvalue: HTTPS\naction: put", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n# Target line: 98\n\n     93:     - name: registry-certificates\n     94:       path: /etc/secrets\n     95:       type: secret\n     96:       secret_name: registry-certificates\n     97:     registry_secure_env_vars:\n>>>  98:       REGISTRY_HTTP_TLS_CERTIFICATE: /etc/secrets/registry.crt\n     99:       REGISTRY_HTTP_TLS_KEY: /etc/secrets/registry.key\n    100:     registry_secure_edits:\n    101:     - key: spec.template.spec.containers[0].livenessProbe.httpGet.scheme\n    102:       value: HTTPS\n    103:       action: put\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "geerlingguy_drupal-vm-provisioning-roles-geerlingguy.apache-vars-Debian.yml", "content": "apache_server_root: /etc/apache2", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.apache-vars-Debian.yml\n\n---\napache_service: apache2\napache_daemon: apache2\napache_daemon_path: /usr/sbin/\n5: apache_server_root: /etc/apache2\napache_conf_path: /etc/apache2\n\n__apache_packages:\n- apache2\n- apache2-utils", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.apache-vars-Debian.yml\n# Target line: 5\n\n      1: ---\n      2: apache_service: apache2\n      3: apache_daemon: apache2\n      4: apache_daemon_path: /usr/sbin/\n>>>   5: apache_server_root: /etc/apache2\n      6: apache_conf_path: /etc/apache2\n      7: \n      8: __apache_packages:\n      9:   - apache2\n     10:   - apache2-utils\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ceph_ceph-ansible-roles-ceph-mds-tasks-non_containerized.yml", "content": "import_key: false", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: ceph_ceph-ansible-roles-ceph-mds-tasks-non_containerized.yml\n\ncaps:\nmon: \"allow profile mds\"\nmds: \"allow\"\nosd: \"allow rwx\"\ndest: \"/var/lib/ceph/mds/{{ cluster }}-{{ ansible_facts['hostname'] }}/keyring\"\n34:     import_key: false\nowner: ceph\ngroup: ceph\nmode: \"{{ ceph_keyring_permissions }}\"\nno_log: \"{{ no_log_on_ceph_key_tasks }}\"\nwhen: cephx | bool", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ceph_ceph-ansible-roles-ceph-mds-tasks-non_containerized.yml\n# Target line: 34\n\n     29:     caps:\n     30:       mon: \"allow profile mds\"\n     31:       mds: \"allow\"\n     32:       osd: \"allow rwx\"\n     33:     dest: \"/var/lib/ceph/mds/{{ cluster }}-{{ ansible_facts['hostname'] }}/keyring\"\n>>>  34:     import_key: false\n     35:     owner: ceph\n     36:     group: ceph\n     37:     mode: \"{{ ceph_keyring_permissions }}\"\n     38:   no_log: \"{{ no_log_on_ceph_key_tasks }}\"\n     39:   when: cephx | bool\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-rabbitservers.yml", "content": "nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-nginx.pem", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-rabbitservers.yml\n\nnginx_remove_default_vhost: true\n\n# NGINX Letsencrypt bindings\nnginx_ssl_role: usegalaxy_eu.certbot\nnginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n36: nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-nginx.pem\n\n#telegraf extra stuff\n#telegraf_plugins_extra:\n#    rabbitmq:\n#    plugin: rabbitmq", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-rabbitservers.yml\n# Target line: 36\n\n     31: nginx_remove_default_vhost: true\n     32: \n     33: # NGINX Letsencrypt bindings\n     34: nginx_ssl_role: usegalaxy_eu.certbot\n     35: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n>>>  36: nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-nginx.pem\n     37: \n     38: #telegraf extra stuff\n     39: #telegraf_plugins_extra:\n     40: #    rabbitmq:\n     41: #    plugin: rabbitmq\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloudera_cloudera-playbook-group_vars-db_server.yml", "content": "user: 'oozie'", "line": 60, "detection_span": [55, 65], "with_context": "# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n\nuser: 'hue'\npass: 'hue_password'\ntype: '{{ database_type }}'\noozie:\nname: 'oozie'\n60:     user: 'oozie'\npass: 'oozie_password'\ntype: '{{ database_type }}'\ndas:\nname: 'das'\nuser: 'das'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n# Target line: 60\n\n     55:     user: 'hue'\n     56:     pass: 'hue_password'\n     57:     type: '{{ database_type }}'\n     58:   oozie:\n     59:     name: 'oozie'\n>>>  60:     user: 'oozie'\n     61:     pass: 'oozie_password'\n     62:     type: '{{ database_type }}'\n     63:   das:\n     64:     name: 'das'\n     65:     user: 'das'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-validations-roles-tls_everywhere-tasks-overcloud-post-deployment.yaml", "content": "cert_status_recommendations:", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: openstack_tripleo-validations-roles-tls_everywhere-tasks-overcloud-post-deployment.yaml\n\n\n- name: Set facts for certificates in failed status\nset_fact:\ncert_status_status: \"{{ helper_status_error }}\"\ncert_status_reason: 'The following certificates are not in a healthy status: {{ failed_certs | join(\", \") }}'\n34:     cert_status_recommendations:\n- \"Log into this host and do 'getcert list -i <cert name>' to verify the failure reason\"\n- \"Verify that the service principal of the certificate is present in IdM/FreeIPA for this host\"\nwhen: failed_certs\n\n- name: Set facts for all certificates in monitoring status", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-validations-roles-tls_everywhere-tasks-overcloud-post-deployment.yaml\n# Target line: 34\n\n     29: \n     30: - name: Set facts for certificates in failed status\n     31:   set_fact:\n     32:     cert_status_status: \"{{ helper_status_error }}\"\n     33:     cert_status_reason: 'The following certificates are not in a healthy status: {{ failed_certs | join(\", \") }}'\n>>>  34:     cert_status_recommendations:\n     35:       - \"Log into this host and do 'getcert list -i <cert name>' to verify the failure reason\"\n     36:       - \"Verify that the service principal of the certificate is present in IdM/FreeIPA for this host\"\n     37:   when: failed_certs\n     38: \n     39: - name: Set facts for all certificates in monitoring status\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "opensrp_playbooks-reveal-web.yml", "content": "become_user: \"root\"", "line": 79, "detection_span": [74, 84], "with_context": "# Ansible file: opensrp_playbooks-reveal-web.yml\n\n- express\n\n- name: \"Setup nginx\"\nrole: nginx\nbecome: true\n79:       become_user: \"root\"\nvars:\nnginx_sites: \"{{ reveal_nginx_sites }}\"\nnginx_ssl_dir: \"{{ reveal_nginx_ssl_dir }}\"\nnginx_access_logs: \"{{ reveal_nginx_access_logs }}\"\nnginx_install_method: \"package\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: opensrp_playbooks-reveal-web.yml\n# Target line: 79\n\n     74:         - express\n     75: \n     76:     - name: \"Setup nginx\"\n     77:       role: nginx\n     78:       become: true\n>>>  79:       become_user: \"root\"\n     80:       vars:\n     81:         nginx_sites: \"{{ reveal_nginx_sites }}\"\n     82:         nginx_ssl_dir: \"{{ reveal_nginx_ssl_dir }}\"\n     83:         nginx_access_logs: \"{{ reveal_nginx_access_logs }}\"\n     84:         nginx_install_method: \"package\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml", "content": "key: fedmsg-librariesio2fedmsg.key", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n\nappowners:\n- jcline\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-key\n20:     key: fedmsg-librariesio2fedmsg.key\nprivatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\nwhen: env != \"staging\"\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-crt", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n# Target line: 20\n\n     15:     appowners:\n     16:     - jcline\n     17:   - role: openshift/secret-file\n     18:     app: librariesio2fedmsg\n     19:     secret_name: librariesio2fedmsg-fedmsg-key\n>>>  20:     key: fedmsg-librariesio2fedmsg.key\n     21:     privatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\n     22:     when: env != \"staging\"\n     23:   - role: openshift/secret-file\n     24:     app: librariesio2fedmsg\n     25:     secret_name: librariesio2fedmsg-fedmsg-crt\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "roots_trellis-roles-common-tasks-main.yml", "content": "generate_ssh_key: yes", "line": 172, "detection_span": [167, 177], "with_context": "# Ansible file: roots_trellis-roles-common-tasks-main.yml\n\nstate: present\n168:\n169: - name: Generate SSH key for vagrant user\n170:   user:\nname: vagrant\n172:     generate_ssh_key: yes\n173:   when: env == 'development'\n174:\n175: - block:\n- name: Retrieve SSH client IP\nipify_facts:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: roots_trellis-roles-common-tasks-main.yml\n# Target line: 172\n\n    167:     state: present\n    168: \n    169: - name: Generate SSH key for vagrant user\n    170:   user:\n    171:     name: vagrant\n>>> 172:     generate_ssh_key: yes\n    173:   when: env == 'development'\n    174: \n    175: - block:\n    176:     - name: Retrieve SSH client IP\n    177:       ipify_facts:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "vijaykakkar_ansible-automation-provisioner-roles-manage_ec2_instances-defaults-main.yml", "content": "username: ec2-user", "line": 135, "detection_span": [130, 140], "with_context": "# Ansible file: vijaykakkar_ansible-automation-provisioner-roles-manage_ec2_instances-defaults-main.yml\n\nsize: t2.xlarge\nusername: ec2-user\n132:   skylight_rhel7_docs:\nfilter: 'RHEL-7.6_HVM_GA*x86_64*'\nsize: t2.xlarge\n135:     username: ec2-user\n136:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: vijaykakkar_ansible-automation-provisioner-roles-manage_ec2_instances-defaults-main.yml\n# Target line: 135\n\n    130:     size: t2.xlarge\n    131:     username: ec2-user\n    132:   skylight_rhel7_docs:\n    133:     filter: 'RHEL-7.6_HVM_GA*x86_64*'\n    134:     size: t2.xlarge\n>>> 135:     username: ec2-user\n    136: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_infrared-plugins-tripleo-overcloud-tasks-add_overcloud_host.yml", "content": "ansible_ssh_pass: \"\"", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-tripleo-overcloud-tasks-add_overcloud_host.yml\n\nadd_host:\nname: \"{{ node_info.name|lower }}\"\n# only add groups for new nodes. don't touch existing nodes' groups\ngroups: \"{{ node_groups }}\"\nansible_user: \"{{ user }}\"\n46:       ansible_ssh_pass: \"\"\nansible_host: \"{{ node_info.addresses.ctlplane[0].addr }}\"\nansible_ssh_private_key_file: \"{{ overcloud_pkey }}\"\n\n- name: add original name\nadd_host:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-tripleo-overcloud-tasks-add_overcloud_host.yml\n# Target line: 46\n\n     41:   add_host:\n     42:       name: \"{{ node_info.name|lower }}\"\n     43:       # only add groups for new nodes. don't touch existing nodes' groups\n     44:       groups: \"{{ node_groups }}\"\n     45:       ansible_user: \"{{ user }}\"\n>>>  46:       ansible_ssh_pass: \"\"\n     47:       ansible_host: \"{{ node_info.addresses.ctlplane[0].addr }}\"\n     48:       ansible_ssh_private_key_file: \"{{ overcloud_pkey }}\"\n     49: \n     50: - name: add original name\n     51:   add_host:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "keystone_auth_admin_password: secrete", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nheat_profiler_hmac_key: 4d34d11770c7e19f0259b044\nheat_service_password: 80091d299c632b6ba5a3b5\nheat_stack_domain_admin_password: 144b8c18f1963eca53e3c1571a603eed314db987a2155d\nhorizon_container_mysql_password: 063fbd22d770f4b14965b7b263be95b3963\nhorizon_secret_key: 50b00fa40b7b3e6d0547f369a0e59fa1\n23: keystone_auth_admin_password: secrete\nkeystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\nkeystone_container_mysql_password: a94e95b30824305cda80caba7cac67\nkeystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\nmemcached_encryption_key: 78a191237b291b66e23a49c3\nneutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 23\n\n     18: heat_profiler_hmac_key: 4d34d11770c7e19f0259b044\n     19: heat_service_password: 80091d299c632b6ba5a3b5\n     20: heat_stack_domain_admin_password: 144b8c18f1963eca53e3c1571a603eed314db987a2155d\n     21: horizon_container_mysql_password: 063fbd22d770f4b14965b7b263be95b3963\n     22: horizon_secret_key: 50b00fa40b7b3e6d0547f369a0e59fa1\n>>>  23: keystone_auth_admin_password: secrete\n     24: keystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\n     25: keystone_container_mysql_password: a94e95b30824305cda80caba7cac67\n     26: keystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\n     27: memcached_encryption_key: 78a191237b291b66e23a49c3\n     28: neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Grindizer_ansible-example-openshift-language_features-intermediate_example.yml", "content": "user: mdehaan", "line": 70, "detection_span": [65, 75], "with_context": "# Ansible file: Grindizer_ansible-example-openshift-language_features-intermediate_example.yml\n\n\n# any play in a playbook can be executed by a user other than root\n# if you want.  sudo support is coming too.\n\n- hosts: webservers\n70:   user: mdehaan\n\n# vars must be specified again for the next play in the playbook\n# but can be reused by including from vars_files if you want\n# you can use vars, vars_files, or both.  vars_files overrides\n# those set in vars.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Grindizer_ansible-example-openshift-language_features-intermediate_example.yml\n# Target line: 70\n\n     65: \n     66: # any play in a playbook can be executed by a user other than root\n     67: # if you want.  sudo support is coming too.\n     68: \n     69: - hosts: webservers\n>>>  70:   user: mdehaan\n     71: \n     72:   # vars must be specified again for the next play in the playbook\n     73:   # but can be reused by including from vars_files if you want\n     74:   # you can use vars, vars_files, or both.  vars_files overrides\n     75:   # those set in vars.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-training-files-2Users-SSH.yml", "content": "set_env_authorized_key: true", "line": 33, "detection_span": [28, 38], "with_context": "# Ansible file: redhat-cop_agnosticd-training-files-2Users-SSH.yml\n\nstudent_name: \"{{ guid }}-user\"          # This will be used to create a student login ID\nstudent_password: \"r3dh4t1!\"             # Customize the student password here. Keep in mind these systems may be public facing.\n\n# Environment Variables for SSH key generation and assignment\n# # set_env_authorized_key role\n33: set_env_authorized_key: true\nenv_authorized_key: \"{{guid}}key\"\n\n# bastion-lite role\ninstall_bastion_lite: true\n# Allow the use of an admin backdoor key for this machine", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-training-files-2Users-SSH.yml\n# Target line: 33\n\n     28: student_name: \"{{ guid }}-user\"          # This will be used to create a student login ID\n     29: student_password: \"r3dh4t1!\"             # Customize the student password here. Keep in mind these systems may be public facing.\n     30: \n     31: # Environment Variables for SSH key generation and assignment\n     32: # # set_env_authorized_key role\n>>>  33: set_env_authorized_key: true\n     34: env_authorized_key: \"{{guid}}key\"\n     35: \n     36: # bastion-lite role\n     37: install_bastion_lite: true\n     38: # Allow the use of an admin backdoor key for this machine\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\nnova_service_password: 054e7b1078a9f2cd\nnova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\nnova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\nrabbitmq_password: b763ef86fce7338e145c9c8c\nswift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\nswift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\nswift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41\nswift_hash_path_suffix: 27ac2b51358886b471e81cde", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 37\n\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n     34: nova_service_password: 054e7b1078a9f2cd\n     35: nova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n     36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n>>>  37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\n     38: rabbitmq_password: b763ef86fce7338e145c9c8c\n     39: swift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\n     40: swift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\n     41: swift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41\n     42: swift_hash_path_suffix: 27ac2b51358886b471e81cde\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_lpe_3scale-defaults-main.yml", "content": "ocp4_workload_lpe_3scale_smtp_userid: <changeme>", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_lpe_3scale-defaults-main.yml\n\n# smtp\nocp4_workload_lpe_3scale_smtp_host: <changeme>\nocp4_workload_lpe_3scale_smtp_port: 587\nocp4_workload_lpe_3scale_smtp_authentication: plain\nocp4_workload_lpe_3scale_smtp_domain: <changeme>\n37: ocp4_workload_lpe_3scale_smtp_userid: <changeme>\nocp4_workload_lpe_3scale_smtp_passwd: <changeme>\nocp4_workload_lpe_3scale_admin_email_user: \"3scaleadmin\"    # i.e. string before @ in your email address\nocp4_workload_lpe_3scale_admin_email_domain: \"redhat.com\"\n\nocp4_workload_lpe_3scale_apicast_services:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_lpe_3scale-defaults-main.yml\n# Target line: 37\n\n     32: # smtp\n     33: ocp4_workload_lpe_3scale_smtp_host: <changeme>\n     34: ocp4_workload_lpe_3scale_smtp_port: 587\n     35: ocp4_workload_lpe_3scale_smtp_authentication: plain\n     36: ocp4_workload_lpe_3scale_smtp_domain: <changeme>\n>>>  37: ocp4_workload_lpe_3scale_smtp_userid: <changeme>\n     38: ocp4_workload_lpe_3scale_smtp_passwd: <changeme>\n     39: ocp4_workload_lpe_3scale_admin_email_user: \"3scaleadmin\"    # i.e. string before @ in your email address\n     40: ocp4_workload_lpe_3scale_admin_email_domain: \"redhat.com\"\n     41: \n     42: ocp4_workload_lpe_3scale_apicast_services:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml", "content": "heat_rabbitmq_telemetry_userid: heat", "line": 87, "detection_span": [82, 92], "with_context": "# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n\nnova_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\nnova_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\nnova_rabbitmq_telemetry_vhost: \"/nova\"\n\nheat_rabbitmq_telemetry_host_group: \"{{ rabbitmq_host_group }}\"\n87: heat_rabbitmq_telemetry_userid: heat\nheat_rabbitmq_telemetry_password: \"{{ heat_rabbitmq_password }}\"\nheat_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\nheat_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\nheat_rabbitmq_telemetry_vhost: \"/heat\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n# Target line: 87\n\n     82: nova_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\n     83: nova_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n     84: nova_rabbitmq_telemetry_vhost: \"/nova\"\n     85: \n     86: heat_rabbitmq_telemetry_host_group: \"{{ rabbitmq_host_group }}\"\n>>>  87: heat_rabbitmq_telemetry_userid: heat\n     88: heat_rabbitmq_telemetry_password: \"{{ heat_rabbitmq_password }}\"\n     89: heat_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\n     90: heat_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n     91: heat_rabbitmq_telemetry_vhost: \"/heat\"\n     92: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-docker-build-ecommerce-ecommerce.yml", "content": "transaction_key: SET-ME-PLEASE", "line": 105, "detection_span": [100, 110], "with_context": "# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n\nsoap_api_url: https://ics2wstest.ic3.com/commerce/1.x/transactionProcessor/CyberSourceTransaction_1.140.wsdl\nsop_access_key: SET-ME-PLEASE\nsop_payment_page_url: https://testsecureacceptance.cybersource.com/silent/pay\nsop_profile_id: SET-ME-PLEASE\nsop_secret_key: SET-ME-PLEASE\n105:             transaction_key: SET-ME-PLEASE\npaypal:\ncancel_url: /checkout/cancel-checkout/\nclient_id: SET-ME-PLEASE\nclient_secret: SET-ME-PLEASE\nerror_url: /checkout/error/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n# Target line: 105\n\n    100:             soap_api_url: https://ics2wstest.ic3.com/commerce/1.x/transactionProcessor/CyberSourceTransaction_1.140.wsdl\n    101:             sop_access_key: SET-ME-PLEASE\n    102:             sop_payment_page_url: https://testsecureacceptance.cybersource.com/silent/pay\n    103:             sop_profile_id: SET-ME-PLEASE\n    104:             sop_secret_key: SET-ME-PLEASE\n>>> 105:             transaction_key: SET-ME-PLEASE\n    106:         paypal:\n    107:             cancel_url: /checkout/cancel-checkout/\n    108:             client_id: SET-ME-PLEASE\n    109:             client_secret: SET-ME-PLEASE\n    110:             error_url: /checkout/error/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "monitoring_oidc_client_secret: secret", "line": 90, "detection_span": [85, 95], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmujina_idp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\nmujina_sp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\n\nmonitoring_tests_person_id: urn:collab:person:schachome:uuid\nmonitoring_tests_password: secret\n90: monitoring_oidc_client_secret: secret\nmonitoring_tests_oidcng_client_secret: secret\nmonitoring_tests_oidcng_resource_server_secret: secret\n\nmanage_internal_api_password: secret\nmanage_backdoor_api_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 90\n\n     85: mujina_idp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\n     86: mujina_sp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\n     87: \n     88: monitoring_tests_person_id: urn:collab:person:schachome:uuid\n     89: monitoring_tests_password: secret\n>>>  90: monitoring_oidc_client_secret: secret\n     91: monitoring_tests_oidcng_client_secret: secret\n     92: monitoring_tests_oidcng_resource_server_secret: secret\n     93: \n     94: manage_internal_api_password: secret\n     95: manage_backdoor_api_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "crv4all_openshift-ansible-images-installer-root-etc-inventory-generator-config.yaml", "content": "ansible_ssh_user: ec2-user", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: crv4all_openshift-ansible-images-installer-root-etc-inventory-generator-config.yaml\n\n# meta config\nmaster_config_path: \"/opt/app-root/src/master-config.yaml\"\nadmin_kubeconfig_path: \"/opt/app-root/src/.kube/config\"\n\n# default user configuration\n7: ansible_ssh_user: ec2-user\nansible_become: \"yes\"\nansible_become_user: \"root\"\n\n# openshift-ansible inventory vars\nopenshift_uninstall_images: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-images-installer-root-etc-inventory-generator-config.yaml\n# Target line: 7\n\n      2: # meta config\n      3: master_config_path: \"/opt/app-root/src/master-config.yaml\"\n      4: admin_kubeconfig_path: \"/opt/app-root/src/.kube/config\"\n      5: \n      6: # default user configuration\n>>>   7: ansible_ssh_user: ec2-user\n      8: ansible_become: \"yes\"\n      9: ansible_become_user: \"root\"\n     10: \n     11: # openshift-ansible inventory vars\n     12: openshift_uninstall_images: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml", "content": "extended_key_usage:", "line": 162, "detection_span": [157, 167], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n\nkey_usage_critical: yes\nkey_usage:\n- Digital Signature\n- keyEncipherment\nextended_key_usage_critical: no\n162:     extended_key_usage:\n- serverAuth\ndigest: sha256\npath: \"/etc/tls/csr/arkcase-server.csr\"\nprivatekey_path: \"{{ ssl_key }}\"\ncountry_name: US", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n# Target line: 162\n\n    157:     key_usage_critical: yes\n    158:     key_usage:\n    159:       - Digital Signature\n    160:       - keyEncipherment\n    161:     extended_key_usage_critical: no\n>>> 162:     extended_key_usage:\n    163:       - serverAuth\n    164:     digest: sha256\n    165:     path: \"/etc/tls/csr/arkcase-server.csr\"\n    166:     privatekey_path: \"{{ ssl_key }}\"\n    167:     country_name: US\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "d34dh0r53_os-ansible-deployment-playbooks-roles-os_horizon-defaults-main.yml", "content": "horizon_ssl_cert_path: /etc/ssl/certs", "line": 66, "detection_span": [61, 71], "with_context": "# Ansible file: d34dh0r53_os-ansible-deployment-playbooks-roles-os_horizon-defaults-main.yml\n\n## Horizon SSL\n### Set the cacert pem if you'd like horizon to verify it.\n# horizon_cacert_pem: /path/to/cacert.pem\nhorizon_ssl_cert: /etc/ssl/certs/apache.cert\nhorizon_ssl_key: /etc/ssl/private/apache.key\n66: horizon_ssl_cert_path: /etc/ssl/certs\nhorizon_ssl_protocol: \"{{ ssl_protocol }}\"\nhorizon_ssl_cipher_suite: \"{{ ssl_cipher_suite }}\"\n\n# For multiple regions uncomment this configuration, and\n# add the extra endpoints below the first list item.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: d34dh0r53_os-ansible-deployment-playbooks-roles-os_horizon-defaults-main.yml\n# Target line: 66\n\n     61: ## Horizon SSL\n     62: ### Set the cacert pem if you'd like horizon to verify it.\n     63: # horizon_cacert_pem: /path/to/cacert.pem\n     64: horizon_ssl_cert: /etc/ssl/certs/apache.cert\n     65: horizon_ssl_key: /etc/ssl/private/apache.key\n>>>  66: horizon_ssl_cert_path: /etc/ssl/certs\n     67: horizon_ssl_protocol: \"{{ ssl_protocol }}\"\n     68: horizon_ssl_cipher_suite: \"{{ ssl_cipher_suite }}\"\n     69: \n     70: # For multiple regions uncomment this configuration, and\n     71: # add the extra endpoints below the first list item.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_casl-ansible-roles-cfme-ocp-provider-defaults-main.yml", "content": "hawkular_token:", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: redhat-cop_casl-ansible-roles-cfme-ocp-provider-defaults-main.yml\n\ncfme_username:\ncfme_password:\nocp_master_host: kubernetes.default.svc.cluster.local\nocp_master_port: 443\nocp_token:\n9: hawkular_token:\nhawkular_host: hawkular-metrics.openshift-infra.svc.cluster.local\nhawkular_port: 443\nocp_container_provier_name: OCP\ndefault_token_sa_namespace: management-infra\ndefault_token_sa_name: management-admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_casl-ansible-roles-cfme-ocp-provider-defaults-main.yml\n# Target line: 9\n\n      4: cfme_username:\n      5: cfme_password:\n      6: ocp_master_host: kubernetes.default.svc.cluster.local\n      7: ocp_master_port: 443\n      8: ocp_token:\n>>>   9: hawkular_token:\n     10: hawkular_host: hawkular-metrics.openshift-infra.svc.cluster.local\n     11: hawkular_port: 443\n     12: ocp_container_provier_name: OCP\n     13: default_token_sa_namespace: management-infra\n     14: default_token_sa_name: management-admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "shadow-robot_aurora-buildspec_teleop.yml", "content": "AWS_ACCESS_KEY : CODE_BUILD_EC2_ACCESS_KEY", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: shadow-robot_aurora-buildspec_teleop.yml\n\nversion: 0.2\n\nenv:\nparameter-store:\n5:      AWS_ACCESS_KEY : CODE_BUILD_EC2_ACCESS_KEY\nAWS_SECRET_KEY : CODE_BUILD_EC2_SECRET_KEY\nphases:\npre_build:\ncommands:\n- aws configure set aws_access_key_id $AWS_ACCESS_KEY", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: shadow-robot_aurora-buildspec_teleop.yml\n# Target line: 5\n\n      1: version: 0.2\n      2: \n      3: env:\n      4:   parameter-store:\n>>>   5:      AWS_ACCESS_KEY : CODE_BUILD_EC2_ACCESS_KEY\n      6:      AWS_SECRET_KEY : CODE_BUILD_EC2_SECRET_KEY\n      7: phases:\n      8:   pre_build:\n      9:     commands:\n     10:       - aws configure set aws_access_key_id $AWS_ACCESS_KEY\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wunderio_WunderTools-drupal-.lando.yml", "content": "webroot: web", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: wunderio_WunderTools-drupal-.lando.yml\n\nname: wunderlando\nrecipe: drupal8\n\nconfig:\n5:   webroot: web\nvia: nginx\nphp: '7.2'\ndatabase: mariadb:10.2\n\ntooling:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: wunderio_WunderTools-drupal-.lando.yml\n# Target line: 5\n\n      1: name: wunderlando\n      2: recipe: drupal8\n      3: \n      4: config:\n>>>   5:   webroot: web\n      6:   via: nginx\n      7:   php: '7.2'\n      8:   database: mariadb:10.2\n      9: \n     10: tooling:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml", "content": "key: fedmsg-librariesio2fedmsg.crt", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n\nprivatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\nwhen: env != \"staging\"\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-crt\n26:     key: fedmsg-librariesio2fedmsg.crt\nprivatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.crt\nwhen: env != \"staging\"\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n# Target line: 26\n\n     21:     privatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\n     22:     when: env != \"staging\"\n     23:   - role: openshift/secret-file\n     24:     app: librariesio2fedmsg\n     25:     secret_name: librariesio2fedmsg-fedmsg-crt\n>>>  26:     key: fedmsg-librariesio2fedmsg.crt\n     27:     privatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.crt\n     28:     when: env != \"staging\"\n     29:   - role: openshift/secret-file\n     30:     app: librariesio2fedmsg\n     31:     secret_name: librariesio2fedmsg-fedmsg-key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ashwineagle_ansible-oracle-roles-oradb-datapatch-defaults-main.yml", "content": "db_user: sys", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: ashwineagle_ansible-oracle-roles-oradb-datapatch-defaults-main.yml\n\nhostgroup: \"{{ group_names[0] }}\"\noracle_user: oracle\n\n4: db_user: sys\ndb_password: \"{% if dbpasswords is defined and dbpasswords[item.oracle_db_name] is defined and dbpasswords[item.oracle_db_name][db_user] is defined%}{{dbpasswords[item.oracle_db_name][db_user]}}{% else %}{{ default_dbpass}}{% endif%}\"\n\ndb_service_name: \"{%- if item.oracle_db_unique_name is defined -%}\n{{ item.oracle_db_unique_name }}\n{%- else -%}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ashwineagle_ansible-oracle-roles-oradb-datapatch-defaults-main.yml\n# Target line: 4\n\n      1: hostgroup: \"{{ group_names[0] }}\"\n      2: oracle_user: oracle\n      3: \n>>>   4: db_user: sys\n      5: db_password: \"{% if dbpasswords is defined and dbpasswords[item.oracle_db_name] is defined and dbpasswords[item.oracle_db_name][db_user] is defined%}{{dbpasswords[item.oracle_db_name][db_user]}}{% else %}{{ default_dbpass}}{% endif%}\"\n      6: \n      7: db_service_name: \"{%- if item.oracle_db_unique_name is defined -%}\n      8:                        {{ item.oracle_db_unique_name }}\n      9:                   {%- else -%}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wazuh_wazuh-ansible-roles-elastic-stack-ansible-kibana-tasks-main.yml", "content": "become_user: kibana", "line": 139, "detection_span": [134, 144], "with_context": "# Ansible file: wazuh_wazuh-ansible-roles-elastic-stack-ansible-kibana-tasks-main.yml\n\n134:   shell: /usr/share/kibana/node/bin/node {{ node_options }} /usr/share/kibana/src/cli/cli.js --optimize -c {{ kibana_conf_path }}/kibana.yml\n135:   args:\nexecutable: /bin/bash\ncreates: /usr/share/kibana/data/wazuh/\n138:   become: yes\n139:   become_user: kibana\n140:   tags:\n- skip_ansible_lint\n142:\n143: - name: Wait for Elasticsearch port\n144:   wait_for: host={{ elasticsearch_network_host }} port={{ elasticsearch_http_port }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: wazuh_wazuh-ansible-roles-elastic-stack-ansible-kibana-tasks-main.yml\n# Target line: 139\n\n    134:   shell: /usr/share/kibana/node/bin/node {{ node_options }} /usr/share/kibana/src/cli/cli.js --optimize -c {{ kibana_conf_path }}/kibana.yml\n    135:   args:\n    136:     executable: /bin/bash\n    137:     creates: /usr/share/kibana/data/wazuh/\n    138:   become: yes\n>>> 139:   become_user: kibana\n    140:   tags:\n    141:     - skip_ansible_lint\n    142: \n    143: - name: Wait for Elasticsearch port\n    144:   wait_for: host={{ elasticsearch_network_host }} port={{ elasticsearch_http_port }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-upgrade_v2.x_to_v3.0_eos_designs-twodc-5stage-clos-intended-structured_configs-DC1-POD2-SPINE2.yml", "content": "sha512_password: $6$eJ5TvI8oru5i9e8G$R1X/SbtGTk9xoEHEBQASc7SC2nHYmi.crVgp2pXuCXwxsXEA81e4E0cXgQ6kX08fIeQzauqhv2kS.RGJFCon5/", "line": 85, "detection_span": [80, 90], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-upgrade_v2.x_to_v3.0_eos_designs-twodc-5stage-clos-intended-structured_configs-DC1-POD2-SPINE2.yml\n\nmode: none\nlocal_users:\nadmin:\nprivilege: 15\nrole: network-admin\n85:     sha512_password: $6$eJ5TvI8oru5i9e8G$R1X/SbtGTk9xoEHEBQASc7SC2nHYmi.crVgp2pXuCXwxsXEA81e4E0cXgQ6kX08fIeQzauqhv2kS.RGJFCon5/\nvrfs:\nMGMT:\nip_routing: false\nmanagement_interfaces:\nManagement1:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-upgrade_v2.x_to_v3.0_eos_designs-twodc-5stage-clos-intended-structured_configs-DC1-POD2-SPINE2.yml\n# Target line: 85\n\n     80:   mode: none\n     81: local_users:\n     82:   admin:\n     83:     privilege: 15\n     84:     role: network-admin\n>>>  85:     sha512_password: $6$eJ5TvI8oru5i9e8G$R1X/SbtGTk9xoEHEBQASc7SC2nHYmi.crVgp2pXuCXwxsXEA81e4E0cXgQ6kX08fIeQzauqhv2kS.RGJFCon5/\n     86: vrfs:\n     87:   MGMT:\n     88:     ip_routing: false\n     89: management_interfaces:\n     90:   Management1:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_infra-ansible-roles-osp-packstack-install-tasks-sync-keys.yml", "content": "dest: \"/tmp/id_rsa\"", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: redhat-cop_infra-ansible-roles-osp-packstack-install-tasks-sync-keys.yml\n\n---\n\n- name: 'Fetch the private SSH key from the first host'\nfetch:\nsrc: \"~/.ssh/id_rsa\"\n6:     dest: \"/tmp/id_rsa\"\nflat: yes\nrun_once: true\ndelegate_to: \"{{ ansible_play_hosts | first }}\"\n\n- name: 'Fetch the public SSH key from the first host'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_infra-ansible-roles-osp-packstack-install-tasks-sync-keys.yml\n# Target line: 6\n\n      1: ---\n      2: \n      3: - name: 'Fetch the private SSH key from the first host'\n      4:   fetch:\n      5:     src: \"~/.ssh/id_rsa\"\n>>>   6:     dest: \"/tmp/id_rsa\"\n      7:     flat: yes\n      8:   run_once: true\n      9:   delegate_to: \"{{ ansible_play_hosts | first }}\"\n     10: \n     11: - name: 'Fetch the public SSH key from the first host'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ynya_ansible-language_features-netscaler.yml", "content": "nsc_pass: nimda", "line": 11, "detection_span": [6, 16], "with_context": "# Ansible file: ynya_ansible-language_features-netscaler.yml\n\n- hosts: web-pool\nserial: 3\nvars:\nnsc_host: nsc.example.com\nnsc_user: admin\n11:     nsc_pass: nimda\n# type of the netscaler object you want to manipulate\ntype: service\n# netscaler object name\nname: \"{{facter_fqdn}}:8080\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ynya_ansible-language_features-netscaler.yml\n# Target line: 11\n\n      6: - hosts: web-pool\n      7:   serial: 3\n      8:   vars:\n      9:     nsc_host: nsc.example.com\n     10:     nsc_user: admin\n>>>  11:     nsc_pass: nimda\n     12:     # type of the netscaler object you want to manipulate\n     13:     type: service\n     14:     # netscaler object name\n     15:     name: \"{{facter_fqdn}}:8080\"\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sivabayya_ansible-provisioner-roles-geerlingguy.gitlab-defaults-main.yml", "content": "gitlab_smtp_user_name: \"smtp user\"", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: sivabayya_ansible-provisioner-roles-geerlingguy.gitlab-defaults-main.yml\n\n\n# SMTP Configuration\ngitlab_smtp_enable: \"false\"\ngitlab_smtp_address: \"smtp.server\"\ngitlab_smtp_port: \"465\"\n34: gitlab_smtp_user_name: \"smtp user\"\ngitlab_smtp_password: \"smtp password\"\ngitlab_smtp_domain: \"example.com\"\ngitlab_smtp_authentication: \"login\"\ngitlab_smtp_enable_starttls_auto: \"true\"\ngitlab_smtp_tls: \"false\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sivabayya_ansible-provisioner-roles-geerlingguy.gitlab-defaults-main.yml\n# Target line: 34\n\n     29: \n     30: # SMTP Configuration\n     31: gitlab_smtp_enable: \"false\"\n     32: gitlab_smtp_address: \"smtp.server\"\n     33: gitlab_smtp_port: \"465\"\n>>>  34: gitlab_smtp_user_name: \"smtp user\"\n     35: gitlab_smtp_password: \"smtp password\"\n     36: gitlab_smtp_domain: \"example.com\"\n     37: gitlab_smtp_authentication: \"login\"\n     38: gitlab_smtp_enable_starttls_auto: \"true\"\n     39: gitlab_smtp_tls: \"false\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml", "content": "- doc_root: \"/var/local/versailles\"", "line": 47, "detection_span": [42, 52], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n\n- doc_root: \"/var/local/njmaps\"\ngit_repo: 'https://github.com/pulibrary/njmaps_exhibit_archive.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'njmaps'\n47:     - doc_root: \"/var/local/versailles\"\ngit_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'versailles'\n- doc_root: \"/var/local/visual_materials\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n# Target line: 47\n\n     42:     - doc_root: \"/var/local/njmaps\"\n     43:       git_repo: 'https://github.com/pulibrary/njmaps_exhibit_archive.git'\n     44:       options: 'Indexes FollowSymLinks MultiViews'\n     45:       version: 'main'\n     46:       alias: 'njmaps'\n>>>  47:     - doc_root: \"/var/local/versailles\"\n     48:       git_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\n     49:       options: 'Indexes FollowSymLinks MultiViews'\n     50:       version: 'main'\n     51:       alias: 'versailles'\n     52:     - doc_root: \"/var/local/visual_materials\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ARTbio_GalaxyKickStart-.github-workflows-ci.yaml", "content": "BIOBLEND_GALAXY_API_KEY: \"artbio2020\"", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: ARTbio_GalaxyKickStart-.github-workflows-ci.yaml\n\n- readthedocs\n- master\nenv:\nGALAXY_USER: admin@galaxy.org\nGALAXY_USER_PASSWD: artbio2020\n10:   BIOBLEND_GALAXY_API_KEY: \"artbio2020\"\nBIOBLEND_GALAXY_URL: \"http://127.0.0.1:80\"\n\n\njobs:\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ARTbio_GalaxyKickStart-.github-workflows-ci.yaml\n# Target line: 10\n\n      5:       - readthedocs\n      6:       - master\n      7: env:\n      8:   GALAXY_USER: admin@galaxy.org\n      9:   GALAXY_USER_PASSWD: artbio2020\n>>>  10:   BIOBLEND_GALAXY_API_KEY: \"artbio2020\"\n     11:   BIOBLEND_GALAXY_URL: \"http://127.0.0.1:80\"\n     12: \n     13: \n     14: jobs:\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "trilioData_triliovault-cfg-scripts-redhat-director-scripts-rhosp16-environments-trilio_env.yaml", "content": "TrilioDatamoverPassword: \"test1234\"", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: trilioData_triliovault-cfg-scripts-redhat-director-scripts-rhosp16-environments-trilio_env.yaml\n\n## Define network map for trilio datamover api service\nServiceNetMap:\nTrilioDatamoverApiNetwork: internal_api\n\n## TrilioVault Datamover Password for keystone and database\n19:    TrilioDatamoverPassword: \"test1234\"\n\n## TrilioVault container pull urls\nDockerTrilioDatamoverImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover:4.0.41-rhosp16\nDockerTrilioDmApiImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover-api:4.0.41-rhosp16\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trilioData_triliovault-cfg-scripts-redhat-director-scripts-rhosp16-environments-trilio_env.yaml\n# Target line: 19\n\n     14:    ## Define network map for trilio datamover api service\n     15:    ServiceNetMap:\n     16:        TrilioDatamoverApiNetwork: internal_api\n     17: \n     18:    ## TrilioVault Datamover Password for keystone and database\n>>>  19:    TrilioDatamoverPassword: \"test1234\"\n     20: \n     21:    ## TrilioVault container pull urls\n     22:    DockerTrilioDatamoverImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover:4.0.41-rhosp16\n     23:    DockerTrilioDmApiImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover-api:4.0.41-rhosp16\n     24: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml", "content": "matrix_mx_puppet_twitter_login_shared_secret: ''", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n\n\nmatrix_mx_puppet_twitter_appservice_token: ''\nmatrix_mx_puppet_twitter_homeserver_token: ''\n\n# Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\n64: matrix_mx_puppet_twitter_login_shared_secret: ''\n\n# Database configuration\nmatrix_mx_puppet_twitter_database_engine: sqlite\n\nmatrix_mx_puppet_twitter_sqlite_database_path_local: \"{{ matrix_mx_puppet_twitter_data_path }}/database.db\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n# Target line: 64\n\n     59: \n     60: matrix_mx_puppet_twitter_appservice_token: ''\n     61: matrix_mx_puppet_twitter_homeserver_token: ''\n     62: \n     63: # Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\n>>>  64: matrix_mx_puppet_twitter_login_shared_secret: ''\n     65: \n     66: # Database configuration\n     67: matrix_mx_puppet_twitter_database_engine: sqlite\n     68: \n     69: matrix_mx_puppet_twitter_sqlite_database_path_local: \"{{ matrix_mx_puppet_twitter_data_path }}/database.db\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Alfresco_alfresco-ansible-deployment-roles-nginx-vars-ssl.yml", "content": "root: \"/usr/share/nginx/html\"", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: Alfresco_alfresco-ansible-deployment-roles-nginx-vars-ssl.yml\n\nserver_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\ntemplate: \"alfresco_redirect.conf.j2\"\nfilename: \"alfresco.conf\"\n- listen: \"443\"\nserver_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\n8:     root: \"/usr/share/nginx/html\"\nindex: \"index.html index.htm\"\nfilename: \"ssl.{{ fqdn_alfresco }}.conf\"\ncert_crt: \"{{ fqdn_alfresco }}.crt\"\ncert_key: \"{{ fqdn_alfresco }}.key\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Alfresco_alfresco-ansible-deployment-roles-nginx-vars-ssl.yml\n# Target line: 8\n\n      3:     server_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\n      4:     template: \"alfresco_redirect.conf.j2\"\n      5:     filename: \"alfresco.conf\"\n      6:   - listen: \"443\"\n      7:     server_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\n>>>   8:     root: \"/usr/share/nginx/html\"\n      9:     index: \"index.html index.htm\"\n     10:     filename: \"ssl.{{ fqdn_alfresco }}.conf\"\n     11:     cert_crt: \"{{ fqdn_alfresco }}.crt\"\n     12:     cert_key: \"{{ fqdn_alfresco }}.key\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "IBM_community-automation-ansible-request-rhel-jmeter-fyre-play-jmeter-play.yml", "content": "- ansible_user: root", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: IBM_community-automation-ansible-request-rhel-jmeter-fyre-play-jmeter-play.yml\n\n---\n\n- hosts: all\nvars:\n5:   - ansible_user: root\nroles:\n- role: podman\n\n- hosts: all\nvars:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_community-automation-ansible-request-rhel-jmeter-fyre-play-jmeter-play.yml\n# Target line: 5\n\n      1: ---\n      2: \n      3: - hosts: all\n      4:   vars:\n>>>   5:   - ansible_user: root\n      6:   roles:\n      7:   - role: podman\n      8: \n      9: - hosts: all\n     10:   vars:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml", "content": "key: crt", "line": 84, "detection_span": [79, 89], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n\nkey: password\n- name: EC_CRT\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\n84:                 key: crt\n- name: EC_CA\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\nkey: ca", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n# Target line: 84\n\n     79:                 key: password\n     80:           - name: EC_CRT\n     81:             valueFrom:\n     82:               secretKeyRef:\n     83:                 name: \"${EC_SECRET_CRT}\"\n>>>  84:                 key: crt\n     85:           - name: EC_CA\n     86:             valueFrom:\n     87:               secretKeyRef:\n     88:                 name: \"${EC_SECRET_CRT}\"\n     89:                 key: ca\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "lumir-sliva_ceph-ansible-infrastructure-playbooks-rgw-add-users-buckets.yml", "content": "user: 'test2'", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: lumir-sliva_ceph-ansible-infrastructure-playbooks-rgw-add-users-buckets.yml\n\n- bucket: 'bucket6'\nuser: 'test2'\n- bucket: 'bucket7'\nuser: 'test2'\n- bucket: 'bucket8'\n61:           user: 'test2'\n- bucket: 'bucket9'\nuser: 'test2'\n- bucket: 'bucket10'\nuser: 'test2'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: lumir-sliva_ceph-ansible-infrastructure-playbooks-rgw-add-users-buckets.yml\n# Target line: 61\n\n     56:         - bucket: 'bucket6'\n     57:           user: 'test2'\n     58:         - bucket: 'bucket7'\n     59:           user: 'test2'\n     60:         - bucket: 'bucket8'\n>>>  61:           user: 'test2'\n     62:         - bucket: 'bucket9'\n     63:           user: 'test2'\n     64:         - bucket: 'bucket10'\n     65:           user: 'test2'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CentOS-PaaS-SIG_linchpin-linchpin-provision-roles-aws-tasks-provision_aws_ec2_vpc_routetable.yml", "content": "- {key: 'Name', value: \"{{ res_def['name'] }}\"}", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: CentOS-PaaS-SIG_linchpin-linchpin-provision-roles-aws-tasks-provision_aws_ec2_vpc_routetable.yml\n\n- name: Append  name to tags\nset_fact:\nroutetable_tags: \"{{ routetable_tags |\ncombine({routekey.key: routekey.value}) }}\"\nwith_items:\n46:     - {key: 'Name', value: \"{{ res_def['name'] }}\"}\nloop_control:\nloop_var: routekey\n\n- name: \"Provision/teardown AWS_EC2_VPC_ROUTETABLE\"\nec2_vpc_route_table:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: CentOS-PaaS-SIG_linchpin-linchpin-provision-roles-aws-tasks-provision_aws_ec2_vpc_routetable.yml\n# Target line: 46\n\n     41: - name: Append  name to tags\n     42:   set_fact:\n     43:     routetable_tags: \"{{ routetable_tags |\n     44:                          combine({routekey.key: routekey.value}) }}\"\n     45:   with_items:\n>>>  46:     - {key: 'Name', value: \"{{ res_def['name'] }}\"}\n     47:   loop_control:\n     48:     loop_var: routekey\n     49: \n     50: - name: \"Provision/teardown AWS_EC2_VPC_ROUTETABLE\"\n     51:   ec2_vpc_route_table:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-eu_infrastructure-playbook-group_vars-all.yml", "content": "- /etc/ssh/ssh_host_rsa_key-cert.pub", "line": 128, "detection_span": [123, 133], "with_context": "# Ansible file: usegalaxy-eu_infrastructure-playbook-group_vars-all.yml\n\n123: # SSH\n124:\n125: # ALL hosts should have signed SSH keys.\n126: # ssh-host-(re)sign role\n127: ssh_host_key_cert_files:\n128:   - /etc/ssh/ssh_host_rsa_key-cert.pub\n129:   - /etc/ssh/ssh_host_ecdsa_key-cert.pub\n130:   - /etc/ssh/ssh_host_ed25519_key-cert.pub\n131:\n132: # dev-sec.ssh-hardening role\n133: # Allow root login on all machines", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-eu_infrastructure-playbook-group_vars-all.yml\n# Target line: 128\n\n    123: # SSH\n    124: \n    125: # ALL hosts should have signed SSH keys.\n    126: # ssh-host-(re)sign role\n    127: ssh_host_key_cert_files:\n>>> 128:   - /etc/ssh/ssh_host_rsa_key-cert.pub\n    129:   - /etc/ssh/ssh_host_ecdsa_key-cert.pub\n    130:   - /etc/ssh/ssh_host_ed25519_key-cert.pub\n    131: \n    132: # dev-sec.ssh-hardening role\n    133: # Allow root login on all machines\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml", "content": "nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem", "line": 45, "detection_span": [40, 50], "with_context": "# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n\n\n## used by: galaxyproject.galaxy\nnginx_srv: /srv/nginx\nnginx_ssl_role: usegalaxy_eu.certbot\nnginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n45: nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n\ncertbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\ncertbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\ncertbot_auth_method: --webroot\ncertbot_install_method: virtualenv", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n# Target line: 45\n\n     40: \n     41: ## used by: galaxyproject.galaxy\n     42: nginx_srv: /srv/nginx\n     43: nginx_ssl_role: usegalaxy_eu.certbot\n     44: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n>>>  45: nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n     46: \n     47: certbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\n     48: certbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\n     49: certbot_auth_method: --webroot\n     50: certbot_install_method: virtualenv\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "RedHatGov_redhatgov.workshops-rhel_edge_aws-group_vars-all_example.yml", "content": "letsencrypt:                      false", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: RedHatGov_redhatgov.workshops-rhel_edge_aws-group_vars-all_example.yml\n\nrhsm_activationkey:               \"\"\nrhsm_org_id:                      \"\"\n#------------------------------------------------------------------------------\n# LetsEncrypt              |      email\nletsencrypt_email:                \"someone@redhat.com\"\n61: letsencrypt:                      false\n#------------------------------------------------------------------------------\n# console                  |      password\nworkshop_password:                \"\" # Note that Windows 2016 requires 3 character classes and 10 characters\n#------------------------------------------------------------------------------\n# ports to open            |      Add any ports that you may need to this dict", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: RedHatGov_redhatgov.workshops-rhel_edge_aws-group_vars-all_example.yml\n# Target line: 61\n\n     56: rhsm_activationkey:               \"\"\n     57: rhsm_org_id:                      \"\"\n     58: #------------------------------------------------------------------------------\n     59: # LetsEncrypt              |      email\n     60: letsencrypt_email:                \"someone@redhat.com\"\n>>>  61: letsencrypt:                      false\n     62: #------------------------------------------------------------------------------\n     63: # console                  |      password\n     64: workshop_password:                \"\" # Note that Windows 2016 requires 3 character classes and 10 characters\n     65: #------------------------------------------------------------------------------\n     66: # ports to open            |      Add any ports that you may need to this dict\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml", "content": "nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n\n\n\n## used by: galaxyproject.galaxy\nnginx_srv: /srv/nginx\nnginx_ssl_role: usegalaxy_eu.certbot\n44: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\nnginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n\ncertbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\ncertbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\ncertbot_auth_method: --webroot", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n# Target line: 44\n\n     39: \n     40: \n     41: ## used by: galaxyproject.galaxy\n     42: nginx_srv: /srv/nginx\n     43: nginx_ssl_role: usegalaxy_eu.certbot\n>>>  44: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n     45: nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n     46: \n     47: certbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\n     48: certbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\n     49: certbot_auth_method: --webroot\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-dev_slurm.yml", "content": "auth_key_user: ubuntu", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-dev_slurm.yml\n\n\n2: auth_key_user: ubuntu\n\nhead_nodes: \"{{ groups['dev_slurm_head'] }}\"\nworker_nodes: \"{{ groups['dev_workers'] }}\"\ngalaxy_nodes: \"{{ groups['dev_galaxy_server'] }}\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-dev_slurm.yml\n# Target line: 2\n\n      1: \n>>>   2: auth_key_user: ubuntu\n      3: \n      4: head_nodes: \"{{ groups['dev_slurm_head'] }}\"\n      5: worker_nodes: \"{{ groups['dev_workers'] }}\"\n      6: galaxy_nodes: \"{{ groups['dev_galaxy_server'] }}\"\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cyverse_atmosphere-ansible-ansible-playbooks-instance_deploy-50_shell_access.yml", "content": "EXTERNAL_HOST_KEY_GROUP: root", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: cyverse_atmosphere-ansible-ansible-playbooks-instance_deploy-50_shell_access.yml\n\nhosts: all\nvars:\nEXTERNAL_HOST_KEY_NAME: \"id_rsa_gateone\"\nEXTERNAL_HOST_KEY_DIR: \"/var/lib/gateone/users/{{ ATMOUSERNAME }}/.ssh\"\nEXTERNAL_HOST_KEY_OWNER: root\n8:     EXTERNAL_HOST_KEY_GROUP: root\nEXTERNAL_HOST: \"shell\"\nUSERNAME: \"{{ ATMOUSERNAME }}\"\nroles:\n- { role: \"sshkey-host-access\", when: (SETUP_GUACAMOLE | default(true)) == false }\ntasks:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cyverse_atmosphere-ansible-ansible-playbooks-instance_deploy-50_shell_access.yml\n# Target line: 8\n\n      3:   hosts: all\n      4:   vars:\n      5:     EXTERNAL_HOST_KEY_NAME: \"id_rsa_gateone\"\n      6:     EXTERNAL_HOST_KEY_DIR: \"/var/lib/gateone/users/{{ ATMOUSERNAME }}/.ssh\"\n      7:     EXTERNAL_HOST_KEY_OWNER: root\n>>>   8:     EXTERNAL_HOST_KEY_GROUP: root\n      9:     EXTERNAL_HOST: \"shell\"\n     10:     USERNAME: \"{{ ATMOUSERNAME }}\"\n     11:   roles:\n     12:     - { role: \"sshkey-host-access\", when: (SETUP_GUACAMOLE | default(true)) == false }\n     13:   tasks:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ComplianceAsCode_content-products-jre-product.yml", "content": "benchmark_root: \"./guide\"", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n\nproduct: jre\nfull_name: Java Runtime Environment\ntype: product\n\nbenchmark_id: JRE\n6: benchmark_root: \"./guide\"\n\nprofiles_root: \"./profiles\"\n\npkg_manager: \"yum\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n# Target line: 6\n\n      1: product: jre\n      2: full_name: Java Runtime Environment\n      3: type: product\n      4: \n      5: benchmark_id: JRE\n>>>   6: benchmark_root: \"./guide\"\n      7: \n      8: profiles_root: \"./profiles\"\n      9: \n     10: pkg_manager: \"yum\"\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-steam-defaults-main.yml", "content": "matrix_mx_puppet_steam_database_username: matrix_mx_puppet_steam", "line": 62, "detection_span": [57, 67], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-steam-defaults-main.yml\n\nmatrix_mx_puppet_steam_database_engine: sqlite\n\nmatrix_mx_puppet_steam_sqlite_database_path_local: \"{{ matrix_mx_puppet_steam_data_path }}/database.db\"\nmatrix_mx_puppet_steam_sqlite_database_path_in_container: \"/data/database.db\"\n\n62: matrix_mx_puppet_steam_database_username: matrix_mx_puppet_steam\nmatrix_mx_puppet_steam_database_password: ~\nmatrix_mx_puppet_steam_database_hostname: 'matrix-postgres'\nmatrix_mx_puppet_steam_database_port: 5432\nmatrix_mx_puppet_steam_database_name: matrix_mx_puppet_steam\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-steam-defaults-main.yml\n# Target line: 62\n\n     57: matrix_mx_puppet_steam_database_engine: sqlite\n     58: \n     59: matrix_mx_puppet_steam_sqlite_database_path_local: \"{{ matrix_mx_puppet_steam_data_path }}/database.db\"\n     60: matrix_mx_puppet_steam_sqlite_database_path_in_container: \"/data/database.db\"\n     61: \n>>>  62: matrix_mx_puppet_steam_database_username: matrix_mx_puppet_steam\n     63: matrix_mx_puppet_steam_database_password: ~\n     64: matrix_mx_puppet_steam_database_hostname: 'matrix-postgres'\n     65: matrix_mx_puppet_steam_database_port: 5432\n     66: matrix_mx_puppet_steam_database_name: matrix_mx_puppet_steam\n     67: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-default_vars_osp.yml", "content": "install_student_user: false", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-default_vars_osp.yml\n\n### OSP Environment variables\n################################################################################\n\n\ncloud_provider: osp\n7: install_student_user: false\n\n\nansible_user: cloud-user\nremote_user: cloud-user\nosp_cluster_dns_zone: red.osp.opentlc.com", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-default_vars_osp.yml\n# Target line: 7\n\n      2: ### OSP Environment variables\n      3: ################################################################################\n      4: \n      5: \n      6: cloud_provider: osp                               \n>>>   7: install_student_user: false\n      8: \n      9: \n     10: ansible_user: cloud-user\n     11: remote_user: cloud-user\n     12: osp_cluster_dns_zone: red.osp.opentlc.com\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OnrampLab_laravel-starter-tools-infrastructure-vm-based-provisioning-ansible-provision-production.yml", "content": "phpmyadmin_user: admin", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: OnrampLab_laravel-starter-tools-infrastructure-vm-based-provisioning-ansible-provision-production.yml\n\ncertbot_email: myemail@email.com\n- role: phpmyadmin\ntags: [ 'phpmyadmin' ]\nphpmyadmin_database: phpmyadmin\nphpmyadmin_server_ip: localhost\n14:         phpmyadmin_user: admin\nphpmyadmin_password: mypassword\nphpmyadmin_client_ip: pma.laravel-starter.com\nphpmyadmin_hostname: pma.laravel-starter.com\ncertbot_email: myemail@email.com\n- role: oefenweb.yarn", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OnrampLab_laravel-starter-tools-infrastructure-vm-based-provisioning-ansible-provision-production.yml\n# Target line: 14\n\n      9:         certbot_email: myemail@email.com\n     10:       - role: phpmyadmin\n     11:         tags: [ 'phpmyadmin' ]\n     12:         phpmyadmin_database: phpmyadmin\n     13:         phpmyadmin_server_ip: localhost\n>>>  14:         phpmyadmin_user: admin\n     15:         phpmyadmin_password: mypassword\n     16:         phpmyadmin_client_ip: pma.laravel-starter.com\n     17:         phpmyadmin_hostname: pma.laravel-starter.com\n     18:         certbot_email: myemail@email.com\n     19:       - role: oefenweb.yarn\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-roles-ufmonitor-defaults-main.yml", "content": "ufmonitor_db_user: \"ufmonitor\"", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: tmzullinger_fedora-ansible-roles-ufmonitor-defaults-main.yml\n\napiserver_container_image: \"docker.io/fedoraqa/ufmonitor-apiserver:latest\"\nupdater_container_image: \"docker.io/fedoraqa/ufmonitor-updater:latest\"\nufmonitor_db_host: \"172.17.0.1\"\nufmonitor_db_name: \"ufmonitor\"\n5: ufmonitor_db_user: \"ufmonitor\"\nufmonitor_db_password: \"terribleinsecurepassword\"\nufmonitor_config_path: \"/etc/sysconfig/ufmonitor\"\nufmonitor_home: \"/var/www/ufmonitor\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-roles-ufmonitor-defaults-main.yml\n# Target line: 5\n\n      1: apiserver_container_image: \"docker.io/fedoraqa/ufmonitor-apiserver:latest\"\n      2: updater_container_image: \"docker.io/fedoraqa/ufmonitor-updater:latest\"\n      3: ufmonitor_db_host: \"172.17.0.1\"\n      4: ufmonitor_db_name: \"ufmonitor\"\n>>>   5: ufmonitor_db_user: \"ufmonitor\"\n      6: ufmonitor_db_password: \"terribleinsecurepassword\"\n      7: ufmonitor_config_path: \"/etc/sysconfig/ufmonitor\"\n      8: ufmonitor_home: \"/var/www/ufmonitor\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dimagi_commcare-cloud-changelog-0010-letsencrypt-restart-nginx.yml", "content": "key: letsencrypt-restart-nginx", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: dimagi_commcare-cloud-changelog-0010-letsencrypt-restart-nginx.yml\n\ntitle: Restart nginx after every letsencrypt cert auto-renewal\n2: key: letsencrypt-restart-nginx\ndate: 2019-01-02\n\noptional_per_env: yes\n\nmin_commcare_version:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dimagi_commcare-cloud-changelog-0010-letsencrypt-restart-nginx.yml\n# Target line: 2\n\n      1: title: Restart nginx after every letsencrypt cert auto-renewal\n>>>   2: key: letsencrypt-restart-nginx\n      3: date: 2019-01-02\n      4: \n      5: optional_per_env: yes\n      6: \n      7: min_commcare_version:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml", "content": "- doc_root: \"/var/local/visual_materials\"", "line": 52, "detection_span": [47, 57], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n\n- doc_root: \"/var/local/versailles\"\ngit_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'versailles'\n52:     - doc_root: \"/var/local/visual_materials\"\ngit_repo: 'git@github.com:PrincetonUniversityLibrary/visual_materials.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'visual_materials'\nssh_opts: -i /home/deploy/.ssh/id_rsa -o StrictHostKeyChecking=no", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n# Target line: 52\n\n     47:     - doc_root: \"/var/local/versailles\"\n     48:       git_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\n     49:       options: 'Indexes FollowSymLinks MultiViews'\n     50:       version: 'main'\n     51:       alias: 'versailles'\n>>>  52:     - doc_root: \"/var/local/visual_materials\"\n     53:       git_repo: 'git@github.com:PrincetonUniversityLibrary/visual_materials.git'\n     54:       options: 'Indexes FollowSymLinks MultiViews'\n     55:       version: 'main'\n     56:       alias: 'visual_materials'\n     57:       ssh_opts: -i /home/deploy/.ssh/id_rsa -o StrictHostKeyChecking=no\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_create_admin-tasks-distribute_key_files.yml", "content": "dest: /home/{{ tripleo_admin_user }}/.ssh/id_rsa", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_create_admin-tasks-distribute_key_files.yml\n\n# License for the specific language governing permissions and limitations\n# under the License.\n\n- name: Install private key on nodes for user {{ tripleo_admin_user }}\ncopy:\n19:     dest: /home/{{ tripleo_admin_user }}/.ssh/id_rsa\ncontent: \"{{ tripleo_admin_prikey }}\"\nowner: \"{{ tripleo_admin_user }}\"\ngroup: \"{{ tripleo_admin_user }}\"\nmode: '0600'\nwhen:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_create_admin-tasks-distribute_key_files.yml\n# Target line: 19\n\n     14: # License for the specific language governing permissions and limitations\n     15: # under the License.\n     16: \n     17: - name: Install private key on nodes for user {{ tripleo_admin_user }}\n     18:   copy:\n>>>  19:     dest: /home/{{ tripleo_admin_user }}/.ssh/id_rsa\n     20:     content: \"{{ tripleo_admin_prikey }}\"\n     21:     owner: \"{{ tripleo_admin_user }}\"\n     22:     group: \"{{ tripleo_admin_user }}\"\n     23:     mode: '0600'\n     24:   when:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-playbooks-manual-upgrade-koschei.yml", "content": "become_user: koschei", "line": 60, "detection_span": [55, 65], "with_context": "# Ansible file: tmzullinger_fedora-ansible-playbooks-manual-upgrade-koschei.yml\n\n- name: run DB migration\nhosts: \"{{ koschei_backend_hosts | default('koschei-backend:koschei-backend-stg') }}\"\ntasks:\n- name: run db migration\nbecome: yes\n60:     become_user: koschei\ncommand: koschei-admin alembic upgrade head\n\n- name: restart httpd\nhosts: \"{{ koschei_web_hosts | default('koschei-web:koschei-web-stg') }}\"\nvars_files:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-playbooks-manual-upgrade-koschei.yml\n# Target line: 60\n\n     55: - name: run DB migration\n     56:   hosts: \"{{ koschei_backend_hosts | default('koschei-backend:koschei-backend-stg') }}\"\n     57:   tasks:\n     58:   - name: run db migration\n     59:     become: yes\n>>>  60:     become_user: koschei\n     61:     command: koschei-admin alembic upgrade head\n     62: \n     63: - name: restart httpd\n     64:   hosts: \"{{ koschei_web_hosts | default('koschei-web:koschei-web-stg') }}\"\n     65:   vars_files:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "neki06_kolla-ansible-ansible-roles-octavia-defaults-main.yml", "content": "octavia_keystone_user: \"octavia\"", "line": 83, "detection_span": [78, 88], "with_context": "# Ansible file: neki06_kolla-ansible-ansible-roles-octavia-defaults-main.yml\n\noctavia_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ octavia_api_port }}\"\noctavia_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ octavia_api_port }}\"\n\noctavia_logging_debug: \"{{ openstack_logging_debug }}\"\n\n83: octavia_keystone_user: \"octavia\"\n\nopenstack_octavia_auth: \"{{ openstack_auth }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: neki06_kolla-ansible-ansible-roles-octavia-defaults-main.yml\n# Target line: 83\n\n     78: octavia_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ octavia_api_port }}\"\n     79: octavia_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ octavia_api_port }}\"\n     80: \n     81: octavia_logging_debug: \"{{ openstack_logging_debug }}\"\n     82: \n>>>  83: octavia_keystone_user: \"octavia\"\n     84: \n     85: openstack_octavia_auth: \"{{ openstack_auth }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Ansible-roles-glassfish-tasks-glassfish.yml", "content": "become_user: liferayadmin", "line": 40, "detection_span": [35, 45], "with_context": "# Ansible file: AAROC_DevOps-Ansible-roles-glassfish-tasks-glassfish.yml\n\ndest: /home/liferayadmin/glassfish-3.1.2.2.zip\nwhen: glassfish_stat.stat.exists | bool != True\n\n- name: extract the zip\nbecome: true\n40:   become_user: liferayadmin\n#  unarchive: src=/home/liferayadmin/glassfish-3.1.2.2.zip  dest=/opt/glassfish copy=no creates=/opt/glassfish/glassfish3/glassfish/bin/asadmin\ncommand: \"/usr/bin/unzip -d /opt/glassfish glassfish-3.1.2.2.zip creates=/opt/glassfish/glassfish3/\"\nwhen: asadmin_stat.stat.exists == false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Ansible-roles-glassfish-tasks-glassfish.yml\n# Target line: 40\n\n     35:     dest: /home/liferayadmin/glassfish-3.1.2.2.zip\n     36:   when: glassfish_stat.stat.exists | bool != True\n     37: \n     38: - name: extract the zip\n     39:   become: true\n>>>  40:   become_user: liferayadmin\n     41: #  unarchive: src=/home/liferayadmin/glassfish-3.1.2.2.zip  dest=/opt/glassfish copy=no creates=/opt/glassfish/glassfish3/glassfish/bin/asadmin\n     42:   command: \"/usr/bin/unzip -d /opt/glassfish glassfish-3.1.2.2.zip creates=/opt/glassfish/glassfish3/\"\n     43:   when: asadmin_stat.stat.exists == false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tungstenfabric_tf-ansible-deployer-playbooks-roles-contrail_deployer-defaults-main.yml", "content": "KEYSTONE_AUTH_ADMIN_USER: admin", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-contrail_deployer-defaults-main.yml\n\n- mesos\n- vcenter\n- none\ncontrail_configuration_keystone_default:\nKEYSTONE_AUTH_ADMIN_TENANT: admin\n9:   KEYSTONE_AUTH_ADMIN_USER: admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-contrail_deployer-defaults-main.yml\n# Target line: 9\n\n      4:   - mesos\n      5:   - vcenter\n      6:   - none\n      7: contrail_configuration_keystone_default:\n      8:   KEYSTONE_AUTH_ADMIN_TENANT: admin\n>>>   9:   KEYSTONE_AUTH_ADMIN_USER: admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml", "content": "key: this-file-does-not-exist-and-must-be-overridden", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n\ncert: this-file-does-not-exist-and-must-be-overridden\n2: key: this-file-does-not-exist-and-must-be-overridden", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n# Target line: 2\n\n      1: cert: this-file-does-not-exist-and-must-be-overridden\n>>>   2: key: this-file-does-not-exist-and-must-be-overridden\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml", "content": "minio_access_key: sandbox-minio-access", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n\n# normal circumstances.\nminio_namespace: minio\nminio_credential_secret: minio-credentials\nminio_service_name: minio-service\nminio_route_name: minio\n49: minio_access_key: sandbox-minio-access\nminio_secret_key: sandbox-minio-secret\nminio_bucket_name: threescale\nminio_bucket_region: us-east-1\nminio_pvc_size: 1Gi\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n# Target line: 49\n\n     44: # normal circumstances.\n     45: minio_namespace: minio\n     46: minio_credential_secret: minio-credentials\n     47: minio_service_name: minio-service\n     48: minio_route_name: minio\n>>>  49: minio_access_key: sandbox-minio-access\n     50: minio_secret_key: sandbox-minio-secret\n     51: minio_bucket_name: threescale\n     52: minio_bucket_region: us-east-1\n     53: minio_pvc_size: 1Gi\n     54: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Shwetas25_ansiblenew-jboss-standalone-site.yml", "content": "remote_user: ansible", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: Shwetas25_ansiblenew-jboss-standalone-site.yml\n\n---\n# This playbook deploys a simple standalone JBoss server.\n\n- hosts: all\n5:   remote_user: ansible\nsudo: yes\n\nroles:\n- jboss-standalone", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Shwetas25_ansiblenew-jboss-standalone-site.yml\n# Target line: 5\n\n      1: ---\n      2: # This playbook deploys a simple standalone JBoss server. \n      3: \n      4: - hosts: all\n>>>   5:   remote_user: ansible\n      6:   sudo: yes\n      7: \n      8:   roles:\n      9:     - jboss-standalone\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "paramasivamsathyaprakash_ansiblerepo-elk-provisioning-web-vars-main.yml", "content": "filebeat_ssl_key_file: elk-example.p8", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: paramasivamsathyaprakash_ansiblerepo-elk-provisioning-web-vars-main.yml\n\n\nfilebeat_output_logstash_enabled: true\nfilebeat_output_logstash_hosts:\n- \"logs.test:5044\"\n\n9: filebeat_ssl_key_file: elk-example.p8\nfilebeat_ssl_certificate_file: elk-example.crt\nfilebeat_ssl_insecure: \"true\"\n\nfilebeat_inputs:\n- type: log", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: paramasivamsathyaprakash_ansiblerepo-elk-provisioning-web-vars-main.yml\n# Target line: 9\n\n      4: \n      5: filebeat_output_logstash_enabled: true\n      6: filebeat_output_logstash_hosts:\n      7:   - \"logs.test:5044\"\n      8: \n>>>   9: filebeat_ssl_key_file: elk-example.p8\n     10: filebeat_ssl_certificate_file: elk-example.crt\n     11: filebeat_ssl_insecure: \"true\"\n     12: \n     13: filebeat_inputs:\n     14:   - type: log\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norbert_florin-vars-defaults.yml", "content": "selfoss_db_username: selfoss", "line": 108, "detection_span": [103, 113], "with_context": "# Ansible file: norbert_florin-vars-defaults.yml\n\n103: prosody_virtual_domain: \"{{ domain }}\"\n104: # prosody_accounts: (required)\n105:\n106: # news\n107: selfoss_domain: \"news.{{ domain }}\"\n108: selfoss_db_username: selfoss\n109: # selfoss_db_password: (required)\n110: selfoss_db_database: selfoss\n111:\n112: # git\n113: cgit_version: 0.10.1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: norbert_florin-vars-defaults.yml\n# Target line: 108\n\n    103: prosody_virtual_domain: \"{{ domain }}\"\n    104: # prosody_accounts: (required)\n    105: \n    106: # news\n    107: selfoss_domain: \"news.{{ domain }}\"\n>>> 108: selfoss_db_username: selfoss\n    109: # selfoss_db_password: (required)\n    110: selfoss_db_database: selfoss\n    111: \n    112: # git\n    113: cgit_version: 0.10.1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aruba_aruba-ansible-modules-example_playbooks-arubaos_controller-ap_whitelist_config.yml", "content": "verify_cert: True", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: aruba_aruba-ansible-modules-example_playbooks-arubaos_controller-ap_whitelist_config.yml\n\npassword: \"{{ mm_password }}\"\nmethod: \"{{ method_type }}\"\nconfig_path: \"{{ configuration_path }}\"\napi_name: wdb_cpsec_add_mac\ndata: { \"ap_name\": \"test_ap\", \"ap_group\": \"default\", \"name\": \"<ap-mac>\" }\n17:         verify_cert: True", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aruba_aruba-ansible-modules-example_playbooks-arubaos_controller-ap_whitelist_config.yml\n# Target line: 17\n\n     12:         password: \"{{ mm_password }}\"\n     13:         method: \"{{ method_type }}\"\n     14:         config_path: \"{{ configuration_path }}\"\n     15:         api_name: wdb_cpsec_add_mac\n     16:         data: { \"ap_name\": \"test_ap\", \"ap_group\": \"default\", \"name\": \"<ap-mac>\" }\n>>>  17:         verify_cert: True\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ansible-collections_community.zabbix-roles-zabbix_proxy-defaults-main.yml", "content": "zabbix_proxy_dbpassword: zabbix_proxy", "line": 85, "detection_span": [80, 90], "with_context": "# Ansible file: ansible-collections_community.zabbix-roles-zabbix_proxy-defaults-main.yml\n\nzabbix_proxy_dbcollation: utf8_bin\nzabbix_proxy_dbhost: localhost\nzabbix_proxy_dbname: zabbix_proxy\nzabbix_proxy_dbschema:\nzabbix_proxy_dbuser: zabbix_proxy\n85: zabbix_proxy_dbpassword: zabbix_proxy\nzabbix_proxy_dbsocket:\nzabbix_proxy_dbport: 5432\nzabbix_proxy_dbhost_run_install: true\nzabbix_proxy_privileged_host: localhost\nzabbix_proxy_localbuffer: 0          # Will be deprecated in 2.0.0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ansible-collections_community.zabbix-roles-zabbix_proxy-defaults-main.yml\n# Target line: 85\n\n     80: zabbix_proxy_dbcollation: utf8_bin\n     81: zabbix_proxy_dbhost: localhost\n     82: zabbix_proxy_dbname: zabbix_proxy\n     83: zabbix_proxy_dbschema:\n     84: zabbix_proxy_dbuser: zabbix_proxy\n>>>  85: zabbix_proxy_dbpassword: zabbix_proxy\n     86: zabbix_proxy_dbsocket:\n     87: zabbix_proxy_dbport: 5432\n     88: zabbix_proxy_dbhost_run_install: true\n     89: zabbix_proxy_privileged_host: localhost\n     90: zabbix_proxy_localbuffer: 0          # Will be deprecated in 2.0.0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml", "content": "matrix_mx_puppet_twitter_appservice_token: ''", "line": 60, "detection_span": [55, 65], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n\nmatrix_mx_puppet_twitter_systemd_required_services_list: ['docker.service']\n\n# List of systemd services that mx-puppet-twitter.service wants\nmatrix_mx_puppet_twitter_systemd_wanted_services_list: []\n\n60: matrix_mx_puppet_twitter_appservice_token: ''\nmatrix_mx_puppet_twitter_homeserver_token: ''\n\n# Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\nmatrix_mx_puppet_twitter_login_shared_secret: ''\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n# Target line: 60\n\n     55: matrix_mx_puppet_twitter_systemd_required_services_list: ['docker.service']\n     56: \n     57: # List of systemd services that mx-puppet-twitter.service wants\n     58: matrix_mx_puppet_twitter_systemd_wanted_services_list: []\n     59: \n>>>  60: matrix_mx_puppet_twitter_appservice_token: ''\n     61: matrix_mx_puppet_twitter_homeserver_token: ''\n     62: \n     63: # Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\n     64: matrix_mx_puppet_twitter_login_shared_secret: ''\n     65: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_htpasswd_certs_logging_infra.yml", "content": "- key: elasticsearch", "line": 109, "detection_span": [104, 114], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_htpasswd_certs_logging_infra.yml\n\n104:   total_replicas: 1\n105:   total_replicas_min: 1\n106:   total_replicas_max: 1\n107:   role: elasticsearch\n108:   taints:\n109:   - key: elasticsearch\nvalue: reserved\neffect: NoSchedule\n112:   - key: elasticsearch\nvalue: reserved\neffect: NoExecute", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_htpasswd_certs_logging_infra.yml\n# Target line: 109\n\n    104:   total_replicas: 1\n    105:   total_replicas_min: 1\n    106:   total_replicas_max: 1\n    107:   role: elasticsearch\n    108:   taints:\n>>> 109:   - key: elasticsearch\n    110:     value: reserved\n    111:     effect: NoSchedule\n    112:   - key: elasticsearch\n    113:     value: reserved\n    114:     effect: NoExecute\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "neki06_kolla-ansible-ansible-roles-watcher-defaults-main.yml", "content": "watcher_keystone_user: \"watcher\"", "line": 69, "detection_span": [64, 74], "with_context": "# Ansible file: neki06_kolla-ansible-ansible-roles-watcher-defaults-main.yml\n\nwatcher_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ watcher_api_port }}\"\nwatcher_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ watcher_api_port }}\"\n\nwatcher_logging_debug: \"{{ openstack_logging_debug }}\"\n\n69: watcher_keystone_user: \"watcher\"\n\nopenstack_watcher_auth: \"{{ openstack_auth }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: neki06_kolla-ansible-ansible-roles-watcher-defaults-main.yml\n# Target line: 69\n\n     64: watcher_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ watcher_api_port }}\"\n     65: watcher_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ watcher_api_port }}\"\n     66: \n     67: watcher_logging_debug: \"{{ openstack_logging_debug }}\"\n     68: \n>>>  69: watcher_keystone_user: \"watcher\"\n     70: \n     71: openstack_watcher_auth: \"{{ openstack_auth }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "henrysher_fedora-infra-ansible-playbooks-manual-staging-sync-koji.yml", "content": "- postgresql_user: name=backup", "line": 69, "detection_span": [64, 74], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-playbooks-manual-staging-sync-koji.yml\n\n- template: src=templates/koji-reset-staging.sql dest=/var/lib/pgsql/koji-reset-staging.sql\ntags:\n- db-sync-script\n\n- postgresql_user: name=koji password={{ kojiPassword }}\n69:   - postgresql_user: name=backup\n- postgresql_db: name=koji state=absent\n# buildroot_listing is excluded from the sync to save some time\n# TODO: install mbuffer on db-koji.stg\n- name: Import the prod db.  This will take quite a while.  Go get a snack!\nshell: >", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-playbooks-manual-staging-sync-koji.yml\n# Target line: 69\n\n     64:   - template: src=templates/koji-reset-staging.sql dest=/var/lib/pgsql/koji-reset-staging.sql\n     65:     tags:\n     66:     - db-sync-script\n     67: \n     68:   - postgresql_user: name=koji password={{ kojiPassword }}\n>>>  69:   - postgresql_user: name=backup\n     70:   - postgresql_db: name=koji state=absent\n     71: # buildroot_listing is excluded from the sync to save some time\n     72: # TODO: install mbuffer on db-koji.stg\n     73:   - name: Import the prod db.  This will take quite a while.  Go get a snack!\n     74:     shell: >\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "EMCECS_ECS-CommunityEdition-examples-local-lab-4-node-deploy.yml", "content": "is_system_admin: true", "line": 147, "detection_span": [142, 152], "with_context": "# Ansible file: EMCECS_ECS-CommunityEdition-examples-local-lab-4-node-deploy.yml\n\n142:   # Management Users\n143:   management_users:\n- username: admin1\npassword: ChangeMe\noptions:\n147:         is_system_admin: true\n- username: monitor1\npassword: ChangeMe\noptions:\nis_system_monitor: true\n152:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: EMCECS_ECS-CommunityEdition-examples-local-lab-4-node-deploy.yml\n# Target line: 147\n\n    142:   # Management Users\n    143:   management_users:\n    144:     - username: admin1\n    145:       password: ChangeMe\n    146:       options:\n>>> 147:         is_system_admin: true\n    148:     - username: monitor1\n    149:       password: ChangeMe\n    150:       options:\n    151:         is_system_monitor: true\n    152: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-alfresco-ee-tasks-main.yml", "content": "become_user: alfresco", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-alfresco-ee-tasks-main.yml\n\n# downloaded.  However, since we are downloading a specific version,\n# we can just check whether the file already exists before downloading it\n\n- name: see if Alfresco EE content services already downloaded\nbecome: yes\n9:   become_user: alfresco\nstat:\npath: \"{{ root_folder }}/install/alfresco/alfresco-content-services-distribution-{{ alfresco_ee_version}}.zip\"\nregister: content_services_download\n\n- name: retrieve Alfresco EE ACS distribution zip file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-alfresco-ee-tasks-main.yml\n# Target line: 9\n\n      4: # downloaded.  However, since we are downloading a specific version,\n      5: # we can just check whether the file already exists before downloading it\n      6: \n      7: - name: see if Alfresco EE content services already downloaded\n      8:   become: yes\n>>>   9:   become_user: alfresco\n     10:   stat:\n     11:     path: \"{{ root_folder }}/install/alfresco/alfresco-content-services-distribution-{{ alfresco_ee_version}}.zip\"\n     12:   register: content_services_download  \n     13: \n     14: - name: retrieve Alfresco EE ACS distribution zip file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml", "content": "ansible_user: ec2-user", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n\nhosts:\n13.232.25.155:\nansible_become: 'yes'\nansible_become_pass: password\nansible_ssh_pass: password\n19:           ansible_user: ec2-user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n# Target line: 19\n\n     14:       hosts:\n     15:         13.232.25.155:\n     16:           ansible_become: 'yes'\n     17:           ansible_become_pass: password\n     18:           ansible_ssh_pass: password\n>>>  19:           ansible_user: ec2-user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml", "content": "- key: \"api_url\"", "line": 79, "detection_span": [74, 84], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n\nvalue: \"{{ env_type }}-{{ email }}\"\n- key: \"api_user\"\nvalue: \"{{ osp_auth_username_member }}\"\n- key: \"api_pass\"\nvalue: \"{{ osp_auth_password_member }}\"\n79:       - key: \"api_url\"\nvalue: \"{{ osp_auth_url }}\"\n- key: \"project_name\"\nvalue: \"{{ osp_project_name }}\"\n- key: \"pxe_image\"\nvalue: \"pxeboot\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n# Target line: 79\n\n     74:         value: \"{{ env_type }}-{{ email }}\"\n     75:       - key: \"api_user\"\n     76:         value: \"{{ osp_auth_username_member }}\"\n     77:       - key: \"api_pass\"\n     78:         value: \"{{ osp_auth_password_member }}\"\n>>>  79:       - key: \"api_url\"\n     80:         value: \"{{ osp_auth_url }}\"\n     81:       - key: \"project_name\"\n     82:         value: \"{{ osp_project_name }}\"\n     83:       - key: \"pxe_image\"\n     84:         value: \"pxeboot\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aristanetworks_ansible-cvp-ansible_collections-arista-cvp-molecule-cv_device-inventory-hosts.yml", "content": "ansible_user: root", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: aristanetworks_ansible-cvp-ansible_collections-arista-cvp-molecule-cv_device-inventory-hosts.yml\n\nall:\nchildren:\nCVP:\nhosts:\ncv_server:\n7:           ansible_user: root", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-cvp-ansible_collections-arista-cvp-molecule-cv_device-inventory-hosts.yml\n# Target line: 7\n\n      2: all:\n      3:   children:\n      4:     CVP:\n      5:       hosts:\n      6:         cv_server:\n>>>   7:           ansible_user: root\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Boes-man_ansible-galaxy-molecule-ec2_centos7-molecule.yml", "content": "ssh_user: centos", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: Boes-man_ansible-galaxy-molecule-ec2_centos7-molecule.yml\n\n- dcos\n- name: agent1-centos7\nimage: ami-9887c6e7\nregion: us-east-1\ninstance_type: m5.large\n27:     ssh_user: centos\ngroups:\n- agents_private\n- agents\n- dcos\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Boes-man_ansible-galaxy-molecule-ec2_centos7-molecule.yml\n# Target line: 27\n\n     22:       - dcos\n     23:   - name: agent1-centos7\n     24:     image: ami-9887c6e7\n     25:     region: us-east-1\n     26:     instance_type: m5.large\n>>>  27:     ssh_user: centos\n     28:     groups:\n     29:       - agents_private\n     30:       - agents\n     31:       - dcos\n     32: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "TerryHowe_ansible-modules-hashivault-functional-test_not_there.yml", "content": "key: 'value'", "line": 51, "detection_span": [46, 56], "with_context": "# Ansible file: TerryHowe_ansible-modules-hashivault-functional-test_not_there.yml\n\nothervalue: 'one'\n\n- name: Nonexistent key with default\nhashivault_read:\nsecret: '{{secret_name}}'\n51:         key: 'value'\ndefault: 'better'\nregister: 'vault_read'\n- assert: { that: \"'{{vault_read.value}}' == 'better'\" }\n\n- set_fact:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: TerryHowe_ansible-modules-hashivault-functional-test_not_there.yml\n# Target line: 51\n\n     46:             othervalue: 'one'\n     47: \n     48:     - name: Nonexistent key with default\n     49:       hashivault_read:\n     50:         secret: '{{secret_name}}'\n>>>  51:         key: 'value'\n     52:         default: 'better'\n     53:       register: 'vault_read'\n     54:     - assert: { that: \"'{{vault_read.value}}' == 'better'\" }\n     55: \n     56:     - set_fact:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_infra-ansible-inventory-idm-server-group_vars-all.yml", "content": "key_secret: 'key_secret'", "line": 16, "detection_span": [11, 21], "with_context": "# Ansible file: redhat-cop_infra-ansible-inventory-idm-server-group_vars-all.yml\n\nstate: present\nnamed: True\nnsupdate:\n- server: \"dns_server_ip\"\nkey_name: \"dns_zone_key_name\"\n16:               key_secret: 'key_secret'\nkey_algorithm: 'hmac-sha256'\nentries:\n- type: A\nrecord: \"idm.subdomain\"\nvalue: \"{{ hostvars['idm.subdomain']['openstack']['private_v4'] }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_infra-ansible-inventory-idm-server-group_vars-all.yml\n# Target line: 16\n\n     11:           state: present\n     12:           named: True\n     13:           nsupdate:\n     14:             - server: \"dns_server_ip\"\n     15:               key_name: \"dns_zone_key_name\"\n>>>  16:               key_secret: 'key_secret'\n     17:               key_algorithm: 'hmac-sha256'\n     18:           entries:\n     19:             - type: A\n     20:               record: \"idm.subdomain\"\n     21:               value: \"{{ hostvars['idm.subdomain']['openstack']['private_v4'] }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-tasks-generate_install_config.yml", "content": "path: /home/{{ ansible_user }}/.ssh/id_rsa.pub", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-tasks-generate_install_config.yml\n\nargs:\ncreates: /home/{{ ansible_user }}/.ssh/id_rsa.pub\n\n- name: Slurp public key\nslurp:\n13:     path: /home/{{ ansible_user }}/.ssh/id_rsa.pub\nregister: idrsapub\n\n- name: Create cluster directory\nfile:\npath: /home/{{ ansible_user }}/{{ cluster_name }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-tasks-generate_install_config.yml\n# Target line: 13\n\n      8:   args:\n      9:     creates: /home/{{ ansible_user }}/.ssh/id_rsa.pub\n     10: \n     11: - name: Slurp public key\n     12:   slurp:\n>>>  13:     path: /home/{{ ansible_user }}/.ssh/id_rsa.pub\n     14:   register: idrsapub\n     15: \n     16: - name: Create cluster directory\n     17:   file:\n     18:     path: /home/{{ ansible_user }}/{{ cluster_name }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-host_vars-prod-rabbit.usegalaxy.org.au.yml", "content": "- user: admin", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: usegalaxy-au_infrastructure-host_vars-prod-rabbit.usegalaxy.org.au.yml\n\n\n\n# Host specific Rabbit settings\nrabbitmq_users:\n5:   - user: admin\npassword: \"{{ rabbitmq_password_admin }}\"\ntags: administrator\nvhost: /\n- user: telegraf\npassword: \"{{ rabbitmq_password_telegraf }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-host_vars-prod-rabbit.usegalaxy.org.au.yml\n# Target line: 5\n\n      1: \n      2: \n      3: # Host specific Rabbit settings\n      4: rabbitmq_users:\n>>>   5:   - user: admin\n      6:     password: \"{{ rabbitmq_password_admin }}\"\n      7:     tags: administrator\n      8:     vhost: /\n      9:   - user: telegraf\n     10:     password: \"{{ rabbitmq_password_telegraf }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "oidcng_api_metadata_push_password: secret", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmyconext: secret\n\nmongo_admin_password: secret\n\nengine_api_metadata_push_password: secret\n26: oidcng_api_metadata_push_password: secret\noidcng_api_tokens_profile_password: secret\noidcng_api_tokens_eduid_password: secret\nmyconext_api_attribute_manipulation_password: secret\nmyconext_oidcng_rs_client_secret: secret\nmyconext_api_attribute_aggregation_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 26\n\n     21:    myconext: secret\n     22: \n     23: mongo_admin_password: secret\n     24: \n     25: engine_api_metadata_push_password: secret\n>>>  26: oidcng_api_metadata_push_password: secret\n     27: oidcng_api_tokens_profile_password: secret\n     28: oidcng_api_tokens_eduid_password: secret\n     29: myconext_api_attribute_manipulation_password: secret\n     30: myconext_oidcng_rs_client_secret: secret\n     31: myconext_api_attribute_aggregation_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ComplianceAsCode_content-products-jre-product.yml", "content": "profiles_root: \"./profiles\"", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n\ntype: product\n\nbenchmark_id: JRE\nbenchmark_root: \"./guide\"\n\n8: profiles_root: \"./profiles\"\n\npkg_manager: \"yum\"\n\ncpes_root: \"../../shared/applicability\"\ncpes:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n# Target line: 8\n\n      3: type: product\n      4: \n      5: benchmark_id: JRE\n      6: benchmark_root: \"./guide\"\n      7: \n>>>   8: profiles_root: \"./profiles\"\n      9: \n     10: pkg_manager: \"yum\"\n     11: \n     12: cpes_root: \"../../shared/applicability\"\n     13: cpes:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-all.yml", "content": "key: files/keys/gareth.pub", "line": 38, "detection_span": [33, 43], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n\nkey: files/keys/mike.pub\nemail: \"{{ mike_email }}\"\n- name: gareth\nroles:\n- galaxy_admin\n38:       key: files/keys/gareth.pub\nemail: \"{{ gareth_email }}\"\n- name: jenkins_bot\nroles:\n- sudo\n- galaxy_admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n# Target line: 38\n\n     33:       key: files/keys/mike.pub\n     34:       email: \"{{ mike_email }}\"\n     35:     - name: gareth\n     36:       roles:\n     37:         - galaxy_admin\n>>>  38:       key: files/keys/gareth.pub\n     39:       email: \"{{ gareth_email }}\"\n     40:     - name: jenkins_bot\n     41:       roles:\n     42:         - sudo\n     43:         - galaxy_admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Alfresco_alfresco-ansible-deployment-molecule-manual-activemq-hosts.yml", "content": "activemq_username: alfresco", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: Alfresco_alfresco-ansible-deployment-molecule-manual-activemq-hosts.yml\n\nexternal:\nchildren:\nexternal_activemq:\nhosts:\nwhatever.mq.eu-west-1.amazonaws.com:\n8:               activemq_username: alfresco\nactivemq_password: alfresco\nactivemq_port: 61617", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Alfresco_alfresco-ansible-deployment-molecule-manual-activemq-hosts.yml\n# Target line: 8\n\n      3:     external:\n      4:       children:\n      5:         external_activemq:\n      6:           hosts:\n      7:             whatever.mq.eu-west-1.amazonaws.com:\n>>>   8:               activemq_username: alfresco\n      9:               activemq_password: alfresco\n     10:               activemq_port: 61617\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_openstack-ansible-os_keystone-examples-playbook.yml", "content": "keystone_oslomsg_rpc_userid: keystone", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: openstack_openstack-ansible-os_keystone-examples-playbook.yml\n\nkeystone_container_mysql_password: \"SuperSecrete\"\nkeystone_oslomsg_rpc_transport: rabbit\nkeystone_oslomsg_rpc_servers: 10.100.100.101\nkeystone_oslomsg_rpc_port: 5671\nkeystone_oslomsg_rpc_use_ssl: true\n23:     keystone_oslomsg_rpc_userid: keystone\nkeystone_oslomsg_rpc_vhost: /keystone\nkeystone_oslomsg_notify_transport: rabbit\nkeystone_oslomsg_notify_servers: 10.100.100.101\nkeystone_oslomsg_notify_port: 5671\nkeystone_oslomsg_notify_use_ssl: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_openstack-ansible-os_keystone-examples-playbook.yml\n# Target line: 23\n\n     18:     keystone_container_mysql_password: \"SuperSecrete\"\n     19:     keystone_oslomsg_rpc_transport: rabbit\n     20:     keystone_oslomsg_rpc_servers: 10.100.100.101\n     21:     keystone_oslomsg_rpc_port: 5671\n     22:     keystone_oslomsg_rpc_use_ssl: true\n>>>  23:     keystone_oslomsg_rpc_userid: keystone\n     24:     keystone_oslomsg_rpc_vhost: /keystone\n     25:     keystone_oslomsg_notify_transport: rabbit\n     26:     keystone_oslomsg_notify_servers: 10.100.100.101\n     27:     keystone_oslomsg_notify_port: 5671\n     28:     keystone_oslomsg_notify_use_ssl: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "FrostyX_fedora-infra-ansible-playbooks-manual-rebuild-fedora-packages.yml", "content": "become_user: apache", "line": 50, "detection_span": [45, 55], "with_context": "# Ansible file: FrostyX_fedora-infra-ansible-playbooks-manual-rebuild-fedora-packages.yml\n\n- name: Rebuild that search index on the side and install it. (just prod)\nhosts: packages\ntags: rebuild-prod-index\nuser: root\nbecome: True\n50:   become_user: apache\ngather_facts: False\n\nvars_files:\n- /srv/web/infra/ansible/vars/global.yml\n- \"{{ private }}/vars.yml\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: FrostyX_fedora-infra-ansible-playbooks-manual-rebuild-fedora-packages.yml\n# Target line: 50\n\n     45: - name: Rebuild that search index on the side and install it. (just prod)\n     46:   hosts: packages\n     47:   tags: rebuild-prod-index\n     48:   user: root\n     49:   become: True\n>>>  50:   become_user: apache\n     51:   gather_facts: False\n     52: \n     53:   vars_files: \n     54:    - /srv/web/infra/ansible/vars/global.yml\n     55:    - \"{{ private }}/vars.yml\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sivabayya_ansible-provisioner-roles-manage_ec2_instances-tasks-inventory-addhost_windows.yml", "content": "ansible_user: \"Administrator\"", "line": 100, "detection_span": [95, 105], "with_context": "# Ansible file: sivabayya_ansible-provisioner-roles-manage_ec2_instances-tasks-inventory-addhost_windows.yml\n\nhostname: \"student{{ item.item.tags.Student | regex_replace('[^0-9]', '') }}-win2\"\nshort_name: \"{{ item.item.tags.short_name }}\"\nansible_host: \"{{ item.item.public_ip_address }}\"\nprivate_ip: \"{{ item.item.private_ip_address }}\"\nansible_port: 5986\n100:     ansible_user: \"Administrator\"\nansible_password: \"{{ item.win_password }}\"\nansible_become_password: \"{{ admin_password }}\"\nansible_connection: \"winrm\"\nansible_winrm_transport: \"ntlm\"\nansible_winrm_server_cert_validation: \"ignore\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sivabayya_ansible-provisioner-roles-manage_ec2_instances-tasks-inventory-addhost_windows.yml\n# Target line: 100\n\n     95:     hostname: \"student{{ item.item.tags.Student | regex_replace('[^0-9]', '') }}-win2\"\n     96:     short_name: \"{{ item.item.tags.short_name }}\"\n     97:     ansible_host: \"{{ item.item.public_ip_address }}\"\n     98:     private_ip: \"{{ item.item.private_ip_address }}\"\n     99:     ansible_port: 5986\n>>> 100:     ansible_user: \"Administrator\"\n    101:     ansible_password: \"{{ item.win_password }}\"\n    102:     ansible_become_password: \"{{ admin_password }}\"\n    103:     ansible_connection: \"winrm\"\n    104:     ansible_winrm_transport: \"ntlm\"\n    105:     ansible_winrm_server_cert_validation: \"ignore\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "crv4all_openshift-ansible-roles-openshift_manageiq-vars-main.yml", "content": "user: management-admin", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: crv4all_openshift-ansible-roles-openshift_manageiq-vars-main.yml\n\n---\nmanage_iq_tasks:\n- resource_kind: role\nresource_name: admin\n5:   user: management-admin\n- resource_kind: role\nresource_name: admin\nuser: system:serviceaccount:management-infra:management-admin\n- resource_kind: cluster-role\nresource_name: management-infra-admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-roles-openshift_manageiq-vars-main.yml\n# Target line: 5\n\n      1: ---\n      2: manage_iq_tasks:\n      3: - resource_kind: role\n      4:   resource_name: admin\n>>>   5:   user: management-admin\n      6: - resource_kind: role\n      7:   resource_name: admin\n      8:   user: system:serviceaccount:management-infra:management-admin\n      9: - resource_kind: cluster-role\n     10:   resource_name: management-infra-admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "BCDevOps_platform-services-tools-github-backups-cron-github-backups.yml", "content": "key: secret", "line": 40, "detection_span": [35, 45], "with_context": "# Ansible file: BCDevOps_platform-services-tools-github-backups-cron-github-backups.yml\n\nkey: id\n- name: S3_SECRET\nvalueFrom:\nsecretKeyRef:\nname: github-backups-s3-creds\n40:                       key: secret\n- name: S3_URL\nvalueFrom:\nsecretKeyRef:\nname: github-backups-s3-creds\nkey: URL", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: BCDevOps_platform-services-tools-github-backups-cron-github-backups.yml\n# Target line: 40\n\n     35:                       key: id\n     36:                 - name: S3_SECRET\n     37:                   valueFrom:\n     38:                     secretKeyRef:\n     39:                       name: github-backups-s3-creds\n>>>  40:                       key: secret\n     41:                 - name: S3_URL\n     42:                   valueFrom:\n     43:                     secretKeyRef:\n     44:                       name: github-backups-s3-creds\n     45:                       key: URL\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml", "content": "control_center_ldap_user: control_center", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n\nkafka_connect_ldap_password: password\nksql_ldap_user: ksql\nksql_ldap_password: password\nkafka_rest_ldap_user: rest_proxy\nkafka_rest_ldap_password: password\n49:     control_center_ldap_user: control_center\ncontrol_center_ldap_password: password\n\nkafka_broker_custom_listeners:\nclient:\nname: CLIENT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n# Target line: 49\n\n     44:     kafka_connect_ldap_password: password\n     45:     ksql_ldap_user: ksql\n     46:     ksql_ldap_password: password\n     47:     kafka_rest_ldap_user: rest_proxy\n     48:     kafka_rest_ldap_password: password\n>>>  49:     control_center_ldap_user: control_center\n     50:     control_center_ldap_password: password\n     51: \n     52:     kafka_broker_custom_listeners:\n     53:       client:\n     54:         name: CLIENT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ManageIQ_manageiq-config-messaging.kafka.yml", "content": "password: smartvm", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: ManageIQ_manageiq-config-messaging.kafka.yml\n\n---\nbase: &base\nhostname: localhost\nport: 9092\nusername: admin\n6:   password: smartvm\n\ndevelopment:\n<<: *base\n\nproduction:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ManageIQ_manageiq-config-messaging.kafka.yml\n# Target line: 6\n\n      1: ---\n      2: base: &base\n      3:   hostname: localhost\n      4:   port: 9092\n      5:   username: admin\n>>>   6:   password: smartvm\n      7: \n      8: development:\n      9:   <<: *base\n     10: \n     11: production:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloudera_cloudera-playbook-group_vars-db_server.yml", "content": "pass: 'navms_password'", "line": 41, "detection_span": [36, 46], "with_context": "# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n\npass: 'nav_password'\ntype: '{{ database_type }}'\nnavms:\nname: 'navms'\nuser: 'navms'\n41:     pass: 'navms_password'\ntype: '{{ database_type }}'\nmetastore:\nname: 'metastore'\nuser: 'hive'\npass: 'hive_password'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n# Target line: 41\n\n     36:     pass: 'nav_password'\n     37:     type: '{{ database_type }}'\n     38:   navms:\n     39:     name: 'navms'\n     40:     user: 'navms'\n>>>  41:     pass: 'navms_password'\n     42:     type: '{{ database_type }}'\n     43:   metastore:\n     44:     name: 'metastore'\n     45:     user: 'hive'\n     46:     pass: 'hive_password'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "EnterpriseDB_edb-ansible-roles-setup_pemagent-defaults-main.yml", "content": "pg_pem_agent_password: \"\"", "line": 11, "detection_span": [6, 16], "with_context": "# Ansible file: EnterpriseDB_edb-ansible-roles-setup_pemagent-defaults-main.yml\n\npass_dir: \"~/.edb\"\nefm_enabled: True\npg_pem_admin_user: \"pemadmin\"\npg_pem_admin_password: \"\"\npg_pem_agent_user: \"pemagent\"\n11: pg_pem_agent_password: \"\"\npg_ssl: true\n\npem_server_exists: false\n# efm information\nefm_version: \"4.4\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: EnterpriseDB_edb-ansible-roles-setup_pemagent-defaults-main.yml\n# Target line: 11\n\n      6: pass_dir: \"~/.edb\"\n      7: efm_enabled: True\n      8: pg_pem_admin_user: \"pemadmin\"\n      9: pg_pem_admin_password: \"\"\n     10: pg_pem_agent_user: \"pemagent\"\n>>>  11: pg_pem_agent_password: \"\"\n     12: pg_ssl: true\n     13: \n     14: pem_server_exists: false\n     15: # efm information\n     16: efm_version: \"4.4\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-all.yml", "content": "key: files/keys/nuwan.pub", "line": 50, "detection_span": [45, 55], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n\nemail: \"{{ jenkins_bot_email }}\" # this is not a real email address and will cause issues if validation is required\n- name: nuwan\nroles:\n- sudo\n- galaxy_admin\n50:       key: files/keys/nuwan.pub\ngalaxy_admin: true\nemail: \"{{ nuwan_email }}\"\n- name: justin\nroles:\n- sudo", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n# Target line: 50\n\n     45:       email: \"{{ jenkins_bot_email }}\" # this is not a real email address and will cause issues if validation is required\n     46:     - name: nuwan\n     47:       roles:\n     48:         - sudo\n     49:         - galaxy_admin\n>>>  50:       key: files/keys/nuwan.pub\n     51:       galaxy_admin: true\n     52:       email: \"{{ nuwan_email }}\"\n     53:     - name: justin\n     54:       roles:\n     55:         - sudo\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml", "content": "ansible_become_pass: password", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n\nungrouped: {}\nweb:\nhosts:\n13.232.25.155:\nansible_become: 'yes'\n17:           ansible_become_pass: password\nansible_ssh_pass: password\nansible_user: ec2-user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n# Target line: 17\n\n     12:     ungrouped: {}\n     13:     web:\n     14:       hosts:\n     15:         13.232.25.155:\n     16:           ansible_become: 'yes'\n>>>  17:           ansible_become_pass: password\n     18:           ansible_ssh_pass: password\n     19:           ansible_user: ec2-user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-osp-satellite-vm-sample_vars.yml", "content": "admin_user: gucore", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-osp-satellite-vm-sample_vars.yml\n\nproject: dev-ansible-tower-implementation-3.3-v6\n#project: EMEA-PC-azure-gold-image-bp\n\ncloud_provider: osp\n\n10: admin_user: gucore\n\nstudent_name: guillaume\n\n\nexternal_network: ee9d9e11-9f4b-4b78-8802-3d3e670ca0f0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-osp-satellite-vm-sample_vars.yml\n# Target line: 10\n\n      5: project: dev-ansible-tower-implementation-3.3-v6\n      6: #project: EMEA-PC-azure-gold-image-bp\n      7: \n      8: cloud_provider: osp\n      9: \n>>>  10: admin_user: gucore\n     11: \n     12: student_name: guillaume\n     13: \n     14: \n     15: external_network: ee9d9e11-9f4b-4b78-8802-3d3e670ca0f0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-ccnrd-stable-defaults-main.yml", "content": "workshop_che_user_password: 'r3dh4t1!'", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-ccnrd-stable-defaults-main.yml\n\ngogs_pwd: 'r3dh4t1!'\n\nworkshop_openshift_user_name: userXX\nworkshop_openshift_user_password: 'r3dh4t1!'\nworkshop_che_user_name: userXX\n23: workshop_che_user_password: 'r3dh4t1!'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-ccnrd-stable-defaults-main.yml\n# Target line: 23\n\n     18: gogs_pwd: 'r3dh4t1!'\n     19: \n     20: workshop_openshift_user_name: userXX\n     21: workshop_openshift_user_password: 'r3dh4t1!'\n     22: workshop_che_user_name: userXX\n>>>  23: workshop_che_user_password: 'r3dh4t1!'\n     24: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "splunk_splunk-ansible-roles-splunk_standalone-molecule-apps-group_vars-all.yml", "content": "password: helloworld", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: splunk_splunk-ansible-roles-splunk_standalone-molecule-apps-group_vars-all.yml\n\napps_location:\n- http://nginx/splunk_app_simple.tgz\n- /tmp/splunk_app_httpexample.tgz\nhec:\ntoken: abcd1234\n10:   password: helloworld\ndisable_popups: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: splunk_splunk-ansible-roles-splunk_standalone-molecule-apps-group_vars-all.yml\n# Target line: 10\n\n      5:   apps_location:\n      6:     - http://nginx/splunk_app_simple.tgz\n      7:     - /tmp/splunk_app_httpexample.tgz\n      8:   hec:\n      9:     token: abcd1234\n>>>  10:   password: helloworld\n     11:   disable_popups: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "vijaykakkar_ansible-automation-exercises-ansible_network-supplemental-parsers-show_ip_interfaces.yaml", "content": "- key: data", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: vijaykakkar_ansible-automation-exercises-ansible_network-supplemental-parsers-show_ip_interfaces.yaml\n\n- name: GENERATE JSON DATA STRUCTURE\njson_template:\ntemplate:\n- key: \"{{ item.matches.0 }}\"\nobject:\n19:         - key: data\nobject:\n- key: name\nvalue: \"{{ item.matches.0 }}\"\n- key: ip\nvalue: \"{{ item.matches.1 }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: vijaykakkar_ansible-automation-exercises-ansible_network-supplemental-parsers-show_ip_interfaces.yaml\n# Target line: 19\n\n     14: - name: GENERATE JSON DATA STRUCTURE\n     15:   json_template:\n     16:     template:\n     17:       - key: \"{{ item.matches.0 }}\"\n     18:         object:\n>>>  19:         - key: data\n     20:           object:\n     21:             - key: name\n     22:               value: \"{{ item.matches.0 }}\"\n     23:             - key: ip\n     24:               value: \"{{ item.matches.1 }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "prasha94_ansible-windows-create-user.yml", "content": "password: \"@ns1bl3\"", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: prasha94_ansible-windows-create-user.yml\n\ngather_facts: false\ntasks:\n- name: Add User\nwin_user:\nname: ansible\n9:         password: \"@ns1bl3\"\nstate: present", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: prasha94_ansible-windows-create-user.yml\n# Target line: 9\n\n      4:   gather_facts: false\n      5:   tasks:\n      6:     - name: Add User\n      7:       win_user:\n      8:         name: ansible\n>>>   9:         password: \"@ns1bl3\"\n     10:         state: present\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-serverless-defaults-main.yaml", "content": "ocp4_workload_dil_serverless_user_access_token: \"hybridcloud\"", "line": 22, "detection_span": [17, 27], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-serverless-defaults-main.yaml\n\nocp4_workload_dil_serverless_system_storage_size: '100Mi'\n\n#  user_registration\nocp4_workload_dil_serverless_lab_title: \"Serverless Workshop\"\nocp4_workload_dil_serverless_username_prefix: \"user\"\n22: ocp4_workload_dil_serverless_user_access_token: \"hybridcloud\"\n\n# provision_shared\nocp4_workload_dil_serverless_num_zk_nodes: 3\nocp4_workload_dil_serverless_num_kafka_brokers: 3\nocp4_workload_dil_serverless_kafka_namespace: 'kafka'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-serverless-defaults-main.yaml\n# Target line: 22\n\n     17: ocp4_workload_dil_serverless_system_storage_size: '100Mi'\n     18: \n     19: #  user_registration\n     20: ocp4_workload_dil_serverless_lab_title: \"Serverless Workshop\"\n     21: ocp4_workload_dil_serverless_username_prefix: \"user\"\n>>>  22: ocp4_workload_dil_serverless_user_access_token: \"hybridcloud\"\n     23: \n     24: # provision_shared\n     25: ocp4_workload_dil_serverless_num_zk_nodes: 3\n     26: ocp4_workload_dil_serverless_num_kafka_brokers: 3\n     27: ocp4_workload_dil_serverless_kafka_namespace: 'kafka'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chz8494_tdlab-openstack-playbooks-os-glance-install.yml", "content": "glance_galera_user: glance", "line": 92, "detection_span": [87, 97], "with_context": "# Ansible file: chz8494_tdlab-openstack-playbooks-os-glance-install.yml\n\n- role: \"system_crontab_coordination\"\ntags:\n- crontab\nvars:\nis_metal: \"{{ properties.is_metal|default(false) }}\"\n92:     glance_galera_user: glance\nglance_galera_database: glance\nglance_galera_address: \"{{ galera_address }}\"\ntags:\n- glance", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: chz8494_tdlab-openstack-playbooks-os-glance-install.yml\n# Target line: 92\n\n     87:     - role: \"system_crontab_coordination\"\n     88:       tags:\n     89:         - crontab\n     90:   vars:\n     91:     is_metal: \"{{ properties.is_metal|default(false) }}\"\n>>>  92:     glance_galera_user: glance\n     93:     glance_galera_database: glance\n     94:     glance_galera_address: \"{{ galera_address }}\"\n     95:   tags:\n     96:     - glance\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "nova_service_password: 054e7b1078a9f2cd", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nneutron_service_password: 5043b5b40b09d31781afe9704\nnova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\nnova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n34: nova_service_password: 054e7b1078a9f2cd\nnova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\nnova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\nrabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\nrabbitmq_password: b763ef86fce7338e145c9c8c\nswift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 34\n\n     29: neutron_service_password: 5043b5b40b09d31781afe9704\n     30: nova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\n     31: nova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n>>>  34: nova_service_password: 054e7b1078a9f2cd\n     35: nova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n     36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n     37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\n     38: rabbitmq_password: b763ef86fce7338e145c9c8c\n     39: swift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sivabayya_ansible-provisioner-sample_workshops-sample-vars-demo.yml", "content": "admin_password: ansible", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: sivabayya_ansible-provisioner-sample_workshops-sample-vars-demo.yml\n\nstudent_total: 1\n# workshop is put into isecurity mode\nworkshop_type: 'demo'\nsecurity_console: 'qradar'\n## Optional Variables\n12: admin_password: ansible\nwindows_password: Ansible+Red*Hat19!20\ntowerinstall: true\ndemo: all\ncreate_cluster: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sivabayya_ansible-provisioner-sample_workshops-sample-vars-demo.yml\n# Target line: 12\n\n      7: student_total: 1\n      8: # workshop is put into isecurity mode\n      9: workshop_type: 'demo'\n     10: security_console: 'qradar'\n     11: ## Optional Variables\n>>>  12: admin_password: ansible\n     13: windows_password: Ansible+Red*Hat19!20\n     14: towerinstall: true\n     15: demo: all\n     16: create_cluster: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "contiv_ansible-roles-ceph-osd-defaults-main.yml", "content": "ceph_osd_docker_username: ceph", "line": 112, "detection_span": [107, 117], "with_context": "# Ansible file: contiv_ansible-roles-ceph-osd-defaults-main.yml\n\n107: ##########\n108: # DOCKER #\n109: ##########\n110:\n111: osd_containerized_deployment: false\n112: ceph_osd_docker_username: ceph\n113: ceph_osd_docker_imagename: daemon\n114: ceph_osd_docker_extra_env: \"CEPH_DAEMON=OSD_CEPH_DISK\" # comma separated variables\n115: #ceph_osd_docker_device:\n116: # - /dev/sdb", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: contiv_ansible-roles-ceph-osd-defaults-main.yml\n# Target line: 112\n\n    107: ##########\n    108: # DOCKER #\n    109: ##########\n    110: \n    111: osd_containerized_deployment: false\n>>> 112: ceph_osd_docker_username: ceph\n    113: ceph_osd_docker_imagename: daemon\n    114: ceph_osd_docker_extra_env: \"CEPH_DAEMON=OSD_CEPH_DISK\" # comma separated variables\n    115: #ceph_osd_docker_device:\n    116: # - /dev/sdb\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloud-bulldozer_browbeat-ansible-browbeat-adjustment-db.yml", "content": "remote_user: heat-admin", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: cloud-bulldozer_browbeat-ansible-browbeat-adjustment-db.yml\n\n---\n#\n#\n\n- hosts: Controller\n6:   remote_user: heat-admin\ngather_facts: false\nvars:\nansible_become: true\ngreenlet_pool_size: 100\nmax_overflow: 100", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloud-bulldozer_browbeat-ansible-browbeat-adjustment-db.yml\n# Target line: 6\n\n      1: ---\n      2: #\n      3: #\n      4: \n      5: - hosts: Controller\n>>>   6:   remote_user: heat-admin\n      7:   gather_facts: false\n      8:   vars:\n      9:     ansible_become: true\n     10:     greenlet_pool_size: 100\n     11:     max_overflow: 100\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-playbooks-roles-mongo_3_6-defaults-main.yml", "content": "- user: cs_comments_service", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: openedx_configuration-playbooks-roles-mongo_3_6-defaults-main.yml\n\n\n# Vars Meant to be overridden\nMONGO_ADMIN_USER: 'admin'\nMONGO_ADMIN_PASSWORD: 'password'\nMONGO_USERS:\n37:   - user: cs_comments_service\npassword: password\ndatabase: cs_comments_service\nroles: readWrite\n- user: edxapp\npassword: password", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-playbooks-roles-mongo_3_6-defaults-main.yml\n# Target line: 37\n\n     32: \n     33: # Vars Meant to be overridden\n     34: MONGO_ADMIN_USER: 'admin'\n     35: MONGO_ADMIN_PASSWORD: 'password'\n     36: MONGO_USERS:\n>>>  37:   - user: cs_comments_service\n     38:     password: password\n     39:     database: cs_comments_service\n     40:     roles: readWrite\n     41:   - user: edxapp\n     42:     password: password\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml", "content": "api_db_username: \"fgapiserver\"", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n\ndb_container_name: \"fg-db\"\n# root password of the db - put this in your group_vars and then in a vault in production\ndb_root_password: \"changeme\"\n# API Server db config\n# API Server user name and password - should be kept in group_vars\n14: api_db_username: \"fgapiserver\"\napi_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\napi_db_name: fgapiserver\n# where will we store the SQL data ?\nsql_data_dir: /tmp/fgapi-server-db-data/\n# Repos", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n# Target line: 14\n\n      9: db_container_name: \"fg-db\"\n     10: # root password of the db - put this in your group_vars and then in a vault in production\n     11: db_root_password: \"changeme\"\n     12: # API Server db config\n     13: # API Server user name and password - should be kept in group_vars\n>>>  14: api_db_username: \"fgapiserver\"\n     15: api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\n     16: api_db_name: fgapiserver\n     17: # where will we store the SQL data ?\n     18: sql_data_dir: /tmp/fgapi-server-db-data/\n     19: # Repos\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-base-tasks-server_base-setup_redhat8.yml", "content": "key: https://download.docker.com/linux/centos/gpg", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-base-tasks-server_base-setup_redhat8.yml\n\nwhen: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n\n- name: Ensure Docker's RPM key is trusted\nrpm_key:\nstate: present\n15:     key: https://download.docker.com/linux/centos/gpg\nwhen: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n\n- name: Ensure EPEL is installed\nyum:\nname:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-base-tasks-server_base-setup_redhat8.yml\n# Target line: 15\n\n     10:   when: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n     11: \n     12: - name: Ensure Docker's RPM key is trusted\n     13:   rpm_key:\n     14:     state: present\n>>>  15:     key: https://download.docker.com/linux/centos/gpg\n     16:   when: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n     17: \n     18: - name: Ensure EPEL is installed\n     19:   yum:\n     20:     name:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-docker-build-ecommerce-ecommerce.yml", "content": "SAILTHRU_SECRET: sailthru secret here", "line": 115, "detection_span": [110, 120], "with_context": "# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n\nerror_url: /checkout/error/\nmode: sandbox\nreceipt_url: /checkout/receipt/\n113: PLATFORM_NAME: Your Platform Name Here\n114: SAILTHRU_KEY: sailthru key here\n115: SAILTHRU_SECRET: sailthru secret here\n116: SECRET_KEY: Your secret key here\n117: SESSION_COOKIE_SECURE: true\n118: SESSION_EXPIRE_AT_BROWSER_CLOSE: false\n119: SOCIAL_AUTH_EDX_OAUTH2_ISSUER: http://127.0.0.1:8000\n120: SOCIAL_AUTH_EDX_OAUTH2_KEY: ecommerce-sso-key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n# Target line: 115\n\n    110:             error_url: /checkout/error/\n    111:             mode: sandbox\n    112:             receipt_url: /checkout/receipt/\n    113: PLATFORM_NAME: Your Platform Name Here\n    114: SAILTHRU_KEY: sailthru key here\n>>> 115: SAILTHRU_SECRET: sailthru secret here\n    116: SECRET_KEY: Your secret key here\n    117: SESSION_COOKIE_SECURE: true\n    118: SESSION_EXPIRE_AT_BROWSER_CLOSE: false\n    119: SOCIAL_AUTH_EDX_OAUTH2_ISSUER: http://127.0.0.1:8000\n    120: SOCIAL_AUTH_EDX_OAUTH2_KEY: ecommerce-sso-key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml", "content": "username: \"admin\"", "line": 137, "detection_span": [132, 142], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n\nstorageDriverName: \"ontap-nas\"     # should be the same as storageclass.parameters.backendType\nbackendName: \"nas-backend\"\nmanagementLIF: \"10.0.0.1\"\ndataLIF: \"10.0.0.2\"\nsvm: \"svm_nfs\"\n137:     username: \"admin\"\npassword: \"secret\"\n# nfsMountOptions: \"nfsvers=4\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n# Target line: 137\n\n    132:     storageDriverName: \"ontap-nas\"     # should be the same as storageclass.parameters.backendType\n    133:     backendName: \"nas-backend\"\n    134:     managementLIF: \"10.0.0.1\"\n    135:     dataLIF: \"10.0.0.2\"\n    136:     svm: \"svm_nfs\"\n>>> 137:     username: \"admin\"\n    138:     password: \"secret\"\n    139:     # nfsMountOptions: \"nfsvers=4\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml", "content": "- { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }", "line": 72, "detection_span": [67, 77], "with_context": "# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n\n#  shell: echo -e \"{{ kadmin_pass }}\\n{{ kadmin_pass }}\" | kadmin.local -q \"addprinc cloudera-scm/admin\" && touch /var/kerberos/cdh_admin_created creates=/var/kerberos/cdh_admin_created\n\n- name: create users\nkadduser: name='{{ item.name }}' password='{{ item.pass }}' params='{{ item.params }}'\nwith_items:\n72:     - { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n- { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n- { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n# Target line: 72\n\n     67: #  shell: echo -e \"{{ kadmin_pass }}\\n{{ kadmin_pass }}\" | kadmin.local -q \"addprinc cloudera-scm/admin\" && touch /var/kerberos/cdh_admin_created creates=/var/kerberos/cdh_admin_created\n     68: \n     69: - name: create users\n     70:   kadduser: name='{{ item.name }}' password='{{ item.pass }}' params='{{ item.params }}'\n     71:   with_items:\n>>>  72:     - { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n     73:     - { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n     74:     - { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n     75:     - { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n     76:     - { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n     77:     - { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dimagi_commcare-cloud-src-commcare_cloud-manage_commcare_cloud-monitors-pg_connections_high_icds.yml", "content": "env_key: host.environment", "line": 1, "detection_span": [1, 6], "with_context": "# Ansible file: dimagi_commcare-cloud-src-commcare_cloud-manage_commcare_cloud-monitors-pg_connections_high_icds.yml\n\n1: env_key: host.environment\nid: 5895436\nmessage: |-\n{{#is_alert}} {{value}} connections waiting on PgBouncer. Which is above threshold of {{threshold}} for the last 5 mins.{{/is_alert}}\n@slack-alerts-icds\nname: '[ICDS] PgBouncer connections waiting {{host.name}}'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dimagi_commcare-cloud-src-commcare_cloud-manage_commcare_cloud-monitors-pg_connections_high_icds.yml\n# Target line: 1\n\n>>>   1: env_key: host.environment\n      2: id: 5895436\n      3: message: |-\n      4:   {{#is_alert}} {{value}} connections waiting on PgBouncer. Which is above threshold of {{threshold}} for the last 5 mins.{{/is_alert}}\n      5:   @slack-alerts-icds\n      6: name: '[ICDS] PgBouncer connections waiting {{host.name}}'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "social-network_matrix-deployer-roles-matrix-bridge-mx-puppet-slack-defaults-main.yml", "content": "matrix_mx_puppet_slack_appservice_token: ''", "line": 47, "detection_span": [42, 52], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-mx-puppet-slack-defaults-main.yml\n\nmatrix_mx_puppet_slack_systemd_required_services_list: ['docker.service']\n\n# List of systemd services that matrix-puppet-slack.service wants\nmatrix_mx_puppet_slack_systemd_wanted_services_list: []\n\n47: matrix_mx_puppet_slack_appservice_token: ''\nmatrix_mx_puppet_slack_homeserver_token: ''\n\n# Default configuration template which covers the generic use case.\n# You can customize it by controlling the various variables inside it.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-mx-puppet-slack-defaults-main.yml\n# Target line: 47\n\n     42: matrix_mx_puppet_slack_systemd_required_services_list: ['docker.service']\n     43: \n     44: # List of systemd services that matrix-puppet-slack.service wants\n     45: matrix_mx_puppet_slack_systemd_wanted_services_list: []\n     46: \n>>>  47: matrix_mx_puppet_slack_appservice_token: ''\n     48: matrix_mx_puppet_slack_homeserver_token: ''\n     49: \n     50: # Default configuration template which covers the generic use case.\n     51: # You can customize it by controlling the various variables inside it.\n     52: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml", "content": "key: password", "line": 79, "detection_span": [74, 84], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n\nkey: username\n- name: DB_PASSWORD\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_DB}\"\n79:                 key: password\n- name: EC_CRT\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\nkey: crt", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n# Target line: 79\n\n     74:                 key: username\n     75:           - name: DB_PASSWORD\n     76:             valueFrom:\n     77:               secretKeyRef:\n     78:                 name: \"${EC_SECRET_DB}\"\n>>>  79:                 key: password\n     80:           - name: EC_CRT\n     81:             valueFrom:\n     82:               secretKeyRef:\n     83:                 name: \"${EC_SECRET_CRT}\"\n     84:                 key: crt\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cip_dci-openstack-agent-plays-prepare_local_mirror.yml", "content": "generate_ssh_key: 'yes'", "line": 35, "detection_span": [30, 40], "with_context": "# Ansible file: redhat-cip_dci-openstack-agent-plays-prepare_local_mirror.yml\n\nwith_fileglob: '{{ dci_mirror_location }}/dci_repo/dci_repo*.repo'\nbecome: true\n- name: Generating RSA key for stack\nuser:\nname: '{{ ansible_user_id }}'\n35:     generate_ssh_key: 'yes'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cip_dci-openstack-agent-plays-prepare_local_mirror.yml\n# Target line: 35\n\n     30:   with_fileglob: '{{ dci_mirror_location }}/dci_repo/dci_repo*.repo'\n     31:   become: true\n     32: - name: Generating RSA key for stack\n     33:   user:\n     34:     name: '{{ ansible_user_id }}'\n>>>  35:     generate_ssh_key: 'yes'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "zhangi_kolla-ansible-ansible-roles-cyborg-defaults-main.yml", "content": "cyborg_keystone_user: \"cyborg\"", "line": 132, "detection_span": [127, 137], "with_context": "# Ansible file: zhangi_kolla-ansible-ansible-roles-cyborg-defaults-main.yml\n\n127: cyborg_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n128: cyborg_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n129:\n130: cyborg_logging_debug: \"{{ openstack_logging_debug }}\"\n131:\n132: cyborg_keystone_user: \"cyborg\"\n133:\n134: openstack_cyborg_auth: \"{{ openstack_auth }}\"\n135:\n136:\n137: ####################", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: zhangi_kolla-ansible-ansible-roles-cyborg-defaults-main.yml\n# Target line: 132\n\n    127: cyborg_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n    128: cyborg_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n    129: \n    130: cyborg_logging_debug: \"{{ openstack_logging_debug }}\"\n    131: \n>>> 132: cyborg_keystone_user: \"cyborg\"\n    133: \n    134: openstack_cyborg_auth: \"{{ openstack_auth }}\"\n    135: \n    136: \n    137: ####################\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Tamilneediarasu_ansible-jboss-standalone-roles-jboss-standalone-tasks-main.yml", "content": "user: name=jboss group=jboss home=/usr/share/jboss-as", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: Tamilneediarasu_ansible-jboss-standalone-roles-jboss-standalone-tasks-main.yml\n\n\n- name: Add group \"jboss\"\ngroup: name=jboss\n\n- name: Add user \"jboss\"\n28:   user: name=jboss group=jboss home=/usr/share/jboss-as\n\n- name: Change ownership of JBoss installation\nfile: path=/usr/share/jboss-as/ owner=jboss group=jboss state=directory recurse=yes\n\n- name: Copy the init script", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Tamilneediarasu_ansible-jboss-standalone-roles-jboss-standalone-tasks-main.yml\n# Target line: 28\n\n     23: \n     24: - name: Add group \"jboss\"\n     25:   group: name=jboss\n     26: \n     27: - name: Add user \"jboss\"\n>>>  28:   user: name=jboss group=jboss home=/usr/share/jboss-as\n     29: \n     30: - name: Change ownership of JBoss installation\n     31:   file: path=/usr/share/jboss-as/ owner=jboss group=jboss state=directory recurse=yes\n     32: \n     33: - name: Copy the init script\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-playbooks-installer-rdo-manager-overcloud-heat-templates-run.yml", "content": "cert_filename: \"overcloud-cacert.pem\"", "line": 89, "detection_span": [84, 94], "with_context": "# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-overcloud-heat-templates-run.yml\n\n\n- name: fetch template from single remote host\ntls_tht:\nsource_dir: \"{{ instack_user_home }}/local_tht/\"\ndest_dir: \"{{ instack_user_home }}/\"\n89:             cert_filename: \"overcloud-cacert.pem\"\ncert_ca_filename: \"overcloud-cacert.pem\"\nkey_filename: \"overcloud-privkey.pem\"\nwhen: installer.ssl\n\n- name: copy the self-signed SSL cert", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-overcloud-heat-templates-run.yml\n# Target line: 89\n\n     84: \n     85:       - name: fetch template from single remote host\n     86:         tls_tht:\n     87:             source_dir: \"{{ instack_user_home }}/local_tht/\"\n     88:             dest_dir: \"{{ instack_user_home }}/\"\n>>>  89:             cert_filename: \"overcloud-cacert.pem\"\n     90:             cert_ca_filename: \"overcloud-cacert.pem\"\n     91:             key_filename: \"overcloud-privkey.pem\"\n     92:         when: installer.ssl\n     93: \n     94:       - name: copy the self-signed SSL cert\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga_ansible-playbooks-icinga2-ansible-web2-ui-defaults-main.yml", "content": "icinga2_db_user: \"icinga\"", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: Icinga_ansible-playbooks-icinga2-ansible-web2-ui-defaults-main.yml\n\n---\n# defaults file for icinga2-ansible-web2-ui\n\nicinga2_db: \"icinga\"\nicinga2_db_pass: \"icinga\"\n6: icinga2_db_user: \"icinga\"\nicinga2_web_mysql_schema: \"/usr/share/icinga2-ido-mysql/schema/mysql.sql\"\n\nicinga2_ido_mysql_conf: \"/etc/icinga2/features-available/ido-mysql.conf\"\n\nicinga2_web2_db: \"icingaweb\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Icinga_ansible-playbooks-icinga2-ansible-web2-ui-defaults-main.yml\n# Target line: 6\n\n      1: ---\n      2: # defaults file for icinga2-ansible-web2-ui\n      3: \n      4: icinga2_db: \"icinga\"\n      5: icinga2_db_pass: \"icinga\"\n>>>   6: icinga2_db_user: \"icinga\"\n      7: icinga2_web_mysql_schema: \"/usr/share/icinga2-ido-mysql/schema/mysql.sql\"\n      8: \n      9: icinga2_ido_mysql_conf: \"/etc/icinga2/features-available/ido-mysql.conf\"\n     10: \n     11: icinga2_web2_db: \"icingaweb\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-all.yml", "content": "public_key_src: files/keys/ubuntu_maintenance_key.pub", "line": 180, "detection_span": [175, 185], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n\n175: pulsar_job_metrics_plugins: \"{{ galaxy_job_metrics_plugins }}\"\n176:\n177: internal_ssh_keys:\n178:   ubuntu_maintenance_key:\nprivate_key_content: \"{{ vault_ubuntu_maintenance_key }}\"\n180:     public_key_src: files/keys/ubuntu_maintenance_key.pub\nuser: ubuntu\n182:\n183: # Golang\n184: golang_version: '1.15.6' # default for role version 2.6.3\n185: golang_install_dir: '/opt/go/{{ golang_version }}' # default for role version 2.6.3", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n# Target line: 180\n\n    175: pulsar_job_metrics_plugins: \"{{ galaxy_job_metrics_plugins }}\"\n    176: \n    177: internal_ssh_keys:\n    178:   ubuntu_maintenance_key:\n    179:     private_key_content: \"{{ vault_ubuntu_maintenance_key }}\"\n>>> 180:     public_key_src: files/keys/ubuntu_maintenance_key.pub\n    181:     user: ubuntu\n    182: \n    183: # Golang\n    184: golang_version: '1.15.6' # default for role version 2.6.3\n    185: golang_install_dir: '/opt/go/{{ golang_version }}' # default for role version 2.6.3\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml", "content": "kafka_connect_ldap_password: password", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n\nkafka_broker_ldap_user: kafka_broker\nkafka_broker_ldap_password: password\nschema_registry_ldap_user: schema_registry\nschema_registry_ldap_password: password\nkafka_connect_ldap_user: connect_worker\n44:     kafka_connect_ldap_password: password\nksql_ldap_user: ksql\nksql_ldap_password: password\nkafka_rest_ldap_user: rest_proxy\nkafka_rest_ldap_password: password\ncontrol_center_ldap_user: control_center", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n# Target line: 44\n\n     39:     kafka_broker_ldap_user: kafka_broker\n     40:     kafka_broker_ldap_password: password\n     41:     schema_registry_ldap_user: schema_registry\n     42:     schema_registry_ldap_password: password\n     43:     kafka_connect_ldap_user: connect_worker\n>>>  44:     kafka_connect_ldap_password: password\n     45:     ksql_ldap_user: ksql\n     46:     ksql_ldap_password: password\n     47:     kafka_rest_ldap_user: rest_proxy\n     48:     kafka_rest_ldap_password: password\n     49:     control_center_ldap_user: control_center\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "davestephens_ansible-nas-roles-bitwarden-defaults-main.yml", "content": "bitwarden_admin_token: qwertyuiop1234567890poiuytrewq0987654321", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: davestephens_ansible-nas-roles-bitwarden-defaults-main.yml\n\nbitwarden_ip_whitelist: \"0.0.0.0/0\"\n\n# Keep this token secret, this is password to access admin area of your server!\n# This token can be anything, but it's recommended to use a long, randomly generated string of characters,\n# for example running openssl rand -base64 48\n13: bitwarden_admin_token: qwertyuiop1234567890poiuytrewq0987654321\n\n# To create a user set this to \"true\", and reprovision the container by re-running the ansible-nas playbook.\n# Once you have created your user, set to \"false\" and run one more time.\n# Target just Bitwarden by running: ansible-playbook -i inventory nas.yml -b -K -t bitwarden\nbitwarden_allow_signups: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: davestephens_ansible-nas-roles-bitwarden-defaults-main.yml\n# Target line: 13\n\n      8: bitwarden_ip_whitelist: \"0.0.0.0/0\"\n      9: \n     10: # Keep this token secret, this is password to access admin area of your server!\n     11: # This token can be anything, but it's recommended to use a long, randomly generated string of characters,\n     12: # for example running openssl rand -base64 48\n>>>  13: bitwarden_admin_token: qwertyuiop1234567890poiuytrewq0987654321\n     14: \n     15: # To create a user set this to \"true\", and reprovision the container by re-running the ansible-nas playbook.\n     16: # Once you have created your user, set to \"false\" and run one more time.\n     17: # Target just Bitwarden by running: ansible-playbook -i inventory nas.yml -b -K -t bitwarden\n     18: bitwarden_allow_signups: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "aa_ala_password: secret", "line": 68, "detection_span": [63, 73], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\naa_sab_password: secret\naa_idin_client_secret: secret\naa_orcid_password: secret\naa_surfmarket_password: secret\naa_sbs_password: secret\n68: aa_ala_password: secret\naa_manage_password: secret\n\nmanage_pdp_password: secret\nattribute_aggregator_js_access_token: secret\npdp_js_access_token: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 68\n\n     63: aa_sab_password: secret\n     64: aa_idin_client_secret: secret\n     65: aa_orcid_password: secret\n     66: aa_surfmarket_password: secret\n     67: aa_sbs_password: secret\n>>>  68: aa_ala_password: secret\n     69: aa_manage_password: secret\n     70: \n     71: manage_pdp_password: secret\n     72: attribute_aggregator_js_access_token: secret\n     73: pdp_js_access_token: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-playbooks-roles-mariadb-defaults-main.yml", "content": "MARIADB_CLUSTER_USER_ADMIN: \"mariadb_clu_root\"", "line": 21, "detection_span": [16, 26], "with_context": "# Ansible file: openedx_configuration-playbooks-roles-mariadb-defaults-main.yml\n\n# Note: version is determined by repo\nMARIADB_REPO: \"deb http://mirrors.syringanetworks.net/mariadb/repo/10.0/ubuntu {{ ansible_distribution_release }} main\"\n\nMARIADB_CREATE_DBS: yes\nMARIADB_CLUSTERED: no\n21: MARIADB_CLUSTER_USER_ADMIN: \"mariadb_clu_root\"\nMARIADB_CLUSTER_PASSWORD_ADMIN: \"password\"\nMARIADB_HOST_PRIV: '%'\n\nMARIADB_HAPROXY_USER: 'haproxy'\nMARIADB_HAPROXY_HOSTS:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-playbooks-roles-mariadb-defaults-main.yml\n# Target line: 21\n\n     16: # Note: version is determined by repo\n     17: MARIADB_REPO: \"deb http://mirrors.syringanetworks.net/mariadb/repo/10.0/ubuntu {{ ansible_distribution_release }} main\"\n     18: \n     19: MARIADB_CREATE_DBS: yes\n     20: MARIADB_CLUSTERED: no\n>>>  21: MARIADB_CLUSTER_USER_ADMIN: \"mariadb_clu_root\"\n     22: MARIADB_CLUSTER_PASSWORD_ADMIN: \"password\"\n     23: MARIADB_HOST_PRIV: '%'\n     24: \n     25: MARIADB_HAPROXY_USER: 'haproxy'\n     26: MARIADB_HAPROXY_HOSTS:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "IBM_z_ansible_collections_samples-zos_concepts-certificate_management-create_SITE_cert_tsocmd.yml", "content": "cert_label: 'ANDY SITE'", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-certificate_management-create_SITE_cert_tsocmd.yml\n\n- ibm.ibm_zos_core\ngather_facts: no\nenvironment: \"{{ environment_vars }}\"\nvars:\nowner_id: 'OMVSKERN'\n12:     cert_label: 'ANDY SITE'\nsign_label: 'ANDY CA'\ncn: '{{cert_label}}.svl.ibm.com'\nou: '{{cert_label}}'\ncountry: 'US'\nexpiry_date: '2021-12-28'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-certificate_management-create_SITE_cert_tsocmd.yml\n# Target line: 12\n\n      7:     - ibm.ibm_zos_core\n      8:   gather_facts: no\n      9:   environment: \"{{ environment_vars }}\"\n     10:   vars:\n     11:     owner_id: 'OMVSKERN'\n>>>  12:     cert_label: 'ANDY SITE'\n     13:     sign_label: 'ANDY CA'\n     14:     cn: '{{cert_label}}.svl.ibm.com'\n     15:     ou: '{{cert_label}}'\n     16:     country: 'US'\n     17:     expiry_date: '2021-12-28'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "enthought_edx_ansible-playbooks-roles-insights-defaults-main.yml", "content": "INSIGHTS_EMAIL_HOST_PASSWORD: \"mail_password\"", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-insights-defaults-main.yml\n\n# should match the timezone of your map reduce pipeline\nINSIGHTS_TIME_ZONE: 'UTC'\nINSIGHTS_LANGUAGE_CODE: 'en-us'\n# email config\nINSIGHTS_EMAIL_HOST: 'smtp.example.com'\n46: INSIGHTS_EMAIL_HOST_PASSWORD: \"mail_password\"\nINSIGHTS_EMAIL_HOST_USER: \"mail_user\"\nINSIGHTS_EMAIL_PORT: 587\nINSIGHTS_ENABLE_AUTO_AUTH: false\nINSIGHTS_SEGMENT_IGNORE_EMAIL_REGEX: !!null\nINSIGHTS_THEME_SCSS: 'sass/themes/open-edx.scss'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-insights-defaults-main.yml\n# Target line: 46\n\n     41: # should match the timezone of your map reduce pipeline\n     42: INSIGHTS_TIME_ZONE: 'UTC'\n     43: INSIGHTS_LANGUAGE_CODE: 'en-us'\n     44: # email config\n     45: INSIGHTS_EMAIL_HOST: 'smtp.example.com'\n>>>  46: INSIGHTS_EMAIL_HOST_PASSWORD: \"mail_password\"\n     47: INSIGHTS_EMAIL_HOST_USER: \"mail_user\"\n     48: INSIGHTS_EMAIL_PORT: 587\n     49: INSIGHTS_ENABLE_AUTO_AUTH: false\n     50: INSIGHTS_SEGMENT_IGNORE_EMAIL_REGEX: !!null\n     51: INSIGHTS_THEME_SCSS: 'sass/themes/open-edx.scss'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sensu_sensu-go-ansible-vagrant-windows-inventory.yaml", "content": "ansible_password: vagrant", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: sensu_sensu-go-ansible-vagrant-windows-inventory.yaml\n\nhosts:\nwindows:\nansible_host: 192.168.50.90\nansible_port: 5985\nansible_user: vagrant\n8:       ansible_password: vagrant\nansible_connection: winrm\nansible_winrm_transport: basic", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sensu_sensu-go-ansible-vagrant-windows-inventory.yaml\n# Target line: 8\n\n      3:   hosts:\n      4:     windows:\n      5:       ansible_host: 192.168.50.90\n      6:       ansible_port: 5985\n      7:       ansible_user: vagrant\n>>>   8:       ansible_password: vagrant\n      9:       ansible_connection: winrm\n     10:       ansible_winrm_transport: basic\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "social-network_matrix-deployer-roles-matrix-base-defaults-main.yml", "content": "matrix_user_username: \"matrix\"", "line": 24, "detection_span": [19, 29], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-base-defaults-main.yml\n\nmatrix_server_fqn_dimension: \"dimension.{{ matrix_domain }}\"\n\n# This is where you access Jitsi.\nmatrix_server_fqn_jitsi: \"jitsi.{{ matrix_domain }}\"\n\n24: matrix_user_username: \"matrix\"\nmatrix_user_groupname: \"matrix\"\n\nmatrix_base_data_path: \"/matrix\"\nmatrix_base_data_path_mode: \"750\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-base-defaults-main.yml\n# Target line: 24\n\n     19: matrix_server_fqn_dimension: \"dimension.{{ matrix_domain }}\"\n     20: \n     21: # This is where you access Jitsi.\n     22: matrix_server_fqn_jitsi: \"jitsi.{{ matrix_domain }}\"\n     23: \n>>>  24: matrix_user_username: \"matrix\"\n     25: matrix_user_groupname: \"matrix\"\n     26: \n     27: matrix_base_data_path: \"/matrix\"\n     28: matrix_base_data_path_mode: \"750\"\n     29: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulp_pulp-operator-roles-pulp-api-tasks-s3-storage-configuration.yml", "content": "s3_secret_access_key_available: true", "line": 35, "detection_span": [30, 40], "with_context": "# Ansible file: pulp_pulp-operator-roles-pulp-api-tasks-s3-storage-configuration.yml\n\n- _custom_s3_configuration.resources[0].data['s3-access-key-id'] is defined\n- _custom_s3_configuration.resources[0].data['s3-access-key-id'] | length\n\n- name: Check if s3-secret-access-key is found\nset_fact:\n35:     s3_secret_access_key_available: true\nwhen:\n- s3_secret_data_available\n- _custom_s3_configuration.resources[0].data['s3-secret-access-key'] is defined\n- _custom_s3_configuration.resources[0].data['s3-secret-access-key'] | length\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulp_pulp-operator-roles-pulp-api-tasks-s3-storage-configuration.yml\n# Target line: 35\n\n     30:     - _custom_s3_configuration.resources[0].data['s3-access-key-id'] is defined\n     31:     - _custom_s3_configuration.resources[0].data['s3-access-key-id'] | length\n     32: \n     33: - name: Check if s3-secret-access-key is found\n     34:   set_fact:\n>>>  35:     s3_secret_access_key_available: true\n     36:   when:\n     37:     - s3_secret_data_available\n     38:     - _custom_s3_configuration.resources[0].data['s3-secret-access-key'] is defined\n     39:     - _custom_s3_configuration.resources[0].data['s3-secret-access-key'] | length\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "confluentinc_cp-ansible-docs-sample_inventories-kafka_connect_replicator.yml", "content": "kafka_connect_replicator_ssl_ca_cert_path: \"/generated_ssl_files/ca.crt\"", "line": 21, "detection_span": [16, 26], "with_context": "# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-kafka_connect_replicator.yml\n\n\nkafka_connect_replicator_white_list: test-replicator-source\nkafka_connect_replicator_bootstrap_servers: ip-10-0-0-10.eu-west-2.compute.internal:9092\nkafka_connect_replicator_kerberos_principal: \"replicator/kafka-connect-replicator1.confluent@CONFLUENT.EXAMPLE.COM\"\nkafka_connect_replicator_kerberos_keytab_path: \"/keytabs/kafka-connect-replicator1.keytab\"\n21:     kafka_connect_replicator_ssl_ca_cert_path: \"/generated_ssl_files/ca.crt\"\nkafka_connect_replicator_ssl_cert_path: \"/generated_ssl_files/{{inventory_hostname}}-ca1-signed.crt\"\nkafka_connect_replicator_ssl_key_path: \"/generated_ssl_files/{{inventory_hostname}}-key.pem\"\nkafka_connect_replicator_ssl_key_password: keypass\n\nkafka_connect_replicator_consumer_listener:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-kafka_connect_replicator.yml\n# Target line: 21\n\n     16: \n     17:     kafka_connect_replicator_white_list: test-replicator-source\n     18:     kafka_connect_replicator_bootstrap_servers: ip-10-0-0-10.eu-west-2.compute.internal:9092\n     19:     kafka_connect_replicator_kerberos_principal: \"replicator/kafka-connect-replicator1.confluent@CONFLUENT.EXAMPLE.COM\"\n     20:     kafka_connect_replicator_kerberos_keytab_path: \"/keytabs/kafka-connect-replicator1.keytab\"\n>>>  21:     kafka_connect_replicator_ssl_ca_cert_path: \"/generated_ssl_files/ca.crt\"\n     22:     kafka_connect_replicator_ssl_cert_path: \"/generated_ssl_files/{{inventory_hostname}}-ca1-signed.crt\"\n     23:     kafka_connect_replicator_ssl_key_path: \"/generated_ssl_files/{{inventory_hostname}}-key.pem\"\n     24:     kafka_connect_replicator_ssl_key_password: keypass\n     25: \n     26:     kafka_connect_replicator_consumer_listener:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nkeystone_auth_admin_password: secrete\nkeystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\nkeystone_container_mysql_password: a94e95b30824305cda80caba7cac67\nkeystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\nmemcached_encryption_key: 78a191237b291b66e23a49c3\n28: neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443\nneutron_service_password: 5043b5b40b09d31781afe9704\nnova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\nnova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 28\n\n     23: keystone_auth_admin_password: secrete\n     24: keystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\n     25: keystone_container_mysql_password: a94e95b30824305cda80caba7cac67\n     26: keystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\n     27: memcached_encryption_key: 78a191237b291b66e23a49c3\n>>>  28: neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443\n     29: neutron_service_password: 5043b5b40b09d31781afe9704\n     30: nova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\n     31: nova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "teams_api_lifecycle_password: secret", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nvoot_oidcng_checkToken_secret: secret\n\nexternal_group_provider_secrets:\nteams: secret\n\n49: teams_api_lifecycle_password: secret\nteams_api_spdashboard_password: secret\nattribute_aggregator_api_lifecycle_password: secret\n\noidc_playground_secret: secret\noidc_playground_jwt_secret: very-long-long-long-long-long-secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 49\n\n     44: voot_oidcng_checkToken_secret: secret\n     45: \n     46: external_group_provider_secrets:\n     47:   teams: secret\n     48: \n>>>  49: teams_api_lifecycle_password: secret\n     50: teams_api_spdashboard_password: secret\n     51: attribute_aggregator_api_lifecycle_password: secret\n     52: \n     53: oidc_playground_secret: secret\n     54: oidc_playground_jwt_secret: very-long-long-long-long-long-secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_infra-ansible-inventory-rh-sso-group_vars-rh-sso-hosts.yml", "content": "keystore_pass: changeit", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: redhat-cop_infra-ansible-inventory-rh-sso-group_vars-rh-sso-hosts.yml\n\nrh_sso_protocol: https\nrh_sso_ssl:\ncert: /the/path/to/my/cert.crt\nkey: /the/path/to/my/cert.key\nkeystore_name: default\n17:   keystore_pass: changeit\nkeystore_path: \"/etc/security/keystore.jks\"\n\nrealms:\n- name: my-awesome-realm\nid: my-awesome-realm", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_infra-ansible-inventory-rh-sso-group_vars-rh-sso-hosts.yml\n# Target line: 17\n\n     12: rh_sso_protocol: https\n     13: rh_sso_ssl:\n     14:   cert: /the/path/to/my/cert.crt\n     15:   key: /the/path/to/my/cert.key\n     16:   keystore_name: default\n>>>  17:   keystore_pass: changeit\n     18:   keystore_path: \"/etc/security/keystore.jks\"\n     19: \n     20: realms:\n     21:   - name: my-awesome-realm\n     22:     id: my-awesome-realm\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-evpn_underlay_ebgp_overlay_ebgp-intended-structured_configs-DC1-L2LEAF3A.yml", "content": "key: telarista", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-evpn_underlay_ebgp_overlay_ebgp-intended-structured_configs-DC1-L2LEAF3A.yml\n\ndaemon_terminattr:\ncvaddrs:\n- 192.168.200.11:9910\ncvauth:\nmethod: key\n12:     key: telarista\ncvvrf: MGMT\nsmashexcludes: ale,flexCounter,hardware,kni,pulse,strata\ningestexclude: /Sysdb/cell/1/agent,/Sysdb/cell/2/agent\ndisable_aaa: false\nvlan_internal_order:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-evpn_underlay_ebgp_overlay_ebgp-intended-structured_configs-DC1-L2LEAF3A.yml\n# Target line: 12\n\n      7: daemon_terminattr:\n      8:   cvaddrs:\n      9:   - 192.168.200.11:9910\n     10:   cvauth:\n     11:     method: key\n>>>  12:     key: telarista\n     13:   cvvrf: MGMT\n     14:   smashexcludes: ale,flexCounter,hardware,kni,pulse,strata\n     15:   ingestexclude: /Sysdb/cell/1/agent,/Sysdb/cell/2/agent\n     16:   disable_aaa: false\n     17: vlan_internal_order:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloud-bulldozer_browbeat-ansible-gather-group_vars-all.yml", "content": "host_remote_user: heat-admin", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: cloud-bulldozer_browbeat-ansible-gather-group_vars-all.yml\n\n# Adjust Browbeat user if you are deploying Browbeat on a different machine than the Undercloud\nbrowbeat_user: \"{{ ansible_user | default('stack') }}\"\n# Login user for the local/jump machine (Typically Undercloud)\nlocal_remote_user: \"{{ ansible_user | default('stack') }}\"\n# Login user for the Overcloud hosts\n8: host_remote_user: heat-admin\n\nhome_dir: \"/home/{{ browbeat_user }}\"\nbrowbeat_path: \"{{ home_dir }}/browbeat\"\ncontainer_cli: docker", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloud-bulldozer_browbeat-ansible-gather-group_vars-all.yml\n# Target line: 8\n\n      3: # Adjust Browbeat user if you are deploying Browbeat on a different machine than the Undercloud\n      4: browbeat_user: \"{{ ansible_user | default('stack') }}\"\n      5: # Login user for the local/jump machine (Typically Undercloud)\n      6: local_remote_user: \"{{ ansible_user | default('stack') }}\"\n      7: # Login user for the Overcloud hosts\n>>>   8: host_remote_user: heat-admin\n      9: \n     10: home_dir: \"/home/{{ browbeat_user }}\"\n     11: browbeat_path: \"{{ home_dir }}/browbeat\"\n     12: container_cli: docker\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "crv4all_openshift-ansible-roles-openshift_console-tasks-install.yml", "content": "- key: auth#oauthEndpointCAFile", "line": 56, "detection_span": [51, 61], "with_context": "# Ansible file: crv4all_openshift-ansible-roles-openshift_console-tasks-install.yml\n\nvalue: \"https://{{ openshift_console_hostname }}\"\n- key: clusterInfo#consoleBasePath\nvalue: \"{{ openshift_console_base_path | default('') }}\"\n- key: clusterInfo#masterPublicURL\nvalue: \"{{ openshift.master.public_api_url }}\"\n56:     - key: auth#oauthEndpointCAFile\nvalue: \"{{ openshift_console_auth_ca_file }}\"\n- key: auth#logoutRedirect\nvalue: \"{{ openshift.master.logout_url | default('') }}\"\n- key: customization#logoImageName\nvalue: \"{{ openshift_console_logo_image_name }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-roles-openshift_console-tasks-install.yml\n# Target line: 56\n\n     51:       value: \"https://{{ openshift_console_hostname }}\"\n     52:     - key: clusterInfo#consoleBasePath\n     53:       value: \"{{ openshift_console_base_path | default('') }}\"\n     54:     - key: clusterInfo#masterPublicURL\n     55:       value: \"{{ openshift.master.public_api_url }}\"\n>>>  56:     - key: auth#oauthEndpointCAFile\n     57:       value: \"{{ openshift_console_auth_ca_file }}\"\n     58:     - key: auth#logoutRedirect\n     59:       value: \"{{ openshift.master.logout_url | default('') }}\"\n     60:     - key: customization#logoImageName\n     61:       value: \"{{ openshift_console_logo_image_name }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml", "content": "url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace\"", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n\nregister: workspace_devfile\nignore_errors: yes\n\n- name: Get workspace for {{ ocp4_workload_iot_managed_workshop_openshift_user_username}}\nuri:\n61:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace\"\nmethod: GET\nheaders:\nAccept: application/json\nAuthorization: \"Bearer {{ access_token }}\"\nstatus_code: 200", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n# Target line: 61\n\n     56:   register: workspace_devfile\n     57:   ignore_errors: yes\n     58:   \n     59: - name: Get workspace for {{ ocp4_workload_iot_managed_workshop_openshift_user_username}}\n     60:   uri:\n>>>  61:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace\"\n     62:     method: GET\n     63:     headers:\n     64:       Accept: application/json\n     65:       Authorization: \"Bearer {{ access_token }}\"\n     66:     status_code: 200\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "social-network_matrix-deployer-roles-matrix-bridge-appservice-discord-defaults-main.yml", "content": "matrix_appservice_discord_appservice_url: 'http://matrix-appservice-discord:9005'", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-discord-defaults-main.yml\n\nmatrix_appservice_discord_systemd_required_services_list: ['docker.service']\n\n# List of systemd services that matrix-appservice-discord.service wants\nmatrix_appservice_discord_systemd_wanted_services_list: []\n\n34: matrix_appservice_discord_appservice_url: 'http://matrix-appservice-discord:9005'\n\nmatrix_appservice_discord_bridge_domain: \"{{ matrix_domain }}\"\n# As of right now, the homeserver URL must be a public URL. See below.\nmatrix_appservice_discord_bridge_homeserverUrl: \"{{ matrix_homeserver_url }}\"\nmatrix_appservice_discord_bridge_disablePresence: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-discord-defaults-main.yml\n# Target line: 34\n\n     29: matrix_appservice_discord_systemd_required_services_list: ['docker.service']\n     30: \n     31: # List of systemd services that matrix-appservice-discord.service wants\n     32: matrix_appservice_discord_systemd_wanted_services_list: []\n     33: \n>>>  34: matrix_appservice_discord_appservice_url: 'http://matrix-appservice-discord:9005'\n     35: \n     36: matrix_appservice_discord_bridge_domain: \"{{ matrix_domain }}\"\n     37: # As of right now, the homeserver URL must be a public URL. See below.\n     38: matrix_appservice_discord_bridge_homeserverUrl: \"{{ matrix_homeserver_url }}\"\n     39: matrix_appservice_discord_bridge_disablePresence: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "carlosthe19916_openshift-ansible-playbooks-adhoc-zabbix_setup-create_app.yml", "content": "g_zserver: http://oso-rhel7-zabbix-web.kwoodsontest2.opstest.online.openshift.com/zabbix/api_jsonrpc.php", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: carlosthe19916_openshift-ansible-playbooks-adhoc-zabbix_setup-create_app.yml\n\ngather_facts: no\nvars_files:\n- vars/template_heartbeat.yml\n- vars/template_os_linux.yml\nvars:\n8:     g_zserver: http://oso-rhel7-zabbix-web.kwoodsontest2.opstest.online.openshift.com/zabbix/api_jsonrpc.php\ng_zuser: Admin\ng_zpassword: zabbix\nroles:\n- ../roles/os_zabbix\npost_tasks:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: carlosthe19916_openshift-ansible-playbooks-adhoc-zabbix_setup-create_app.yml\n# Target line: 8\n\n      3:   gather_facts: no\n      4:   vars_files:\n      5:   - vars/template_heartbeat.yml\n      6:   - vars/template_os_linux.yml\n      7:   vars:\n>>>   8:     g_zserver: http://oso-rhel7-zabbix-web.kwoodsontest2.opstest.online.openshift.com/zabbix/api_jsonrpc.php\n      9:     g_zuser: Admin\n     10:     g_zpassword: zabbix\n     11:   roles:\n     12:   - ../roles/os_zabbix\n     13:   post_tasks:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-streaming-tasks-provision_crw.yaml", "content": "url: 'http://keycloak-{{ che_project }}.{{ route_subdomain }}/auth/admin/realms/master'", "line": 89, "detection_span": [84, 94], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-streaming-tasks-provision_crw.yaml\n\nset_fact:\nadmin_token: '{{token_result.json.access_token}}'\n\n- name: Increase Token Lifespan (60mins)\nuri:\n89:     url: 'http://keycloak-{{ che_project }}.{{ route_subdomain }}/auth/admin/realms/master'\nmethod: PUT\nbody: \"{\\\"realm\\\":\\\"master\\\", \\\"accessTokenLifespan\\\":\\\"3600\\\"}\"\nbody_format: json\nheaders:\nContent-Type: \"application/json\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-streaming-tasks-provision_crw.yaml\n# Target line: 89\n\n     84:   set_fact:\n     85:     admin_token: '{{token_result.json.access_token}}'\n     86: \n     87: - name: Increase Token Lifespan (60mins)\n     88:   uri:\n>>>  89:     url: 'http://keycloak-{{ che_project }}.{{ route_subdomain }}/auth/admin/realms/master'\n     90:     method: PUT\n     91:     body: \"{\\\"realm\\\":\\\"master\\\", \\\"accessTokenLifespan\\\":\\\"3600\\\"}\"\n     92:     body_format: json\n     93:     headers:\n     94:       Content-Type: \"application/json\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Islandora-Devops_islandora-playbook-inventory-vagrant-group_vars-alpaca.yml", "content": "alpaca_houdini_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/houdini\"", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: Islandora-Devops_islandora-playbook-inventory-vagrant-group_vars-alpaca.yml\n\n\n\ntriplestore_namespace: islandora\nalpaca_triplestore_base_url: \"http://{{ hostvars[groups['tomcat'][0]].ansible_host  }}:8080/bigdata\"\nalpaca_milliner_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/milliner/\"\n13:  alpaca_houdini_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/houdini\"\nalpaca_homarus_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/homarus\"\nalpaca_hypercube_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/hypercube\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Islandora-Devops_islandora-playbook-inventory-vagrant-group_vars-alpaca.yml\n# Target line: 13\n\n      8: \n      9: \n     10:  triplestore_namespace: islandora\n     11:  alpaca_triplestore_base_url: \"http://{{ hostvars[groups['tomcat'][0]].ansible_host  }}:8080/bigdata\"\n     12:  alpaca_milliner_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/milliner/\"\n>>>  13:  alpaca_houdini_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/houdini\"\n     14:  alpaca_homarus_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/homarus\"\n     15:  alpaca_hypercube_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/hypercube\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.crayfish-defaults-main.yml", "content": "pcdm: \"http://pcdm.org/models#\"", "line": 130, "detection_span": [125, 135], "with_context": "# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.crayfish-defaults-main.yml\n\n125: crayfish_recast_prefixes:\n126:   acl: \"http://www.w3.org/ns/auth/acl#\"\n127:   fedora: \"http://fedora.info/definitions/v4/repository#\"\n128:   ldp: \"http://www.w3.org/ns/ldp#\"\n129:   memento: \"http://mementoweb.org/ns#\"\n130:   pcdm: \"http://pcdm.org/models#\"\n131:   pcdmuse: \"http://pcdm.org/use#\"\n132:   webac: \"http://fedora.info/definitions/v4/webac#\"\n133:   vcard: \"http://www.w3.org/2006/vcard/ns#\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.crayfish-defaults-main.yml\n# Target line: 130\n\n    125: crayfish_recast_prefixes:\n    126:   acl: \"http://www.w3.org/ns/auth/acl#\"\n    127:   fedora: \"http://fedora.info/definitions/v4/repository#\"\n    128:   ldp: \"http://www.w3.org/ns/ldp#\"\n    129:   memento: \"http://mementoweb.org/ns#\"\n>>> 130:   pcdm: \"http://pcdm.org/models#\"\n    131:   pcdmuse: \"http://pcdm.org/use#\"\n    132:   webac: \"http://fedora.info/definitions/v4/webac#\"\n    133:   vcard: \"http://www.w3.org/2006/vcard/ns#\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "shourya7_Ansible_sha-ansible-configs-bu-workshop-files-import_gitlab_repos.yml", "content": "url: 'http://{{ gitlab_hostname }}/api/v3/projects'", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: shourya7_Ansible_sha-ansible-configs-bu-workshop-files-import_gitlab_repos.yml\n\nregister: project_absent\nignore_errors: true\n\n- name: 'Import nationalparks repository for {{ item }}'\nuri:\n26:     url: 'http://{{ gitlab_hostname }}/api/v3/projects'\nHEADER_PRIVATE-TOKEN: \"{{token_out.json.private_token}}\"\nbody: 'name=nationalparks&import_url=https://github.com/openshift-roadshow/nationalparks&public=true'\nmethod: POST\nstatus_code: 201\nreturn_content: no", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: shourya7_Ansible_sha-ansible-configs-bu-workshop-files-import_gitlab_repos.yml\n# Target line: 26\n\n     21:   register: project_absent\n     22:   ignore_errors: true\n     23: \n     24: - name: 'Import nationalparks repository for {{ item }}'\n     25:   uri:\n>>>  26:     url: 'http://{{ gitlab_hostname }}/api/v3/projects'\n     27:     HEADER_PRIVATE-TOKEN: \"{{token_out.json.private_token}}\"\n     28:     body: 'name=nationalparks&import_url=https://github.com/openshift-roadshow/nationalparks&public=true'\n     29:     method: POST\n     30:     status_code: 201\n     31:     return_content: no\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack_tripleo-quickstart-config-release-master.yml", "content": "baseurl: http://mirror.centos.org/centos/8-stream/HighAvailability/x86_64/os/", "line": 69, "detection_span": [64, 74], "with_context": "# Ansible file: openstack_tripleo-quickstart-config-release-master.yml\n\nbaseurl: http://mirror.centos.org/centos/8-stream/PowerTools/x86_64/os/\n\n- type: generic\nreponame: quickstart-centos-highavailability\nfilename: quickstart-centos-highavailability.repo\n69:     baseurl: http://mirror.centos.org/centos/8-stream/HighAvailability/x86_64/os/\n\n- type: generic\nreponame: quickstart-centos-extras\nfilename: quickstart-centos-extras.repo\nbaseurl: http://mirror.centos.org/centos/8-stream/extras/x86_64/os/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-quickstart-config-release-master.yml\n# Target line: 69\n\n     64:     baseurl: http://mirror.centos.org/centos/8-stream/PowerTools/x86_64/os/\n     65: \n     66:   - type: generic\n     67:     reponame: quickstart-centos-highavailability\n     68:     filename: quickstart-centos-highavailability.repo\n>>>  69:     baseurl: http://mirror.centos.org/centos/8-stream/HighAvailability/x86_64/os/\n     70: \n     71:   - type: generic\n     72:     reponame: quickstart-centos-extras\n     73:     filename: quickstart-centos-extras.repo\n     74:     baseurl: http://mirror.centos.org/centos/8-stream/extras/x86_64/os/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack_tripleo-quickstart-config-release-centosci-CentOS-8-train-current-tripleo.yml", "content": "baseurl: http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/", "line": 38, "detection_span": [33, 43], "with_context": "# Ansible file: openstack_tripleo-quickstart-config-release-centosci-CentOS-8-train-current-tripleo.yml\n\ndown_url: https://trunk.rdoproject.org/{{ distro_ver }}-{{ release }}/delorean-deps.repo\n\n- type: generic\nreponame: quickstart-centos-base\nfilename: quickstart-centos-base.repo\n38:     baseurl: http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/\n\n- type: generic\nreponame: quickstart-centos-appstreams\nfilename: quickstart-centos-appstreams.repo\nbaseurl: http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-quickstart-config-release-centosci-CentOS-8-train-current-tripleo.yml\n# Target line: 38\n\n     33:     down_url: https://trunk.rdoproject.org/{{ distro_ver }}-{{ release }}/delorean-deps.repo\n     34: \n     35:   - type: generic\n     36:     reponame: quickstart-centos-base\n     37:     filename: quickstart-centos-base.repo\n>>>  38:     baseurl: http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/\n     39: \n     40:   - type: generic\n     41:     reponame: quickstart-centos-appstreams\n     42:     filename: quickstart-centos-appstreams.repo\n     43:     baseurl: http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml", "content": "url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace/{{ workspace_def.json[0].id }}/runtime\"", "line": 82, "detection_span": [77, 87], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n\n\n\n- name: Verify and start workspace for {{ ocp_username }} again if stopped\nwhen: workspace_def.json[0].status == \"STOPPED\"\nuri:\n82:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace/{{ workspace_def.json[0].id }}/runtime\"\nmethod: POST\nheaders:\nAccept: application/json\nAuthorization: \"Bearer {{ access_token }}\"\nstatus_code: 200", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n# Target line: 82\n\n     77:     \n     78:     \n     79: - name: Verify and start workspace for {{ ocp_username }} again if stopped\n     80:   when: workspace_def.json[0].status == \"STOPPED\"\n     81:   uri:\n>>>  82:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace/{{ workspace_def.json[0].id }}/runtime\"\n     83:     method: POST\n     84:     headers:\n     85:       Accept: application/json\n     86:       Authorization: \"Bearer {{ access_token }}\"\n     87:     status_code: 200\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack_kolla-ansible-roles-cephadm-defaults-main.yml", "content": "cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n- shortname: \"ceph-noarch\"\nname: \"Ceph noarch repository\"\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n\n13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n\ncephadm_ceph_osd_devices:\n- primary:/dev/cephvg/cephlv\n- secondary1:/dev/cephvg/cephlv\n- secondary2:/dev/cephvg/cephlv", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n# Target line: 13\n\n      8:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n      9:   - shortname: \"ceph-noarch\"\n     10:     name: \"Ceph noarch repository\"\n     11:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n     12: \n>>>  13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n     14: \n     15: cephadm_ceph_osd_devices:\n     16:   - primary:/dev/cephvg/cephlv\n     17:   - secondary1:/dev/cephvg/cephlv\n     18:   - secondary2:/dev/cephvg/cephlv\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "geerlingguy_ansible-role-jenkins-tasks-main.yml", "content": "url: \"http://{{ jenkins_hostname }}:{{ jenkins_http_port }}{{ jenkins_url_prefix }}/cli/\"", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: geerlingguy_ansible-role-jenkins-tasks-main.yml\n\n- name: Ensure Jenkins is started and runs on startup.\nservice: name=jenkins state=started enabled=yes\n\n- name: Wait for Jenkins to start up before proceeding.\nuri:\n37:     url: \"http://{{ jenkins_hostname }}:{{ jenkins_http_port }}{{ jenkins_url_prefix }}/cli/\"\nmethod: GET\nreturn_content: \"yes\"\ntimeout: 5\nbody_format: raw\nfollow_redirects: \"no\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_ansible-role-jenkins-tasks-main.yml\n# Target line: 37\n\n     32: - name: Ensure Jenkins is started and runs on startup.\n     33:   service: name=jenkins state=started enabled=yes\n     34: \n     35: - name: Wait for Jenkins to start up before proceeding.\n     36:   uri:\n>>>  37:     url: \"http://{{ jenkins_hostname }}:{{ jenkins_http_port }}{{ jenkins_url_prefix }}/cli/\"\n     38:     method: GET\n     39:     return_content: \"yes\"\n     40:     timeout: 5\n     41:     body_format: raw\n     42:     follow_redirects: \"no\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "enthought_edx_ansible-playbooks-roles-common_vars-defaults-main.yml", "content": "COMMON_UBUNTU_APT_KEYSERVER: \"http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=\"", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-common_vars-defaults-main.yml\n\n\nCOMMON_ENVIRONMENT: 'default_env'\nCOMMON_DEPLOYMENT: 'default_deployment'\nCOMMON_PYPI_MIRROR_URL: 'https://pypi.python.org/simple'\nCOMMON_NPM_MIRROR_URL: 'http://registry.npmjs.org'\n44: COMMON_UBUNTU_APT_KEYSERVER: \"http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=\"\n\nCOMMON_EDX_PPA: \"deb http://ppa.edx.org {{ ansible_distribution_release }} main\"\nCOMMON_EDX_PPA_KEY_SERVER: \"keyserver.ubuntu.com\"\nCOMMON_EDX_PPA_KEY_ID: \"69464050\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-common_vars-defaults-main.yml\n# Target line: 44\n\n     39:     \n     40: COMMON_ENVIRONMENT: 'default_env'\n     41: COMMON_DEPLOYMENT: 'default_deployment'\n     42: COMMON_PYPI_MIRROR_URL: 'https://pypi.python.org/simple'\n     43: COMMON_NPM_MIRROR_URL: 'http://registry.npmjs.org'\n>>>  44: COMMON_UBUNTU_APT_KEYSERVER: \"http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=\"\n     45: \n     46: COMMON_EDX_PPA: \"deb http://ppa.edx.org {{ ansible_distribution_release }} main\"\n     47: COMMON_EDX_PPA_KEY_SERVER: \"keyserver.ubuntu.com\"\n     48: COMMON_EDX_PPA_KEY_ID: \"69464050\"\n     49: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "trustedanalytics_platform-ansible-defaults-yum_repos.yml", "content": "baseurl: http://dl.fedoraproject.org/pub/epel/6/x86_64/", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: trustedanalytics_platform-ansible-defaults-yum_repos.yml\n\nname: Extra Packages for Enterprise Linux 6 - $basearch\nenabled: 1\nfailovermethod: priority\ngpgcheck: 1\ngpgkey: http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\n9:     baseurl: http://dl.fedoraproject.org/pub/epel/6/x86_64/\nsslverify: true\nepel-testing:\nname: Extra Packages for Enterprise Linux 6 - Testing - $basearch\nenabled: 1\nfailovermethod: priority", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trustedanalytics_platform-ansible-defaults-yum_repos.yml\n# Target line: 9\n\n      4:     name: Extra Packages for Enterprise Linux 6 - $basearch\n      5:     enabled: 1\n      6:     failovermethod: priority\n      7:     gpgcheck: 1\n      8:     gpgkey: http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\n>>>   9:     baseurl: http://dl.fedoraproject.org/pub/epel/6/x86_64/\n     10:     sslverify: true\n     11:   epel-testing:\n     12:     name: Extra Packages for Enterprise Linux 6 - Testing - $basearch\n     13:     enabled: 1\n     14:     failovermethod: priority\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "ArdanaCLM_cobbler-ansible-roles-cobbler-tasks-set-vars.yml", "content": "deployer_server: \"http://{{ cobbler_server_ip_addr | ipwrap }}:{{ deployer_server_port }}\"", "line": 88, "detection_span": [83, 93], "with_context": "# Ansible file: ArdanaCLM_cobbler-ansible-roles-cobbler-tasks-set-vars.yml\n\ncobbler_name_server: \"{{ cobbler_server_ip_addr }}\"\nwhen: cobbler_name_server is not defined\n\n- name: cobbler | set-vars | Set local repo ip url\nset_fact:\n88:     deployer_server: \"http://{{ cobbler_server_ip_addr | ipwrap }}:{{ deployer_server_port }}\"\nwhen: deployer_server is not defined\n\n# Set vars for currently used rhel distro\n- include: set-rhel-vars.yml\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArdanaCLM_cobbler-ansible-roles-cobbler-tasks-set-vars.yml\n# Target line: 88\n\n     83:     cobbler_name_server: \"{{ cobbler_server_ip_addr }}\"\n     84:   when: cobbler_name_server is not defined\n     85: \n     86: - name: cobbler | set-vars | Set local repo ip url\n     87:   set_fact:\n>>>  88:     deployer_server: \"http://{{ cobbler_server_ip_addr | ipwrap }}:{{ deployer_server_port }}\"\n     89:   when: deployer_server is not defined\n     90: \n     91: # Set vars for currently used rhel distro\n     92: - include: set-rhel-vars.yml\n     93: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "pulibrary_princeton_ansible-roles-ojs-molecule-default-converge.yml", "content": "method: md5", "line": 48, "detection_span": [43, 53], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-ojs-molecule-default-converge.yml\n\nmethod: md5\n- type: host\ndatabase: ojs_db\nuser: ojs_db_user\naddress: 127.0.0.1/32\n48:           method: md5\ntasks:\n- name: \"Include roles/psql\"\ninclude_role:\nname: \"psql\"\n- name: \"Include roles/ojs\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-ojs-molecule-default-converge.yml\n# Target line: 48\n\n     43:           method: md5\n     44:         - type: host\n     45:           database: ojs_db\n     46:           user: ojs_db_user\n     47:           address: 127.0.0.1/32\n>>>  48:           method: md5\n     49:   tasks:\n     50:     - name: \"Include roles/psql\"\n     51:       include_role:\n     52:         name: \"psql\"\n     53:     - name: \"Include roles/ojs\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "voc_cm-ansible-roles-common-tasks-ssh_known_hosts.yml", "content": "lineinfile: dest=/etc/ssh/ssh_known_hosts state=present", "line": 16, "detection_span": [11, 21], "with_context": "# Ansible file: voc_cm-ansible-roles-common-tasks-ssh_known_hosts.yml\n\nlineinfile: dest=/etc/ssh/ssh_known_hosts state=present\nregexp=\"^mng.ber.c3voc.de.*ecdsa-sha2-nistp521\\ .*\"\nline=\"mng.ber.c3voc.de,2001:67c:20a0:e::163,195.54.164.163 ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBADFt5dEapTckFu1xDMmTdELUPSrtOQiyQM18n9d/M1BkIS5mjaobRzLkcALqhenzG0OJMIdQmxRbQECBYQdomZb9gF02MMExqppESajZBHbBPno/59z1TgMRfZ9+Q353ck4yz9IXdK7cjw+6uvH+m//fom8xnaZW5xg/QlqxO46KgQ2Gw==\"\n\n- name: add \u00bbgithub.com\u00ab to global known_hosts file\n16:     lineinfile: dest=/etc/ssh/ssh_known_hosts state=present\nregexp=\"^github.com,192.30.252.131.*ssh-rsa\\ .*\"\nline=\"github.com,192.30.252.131,192.30.252.129 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: voc_cm-ansible-roles-common-tasks-ssh_known_hosts.yml\n# Target line: 16\n\n     11:     lineinfile: dest=/etc/ssh/ssh_known_hosts state=present\n     12:                 regexp=\"^mng.ber.c3voc.de.*ecdsa-sha2-nistp521\\ .*\"\n     13:                 line=\"mng.ber.c3voc.de,2001:67c:20a0:e::163,195.54.164.163 ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBADFt5dEapTckFu1xDMmTdELUPSrtOQiyQM18n9d/M1BkIS5mjaobRzLkcALqhenzG0OJMIdQmxRbQECBYQdomZb9gF02MMExqppESajZBHbBPno/59z1TgMRfZ9+Q353ck4yz9IXdK7cjw+6uvH+m//fom8xnaZW5xg/QlqxO46KgQ2Gw==\"\n     14: \n     15:   - name: add \u00bbgithub.com\u00ab to global known_hosts file\n>>>  16:     lineinfile: dest=/etc/ssh/ssh_known_hosts state=present\n     17:                 regexp=\"^github.com,192.30.252.131.*ssh-rsa\\ .*\"\n     18:                 line=\"github.com,192.30.252.131,192.30.252.129 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "cloudalchemy_ansible-grafana-.circleci-config.yml", "content": "GIT_COMMIT_DESC: git log --format=%B -n 1 ${CIRCLE_SHA1}", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: cloudalchemy_ansible-grafana-.circleci-config.yml\n\nrelease:\nexecutor: python\nenvironment:\nGIT_MAIL: cloudalchemybot@gmail.com\nGIT_USER: cloudalchemybot\n49:       GIT_COMMIT_DESC: git log --format=%B -n 1 ${CIRCLE_SHA1}\nsteps:\n- checkout\n- setup_remote_docker\n- run: pip install git-semver\n- run: git config --global user.email \"${GIT_MAIL}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudalchemy_ansible-grafana-.circleci-config.yml\n# Target line: 49\n\n     44:   release:\n     45:     executor: python\n     46:     environment:\n     47:       GIT_MAIL: cloudalchemybot@gmail.com\n     48:       GIT_USER: cloudalchemybot\n>>>  49:       GIT_COMMIT_DESC: git log --format=%B -n 1 ${CIRCLE_SHA1}\n     50:     steps:\n     51:       - checkout\n     52:       - setup_remote_docker\n     53:       - run: pip install git-semver\n     54:       - run: git config --global user.email \"${GIT_MAIL}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "ArdanaCLM_monasca-ansible-roles-monasca-persister-tasks-java_configure.yml", "content": "when: not monasca_persister_jar_old_md5_file_result.stat.exists or", "line": 72, "detection_span": [67, 77], "with_context": "# Ansible file: ArdanaCLM_monasca-ansible-roles-monasca-persister-tasks-java_configure.yml\n\nregister: monasca_persister_jar_old_md5_result\n\n- name: Mark Monasca Persister for restart if new monasca-persister jar\ndebug: msg=\"restart monasca-persister because monasca-persister jar changed\"\nchanged_when: True\n72:   when: not monasca_persister_jar_old_md5_file_result.stat.exists or\n( monasca_persister_jar_old_md5_file_result.stat.exists and\n( monasca_persister_jar_result.stat.md5 !=\n( monasca_persister_jar_old_md5_result.content | b64decode ) ) )\nregister: ardana_notify_monasca_persister_restart_required\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArdanaCLM_monasca-ansible-roles-monasca-persister-tasks-java_configure.yml\n# Target line: 72\n\n     67:   register: monasca_persister_jar_old_md5_result\n     68: \n     69: - name: Mark Monasca Persister for restart if new monasca-persister jar\n     70:   debug: msg=\"restart monasca-persister because monasca-persister jar changed\"\n     71:   changed_when: True\n>>>  72:   when: not monasca_persister_jar_old_md5_file_result.stat.exists or\n     73:         ( monasca_persister_jar_old_md5_file_result.stat.exists and\n     74:           ( monasca_persister_jar_result.stat.md5 !=\n     75:             ( monasca_persister_jar_old_md5_result.content | b64decode ) ) )\n     76:   register: ardana_notify_monasca_persister_restart_required\n     77: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "ArdanaCLM_ardana-ansible-roles-service-guest-image-tasks-upload_image.yml", "content": "shell: \"md5sum {{ guest_image_tempdir.stdout }}/{{ IMAGE_NAME }}*.qcow2 | cut -d ' ' -f 1\"", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: ArdanaCLM_ardana-ansible-roles-service-guest-image-tasks-upload_image.yml\n\n- ses_config_path is defined\n- ses_nova_set_images_type | default(False)\n\n# get the md5sum for the new image\n- name: service-guest-image | upload-image | get checksum for new image\n27:   shell: \"md5sum {{ guest_image_tempdir.stdout }}/{{ IMAGE_NAME }}*.qcow2 | cut -d ' ' -f 1\"\nregister: image_checksum\nrun_once: true\n\n# verify if the md5sum match and if the image is in ACTIVE status\n- name: service-guest-image | upload-image | find image that matches the checksum and name", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArdanaCLM_ardana-ansible-roles-service-guest-image-tasks-upload_image.yml\n# Target line: 27\n\n     22:     - ses_config_path is defined\n     23:     - ses_nova_set_images_type | default(False)\n     24: \n     25: # get the md5sum for the new image\n     26: - name: service-guest-image | upload-image | get checksum for new image\n>>>  27:   shell: \"md5sum {{ guest_image_tempdir.stdout }}/{{ IMAGE_NAME }}*.qcow2 | cut -d ' ' -f 1\"\n     28:   register: image_checksum\n     29:   run_once: true\n     30: \n     31: # verify if the md5sum match and if the image is in ACTIVE status\n     32: - name: service-guest-image | upload-image | find image that matches the checksum and name\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "myrepo5588_openshift-ansible-roles-openshift_web_console-files-console-template.yaml", "content": "- /bin/sh", "line": 76, "detection_span": [71, 81], "with_context": "# Ansible file: myrepo5588_openshift-ansible-roles-openshift_web_console-files-console-template.yaml\n\nport: 8443\nscheme: HTTPS\nlivenessProbe:\nexec:\ncommand:\n76:                 - /bin/sh\n- -c\n- |-\nif [[ ! -f /tmp/webconsole-config.hash ]]; then \\\nmd5sum /var/webconsole-config/webconsole-config.yaml > /tmp/webconsole-config.hash; \\\nelif [[ $(md5sum /var/webconsole-config/webconsole-config.yaml) != $(cat /tmp/webconsole-config.hash) ]]; then \\", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: myrepo5588_openshift-ansible-roles-openshift_web_console-files-console-template.yaml\n# Target line: 76\n\n     71:               port: 8443\n     72:               scheme: HTTPS\n     73:           livenessProbe:\n     74:             exec:\n     75:               command:\n>>>  76:                 - /bin/sh\n     77:                 - -c\n     78:                 - |-\n     79:                   if [[ ! -f /tmp/webconsole-config.hash ]]; then \\\n     80:                     md5sum /var/webconsole-config/webconsole-config.yaml > /tmp/webconsole-config.hash; \\\n     81:                   elif [[ $(md5sum /var/webconsole-config/webconsole-config.yaml) != $(cat /tmp/webconsole-config.hash) ]]; then \\\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "oVirt_ovirt-ansible-collection-roles-infra-roles-aaa_jdbc-tasks-main.yml", "content": "# FIXME: Support only add, if the user is removed from list, it's not removed from the group:", "line": 77, "detection_span": [72, 82], "with_context": "# Ansible file: oVirt_ovirt-ansible-collection-roles-infra-roles-aaa_jdbc-tasks-main.yml\n\nfailed_when: \"out_groups.rc != 5 and out_groups.rc != 0 and out_groups.rc != 4\"\ntags:\n- ovirt-aaa-jdbc\n- user_groups\n\n77: # FIXME: Support only add, if the user is removed from list, it's not removed from the group:\n- name: Manage groups members\ncommand: \"{{ aaa_jdbc_prefix }}/ovirt-aaa-jdbc-tool group-manage {{ (item.state is undefined or item.state == 'present') | ternary('useradd','userdel') }} {{ item.0.name }} --user {{ item.1 }}\"\nwith_subelements:\n- \"{{ user_groups | default([]) }}\"\n- users", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: oVirt_ovirt-ansible-collection-roles-infra-roles-aaa_jdbc-tasks-main.yml\n# Target line: 77\n\n     72:   failed_when: \"out_groups.rc != 5 and out_groups.rc != 0 and out_groups.rc != 4\"\n     73:   tags:\n     74:     - ovirt-aaa-jdbc\n     75:     - user_groups\n     76: \n>>>  77: # FIXME: Support only add, if the user is removed from list, it's not removed from the group:\n     78: - name: Manage groups members\n     79:   command: \"{{ aaa_jdbc_prefix }}/ovirt-aaa-jdbc-tool group-manage {{ (item.state is undefined or item.state == 'present') | ternary('useradd','userdel') }} {{ item.0.name }} --user {{ item.1 }}\"\n     80:   with_subelements:\n     81:     - \"{{ user_groups | default([]) }}\"\n     82:     - users\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_network_config-defaults-main.yml", "content": "# All variables within this role should have a prefix of \"tripleo_network_config\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_network_config-defaults-main.yml\n\n# under the License.\n\n\n# All variables intended for modification should be placed in this file.\n\n20: # All variables within this role should have a prefix of \"tripleo_network_config\"\ntripleo_network_config_update: False\ntripleo_network_config_async_poll: 3\ntripleo_network_config_async_timeout: 300\ntripleo_network_config_bridge_name: br-ex\ntripleo_network_config_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_network_config-defaults-main.yml\n# Target line: 20\n\n     15: # under the License.\n     16: \n     17: \n     18: # All variables intended for modification should be placed in this file.\n     19: \n>>>  20: # All variables within this role should have a prefix of \"tripleo_network_config\"\n     21: tripleo_network_config_update: False\n     22: tripleo_network_config_async_poll: 3\n     23: tripleo_network_config_async_timeout: 300\n     24: tripleo_network_config_bridge_name: br-ex\n     25: tripleo_network_config_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack_tripleo-validations-roles-undercloud_debug-defaults-main.yml", "content": "# Parse following ini files, retrieving value of the 'debug' key", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: openstack_tripleo-validations-roles-undercloud_debug-defaults-main.yml\n\n---\n# Fail if the 'debug' key is set to value of 'debug_check'\ndebug_check: true\n\n5: # Parse following ini files, retrieving value of the 'debug' key\nservices_conf_files:\n- /var/lib/config-data/puppet-generated/nova/etc/nova/nova.conf\n- /var/lib/config-data/puppet-generated/neutron/etc/neutron/neutron.conf\n- /var/lib/config-data/puppet-generated/ceilometer/etc/ceilometer/ceilometer.conf\n- /var/lib/config-data/puppet-generated/heat/etc/heat/heat.conf", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-validations-roles-undercloud_debug-defaults-main.yml\n# Target line: 5\n\n      1: ---\n      2: # Fail if the 'debug' key is set to value of 'debug_check'\n      3: debug_check: true\n      4: \n>>>   5: # Parse following ini files, retrieving value of the 'debug' key\n      6: services_conf_files:\n      7:   - /var/lib/config-data/puppet-generated/nova/etc/nova/nova.conf\n      8:   - /var/lib/config-data/puppet-generated/neutron/etc/neutron/neutron.conf\n      9:   - /var/lib/config-data/puppet-generated/ceilometer/etc/ceilometer/ceilometer.conf\n     10:   - /var/lib/config-data/puppet-generated/heat/etc/heat/heat.conf\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "crv4all_openshift-ansible-roles-openshift_control_plane-tasks-bootstrap.yml", "content": "# TODO: create a module for this command.", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: crv4all_openshift-ansible-roles-openshift_control_plane-tasks-bootstrap.yml\n\n---\n2: # TODO: create a module for this command.\n# oc_serviceaccounts_kubeconfig\n- name: create service account kubeconfig with csr rights\ncommand: >\n{{ openshift_client_binary }} --config={{ openshift.common.config_base }}/master/admin.kubeconfig serviceaccounts create-kubeconfig {{ openshift_master_csr_sa }} -n {{ openshift_master_csr_namespace }}\nregister: kubeconfig_out", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-roles-openshift_control_plane-tasks-bootstrap.yml\n# Target line: 2\n\n      1: ---\n>>>   2: # TODO: create a module for this command.\n      3: # oc_serviceaccounts_kubeconfig\n      4: - name: create service account kubeconfig with csr rights\n      5:   command: >\n      6:     {{ openshift_client_binary }} --config={{ openshift.common.config_base }}/master/admin.kubeconfig serviceaccounts create-kubeconfig {{ openshift_master_csr_sa }} -n {{ openshift_master_csr_namespace }}\n      7:   register: kubeconfig_out\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "galaxyproject_usegalaxy-playbook-env-common-host_vars-jetstream2.galaxyproject.org.yml", "content": "#  prefix: \"{{ _pulsar_dependencies_dir }}/_conda\"", "line": 63, "detection_span": [58, 68], "with_context": "# Ansible file: galaxyproject_usegalaxy-playbook-env-common-host_vars-jetstream2.galaxyproject.org.yml\n\namqp_publish_retry_interval_step: 10\namqp_publish_retry_interval_max: 60\ndependency_resolution:\nresolvers:\n#- type: conda\n63:       #  prefix: \"{{ _pulsar_dependencies_dir }}/_conda\"\n#- type: conda\n#  prefix: \"{{ _jetstream_scratch_root }}/conda\"\n#  auto_init: true\n#  auto_install: true\n#- type: tool_shed_packages", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: galaxyproject_usegalaxy-playbook-env-common-host_vars-jetstream2.galaxyproject.org.yml\n# Target line: 63\n\n     58:   amqp_publish_retry_interval_step: 10\n     59:   amqp_publish_retry_interval_max: 60\n     60:   dependency_resolution:\n     61:     resolvers:\n     62:       #- type: conda\n>>>  63:       #  prefix: \"{{ _pulsar_dependencies_dir }}/_conda\"\n     64:       #- type: conda\n     65:       #  prefix: \"{{ _jetstream_scratch_root }}/conda\"\n     66:       #  auto_init: true\n     67:       #  auto_install: true\n     68:       #- type: tool_shed_packages\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_serverless_ml_workshop-defaults-main.yml", "content": "## When you go to create a ServiceNow ticket to create", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_serverless_ml_workshop-defaults-main.yml\n\nbecome_override: false\nocp_username: opentlc-mgr\nsilent: false\n\n## ADD Variables here for use in your role, if needed.\n8: ## When you go to create a ServiceNow ticket to create\n## the RHPDS catalog item, you can ask the engineer to feed\n## values the requesting user enters in the form in RHPDS\n## into these variables. Everything you add here should be\n## prefixed with the role name: ocp4_workload_serverless_ml_workshop\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_serverless_ml_workshop-defaults-main.yml\n# Target line: 8\n\n      3: become_override: false\n      4: ocp_username: opentlc-mgr\n      5: silent: false\n      6: \n      7: ## ADD Variables here for use in your role, if needed.\n>>>   8: ## When you go to create a ServiceNow ticket to create\n      9: ## the RHPDS catalog item, you can ask the engineer to feed\n     10: ## values the requesting user enters in the form in RHPDS\n     11: ## into these variables. Everything you add here should be\n     12: ## prefixed with the role name: ocp4_workload_serverless_ml_workshop\n     13: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "vijaykakkar_ansible-automation-provisioner-sample_workshops-sample-vars-f5.yml", "content": "# name prefix for all the VMs", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: vijaykakkar_ansible-automation-provisioner-sample_workshops-sample-vars-f5.yml\n\n---\n# region where the nodes will live\nec2_region: us-east-1\n4: # name prefix for all the VMs\nec2_name_prefix: TESTWORKSHOP\n# amount of work benches to provision\nstudent_total: 2\n# workshp runs in F5 mode\nworkshop_type: f5", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: vijaykakkar_ansible-automation-provisioner-sample_workshops-sample-vars-f5.yml\n# Target line: 4\n\n      1: ---\n      2: # region where the nodes will live\n      3: ec2_region: us-east-1\n>>>   4: # name prefix for all the VMs\n      5: ec2_name_prefix: TESTWORKSHOP\n      6: # amount of work benches to provision\n      7: student_total: 2\n      8: # workshp runs in F5 mode\n      9: workshop_type: f5\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "litmuschaos_litmus-.github-stale.yml", "content": "# Label to use when marking an issue as stale", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: litmuschaos_litmus-.github-stale.yml\n\ndaysUntilClose: 7\n# Issues with these labels will never be considered stale\nexemptLabels:\n- pinned\n- security\n9: # Label to use when marking an issue as stale\nstaleLabel: wontfix\n# Comment to post when marking an issue as stale. Set to `false` to disable\nmarkComment: >\nThis issue has been automatically marked as stale because it has not had\nrecent activity. It will be closed if no further activity occurs. Thank you", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: litmuschaos_litmus-.github-stale.yml\n# Target line: 9\n\n      4: daysUntilClose: 7\n      5: # Issues with these labels will never be considered stale\n      6: exemptLabels:\n      7:   - pinned\n      8:   - security\n>>>   9: # Label to use when marking an issue as stale\n     10: staleLabel: wontfix\n     11: # Comment to post when marking an issue as stale. Set to `false` to disable\n     12: markComment: >\n     13:   This issue has been automatically marked as stale because it has not had\n     14:   recent activity. It will be closed if no further activity occurs. Thank you\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "integr8ly_ansible-tower-configuration-playbooks-roles-integreatly-tasks-bootstrap_install.yml", "content": "# Need to use this one liner due to known bug on tower https://github.com/ansible/tower-cli/issues/331", "line": 169, "detection_span": [164, 174], "with_context": "# Ansible file: integr8ly_ansible-tower-configuration-playbooks-roles-integreatly-tasks-bootstrap_install.yml\n\n164:   until: remove_host_ref_raw is succeeded\n165:   retries: 10\n166:   delay: 5\n167:\n168: - name: Retrieve cluster provisioning vars inventory\n169:   # Need to use this one liner due to known bug on tower https://github.com/ansible/tower-cli/issues/331\n170:   shell: \"tower-cli inventory get -n \\\"{{ cluster_provisioning_vars_inventory }}\\\" -f yaml | yq r - variables\"\n171:   register: cluster_provisioning_vars_raw\n172:\n173: - set_fact:\ncluster_provisioning_vars: \"{{ cluster_provisioning_vars_raw.stdout | from_yaml }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: integr8ly_ansible-tower-configuration-playbooks-roles-integreatly-tasks-bootstrap_install.yml\n# Target line: 169\n\n    164:   until: remove_host_ref_raw is succeeded\n    165:   retries: 10\n    166:   delay: 5\n    167: \n    168: - name: Retrieve cluster provisioning vars inventory\n>>> 169:   # Need to use this one liner due to known bug on tower https://github.com/ansible/tower-cli/issues/331\n    170:   shell: \"tower-cli inventory get -n \\\"{{ cluster_provisioning_vars_inventory }}\\\" -f yaml | yq r - variables\"\n    171:   register: cluster_provisioning_vars_raw\n    172: \n    173: - set_fact:\n    174:     cluster_provisioning_vars: \"{{ cluster_provisioning_vars_raw.stdout | from_yaml }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sensu_sensu-ansible-tasks-Amazon-rabbit.yml", "content": "# causing dependency issues during installs", "line": 51, "detection_span": [46, 56], "with_context": "# Ansible file: sensu_sensu-ansible-tasks-Amazon-rabbit.yml\n\n- rabbitmq\n- rabbitmq-erlang\n\n# Hard dependency for rabbitmq-server, however, typically comes from EPEL, so\n# we simply install it here, as we purposely disable epel when installing rabbitmq\n51: # causing dependency issues during installs\n- name: Ensure socat is installed\ntags: rabbitmq\nyum:\nname: socat\nstate: present", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sensu_sensu-ansible-tasks-Amazon-rabbit.yml\n# Target line: 51\n\n     46:     - rabbitmq\n     47:     - rabbitmq-erlang\n     48: \n     49: # Hard dependency for rabbitmq-server, however, typically comes from EPEL, so\n     50: # we simply install it here, as we purposely disable epel when installing rabbitmq\n>>>  51: # causing dependency issues during installs\n     52: - name: Ensure socat is installed\n     53:   tags: rabbitmq\n     54:   yum:\n     55:     name: socat\n     56:     state: present\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-openstack_infrared-plugins-packstack-create_external_network.yml", "content": "# TODO(yfried): enable if/when packstack uses floating ips and localhost can access cloud", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n\ngather_facts: yes\nany_errors_fatal: true\nhosts: controller[0]\ntags:\n- external_net\n15: # TODO(yfried): enable if/when packstack uses floating ips and localhost can access cloud\n#  hosts: localhost\n#  vars:\n#      first_controller: \"{{ groups.controller | first }}\"\nvars_files:\n- \"{{ install.network.service }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n# Target line: 15\n\n     10:   gather_facts: yes\n     11:   any_errors_fatal: true\n     12:   hosts: controller[0]\n     13:   tags:\n     14:       - external_net\n>>>  15: # TODO(yfried): enable if/when packstack uses floating ips and localhost can access cloud\n     16: #  hosts: localhost\n     17: #  vars:\n     18: #      first_controller: \"{{ groups.controller | first }}\"\n     19:   vars_files:\n     20:       - \"{{ install.network.service }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "debops_debops-ansible-roles-sks-defaults-main.yml", "content": "# FIXME: Move configuration from the template.", "line": 106, "detection_span": [101, 111], "with_context": "# Ansible file: debops_debops-ansible-roles-sks-defaults-main.yml\n\n101:\n# ]]]\n103: # .. envvar:: sks__ferm__dependent_rules [[[\n104: #\n105: # Configuration for the :ref:`debops.ferm` Ansible role.\n106: # FIXME: Move configuration from the template.\n107: sks__ferm__dependent_rules: []\n108:\n# ]]]\n110: # .. envvar:: sks__nginx__dependent_servers [[[\n111: #", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: debops_debops-ansible-roles-sks-defaults-main.yml\n# Target line: 106\n\n    101: \n    102:                                                                    # ]]]\n    103: # .. envvar:: sks__ferm__dependent_rules [[[\n    104: #\n    105: # Configuration for the :ref:`debops.ferm` Ansible role.\n>>> 106: # FIXME: Move configuration from the template.\n    107: sks__ferm__dependent_rules: []\n    108: \n    109:                                                                    # ]]]\n    110: # .. envvar:: sks__nginx__dependent_servers [[[\n    111: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openfoodfoundation_ofn-install-inventory-host_vars-_example.com-secrets.example.yml", "content": "#bugsnag_key: ''", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: openfoodfoundation_ofn-install-inventory-host_vars-_example.com-secrets.example.yml\n\n# datadog_key: 'API_key_for_the_OFN_account'\n\n# Bugsnag collects all errors and notifies you.\n# https://github.com/openfoodfoundation/ofn-install/wiki/Issue-reporting\n#\n64: #bugsnag_key: ''\n\n# Example settings for integrations like Zapier.\n# ----------------------------------------------\n# Generate a strong password with this command: `openssl rand -hex 128`.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openfoodfoundation_ofn-install-inventory-host_vars-_example.com-secrets.example.yml\n# Target line: 64\n\n     59: # datadog_key: 'API_key_for_the_OFN_account'\n     60: \n     61: # Bugsnag collects all errors and notifies you.\n     62: # https://github.com/openfoodfoundation/ofn-install/wiki/Issue-reporting\n     63: #\n>>>  64: #bugsnag_key: ''\n     65: \n     66: # Example settings for integrations like Zapier.\n     67: # ----------------------------------------------\n     68: # Generate a strong password with this command: `openssl rand -hex 128`.\n     69: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-openstack_infrared-plugins-openstack-post.yml", "content": "# FIXME: move this change to a different review", "line": 50, "detection_span": [45, 55], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-openstack-post.yml\n\nport: \"{{ openstack_ports |\nselectattr('device_id', 'equalto', server.id) |\nselectattr('mac_address', 'equalto', nic.macaddress) |\nlist | first }}\"\n# todo(yfried): add subnets to know if dhcp is on or no\n50:         # FIXME: move this change to a different review\ncopy:\ncontent: |\nBOOTPROTO=static\nIPADDR={{ port.fixed_ips[0].ip_address }}\nNETMASK=255.255.255.0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-openstack-post.yml\n# Target line: 50\n\n     45:             port: \"{{ openstack_ports |\n     46:                         selectattr('device_id', 'equalto', server.id) |\n     47:                         selectattr('mac_address', 'equalto', nic.macaddress) |\n     48:                         list | first }}\"\n     49:             # todo(yfried): add subnets to know if dhcp is on or no\n>>>  50:         # FIXME: move this change to a different review\n     51:         copy:\n     52:             content: |\n     53:                 BOOTPROTO=static\n     54:                 IPADDR={{ port.fixed_ips[0].ip_address }}\n     55:                 NETMASK=255.255.255.0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SalientCRGT_openshift-ansible-roles-openshift_openstack-tasks-container-storage-setup.yml", "content": "# TODO(shadower): Find out which CentOS version supports overlayfs2", "line": 35, "detection_span": [30, 40], "with_context": "# Ansible file: SalientCRGT_openshift-ansible-roles-openshift_openstack-tasks-container-storage-setup.yml\n\ndest: /etc/sysconfig/docker-storage-setup\nowner: root\ngroup: root\nmode: 0644\n\n35:   # TODO(shadower): Find out which CentOS version supports overlayfs2\nwhen:\n- ansible_distribution == \"CentOS\"\n\n- name: Check if docker is running\ncommand: systemctl status {{ openshift_docker_service_name }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: SalientCRGT_openshift-ansible-roles-openshift_openstack-tasks-container-storage-setup.yml\n# Target line: 35\n\n     30:         dest: /etc/sysconfig/docker-storage-setup\n     31:         owner: root\n     32:         group: root\n     33:         mode: 0644\n     34: \n>>>  35:   # TODO(shadower): Find out which CentOS version supports overlayfs2\n     36:   when:\n     37:     - ansible_distribution == \"CentOS\"\n     38: \n     39: - name: Check if docker is running\n     40:   command: systemctl status {{ openshift_docker_service_name }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-defaults-main.yml", "content": "# https://bugzilla.redhat.com/show_bug.cgi?id=1897603", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-defaults-main.yml\n\n# change the manifests.\nocp4_network_ovn_install_workaround: false\n\n# On OpenStack 16 device ids are not truncated to 20 characters.\n# This MachineConfig adds a udev configuration to work around this issue.\n10: # https://bugzilla.redhat.com/show_bug.cgi?id=1897603\nocp4_scsi_device_detection_workaround: false\n\n# Configure OCP4 install to not configure the OpenStack external network\n# and have Ansible manage it instead.\nocp4_ansible_managed_osp_external_network: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-defaults-main.yml\n# Target line: 10\n\n      5: # change the manifests.\n      6: ocp4_network_ovn_install_workaround: false\n      7: \n      8: # On OpenStack 16 device ids are not truncated to 20 characters.\n      9: # This MachineConfig adds a udev configuration to work around this issue.\n>>>  10: # https://bugzilla.redhat.com/show_bug.cgi?id=1897603\n     11: ocp4_scsi_device_detection_workaround: false\n     12: \n     13: # Configure OCP4 install to not configure the OpenStack external network\n     14: # and have Ansible manage it instead.\n     15: ocp4_ansible_managed_osp_external_network: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "IBM_z_ansible_collections_samples-zos_concepts-data_transfer-dump_pack_ftp_unpack_restore-changelog.yml", "content": "#                 - bug fixes", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-data_transfer-dump_pack_ftp_unpack_restore-changelog.yml\n\n#             added:\n#                 - new features are added\n#             deprecated:\n#                 - features being removed in the future\n#             fixed:\n17: #                 - bug fixes\n#             minor:\n#                 - changes in existing functionality\n#             removed:\n#                 - features removed no longer available\n#             security:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-data_transfer-dump_pack_ftp_unpack_restore-changelog.yml\n# Target line: 17\n\n     12: #             added:\n     13: #                 - new features are added\n     14: #             deprecated:\n     15: #                 - features being removed in the future\n     16: #             fixed:\n>>>  17: #                 - bug fixes\n     18: #             minor:\n     19: #                 - changes in existing functionality\n     20: #             removed:\n     21: #                 - features removed no longer available\n     22: #             security:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "devopsschool-training-notes_Tesco-Git-Ansible-Batch2-Nov-final-roles-web-meta-main.yml", "content": "# - GPL-2.0-or-later", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: devopsschool-training-notes_Tesco-Git-Ansible-Batch2-Nov-final-roles-web-meta-main.yml\n\n# issue_tracker_url: http://example.com/issue/tracker\n\n# Choose a valid license ID from https://spdx.org - some suggested licenses:\n# - BSD-3-Clause (default)\n# - MIT\n13:   # - GPL-2.0-or-later\n# - GPL-3.0-only\n# - Apache-2.0\n# - CC-BY-4.0\nlicense: license (GPL-2.0-or-later, MIT, etc)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: devopsschool-training-notes_Tesco-Git-Ansible-Batch2-Nov-final-roles-web-meta-main.yml\n# Target line: 13\n\n      8:   # issue_tracker_url: http://example.com/issue/tracker\n      9: \n     10:   # Choose a valid license ID from https://spdx.org - some suggested licenses:\n     11:   # - BSD-3-Clause (default)\n     12:   # - MIT\n>>>  13:   # - GPL-2.0-or-later\n     14:   # - GPL-3.0-only\n     15:   # - Apache-2.0\n     16:   # - CC-BY-4.0\n     17:   license: license (GPL-2.0-or-later, MIT, etc)\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-ansible-elasticsearch-.github-stale.yml", "content": "# Number of days of inactivity before an stale issue is closed", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-ansible-elasticsearch-.github-stale.yml\n\n---\n# Number of days of inactivity before an issue becomes stale\ndaysUntilStale: 90\n\n5: # Number of days of inactivity before an stale issue is closed\ndaysUntilClose: 30\n\n# Label to use when marking an issue as stale\nstaleLabel: triage/stale\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-ansible-elasticsearch-.github-stale.yml\n# Target line: 5\n\n      1: ---\n      2: # Number of days of inactivity before an issue becomes stale\n      3: daysUntilStale: 90\n      4: \n>>>   5: # Number of days of inactivity before an stale issue is closed\n      6: daysUntilClose: 30\n      7: \n      8: # Label to use when marking an issue as stale\n      9: staleLabel: triage/stale\n     10: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml", "content": "# MAS Cluster Issuer", "line": 68, "detection_span": [63, 73], "with_context": "# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n\n# Do you want to update a DNS entry if it already exists?\nupdate_dns: \"{{ lookup('env', 'UPDATE_DNS_ENTRIES') | default(true, true) }}\"\n# e.g: \"apps.joaopauloksn.cp.fyre.ibm.com\" Default will be always from cluster ingress CR.\ncustom_ocp_ingress: \"{{ lookup('env', 'OCP_INGRESS') | default(None, true)}}\"\n\n68: # MAS Cluster Issuer\n# -----------------------------------------------------------------------------\n# If cis, custom_cluster_issuer = cis-letsencrypt-production-{{ mas_instance_id }}\n# If PKI, custom_cluster_issuer = MAS_CUSTOM_CLUSTER_ISSUER\n# If not specified, custom_cluster_issuer = autogenerated\ndefault_custom_cluster_issuer: \"cis-letsencrypt-production-{{ mas_instance_id }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n# Target line: 68\n\n     63: # Do you want to update a DNS entry if it already exists?\n     64: update_dns: \"{{ lookup('env', 'UPDATE_DNS_ENTRIES') | default(true, true) }}\"\n     65: # e.g: \"apps.joaopauloksn.cp.fyre.ibm.com\" Default will be always from cluster ingress CR.\n     66: custom_ocp_ingress: \"{{ lookup('env', 'OCP_INGRESS') | default(None, true)}}\"\n     67: \n>>>  68: # MAS Cluster Issuer\n     69: # -----------------------------------------------------------------------------\n     70: # If cis, custom_cluster_issuer = cis-letsencrypt-production-{{ mas_instance_id }}\n     71: # If PKI, custom_cluster_issuer = MAS_CUSTOM_CLUSTER_ISSUER\n     72: # If not specified, custom_cluster_issuer = autogenerated\n     73: default_custom_cluster_issuer: \"cis-letsencrypt-production-{{ mas_instance_id }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "henrysher_fedora-infra-ansible-roles-postfix_logreport-tasks-main.yml", "content": "# tasklist for setting up postfix/logreport", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-postfix_logreport-tasks-main.yml\n\n---\n2: # tasklist for setting up postfix/logreport\n# This is the base set of files needed for postfix/logreport\n\n- name: install postfix-perl-scripts package\npackage: name=postfix-perl-scripts state=present\ntags:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-postfix_logreport-tasks-main.yml\n# Target line: 2\n\n      1: ---\n>>>   2: # tasklist for setting up postfix/logreport\n      3: # This is the base set of files needed for postfix/logreport\n      4: \n      5: - name: install postfix-perl-scripts package\n      6:   package: name=postfix-perl-scripts state=present\n      7:   tags:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "geerlingguy_drupal-vm-provisioning-roles-geerlingguy.drupal-.github-stale.yml", "content": "# Number of days of inactivity before an Issue or Pull Request becomes stale", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.drupal-.github-stale.yml\n\n# Configuration for probot-stale - https://github.com/probot/stale\n\n3: # Number of days of inactivity before an Issue or Pull Request becomes stale\ndaysUntilStale: 90\n\n# Number of days of inactivity before an Issue or Pull Request with the stale label is closed.\n# Set to false to disable. If disabled, issues still need to be closed manually, but will remain marked as stale.\ndaysUntilClose: 30", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.drupal-.github-stale.yml\n# Target line: 3\n\n      1: # Configuration for probot-stale - https://github.com/probot/stale\n      2: \n>>>   3: # Number of days of inactivity before an Issue or Pull Request becomes stale\n      4: daysUntilStale: 90\n      5: \n      6: # Number of days of inactivity before an Issue or Pull Request with the stale label is closed.\n      7: # Set to false to disable. If disabled, issues still need to be closed manually, but will remain marked as stale.\n      8: daysUntilClose: 30\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "Kubeinit_kubeinit-kubeinit-roles-kubeinit_prepare-defaults-main.yml", "content": "# All variables within this role should have a prefix of \"kubeinit_prepare_\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: Kubeinit_kubeinit-kubeinit-roles-kubeinit_prepare-defaults-main.yml\n\n# under the License.\n\n\n# All variables intended for modification should be placed in this file.\n\n20: # All variables within this role should have a prefix of \"kubeinit_prepare_\"\nkubeinit_prepare_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"\nkubeinit_prepare_hide_sensitive_logs: true\n\nkubeinit_prepare_podman_dependencies:\n- podman", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Kubeinit_kubeinit-kubeinit-roles-kubeinit_prepare-defaults-main.yml\n# Target line: 20\n\n     15: # under the License.\n     16: \n     17: \n     18: # All variables intended for modification should be placed in this file.\n     19: \n>>>  20: # All variables within this role should have a prefix of \"kubeinit_prepare_\"\n     21: kubeinit_prepare_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"\n     22: kubeinit_prepare_hide_sensitive_logs: true\n     23: \n     24: kubeinit_prepare_podman_dependencies:\n     25:   - podman\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml", "content": "# solve the DNS01 challenge.", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n\n# The GroupName here is used to identify your company or business unit that\n# created this webhook.\n# For example, this may be \"acme.mycompany.com\".\n# This name will need to be referenced in each Issuer's `webhook` stanza to\n# inform cert-manager of where to send ChallengePayload resources in order to\n6: # solve the DNS01 challenge.\n# This group name should be **unique**, hence using your own company's domain\n# here is recommended.\ngroupName: acme.msmaximoappsuite.br\n\nlogLevel: 1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n# Target line: 6\n\n      1: # The GroupName here is used to identify your company or business unit that\n      2: # created this webhook.\n      3: # For example, this may be \"acme.mycompany.com\".\n      4: # This name will need to be referenced in each Issuer's `webhook` stanza to\n      5: # inform cert-manager of where to send ChallengePayload resources in order to\n>>>   6: # solve the DNS01 challenge.\n      7: # This group name should be **unique**, hence using your own company's domain\n      8: # here is recommended.\n      9: groupName: acme.msmaximoappsuite.br\n     10: \n     11: logLevel: 1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "fgravato_ansible-fedora-infra-roles-nagios_client-tasks-main.yml", "content": "# FIXME? figure out nrpe selinux policy of DOOM is needed", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: fgravato_ansible-fedora-infra-roles-nagios_client-tasks-main.yml\n\n# then we symlinked that to /usr/lib64/nagios/plugins\n# it was a nightmare - don't do that - my ghost will haunt you if you do\n# skvidal 2013-05-21\n\n\n36: # FIXME? figure out nrpe selinux policy of DOOM is needed\n\n- name: /etc/nagios/nrpe.cfg\ntemplate: src=nrpe.cfg.j2 dest=/etc/nagios/nrpe.cfg\nnotify:\n- restart nrpe", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: fgravato_ansible-fedora-infra-roles-nagios_client-tasks-main.yml\n# Target line: 36\n\n     31: # then we symlinked that to /usr/lib64/nagios/plugins\n     32: # it was a nightmare - don't do that - my ghost will haunt you if you do\n     33: # skvidal 2013-05-21\n     34: \n     35: \n>>>  36: # FIXME? figure out nrpe selinux policy of DOOM is needed\n     37: \n     38: - name: /etc/nagios/nrpe.cfg\n     39:   template: src=nrpe.cfg.j2 dest=/etc/nagios/nrpe.cfg\n     40:   notify:\n     41:   - restart nrpe\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "banalas_ansible-examples-language_features-intro_example.yml", "content": "# for when we use the 'template' action/module later on...", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: banalas_ansible-examples-language_features-intro_example.yml\n\n#  remote_user: mdehaan\n#  become: yes\n#  become_method: sudo\n\n# make these variables available inside of templates\n20:   # for when we use the 'template' action/module later on...\n\nvars:\nhttp_port: 80\nmax_clients: 200\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: banalas_ansible-examples-language_features-intro_example.yml\n# Target line: 20\n\n     15: #  remote_user: mdehaan\n     16: #  become: yes\n     17: #  become_method: sudo\n     18: \n     19:   # make these variables available inside of templates\n>>>  20:   # for when we use the 'template' action/module later on...\n     21: \n     22:   vars:\n     23:     http_port: 80\n     24:     max_clients: 200\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "epiphany-platform_epiphany-ansible-playbooks-roles-postgresql-molecule-debian-repmgr-molecule.yml", "content": "# linter's project dir is changed to avoid issues with include_tasks", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: epiphany-platform_epiphany-ansible-playbooks-roles-postgresql-molecule-debian-repmgr-molecule.yml\n\n---\ndependency:\nenabled: false\n4: # linter's project dir is changed to avoid issues with include_tasks\nlint: ansible-lint --project-dir=../.. roles/postgresql --exclude roles/postgresql/molecule\ndriver:\nname: docker\nplatforms:\n- name: instance-1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: epiphany-platform_epiphany-ansible-playbooks-roles-postgresql-molecule-debian-repmgr-molecule.yml\n# Target line: 4\n\n      1: ---\n      2: dependency:\n      3:   enabled: false\n>>>   4: # linter's project dir is changed to avoid issues with include_tasks\n      5: lint: ansible-lint --project-dir=../.. roles/postgresql --exclude roles/postgresql/molecule\n      6: driver:\n      7:   name: docker\n      8: platforms:\n      9:   - name: instance-1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-openstack_infrared-plugins-packstack-create_external_network.yml", "content": "# TODO(yfried): Use localhost where shade is mandatory", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n\ncomment: \"Infrared: bz1404763\"\nchain: INPUT\njump: ACCEPT\nprotocol: tcp\n\n64:       # TODO(yfried): Use localhost where shade is mandatory\n- name: create the external network\nvars:\nansible_python_interpreter: \"{{ shade_path_venv | default('/var/tmp/venv_shade') }}/bin/python\"\nos_network:\nauth: \"{{ creds.stdout | from_yaml }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n# Target line: 64\n\n     59:             comment: \"Infrared: bz1404763\"\n     60:             chain: INPUT\n     61:             jump: ACCEPT\n     62:             protocol: tcp\n     63: \n>>>  64:       # TODO(yfried): Use localhost where shade is mandatory\n     65:       - name: create the external network\n     66:         vars:\n     67:             ansible_python_interpreter: \"{{ shade_path_venv | default('/var/tmp/venv_shade') }}/bin/python\"\n     68:         os_network:\n     69:             auth: \"{{ creds.stdout | from_yaml }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "gluster_gdeploy-playbooks-define_service_ports.yml", "content": "# The above hack is way too ugly. But no other choice on Ansible 1.9", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: gluster_gdeploy-playbooks-define_service_ports.yml\n\n\ntasks:\n- name: Define service port\nlineinfile: dest=/etc/sysconfig/nfs regexp='^#STATD_PORT=.*' line='STATD_PORT=662'\n\n10: # The above hack is way too ugly. But no other choice on Ansible 1.9\n\n# Some of our channels provide only ansible1.9 and backrefs in lineinfile\n# fails. Currently hardcoding to 662\n# replace the above lineinfile with the below backrefs, once all channels are\n# updated with ansible 2.0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: gluster_gdeploy-playbooks-define_service_ports.yml\n# Target line: 10\n\n      5: \n      6:   tasks:\n      7:   - name: Define service port\n      8:     lineinfile: dest=/etc/sysconfig/nfs regexp='^#STATD_PORT=.*' line='STATD_PORT=662'\n      9: \n>>>  10: # The above hack is way too ugly. But no other choice on Ansible 1.9\n     11: \n     12: # Some of our channels provide only ansible1.9 and backrefs in lineinfile\n     13: # fails. Currently hardcoding to 662\n     14: # replace the above lineinfile with the below backrefs, once all channels are\n     15: # updated with ansible 2.0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "georgegoh_openshift-ansible-playbooks-common-openshift-cluster-upgrades-rpm_upgrade.yml", "content": "# TODO: If the sdn package isn't already installed this will install it, we", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-upgrades-rpm_upgrade.yml\n\n# available and the whole set of dependencies end up at the latest version.\n# Since the package module, unlike the yum module, doesn't flatten a list\n# of packages into one transaction we need to do that explicitly. The ansible\n# core team tells us not to rely on yum module transaction flattening anyway.\n\n9: # TODO: If the sdn package isn't already installed this will install it, we\n# should fix that\n\n- name: Upgrade master packages\npackage: name={{ master_pkgs | join(',') }} state=present\nvars:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-upgrades-rpm_upgrade.yml\n# Target line: 9\n\n      4: # available and the whole set of dependencies end up at the latest version.\n      5: # Since the package module, unlike the yum module, doesn't flatten a list\n      6: # of packages into one transaction we need to do that explicitly. The ansible\n      7: # core team tells us not to rely on yum module transaction flattening anyway.\n      8: \n>>>   9: # TODO: If the sdn package isn't already installed this will install it, we\n     10: # should fix that\n     11: \n     12: - name: Upgrade master packages\n     13:   package: name={{ master_pkgs | join(',') }} state=present\n     14:   vars:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml", "content": "### IPv4 Prefix-Lists ###", "line": 1, "detection_span": [1, 6], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n\n1: ### IPv4 Prefix-Lists ###\ndynamic_prefix_lists:\n- name: DYNAMIC_PREFIX_LIST_NAME_3\nmatch_map: Test_2\nprefix_list:\nipv4: IPV4_PREFIX_LIST", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n# Target line: 1\n\n>>>   1: ### IPv4 Prefix-Lists ###\n      2: dynamic_prefix_lists:\n      3:   - name: DYNAMIC_PREFIX_LIST_NAME_3\n      4:     match_map: Test_2\n      5:     prefix_list:\n      6:       ipv4: IPV4_PREFIX_LIST\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml", "content": "### IPv6 Prefix-lists ###", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n\naction: \"permit 192.168.255.0/24 eq 32\"\n20:\naction: \"permit 192.168.254.0/24 eq 32\"\n\n\n27: ### IPv6 Prefix-lists ###\nipv6_prefix_lists:\nPL-IPV6-LOOPBACKS:\nsequence_numbers:\n10:\naction: permit 1b11:3a00:22b0:0082::/64 eq 128", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n# Target line: 27\n\n     22:         action: \"permit 192.168.255.0/24 eq 32\"\n     23:       20:\n     24:         action: \"permit 192.168.254.0/24 eq 32\"\n     25: \n     26: \n>>>  27: ### IPv6 Prefix-lists ###\n     28: ipv6_prefix_lists:\n     29:   PL-IPV6-LOOPBACKS:\n     30:     sequence_numbers:\n     31:       10:\n     32:         action: permit 1b11:3a00:22b0:0082::/64 eq 128\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "SalientCRGT_openshift-ansible-playbooks-openstack-openshift-cluster-provision.yml", "content": "# TODO(shadower): consider splitting this up so people can stop here", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: SalientCRGT_openshift-ansible-playbooks-openstack-openshift-cluster-provision.yml\n\n\n- name: Gather facts for the new nodes\nsetup:\n\n\n26: # TODO(shadower): consider splitting this up so people can stop here\n# and configure their DNS if they have to.\n- name: Populate the DNS entries\nany_errors_fatal: true\nhosts: localhost\ntasks:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: SalientCRGT_openshift-ansible-playbooks-openstack-openshift-cluster-provision.yml\n# Target line: 26\n\n     21: \n     22:   - name: Gather facts for the new nodes\n     23:     setup:\n     24: \n     25: \n>>>  26: # TODO(shadower): consider splitting this up so people can stop here\n     27: # and configure their DNS if they have to.\n     28: - name: Populate the DNS entries\n     29:   any_errors_fatal: true\n     30:   hosts: localhost\n     31:   tasks:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "henrysher_fedora-infra-ansible-roles-copr-backend-files-provision-provision_builder_tasks.yml", "content": "- 204.157.3.70 # https://pagure.io/fedora-infrastructure/issue/8096", "line": 116, "detection_span": [111, 121], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-copr-backend-files-provision-provision_builder_tasks.yml\n\nenabled: no\n112:\n113: - name: blacklist ipv4 addresses for some mirrors\n114:   shell: ip route add unreachable \"{{ item }}\"\n115:   with_items:\n116:   - 204.157.3.70 # https://pagure.io/fedora-infrastructure/issue/8096\n117:   when:\n118:   - prepare_base_image is not defined", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-copr-backend-files-provision-provision_builder_tasks.yml\n# Target line: 116\n\n    111:     enabled: no\n    112: \n    113: - name: blacklist ipv4 addresses for some mirrors\n    114:   shell: ip route add unreachable \"{{ item }}\"\n    115:   with_items:\n>>> 116:   - 204.157.3.70 # https://pagure.io/fedora-infrastructure/issue/8096\n    117:   when:\n    118:   - prepare_base_image is not defined\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-openstack_khaleesi-roles-common-tasks-main.yml", "content": "#to-do this is inconsistently failing w/ perm denied", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: redhat-openstack_khaleesi-roles-common-tasks-main.yml\n\n---\n2: #to-do this is inconsistently failing w/ perm denied\n- name: Set local time to UTC\nshell: unlink /etc/localtime; ln -s /usr/share/zoneinfo/UTC /etc/localtime\nsudo: yes\nignore_errors: yes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-roles-common-tasks-main.yml\n# Target line: 2\n\n      1: ---\n>>>   2: #to-do this is inconsistently failing w/ perm denied\n      3: - name: Set local time to UTC\n      4:   shell: unlink /etc/localtime; ln -s /usr/share/zoneinfo/UTC /etc/localtime\n      5:   sudo: yes\n      6:   ignore_errors: yes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "BCDevOps_platform-services-monitoring-sysdig-openshift-lab-cm-sysdig-agent-infra.yaml", "content": "##### Debug and disable undesired metrics", "line": 33, "detection_span": [28, 38], "with_context": "# Ansible file: BCDevOps_platform-services-monitoring-sysdig-openshift-lab-cm-sysdig-agent-infra.yaml\n\n\n#######################################\nnew_k8s: true\nk8s_cluster_name: lab-pathfinder\n\n33:     ##### Debug and disable undesired metrics\napp_checks_enabled: true\nstatsd:\nenabled: true\njmx:\nenabled: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: BCDevOps_platform-services-monitoring-sysdig-openshift-lab-cm-sysdig-agent-infra.yaml\n# Target line: 33\n\n     28: \n     29:     #######################################\n     30:     new_k8s: true\n     31:     k8s_cluster_name: lab-pathfinder\n     32: \n>>>  33:     ##### Debug and disable undesired metrics\n     34:     app_checks_enabled: true\n     35:     statsd:\n     36:       enabled: true\n     37:     jmx:\n     38:       enabled: true    \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "enthought_edx_ansible-playbooks-roles-xqwatcher-defaults-main.yml", "content": "#TODO: change this to /edx/etc after pulling xqwatcher.json out", "line": 83, "detection_span": [78, 88], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-xqwatcher-defaults-main.yml\n\nxqwatcher_app_data: \"{{ xqwatcher_app_dir }}/data\"\nxqwatcher_code_dir: \"{{ xqwatcher_app_dir }}/src\"\n\nxqwatcher_repo_name: xqueue-watcher.git\n\n83: #TODO: change this to /edx/etc after pulling xqwatcher.json out\nxqwatcher_conf_dir: \"{{ xqwatcher_app_dir }}\"\n\n#TODO: remove after refactoring out all the git stuff\nxqwatcher_course_git_ssh_opts: \"-o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i {{ xqwatcher_app_dir }}/.ssh/{{ xqwatcher_service_name }}-courses\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-xqwatcher-defaults-main.yml\n# Target line: 83\n\n     78: xqwatcher_app_data: \"{{ xqwatcher_app_dir }}/data\"\n     79: xqwatcher_code_dir: \"{{ xqwatcher_app_dir }}/src\"\n     80: \n     81: xqwatcher_repo_name: xqueue-watcher.git\n     82: \n>>>  83: #TODO: change this to /edx/etc after pulling xqwatcher.json out\n     84: xqwatcher_conf_dir: \"{{ xqwatcher_app_dir }}\"\n     85: \n     86: #TODO: remove after refactoring out all the git stuff\n     87: xqwatcher_course_git_ssh_opts: \"-o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i {{ xqwatcher_app_dir }}/.ssh/{{ xqwatcher_service_name }}-courses\"\n     88: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-roles-host-lets-encrypt-certs-defaults-main.yml", "content": "# to prevent issues with the Let's Encrypt rate limits", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-host-lets-encrypt-certs-defaults-main.yml\n\nacme_cache_key_file:       \"/tmp/ssl.key\"\nacme_cache_ca_file:        \"/tmp/ssl_ca.cert\"\nacme_cache_fullchain_file: \"/tmp/fullchain.cer\"\n\n# Use the Production Let's Encrypt Server. Leave to False for testing runs\n36: # to prevent issues with the Let's Encrypt rate limits\nacme_production: False\n\n# Install a cron job to automatically renew Certificates. Checks\n# once a day.\nacme_renew_automatically: False", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-host-lets-encrypt-certs-defaults-main.yml\n# Target line: 36\n\n     31: acme_cache_key_file:       \"/tmp/ssl.key\"\n     32: acme_cache_ca_file:        \"/tmp/ssl_ca.cert\"\n     33: acme_cache_fullchain_file: \"/tmp/fullchain.cer\"\n     34: \n     35: # Use the Production Let's Encrypt Server. Leave to False for testing runs\n>>>  36: # to prevent issues with the Let's Encrypt rate limits\n     37: acme_production: False\n     38: \n     39: # Install a cron job to automatically renew Certificates. Checks\n     40: # once a day.\n     41: acme_renew_automatically: False\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "IBM_z_ansible_collections_samples-zos_subsystems-cics-cmci-reporting-report.yml", "content": "#   IBM z/OS CICS collection 1.0.0 or later", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-cics-cmci-reporting-report.yml\n\n#  resource tables supported by CPSM. The retrieved information is written to a\n#  csv file, suitable for opening as a spreadsheet.  This sample additionally\n#  shows how to automate installation of pre-requisites for the CMCI modules.\n#\n# Requirements:\n28: #   IBM z/OS CICS collection 1.0.0 or later\n###############################################################################\n---\n- name:  CICS CMCI Report\n\ncollections:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-cics-cmci-reporting-report.yml\n# Target line: 28\n\n     23: #  resource tables supported by CPSM. The retrieved information is written to a\n     24: #  csv file, suitable for opening as a spreadsheet.  This sample additionally\n     25: #  shows how to automate installation of pre-requisites for the CMCI modules.\n     26: #\n     27: # Requirements:\n>>>  28: #   IBM z/OS CICS collection 1.0.0 or later\n     29: ###############################################################################\n     30: ---\n     31: - name:  CICS CMCI Report\n     32: \n     33:   collections:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "myrepo5588_openshift-ansible-roles-kube_proxy_and_dns-files-kube-proxy-and-dns.yaml", "content": "# TODO: Temporarily disabled until we determine how to wait for clean default", "line": 120, "detection_span": [115, 125], "with_context": "# Ansible file: myrepo5588_openshift-ansible-roles-kube_proxy_and_dns-files-kube-proxy-and-dns.yaml\n\n- name: OPENSHIFT_DNS_DOMAIN\nvalue: cluster.local\nports:\n- name: healthz\ncontainerPort: 10256\n120:         # TODO: Temporarily disabled until we determine how to wait for clean default\n# config\n# livenessProbe:\n#   initialDelaySeconds: 10\n#   httpGet:\n#     path: /healthz", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: myrepo5588_openshift-ansible-roles-kube_proxy_and_dns-files-kube-proxy-and-dns.yaml\n# Target line: 120\n\n    115:         - name: OPENSHIFT_DNS_DOMAIN\n    116:           value: cluster.local\n    117:         ports:\n    118:         - name: healthz\n    119:           containerPort: 10256\n>>> 120:         # TODO: Temporarily disabled until we determine how to wait for clean default\n    121:         # config\n    122:         # livenessProbe:\n    123:         #   initialDelaySeconds: 10\n    124:         #   httpGet:\n    125:         #     path: /healthz\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "tungstenfabric_tf-ansible-deployer-playbooks-roles-k8s_deployer-tasks-main.yml", "content": "# TODO: there are no private_ip/ansible_user/ansible_ssh_pass/ansible_ssh_private_key_file", "line": 42, "detection_span": [37, 47], "with_context": "# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-k8s_deployer-tasks-main.yml\n\ncontrail_configuration: \"{{ contrail_configuration | combine({'KUBERNETES_API_SERVER': k8s_master_ip}) }}\"\nwhen:\n- contrail_configuration.KUBERNETES_API_SERVER is undefined\n- k8s_master_ip is defined\n\n42: # TODO: there are no private_ip/ansible_user/ansible_ssh_pass/ansible_ssh_private_key_file\n- name: create k8s_master_host host group\nadd_host:\nhostname: \"{{ item.value.ip }}\"\ngroupname: k8s_master_host\ninstance_name: \"{{ item.key }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-k8s_deployer-tasks-main.yml\n# Target line: 42\n\n     37:     contrail_configuration: \"{{ contrail_configuration | combine({'KUBERNETES_API_SERVER': k8s_master_ip}) }}\"\n     38:   when:\n     39:     - contrail_configuration.KUBERNETES_API_SERVER is undefined\n     40:     - k8s_master_ip is defined\n     41: \n>>>  42: # TODO: there are no private_ip/ansible_user/ansible_ssh_pass/ansible_ssh_private_key_file\n     43: - name: create k8s_master_host host group\n     44:   add_host:\n     45:     hostname: \"{{ item.value.ip }}\"\n     46:     groupname: k8s_master_host\n     47:     instance_name: \"{{ item.key }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "Juniper_contrail-ansible-internal-playbooks-roles-contrail-analyticsdb-tasks-install-RedHat.yml", "content": "# This is a workaround on issue https://github.com/Juniper/contrail-docker/issues/2", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: Juniper_contrail-ansible-internal-playbooks-roles-contrail-analyticsdb-tasks-install-RedHat.yml\n\n\n# Workaround for LP #1669295\n- name: Disable contrail-database to auto start on reboot\ncommand: chkconfig contrail-database off\n\n14: # This is a workaround on issue https://github.com/Juniper/contrail-docker/issues/2\n- name: Remove supervisor-database from /etc/sensitive_servies (WA for issue contrail-docker/2)\nlineinfile: dest=/etc/sensitive_services line=supervisor-database state=absent", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Juniper_contrail-ansible-internal-playbooks-roles-contrail-analyticsdb-tasks-install-RedHat.yml\n# Target line: 14\n\n      9: \n     10: # Workaround for LP #1669295\n     11: - name: Disable contrail-database to auto start on reboot\n     12:   command: chkconfig contrail-database off\n     13: \n>>>  14: # This is a workaround on issue https://github.com/Juniper/contrail-docker/issues/2\n     15: - name: Remove supervisor-database from /etc/sensitive_servies (WA for issue contrail-docker/2)\n     16:   lineinfile: dest=/etc/sensitive_services line=supervisor-database state=absent\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "AAROC_DevOps-Ansible-roles-top-bdii-tasks-configure.yml", "content": "#     regexp: \"^suffix\\s*\\\"o\\=grid\\\"\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: AAROC_DevOps-Ansible-roles-top-bdii-tasks-configure.yml\n\n#\n# - name: Ensure that relay database suffix is disabled\n#   become: true\n#   lineinefile:\n#     dest: /etc/bdii/bdii-top-slapd.conf\n20: #     regexp: \"^suffix\\s*\\\"o\\=grid\\\"\"\n#     line: \"#suffix \\\"o=grid\\\"\"\n#   when: ansible_os_family == 'RedHat' && ansible_distribution_major_version == '6'\n\n- name: Tweak relay db\nbecome: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Ansible-roles-top-bdii-tasks-configure.yml\n# Target line: 20\n\n     15: #\n     16: # - name: Ensure that relay database suffix is disabled\n     17: #   become: true\n     18: #   lineinefile:\n     19: #     dest: /etc/bdii/bdii-top-slapd.conf\n>>>  20: #     regexp: \"^suffix\\s*\\\"o\\=grid\\\"\"\n     21: #     line: \"#suffix \\\"o=grid\\\"\"\n     22: #   when: ansible_os_family == 'RedHat' && ansible_distribution_major_version == '6'\n     23: \n     24: - name: Tweak relay db\n     25:   become: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-cop_controller_configuration-roles-ad_hoc_command_cancel-meta-main.yml", "content": "# If the issue tracker for your role is not on github, uncomment the", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: redhat-cop_controller_configuration-roles-ad_hoc_command_cancel-meta-main.yml\n\nrole_name: \"ad_hoc_command_cancel\"\nauthor: \"Sean Sullivan\"\ndescription: \"An Ansible Role to cancel ad hoc commands in Ansible Controller.\"\ncompany: \"Red Hat\"\n\n8:   # If the issue tracker for your role is not on github, uncomment the\n# next line and provide a value\n# issue_tracker_url: http://example.com/issue/tracker\nlicense: \"GPLv3+\"\n\nmin_ansible_version: \"2.9\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_controller_configuration-roles-ad_hoc_command_cancel-meta-main.yml\n# Target line: 8\n\n      3:   role_name: \"ad_hoc_command_cancel\"\n      4:   author: \"Sean Sullivan\"\n      5:   description: \"An Ansible Role to cancel ad hoc commands in Ansible Controller.\"\n      6:   company: \"Red Hat\"\n      7: \n>>>   8:   # If the issue tracker for your role is not on github, uncomment the\n      9:   # next line and provide a value\n     10:   # issue_tracker_url: http://example.com/issue/tracker\n     11:   license: \"GPLv3+\"\n     12: \n     13:   min_ansible_version: \"2.9\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "debops_debops-ansible-playbooks-service-extrepo.yml", "content": "# SPDX-License-Identifier: GPL-3.0-or-later", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: debops_debops-ansible-playbooks-service-extrepo.yml\n\n---\n# Copyright (C) 2021 Maciej Delmanowski <drybjed@gmail.com>\n# Copyright (C) 2021 DebOps <https://debops.org/>\n4: # SPDX-License-Identifier: GPL-3.0-or-later\n\n- name: Manage external APT sources\ncollections: [ 'debops.debops', 'debops.roles01',\n'debops.roles02', 'debops.roles03' ]\nhosts: [ 'debops_service_extrepo' ]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: debops_debops-ansible-playbooks-service-extrepo.yml\n# Target line: 4\n\n      1: ---\n      2: # Copyright (C) 2021 Maciej Delmanowski <drybjed@gmail.com>\n      3: # Copyright (C) 2021 DebOps <https://debops.org/>\n>>>   4: # SPDX-License-Identifier: GPL-3.0-or-later\n      5: \n      6: - name: Manage external APT sources\n      7:   collections: [ 'debops.debops', 'debops.roles01',\n      8:                  'debops.roles02', 'debops.roles03' ]\n      9:   hosts: [ 'debops_service_extrepo' ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
