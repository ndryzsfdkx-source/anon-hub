{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-ironic-install-defaults-required_defaults_Fedora_26.yml", "content": "nginx_user: nginx", "line": 8, "detection_span": [6, 10], "with_context": "# File: bifrost-playbooks-roles-bifrost-ironic-install-defaults-required_defaults_Fedora_26.yml\n# Target line: 8\n\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n      5: ipxe_dir: /usr/share/ipxe/\n      6: ipxe_full_binary: ipxe.lkrn\n      7: ironic_rootwrap_dir: /usr/bin/\n>>>   8: nginx_user: nginx\n      9: mysql_service_name: mariadb\n     10: tftp_service_name: tftp\n     11: required_packages:\n     12:   - mariadb-server\n     13:   - dnsmasq", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-ironic-install-defaults-required_defaults_Fedora_26.yml\n# Target line: 8\n\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n      5: ipxe_dir: /usr/share/ipxe/\n      6: ipxe_full_binary: ipxe.lkrn\n      7: ironic_rootwrap_dir: /usr/bin/\n>>>   8: nginx_user: nginx\n      9: mysql_service_name: mariadb\n     10: tftp_service_name: tftp\n     11: required_packages:\n     12:   - mariadb-server\n     13:   - dnsmasq\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "mysql_username: \"root\"", "line": 15, "detection_span": [13, 17], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 15\n\n     10: skip_bootstrap: False\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n>>>  15: mysql_username: \"root\"\n     16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 15\n\n     10: skip_bootstrap: False\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n>>>  15: mysql_username: \"root\"\n     16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "username: admin", "line": 47, "detection_span": [45, 49], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 47\n\n     42: \n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n>>>  47:     username: admin\n     48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 47\n\n     42: \n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n>>>  47:     username: admin\n     48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "password: ChangeThisPa55w0rd", "line": 48, "detection_span": [46, 50], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 48\n\n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n     47:     username: admin\n>>>  48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 48\n\n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n     47:     username: admin\n>>>  48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "username: keystone", "line": 55, "detection_span": [53, 57], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 55\n\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"\n     54:   message_queue:\n>>>  55:     username: keystone\n     56:     password: ChangeThisPa55w0rd\n     57:     host: localhost\n     58:     port: 5672\n     59:   database:\n     60:     name: keystone", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 55\n\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"\n     54:   message_queue:\n>>>  55:     username: keystone\n     56:     password: ChangeThisPa55w0rd\n     57:     host: localhost\n     58:     port: 5672\n     59:   database:\n     60:     name: keystone\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "mysql_password: \"\"", "line": 16, "detection_span": [14, 18], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 16\n\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n     15: mysql_username: \"root\"\n>>>  16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 16\n\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n     15: mysql_username: \"root\"\n>>>  16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-required_defaults_Debian_jessie.yml", "content": "nginx_user: www-data", "line": 5, "detection_span": [3, 7], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-required_defaults_Debian_jessie.yml\n# Target line: 5\n\n      1: ---\n      2: init_template: systemd_template.j2\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n>>>   5: nginx_user: www-data\n      6: mysql_service_name: mysql\n      7: required_packages:\n      8:   - mysql-server\n      9:   - rabbitmq-server\n     10:   - python-dev", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-required_defaults_Debian_jessie.yml\n# Target line: 5\n\n      1: ---\n      2: init_template: systemd_template.j2\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n>>>   5: nginx_user: www-data\n      6: mysql_service_name: mysql\n      7: required_packages:\n      8:   - mysql-server\n      9:   - rabbitmq-server\n     10:   - python-dev\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "browbeat-ansible-install-roles-fluentd-tasks-main.yml", "content": "key=https://packages.treasuredata.com/GPG-KEY-td-agent", "line": 17, "detection_span": [15, 19], "with_context": "# File: browbeat-ansible-install-roles-fluentd-tasks-main.yml\n# Target line: 17\n\n     12:     mode=0644\n     13:   become: true\n     14: \n     15: - name: Import fluentd GPG Key\n     16:   rpm_key:\n>>>  17:     key=https://packages.treasuredata.com/GPG-KEY-td-agent\n     18:     state=present\n     19: \n     20: - name: Install fluentd\n     21:   yum: name={{ item }} state=present\n     22:   become: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: browbeat-ansible-install-roles-fluentd-tasks-main.yml\n# Target line: 17\n\n     12:     mode=0644\n     13:   become: true\n     14: \n     15: - name: Import fluentd GPG Key\n     16:   rpm_key:\n>>>  17:     key=https://packages.treasuredata.com/GPG-KEY-td-agent\n     18:     state=present\n     19: \n     20: - name: Install fluentd\n     21:   yum: name={{ item }} state=present\n     22:   become: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack-ansible-ops-leap-upgrades-upgrade-utilities-mitaka-playbooks-deploy-config-changes-mitaka.yml", "content": "user: root", "line": 20, "detection_span": [18, 22], "with_context": "# File: openstack-ansible-ops-leap-upgrades-upgrade-utilities-mitaka-playbooks-deploy-config-changes-mitaka.yml\n# Target line: 20\n\n     15: \n     16: - name: Upgrade environment/inventory configuration\n     17:   hosts: localhost\n     18:   connection: local\n     19:   gather_facts: false\n>>>  20:   user: root\n     21:   tasks:\n     22:       - name: Create an old copy of openstack_deploy\n     23:         copy:\n     24:           src: \"/etc/openstack_deploy/\"\n     25:           dest: \"/etc/openstack_deploy.LIBERTY/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-leap-upgrades-upgrade-utilities-mitaka-playbooks-deploy-config-changes-mitaka.yml\n# Target line: 20\n\n     15: \n     16: - name: Upgrade environment/inventory configuration\n     17:   hosts: localhost\n     18:   connection: local\n     19:   gather_facts: false\n>>>  20:   user: root\n     21:   tasks:\n     22:       - name: Create an old copy of openstack_deploy\n     23:         copy:\n     24:           src: \"/etc/openstack_deploy/\"\n     25:           dest: \"/etc/openstack_deploy.LIBERTY/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack-ansible-playbooks-lxc-containers-destroy.yml", "content": "key: lxc_containers", "line": 22, "detection_span": [20, 24], "with_context": "# File: openstack-ansible-playbooks-lxc-containers-destroy.yml\n# Target line: 22\n\n     17:   hosts: \"{{ container_group | default('all_containers') }}\"\n     18:   gather_facts: false\n     19:   tasks:\n     20:     - name: Add hosts to dynamic inventory group\n     21:       group_by:\n>>>  22:         key: lxc_containers\n     23:         parents: all_lxc_containers\n     24:       when:\n     25:         - container_tech == 'lxc'\n     26:   tags:\n     27:     - always", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-lxc-containers-destroy.yml\n# Target line: 22\n\n     17:   hosts: \"{{ container_group | default('all_containers') }}\"\n     18:   gather_facts: false\n     19:   tasks:\n     20:     - name: Add hosts to dynamic inventory group\n     21:       group_by:\n>>>  22:         key: lxc_containers\n     23:         parents: all_lxc_containers\n     24:       when:\n     25:         - container_tech == 'lxc'\n     26:   tags:\n     27:     - always\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack-ansible-playbooks-utility-install.yml", "content": "dest: /root/.ssh/id_rsa", "line": 70, "detection_span": [68, 72], "with_context": "# File: openstack-ansible-playbooks-utility-install.yml\n# Target line: 70\n\n     65:         cache_valid_time: \"{{ (ansible_pkg_mgr == 'apt') | ternary(cache_timeout, omit) }}\"\n     66: \n     67:     - name: Distribute private ssh key\n     68:       copy:\n     69:         content: \"{{ utility_ssh_private_key }}\"\n>>>  70:         dest: /root/.ssh/id_rsa\n     71:         mode: 0600\n     72:         owner: root\n     73:         group: root\n     74:       when: utility_ssh_private_key is defined\n     75: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-utility-install.yml\n# Target line: 70\n\n     65:         cache_valid_time: \"{{ (ansible_pkg_mgr == 'apt') | ternary(cache_timeout, omit) }}\"\n     66: \n     67:     - name: Distribute private ssh key\n     68:       copy:\n     69:         content: \"{{ utility_ssh_private_key }}\"\n>>>  70:         dest: /root/.ssh/id_rsa\n     71:         mode: 0600\n     72:         owner: root\n     73:         group: root\n     74:       when: utility_ssh_private_key is defined\n     75: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "tripleo-quickstart-roles-libvirt-setup-overcloud-tasks-vars-libvirt_nodepool_vars.yml", "content": "vm_pass: random", "line": 16, "detection_span": [14, 18], "with_context": "# File: tripleo-quickstart-roles-libvirt-setup-overcloud-tasks-vars-libvirt_nodepool_vars.yml\n# Target line: 16\n\n     11:     flavor: control\n     12: pub_key: \"{{ lookup('env', 'HOME') }}/.ssh/id_rsa.pub\"\n     13: image_fetch_dir: \"{{ local_working_dir }}\"\n     14: libvirt_nodepool_vms: true\n     15: create_instackenv_json: false\n>>>  16: vm_pass: random\n     17: control_vcpu: 6\n     18: control_memory: 16384\n     19: images:\n     20:   - name: centos\n     21:     url: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1802.qcow2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: tripleo-quickstart-roles-libvirt-setup-overcloud-tasks-vars-libvirt_nodepool_vars.yml\n# Target line: 16\n\n     11:     flavor: control\n     12: pub_key: \"{{ lookup('env', 'HOME') }}/.ssh/id_rsa.pub\"\n     13: image_fetch_dir: \"{{ local_working_dir }}\"\n     14: libvirt_nodepool_vms: true\n     15: create_instackenv_json: false\n>>>  16: vm_pass: random\n     17: control_vcpu: 6\n     18: control_memory: 16384\n     19: images:\n     20:   - name: centos\n     21:     url: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1802.qcow2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "ansible-role-tripleo-modify-image-tasks-modify_image.yml", "content": "#FIXME: buildah should not required root commands to build an image", "line": 35, "detection_span": [33, 37], "with_context": "# File: ansible-role-tripleo-modify-image-tasks-modify_image.yml\n# Target line: 35\n\n     30:     insertafter: \"^FROM \"\n     31:     line: \"LABEL modified_append_tag={{ modified_append_tag }}\"\n     32: \n     33: - name: Modify image from {{ modify_dir_path }}\n     34:   command: \"{{ build_commands[container_build_tool] }} --tag {{ target_image | default(source_image) }}{{ modified_append_tag }} --file Dockerfile.modified --network host ./\"\n>>>  35:   #FIXME: buildah should not required root commands to build an image\n     36:   become: \"{{ true if build_commands[container_build_tool] == 'buildah' else false }}\"\n     37:   args:\n     38:     chdir: \"{{ modify_dir_path }}\"\n     39: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: ansible-role-tripleo-modify-image-tasks-modify_image.yml\n# Target line: 35\n\n     30:     insertafter: \"^FROM \"\n     31:     line: \"LABEL modified_append_tag={{ modified_append_tag }}\"\n     32: \n     33: - name: Modify image from {{ modify_dir_path }}\n     34:   command: \"{{ build_commands[container_build_tool] }} --tag {{ target_image | default(source_image) }}{{ modified_append_tag }} --file Dockerfile.modified --network host ./\"\n>>>  35:   #FIXME: buildah should not required root commands to build an image\n     36:   become: \"{{ true if build_commands[container_build_tool] == 'buildah' else false }}\"\n     37:   args:\n     38:     chdir: \"{{ modify_dir_path }}\"\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "browbeat-ansible-browbeat-roles-gnocchi-config-tasks-main.yml", "content": "# (akrzos) Commented out Group as to prevent in Pike incorrect permissions on config file", "line": 11, "detection_span": [9, 13], "with_context": "# File: browbeat-ansible-browbeat-roles-gnocchi-config-tasks-main.yml\n# Target line: 11\n\n      6: - name: Configure gnocchi.conf\n      7:   become: true\n      8:   ini_file:\n      9:     dest: \"{{gnocchi_config_file}}\"\n     10:     mode: 0640\n>>>  11:     # (akrzos) Commented out Group as to prevent in Pike incorrect permissions on config file\n     12:     # group: gnocchi\n     13:     section: \"{{item.section}}\"\n     14:     option: \"{{item.option}}\"\n     15:     value: \"{{item.value}}\"\n     16:     backup: yes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: browbeat-ansible-browbeat-roles-gnocchi-config-tasks-main.yml\n# Target line: 11\n\n      6: - name: Configure gnocchi.conf\n      7:   become: true\n      8:   ini_file:\n      9:     dest: \"{{gnocchi_config_file}}\"\n     10:     mode: 0640\n>>>  11:     # (akrzos) Commented out Group as to prevent in Pike incorrect permissions on config file\n     12:     # group: gnocchi\n     13:     section: \"{{item.section}}\"\n     14:     option: \"{{item.option}}\"\n     15:     value: \"{{item.value}}\"\n     16:     backup: yes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml", "content": "# TODO(odyssey4me): revisit this once the bug is fixed and released", "line": 98, "detection_span": [96, 100], "with_context": "# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 98\n\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n     96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n>>>  98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart\n    102:   command: >\n    103:     lxc-stop --name {{ inventory_hostname }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 98\n\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n     96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n>>>  98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart\n    102:   command: >\n    103:     lxc-stop --name {{ inventory_hostname }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack-ansible-playbooks-healthcheck-hosts.yml", "content": "# TO BE IMPLEMENTED", "line": 20, "detection_span": [18, 22], "with_context": "# File: openstack-ansible-playbooks-healthcheck-hosts.yml\n# Target line: 20\n\n     15: \n     16: # This playbook is meant to run after setup-hosts.\n     17: # To succeed, it expects the setup-hosts playbook to have run successfuly.\n     18: \n     19: # Test if the openstack-hosts-setup play was a success.\n>>>  20: # TO BE IMPLEMENTED\n     21: \n     22: # Test if security-hardening was a success.\n     23: # TO BE IMPLEMENTED\n     24: \n     25: # Test if containers-deploy was a success.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-healthcheck-hosts.yml\n# Target line: 20\n\n     15: \n     16: # This playbook is meant to run after setup-hosts.\n     17: # To succeed, it expects the setup-hosts playbook to have run successfuly.\n     18: \n     19: # Test if the openstack-hosts-setup play was a success.\n>>>  20: # TO BE IMPLEMENTED\n     21: \n     22: # Test if security-hardening was a success.\n     23: # TO BE IMPLEMENTED\n     24: \n     25: # Test if containers-deploy was a success.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml", "content": "# Due to https://github.com/ansible/ansible-modules-extras/issues/2691", "line": 96, "detection_span": [94, 98], "with_context": "# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 96\n\n     91:   retries: 3\n     92:   delay: 5\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n>>>  96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n     98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 96\n\n     91:   retries: 3\n     92:   delay: 5\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n>>>  96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n     98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'", "line": 24, "detection_span": [22, 26], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 24\n\n     19: default_os_families:\n     20:   ubuntu-16.04-amd64: debian\n     21:   ubuntu-14.04-amd64: debian\n     22: \n     23: default_ubuntu_kernel: linux-generic\n>>>  24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 24\n\n     19: default_os_families:\n     20:   ubuntu-16.04-amd64: debian\n     21:   ubuntu-14.04-amd64: debian\n     22: \n     23: default_ubuntu_kernel: linux-generic\n>>>  24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "default_proxy_url: 'http://10.0.2.1:3142/'", "line": 28, "detection_span": [26, 30], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 28\n\n     23: default_ubuntu_kernel: linux-generic\n     24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n>>>  28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n     32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 28\n\n     23: default_ubuntu_kernel: linux-generic\n     24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n>>>  28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n     32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "ipxe_kernel_base_url: \"http://boot.ipxe.org\"", "line": 32, "detection_span": [30, 34], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 32\n\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n>>>  32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: \n     34: # The timeout for the SSH check to the vm_servers\n     35: vm_ssh_timeout: 1500\n     36: \n     37: # Whether to use snapshots (if they are available) for file-backed VM's", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 32\n\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n>>>  32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: \n     34: # The timeout for the SSH check to the vm_servers\n     35: vm_ssh_timeout: 1500\n     36: \n     37: # Whether to use snapshots (if they are available) for file-backed VM's\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"", "line": 53, "detection_span": [51, 55], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 53\n\n     48:     image_type: \"debian\"\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 53\n\n     48:     image_type: \"debian\"\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"", "line": 54, "detection_span": [52, 56], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 54\n\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 54\n\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "url: \"http://{{ tftp_server }}/configs/vm.config\"", "line": 57, "detection_span": [55, 59], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 57\n\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n>>>  57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n     60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 57\n\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n>>>  57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n     60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "url: \"http://{{ tftp_server }}/configs/vm-compute.config\"", "line": 60, "detection_span": [58, 62], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 60\n\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n>>>  60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 60\n\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n>>>  60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"", "line": 68, "detection_span": [66, 70], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 68\n\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 68\n\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"", "line": 69, "detection_span": [67, 71], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 69\n\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"\n     74:       vm-compute:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 69\n\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"\n     74:       vm-compute:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"", "line": 83, "detection_span": [81, 85], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 83\n\n     78:     image_type: \"debian\"\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n>>>  83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 83\n\n     78:     image_type: \"debian\"\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n>>>  83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"", "line": 84, "detection_span": [82, 86], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 84\n\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n     83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"\n     89:       vm-compute:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 84\n\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n     83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"\n     89:       vm-compute:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"", "line": 96, "detection_span": [94, 98], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 96\n\n     91:         template_name: \"vm-compute.config\"\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n>>>  96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 96\n\n     91:         template_name: \"vm-compute.config\"\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n>>>  96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"", "line": 97, "detection_span": [95, 99], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 97\n\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n>>>  97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 97\n\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n>>>  97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"", "line": 98, "detection_span": [96, 100], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 98\n\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n>>>  98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n    103:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 98\n\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n>>>  98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n    103:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "cors_allowed_origin2: \"www.google.com\"", "line": 23, "detection_span": [21, 25], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 23\n\n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests\n     22: cors_allowed_origin: \"http://localhost:8000\"\n>>>  23: cors_allowed_origin2: \"www.google.com\"\n     24: # bifrost utilizes noauth mode by default and as such\n     25: # the setting should be set to false. This setting should\n     26: # not need to be modified by the user.\n     27: enable_cors_credential_support: false\n     28: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 23\n\n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests\n     22: cors_allowed_origin: \"http://localhost:8000\"\n>>>  23: cors_allowed_origin2: \"www.google.com\"\n     24: # bifrost utilizes noauth mode by default and as such\n     25: # the setting should be set to false. This setting should\n     26: # not need to be modified by the user.\n     27: enable_cors_credential_support: false\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
