{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-roles-docker-distribution-defaults-main.yml", "content": "key_src: \"ca.key\"", "line": 29, "detection_span": [24, 34], "with_context": "# Ansible file: tmzullinger_fedora-ansible-roles-docker-distribution-defaults-main.yml\n\n# Cert information to place certificate files on system\ncert:\ndest_dir: \"/etc/pki/docker/{{ inventory_hostname }}{{ http.addr }}\"\ncert_src: \"ca.crt\"\ncert_dest: \"ca.crt\"\n29:   key_src: \"ca.key\"\nkey_dest: \"ca.key\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-roles-docker-distribution-defaults-main.yml\n# Target line: 29\n\n     24: # Cert information to place certificate files on system\n     25: cert:\n     26:   dest_dir: \"/etc/pki/docker/{{ inventory_hostname }}{{ http.addr }}\"\n     27:   cert_src: \"ca.crt\"\n     28:   cert_dest: \"ca.crt\"\n>>>  29:   key_src: \"ca.key\"\n     30:   key_dest: \"ca.key\"\n     31: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mdw-at-linuxbox_ceph-ansible-roles-ceph-mon-defaults-main.yml", "content": "- { name: client.gnocchi, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_gnocchi_pool.name }}\", mode: \"0600\", acls: [] }", "line": 102, "detection_span": [97, 107], "with_context": "# Ansible file: mdw-at-linuxbox_ceph-ansible-roles-ceph-mon-defaults-main.yml\n\n# acls: [\"u:nova:r--\", \"u:cinder:r--\", \"u:glance:r--\", \"u:gnocchi:r--\"]\nopenstack_keys:\n- { name: client.glance, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: [] }\n100:   - { name: client.cinder, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: []  }\n101:   - { name: client.cinder-backup, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n102:   - { name: client.gnocchi, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_gnocchi_pool.name }}\", mode: \"0600\", acls: [] }\n103:   - { name: client.openstack, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n104:\n105: ##########\n106: # DOCKER #\n107: ##########", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: mdw-at-linuxbox_ceph-ansible-roles-ceph-mon-defaults-main.yml\n# Target line: 102\n\n     97: # acls: [\"u:nova:r--\", \"u:cinder:r--\", \"u:glance:r--\", \"u:gnocchi:r--\"]\n     98: openstack_keys:\n     99:   - { name: client.glance, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: [] }\n    100:   - { name: client.cinder, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: []  }\n    101:   - { name: client.cinder-backup, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n>>> 102:   - { name: client.gnocchi, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_gnocchi_pool.name }}\", mode: \"0600\", acls: [] }\n    103:   - { name: client.openstack, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n    104: \n    105: ##########\n    106: # DOCKER #\n    107: ##########\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_ceph_client-molecule-default-converge.yml", "content": "key: AQAqFN1fAAAAABAAkHoVtZxSvvRbwYtZ4LwNZA==", "line": 134, "detection_span": [129, 139], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_ceph_client-molecule-default-converge.yml\n\nkeys:\n- caps:\nmgr: allow *\nmon: profile rbd\nosd: profile rbd pool=vms, profile rbd pool=volumes, profile rbd pool=images\n134:                 key: AQAqFN1fAAAAABAAkHoVtZxSvvRbwYtZ4LwNZA==\nmode: '0600'\nname: client.openstack\n- cluster: dcn1\nceph_conf_overrides:\nclient:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_ceph_client-molecule-default-converge.yml\n# Target line: 134\n\n    129:             keys:\n    130:               - caps:\n    131:                   mgr: allow *\n    132:                   mon: profile rbd\n    133:                   osd: profile rbd pool=vms, profile rbd pool=volumes, profile rbd pool=images\n>>> 134:                 key: AQAqFN1fAAAAABAAkHoVtZxSvvRbwYtZ4LwNZA==\n    135:                 mode: '0600'\n    136:                 name: client.openstack\n    137:           - cluster: dcn1\n    138:             ceph_conf_overrides:\n    139:               client:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "litmuschaos_litmus-monitoring-utils-metrics-exporters-kube-state-metrics-deployment.yaml", "content": "runAsUser: 65534", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: litmuschaos_litmus-monitoring-utils-metrics-exporters-kube-state-metrics-deployment.yaml\n\nrelease: prometheus-stack\nspec:\ncontainers:\n- image: k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.0.0-beta\nsecurityContext:\n25:             runAsUser: 65534\nlivenessProbe:\nhttpGet:\npath: /healthz\nport: 8080\ninitialDelaySeconds: 5", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: litmuschaos_litmus-monitoring-utils-metrics-exporters-kube-state-metrics-deployment.yaml\n# Target line: 25\n\n     20:         release: prometheus-stack\n     21:     spec:\n     22:       containers:\n     23:         - image: k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.0.0-beta\n     24:           securityContext:\n>>>  25:             runAsUser: 65534\n     26:           livenessProbe:\n     27:             httpGet:\n     28:               path: /healthz\n     29:               port: 8080\n     30:             initialDelaySeconds: 5\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "davestephens_ansible-nas-roles-gitlab-tasks-main.yml", "content": "update_password: on_create", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: davestephens_ansible-nas-roles-gitlab-tasks-main.yml\n\nuser:\nname: gitlab\nuid: 998\nstate: present\nsystem: yes\n25:     update_password: on_create\ncreate_home: no\ngroup: gitlab\n\n- name: Create Gitlab Directories\nfile:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: davestephens_ansible-nas-roles-gitlab-tasks-main.yml\n# Target line: 25\n\n     20:   user:\n     21:     name: gitlab\n     22:     uid: 998\n     23:     state: present\n     24:     system: yes\n>>>  25:     update_password: on_create\n     26:     create_home: no\n     27:     group: gitlab\n     28: \n     29: - name: Create Gitlab Directories\n     30:   file:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ComplianceAsCode_content-products-example-product.yml", "content": "cpes_root: \"../../shared/applicability\"", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: ComplianceAsCode_content-products-example-product.yml\n\n\npkg_manager: \"dnf\"\n\ninit_system: \"systemd\"\n\n14: cpes_root: \"../../shared/applicability\"\ncpes:\n- example:\nname: \"cpe:/o:example\"\ntitle: \"Example\"\ncheck_id: installed_OS_is_part_of_Unix_family", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ComplianceAsCode_content-products-example-product.yml\n# Target line: 14\n\n      9: \n     10: pkg_manager: \"dnf\"\n     11: \n     12: init_system: \"systemd\"\n     13: \n>>>  14: cpes_root: \"../../shared/applicability\"\n     15: cpes:\n     16:   - example:\n     17:       name: \"cpe:/o:example\"\n     18:       title: \"Example\"\n     19:       check_id: installed_OS_is_part_of_Unix_family\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "voot_oidcng_checkToken_secret: secret", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\n\nteams_authz_client_secret: secret\nteams_migration_secret_key: secret\n\nvoot_resource_checking_secret: secret\n44: voot_oidcng_checkToken_secret: secret\n\nexternal_group_provider_secrets:\nteams: secret\n\nteams_api_lifecycle_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 44\n\n     39: \n     40: teams_authz_client_secret: secret\n     41: teams_migration_secret_key: secret\n     42: \n     43: voot_resource_checking_secret: secret\n>>>  44: voot_oidcng_checkToken_secret: secret\n     45: \n     46: external_group_provider_secrets:\n     47:   teams: secret\n     48: \n     49: teams_api_lifecycle_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Kishorem05_ansible-lamp-infrastructure-provisioners-aws.yml", "content": "host_key_checking: false", "line": 107, "detection_span": [102, 112], "with_context": "# Ansible file: Kishorem05_ansible-lamp-infrastructure-provisioners-aws.yml\n\nadd_host:\nname: \"{{ item.1.tagged_instances.0.public_ip }}\"\ngroups: \"aws,{{ item.1.item.group }},{{ item.1.item.name }}\"\n# You can dynamically add inventory variables per-host.\nansible_user: centos\n107:         host_key_checking: false\nmysql_replication_role: >-\n{{ 'master' if (item.1.item.name == 'a4d.lamp.db.1')\nelse 'slave' }}\nmysql_server_id: \"{{ item.0 }}\"\nwhen: item.1.instances is defined", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Kishorem05_ansible-lamp-infrastructure-provisioners-aws.yml\n# Target line: 107\n\n    102:       add_host:\n    103:         name: \"{{ item.1.tagged_instances.0.public_ip }}\"\n    104:         groups: \"aws,{{ item.1.item.group }},{{ item.1.item.name }}\"\n    105:         # You can dynamically add inventory variables per-host.\n    106:         ansible_user: centos\n>>> 107:         host_key_checking: false\n    108:         mysql_replication_role: >-\n    109:           {{ 'master' if (item.1.item.name == 'a4d.lamp.db.1')\n    110:           else 'slave' }}\n    111:         mysql_server_id: \"{{ item.0 }}\"\n    112:       when: item.1.instances is defined\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml", "content": "secret: registry-certificates", "line": 84, "detection_span": [79, 89], "with_context": "# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n\nregister: create_registry_certificates_secret_out\n\n- name: Add the secret to the registry's pod service accounts\noc_serviceaccount_secret:\nservice_account: \"{{ item }}\"\n84:     secret: registry-certificates\nnamespace: \"{{ openshift_hosted_registry_namespace }}\"\nwith_items:\n- registry\n- default\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n# Target line: 84\n\n     79:   register: create_registry_certificates_secret_out\n     80: \n     81: - name: Add the secret to the registry's pod service accounts\n     82:   oc_serviceaccount_secret:\n     83:     service_account: \"{{ item }}\"\n>>>  84:     secret: registry-certificates\n     85:     namespace: \"{{ openshift_hosted_registry_namespace }}\"\n     86:   with_items:\n     87:   - registry\n     88:   - default\n     89: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dellhpc_omnia-control_plane-input_params-ethernet_tor_vars.yml", "content": "admin: up", "line": 53, "detection_span": [48, 58], "with_context": "# Ansible file: dellhpc_omnia-control_plane-input_params-ethernet_tor_vars.yml\n\nethernet 1/1/7:\ndesc: \"Port 7\"\nadmin: up\nethernet 1/1/8:\ndesc: \"Port 8\"\n53:       admin: up\nethernet 1/1/9:\ndesc: \"Port 9\"\nadmin: up\nethernet 1/1/10:\ndesc: \"Port 10\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dellhpc_omnia-control_plane-input_params-ethernet_tor_vars.yml\n# Target line: 53\n\n     48:     ethernet 1/1/7:\n     49:       desc: \"Port 7\"\n     50:       admin: up\n     51:     ethernet 1/1/8:\n     52:       desc: \"Port 8\"\n>>>  53:       admin: up\n     54:     ethernet 1/1/9:\n     55:       desc: \"Port 9\"\n     56:       admin: up\n     57:     ethernet 1/1/10:\n     58:       desc: \"Port 10\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml", "content": "- key: \"instance_filter\"", "line": 57, "detection_span": [52, 62], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n\ntags:\n- key: \"AnsibleGroup\"\nvalue: \"bastions\"\n- key: \"ostype\"\nvalue: \"linux\"\n57:       - key: \"instance_filter\"\nvalue: \"{{ env_type }}-{{ email }}\"\n\n- name: \"frontend\"\ncount: \"{{ frontend_instance_count | default(1) }}\"\npublic_dns: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n# Target line: 57\n\n     52:     tags:\n     53:       - key: \"AnsibleGroup\"\n     54:         value: \"bastions\"\n     55:       - key: \"ostype\"\n     56:         value: \"linux\"\n>>>  57:       - key: \"instance_filter\"\n     58:         value: \"{{ env_type }}-{{ email }}\"\n     59: \n     60:   - name: \"frontend\"\n     61:     count: \"{{ frontend_instance_count | default(1) }}\"\n     62:     public_dns: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml", "content": "ceilometer_oslomsg_rpc_userid: ceilometer", "line": 21, "detection_span": [16, 26], "with_context": "# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n\nceilometer_service_user_name: \"{{ hostvars['localhost']['ceilometer_service_user_name'] }}\"\nceilometer_service_tenant_name: \"{{ hostvars['localhost']['ceilometer_service_tenant_name'] }}\"\n\n# TODO(ansmith): remove rabbitmq vars once service file is updated\n# to use oslomsg vars\n21: ceilometer_oslomsg_rpc_userid: ceilometer\nceilometer_oslomsg_rpc_vhost: /ceilometer\nceilometer_oslomsg_notify_userid: ceilometer\nceilometer_oslomsg_notify_vhost: /ceilometer\n\n# These are here rather than in ceilometer_all because", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n# Target line: 21\n\n     16: ceilometer_service_user_name: \"{{ hostvars['localhost']['ceilometer_service_user_name'] }}\"\n     17: ceilometer_service_tenant_name: \"{{ hostvars['localhost']['ceilometer_service_tenant_name'] }}\"\n     18: \n     19: # TODO(ansmith): remove rabbitmq vars once service file is updated\n     20: # to use oslomsg vars\n>>>  21: ceilometer_oslomsg_rpc_userid: ceilometer\n     22: ceilometer_oslomsg_rpc_vhost: /ceilometer\n     23: ceilometer_oslomsg_notify_userid: ceilometer\n     24: ceilometer_oslomsg_notify_vhost: /ceilometer\n     25: \n     26: # These are here rather than in ceilometer_all because\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-pntae-jabn-default_vars_osp.yml", "content": "ansible_user: cloud-user", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-pntae-jabn-default_vars_osp.yml\n\n---\n2: ansible_user: cloud-user\nremote_user: cloud-user\n\nchomped_zone_internal_dns: \"example.com\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-pntae-jabn-default_vars_osp.yml\n# Target line: 2\n\n      1: ---\n>>>   2: ansible_user: cloud-user\n      3: remote_user: cloud-user\n      4: \n      5: chomped_zone_internal_dns: \"example.com\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "geerlingguy_drupal-vm-provisioning-roles-geerlingguy.nodejs-molecule-default-playbook-latest.yml", "content": "nodejs_install_npm_user: root", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.nodejs-molecule-default-playbook-latest.yml\n\nhosts: all\nbecome: true\n\nvars:\nnodejs_version: \"13.x\"\n8:     nodejs_install_npm_user: root\nnpm_config_prefix: /root/.npm-global\nnpm_config_unsafe_perm: \"true\"\nnodejs_npm_global_packages:\n- slugify\n- name: jslint", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.nodejs-molecule-default-playbook-latest.yml\n# Target line: 8\n\n      3:   hosts: all\n      4:   become: true\n      5: \n      6:   vars:\n      7:     nodejs_version: \"13.x\"\n>>>   8:     nodejs_install_npm_user: root\n      9:     npm_config_prefix: /root/.npm-global\n     10:     npm_config_unsafe_perm: \"true\"\n     11:     nodejs_npm_global_packages:\n     12:       - slugify\n     13:       - name: jslint\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jcalazan_ansible-django-stack-roles-base-defaults-main.yml", "content": "server_user: root", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: jcalazan_ansible-django-stack-roles-base-defaults-main.yml\n\n---\n\nansible_python_interpreter: /usr/bin/python3\n\n5: server_user: root\n\nbase_python_package: \"{{ ansible_python_interpreter | default('/usr/bin/python') | basename }}\"\n\ncreate_swap_file: false\nswap_file_path: /swapfile", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: jcalazan_ansible-django-stack-roles-base-defaults-main.yml\n# Target line: 5\n\n      1: ---\n      2: \n      3: ansible_python_interpreter: /usr/bin/python3\n      4: \n>>>   5: server_user: root\n      6: \n      7: base_python_package: \"{{ ansible_python_interpreter | default('/usr/bin/python') | basename }}\"\n      8: \n      9: create_swap_file: false\n     10: swap_file_path: /swapfile\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cfpb_aurora-deploy-roles-redis-defaults-main.yml", "content": "redis_user:                             redis", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: cfpb_aurora-deploy-roles-redis-defaults-main.yml\n\n---\n\nepel_repo_url:                          \"https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\"\n4: redis_user:                             redis\nredis_user_shell:                       \"/bin/false\"\nredis_group:                            \"{{ redis_user }}\"\nredis_user_groups:                      []\nredis_pidfile:                          /var/run/redis/redis.{{ redis_port }}\nredis_db_dir:                           /var/lib/redis", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cfpb_aurora-deploy-roles-redis-defaults-main.yml\n# Target line: 4\n\n      1: ---\n      2: \n      3: epel_repo_url:                          \"https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\" \n>>>   4: redis_user:                             redis\n      5: redis_user_shell:                       \"/bin/false\"\n      6: redis_group:                            \"{{ redis_user }}\"\n      7: redis_user_groups:                      []\n      8: redis_pidfile:                          /var/run/redis/redis.{{ redis_port }}\n      9: redis_db_dir:                           /var/lib/redis\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper_contrail-ansible-playbooks-roles-docker-vars-RedHat.yml", "content": "docker_ssl_key_pki_cert_dir : /etc/pki/tls/certs", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: Juniper_contrail-ansible-playbooks-roles-docker-vars-RedHat.yml\n\n---\ndocker_ssl_key_pki_cacert_dir : /etc/pki/ca-trust/source/anchors\n3: docker_ssl_key_pki_cert_dir : /etc/pki/tls/certs\ndocker_ssl_key_pki_key_dir : /etc/pki/tls/private\n\ndocker_options_var: OPTIONS\ndocker_env_file: \"{{ '/etc/sysconfig/docker' if ansible_distribution != 'RedHat' else '/etc/docker/daemon.json' }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Juniper_contrail-ansible-playbooks-roles-docker-vars-RedHat.yml\n# Target line: 3\n\n      1: ---\n      2: docker_ssl_key_pki_cacert_dir : /etc/pki/ca-trust/source/anchors\n>>>   3: docker_ssl_key_pki_cert_dir : /etc/pki/tls/certs\n      4: docker_ssl_key_pki_key_dir : /etc/pki/tls/private\n      5: \n      6: docker_options_var: OPTIONS\n      7: docker_env_file: \"{{ '/etc/sysconfig/docker' if ansible_distribution != 'RedHat' else '/etc/docker/daemon.json' }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "social-network_matrix-deployer-roles-matrix-bridge-appservice-webhooks-defaults-main.yml", "content": "matrix_appservice_webhooks_id_token: ''", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-webhooks-defaults-main.yml\n\n# List of systemd services that matrix-appservice-webhooks.service wants\nmatrix_appservice_webhooks_systemd_wanted_services_list: []\n\nmatrix_appservice_webhooks_appservice_token: ''\nmatrix_appservice_webhooks_homeserver_token: ''\n46: matrix_appservice_webhooks_id_token: ''\nmatrix_appservice_webhooks_api_secret: ''\n\n# Logging information (info and verbose is available) default is: info\nmatrix_appservice_webhooks_log_level: 'info'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-webhooks-defaults-main.yml\n# Target line: 46\n\n     41: # List of systemd services that matrix-appservice-webhooks.service wants\n     42: matrix_appservice_webhooks_systemd_wanted_services_list: []\n     43: \n     44: matrix_appservice_webhooks_appservice_token: ''\n     45: matrix_appservice_webhooks_homeserver_token: ''\n>>>  46: matrix_appservice_webhooks_id_token: ''\n     47: matrix_appservice_webhooks_api_secret: ''\n     48: \n     49: # Logging information (info and verbose is available) default is: info\n     50: matrix_appservice_webhooks_log_level: 'info'\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AlexPrem_Openstack-Ansible-inventory-group_vars-aodh_all.yml", "content": "aodh_oslomsg_notify_userid: aodh", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-aodh_all.yml\n\n\n# TODO(ansmith): remove rabbitmq vars once service file is updated\n# to use oslomsg vars\naodh_oslomsg_rpc_userid: aodh\naodh_oslomsg_rpc_vhost: /aodh\n26: aodh_oslomsg_notify_userid: aodh\naodh_oslomsg_notify_vhost: /aodh\n\naodh_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\n\naodh_service_in_ldap: \"{{ service_ldap_backend_enabled }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-aodh_all.yml\n# Target line: 26\n\n     21: \n     22: # TODO(ansmith): remove rabbitmq vars once service file is updated\n     23: # to use oslomsg vars\n     24: aodh_oslomsg_rpc_userid: aodh\n     25: aodh_oslomsg_rpc_vhost: /aodh\n>>>  26: aodh_oslomsg_notify_userid: aodh\n     27: aodh_oslomsg_notify_vhost: /aodh\n     28: \n     29: aodh_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\n     30: \n     31: aodh_service_in_ldap: \"{{ service_ldap_backend_enabled }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml", "content": "- key: \"ostype\"", "line": 55, "detection_span": [50, 60], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n\nsecurity_groups:\n- BastionSG\ntags:\n- key: \"AnsibleGroup\"\nvalue: \"bastions\"\n55:       - key: \"ostype\"\nvalue: \"linux\"\n- key: \"instance_filter\"\nvalue: \"{{ env_type }}-{{ email }}\"\n\n- name: \"frontend\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n# Target line: 55\n\n     50:     security_groups:\n     51:       - BastionSG\n     52:     tags:\n     53:       - key: \"AnsibleGroup\"\n     54:         value: \"bastions\"\n>>>  55:       - key: \"ostype\"\n     56:         value: \"linux\"\n     57:       - key: \"instance_filter\"\n     58:         value: \"{{ env_type }}-{{ email }}\"\n     59: \n     60:   - name: \"frontend\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "freeipa_ansible-freeipa-playbooks-privilege-privilege-member-present.yml", "content": "ipaadmin_password: SomeADMINpassword", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: freeipa_ansible-freeipa-playbooks-privilege-privilege-member-present.yml\n\nbecome: true\n\ntasks:\n- name: Ensure privilege \"Broad Privilege\" permissions are present\nipaprivilege:\n9:       ipaadmin_password: SomeADMINpassword\nname: Broad Privilege\npermission:\n- \"System: Write IPA Configuration\"\n- \"System: Write DNS Configuration\"\n- \"System: Update DNS Entries\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: freeipa_ansible-freeipa-playbooks-privilege-privilege-member-present.yml\n# Target line: 9\n\n      4:   become: true\n      5: \n      6:   tasks:\n      7:   - name: Ensure privilege \"Broad Privilege\" permissions are present\n      8:     ipaprivilege:\n>>>   9:       ipaadmin_password: SomeADMINpassword\n     10:       name: Broad Privilege\n     11:       permission:\n     12:       - \"System: Write IPA Configuration\"\n     13:       - \"System: Write DNS Configuration\"\n     14:       - \"System: Update DNS Entries\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dellhpc_omnia-platforms-roles-polyaxon-files-polyaxon_config.yaml", "content": "cookieSecret: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: dellhpc_omnia-platforms-roles-polyaxon-files-polyaxon_config.yaml\n\nproxy:\nsecretToken: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\n\nhub:\n5:   cookieSecret: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\nservice:\ntype: LoadBalancer\ndb:\ntype: sqlite-pvc\nextraConfig:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dellhpc_omnia-platforms-roles-polyaxon-files-polyaxon_config.yaml\n# Target line: 5\n\n      1: proxy:\n      2:   secretToken: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\n      3: \n      4: hub:\n>>>   5:   cookieSecret: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\n      6:   service:\n      7:     type: LoadBalancer\n      8:   db:\n      9:     type: sqlite-pvc\n     10:   extraConfig:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chz8494_tdlab-openstack-playbooks-inventory-group_vars-barbican_all.yml", "content": "barbican_rabbitmq_userid: barbican", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: chz8494_tdlab-openstack-playbooks-inventory-group_vars-barbican_all.yml\n\n\nbarbican_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\nbarbican_rabbitmq_port: \"{{ rabbitmq_port }}\"\nbarbican_rabbitmq_servers: \"{{ rabbitmq_servers }}\"\nbarbican_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n28: barbican_rabbitmq_userid: barbican\nbarbican_rabbitmq_vhost: /barbican\n\n# venv fetch configuration\nbarbican_venv_tag: \"{{ venv_tag }}\"\nbarbican_venv_download_url: \"{{ venv_base_download_url }}/barbican-{{ openstack_release }}-{{ ansible_architecture | lower }}.tgz\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: chz8494_tdlab-openstack-playbooks-inventory-group_vars-barbican_all.yml\n# Target line: 28\n\n     23: \n     24: barbican_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\n     25: barbican_rabbitmq_port: \"{{ rabbitmq_port }}\"\n     26: barbican_rabbitmq_servers: \"{{ rabbitmq_servers }}\"\n     27: barbican_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n>>>  28: barbican_rabbitmq_userid: barbican\n     29: barbican_rabbitmq_vhost: /barbican\n     30: \n     31: # venv fetch configuration\n     32: barbican_venv_tag: \"{{ venv_tag }}\"\n     33: barbican_venv_download_url: \"{{ venv_base_download_url }}/barbican-{{ openstack_release }}-{{ ansible_architecture | lower }}.tgz\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_keystone_resources-tasks-admin.yml", "content": "user: admin", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_keystone_resources-tasks-admin.yml\n\nrole: admin\n\n- name: Assign _member_ role to admin project for admin user\nopenstack.cloud.role_assignment:\ncloud: \"{{ tripleo_keystone_resources_cloud_name }}\"\n61:     user: admin\nproject: admin\nrole: '_member_'\nwhen:\n- keystone_enable_member | default(tripleo_keystone_resources_member_role_enabled)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_keystone_resources-tasks-admin.yml\n# Target line: 61\n\n     56:     role: admin\n     57: \n     58: - name: Assign _member_ role to admin project for admin user\n     59:   openstack.cloud.role_assignment:\n     60:     cloud: \"{{ tripleo_keystone_resources_cloud_name }}\"\n>>>  61:     user: admin\n     62:     project: admin\n     63:     role: '_member_'\n     64:   when:\n     65:     - keystone_enable_member | default(tripleo_keystone_resources_member_role_enabled)\n     66: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml", "content": "helm_charts_url: \"http://{{ controller_floating_address | ipwrap }}:{{ helm_repo_port }}/helm_charts\"", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n\nexecutable: /usr/bin/python\nregister: helm_sql_database_password\n\n- name: Set Armada overrides\nset_fact:\n44:     helm_charts_url: \"http://{{ controller_floating_address | ipwrap }}:{{ helm_repo_port }}/helm_charts\"\nhelm_sql_connection_address: \"postgresql://admin-helmv2:{{ helm_sql_database_password.stdout }}@{{\ncontroller_floating_address | ipwrap }}:5432/helmv2?sslmode=disable\"\nhelm_sql_endpoint_ip: \"{{ controller_floating_address | ipwrap }}\"\n\n- name: Configure and launch containerized Armada", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n# Target line: 44\n\n     39:     executable: /usr/bin/python\n     40:   register: helm_sql_database_password\n     41: \n     42: - name: Set Armada overrides\n     43:   set_fact:\n>>>  44:     helm_charts_url: \"http://{{ controller_floating_address | ipwrap }}:{{ helm_repo_port }}/helm_charts\"\n     45:     helm_sql_connection_address: \"postgresql://admin-helmv2:{{ helm_sql_database_password.stdout }}@{{\n     46:                                   controller_floating_address | ipwrap }}:5432/helmv2?sslmode=disable\"\n     47:     helm_sql_endpoint_ip: \"{{ controller_floating_address | ipwrap }}\"\n     48: \n     49: - name: Configure and launch containerized Armada\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "NationalGenomicsInfrastructure_irma-provision-roles-tarzan-tasks-main.yml", "content": "# FIXME: Couldn't get this to work properly with supervisord because", "line": 57, "detection_span": [52, 62], "with_context": "# Ansible file: NationalGenomicsInfrastructure_irma-provision-roles-tarzan-tasks-main.yml\n\ncopy: src=\"tarzan_cert.pem\" dest=\"{{ tarzan_conf }}/tarzan_cert.pem\"\n\n- name: deploy ssl key for kong\ncopy: src=\"tarzan_key.pem\" dest=\"{{ tarzan_conf }}/tarzan_key.pem\"\n\n57: # FIXME: Couldn't get this to work properly with supervisord because\n# it demands that the program under control doesn't daemonize.\n# (The kong binary itself spawns nginx and self binaries)\n- name: modify uppsala's crontab to start kong\nlineinfile: dest=\"{{ ngi_pipeline_conf }}/crontab_upps\"\nline='# restart kong if it has died for some reason'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: NationalGenomicsInfrastructure_irma-provision-roles-tarzan-tasks-main.yml\n# Target line: 57\n\n     52:   copy: src=\"tarzan_cert.pem\" dest=\"{{ tarzan_conf }}/tarzan_cert.pem\"\n     53: \n     54: - name: deploy ssl key for kong \n     55:   copy: src=\"tarzan_key.pem\" dest=\"{{ tarzan_conf }}/tarzan_key.pem\"\n     56: \n>>>  57: # FIXME: Couldn't get this to work properly with supervisord because \n     58: # it demands that the program under control doesn't daemonize. \n     59: # (The kong binary itself spawns nginx and self binaries)\n     60: - name: modify uppsala's crontab to start kong\n     61:   lineinfile: dest=\"{{ ngi_pipeline_conf }}/crontab_upps\"\n     62:               line='# restart kong if it has died for some reason'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "carlosthe19916_openshift-ansible-roles-openshift_common-vars-main.yml", "content": "# TODO: it might be possible to still use firewalld if we wire up the created", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: carlosthe19916_openshift-ansible-roles-openshift_common-vars-main.yml\n\n---\n# TODO: Upstream kubernetes only supports iptables currently, if this changes,\n# then these variable should be moved to defaults\n4: # TODO: it might be possible to still use firewalld if we wire up the created\n# chains with the public zone (or the zone associated with the correct\n# interfaces)\nos_firewall_use_firewalld: False\n\nopenshift_data_dir: /var/lib/openshift", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: carlosthe19916_openshift-ansible-roles-openshift_common-vars-main.yml\n# Target line: 4\n\n      1: ---\n      2: # TODO: Upstream kubernetes only supports iptables currently, if this changes,\n      3: # then these variable should be moved to defaults\n>>>   4: # TODO: it might be possible to still use firewalld if we wire up the created\n      5: # chains with the public zone (or the zone associated with the correct\n      6: # interfaces)\n      7: os_firewall_use_firewalld: False\n      8: \n      9: openshift_data_dir: /var/lib/openshift\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml", "content": "#    storagePrefix: Prefix used when provisioning new volumes in the SVM", "line": 108, "detection_span": [103, 113], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n\n103: #    dataLIF: IP address of protocol LIF\n104: #    svm: Storage virtual machine to use\n105: #    igroupName:  Name of the igroup for SAN volumes to use\n106: #    username:  Username to connect to the cluster/SVM\n107: #    password:  Password to connect to the cluster/SVM\n108: #    storagePrefix: Prefix used when provisioning new volumes in the SVM\n109: #    limitAggregateUsage: Fail provisioning if usage is above this percentage\n110: #    limitVolumeSize: Fail provisioning if requested volume size is above this value\n111: #    nfsMountOptions\" Comma-separated list of NFS mount options (except ontap-san)\n112: #\n113: # WARNING: It is strongly recommended to store these settings in Ansible vault", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n# Target line: 108\n\n    103: #    dataLIF: IP address of protocol LIF\n    104: #    svm: Storage virtual machine to use\n    105: #    igroupName:  Name of the igroup for SAN volumes to use\n    106: #    username:  Username to connect to the cluster/SVM\n    107: #    password:  Password to connect to the cluster/SVM\n>>> 108: #    storagePrefix: Prefix used when provisioning new volumes in the SVM\n    109: #    limitAggregateUsage: Fail provisioning if usage is above this percentage\n    110: #    limitVolumeSize: Fail provisioning if requested volume size is above this value\n    111: #    nfsMountOptions\" Comma-separated list of NFS mount options (except ontap-san)\n    112: #\n    113: # WARNING: It is strongly recommended to store these settings in Ansible vault\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "litmuschaos_litmus-.github-stale.yml", "content": "# Number of days of inactivity before a stale issue is closed", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: litmuschaos_litmus-.github-stale.yml\n\n# Number of days of inactivity before an issue becomes stale\ndaysUntilStale: 60\n3: # Number of days of inactivity before a stale issue is closed\ndaysUntilClose: 7\n# Issues with these labels will never be considered stale\nexemptLabels:\n- pinned\n- security", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: litmuschaos_litmus-.github-stale.yml\n# Target line: 3\n\n      1: # Number of days of inactivity before an issue becomes stale\n      2: daysUntilStale: 60\n>>>   3: # Number of days of inactivity before a stale issue is closed\n      4: daysUntilClose: 7\n      5: # Issues with these labels will never be considered stale\n      6: exemptLabels:\n      7:   - pinned\n      8:   - security\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml", "content": "# HostedZoneId must match subdomain_base_suffix", "line": 67, "detection_span": [62, 72], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n\n\n# AWS Credentials\naws_access_key_id: FROM_SECRET\naws_secret_access_key: FROM_SECRET\n\n67: # HostedZoneId must match subdomain_base_suffix\n#HostedZoneId: FROM_SECRET\nsubdomain_base_suffix: .example.com\n\n# Reserve everything in the same AZ (costs saving)\n# Set to false to spread the instances across multiple zones", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n# Target line: 67\n\n     62: \n     63: # AWS Credentials\n     64: aws_access_key_id: FROM_SECRET\n     65: aws_secret_access_key: FROM_SECRET\n     66: \n>>>  67: # HostedZoneId must match subdomain_base_suffix\n     68: #HostedZoneId: FROM_SECRET\n     69: subdomain_base_suffix: .example.com\n     70: \n     71: # Reserve everything in the same AZ (costs saving)\n     72: # Set to false to spread the instances across multiple zones\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "keylime_keylime-vagrant-ansible-tpm-emulator-roles-ansible-keylime-tpm20-meta-main.yml", "content": "# issue_tracker_url: http://example.com/issue/tracker", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: keylime_keylime-vagrant-ansible-tpm-emulator-roles-ansible-keylime-tpm20-meta-main.yml\n\ndescription: Ansible Keylime\ncompany: Red Hat\n\n# If the issue tracker for your role is not on github, uncomment the\n# next line and provide a value\n8:   # issue_tracker_url: http://example.com/issue/tracker\n\n# Some suggested licenses:\n# - BSD (default)\n# - MIT\n# - GPLv2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: keylime_keylime-vagrant-ansible-tpm-emulator-roles-ansible-keylime-tpm20-meta-main.yml\n# Target line: 8\n\n      3:   description: Ansible Keylime\n      4:   company: Red Hat\n      5: \n      6:   # If the issue tracker for your role is not on github, uncomment the\n      7:   # next line and provide a value\n>>>   8:   # issue_tracker_url: http://example.com/issue/tracker\n      9: \n     10:   # Some suggested licenses:\n     11:   # - BSD (default)\n     12:   # - MIT\n     13:   # - GPLv2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "weak_cryptography_algorithms", "file": "openstack_openstack-ansible-os_swift-releasenotes-notes-swift-conf-b8dd5e1199f8e4a8.yaml", "content": "- Previously, the ``ansible_managed`` var was being", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: openstack_openstack-ansible-os_swift-releasenotes-notes-swift-conf-b8dd5e1199f8e4a8.yaml\n\n---\nfixes:\n3:   - Previously, the ``ansible_managed`` var was being\nused to insert a header into the ``swift.conf`` that\ncontained date/time information. This meant that\nswift.conf across different nodes did not have the\nsame MD5SUM, causing ``swift-recon --md5`` to break.\nWe now insert a piece of static text instead to", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_openstack-ansible-os_swift-releasenotes-notes-swift-conf-b8dd5e1199f8e4a8.yaml\n# Target line: 3\n\n      1: ---\n      2: fixes:\n>>>   3:   - Previously, the ``ansible_managed`` var was being\n      4:     used to insert a header into the ``swift.conf`` that\n      5:     contained date/time information. This meant that\n      6:     swift.conf across different nodes did not have the\n      7:     same MD5SUM, causing ``swift-recon --md5`` to break.\n      8:     We now insert a piece of static text instead to\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
