{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-felisialoukou.pp", "content": "ssh_key  => [", "line": 5, "detection_span": [3, 7], "with_context": "# File: alphagov@govuk-puppet-modules-users-manifests-felisialoukou.pp\n# Target line: 5\n\n      1: # Creates the felisialoukou user\n      2: class users::felisialoukou { govuk_user { 'felisialoukou':\n      3:     fullname => 'Felisia Loukou',\n      4:     email    => 'felisia.loukou@digital.cabinet-office.gov.uk',\n>>>   5:     ssh_key  => [\n      6:         'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlxJNWiWOVbtSwe5DNNzN8csunIvCX6XUIAT141EjGZpOaEjK3yFtvv96OukdWTXPQXnWBDOIWg+fNJWc4LsfqnCV5CrHftykTqHeKakEcVX2aW5UrWvlOWHoTdkbFv+L67MaT2xIT/KWLYPliyZJOmwwF+W1kiFq3xVtI5qgMha7s2I3thuBo8lgLXsmxdVcYoa32MBKabNyknvZaF/l2l/D/wssbC/3N5zeLupJJXDRA4BWw6nqAW97AOceVH04twCG6+B5qL/M56D/YW8kMIx/XSSIAde4+yXCX0gLr5p4L6pNvD2vn/nJSY/rMDtO5rPX+XQjmM7eti50FvkflvGzuaUoSXb1sP+rwOtGMVQBn4pnB1whd8jZSQC+SRsXAgj7TgQfKLux/T00cq+pC09HrBPLag1TUcueJE65FM6mi2uyi+sYYOnVfr4ZhgiEBY+uFoOWl/TwnKuIAXXXD4aL9BXpOTdy3XxxEwHeobfv2AOa8QH8rGQXuXExTjaMXQEbQ6rnhUEmccu1fSTZt4rEUlv2a61Bp2XKcjvKNodNHqQwFXWbX+qmKpGTurPQZG9wqJzejUer1YYSuraxezQtSpM0ZREFhIQMSA5F137bCPVwLanJ3A/XN+1aEwjynrDALOmYOyJw/eblYCUX84At55tbDt+XdmIXiVeg0eQ== felisia.loukou@digital.cabinet-office.gov.uk',\n      7:     ],\n      8:   }\n      9: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-users-manifests-felisialoukou.pp\n# Target line: 5\n\n      1: # Creates the felisialoukou user\n      2: class users::felisialoukou { govuk_user { 'felisialoukou':\n      3:     fullname => 'Felisia Loukou',\n      4:     email    => 'felisia.loukou@digital.cabinet-office.gov.uk',\n>>>   5:     ssh_key  => [\n      6:         'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlxJNWiWOVbtSwe5DNNzN8csunIvCX6XUIAT141EjGZpOaEjK3yFtvv96OukdWTXPQXnWBDOIWg+fNJWc4LsfqnCV5CrHftykTqHeKakEcVX2aW5UrWvlOWHoTdkbFv+L67MaT2xIT/KWLYPliyZJOmwwF+W1kiFq3xVtI5qgMha7s2I3thuBo8lgLXsmxdVcYoa32MBKabNyknvZaF/l2l/D/wssbC/3N5zeLupJJXDRA4BWw6nqAW97AOceVH04twCG6+B5qL/M56D/YW8kMIx/XSSIAde4+yXCX0gLr5p4L6pNvD2vn/nJSY/rMDtO5rPX+XQjmM7eti50FvkflvGzuaUoSXb1sP+rwOtGMVQBn4pnB1whd8jZSQC+SRsXAgj7TgQfKLux/T00cq+pC09HrBPLag1TUcueJE65FM6mi2uyi+sYYOnVfr4ZhgiEBY+uFoOWl/TwnKuIAXXXD4aL9BXpOTdy3XxxEwHeobfv2AOa8QH8rGQXuXExTjaMXQEbQ6rnhUEmccu1fSTZt4rEUlv2a61Bp2XKcjvKNodNHqQwFXWbX+qmKpGTurPQZG9wqJzejUer1YYSuraxezQtSpM0ZREFhIQMSA5F137bCPVwLanJ3A/XN+1aEwjynrDALOmYOyJw/eblYCUX84At55tbDt+XdmIXiVeg0eQ== felisia.loukou@digital.cabinet-office.gov.uk',\n      7:     ],\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp", "content": "root_password => 'strongpassword',", "line": 9, "detection_span": [7, 11], "with_context": "# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 9\n\n      4: \n      5:   include ::java\n      6:   include ::git\n      7: \n      8:   class { '::mysql::server':\n>>>   9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n     14:     password => 'password',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 9\n\n      4: \n      5:   include ::java\n      6:   include ::git\n      7: \n      8:   class { '::mysql::server':\n>>>   9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n     14:     password => 'password',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp", "content": "user     => 'bitbucket',", "line": 13, "detection_span": [11, 15], "with_context": "# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 13\n\n      8:   class { '::mysql::server':\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n>>>  13:     user     => 'bitbucket',\n     14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 13\n\n      8:   class { '::mysql::server':\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n>>>  13:     user     => 'bitbucket',\n     14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp", "content": "password => 'password',", "line": 14, "detection_span": [12, 16], "with_context": "# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 14\n\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n>>>  14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: \n     19:   class { '::bitbucket':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 14\n\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n>>>  14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: \n     19:   class { '::bitbucket':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "password => 'an_even_bigger_secret',", "line": 11, "detection_span": [9, 13], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 11\n\n      6:   include ::openstack_integration::config\n      7:   include ::openstack_integration::params\n      8:   include ::openstack_integration::bind\n      9: \n     10:   openstack_integration::mq_user { 'designate':\n>>>  11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n     16:     password => 'designate',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 11\n\n      6:   include ::openstack_integration::config\n      7:   include ::openstack_integration::params\n      8:   include ::openstack_integration::bind\n      9: \n     10:   openstack_integration::mq_user { 'designate':\n>>>  11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n     16:     password => 'designate',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "password => 'designate',", "line": 16, "detection_span": [14, 18], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 16\n\n     11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n>>>  16:     password => 'designate',\n     17:   }\n     18:   class { '::designate::logging':\n     19:     debug => true,\n     20:   }\n     21:   class { '::designate':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 16\n\n     11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n>>>  16:     password => 'designate',\n     17:   }\n     18:   class { '::designate::logging':\n     19:     debug => true,\n     20:   }\n     21:   class { '::designate':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "password     => 'a_big_secret',", "line": 39, "detection_span": [37, 41], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 39\n\n     34: \n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n>>>  39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 39\n\n     34: \n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n>>>  39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-rabbitmq-examples-permissions-add.pp", "content": "password => 'foo',", "line": 2, "detection_span": [0, 4], "with_context": "# File: voxpupuli@puppet-rabbitmq-examples-permissions-add.pp\n# Target line: 2\n\n      1: rabbitmq_user { 'blah7':\n>>>   2:   password => 'foo',\n      3: }\n      4: rabbitmq_vhost { 'test5': }\n      5: rabbitmq_user_permissions { 'blah7@test5':\n      6:   configure_permission => 'config2',\n      7:   read_permission      => 'ready',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-rabbitmq-examples-permissions-add.pp\n# Target line: 2\n\n      1: rabbitmq_user { 'blah7':\n>>>   2:   password => 'foo',\n      3: }\n      4: rabbitmq_vhost { 'test5': }\n      5: rabbitmq_user_permissions { 'blah7@test5':\n      6:   configure_permission => 'config2',\n      7:   read_permission      => 'ready',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "Automattic@vip-quickstart-puppet-manifests-sections-mail.pp", "content": "user    => root,", "line": 7, "detection_span": [5, 9], "with_context": "# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 7\n\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',\n>>>   7:     user    => root,\n      8:     notify  => Service['postfix']\n      9: }\n     10: \n     11: # Mailtuils for sending diagnostic reports\n     12: package { 'mailutils': ensure => installed }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 7\n\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',\n>>>   7:     user    => root,\n      8:     notify  => Service['postfix']\n      9: }\n     10: \n     11: # Mailtuils for sending diagnostic reports\n     12: package { 'mailutils': ensure => installed }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp", "content": "key => 'bind',", "line": 166, "detection_span": [164, 168], "with_context": "# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 166\n\n    161:       'DEFAULTS/collectors'         : value => $collector_ip_port_list;\n    162:       'API_SERVER/api_server_list'  : value => $api_server_list;\n    163:     } ->\n    164: \n    165:     contrail::lib::augeas_conf_rm { \"remove_bind\":\n>>> 166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n    171:                 key => 'save',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 166\n\n    161:       'DEFAULTS/collectors'         : value => $collector_ip_port_list;\n    162:       'API_SERVER/api_server_list'  : value => $api_server_list;\n    163:     } ->\n    164: \n    165:     contrail::lib::augeas_conf_rm { \"remove_bind\":\n>>> 166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n    171:                 key => 'save',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp", "content": "key => 'save',", "line": 171, "detection_span": [169, 173], "with_context": "# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 171\n\n    166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n>>> 171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n    176:                 key => 'dbfilename',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 171\n\n    166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n>>> 171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n    176:                 key => 'dbfilename',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp", "content": "key => 'dbfilename',", "line": 176, "detection_span": [174, 178], "with_context": "# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 176\n\n    171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n>>> 176:                 key => 'dbfilename',\n    177:                 config_file => $redis_config_file,\n    178:                 lens_to_use => $redis_augeas_lens_to_use,\n    179:     } ->\n    180: \n    181:     file { '/etc/snmp':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 176\n\n    171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n>>> 176:                 key => 'dbfilename',\n    177:                 config_file => $redis_config_file,\n    178:                 lens_to_use => $redis_augeas_lens_to_use,\n    179:     } ->\n    180: \n    181:     file { '/etc/snmp':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp", "content": "$backupuser         = '',", "line": 3, "detection_span": [1, 5], "with_context": "# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 3\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n>>>   3:   $backupuser         = '',\n      4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 3\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n>>>   3:   $backupuser         = '',\n      4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp", "content": "$backuppassword     = '',", "line": 4, "detection_span": [2, 6], "with_context": "# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 4\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n      3:   $backupuser         = '',\n>>>   4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',\n      9:   $backupdirgroup     = $mysql::params::root_group,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 4\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n      3:   $backupuser         = '',\n>>>   4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',\n      9:   $backupdirgroup     = $mysql::params::root_group,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp", "content": "user    => 'root',", "line": 32, "detection_span": [30, 34], "with_context": "# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 32\n\n     27:   }\n     28: \n     29:   cron { 'xtrabackup-weekly':\n     30:     ensure  => $ensure,\n     31:     command => \"/usr/local/sbin/xtrabackup.sh ${backupdir}\",\n>>>  32:     user    => 'root',\n     33:     hour    => $time[0],\n     34:     minute  => $time[1],\n     35:     weekday => '0',\n     36:     require => Package['percona-xtrabackup'],\n     37:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 32\n\n     27:   }\n     28: \n     29:   cron { 'xtrabackup-weekly':\n     30:     ensure  => $ensure,\n     31:     command => \"/usr/local/sbin/xtrabackup.sh ${backupdir}\",\n>>>  32:     user    => 'root',\n     33:     hour    => $time[0],\n     34:     minute  => $time[1],\n     35:     weekday => '0',\n     36:     require => Package['percona-xtrabackup'],\n     37:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "/^(6|7)\\..*/: { $seluser = 'unconfined_u' }", "line": 67, "detection_span": [65, 69], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 67\n\n     62:   # Redhat 7 selinux user context for /etc/sysconfig/iptables is set to unconfined_u\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n>>>  67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 67\n\n     62:   # Redhat 7 selinux user context for /etc/sysconfig/iptables is set to unconfined_u\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n>>>  67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "default: { $seluser = 'system_u' }", "line": 68, "detection_span": [66, 70], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 68\n\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n>>>  68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }\n     73:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 68\n\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n>>>  68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }\n     73:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "default:     { $seluser = undef }", "line": 72, "detection_span": [70, 74], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 72\n\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n>>>  72:     default:     { $seluser = undef }\n     73:   }\n     74: \n     75:   file { \"/etc/sysconfig/${service_name}\":\n     76:     ensure  => present,\n     77:     owner   => 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 72\n\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n>>>  72:     default:     { $seluser = undef }\n     73:   }\n     74: \n     75:   file { \"/etc/sysconfig/${service_name}\":\n     76:     ensure  => present,\n     77:     owner   => 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-apt-manifests-backports.pp", "content": "key_server => 'pgp.mit.edu',", "line": 45, "detection_span": [43, 47], "with_context": "# File: Vizir@carnival-vagrant-modules-apt-manifests-backports.pp\n# Target line: 45\n\n     40:   apt::source { 'backports':\n     41:     location   => $location,\n     42:     release    => \"${release_real}-backports\",\n     43:     repos      => $repos,\n     44:     key        => $key,\n>>>  45:     key_server => 'pgp.mit.edu',\n     46:     pin        => '200',\n     47:   }\n     48: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Vizir@carnival-vagrant-modules-apt-manifests-backports.pp\n# Target line: 45\n\n     40:   apt::source { 'backports':\n     41:     location   => $location,\n     42:     release    => \"${release_real}-backports\",\n     43:     repos      => $repos,\n     44:     key        => $key,\n>>>  45:     key_server => 'pgp.mit.edu',\n     46:     pin        => '200',\n     47:   }\n     48: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_elasticsearch-manifests-dump.pp", "content": "user    => 'elasticsearch',", "line": 31, "detection_span": [29, 33], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_elasticsearch-manifests-dump.pp\n# Target line: 31\n\n     26:     mode   => '0755',\n     27:   }\n     28: \n     29:   cron { 'dump-elasticsearch-indexes':\n     30:     command => '/usr/bin/es_dump http://localhost:9200 /var/es_dump',\n>>>  31:     user    => 'elasticsearch',\n     32:     require => [\n     33:       File['/var/es_dump'],\n     34:       File['/usr/bin/es_dump'],\n     35:     ],\n     36:     hour    => $run_es_dump_hour,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_elasticsearch-manifests-dump.pp\n# Target line: 31\n\n     26:     mode   => '0755',\n     27:   }\n     28: \n     29:   cron { 'dump-elasticsearch-indexes':\n     30:     command => '/usr/bin/es_dump http://localhost:9200 /var/es_dump',\n>>>  31:     user    => 'elasticsearch',\n     32:     require => [\n     33:       File['/var/es_dump'],\n     34:       File['/usr/bin/es_dump'],\n     35:     ],\n     36:     hour    => $run_es_dump_hour,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-scrape_icinga_alerts_for_dashboard_metrics.pp", "content": "$slack_auth_token = undef,", "line": 34, "detection_span": [32, 36], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-scrape_icinga_alerts_for_dashboard_metrics.pp\n# Target line: 34\n\n     29:   $private_key = undef,\n     30:   $client_email = undef,\n     31:   $client_id = undef,\n     32:   $client_x509_cert_url = undef,\n     33:   $enable_slack_notifications = true,\n>>>  34:   $slack_auth_token = undef,\n     35:   $run_monthly = false,\n     36:   $app_domain = hiera('app_domain'),\n     37: ) {\n     38: \n     39:   $slack_team_domain = 'gds'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-scrape_icinga_alerts_for_dashboard_metrics.pp\n# Target line: 34\n\n     29:   $private_key = undef,\n     30:   $client_email = undef,\n     31:   $client_id = undef,\n     32:   $client_x509_cert_url = undef,\n     33:   $enable_slack_notifications = true,\n>>>  34:   $slack_auth_token = undef,\n     35:   $run_monthly = false,\n     36:   $app_domain = hiera('app_domain'),\n     37: ) {\n     38: \n     39:   $slack_team_domain = 'gds'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_mysql-manifests-server.pp", "content": "$root_password=undef,", "line": 48, "detection_span": [46, 50], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_mysql-manifests-server.pp\n# Target line: 48\n\n     43: #\n     44: # [*innodb_buffer_pool_size_proportion*]\n     45: #   The proportion of machine memory used by the innodb buffer.\n     46: #\n     47: class govuk_mysql::server (\n>>>  48:   $root_password=undef,\n     49:   $tmp_table_size='128M',\n     50:   $max_heap_table_size='128M',\n     51:   $innodb_file_per_table=true,\n     52:   $key_buffer_size='16M',\n     53:   $query_cache_limit='1M',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_mysql-manifests-server.pp\n# Target line: 48\n\n     43: #\n     44: # [*innodb_buffer_pool_size_proportion*]\n     45: #   The proportion of machine memory used by the innodb buffer.\n     46: #\n     47: class govuk_mysql::server (\n>>>  48:   $root_password=undef,\n     49:   $tmp_table_size='128M',\n     50:   $max_heap_table_size='128M',\n     51:   $innodb_file_per_table=true,\n     52:   $key_buffer_size='16M',\n     53:   $query_cache_limit='1M',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp", "content": "superuser     => true,", "line": 14, "detection_span": [12, 16], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 14\n\n      9: #\n     10: class govuk_postgresql::env_sync_user (\n     11:   $password\n     12: ) {\n     13:   @postgresql::server::role { 'env-sync':\n>>>  14:     superuser     => true,\n     15:     password_hash => postgresql_password('env-sync', $password),\n     16:     tag           => 'govuk_postgresql::server::not_slave',\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 14\n\n      9: #\n     10: class govuk_postgresql::env_sync_user (\n     11:   $password\n     12: ) {\n     13:   @postgresql::server::role { 'env-sync':\n>>>  14:     superuser     => true,\n     15:     password_hash => postgresql_password('env-sync', $password),\n     16:     tag           => 'govuk_postgresql::server::not_slave',\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp", "content": "user        => 'env-sync',", "line": 22, "detection_span": [20, 24], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 22\n\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n>>>  22:     user        => 'env-sync',\n     23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 22\n\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n>>>  22:     user        => 'env-sync',\n     23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp", "content": "key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',", "line": 21, "detection_span": [19, 23], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 21\n\n     16: \n     17:   apt::source { 'rbenv-ruby':\n     18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n>>>  21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: \n     24:   $ruby_versions = [\n     25:     '2.4.4',\n     26:     '2.4.5',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 21\n\n     16: \n     17:   apt::source { 'rbenv-ruby':\n     18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n>>>  21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: \n     24:   $ruby_versions = [\n     25:     '2.4.4',\n     26:     '2.4.5',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-mysql-manifests-server-instance.pp", "content": "define mysql::server::instance ($root_password = '', $debian_sys_maint_password = '') {", "line": 1, "detection_span": [-1, 3], "with_context": "# File: cargomedia@puppet-packages-modules-mysql-manifests-server-instance.pp\n# Target line: 1\n\n>>>   1: define mysql::server::instance ($root_password = '', $debian_sys_maint_password = '') {\n      2: \n      3:   class { 'mysql::server':\n      4:     root_password             => $root_password,\n      5:     debian_sys_maint_password => $debian_sys_maint_password,\n      6:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: cargomedia@puppet-packages-modules-mysql-manifests-server-instance.pp\n# Target line: 1\n\n>>>   1: define mysql::server::instance ($root_password = '', $debian_sys_maint_password = '') {\n      2: \n      3:   class { 'mysql::server':\n      4:     root_password             => $root_password,\n      5:     debian_sys_maint_password => $debian_sys_maint_password,\n      6:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$nexus_root                    = '/srv'", "line": 29, "detection_span": [27, 31], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 29\n\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n     28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n>>>  29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n     34:   $nexus_user                    = 'nexus'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 29\n\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n     28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n>>>  29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n     34:   $nexus_user                    = 'nexus'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$nexus_user                    = 'nexus'", "line": 34, "detection_span": [32, 36], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 34\n\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n>>>  34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 34\n\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n>>>  34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$nexus_manage_user             = true", "line": 39, "detection_span": [37, 41], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 39\n\n     34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n>>>  39:   $nexus_manage_user             = true\n     40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 39\n\n     34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n>>>  39:   $nexus_manage_user             = true\n     40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$mysql_root_user     = pick($mysql_hash['root_user'], 'root')", "line": 9, "detection_span": [7, 11], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 9\n\n      4: \n      5:   $ironic_hash    = hiera_hash('ironic', {})\n      6:   $mysql_hash     = hiera_hash('mysql', {})\n      7:   $database_vip   = hiera('database_vip')\n      8: \n>>>   9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 9\n\n      4: \n      5:   $ironic_hash    = hiera_hash('ironic', {})\n      6:   $mysql_hash     = hiera_hash('mysql', {})\n      7:   $database_vip   = hiera('database_vip')\n      8: \n>>>   9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_user     = pick($ironic_hash['db_user'], 'ironic')", "line": 13, "detection_span": [11, 15], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 13\n\n      8: \n      9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n>>>  13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 13\n\n      8: \n      9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n>>>  13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_password = pick($ironic_hash['db_password'], $mysql_root_password)", "line": 15, "detection_span": [13, 17], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 15\n\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n>>>  15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 15\n\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n>>>  15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)", "line": 19, "detection_span": [17, 21], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 19\n\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n>>>  19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 19\n\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n>>>  19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)", "line": 20, "detection_span": [18, 22], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 20\n\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n>>>  20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)\n     25:   validate_string($database_vip)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 20\n\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n>>>  20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)\n     25:   validate_string($database_vip)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp", "content": "$permit_root    = undef,", "line": 40, "detection_span": [38, 42], "with_context": "# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 40\n\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n>>>  40:   $permit_root    = undef,\n     41:   $listen_address = [],\n     42:   $accept_env     = 'LANG LC_*',\n     43: ){\n     44: \n     45:   case $::osfamily {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 40\n\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n>>>  40:   $permit_root    = undef,\n     41:   $listen_address = [],\n     42:   $accept_env     = 'LANG LC_*',\n     43: ){\n     44: \n     45:   case $::osfamily {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-server-placement.pp", "content": "$username            = 'nova',", "line": 71, "detection_span": [69, 73], "with_context": "# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 71\n\n     66: #\n     67: \n     68: class neutron::server::placement (\n     69:   $password,\n     70:   $auth_type           = 'password',\n>>>  71:   $username            = 'nova',\n     72:   $project_domain_id   = 'default',\n     73:   $project_domain_name = 'Default',\n     74:   $project_name        = 'services',\n     75:   $user_domain_id      = 'default',\n     76:   $user_domain_name    = 'Default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 71\n\n     66: #\n     67: \n     68: class neutron::server::placement (\n     69:   $password,\n     70:   $auth_type           = 'password',\n>>>  71:   $username            = 'nova',\n     72:   $project_domain_id   = 'default',\n     73:   $project_domain_name = 'Default',\n     74:   $project_name        = 'services',\n     75:   $user_domain_id      = 'default',\n     76:   $user_domain_name    = 'Default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-server-placement.pp", "content": "'placement/password':            value => $password, secret => true;", "line": 87, "detection_span": [85, 89], "with_context": "# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 87\n\n     82:   include ::neutron::deps\n     83: \n     84:   neutron_config {\n     85:     'placement/auth_url':            value => $auth_url;\n     86:     'placement/username':            value => $username;\n>>>  87:     'placement/password':            value => $password, secret => true;\n     88:     'placement/project_domain_id':   value => $project_domain_id;\n     89:     'placement/project_domain_name': value => $project_domain_name;\n     90:     'placement/project_name':        value => $project_name;\n     91:     'placement/user_domain_id':      value => $user_domain_id;\n     92:     'placement/user_domain_name':    value => $user_domain_name;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 87\n\n     82:   include ::neutron::deps\n     83: \n     84:   neutron_config {\n     85:     'placement/auth_url':            value => $auth_url;\n     86:     'placement/username':            value => $username;\n>>>  87:     'placement/password':            value => $password, secret => true;\n     88:     'placement/project_domain_id':   value => $project_domain_id;\n     89:     'placement/project_domain_name': value => $project_domain_name;\n     90:     'placement/project_name':        value => $project_name;\n     91:     'placement/user_domain_id':      value => $user_domain_id;\n     92:     'placement/user_domain_name':    value => $user_domain_name;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "enable_api_admin => true", "line": 58, "detection_span": [56, 60], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 58\n\n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n     55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n>>>  58:     enable_api_admin => true\n     59:   }\n     60: \n     61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 58\n\n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n     55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n>>>  58:     enable_api_admin => true\n     59:   }\n     60: \n     61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "puphpet@puppet-puphpet-manifests-nginx-params.pp", "content": "$webroot_user  = 'www-data'", "line": 5, "detection_span": [3, 7], "with_context": "# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 5\n\n      1: class puphpet::nginx::params\n      2:   inherits ::puphpet::params\n      3: {\n      4: \n>>>   5:   $webroot_user  = 'www-data'\n      6:   $webroot_group = 'www-data'\n      7: \n      8:   $www_location     = '/var/www'\n      9:   $webroot_location = '/var/www/html'\n     10: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 5\n\n      1: class puphpet::nginx::params\n      2:   inherits ::puphpet::params\n      3: {\n      4: \n>>>   5:   $webroot_user  = 'www-data'\n      6:   $webroot_group = 'www-data'\n      7: \n      8:   $www_location     = '/var/www'\n      9:   $webroot_location = '/var/www/html'\n     10: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "$password = '',\t# global vrrp password to use", "line": 26, "detection_span": [24, 28], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 26\n\n     21: \t$replica = 1,\n     22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n>>>  26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',\n     28: \t$repo = true,\n     29: \t$count = 0,\t# 0 means build 1 brick, unless $brick_params exists...\n     30: \t$brick_params = {},\t# this sets the brick count when $count is 0...\n     31: \t$brick_param_defaults = {},\t# these always get used to build bricks", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 26\n\n     21: \t$replica = 1,\n     22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n>>>  26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',\n     28: \t$repo = true,\n     29: \t$count = 0,\t# 0 means build 1 brick, unless $brick_params exists...\n     30: \t$brick_params = {},\t# this sets the brick count when $count is 0...\n     31: \t$brick_param_defaults = {},\t# these always get used to build bricks\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-recovery_message.pp", "content": "user        => root", "line": 22, "detection_span": [20, 24], "with_context": "# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 22\n\n     17:   # Otherwise you will need to touch $kextdir to generate it.\n     18:   exec { 'Refresh system kext cache':\n     19:       command     => \"/usr/bin/touch ${kextdir}\",\n     20:       creates     => $eficachedir,\n     21:       refreshonly => true,\n>>>  22:       user        => root\n     23:   }\n     24: \n     25:   exec { 'Refresh CoreStorage EFI Cache':\n     26:       command     => \"/usr/bin/touch ${eficachedir}\",\n     27:       onlyif      => \"test -d ${eficachedir}\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 22\n\n     17:   # Otherwise you will need to touch $kextdir to generate it.\n     18:   exec { 'Refresh system kext cache':\n     19:       command     => \"/usr/bin/touch ${kextdir}\",\n     20:       creates     => $eficachedir,\n     21:       refreshonly => true,\n>>>  22:       user        => root\n     23:   }\n     24: \n     25:   exec { 'Refresh CoreStorage EFI Cache':\n     26:       command     => \"/usr/bin/touch ${eficachedir}\",\n     27:       onlyif      => \"test -d ${eficachedir}\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-recovery_message.pp", "content": "key    => 'LoginwindowText',", "line": 37, "detection_span": [35, 39], "with_context": "# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 37\n\n     32:   if $ensure == 'present' {\n     33:     if $value != undef {\n     34:       property_list_key { 'Set OS X Recovery Message':\n     35:         ensure => present,\n     36:         path   => '/Library/Preferences/com.apple.loginwindow.plist',\n>>>  37:         key    => 'LoginwindowText',\n     38:         value  => $value,\n     39:         notify => [\n     40:           Exec['Refresh system kext cache'],\n     41:           Exec['Refresh CoreStorage EFI Cache']\n     42:         ]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 37\n\n     32:   if $ensure == 'present' {\n     33:     if $value != undef {\n     34:       property_list_key { 'Set OS X Recovery Message':\n     35:         ensure => present,\n     36:         path   => '/Library/Preferences/com.apple.loginwindow.plist',\n>>>  37:         key    => 'LoginwindowText',\n     38:         value  => $value,\n     39:         notify => [\n     40:           Exec['Refresh system kext cache'],\n     41:           Exec['Refresh CoreStorage EFI Cache']\n     42:         ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "redhat-openstack@puppet-galera-manifests-server.pp", "content": "$wsrep_sst_username    = 'root',", "line": 98, "detection_span": [96, 100], "with_context": "# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 98\n\n     93:   $wsrep_node_address    = undef,\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n>>>  98:   $wsrep_sst_username    = 'root',\n     99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 98\n\n     93:   $wsrep_node_address    = undef,\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n>>>  98:   $wsrep_sst_username    = 'root',\n     99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "redhat-openstack@puppet-galera-manifests-server.pp", "content": "$wsrep_sst_password    = undef,", "line": 99, "detection_span": [97, 101], "with_context": "# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 99\n\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n     98:   $wsrep_sst_username    = 'root',\n>>>  99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,\n    104:   # DEPRECATED OPTIONS", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 99\n\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n     98:   $wsrep_sst_username    = 'root',\n>>>  99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,\n    104:   # DEPRECATED OPTIONS\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "www_root        => '/var/www/nginx-default',", "line": 5, "detection_span": [3, 7], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 5\n\n      1: include nginx\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n>>>   5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 5\n\n      1: include nginx\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n>>>   5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',", "line": 7, "detection_span": [5, 9], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 7\n\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n>>>   7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 7\n\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n>>>   7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',", "line": 8, "detection_span": [6, 10], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 8\n\n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 8\n\n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',", "line": 9, "detection_span": [7, 11], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 9\n\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,\n     14:   www_root => '/var/www/nginx-default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 9\n\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,\n     14:   www_root => '/var/www/nginx-default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "www_root => '/var/www/bob',", "line": 22, "detection_span": [20, 24], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 22\n\n     17:   ssl_key  => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     18: }\n     19: \n     20: nginx::resource::location { 'test2.local-bob':\n     21:   ensure   => present,\n>>>  22:   www_root => '/var/www/bob',\n     23:   location => '/bob',\n     24:   server   => 'test2.local test2',\n     25: }\n     26: \n     27: nginx::resource::location { 'test3.local-bob':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 22\n\n     17:   ssl_key  => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     18: }\n     19: \n     20: nginx::resource::location { 'test2.local-bob':\n     21:   ensure   => present,\n>>>  22:   www_root => '/var/www/bob',\n     23:   location => '/bob',\n     24:   server   => 'test2.local test2',\n     25: }\n     26: \n     27: nginx::resource::location { 'test3.local-bob':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-rabbitmq-examples-server.pp", "content": "delete_guest_user => true,", "line": 3, "detection_span": [1, 5], "with_context": "# File: voxpupuli@puppet-rabbitmq-examples-server.pp\n# Target line: 3\n\n      1: class { 'rabbitmq::server':\n      2:   port              => '5672',\n>>>   3:   delete_guest_user => true,\n      4:   version           => 'latest',\n      5: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-rabbitmq-examples-server.pp\n# Target line: 3\n\n      1: class { 'rabbitmq::server':\n      2:   port              => '5672',\n>>>   3:   delete_guest_user => true,\n      4:   version           => 'latest',\n      5: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_calculators_frontend.pp", "content": "# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc", "line": 1, "detection_span": [-1, 3], "with_context": "# File: alphagov@govuk-puppet-modules-govuk-manifests-node-s_calculators_frontend.pp\n# Target line: 1\n\n>>>   1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::node::s_calculators_frontend inherits govuk::node::s_base {\n      3:   include govuk::node::s_app_server\n      4: \n      5:   include govuk_aws_xray_daemon\n      6: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk-manifests-node-s_calculators_frontend.pp\n# Target line: 1\n\n>>>   1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::node::s_calculators_frontend inherits govuk::node::s_base {\n      3:   include govuk::node::s_app_server\n      4: \n      5:   include govuk_aws_xray_daemon\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "# TODO: Support SSL", "line": 37, "detection_span": [35, 39], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 37\n\n     32:     database_connection => 'mysql+pymysql://designate:designate@127.0.0.1/designate?charset=utf8'\n     33:   }\n     34: \n     35:   include '::designate::client'\n     36: \n>>>  37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 37\n\n     32:     database_connection => 'mysql+pymysql://designate:designate@127.0.0.1/designate?charset=utf8'\n     33:   }\n     34: \n     35:   include '::designate::client'\n     36: \n>>>  37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "# TODO: Implement pools.yaml management in puppet-designate", "line": 100, "detection_span": [98, 102], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 100\n\n     95:     timeout     => '15',\n     96:     refreshonly => true,\n     97:     subscribe   => Anchor['designate::service::end'],\n     98:   }\n     99: \n>>> 100:   # TODO: Implement pools.yaml management in puppet-designate\n    101:   file { '/etc/designate/pools.yaml':\n    102:     ensure  => present,\n    103:     content => template(\"${module_name}/pools.yaml.erb\"),\n    104:     require => Service['designate-central'],\n    105:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 100\n\n     95:     timeout     => '15',\n     96:     refreshonly => true,\n     97:     subscribe   => Anchor['designate::service::end'],\n     98:   }\n     99: \n>>> 100:   # TODO: Implement pools.yaml management in puppet-designate\n    101:   file { '/etc/designate/pools.yaml':\n    102:     ensure  => present,\n    103:     content => template(\"${module_name}/pools.yaml.erb\"),\n    104:     require => Service['designate-central'],\n    105:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster", "line": 22, "detection_span": [20, 24], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 22\n\n     17: \n     18: class gluster::simple(\n     19: \t$path = '',\n     20: \t$volume = 'puppet',\t# NOTE: this can be a list...\n     21: \t$replica = 1,\n>>>  22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n     26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 22\n\n     17: \n     18: class gluster::simple(\n     19: \t$path = '',\n     20: \t$volume = 'puppet',\t# NOTE: this can be a list...\n     21: \t$replica = 1,\n>>>  22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n     26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# TODO: check that each element of array is a valid hash!", "line": 81, "detection_span": [79, 83], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 81\n\n     76: \t$valid_brick_param_defaults = merge($areyousure, $againhash, $brick_param_defaults)\n     77: \n     78: \t# if this is an array, then each element is the default for each brick!\n     79: \t# if this is an array, then the number of elements is the brick count!!\n     80: \tvalidate_array($brick_params_defaults)\n>>>  81: \t# TODO: check that each element of array is a valid hash!\n     82: \t$valid_brick_params_defaults = $brick_params_defaults\n     83: \n     84: \tnotify { 'gluster::simple':\n     85: \t\tmessage => 'You are using gluster::simple !',\n     86: \t}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 81\n\n     76: \t$valid_brick_param_defaults = merge($areyousure, $againhash, $brick_param_defaults)\n     77: \n     78: \t# if this is an array, then each element is the default for each brick!\n     79: \t# if this is an array, then the number of elements is the brick count!!\n     80: \tvalidate_array($brick_params_defaults)\n>>>  81: \t# TODO: check that each element of array is a valid hash!\n     82: \t$valid_brick_params_defaults = $brick_params_defaults\n     83: \n     84: \tnotify { 'gluster::simple':\n     85: \t\tmessage => 'You are using gluster::simple !',\n     86: \t}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# TODO: should we use the same pattern for 1 or many ?", "line": 145, "detection_span": [143, 147], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 145\n\n    140: \t\t},\n    141: \t\tdefault => $count,\n    142: \t}\n    143: \n    144: \t$brick_params_names = \"${valid_count}\" ? {\n>>> 145: \t\t# TODO: should we use the same pattern for 1 or many ?\n    146: \t\t'1' => [\"${::fqdn}:${valid_path}\"],\n    147: \t\tdefault => split(inline_template(\"<%= (1..@valid_count.to_i).collect{|i| '${::fqdn}:${valid_path}brick' + i.to_s.rjust(7, '0') + '/' }.join(',') %>\"), ','),\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 145\n\n    140: \t\t},\n    141: \t\tdefault => $count,\n    142: \t}\n    143: \n    144: \t$brick_params_names = \"${valid_count}\" ? {\n>>> 145: \t\t# TODO: should we use the same pattern for 1 or many ?\n    146: \t\t'1' => [\"${::fqdn}:${valid_path}\"],\n    147: \t\tdefault => split(inline_template(\"<%= (1..@valid_count.to_i).collect{|i| '${::fqdn}:${valid_path}brick' + i.to_s.rjust(7, '0') + '/' }.join(',') %>\"), ','),\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "Automattic@vip-quickstart-puppet-manifests-sections-mail.pp", "content": "# Postfix", "line": 1, "detection_span": [-1, 3], "with_context": "# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 1\n\n>>>   1: # Postfix\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 1\n\n>>>   1: # Postfix\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "# RHEL 7 and later and Fedora 15 and later require the iptables-services", "line": 23, "detection_span": [21, 25], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 23\n\n     18:   $service_name   = $::firewall::params::service_name,\n     19:   $package_name   = $::firewall::params::package_name,\n     20:   $package_ensure = $::firewall::params::package_ensure,\n     21: ) inherits ::firewall::params {\n     22: \n>>>  23:   # RHEL 7 and later and Fedora 15 and later require the iptables-services\n     24:   # package, which provides the /usr/libexec/iptables/iptables.init used by\n     25:   # lib/puppet/util/firewall.rb.\n     26:   if ($::operatingsystem != 'Amazon')\n     27:   and (($::operatingsystem != 'Fedora' and versioncmp($::operatingsystemrelease, '7.0') >= 0)\n     28:   or  ($::operatingsystem == 'Fedora' and versioncmp($::operatingsystemrelease, '15') >= 0)) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 23\n\n     18:   $service_name   = $::firewall::params::service_name,\n     19:   $package_name   = $::firewall::params::package_name,\n     20:   $package_ensure = $::firewall::params::package_ensure,\n     21: ) inherits ::firewall::params {\n     22: \n>>>  23:   # RHEL 7 and later and Fedora 15 and later require the iptables-services\n     24:   # package, which provides the /usr/libexec/iptables/iptables.init used by\n     25:   # lib/puppet/util/firewall.rb.\n     26:   if ($::operatingsystem != 'Amazon')\n     27:   and (($::operatingsystem != 'Fedora' and versioncmp($::operatingsystemrelease, '7.0') >= 0)\n     28:   or  ($::operatingsystem == 'Fedora' and versioncmp($::operatingsystemrelease, '15') >= 0)) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp", "content": "# These aliases resolve .ruby-version 2.x to an installed Ruby version.", "line": 36, "detection_span": [34, 38], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 36\n\n     31: \n     32:   govuk_rbenv::install_ruby_version { $ruby_versions:\n     33:     with_foreman => $with_foreman,\n     34:   }\n     35: \n>>>  36:   # These aliases resolve .ruby-version 2.x to an installed Ruby version.\n     37:   rbenv::alias { '2.4':\n     38:     to_version => '2.4.5',\n     39:   }\n     40:   rbenv::alias { '2.5':\n     41:     to_version => '2.5.3',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 36\n\n     31: \n     32:   govuk_rbenv::install_ruby_version { $ruby_versions:\n     33:     with_foreman => $with_foreman,\n     34:   }\n     35: \n>>>  36:   # These aliases resolve .ruby-version 2.x to an installed Ruby version.\n     37:   rbenv::alias { '2.4':\n     38:     to_version => '2.4.5',\n     39:   }\n     40:   rbenv::alias { '2.5':\n     41:     to_version => '2.5.3',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-python-manifests-pip-couchdb.pp", "content": "# with the service/package couchdb! Hoping that one day we can properly solve", "line": 20, "detection_span": [18, 22], "with_context": "# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 20\n\n     15:     ['^RedHat$','^Debian$'],\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n>>>  20:   # with the service/package couchdb! Hoping that one day we can properly solve\n     21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 20\n\n     15:     ['^RedHat$','^Debian$'],\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n>>>  20:   # with the service/package couchdb! Hoping that one day we can properly solve\n     21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-python-manifests-pip-couchdb.pp", "content": "# this problem using e.g. composite name identifier", "line": 21, "detection_span": [19, 23], "with_context": "# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 21\n\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n     20:   # with the service/package couchdb! Hoping that one day we can properly solve\n>>>  21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }\n     26: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 21\n\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n     20:   # with the service/package couchdb! Hoping that one day we can properly solve\n>>>  21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }\n     26: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "mattheath@puppet-php-manifests-version.pp", "content": "# Fix permissions for php versions installed prior to 0.3.5 of this module", "line": 122, "detection_span": [120, 124], "with_context": "# File: mattheath@puppet-php-manifests-version.pp\n# Target line: 122\n\n    117:         Package['boxen/brews/autoconf213'],\n    118:       ],\n    119:       notify        => Exec[\"phpenv-rehash-post-install-${version}\"],\n    120:     }\n    121: \n>>> 122:     # Fix permissions for php versions installed prior to 0.3.5 of this module\n    123:     file { $dest:\n    124:       ensure  => directory,\n    125:       owner   => $::boxen_user,\n    126:       group   => 'staff',\n    127:       recurse => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: mattheath@puppet-php-manifests-version.pp\n# Target line: 122\n\n    117:         Package['boxen/brews/autoconf213'],\n    118:       ],\n    119:       notify        => Exec[\"phpenv-rehash-post-install-${version}\"],\n    120:     }\n    121: \n>>> 122:     # Fix permissions for php versions installed prior to 0.3.5 of this module\n    123:     file { $dest:\n    124:       ensure  => directory,\n    125:       owner   => $::boxen_user,\n    126:       group   => 'staff',\n    127:       recurse => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-monasca-manifests-virtualenv-instance.pp", "content": "# and with different $venv_prefix options.  The monasca::agent class will allow", "line": 19, "detection_span": [17, 21], "with_context": "# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 19\n\n     14: #\n     15: # This module explicitly supports provisioning multiple virtualenv based\n     16: # installations in order to make upgrades and rollbacks easier.  To take\n     17: # advantage of this, you can define additional instances of\n     18: # monasca::virtualenv::instance type with the active flag set to false\n>>>  19: # and with different $venv_prefix options.  The monasca::agent class will allow\n     20: # configuring multiple virtualenvs via hiera.\n     21: #\n     22: # If using virtualenv based installations it's *strongly* recommended that\n     23: # virtualenvs be treated as immutable once created.  Behavior with changing\n     24: # requirements.txt or code may not be what you expect, since the existing", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 19\n\n     14: #\n     15: # This module explicitly supports provisioning multiple virtualenv based\n     16: # installations in order to make upgrades and rollbacks easier.  To take\n     17: # advantage of this, you can define additional instances of\n     18: # monasca::virtualenv::instance type with the active flag set to false\n>>>  19: # and with different $venv_prefix options.  The monasca::agent class will allow\n     20: # configuring multiple virtualenvs via hiera.\n     21: #\n     22: # If using virtualenv based installations it's *strongly* recommended that\n     23: # virtualenvs be treated as immutable once created.  Behavior with changing\n     24: # requirements.txt or code may not be what you expect, since the existing\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-monasca-manifests-virtualenv-instance.pp", "content": "# [*venv_prefix*] Prefix to give to virtualenv directories", "line": 42, "detection_span": [40, 44], "with_context": "# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 42\n\n     37: #\n     38: # [*basedir*] (required) Base directory for storing virtualenvs.\n     39: #\n     40: # [*symlink*] (required if venv_active is true) The path to link to the venv_dir\n     41: #\n>>>  42: # [*venv_prefix*] Prefix to give to virtualenv directories\n     43: # This can be specified to provide more meaningful names, or to have multiple\n     44: # virtualenvs installed at the same time. Defaults to $name\n     45: #\n     46: # [*venv_requirements*] (required) Python requirements.txt to pass to pip when\n     47: # populating the virtualenv.  Required if the instance is ensured to be present.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 42\n\n     37: #\n     38: # [*basedir*] (required) Base directory for storing virtualenvs.\n     39: #\n     40: # [*symlink*] (required if venv_active is true) The path to link to the venv_dir\n     41: #\n>>>  42: # [*venv_prefix*] Prefix to give to virtualenv directories\n     43: # This can be specified to provide more meaningful names, or to have multiple\n     44: # virtualenvs installed at the same time. Defaults to $name\n     45: #\n     46: # [*venv_requirements*] (required) Python requirements.txt to pass to pip when\n     47: # populating the virtualenv.  Required if the instance is ensured to be present.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "# IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396", "line": 61, "detection_span": [59, 63], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 61\n\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: \n>>>  61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'\n     64:   }\n     65: \n     66:   class { '::designate::central': }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 61\n\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: \n>>>  61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'\n     64:   }\n     65: \n     66:   class { '::designate::central': }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp", "content": "# [*debug*]", "line": 30, "detection_span": [28, 32], "with_context": "# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 30\n\n     25: #   Docker image name for dibbler.\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n>>>  30: # [*debug*]\n     31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 30\n\n     25: #   Docker image name for dibbler.\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n>>>  30: # [*debug*]\n     31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp", "content": "#   Enable debug messages for the wrapper script.", "line": 31, "detection_span": [29, 33], "with_context": "# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 31\n\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n     30: # [*debug*]\n>>>  31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #\n     36: define tripleo::profile::base::neutron::wrappers::dibbler_client (", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 31\n\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n     30: # [*debug*]\n>>>  31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #\n     36: define tripleo::profile::base::neutron::wrappers::dibbler_client (\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# (at your option) any later version.", "line": 8, "detection_span": [6, 10], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 8\n\n      3: # Written by James Shubin <james@shubin.ca>\n      4: #\n      5: # This program is free software: you can redistribute it and/or modify\n      6: # it under the terms of the GNU Affero General Public License as published by\n      7: # the Free Software Foundation, either version 3 of the License, or\n>>>   8: # (at your option) any later version.\n      9: #\n     10: # This program is distributed in the hope that it will be useful,\n     11: # but WITHOUT ANY WARRANTY; without even the implied warranty of\n     12: # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n     13: # GNU Affero General Public License for more details.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 8\n\n      3: # Written by James Shubin <james@shubin.ca>\n      4: #\n      5: # This program is free software: you can redistribute it and/or modify\n      6: # it under the terms of the GNU Affero General Public License as published by\n      7: # the Free Software Foundation, either version 3 of the License, or\n>>>   8: # (at your option) any later version.\n      9: #\n     10: # This program is distributed in the hope that it will be useful,\n     11: # but WITHOUT ANY WARRANTY; without even the implied warranty of\n     12: # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n     13: # GNU Affero General Public License for more details.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# readability. Puppet needs to fix this issue somehow! Creating", "line": 153, "detection_span": [151, 155], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 153\n\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)\n    151: \n    152: \t# NOTE: I've kept this template split as two comment chunks for\n>>> 153: \t# readability. Puppet needs to fix this issue somehow! Creating\n    154: \t# a separate template removes the logic from the code, but as a\n    155: \t# large inline template it's very hard to read/write the logic!\n    156: \t#DEFAULTS = (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {})\n    157: \t#$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => DEFAULTS.merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")\n    158: \t$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {}).merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 153\n\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)\n    151: \n    152: \t# NOTE: I've kept this template split as two comment chunks for\n>>> 153: \t# readability. Puppet needs to fix this issue somehow! Creating\n    154: \t# a separate template removes the logic from the code, but as a\n    155: \t# large inline template it's very hard to read/write the logic!\n    156: \t#DEFAULTS = (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {})\n    157: \t#$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => DEFAULTS.merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")\n    158: \t$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {}).merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp", "content": "auth_method => 'md5',", "line": 23, "detection_span": [21, 25], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 23\n\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n     22:     user        => 'env-sync',\n>>>  23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 23\n\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n     22:     user        => 'env-sync',\n>>>  23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp", "content": "$ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',", "line": 34, "detection_span": [32, 36], "with_context": "# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 34\n\n     29: #\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n>>>  34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 34\n\n     29: #\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n>>>  34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp", "content": "$macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',", "line": 35, "detection_span": [33, 37], "with_context": "# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 35\n\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n     34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n>>>  35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n     40:   $permit_root    = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 35\n\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n     34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n>>>  35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n     40:   $permit_root    = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "puphpet@puppet-puphpet-manifests-nginx-params.pp", "content": "$allowed_ciphers = [", "line": 25, "detection_span": [23, 27], "with_context": "# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 25\n\n     20:     'vhost_cfg_append'     => {'sendfile' => 'off'},\n     21:     'index_files'          => ['index.html', 'index.htm',],\n     22:     'locations'            => [ ]\n     23:   }\n     24: \n>>>  25:   $allowed_ciphers = [\n     26:     'ECDHE-RSA-AES256-GCM-SHA384', 'ECDHE-RSA-AES128-GCM-SHA256',\n     27:     'DHE-RSA-AES256-GCM-SHA384', 'DHE-RSA-AES128-GCM-SHA256',\n     28:     'ECDHE-RSA-AES256-SHA384', 'ECDHE-RSA-AES128-SHA256', 'ECDHE-RSA-AES256-SHA',\n     29:     'ECDHE-RSA-AES128-SHA', 'DHE-RSA-AES256-SHA256', 'DHE-RSA-AES128-SHA256',\n     30:     'DHE-RSA-AES256-SHA', 'DHE-RSA-AES128-SHA', 'ECDHE-RSA-DES-CBC3-SHA',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 25\n\n     20:     'vhost_cfg_append'     => {'sendfile' => 'off'},\n     21:     'index_files'          => ['index.html', 'index.htm',],\n     22:     'locations'            => [ ]\n     23:   }\n     24: \n>>>  25:   $allowed_ciphers = [\n     26:     'ECDHE-RSA-AES256-GCM-SHA384', 'ECDHE-RSA-AES128-GCM-SHA256',\n     27:     'DHE-RSA-AES256-GCM-SHA384', 'DHE-RSA-AES128-GCM-SHA256',\n     28:     'ECDHE-RSA-AES256-SHA384', 'ECDHE-RSA-AES128-SHA256', 'ECDHE-RSA-AES256-SHA',\n     29:     'ECDHE-RSA-AES128-SHA', 'DHE-RSA-AES256-SHA256', 'DHE-RSA-AES128-SHA256',\n     30:     'DHE-RSA-AES256-SHA', 'DHE-RSA-AES128-SHA', 'ECDHE-RSA-DES-CBC3-SHA',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp", "content": "$home_sha = sha1($catalina_home)", "line": 6, "detection_span": [4, 8], "with_context": "# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 6\n\n      1: # private\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n>>>   6:   $home_sha = sha1($catalina_home)\n      7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 6\n\n      1: # private\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n>>>   6:   $home_sha = sha1($catalina_home)\n      7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp", "content": "$base_sha = sha1($catalina_base)", "line": 7, "detection_span": [5, 9], "with_context": "# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 7\n\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n      6:   $home_sha = sha1($catalina_home)\n>>>   7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: \n     12:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 7\n\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n      6:   $home_sha = sha1($catalina_home)\n>>>   7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: \n     12:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "puppetlabs@puppetlabs-apache-manifests-mod-ssl.pp", "content": "$ssl_cipher                                               = 'HIGH:MEDIUM:!aNULL:!MD5:!RC4:!3DES',", "line": 9, "detection_span": [7, 11], "with_context": "# File: puppetlabs@puppetlabs-apache-manifests-mod-ssl.pp\n# Target line: 9\n\n      4:   $ssl_options                                              = [ 'StdEnvVars' ],\n      5:   $ssl_openssl_conf_cmd                                     = undef,\n      6:   Optional[String] $ssl_cert                                = undef,\n      7:   Optional[String] $ssl_key                                 = undef,\n      8:   $ssl_ca                                                   = undef,\n>>>   9:   $ssl_cipher                                               = 'HIGH:MEDIUM:!aNULL:!MD5:!RC4:!3DES',\n     10:   Variant[Boolean, Enum['on', 'off']] $ssl_honorcipherorder = true,\n     11:   $ssl_protocol                                             = [ 'all', '-SSLv2', '-SSLv3' ],\n     12:   Array $ssl_proxy_protocol                                 = [],\n     13:   $ssl_pass_phrase_dialog                                   = 'builtin',\n     14:   $ssl_random_seed_bytes                                    = '512',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: puppetlabs@puppetlabs-apache-manifests-mod-ssl.pp\n# Target line: 9\n\n      4:   $ssl_options                                              = [ 'StdEnvVars' ],\n      5:   $ssl_openssl_conf_cmd                                     = undef,\n      6:   Optional[String] $ssl_cert                                = undef,\n      7:   Optional[String] $ssl_key                                 = undef,\n      8:   $ssl_ca                                                   = undef,\n>>>   9:   $ssl_cipher                                               = 'HIGH:MEDIUM:!aNULL:!MD5:!RC4:!3DES',\n     10:   Variant[Boolean, Enum['on', 'off']] $ssl_honorcipherorder = true,\n     11:   $ssl_protocol                                             = [ 'all', '-SSLv2', '-SSLv3' ],\n     12:   Array $ssl_proxy_protocol                                 = [],\n     13:   $ssl_pass_phrase_dialog                                   = 'builtin',\n     14:   $ssl_random_seed_bytes                                    = '512',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "alphagov@govuk-puppet-modules-govuk_beat-manifests-repo.pp", "content": "location     => \"http://${apt_mirror_hostname}/elastic-beats\",", "line": 16, "detection_span": [14, 18], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_beat-manifests-repo.pp\n# Target line: 16\n\n     11: #\n     12: class govuk_beat::repo(\n     13:   $apt_mirror_hostname,\n     14: ) {\n     15:   apt::source { 'elastic-beats':\n>>>  16:     location     => \"http://${apt_mirror_hostname}/elastic-beats\",\n     17:     release      => 'stable',\n     18:     architecture => $::architecture,\n     19:   }\n     20: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_beat-manifests-repo.pp\n# Target line: 16\n\n     11: #\n     12: class govuk_beat::repo(\n     13:   $apt_mirror_hostname,\n     14: ) {\n     15:   apt::source { 'elastic-beats':\n>>>  16:     location     => \"http://${apt_mirror_hostname}/elastic-beats\",\n     17:     release      => 'stable',\n     18:     architecture => $::architecture,\n     19:   }\n     20: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 40, "detection_span": [38, 42], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 40\n\n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n>>>  40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 40\n\n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n>>>  40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 41, "detection_span": [39, 43], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 41\n\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 41\n\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 42, "detection_span": [40, 44], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 42\n\n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',\n     47:     project_domain_name  => 'Default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 42\n\n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',\n     47:     project_domain_name  => 'Default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 55, "detection_span": [53, 57], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 55\n\n     50:     memcached_servers    => $::openstack_integration::config::memcached_servers,\n     51:   }\n     52: \n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n>>>  55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 55\n\n     50:     memcached_servers    => $::openstack_integration::config::memcached_servers,\n     51:   }\n     52: \n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n>>>  55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp", "content": "location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",", "line": 18, "detection_span": [16, 20], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 18\n\n     13:   $with_foreman = false,\n     14: ) {\n     15:   include govuk_rbenv\n     16: \n     17:   apt::source { 'rbenv-ruby':\n>>>  18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n     21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 18\n\n     13:   $with_foreman = false,\n     14: ) {\n     15:   include govuk_rbenv\n     16: \n     17:   apt::source { 'rbenv-ruby':\n>>>  18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n     21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp", "content": "mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',", "line": 9, "detection_span": [7, 11], "with_context": "# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::jpackage6 {\n      6: \n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n>>>   9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::jpackage6 {\n      6: \n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n>>>   9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp", "content": "gpgkey         => 'http://www.jpackage.org/jpackage.asc',", "line": 12, "detection_span": [10, 14], "with_context": "# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n      9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n>>>  12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,\n     15:   }\n     16: \n     17: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n      9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n>>>  12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,\n     15:   }\n     16: \n     17: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$download_site                 = 'http://download.sonatype.com/nexus/oss'", "line": 28, "detection_span": [26, 30], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 28\n\n     23:   # See nexus::package on why this won't increment the package version.\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n>>>  28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 28\n\n     23:   # See nexus::package on why this won't increment the package version.\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n>>>  28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'", "line": 40, "detection_span": [38, 42], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 40\n\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true\n>>>  40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef\n     45: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 40\n\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true\n>>>  40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef\n     45: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "voxpupuli@puppet-rundeck-manifests-config-global-framework.pp", "content": "$framework_config_url = { 'framework.server.url' => \"http://${rundeck_hostname}:${rundeck_port}\" }", "line": 28, "detection_span": [26, 30], "with_context": "# File: voxpupuli@puppet-rundeck-manifests-config-global-framework.pp\n# Target line: 28\n\n     23:   if $ssl_enabled {\n     24:     $framework_config_port = { 'framework.server.port' => $ssl_port }\n     25:     $framework_config_url = { 'framework.server.url' => \"https://${rundeck_hostname}:${ssl_port}\" }\n     26:   } elsif $rundeck_hostname != $rundeck::params::framework_config['framework.server.hostname'] {\n     27:     $framework_config_port = undef\n>>>  28:     $framework_config_url = { 'framework.server.url' => \"http://${rundeck_hostname}:${rundeck_port}\" }\n     29:   } else {\n     30:     $framework_config_port = undef\n     31:     $framework_config_url = undef\n     32:   }\n     33: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-rundeck-manifests-config-global-framework.pp\n# Target line: 28\n\n     23:   if $ssl_enabled {\n     24:     $framework_config_port = { 'framework.server.port' => $ssl_port }\n     25:     $framework_config_url = { 'framework.server.url' => \"https://${rundeck_hostname}:${ssl_port}\" }\n     26:   } elsif $rundeck_hostname != $rundeck::params::framework_config['framework.server.hostname'] {\n     27:     $framework_config_port = undef\n>>>  28:     $framework_config_url = { 'framework.server.url' => \"http://${rundeck_hostname}:${rundeck_port}\" }\n     29:   } else {\n     30:     $framework_config_port = undef\n     31:     $framework_config_url = undef\n     32:   }\n     33: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
