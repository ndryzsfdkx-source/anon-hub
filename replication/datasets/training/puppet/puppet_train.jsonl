{"smell": "hard_coded_secret", "file": "dgoodlad@puppet-chruby-manifests-params.pp", "content": "$user          = 'root'", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: dgoodlad@puppet-chruby-manifests-params.pp\n\n}\n\ndefault: {\n$chruby_root   = '/usr/local/share/chruby'\n$chruby_rubies = '/opt/rubies'\n17:       $user          = 'root'\n}\n}\n\n$chruby_version = '0.3.7'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: dgoodlad@puppet-chruby-manifests-params.pp\n# Target line: 17\n\n     12:     }\n     13: \n     14:     default: {\n     15:       $chruby_root   = '/usr/local/share/chruby'\n     16:       $chruby_rubies = '/opt/rubies'\n>>>  17:       $user          = 'root'\n     18:     }\n     19:   }\n     20: \n     21:   $chruby_version = '0.3.7'\n     22: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-network-contrail-heat.pp", "content": "$admin_user     = hiera('contrail::admin_user'),", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-heat.pp\n\n#  Defaults to 'False'\n#\nclass tripleo::network::contrail::heat(\n$admin_password = hiera('contrail::admin_password'),\n$admin_token    = hiera('contrail::admin_token'),\n70:   $admin_user     = hiera('contrail::admin_user'),\n$api_server     = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n$api_port       = 8082,\n$auth_host      = hiera('contrail::auth_host'),\n$step           = Integer(hiera('step')),\n$use_ssl        = 'False',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-heat.pp\n# Target line: 70\n\n     65: #  Defaults to 'False'\n     66: #\n     67: class tripleo::network::contrail::heat(\n     68:   $admin_password = hiera('contrail::admin_password'),\n     69:   $admin_token    = hiera('contrail::admin_token'),\n>>>  70:   $admin_user     = hiera('contrail::admin_user'),\n     71:   $api_server     = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n     72:   $api_port       = 8082,\n     73:   $auth_host      = hiera('contrail::auth_host'),\n     74:   $step           = Integer(hiera('step')),\n     75:   $use_ssl        = 'False',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-postgres-manifests-server.pp", "content": "user            => \"postgres\",", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-postgres-manifests-server.pp\n\nrequire         => Package[\"postgresql-server\"],\n}\n\nexec { \"pginitdb\":\ncommand         => \"/usr/bin/initdb --pgdata='/var/lib/pgsql/data' -E UTF8 -A ident\",\n28:         user            => \"postgres\",\ngroup           => \"postgres\",\ncreates         => \"/var/lib/pgsql/data/PG_VERSION\",\nrequire         => Package[\"postgresql-server\"],\nnotify          => Service[\"postgresql\"],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-postgres-manifests-server.pp\n# Target line: 28\n\n     23:         require         => Package[\"postgresql-server\"],\n     24:     }\n     25: \n     26:     exec { \"pginitdb\":\n     27:         command         => \"/usr/bin/initdb --pgdata='/var/lib/pgsql/data' -E UTF8 -A ident\",\n>>>  28:         user            => \"postgres\",\n     29:         group           => \"postgres\",\n     30:         creates         => \"/var/lib/pgsql/data/PG_VERSION\",\n     31:         require         => Package[\"postgresql-server\"],\n     32:         notify          => Service[\"postgresql\"],\n     33:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp", "content": "aeolus::conductor::login{\"admin\": password => \"password\",", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n\nemail           => 'root@localhost.localdomain',\npassword        => \"password\",\nfirst_name      => 'Administrator',\nlast_name       => ''}\n\n23:   aeolus::conductor::login{\"admin\": password => \"password\",\nrequire  => Aeolus::Conductor::Site_admin['admin']}\n\naeolus::conductor::provider{\"mock\":\ntype           => \"mock\",\nurl            => \"http://localhost:3002/api\"}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n# Target line: 23\n\n     18:      email           => 'root@localhost.localdomain',\n     19:      password        => \"password\",\n     20:      first_name      => 'Administrator',\n     21:      last_name       => ''}\n     22: \n>>>  23:   aeolus::conductor::login{\"admin\": password => \"password\",\n     24:      require  => Aeolus::Conductor::Site_admin['admin']}\n     25: \n     26:   aeolus::conductor::provider{\"mock\":\n     27:                                 type           => \"mock\",\n     28:                                 url            => \"http://localhost:3002/api\"}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-manifests-params.pp", "content": "$misc_owner_root = 'root',", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n\n\n# external modules...\n$include_puppet_facter = true,\n\n# Owner/Group\n67: \t$misc_owner_root = 'root',\n$misc_group_root = 'root',\n$misc_group_nobody = 'nobody',\n\n# Default directories\n# See http://manpages.ubuntu.com/manpages/trusty/man8/mount.glusterfs.8.html", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n# Target line: 67\n\n     62: \n     63: \t# external modules...\n     64: \t$include_puppet_facter = true,\n     65: \n     66: \t# Owner/Group\n>>>  67: \t$misc_owner_root = 'root',\n     68: \t$misc_group_root = 'root',\n     69: \t$misc_group_nobody = 'nobody',\n     70: \n     71: \t# Default directories\n     72: \t# See http://manpages.ubuntu.com/manpages/trusty/man8/mount.glusterfs.8.html\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-midonet.pp", "content": "'MIDONET/password'    : value => $password, secret => true;", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-midonet.pp\n\ninclude ::neutron::deps\n\nneutron_plugin_ml2 {\n'MIDONET/midonet_uri' : value => $midonet_uri;\n'MIDONET/username'    : value => $username;\n33:     'MIDONET/password'    : value => $password, secret => true;\n'MIDONET/project_id'  : value => $project_id;\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-midonet.pp\n# Target line: 33\n\n     28:   include ::neutron::deps\n     29: \n     30:   neutron_plugin_ml2 {\n     31:     'MIDONET/midonet_uri' : value => $midonet_uri;\n     32:     'MIDONET/username'    : value => $username;\n>>>  33:     'MIDONET/password'    : value => $password, secret => true;\n     34:     'MIDONET/project_id'  : value => $project_id;\n     35:   }\n     36: \n     37: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp", "content": "key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n\napt::source { 'logstash':\nlocation    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\nrelease     => 'stable',\nrepos       => 'main',\nkey         => 'D88E42B4',\n11:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\ninclude_src => false,\n}\n\nclass { '::logstash':\nversion            => '1.4.2-1-2c0f5a1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n# Target line: 11\n\n      6:   apt::source { 'logstash':\n      7:     location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\n      8:     release     => 'stable',\n      9:     repos       => 'main',\n     10:     key         => 'D88E42B4',\n>>>  11:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     12:     include_src => false,\n     13:   }\n     14: \n     15:   class { '::logstash':\n     16:     version            => '1.4.2-1-2c0f5a1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-deploy-setup.pp", "content": "username  => 'deploy',", "line": 126, "detection_span": [121, 131], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy-setup.pp\n\n121:\n122:   govuk_bundler::config { 'deploy-bundler':\nserver    => $gemstash_server,\nrequire   => User['deploy'],\nuser_home => '/home/deploy',\n126:     username  => 'deploy',\n127:   }\n128: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy-setup.pp\n# Target line: 126\n\n    121: \n    122:   govuk_bundler::config { 'deploy-bundler':\n    123:     server    => $gemstash_server,\n    124:     require   => User['deploy'],\n    125:     user_home => '/home/deploy',\n>>> 126:     username  => 'deploy',\n    127:   }\n    128: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-init.pp", "content": "admin    => false,", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-init.pp\n\nread_permission      => '.*',\nwrite_permission     => '.*',\n}\n\nrabbitmq_user { $monitoring_user:\n71:     admin    => false,\ntags     => [ 'monitoring' ],\npassword => $monitoring_password,\n}\n\nrabbitmq_user_permissions { \"${monitoring_user}@${root_vhost}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-init.pp\n# Target line: 71\n\n     66:     read_permission      => '.*',\n     67:     write_permission     => '.*',\n     68:   }\n     69: \n     70:   rabbitmq_user { $monitoring_user:\n>>>  71:     admin    => false,\n     72:     tags     => [ 'monitoring' ],\n     73:     password => $monitoring_password,\n     74:   }\n     75: \n     76:   rabbitmq_user_permissions { \"${monitoring_user}@${root_vhost}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp", "content": "$request_uuid                = false,", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n\n$client_max_body_size        = '10m',\n$is_django                   = false,\n$client_max_body_size        = '10m',\n$ssl_cert                    = hiera('public_ssl_cert'),\n$ssl_key                     = hiera('public_ssl_key'),\n26:   $request_uuid                = false,\n$statsd_prefix               = $title,\n) {\nvalidate_bool($request_uuid)\ninclude nginx\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n# Target line: 26\n\n     21:   $client_max_body_size        = '10m',\n     22:   $is_django                   = false,\n     23:   $client_max_body_size        = '10m',\n     24:   $ssl_cert                    = hiera('public_ssl_cert'),\n     25:   $ssl_key                     = hiera('public_ssl_key'),\n>>>  26:   $request_uuid                = false,\n     27:   $statsd_prefix               = $title,\n     28: ) {\n     29:   validate_bool($request_uuid)\n     30:   include nginx\n     31: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-sebastianschmieschek.pp", "content": "ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7VcUWYh2s+lrZ2/Yidodl0nAU2/hI5LP9RNK2Vx0u05KHp5MP8JJl1oGL53KgVuwxQ0YGm9mJzMVmp16F15H/kVR9HAVHpgqfm/6vRGPoHvkWTXc8IdrhmSO/O+kJO+vhFRwp1SQ1dvoGoEjWj/fJ/9NuMjfMUIMm4j+S6mqG5+qq+lJxd/0yFe1tFnh0dxWbFnUIR55s2FaXNTx+dTMTeq2/gw2cPo/oH8x1OoH4XTeWev7Ey0bMAvqKH0kwGJXe54LuTcwNxCABWP3KP+UZ1/E58D6Bilc6KYH4ukwLukZVFP6e+L6VB8/HJZJU2GTSQmsDdk5V6IvbeEtZcMcdMqJjlHP0IxvmhRt17TC85H29ig23DxSgZsWQ+37YMZLfHrwdqMccp8LvYFyiuWLWieyKNNMnU/cSnejoLykyBVrePjDbSqI8z/fQn4h8JVcol/i2wt0NNe9AjTYlWgTZlKFl5WkAZFfX+cZ84IzqdoXKHFaw9QkHPzMGsV3yQgn2x2CEB+evnbaBBxqSCB2re04zNtAqkQMjTa7xWJ7VglqrnfH2TYlrXXBccGSakhZgwTlG+rkz4/BRGQxowPcANrZAH5AmRvQMpWKIOIgbHpp4vzD4+rgwOXH4sei1tQMS/xRAL191s4Tsdt5xgue5Jv8cZ03apT+SPMbh0TSd8w== sebastianschmieschek@gds5607.local',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-sebastianschmieschek.pp\n\n# Creates the user schmie for Sebastian Schmieschek\nclass users::sebastianschmieschek {\ngovuk_user { 'sebastianschmieschek':\nfullname => 'Sebastian Schmieschek',\nemail    => 'sebastian.schmieschek@digital.cabinet-office.gov.uk',\n6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7VcUWYh2s+lrZ2/Yidodl0nAU2/hI5LP9RNK2Vx0u05KHp5MP8JJl1oGL53KgVuwxQ0YGm9mJzMVmp16F15H/kVR9HAVHpgqfm/6vRGPoHvkWTXc8IdrhmSO/O+kJO+vhFRwp1SQ1dvoGoEjWj/fJ/9NuMjfMUIMm4j+S6mqG5+qq+lJxd/0yFe1tFnh0dxWbFnUIR55s2FaXNTx+dTMTeq2/gw2cPo/oH8x1OoH4XTeWev7Ey0bMAvqKH0kwGJXe54LuTcwNxCABWP3KP+UZ1/E58D6Bilc6KYH4ukwLukZVFP6e+L6VB8/HJZJU2GTSQmsDdk5V6IvbeEtZcMcdMqJjlHP0IxvmhRt17TC85H29ig23DxSgZsWQ+37YMZLfHrwdqMccp8LvYFyiuWLWieyKNNMnU/cSnejoLykyBVrePjDbSqI8z/fQn4h8JVcol/i2wt0NNe9AjTYlWgTZlKFl5WkAZFfX+cZ84IzqdoXKHFaw9QkHPzMGsV3yQgn2x2CEB+evnbaBBxqSCB2re04zNtAqkQMjTa7xWJ7VglqrnfH2TYlrXXBccGSakhZgwTlG+rkz4/BRGQxowPcANrZAH5AmRvQMpWKIOIgbHpp4vzD4+rgwOXH4sei1tQMS/xRAL191s4Tsdt5xgue5Jv8cZ03apT+SPMbh0TSd8w== sebastianschmieschek@gds5607.local',\n],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-sebastianschmieschek.pp\n# Target line: 6\n\n      1: # Creates the user schmie for Sebastian Schmieschek\n      2: class users::sebastianschmieschek {\n      3:   govuk_user { 'sebastianschmieschek':\n      4:     fullname => 'Sebastian Schmieschek',\n      5:     email    => 'sebastian.schmieschek@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7VcUWYh2s+lrZ2/Yidodl0nAU2/hI5LP9RNK2Vx0u05KHp5MP8JJl1oGL53KgVuwxQ0YGm9mJzMVmp16F15H/kVR9HAVHpgqfm/6vRGPoHvkWTXc8IdrhmSO/O+kJO+vhFRwp1SQ1dvoGoEjWj/fJ/9NuMjfMUIMm4j+S6mqG5+qq+lJxd/0yFe1tFnh0dxWbFnUIR55s2FaXNTx+dTMTeq2/gw2cPo/oH8x1OoH4XTeWev7Ey0bMAvqKH0kwGJXe54LuTcwNxCABWP3KP+UZ1/E58D6Bilc6KYH4ukwLukZVFP6e+L6VB8/HJZJU2GTSQmsDdk5V6IvbeEtZcMcdMqJjlHP0IxvmhRt17TC85H29ig23DxSgZsWQ+37YMZLfHrwdqMccp8LvYFyiuWLWieyKNNMnU/cSnejoLykyBVrePjDbSqI8z/fQn4h8JVcol/i2wt0NNe9AjTYlWgTZlKFl5WkAZFfX+cZ84IzqdoXKHFaw9QkHPzMGsV3yQgn2x2CEB+evnbaBBxqSCB2re04zNtAqkQMjTa7xWJ7VglqrnfH2TYlrXXBccGSakhZgwTlG+rkz4/BRGQxowPcANrZAH5AmRvQMpWKIOIgbHpp4vzD4+rgwOXH4sei1tQMS/xRAL191s4Tsdt5xgue5Jv8cZ03apT+SPMbh0TSd8w== sebastianschmieschek@gds5607.local',\n      7:     ],\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-bootstrap-manifests-profile-guacamole.pp", "content": "password => 'some_password',", "line": 75, "detection_span": [70, 80], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-guacamole.pp\n\n}\ncontain ::mysql::server\n\nmysql::db {'guacamole_db':\nuser     => 'guacamole_user',\n75: \tpassword => 'some_password',\nhost     => '%',\ngrant    => ['SELECT','INSERT','UPDATE','DELETE'],\nsql      => $guacamole_initdb_file,\nrequire  => File[$guacamole_initdb_file],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-guacamole.pp\n# Target line: 75\n\n     70:       }\n     71:       contain ::mysql::server\n     72: \n     73:       mysql::db {'guacamole_db':\n     74: \tuser     => 'guacamole_user',\n>>>  75: \tpassword => 'some_password',\n     76: \thost     => '%',\n     77: \tgrant    => ['SELECT','INSERT','UPDATE','DELETE'],\n     78: \tsql      => $guacamole_initdb_file,\n     79: \trequire  => File[$guacamole_initdb_file],\n     80:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp", "content": "$passenger_root   = '/usr'", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n\n$mpm_module       = 'worker'\n$dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n$default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n$default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$ssl_certs_dir    = '/etc/ssl/certs'\n95:     $passenger_root   = '/usr'\n$passenger_ruby   = '/usr/bin/ruby'\n$mod_packages     = {\n'auth_kerb'  => 'libapache2-mod-auth-kerb',\n'fcgid'      => 'libapache2-mod-fcgid',\n'passenger'  => 'libapache2-mod-passenger',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n# Target line: 95\n\n     90:     $mpm_module       = 'worker'\n     91:     $dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n     92:     $default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n     93:     $default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     94:     $ssl_certs_dir    = '/etc/ssl/certs'\n>>>  95:     $passenger_root   = '/usr'\n     96:     $passenger_ruby   = '/usr/bin/ruby'\n     97:     $mod_packages     = {\n     98:       'auth_kerb'  => 'libapache2-mod-auth-kerb',\n     99:       'fcgid'      => 'libapache2-mod-fcgid',\n    100:       'passenger'  => 'libapache2-mod-passenger',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-contacts-db.pp", "content": "$mysql_contacts_admin = '',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-contacts-db.pp\n\n#\n# [*password*]\n#   The DB user password.\n#\nclass govuk::apps::contacts::db (\n12:   $mysql_contacts_admin = '',\n$mysql_contacts_frontend =  '',\n){\nmysql::db { 'contacts_production':\nuser     => 'contacts',\nhost     => '%',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-contacts-db.pp\n# Target line: 12\n\n      7: #\n      8: # [*password*]\n      9: #   The DB user password.\n     10: #\n     11: class govuk::apps::contacts::db (\n>>>  12:   $mysql_contacts_admin = '',\n     13:   $mysql_contacts_frontend =  '',\n     14: ){\n     15:   mysql::db { 'contacts_production':\n     16:     user     => 'contacts',\n     17:     host     => '%',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-edwardkerry.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7jBVz4z6BrhddvmRxxaYFPndUsrusaqzQARHRWWEVCGgLgmODjr66mIYTA7refk1zkJCmpvZobG5MuUEF/O3uYkml1YmRIrE/cyAUptiJKNWPds6YsCnX+4efJFdUfVQUvUH0uXs7I6shrPz6dAJwZjFy6y2u42RFliX6HhXtI3KHAt9Xb/hrbjM29lTQiVB8lHCdM6hdesyIK5WlYzGM/33DlqtXywr8WhOOlYGhix0FgWoiWAt3WX8hRDZaa0KuRKDaWuQ9nJRAFzINb+EvYwephSrpXWO/BtCoLLTb1emJl7ehKwb8DDmcNKV9eTIlW9iL4Xf8ZxB1GncQDu/bpfuLUzmbVMp0aJJMZFPwG+4mS8VFxd1yDAC4NucjbgekVrp2KLoUzMPlG9JTQ31/h7KTH6KP0hYGpKwY0FoTMafC6n5CQv3I00Fvl+zjh2g8xZbfllVJAcweEHwCcAQNI36+zusvKW6ptepyNcJiJB6MQzHhT+nCkUNnjYkoyLtyCyG+a9muiCFDDkVDHxapnNNXJF6ikWFHLGb0WHeLvjZ894JJjAbC7xuMYDTfYoKgPKCwfuGM3LRayPNc4faYqyo97qk7D0CvrnS6AXZylNVeeeTxkAoyq4AlTe7Pj1n478Dsq4jkxY637y6FOEnmPTJ2t9XPrPxncAaPyajBvQ== edward.kerry@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-edwardkerry.pp\n\n# Creates the user edwardkerry\nclass users::edwardkerry {\ngovuk_user { 'edwardkerry':\nfullname => 'Edward Kerry',\nemail    => 'edward.kerry@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7jBVz4z6BrhddvmRxxaYFPndUsrusaqzQARHRWWEVCGgLgmODjr66mIYTA7refk1zkJCmpvZobG5MuUEF/O3uYkml1YmRIrE/cyAUptiJKNWPds6YsCnX+4efJFdUfVQUvUH0uXs7I6shrPz6dAJwZjFy6y2u42RFliX6HhXtI3KHAt9Xb/hrbjM29lTQiVB8lHCdM6hdesyIK5WlYzGM/33DlqtXywr8WhOOlYGhix0FgWoiWAt3WX8hRDZaa0KuRKDaWuQ9nJRAFzINb+EvYwephSrpXWO/BtCoLLTb1emJl7ehKwb8DDmcNKV9eTIlW9iL4Xf8ZxB1GncQDu/bpfuLUzmbVMp0aJJMZFPwG+4mS8VFxd1yDAC4NucjbgekVrp2KLoUzMPlG9JTQ31/h7KTH6KP0hYGpKwY0FoTMafC6n5CQv3I00Fvl+zjh2g8xZbfllVJAcweEHwCcAQNI36+zusvKW6ptepyNcJiJB6MQzHhT+nCkUNnjYkoyLtyCyG+a9muiCFDDkVDHxapnNNXJF6ikWFHLGb0WHeLvjZ894JJjAbC7xuMYDTfYoKgPKCwfuGM3LRayPNc4faYqyo97qk7D0CvrnS6AXZylNVeeeTxkAoyq4AlTe7Pj1n478Dsq4jkxY637y6FOEnmPTJ2t9XPrPxncAaPyajBvQ== edward.kerry@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-edwardkerry.pp\n# Target line: 6\n\n      1: # Creates the user edwardkerry\n      2: class users::edwardkerry {\n      3:   govuk_user { 'edwardkerry':\n      4:     fullname => 'Edward Kerry',\n      5:     email    => 'edward.kerry@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7jBVz4z6BrhddvmRxxaYFPndUsrusaqzQARHRWWEVCGgLgmODjr66mIYTA7refk1zkJCmpvZobG5MuUEF/O3uYkml1YmRIrE/cyAUptiJKNWPds6YsCnX+4efJFdUfVQUvUH0uXs7I6shrPz6dAJwZjFy6y2u42RFliX6HhXtI3KHAt9Xb/hrbjM29lTQiVB8lHCdM6hdesyIK5WlYzGM/33DlqtXywr8WhOOlYGhix0FgWoiWAt3WX8hRDZaa0KuRKDaWuQ9nJRAFzINb+EvYwephSrpXWO/BtCoLLTb1emJl7ehKwb8DDmcNKV9eTIlW9iL4Xf8ZxB1GncQDu/bpfuLUzmbVMp0aJJMZFPwG+4mS8VFxd1yDAC4NucjbgekVrp2KLoUzMPlG9JTQ31/h7KTH6KP0hYGpKwY0FoTMafC6n5CQv3I00Fvl+zjh2g8xZbfllVJAcweEHwCcAQNI36+zusvKW6ptepyNcJiJB6MQzHhT+nCkUNnjYkoyLtyCyG+a9muiCFDDkVDHxapnNNXJF6ikWFHLGb0WHeLvjZ894JJjAbC7xuMYDTfYoKgPKCwfuGM3LRayPNc4faYqyo97qk7D0CvrnS6AXZylNVeeeTxkAoyq4AlTe7Pj1n478Dsq4jkxY637y6FOEnmPTJ2t9XPrPxncAaPyajBvQ== edward.kerry@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-rabbitmq-examples-user-add.pp", "content": "password => 'phoey!',", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: voxpupuli@puppet-rabbitmq-examples-user-add.pp\n\nrabbitmq_user { ['blah2', 'blah3', 'blah4']:\n2:   password => 'phoey!',\n#provider => 'rabbitmqctl',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-rabbitmq-examples-user-add.pp\n# Target line: 2\n\n      1: rabbitmq_user { ['blah2', 'blah3', 'blah4']:\n>>>   2:   password => 'phoey!',\n      3:   #provider => 'rabbitmqctl',\n      4: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-httpd-manifests-vhost-proxy.pp", "content": "$docroot         = undef,", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: openstack-infra@puppet-httpd-manifests-vhost-proxy.pp\n\n# Sample Usage:\n#\ndefine httpd::vhost::proxy (\n$dest,\n$port,\n24:     $docroot         = undef,\n$priority        = '10',\n$proxyexclusions = undef,\n$serveraliases   = undef,\n$servername      = undef,\n$ssl             = false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-httpd-manifests-vhost-proxy.pp\n# Target line: 24\n\n     19: # Sample Usage:\n     20: #\n     21: define httpd::vhost::proxy (\n     22:     $dest,\n     23:     $port,\n>>>  24:     $docroot         = undef,\n     25:     $priority        = '10',\n     26:     $proxyexclusions = undef,\n     27:     $serveraliases   = undef,\n     28:     $servername      = undef,\n     29:     $ssl             = false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute.pp", "content": "password    => hiera('CONFIG_NOVA_KS_PW'),", "line": 89, "detection_span": [84, 94], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute.pp\n\nforce_config_drive            => false,\n}\n\nclass { '::nova::placement':\nauth_url    => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\n89:       password    => hiera('CONFIG_NOVA_KS_PW'),\nregion_name => hiera('CONFIG_KEYSTONE_REGION'),\n}\n\nclass { '::nova::compute::pci':\npassthrough => hiera('CONFIG_NOVA_PCI_PASSTHROUGH_WHITELIST')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute.pp\n# Target line: 89\n\n     84:       force_config_drive            => false,\n     85:     }\n     86: \n     87:     class { '::nova::placement':\n     88:       auth_url    => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\n>>>  89:       password    => hiera('CONFIG_NOVA_KS_PW'),\n     90:       region_name => hiera('CONFIG_KEYSTONE_REGION'),\n     91:     }\n     92: \n     93:     class { '::nova::compute::pci':\n     94:       passthrough => hiera('CONFIG_NOVA_PCI_PASSTHROUGH_WHITELIST')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'EA312927';", "line": 88, "detection_span": [83, 93], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'dist',\nkey      => '7F0CEB10';\n'mongodb3.2':\nlocation => 'https://repo.mongodb.org/apt/ubuntu',\nrelease  => 'trusty/mongodb-org/3.2',\n88:       key      => 'EA312927';\n'nginx':\nlocation => 'https://nginx.org/packages/ubuntu/',\nrelease  => 'trusty',\nkey      => 'ABF5BD827BD9BF62';\n'nginx-precise':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 88\n\n     83:       release  => 'dist',\n     84:       key      => '7F0CEB10';\n     85:     'mongodb3.2':\n     86:       location => 'https://repo.mongodb.org/apt/ubuntu',\n     87:       release  => 'trusty/mongodb-org/3.2',\n>>>  88:       key      => 'EA312927';\n     89:     'nginx':\n     90:       location => 'https://nginx.org/packages/ubuntu/',\n     91:       release  => 'trusty',\n     92:       key      => 'ABF5BD827BD9BF62';\n     93:     'nginx-precise':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp", "content": "$superuser        = false,", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n\n$password_hash    = false,\n$createdb         = false,\n$createrole       = false,\n$db               = 'postgres',\n$login            = false,\n25:   $superuser        = false,\n$replication      = false,\n$connection_limit = '-1',\n$username         = $title\n) {\ninclude postgresql::params", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n# Target line: 25\n\n     20:   $password_hash    = false,\n     21:   $createdb         = false,\n     22:   $createrole       = false,\n     23:   $db               = 'postgres',\n     24:   $login            = false,\n>>>  25:   $superuser        = false,\n     26:   $replication      = false,\n     27:   $connection_limit = '-1',\n     28:   $username         = $title\n     29: ) {\n     30:   include postgresql::params\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp", "content": "key    => 'wvous-bl-modifier',", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n\nvalue  => 4,\n}\nboxen::osx_defaults { 'Bottom left screen corner \u2192 Modifier':\nuser   => $::luser,\ndomain => 'com.apple.dock',\n61:     key    => 'wvous-bl-modifier',\ntype   => 'int',\nvalue  => 0,\n}\nboxen::osx_defaults { 'Top right screen corner \u2192 Mission Control':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n# Target line: 61\n\n     56:     value  => 4,\n     57:   }\n     58:   boxen::osx_defaults { 'Bottom left screen corner \u2192 Modifier':\n     59:     user   => $::luser,\n     60:     domain => 'com.apple.dock',\n>>>  61:     key    => 'wvous-bl-modifier',\n     62:     type   => 'int',\n     63:     value  => 0,\n     64:   }\n     65:   boxen::osx_defaults { 'Top right screen corner \u2192 Mission Control':\n     66:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp", "content": "admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n\ndebug => hiera('CONFIG_DEBUG_MODE'),\n}\n\nclass { '::keystone':\nadmin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\n36:       admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\ndatabase_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\ntoken_provider      => \"${keystone_token_provider_str}\",\nenable_fernet_setup => true,\nservice_name        => 'httpd',\nenable_ssl          => $keystone_use_ssl,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n# Target line: 36\n\n     31:       debug => hiera('CONFIG_DEBUG_MODE'),\n     32:     }\n     33: \n     34:     class { '::keystone':\n     35:       admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\n>>>  36:       admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\n     37:       database_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\n     38:       token_provider      => \"${keystone_token_provider_str}\",\n     39:       enable_fernet_setup => true,\n     40:       service_name        => 'httpd',\n     41:       enable_ssl          => $keystone_use_ssl,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-aodh.pp", "content": "password => 'aodh',", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-aodh.pp\n\ndatabase_connection        => 'mysql+pymysql://aodh:aodh@127.0.0.1/aodh?charset=utf8',\nnotification_topics        => $notification_topics,\nnotification_driver        => 'messagingv2',\n}\nclass { '::aodh::db::mysql':\n52:     password => 'aodh',\n}\nclass { '::aodh::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:8042\",\ninternal_url => \"${::openstack_integration::config::base_url}:8042\",\nadmin_url    => \"${::openstack_integration::config::base_url}:8042\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-aodh.pp\n# Target line: 52\n\n     47:     database_connection        => 'mysql+pymysql://aodh:aodh@127.0.0.1/aodh?charset=utf8',\n     48:     notification_topics        => $notification_topics,\n     49:     notification_driver        => 'messagingv2',\n     50:   }\n     51:   class { '::aodh::db::mysql':\n>>>  52:     password => 'aodh',\n     53:   }\n     54:   class { '::aodh::keystone::auth':\n     55:     public_url   => \"${::openstack_integration::config::base_url}:8042\",\n     56:     internal_url => \"${::openstack_integration::config::base_url}:8042\",\n     57:     admin_url    => \"${::openstack_integration::config::base_url}:8042\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-postgresql-manifests-server-role.pp", "content": "$pwd_md5 = md5(\"${password_hash}${username}\")", "line": 115, "detection_span": [110, 120], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n\n110:\nif $password_hash and $update_password {\nif($password_hash =~ /^md5.+/) {\n$pwd_hash_sql = $password_hash\n} else {\n115:         $pwd_md5 = md5(\"${password_hash}${username}\")\n$pwd_hash_sql = \"md5${pwd_md5}\"\n}\npostgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\ncommand     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\nunless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n# Target line: 115\n\n    110: \n    111:     if $password_hash and $update_password {\n    112:       if($password_hash =~ /^md5.+/) {\n    113:         $pwd_hash_sql = $password_hash\n    114:       } else {\n>>> 115:         $pwd_md5 = md5(\"${password_hash}${username}\")\n    116:         $pwd_hash_sql = \"md5${pwd_md5}\"\n    117:       }\n    118:       postgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\n    119:         command     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\n    120:         unless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ceph-manifests-mgr.pp", "content": "$inject_key          = false,", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: openstack@puppet-ceph-manifests-mgr.pp\n\n$enable              = true,\n$ensure              = running,\n$cluster             = 'ceph',\n$authentication_type = 'cephx',\n$key                 = undef,\n53:   $inject_key          = false,\n) {\nfile { '/var/lib/ceph/mgr':\nensure  => directory,\nowner   => 'ceph',\ngroup   => 'ceph',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ceph-manifests-mgr.pp\n# Target line: 53\n\n     48:   $enable              = true,\n     49:   $ensure              = running,\n     50:   $cluster             = 'ceph',\n     51:   $authentication_type = 'cephx',\n     52:   $key                 = undef,\n>>>  53:   $inject_key          = false,\n     54: ) {\n     55:   file { '/var/lib/ceph/mgr':\n     56:     ensure  => directory,\n     57:     owner   => 'ceph',\n     58:     group   => 'ceph',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-manuals_publisher.pp", "content": "$email_alert_api_bearer_token = undef,", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-manuals_publisher.pp\n\n#   Default: undef\n#\nclass govuk::apps::manuals_publisher(\n$port = 3205,\n$asset_manager_bearer_token = undef,\n67:   $email_alert_api_bearer_token = undef,\n$enable_procfile_worker = true,\n$sentry_dsn = undef,\n$mongodb_nodes,\n$mongodb_name,\n$oauth_id = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-manuals_publisher.pp\n# Target line: 67\n\n     62: #   Default: undef\n     63: #\n     64: class govuk::apps::manuals_publisher(\n     65:   $port = 3205,\n     66:   $asset_manager_bearer_token = undef,\n>>>  67:   $email_alert_api_bearer_token = undef,\n     68:   $enable_procfile_worker = true,\n     69:   $sentry_dsn = undef,\n     70:   $mongodb_nodes,\n     71:   $mongodb_name,\n     72:   $oauth_id = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-influxdb-bootstrap.pp", "content": "$influxdb_dbuser_ro_password = undef,", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n\n# [*influxdb_retention_replication*]\n#   influxdb retention policy replication factor\n#\nclass monasca::influxdb::bootstrap(\n$influxdb_password = undef,\n30:   $influxdb_dbuser_ro_password = undef,\n$influxdb_def_ret_pol_name = 'raw',\n$influxdb_def_ret_pol_duration = '390d',\n$influxdb_tmp_ret_pol_name = 'tmp',\n$influxdb_tmp_ret_pol_duration = '1h',\n$influxdb_retention_replication = 1,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n# Target line: 30\n\n     25: # [*influxdb_retention_replication*]\n     26: #   influxdb retention policy replication factor\n     27: #\n     28: class monasca::influxdb::bootstrap(\n     29:   $influxdb_password = undef,\n>>>  30:   $influxdb_dbuser_ro_password = undef,\n     31:   $influxdb_def_ret_pol_name = 'raw',\n     32:   $influxdb_def_ret_pol_duration = '390d',\n     33:   $influxdb_tmp_ret_pol_name = 'tmp',\n     34:   $influxdb_tmp_ret_pol_duration = '1h',\n     35:   $influxdb_retention_replication = 1,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-global-key_repeat_rate.pp", "content": "key    => 'KeyRepeat',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: quintel@boxen-modules-osx-manifests-global-key_repeat_rate.pp\n\n#     rate => 2\n#   }\nclass osx::global::key_repeat_rate($rate = 0) {\nboxen::osx_defaults { 'key repeat rate':\ndomain => 'NSGlobalDomain',\n17:     key    => 'KeyRepeat',\nvalue  => $rate,\nuser   => $::boxen_user;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-osx-manifests-global-key_repeat_rate.pp\n# Target line: 17\n\n     12: #     rate => 2\n     13: #   }\n     14: class osx::global::key_repeat_rate($rate = 0) {\n     15:   boxen::osx_defaults { 'key repeat rate':\n     16:     domain => 'NSGlobalDomain',\n>>>  17:     key    => 'KeyRepeat',\n     18:     value  => $rate,\n     19:     user   => $::boxen_user;\n     20:   }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-zooming.pp", "content": "key    => 'closeViewScrollWheelToggle',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-zooming.pp\n\nclass people::felho::osx_settings::zooming {\nboxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) modifier key to zoom':\nuser   => $::luser,\ndomain => 'com.apple.universalaccess',\n5:     key    => 'closeViewScrollWheelToggle',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Zooming: zoom panning mode':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-zooming.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::zooming {\n      2:   boxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) modifier key to zoom':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.universalaccess',\n>>>   5:     key    => 'closeViewScrollWheelToggle',\n      6:     type   => 'bool',\n      7:     value  => true,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Zooming: zoom panning mode':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-magnum.pp", "content": "password             => hiera('CONFIG_MAGNUM_KS_PW'),", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-magnum.pp\n\nclass { '::magnum::keystone::authtoken':\nwww_authenticate_uri => \"${magnum_protocol}://${magnum_host}:5000/v3\",\nauth_url             => \"${magnum_protocol}://${magnum_host}:5000\",\nauth_version         => 'v3',\nusername             => 'magnum',\n20:       password             => hiera('CONFIG_MAGNUM_KS_PW'),\nauth_type            => 'password',\nmemcached_servers    => \"${magnum_host}:11211\",\nproject_name         => 'services'\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-magnum.pp\n# Target line: 20\n\n     15:     class { '::magnum::keystone::authtoken':\n     16:       www_authenticate_uri => \"${magnum_protocol}://${magnum_host}:5000/v3\",\n     17:       auth_url             => \"${magnum_protocol}://${magnum_host}:5000\",\n     18:       auth_version         => 'v3',\n     19:       username             => 'magnum',\n>>>  20:       password             => hiera('CONFIG_MAGNUM_KS_PW'),\n     21:       auth_type            => 'password',\n     22:       memcached_servers    => \"${magnum_host}:11211\",\n     23:       project_name         => 'services'\n     24:     }\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-shorewall-manifests-mangle.pp", "content": "$user            = '-',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: duritong@puppet-shorewall-manifests-mangle.pp\n\n$destination,\n$action          = $name,\n$proto           = '-',\n$destinationport = '-',\n$sourceport      = '-',\n8:   $user            = '-',\n$test            = '-',\n$length          = '-',\n$tos             = '-',\n$connbytes       = '-',\n$helper          = '-',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-shorewall-manifests-mangle.pp\n# Target line: 8\n\n      3:   $destination,\n      4:   $action          = $name,\n      5:   $proto           = '-',\n      6:   $destinationport = '-',\n      7:   $sourceport      = '-',\n>>>   8:   $user            = '-',\n      9:   $test            = '-',\n     10:   $length          = '-',\n     11:   $tos             = '-',\n     12:   $connbytes       = '-',\n     13:   $helper          = '-',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write-rabbitmq.pp", "content": "$amqp_pass  = 'backdrop_write',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write-rabbitmq.pp\n\n#   The virtual host that this application is restricted to\n#   Default: backdrop_write\n#\nclass govuk::apps::backdrop_write::rabbitmq (\n$amqp_user  = 'backdrop_write',\n29:   $amqp_pass  = 'backdrop_write',\n$amqp_vhost = 'backdrop_write',\n) {\n\nrabbitmq_vhost { \"/${amqp_vhost}\":\nensure   => present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write-rabbitmq.pp\n# Target line: 29\n\n     24: #   The virtual host that this application is restricted to\n     25: #   Default: backdrop_write\n     26: #\n     27: class govuk::apps::backdrop_write::rabbitmq (\n     28:   $amqp_user  = 'backdrop_write',\n>>>  29:   $amqp_pass  = 'backdrop_write',\n     30:   $amqp_vhost = 'backdrop_write',\n     31: ) {\n     32: \n     33:   rabbitmq_vhost { \"/${amqp_vhost}\":\n     34:     ensure   => present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_clicking.pp", "content": "key    => 'com.apple.mouse.tapBehavior',", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_clicking.pp\n\n\nboxen::osx_defaults { 'Enable tap to click for the active user':\nuser   => $::luser,\nhost   => 'currentHost',\ndomain => 'NSGlobalDomain',\n36:     key    => 'com.apple.mouse.tapBehavior',\ntype   => 'int',\nvalue  => $tapBehavior,\n}\n\nboxen::osx_defaults { 'Enable tap to click on the login screen':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_clicking.pp\n# Target line: 36\n\n     31: \n     32:   boxen::osx_defaults { 'Enable tap to click for the active user':\n     33:     user   => $::luser,\n     34:     host   => 'currentHost',\n     35:     domain => 'NSGlobalDomain',\n>>>  36:     key    => 'com.apple.mouse.tapBehavior',\n     37:     type   => 'int',\n     38:     value  => $tapBehavior,\n     39:   }\n     40: \n     41:   boxen::osx_defaults { 'Enable tap to click on the login screen':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "biemond@biemond-oradb-manifests-autostartdatabase.pp", "content": "String $user         = lookup('oradb::user'),", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: biemond@biemond-oradb-manifests-autostartdatabase.pp\n\n# @param service_name\n#\ndefine oradb::autostartdatabase(\nString $oracle_home  = undef,\nString $db_name      = lookup('oradb::database_name'),\n23:   String $user         = lookup('oradb::user'),\nString $service_name = lookup('oradb::host::service_name')\n){\n\nclass { 'oradb::prepareautostart':\noracle_home  => $oracle_home,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-oradb-manifests-autostartdatabase.pp\n# Target line: 23\n\n     18: # @param service_name\n     19: #\n     20: define oradb::autostartdatabase(\n     21:   String $oracle_home  = undef,\n     22:   String $db_name      = lookup('oradb::database_name'),\n>>>  23:   String $user         = lookup('oradb::user'),\n     24:   String $service_name = lookup('oradb::host::service_name')\n     25: ){\n     26: \n     27:   class { 'oradb::prepareautostart':\n     28:     oracle_home  => $oracle_home,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp", "content": "key               => '89DF5277',", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n\n::apt::source { 'packages.dotdeb.org-php56-repo.puphpet':\nlocation          => 'http://repo.puphpet.com/dotdeb/',\nrelease           => 'wheezy-php56',\nrepos             => 'all',\nrequired_packages => 'debian-keyring debian-archive-keyring',\n41:           key               => '89DF5277',\nkey_server        => 'keys.gnupg.net',\ninclude_src       => true\n}\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n# Target line: 41\n\n     36:        ::apt::source { 'packages.dotdeb.org-php56-repo.puphpet':\n     37:           location          => 'http://repo.puphpet.com/dotdeb/',\n     38:           release           => 'wheezy-php56',\n     39:           repos             => 'all',\n     40:           required_packages => 'debian-keyring debian-archive-keyring',\n>>>  41:           key               => '89DF5277',\n     42:           key_server        => 'keys.gnupg.net',\n     43:           include_src       => true\n     44:         }\n     45:       }\n     46:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-nginx-manifests-init.pp", "content": "user       => 'www-data',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-init.pp\n\nnotify => Class['nginx::service'];\n}\n\nlimits::limits { 'www-data_nofile':\nensure     => present,\n23:     user       => 'www-data',\nlimit_type => 'nofile',\nboth       => 16384,\n}\n\nclass { 'nginx::package':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-init.pp\n# Target line: 23\n\n     18:     notify => Class['nginx::service'];\n     19:   }\n     20: \n     21:   limits::limits { 'www-data_nofile':\n     22:     ensure     => present,\n>>>  23:     user       => 'www-data',\n     24:     limit_type => 'nofile',\n     25:     both       => 16384,\n     26:   }\n     27: \n     28:   class { 'nginx::package':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "solarkennedy@puppet-consul-manifests-params.pp", "content": "$user = 'consul'", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: solarkennedy@puppet-consul-manifests-params.pp\n\n$config_defaults  = {\ndata_dir => '/opt/consul'\n}\n$manage_user = true\n$manage_group = true\n56:       $user = 'consul'\n$group = 'consul'\n}\n}\n\ncase $facts['os']['name'] {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: solarkennedy@puppet-consul-manifests-params.pp\n# Target line: 56\n\n     51:       $config_defaults  = {\n     52:         data_dir => '/opt/consul'\n     53:       }\n     54:       $manage_user = true\n     55:       $manage_group = true\n>>>  56:       $user = 'consul'\n     57:       $group = 'consul'\n     58:     }\n     59:   }\n     60: \n     61:   case $facts['os']['name'] {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-gnocchi-examples-site.pp", "content": "password     => 'verysecrete',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: openstack@puppet-gnocchi-examples-site.pp\n\n\nclass { '::gnocchi::keystone::auth':\nadmin_url    => 'http://10.0.0.1:8041',\ninternal_url => 'http://10.0.0.1:8041',\npublic_url   => 'http://10.0.0.1:8041',\n7:   password     => 'verysecrete',\nregion       => 'OpenStack'\n}\n\nclass { '::gnocchi':\ndatabase_connection => 'mysql+pymysql://gnocchi:secrete@10.0.0.1/gnocchi?charset=utf8',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-gnocchi-examples-site.pp\n# Target line: 7\n\n      2: \n      3: class { '::gnocchi::keystone::auth':\n      4:   admin_url    => 'http://10.0.0.1:8041',\n      5:   internal_url => 'http://10.0.0.1:8041',\n      6:   public_url   => 'http://10.0.0.1:8041',\n>>>   7:   password     => 'verysecrete',\n      8:   region       => 'OpenStack'\n      9: }\n     10: \n     11: class { '::gnocchi':\n     12:   database_connection => 'mysql+pymysql://gnocchi:secrete@10.0.0.1/gnocchi?charset=utf8',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp", "content": "$postgres_password    = undef,", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n\n#\nclass govuk::node::s_transition_db_admin(\n$backup_s3_bucket     = undef,\n$postgres_host        = undef,\n$postgres_user        = undef,\n11:   $postgres_password    = undef,\n$postgres_port        = '5432',\n$postgres_backup_hour = 7,\n$postgres_backup_min  = 30,\n$apt_mirror_hostname,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n# Target line: 11\n\n      6: #\n      7: class govuk::node::s_transition_db_admin(\n      8:   $backup_s3_bucket     = undef,\n      9:   $postgres_host        = undef,\n     10:   $postgres_user        = undef,\n>>>  11:   $postgres_password    = undef,\n     12:   $postgres_port        = '5432',\n     13:   $postgres_backup_hour = 7,\n     14:   $postgres_backup_min  = 30,\n     15:   $apt_mirror_hostname,\n     16: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'ABF5BD827BD9BF62';", "line": 92, "detection_span": [87, 97], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'trusty/mongodb-org/3.2',\nkey      => 'EA312927';\n'nginx':\nlocation => 'https://nginx.org/packages/ubuntu/',\nrelease  => 'trusty',\n92:       key      => 'ABF5BD827BD9BF62';\n'nginx-precise':\nlocation => 'https://nginx.org/packages/ubuntu/',\nrelease  => 'precise',\nkey      => 'ABF5BD827BD9BF62';\n'nodejs':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 92\n\n     87:       release  => 'trusty/mongodb-org/3.2',\n     88:       key      => 'EA312927';\n     89:     'nginx':\n     90:       location => 'https://nginx.org/packages/ubuntu/',\n     91:       release  => 'trusty',\n>>>  92:       key      => 'ABF5BD827BD9BF62';\n     93:     'nginx-precise':\n     94:       location => 'https://nginx.org/packages/ubuntu/',\n     95:       release  => 'precise',\n     96:       key      => 'ABF5BD827BD9BF62';\n     97:     'nodejs':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-dev@devstack-vagrant-puppet-modules-user-manifests-stack.pp", "content": "is_admin => true,", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-stack.pp\n\n\nuser::create { 'stack':\nuser => $username,\npass => $stack_password,\nkey => $stack_sshkey,\n25:     is_admin => true,\n} ->\n\nfile {'/home/stack/.bashrc':\nowner => $username,\ngroup => $username,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-stack.pp\n# Target line: 25\n\n     20: \n     21:   user::create { 'stack':\n     22:     user => $username,\n     23:     pass => $stack_password,\n     24:     key => $stack_sshkey,\n>>>  25:     is_admin => true,\n     26:   } ->\n     27: \n     28:   file {'/home/stack/.bashrc':\n     29:     owner => $username,\n     30:     group => $username,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-mplayerx.pp", "content": "key    => 'ASVTS',", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-mplayerx.pp\n\ntype   => 'int',\nvalue  => 0;\n'ASVTS (this should be set for some reason)':\nuser   => $::luser,\ndomain => 'org.niltsh.MPlayerX',\n28:       key    => 'ASVTS',\ntype   => 'int',\nvalue  => 2;\n}\n\nboxen::osx_defaults { 'MPlayerX: set subtitle font color to red':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-mplayerx.pp\n# Target line: 28\n\n     23:       type   => 'int',\n     24:       value  => 0;\n     25:     'ASVTS (this should be set for some reason)':\n     26:       user   => $::luser,\n     27:       domain => 'org.niltsh.MPlayerX',\n>>>  28:       key    => 'ASVTS',\n     29:       type   => 'int',\n     30:       value  => 2;\n     31:   }\n     32: \n     33:   boxen::osx_defaults { 'MPlayerX: set subtitle font color to red':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp", "content": "routing_key   => '*.major.#',", "line": 44, "detection_span": [39, 49], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n\n} ->\n\ngovuk_rabbitmq::queue_with_binding { $amqp_major_change_queue:\namqp_exchange => $amqp_exchange,\namqp_queue    => $amqp_major_change_queue,\n44:     routing_key   => '*.major.#',\ndurable       => true,\n} ->\n\ngovuk_rabbitmq::queue_with_binding { $amqp_unpublishing_queue:\namqp_exchange => $amqp_exchange,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n# Target line: 44\n\n     39:   } ->\n     40: \n     41:   govuk_rabbitmq::queue_with_binding { $amqp_major_change_queue:\n     42:     amqp_exchange => $amqp_exchange,\n     43:     amqp_queue    => $amqp_major_change_queue,\n>>>  44:     routing_key   => '*.major.#',\n     45:     durable       => true,\n     46:   } ->\n     47: \n     48:   govuk_rabbitmq::queue_with_binding { $amqp_unpublishing_queue:\n     49:     amqp_exchange => $amqp_exchange,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-ctf-hidden_file-manifests-install.pp", "content": "password   => pw_hash($account['password'], 'SHA-512', 'mysalt'),", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ctf-hidden_file-manifests-install.pp\n\n$storage_directory = \"/home/$username\"\n\n# Create user account\n::accounts::user { $username:\nshell      => '/bin/bash',\n18:       password   => pw_hash($account['password'], 'SHA-512', 'mysalt'),\nmanagehome => true,\nhome_mode  => '0755',\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ctf-hidden_file-manifests-install.pp\n# Target line: 18\n\n     13:     $storage_directory = \"/home/$username\"\n     14: \n     15:     # Create user account\n     16:     ::accounts::user { $username:\n     17:       shell      => '/bin/bash',\n>>>  18:       password   => pw_hash($account['password'], 'SHA-512', 'mysalt'),\n     19:       managehome => true,\n     20:       home_mode  => '0755',\n     21:     }\n     22:   }\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp", "content": "routing_key   => '*.*',", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\nensure        => $toggled_ensure,\namqp_exchange => $amqp_exchange,\namqp_queue    => 'rummager_govuk_index',\n48:     routing_key   => '*.*',\ndurable       => true,\n}\n\n# When we want to manually refresh data in search, we can run a task in\n# publishing API to send \"bulk reindex\" messages. The routing key has", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n# Target line: 48\n\n     43: \n     44:   govuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\n     45:     ensure        => $toggled_ensure,\n     46:     amqp_exchange => $amqp_exchange,\n     47:     amqp_queue    => 'rummager_govuk_index',\n>>>  48:     routing_key   => '*.*',\n     49:     durable       => true,\n     50:   }\n     51: \n     52:   # When we want to manually refresh data in search, we can run a task in\n     53:   # publishing API to send \"bulk reindex\" messages. The routing key has\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-table_grant.pp", "content": "$psql_user = undef", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-table_grant.pp\n\n$privilege,\n$table,\n$db,\n$role,\n$psql_db   = undef,\n8:   $psql_user = undef\n) {\ninclude postgresql::params\npostgresql::grant { \"table:${name}\":\nrole        => $role,\ndb          => $db,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-table_grant.pp\n# Target line: 8\n\n      3:   $privilege,\n      4:   $table,\n      5:   $db,\n      6:   $role,\n      7:   $psql_db   = undef,\n>>>   8:   $psql_user = undef\n      9: ) {\n     10:   include postgresql::params\n     11:   postgresql::grant { \"table:${name}\":\n     12:     role        => $role,\n     13:     db          => $db,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-divvy.pp", "content": "key    => 'globalHotkey',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-divvy.pp\n\n}\n\npeople::felho::osx_defaults_extended { 'Divvy globalHotkey':\nuser   => $::luser,\ndomain => 'com.mizage.Divvy',\n12:     key    => 'globalHotkey',\ntype   => 'dict',\nvalue  => { 'keyCode' => 13, 'modifiers' => 2304 },\n}\n\nboxen::osx_defaults { 'Divvy shortcuts':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-divvy.pp\n# Target line: 12\n\n      7:   }\n      8: \n      9:   people::felho::osx_defaults_extended { 'Divvy globalHotkey':\n     10:     user   => $::luser,\n     11:     domain => 'com.mizage.Divvy',\n>>>  12:     key    => 'globalHotkey',\n     13:     type   => 'dict',\n     14:     value  => { 'keyCode' => 13, 'modifiers' => 2304 },\n     15:   }\n     16: \n     17:   boxen::osx_defaults { 'Divvy shortcuts':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-keystone-auth.pp", "content": "$configure_user      = true,", "line": 79, "detection_span": [74, 84], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-keystone-auth.pp\n\n$password,\n$auth_name           = 'neutron',\n$email               = 'neutron@localhost',\n$tenant              = 'services',\n$configure_endpoint  = true,\n79:   $configure_user      = true,\n$configure_user_role = true,\n$service_name        = 'neutron',\n$service_type        = 'network',\n$service_description = 'Neutron Networking Service',\n$region              = 'RegionOne',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-keystone-auth.pp\n# Target line: 79\n\n     74:   $password,\n     75:   $auth_name           = 'neutron',\n     76:   $email               = 'neutron@localhost',\n     77:   $tenant              = 'services',\n     78:   $configure_endpoint  = true,\n>>>  79:   $configure_user      = true,\n     80:   $configure_user_role = true,\n     81:   $service_name        = 'neutron',\n     82:   $service_type        = 'network',\n     83:   $service_description = 'Neutron Networking Service',\n     84:   $region              = 'RegionOne',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-tijmenbrommet.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChxDnHtmrP+8wTqONV76/sHMAVkJeyeMs/yDNl4+bumjWum9+ZqKGTS6QvvZGh/rTKg5934ncv5xPv910NmisYW6SetjT4hWMZuqtnZKdLBN2YpSyqTjIWK0kpdKMS1linkeE5/6X38Ebi3UKP63VqTsDM7o4W2v/CshoIbC5+UKt7WjtcMsrijpul1leSw8gvwCtoq6z5N3vLqECTcv5/AoH+LxWDW/TYlywGqUD4Lfa1jJGf+D5ICK+StQMQ1RBU4ICby43htus+RR+NqMyDnQLkGdrVVT+/Tc2jQrj0wz78nVvJPULiG889NvgPrjXn1s9w45DuVl7i3a4c+X8yFGg6hcgW8pHcH+2sOPC5g1Y84ZARLj6yIr1ezdr6H5vSLiUBTauYuTOP3u2F5h1MKLHdXuhUKaV4jIj42jKpCwnKnd62uHs4oOkfIz4OFbVNCNDvUdBMYbRkJd8yDYHeSzbEFElSSSxBRtwMnfX1DJ21myNtI0AGzQMP27NYkroHQGLmbbHiLeWuFly8yuEmeeustdtQBwf6qMTcJeCXtAkzgTUDFYLsu3zBCZQN9wJt/OCBPrGbwn5cutaUMmn9RGEeUgqNYxzvKEwmF+1/QINAD3PZjk3byfh0u1LRYnppvQrfsg24wh5dtlTRzPfuPxtrWdKTxkPm3gLvqdJmvw== tijmen.brommet@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-tijmenbrommet.pp\n\n# Creates the tijmenbrommet user\nclass users::tijmenbrommet {\ngovuk_user { 'tijmenbrommet':\nfullname => 'Tijmen Brommet',\nemail    => 'tijmen.brommet@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChxDnHtmrP+8wTqONV76/sHMAVkJeyeMs/yDNl4+bumjWum9+ZqKGTS6QvvZGh/rTKg5934ncv5xPv910NmisYW6SetjT4hWMZuqtnZKdLBN2YpSyqTjIWK0kpdKMS1linkeE5/6X38Ebi3UKP63VqTsDM7o4W2v/CshoIbC5+UKt7WjtcMsrijpul1leSw8gvwCtoq6z5N3vLqECTcv5/AoH+LxWDW/TYlywGqUD4Lfa1jJGf+D5ICK+StQMQ1RBU4ICby43htus+RR+NqMyDnQLkGdrVVT+/Tc2jQrj0wz78nVvJPULiG889NvgPrjXn1s9w45DuVl7i3a4c+X8yFGg6hcgW8pHcH+2sOPC5g1Y84ZARLj6yIr1ezdr6H5vSLiUBTauYuTOP3u2F5h1MKLHdXuhUKaV4jIj42jKpCwnKnd62uHs4oOkfIz4OFbVNCNDvUdBMYbRkJd8yDYHeSzbEFElSSSxBRtwMnfX1DJ21myNtI0AGzQMP27NYkroHQGLmbbHiLeWuFly8yuEmeeustdtQBwf6qMTcJeCXtAkzgTUDFYLsu3zBCZQN9wJt/OCBPrGbwn5cutaUMmn9RGEeUgqNYxzvKEwmF+1/QINAD3PZjk3byfh0u1LRYnppvQrfsg24wh5dtlTRzPfuPxtrWdKTxkPm3gLvqdJmvw== tijmen.brommet@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-tijmenbrommet.pp\n# Target line: 6\n\n      1: # Creates the tijmenbrommet user\n      2: class users::tijmenbrommet {\n      3:   govuk_user { 'tijmenbrommet':\n      4:     fullname => 'Tijmen Brommet',\n      5:     email    => 'tijmen.brommet@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChxDnHtmrP+8wTqONV76/sHMAVkJeyeMs/yDNl4+bumjWum9+ZqKGTS6QvvZGh/rTKg5934ncv5xPv910NmisYW6SetjT4hWMZuqtnZKdLBN2YpSyqTjIWK0kpdKMS1linkeE5/6X38Ebi3UKP63VqTsDM7o4W2v/CshoIbC5+UKt7WjtcMsrijpul1leSw8gvwCtoq6z5N3vLqECTcv5/AoH+LxWDW/TYlywGqUD4Lfa1jJGf+D5ICK+StQMQ1RBU4ICby43htus+RR+NqMyDnQLkGdrVVT+/Tc2jQrj0wz78nVvJPULiG889NvgPrjXn1s9w45DuVl7i3a4c+X8yFGg6hcgW8pHcH+2sOPC5g1Y84ZARLj6yIr1ezdr6H5vSLiUBTauYuTOP3u2F5h1MKLHdXuhUKaV4jIj42jKpCwnKnd62uHs4oOkfIz4OFbVNCNDvUdBMYbRkJd8yDYHeSzbEFElSSSxBRtwMnfX1DJ21myNtI0AGzQMP27NYkroHQGLmbbHiLeWuFly8yuEmeeustdtQBwf6qMTcJeCXtAkzgTUDFYLsu3zBCZQN9wJt/OCBPrGbwn5cutaUMmn9RGEeUgqNYxzvKEwmF+1/QINAD3PZjk3byfh0u1LRYnppvQrfsg24wh5dtlTRzPfuPxtrWdKTxkPm3gLvqdJmvw== tijmen.brommet@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-init.pp", "content": "$manage_user         = true,", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-init.pp\n\n$user                = $::tomcat::params::user,\n$group               = $::tomcat::params::group,\n$install_from_source = true,\n$purge_connectors    = false,\n$purge_realms        = false,\n37:   $manage_user         = true,\n$manage_group        = true,\n$manage_home         = true,\n$manage_base         = true,\n$manage_properties   = true,\n) inherits ::tomcat::params {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-init.pp\n# Target line: 37\n\n     32:   $user                = $::tomcat::params::user,\n     33:   $group               = $::tomcat::params::group,\n     34:   $install_from_source = true,\n     35:   $purge_connectors    = false,\n     36:   $purge_realms        = false,\n>>>  37:   $manage_user         = true,\n     38:   $manage_group        = true,\n     39:   $manage_home         = true,\n     40:   $manage_base         = true,\n     41:   $manage_properties   = true,\n     42: ) inherits ::tomcat::params {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp", "content": "key    => 'wvous-tl-corner',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n\n# 10: Put display to sleep\n# 11: Launchpad\nboxen::osx_defaults { 'Top left screen corner \u2192 Application windows':\nuser   => $::luser,\ndomain => 'com.apple.dock',\n40:     key    => 'wvous-tl-corner',\ntype   => 'int',\nvalue  => 3,\n}\nboxen::osx_defaults { 'Top left screen corner \u2192 Modifier':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n# Target line: 40\n\n     35:   # 10: Put display to sleep\n     36:   # 11: Launchpad\n     37:   boxen::osx_defaults { 'Top left screen corner \u2192 Application windows':\n     38:     user   => $::luser,\n     39:     domain => 'com.apple.dock',\n>>>  40:     key    => 'wvous-tl-corner',\n     41:     type   => 'int',\n     42:     value  => 3,\n     43:   }\n     44:   boxen::osx_defaults { 'Top left screen corner \u2192 Modifier':\n     45:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n'curl', default: {\n$http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n$http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n$http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n$ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n}\n'wget': {\n$http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n$http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n$http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 58\n\n     53:     'curl', default: {\n     54:       $http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n     55:       $http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n     56:       $http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n     57:       $ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n>>>  58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n     59:     }\n     60:     'wget': {\n     61:       $http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n     62:       $http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n     63:       $http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-db-mysql.pp", "content": "$user          = 'neutron',", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-db-mysql.pp\n\n#   Defaults to 'utf8_general_ci'\n#\nclass neutron::db::mysql (\n$password,\n$dbname        = 'neutron',\n36:   $user          = 'neutron',\n$host          = '127.0.0.1',\n$allowed_hosts = undef,\n$charset       = 'utf8',\n$collate       = 'utf8_general_ci',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-db-mysql.pp\n# Target line: 36\n\n     31: #   Defaults to 'utf8_general_ci'\n     32: #\n     33: class neutron::db::mysql (\n     34:   $password,\n     35:   $dbname        = 'neutron',\n>>>  36:   $user          = 'neutron',\n     37:   $host          = '127.0.0.1',\n     38:   $allowed_hosts = undef,\n     39:   $charset       = 'utf8',\n     40:   $collate       = 'utf8_general_ci',\n     41: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-radosgw_keystone.pp", "content": "configure_user      => false,", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-radosgw_keystone.pp\n\nadmin_url           => $admin_url,\ninternal_url        => $internal_url,\n}->\n\nkeystone::resource::service_identity { 'radosgw_s3':\n45:     configure_user      => false,\nconfigure_user_role => false,\nservice_type        => 's3',\nservice_description => 'Openstack Object-Store Service',\nservice_name        => 'swift_s3',\nregion              => $region,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-radosgw_keystone.pp\n# Target line: 45\n\n     40:     admin_url           => $admin_url,\n     41:     internal_url        => $internal_url,\n     42:   }->\n     43: \n     44:   keystone::resource::service_identity { 'radosgw_s3':\n>>>  45:     configure_user      => false,\n     46:     configure_user_role => false,\n     47:     service_type        => 's3',\n     48:     service_description => 'Openstack Object-Store Service',\n     49:     service_name        => 'swift_s3',\n     50:     region              => $region,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph_nova_compute.pp", "content": "$user                = 'compute',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph_nova_compute.pp\n\n# configure the nova_compute parts if present\nclass osnailyfacter::ceph_nova_compute (\n$rbd_secret_uuid     = 'a5d0dd94-57c4-ae55-ffe0-7e3732a24455',\n4:   $user                = 'compute',\n$compute_pool        = 'compute',\n$secret_xml          = '/root/.secret_attrs.xml',\n$libvirt_images_type = 'rbd',\n) {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph_nova_compute.pp\n# Target line: 4\n\n      1: # configure the nova_compute parts if present\n      2: class osnailyfacter::ceph_nova_compute (\n      3:   $rbd_secret_uuid     = 'a5d0dd94-57c4-ae55-ffe0-7e3732a24455',\n>>>   4:   $user                = 'compute',\n      5:   $compute_pool        = 'compute',\n      6:   $secret_xml          = '/root/.secret_attrs.xml',\n      7:   $libvirt_images_type = 'rbd',\n      8: ) {\n      9: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-hpelefthand.pp", "content": "$cinder_hpelefthand_username           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_username', undef),", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-hpelefthand.pp\n\n#   Defaults to hiera('step')\n#\nclass tripleo::profile::base::cinder::volume::hpelefthand (\n$backend_name                          = hiera('cinder::backend::hpelefthand_iscsi::volume_backend_name', 'tripleo_hpelefthand'),\n$backend_availability_zone             = hiera('cinder::backend::hpelefthand_iscsi::backend_availability_zone', undef),\n55:   $cinder_hpelefthand_username           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_username', undef),\n$cinder_hpelefthand_password           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_password', undef),\n$cinder_hpelefthand_clustername        = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_clustername', undef),\n$cinder_hpelefthand_api_url            = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_api_url', undef),\n$cinder_hpelefthand_iscsi_chap_enabled = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_iscsi_chap_enabled', undef),\n$cinder_hpelefthand_debug              = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_debug', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-hpelefthand.pp\n# Target line: 55\n\n     50: #   Defaults to hiera('step')\n     51: #\n     52: class tripleo::profile::base::cinder::volume::hpelefthand (\n     53:   $backend_name                          = hiera('cinder::backend::hpelefthand_iscsi::volume_backend_name', 'tripleo_hpelefthand'),\n     54:   $backend_availability_zone             = hiera('cinder::backend::hpelefthand_iscsi::backend_availability_zone', undef),\n>>>  55:   $cinder_hpelefthand_username           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_username', undef),\n     56:   $cinder_hpelefthand_password           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_password', undef),\n     57:   $cinder_hpelefthand_clustername        = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_clustername', undef),\n     58:   $cinder_hpelefthand_api_url            = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_api_url', undef),\n     59:   $cinder_hpelefthand_iscsi_chap_enabled = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_iscsi_chap_enabled', undef),\n     60:   $cinder_hpelefthand_debug              = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_debug', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-apt-manifests-debian-testing.pp", "content": "key_server        => 'subkeys.pgp.net',", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apt-manifests-debian-testing.pp\n\nlocation          => 'http://debian.mirror.iweb.ca/debian/',\nrelease           => 'testing',\nrepos             => 'main contrib non-free',\nrequired_packages => 'debian-keyring debian-archive-keyring',\nkey               => '46925553',\n18:     key_server        => 'subkeys.pgp.net',\npin               => '-10',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apt-manifests-debian-testing.pp\n# Target line: 18\n\n     13:     location          => 'http://debian.mirror.iweb.ca/debian/',\n     14:     release           => 'testing',\n     15:     repos             => 'main contrib non-free',\n     16:     required_packages => 'debian-keyring debian-archive-keyring',\n     17:     key               => '46925553',\n>>>  18:     key_server        => 'subkeys.pgp.net',\n     19:     pin               => '-10',\n     20:   }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker.pp", "content": "$amqp_pass = 'guest',", "line": 44, "detection_span": [39, 49], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker.pp\n\nclass govuk::apps::govuk_crawler_worker (\n$airbrake_api_key = '',\n$airbrake_endpoint = '',\n$airbrake_env = '',\n$amqp_host = 'localhost',\n44:   $amqp_pass = 'guest',\n$blacklist_paths = [],\n$enabled   = false,\n$mirror_root = '/mnt/crawler_worker',\n$port = '3074',\n$root_urls = [],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker.pp\n# Target line: 44\n\n     39: class govuk::apps::govuk_crawler_worker (\n     40:   $airbrake_api_key = '',\n     41:   $airbrake_endpoint = '',\n     42:   $airbrake_env = '',\n     43:   $amqp_host = 'localhost',\n>>>  44:   $amqp_pass = 'guest',\n     45:   $blacklist_paths = [],\n     46:   $enabled   = false,\n     47:   $mirror_root = '/mnt/crawler_worker',\n     48:   $port = '3074',\n     49:   $root_urls = [],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp", "content": "$amqp_user  = 'content_data_api',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n\n#   The RabbitMQ queue to set up for workers of this type to read from\n#   for bulk importer of content into the Content Data API\n#   (default: 'content_data_api_govuk_importer')\n#\nclass govuk::apps::content_data_api::rabbitmq (\n30:   $amqp_user  = 'content_data_api',\n$amqp_pass = undef,\n$amqp_exchange = 'published_documents',\n$amqp_queue = 'content_data_api',\n$amqp_bulk_importing_queue = 'content_data_api_govuk_importer'\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n# Target line: 30\n\n     25: #   The RabbitMQ queue to set up for workers of this type to read from\n     26: #   for bulk importer of content into the Content Data API\n     27: #   (default: 'content_data_api_govuk_importer')\n     28: #\n     29: class govuk::apps::content_data_api::rabbitmq (\n>>>  30:   $amqp_user  = 'content_data_api',\n     31:   $amqp_pass = undef,\n     32:   $amqp_exchange = 'published_documents',\n     33:   $amqp_queue = 'content_data_api',\n     34:   $amqp_bulk_importing_queue = 'content_data_api_govuk_importer'\n     35: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$nodetree = {", "line": 98, "detection_span": [93, 103], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n98: $nodetree = {\n'annex1.example.com' => {\n100: \t\t'ip' => '172.16.1.81',\n101: \t\t'uuid' => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n102: \t\t'bricks' => {\n103: \t\t\t'/mnt/storage1a' => $brick1a,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 98\n\n     93: \txfs_inode64 => true,\n     94: \txfs_nobarrier => true,\n     95: \tareyousure => true,\n     96: }\n     97: \n>>>  98: $nodetree = {\n     99: \t'annex1.example.com' => {\n    100: \t\t'ip' => '172.16.1.81',\n    101: \t\t'uuid' => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n    102: \t\t'bricks' => {\n    103: \t\t\t'/mnt/storage1a' => $brick1a,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-network-contrail-database.pp", "content": "$admin_password       = hiera('contrail::admin_password'),", "line": 107, "detection_span": [102, 112], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-database.pp\n\n102: #  (optional) Zookeeper ip list\n103: #  Array of string (IPv4) values\n104: #  Defaults to hiera('contrail_database_node_ips')\n105: #\n106: class tripleo::network::contrail::database(\n107:   $admin_password       = hiera('contrail::admin_password'),\n108:   $admin_tenant_name    = hiera('contrail::admin_tenant_name'),\n$admin_token          = hiera('contrail::admin_token'),\n$admin_user           = hiera('contrail::admin_user'),\n$api_server           = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n$api_port             = hiera('contrail::api_port'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-database.pp\n# Target line: 107\n\n    102: #  (optional) Zookeeper ip list\n    103: #  Array of string (IPv4) values\n    104: #  Defaults to hiera('contrail_database_node_ips')\n    105: #\n    106: class tripleo::network::contrail::database(\n>>> 107:   $admin_password       = hiera('contrail::admin_password'),\n    108:   $admin_tenant_name    = hiera('contrail::admin_tenant_name'),\n    109:   $admin_token          = hiera('contrail::admin_token'),\n    110:   $admin_user           = hiera('contrail::admin_user'),\n    111:   $api_server           = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n    112:   $api_port             = hiera('contrail::api_port'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "biemond@biemond-wildfly-manifests-init.pp", "content": "Boolean $manage_user                                        = true,", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: biemond@biemond-wildfly-manifests-init.pp\n\nStdlib::Unixpath $dirname                                   = '/opt/wildfly',\nStdlib::Unixpath $java_home                                 = '/usr/java/default',\nStdlib::Unixpath $console_log                               = '/var/log/wildfly/console.log',\nStdlib::Unixpath $install_cache_dir                         = '/var/cache/wget',\nStdlib::Unixpath $deploy_cache_dir                          = '/opt',\n64:   Boolean $manage_user                                        = true,\nString $user                                                = 'wildfly',\nStdlib::Unixpath $user_home                                 = '/home/wildfly',\nString $group                                               = 'wildfly',\nString $mode_template                                       = \"wildfly/${mode}.conf\",\nWildfly::Config_file $config                                = 'standalone.xml',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-wildfly-manifests-init.pp\n# Target line: 64\n\n     59:   Stdlib::Unixpath $dirname                                   = '/opt/wildfly',\n     60:   Stdlib::Unixpath $java_home                                 = '/usr/java/default',\n     61:   Stdlib::Unixpath $console_log                               = '/var/log/wildfly/console.log',\n     62:   Stdlib::Unixpath $install_cache_dir                         = '/var/cache/wget',\n     63:   Stdlib::Unixpath $deploy_cache_dir                          = '/opt',\n>>>  64:   Boolean $manage_user                                        = true,\n     65:   String $user                                                = 'wildfly',\n     66:   Stdlib::Unixpath $user_home                                 = '/home/wildfly',\n     67:   String $group                                               = 'wildfly',\n     68:   String $mode_template                                       = \"wildfly/${mode}.conf\",\n     69:   Wildfly::Config_file $config                                = 'standalone.xml',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-dock-2d.pp", "content": "key    => 'no-glass',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: boxen@puppet-osx-manifests-dock-2d.pp\n\nclass osx::dock::2d {\ninclude osx::dock\n\nboxen::osx_defaults { 'Use a flat, 2d style for the Dock':\nuser   => $::boxen_user,\n7:     key    => 'no-glass',\ndomain => 'com.apple.dock',\nvalue  => true,\nnotify => Exec['killall Dock'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-dock-2d.pp\n# Target line: 7\n\n      2: class osx::dock::2d {\n      3:   include osx::dock\n      4: \n      5:   boxen::osx_defaults { 'Use a flat, 2d style for the Dock':\n      6:     user   => $::boxen_user,\n>>>   7:     key    => 'no-glass',\n      8:     domain => 'com.apple.dock',\n      9:     value  => true,\n     10:     notify => Exec['killall Dock'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-db-online_data_migrations.pp", "content": "user        => 'ironic',", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-db-online_data_migrations.pp\n\ninclude ::ironic::params\n\nexec { 'ironic-db-online-data-migrations':\ncommand     => \"${::ironic::params::dbsync_command} ${extra_params} online_data_migrations ${migration_params}\",\npath        => '/usr/bin',\n28:     user        => 'ironic',\nrefreshonly => true,\ntry_sleep   => 5,\ntries       => 10,\nlogoutput   => on_failure,\nsubscribe   => [", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-db-online_data_migrations.pp\n# Target line: 28\n\n     23:   include ::ironic::params\n     24: \n     25:   exec { 'ironic-db-online-data-migrations':\n     26:     command     => \"${::ironic::params::dbsync_command} ${extra_params} online_data_migrations ${migration_params}\",\n     27:     path        => '/usr/bin',\n>>>  28:     user        => 'ironic',\n     29:     refreshonly => true,\n     30:     try_sleep   => 5,\n     31:     tries       => 10,\n     32:     logoutput   => on_failure,\n     33:     subscribe   => [\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$brick2c = {", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n48: $brick2c = {\ndev => '/dev/disk/by-id/scsi-36003048007df450014ca280e1bda8e70',\t# /dev/sdd\nlabeltype => 'gpt',\nfstype => 'xfs',\nfsuuid => '2c434d6c-7800-4eec-9121-483bee2336f6',\nxfs_inode64 => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 48\n\n     43: \txfs_inode64 => true,\n     44: \txfs_nobarrier => true,\n     45: \tareyousure => true,\n     46: }\n     47: \n>>>  48: $brick2c = {\n     49: \tdev => '/dev/disk/by-id/scsi-36003048007df450014ca280e1bda8e70',\t# /dev/sdd\n     50: \tlabeltype => 'gpt',\n     51: \tfstype => 'xfs',\n     52: \tfsuuid => '2c434d6c-7800-4eec-9121-483bee2336f6',\n     53: \txfs_inode64 => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp", "content": "$nginx_ssl_kibana_certificate  = undef,", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n\n$logstash_ssl_certificate      = undef,\n$logstash_ssl_key              = undef,\n# /FIXME.\n$nginx_ssl_elastic_certificate = undef,\n$nginx_ssl_elastic_key         = undef,\n18:   $nginx_ssl_kibana_certificate  = undef,\n$nginx_ssl_kibana_key          = undef,\n) { }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n# Target line: 18\n\n     13:   $logstash_ssl_certificate      = undef,\n     14:   $logstash_ssl_key              = undef,\n     15:   # /FIXME.\n     16:   $nginx_ssl_elastic_certificate = undef,\n     17:   $nginx_ssl_elastic_key         = undef,\n>>>  18:   $nginx_ssl_kibana_certificate  = undef,\n     19:   $nginx_ssl_kibana_key          = undef,\n     20:   ) { }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puphpet@puppet-puphpet-manifests-params.pp", "content": "$ssh_username      = pick(getvar('::ssh_username'), 'root')", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: puphpet@puppet-puphpet-manifests-params.pp\n\n$extra_config_files = []\n) {\n\n$puphpet_core_dir  = pick(getvar('::puphpet_core_dir'), '/opt/puphpet')\n$puphpet_state_dir = pick(getvar('::puphpet_state_dir'), '/opt/puphpet-state')\n7:   $ssh_username      = pick(getvar('::ssh_username'), 'root')\n$provisioner_type  = pick(getvar('::provisioner_type'), 'remote')\n\n$puphpet_manifest_dir = \"${puphpet_core_dir}/puppet/modules/puphpet\"\n\n$base_configs = [", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puphpet@puppet-puphpet-manifests-params.pp\n# Target line: 7\n\n      2:   $extra_config_files = []\n      3: ) {\n      4: \n      5:   $puphpet_core_dir  = pick(getvar('::puphpet_core_dir'), '/opt/puphpet')\n      6:   $puphpet_state_dir = pick(getvar('::puphpet_state_dir'), '/opt/puphpet-state')\n>>>   7:   $ssh_username      = pick(getvar('::ssh_username'), 'root')\n      8:   $provisioner_type  = pick(getvar('::provisioner_type'), 'remote')\n      9: \n     10:   $puphpet_manifest_dir = \"${puphpet_core_dir}/puppet/modules/puphpet\"\n     11: \n     12:   $base_configs = [\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-glance.pp", "content": "swift_store_key                     => 'a_big_secret',", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-glance.pp\n\n}\n'swift': {\n$backend_store = ['swift']\nclass { '::glance::backend::swift':\nswift_store_user                    => 'services:glance',\n70:         swift_store_key                     => 'a_big_secret',\nswift_store_create_container_on_put => 'True',\nswift_store_auth_address            => \"${::openstack_integration::config::keystone_auth_uri}/v3\",\nswift_store_auth_version            => '3',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-glance.pp\n# Target line: 70\n\n     65:     }\n     66:     'swift': {\n     67:       $backend_store = ['swift']\n     68:       class { '::glance::backend::swift':\n     69:         swift_store_user                    => 'services:glance',\n>>>  70:         swift_store_key                     => 'a_big_secret',\n     71:         swift_store_create_container_on_put => 'True',\n     72:         swift_store_auth_address            => \"${::openstack_integration::config::keystone_auth_uri}/v3\",\n     73:         swift_store_auth_version            => '3',\n     74:       }\n     75:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-params.pp", "content": "$gitlab_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n\n$gitlab_email_display_name= 'GitLab'\n$gitlab_support_email     = 'support@localhost'\n$gitlab_ssl               = false\n$gitlab_ssl_protocols     = 'TLSv1.2 TLSv1.1 TLSv1'\n$gitlab_ssl_ciphers       = 'AES:HIGH:!aNULL:!RC4:!MD5:!ADH:!MDF'\n64:   $gitlab_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n$gitlab_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$gitlab_ssl_self_signed   = false\n$gitlab_projects          = '10'\n$gitlab_username_change   = true\n$gitlab_unicorn_listen    = '127.0.0.1'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n# Target line: 64\n\n     59:   $gitlab_email_display_name= 'GitLab'\n     60:   $gitlab_support_email     = 'support@localhost'\n     61:   $gitlab_ssl               = false\n     62:   $gitlab_ssl_protocols     = 'TLSv1.2 TLSv1.1 TLSv1'\n     63:   $gitlab_ssl_ciphers       = 'AES:HIGH:!aNULL:!RC4:!MD5:!ADH:!MDF'\n>>>  64:   $gitlab_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n     65:   $gitlab_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     66:   $gitlab_ssl_self_signed   = false\n     67:   $gitlab_projects          = '10'\n     68:   $gitlab_username_change   = true\n     69:   $gitlab_unicorn_listen    = '127.0.0.1'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-apps-mirror_rubygems.pp", "content": "user        => 'rubygems',", "line": 103, "detection_span": [98, 108], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-apps-mirror_rubygems.pp\n\n\ncron { 'rubygems-mirror' :\nminute      => $cron_frequency,\ncommand     => 'flock -n /var/run/rubygems/mirror.lock timeout -k 2m 30m gem mirror 2>&1 | logger -t rubygems-mirror',\nenvironment => 'PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin',\n103:     user        => 'rubygems',\n104:   }\n105:\n106: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-apps-mirror_rubygems.pp\n# Target line: 103\n\n     98: \n     99:   cron { 'rubygems-mirror' :\n    100:     minute      => $cron_frequency,\n    101:     command     => 'flock -n /var/run/rubygems/mirror.lock timeout -k 2m 30m gem mirror 2>&1 | logger -t rubygems-mirror',\n    102:     environment => 'PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin',\n>>> 103:     user        => 'rubygems',\n    104:   }\n    105: \n    106: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_from_staging_to_aws.pp", "content": "$whitehall_mysql_password = undef,", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_from_staging_to_aws.pp\n\n$mysql_dst_root_pw = undef,\n$pg_src_env_sync_pw = undef,\n$pg_dst_env_sync_pw = undef,\n$pg_tr_dst_env_sync_pw = undef,\n$pg_tr_src_env_sync_pw = undef,\n12:   $whitehall_mysql_password = undef,\n$app_domain = hiera('app_domain'),\n) {\n$check_name = 'copy_data_from_staging_to_aws'\n$service_description = 'Copy Data from Production to Aws'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_from_staging_to_aws.pp\n# Target line: 12\n\n      7:   $mysql_dst_root_pw = undef,\n      8:   $pg_src_env_sync_pw = undef,\n      9:   $pg_dst_env_sync_pw = undef,\n     10:   $pg_tr_dst_env_sync_pw = undef,\n     11:   $pg_tr_src_env_sync_pw = undef,\n>>>  12:   $whitehall_mysql_password = undef,\n     13:   $app_domain = hiera('app_domain'),\n     14: ) {\n     15:   $check_name = 'copy_data_from_staging_to_aws'\n     16:   $service_description = 'Copy Data from Production to Aws'\n     17: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp", "content": "$ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n\n$swarm_password = ''\n$swarm_package = 'jenkins-swarm-slave'\n$swarm_service = 'jenkins-swarm-slave'\n\n$ssl_cert_file = '/etc/ssl/jenkins.crt'\n32:   $ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\nMIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\nVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\ncyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\nMDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT\nb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQxGjAY", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n# Target line: 32\n\n     27:   $swarm_password = ''\n     28:   $swarm_package = 'jenkins-swarm-slave'\n     29:   $swarm_service = 'jenkins-swarm-slave'\n     30: \n     31:   $ssl_cert_file = '/etc/ssl/jenkins.crt'\n>>>  32:   $ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\n     33: MIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\n     34: VTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\n     35: cyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\n     36: MDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT\n     37: b21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQxGjAY\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "password => 'whitehall',", "line": 99, "detection_span": [94, 104], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\n'whitehall_test14',\n'whitehall_test15',\n'whitehall_test16',\n]:\nuser     => 'whitehall',\n99:       password => 'whitehall',\ngrant    => ['ALL'],\nrequire  => Class['::mysql::server'];\n102:   }\n103: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 99\n\n     94:       'whitehall_test14',\n     95:       'whitehall_test15',\n     96:       'whitehall_test16',\n     97:     ]:\n     98:       user     => 'whitehall',\n>>>  99:       password => 'whitehall',\n    100:       grant    => ['ALL'],\n    101:       require  => Class['::mysql::server'];\n    102:   }\n    103: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'stable',\nkey      => 'D88E42B4';\n'elasticsearch-1.5':\nlocation => 'http://packages.elastic.co/elasticsearch/1.5/debian',\nrelease  => 'stable',\n56:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n'elasticsearch-1.7':\nlocation => 'http://packages.elastic.co/elasticsearch/1.7/debian',\nrelease  => 'stable',\nkey      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n'elasticsearch-2.x':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 56\n\n     51:       release  => 'stable',\n     52:       key      => 'D88E42B4';\n     53:     'elasticsearch-1.5':\n     54:       location => 'http://packages.elastic.co/elasticsearch/1.5/debian',\n     55:       release  => 'stable',\n>>>  56:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n     57:     'elasticsearch-1.7':\n     58:       location => 'http://packages.elastic.co/elasticsearch/1.7/debian',\n     59:       release  => 'stable',\n     60:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n     61:     'elasticsearch-2.x':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-amqp.pp", "content": "ssl_fail_if_no_peer_cert => true,", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-amqp.pp\n\npackage_provider         => 'yum',\nrepos_ensure             => false,\nadmin_enable             => false,\nloopback_users           => [],\n# FIXME: it's ugly to not to require client certs\n33:       ssl_fail_if_no_peer_cert => true,\nconfig_variables         => {\n'tcp_listen_options' => '[binary,{packet, raw},{reuseaddr, true},{backlog, 128},{nodelay, true},{exit_on_close, false},{keepalive, true}]',\n},\n}\n} else {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-amqp.pp\n# Target line: 33\n\n     28:       package_provider         => 'yum',\n     29:       repos_ensure             => false,\n     30:       admin_enable             => false,\n     31:       loopback_users           => [],\n     32:       # FIXME: it's ugly to not to require client certs\n>>>  33:       ssl_fail_if_no_peer_cert => true,\n     34:       config_variables         => {\n     35:      'tcp_listen_options' => '[binary,{packet, raw},{reuseaddr, true},{backlog, 128},{nodelay, true},{exit_on_close, false},{keepalive, true}]',\n     36:       },\n     37:     }\n     38:   } else {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-certmonger-libvirt_dirs.pp", "content": "seluser => 'system_u',", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-certmonger-libvirt_dirs.pp\n\nif $key_dir {\nfile { $key_dir :\nensure  => 'directory',\nselrole => 'object_r',\nseltype => 'cert_t',\n55:       seluser => 'system_u',\n}\nFile[$key_dir] ~> Certmonger_certificate<| tag == 'libvirt-cert' |>\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-certmonger-libvirt_dirs.pp\n# Target line: 55\n\n     50:   if $key_dir {\n     51:     file { $key_dir :\n     52:       ensure  => 'directory',\n     53:       selrole => 'object_r',\n     54:       seltype => 'cert_t',\n>>>  55:       seluser => 'system_u',\n     56:     }\n     57:     File[$key_dir] ~> Certmonger_certificate<| tag == 'libvirt-cert' |>\n     58:   }\n     59: \n     60: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bd808@my-boxen-modules-people-manifests-bd808-osx_settings.pp", "content": "key => 'mcx-disabled',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: bd808@my-boxen-modules-people-manifests-bd808-osx_settings.pp\n\n}\nclass { 'osx::appearance::sidebar_icons': size => 'small' }\n\nboxen::osx_defaults { 'Disable dashboard':\nuser => $::boxen_user,\n17:     key => 'mcx-disabled',\ndomain => 'com.apple.dashboard',\nvalue => true,\n}\n\nclass { 'osx::desktop::displayed_items':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bd808@my-boxen-modules-people-manifests-bd808-osx_settings.pp\n# Target line: 17\n\n     12:   }\n     13:   class { 'osx::appearance::sidebar_icons': size => 'small' }\n     14: \n     15:   boxen::osx_defaults { 'Disable dashboard':\n     16:     user => $::boxen_user,\n>>>  17:     key => 'mcx-disabled',\n     18:     domain => 'com.apple.dashboard',\n     19:     value => true,\n     20:   }\n     21: \n     22:   class { 'osx::desktop::displayed_items':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-aodh.pp", "content": "$oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),", "line": 91, "detection_span": [86, 96], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n\n$oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n$oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n$oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n$oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n$oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n91:   $oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n$oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n) {\n\nif $::hostname == downcase($bootstrap_node) {\n$sync_db = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n# Target line: 91\n\n     86:   $oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     87:   $oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n     88:   $oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n     89:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n     90:   $oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n>>>  91:   $oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n     92:   $oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n     93: ) {\n     94: \n     95:   if $::hostname == downcase($bootstrap_node) {\n     96:     $sync_db = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp", "content": "password     => hiera('CONFIG_GNOCCHI_KS_PW'),", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n\n{\n$gnocchi_keystone_host_url = hiera('CONFIG_KEYSTONE_HOST_URL')\n\nclass { '::gnocchi::keystone::auth':\nregion       => hiera('CONFIG_KEYSTONE_REGION'),\n7:       password     => hiera('CONFIG_GNOCCHI_KS_PW'),\npublic_url   => \"http://${gnocchi_keystone_host_url}:8041\",\nadmin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\ninternal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n# Target line: 7\n\n      2: {\n      3:     $gnocchi_keystone_host_url = hiera('CONFIG_KEYSTONE_HOST_URL')\n      4: \n      5:     class { '::gnocchi::keystone::auth':\n      6:       region       => hiera('CONFIG_KEYSTONE_REGION'),\n>>>   7:       password     => hiera('CONFIG_GNOCCHI_KS_PW'),\n      8:       public_url   => \"http://${gnocchi_keystone_host_url}:8041\",\n      9:       admin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\n     10:       internal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n     11:     }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp", "content": "jenkins_username            => hiera('jenkins_username', 'jenkins'),", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n\nvhost_name                  => $vhost_name,\nproject_config_repo         => hiera('project_config_repo'),\nserveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\njenkins_version             => hiera('jenkins_version', 'present'),\njenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\n37:     jenkins_username            => hiera('jenkins_username', 'jenkins'),\njenkins_password            => hiera('jenkins_password', 'XXX'),\njenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\njenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\njava_args_override          => hiera('java_args_override', undef),\ngerrit_server               => hiera('gerrit_server', 'review.openstack.org'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n# Target line: 37\n\n     32:     vhost_name                  => $vhost_name,\n     33:     project_config_repo         => hiera('project_config_repo'),\n     34:     serveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\n     35:     jenkins_version             => hiera('jenkins_version', 'present'),\n     36:     jenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\n>>>  37:     jenkins_username            => hiera('jenkins_username', 'jenkins'),\n     38:     jenkins_password            => hiera('jenkins_password', 'XXX'),\n     39:     jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\n     40:     jenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\n     41:     java_args_override          => hiera('java_args_override', undef),\n     42:     gerrit_server               => hiera('gerrit_server', 'review.openstack.org'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp", "content": "$sahara_user     = pick($sahara_hash['user'], 'sahara')", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n\n$sahara_hash     = hiera_hash('sahara', {})\n$public_ssl_hash = hiera_hash('public_ssl')\n$public_vip      = hiera('public_vip')\n$admin_address   = hiera('management_vip')\n$api_bind_port   = '8386'\n10:   $sahara_user     = pick($sahara_hash['user'], 'sahara')\n$sahara_password = pick($sahara_hash['user_password'])\n$tenant          = pick($sahara_hash['tenant'], 'services')\n$region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n$service_name    = pick($sahara_hash['service_name'], 'sahara')\n$public_address = $public_ssl_hash['services'] ? {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n# Target line: 10\n\n      5:   $sahara_hash     = hiera_hash('sahara', {})\n      6:   $public_ssl_hash = hiera_hash('public_ssl')\n      7:   $public_vip      = hiera('public_vip')\n      8:   $admin_address   = hiera('management_vip')\n      9:   $api_bind_port   = '8386'\n>>>  10:   $sahara_user     = pick($sahara_hash['user'], 'sahara')\n     11:   $sahara_password = pick($sahara_hash['user_password'])\n     12:   $tenant          = pick($sahara_hash['tenant'], 'services')\n     13:   $region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n     14:   $service_name    = pick($sahara_hash['service_name'], 'sahara')\n     15:   $public_address = $public_ssl_hash['services'] ? {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp", "content": "routing_key   => '*.links',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_to_be_indexed':\nensure        => $toggled_ensure,\namqp_exchange => $amqp_exchange,\namqp_queue    => 'rummager_to_be_indexed',\n40:     routing_key   => '*.links',\ndurable       => true,\n}\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\nensure        => $toggled_ensure,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n# Target line: 40\n\n     35: \n     36:   govuk_rabbitmq::queue_with_binding { 'rummager_to_be_indexed':\n     37:     ensure        => $toggled_ensure,\n     38:     amqp_exchange => $amqp_exchange,\n     39:     amqp_queue    => 'rummager_to_be_indexed',\n>>>  40:     routing_key   => '*.links',\n     41:     durable       => true,\n     42:   }\n     43: \n     44:   govuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\n     45:     ensure        => $toggled_ensure,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-kafka-manifests-params.pp", "content": "$user           = 'kafka'", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: voxpupuli@puppet-kafka-manifests-params.pp\n\n$proxy_server   = undef\n$proxy_host     = undef\n$proxy_port     = undef\n$proxy_type     = undef\n$package_ensure = 'present'\n33:   $user           = 'kafka'\n$group          = 'kafka'\n$user_id        = undef\n$group_id       = undef\n$system_user    = false\n$system_group   = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-kafka-manifests-params.pp\n# Target line: 33\n\n     28:   $proxy_server   = undef\n     29:   $proxy_host     = undef\n     30:   $proxy_port     = undef\n     31:   $proxy_type     = undef\n     32:   $package_ensure = 'present'\n>>>  33:   $user           = 'kafka'\n     34:   $group          = 'kafka'\n     35:   $user_id        = undef\n     36:   $group_id       = undef\n     37:   $system_user    = false\n     38:   $system_group   = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-keystone.pp", "content": "$configure_user      = pick($ceilometer_hash['configure_user'], true)", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-keystone.pp\n\n\n$region              = pick($ceilometer_hash['region'], hiera('region', 'RegionOne'))\n$password            = $ceilometer_hash['user_password']\n$auth_name           = pick($ceilometer_hash['auth_name'], 'ceilometer')\n$configure_endpoint  = pick($ceilometer_hash['configure_endpoint'], true)\n26:   $configure_user      = pick($ceilometer_hash['configure_user'], true)\n$configure_user_role = pick($ceilometer_hash['configure_user_role'], true)\n$service_name        = pick($ceilometer_hash['service_name'], 'ceilometer')\n$tenant              = pick($ceilometer_hash['tenant'], 'services')\nvalidate_string($public_address)\nvalidate_string($password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-keystone.pp\n# Target line: 26\n\n     21: \n     22:   $region              = pick($ceilometer_hash['region'], hiera('region', 'RegionOne'))\n     23:   $password            = $ceilometer_hash['user_password']\n     24:   $auth_name           = pick($ceilometer_hash['auth_name'], 'ceilometer')\n     25:   $configure_endpoint  = pick($ceilometer_hash['configure_endpoint'], true)\n>>>  26:   $configure_user      = pick($ceilometer_hash['configure_user'], true)\n     27:   $configure_user_role = pick($ceilometer_hash['configure_user_role'], true)\n     28:   $service_name        = pick($ceilometer_hash['service_name'], 'ceilometer')\n     29:   $tenant              = pick($ceilometer_hash['tenant'], 'services')\n     30:   validate_string($public_address)\n     31:   validate_string($password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp", "content": "$rabbit_password            = 'rabbit_pw',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n\n$syslog_log_facility_cinder = 'LOG_LOCAL3',\n$debug                      = false,\n$verbose                    = true,\n# Rabbit details necessary for cinder\n$rabbit_nodes               = false,\n43:   $rabbit_password            = 'rabbit_pw',\n$rabbit_host                = false,\n$rabbit_user                = 'nova',\n$rabbit_ha_virtual_ip       = false,\n$queue_provider             = 'rabbitmq',\n$qpid_password              = 'qpid_pw',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n# Target line: 43\n\n     38:   $syslog_log_facility_cinder = 'LOG_LOCAL3',\n     39:   $debug                      = false,\n     40:   $verbose                    = true,\n     41:   # Rabbit details necessary for cinder\n     42:   $rabbit_nodes               = false,\n>>>  43:   $rabbit_password            = 'rabbit_pw',\n     44:   $rabbit_host                = false,\n     45:   $rabbit_user                = 'nova',\n     46:   $rabbit_ha_virtual_ip       = false,\n     47:   $queue_provider             = 'rabbitmq',\n     48:   $qpid_password              = 'qpid_pw',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "solarkennedy@puppet-consul-manifests-service.pp", "content": "$override_key = 'enable_tag_override'", "line": 88, "detection_span": [83, 93], "with_context": "# Puppet file: solarkennedy@puppet-consul-manifests-service.pp\n\ninclude consul\n\nconsul::validate_checks($checks)\n\nif versioncmp($consul::version, '1.0.0') >= 0 {\n88:     $override_key = 'enable_tag_override'\n} else {\n$override_key = 'enableTagOverride'\n}\n\n$default_config_hash = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: solarkennedy@puppet-consul-manifests-service.pp\n# Target line: 88\n\n     83:   include consul\n     84: \n     85:   consul::validate_checks($checks)\n     86: \n     87:   if versioncmp($consul::version, '1.0.0') >= 0 {\n>>>  88:     $override_key = 'enable_tag_override'\n     89:   } else {\n     90:     $override_key = 'enableTagOverride'\n     91:   }\n     92: \n     93:   $default_config_hash = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-ceph.pp", "content": "user                        => 'ceph',", "line": 123, "detection_span": [118, 128], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n\n118:\n#configure rgw to use keystone\nceph::rgw::keystone { 'radosgw.gateway':\nrgw_keystone_url            => $::openstack_integration::config::keystone_admin_uri,\nrgw_keystone_version        => 'v3',\n123:       user                        => 'ceph',\nuse_pki                     => false,\nrgw_keystone_accepted_roles => ['admin', 'member'],\nrgw_keystone_admin_domain   => $user_domain,\nrgw_keystone_admin_project  => $project,\nrgw_keystone_admin_user     => $auth_name,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n# Target line: 123\n\n    118: \n    119:     #configure rgw to use keystone\n    120:     ceph::rgw::keystone { 'radosgw.gateway':\n    121:       rgw_keystone_url            => $::openstack_integration::config::keystone_admin_uri,\n    122:       rgw_keystone_version        => 'v3',\n>>> 123:       user                        => 'ceph',\n    124:       use_pki                     => false,\n    125:       rgw_keystone_accepted_roles => ['admin', 'member'],\n    126:       rgw_keystone_admin_domain   => $user_domain,\n    127:       rgw_keystone_admin_project  => $project,\n    128:       rgw_keystone_admin_user     => $auth_name,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$certificate = undef, #: https certificate file", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n#\ndefine staging::file (\n$source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n$target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n$username    = undef, #: https or ftp username\n16:   $certificate = undef, #: https certificate file\n$password    = undef, #: https or ftp user password or https certificate password\n$environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n$timeout     = undef, #: the the time to wait for the file transfer to complete\n$curl_option = undef, #: options to pass to curl\n$wget_option = undef, #: options to pass to wget", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 16\n\n     11: #\n     12: define staging::file (\n     13:   $source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n     14:   $target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n     15:   $username    = undef, #: https or ftp username\n>>>  16:   $certificate = undef, #: https certificate file\n     17:   $password    = undef, #: https or ftp user password or https certificate password\n     18:   $environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n     19:   $timeout     = undef, #: the the time to wait for the file transfer to complete\n     20:   $curl_option = undef, #: options to pass to curl\n     21:   $wget_option = undef, #: options to pass to wget\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-erinrajstaniland.pp", "content": "ssh_key  => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMcNbnQbVVQAse1UUD8OD/HuKQJ2Divi6scGvNKfL4ai erin.raj-staniland@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-erinrajstaniland.pp\n\n# Creates erinrajstaniland user\nclass users::erinrajstaniland {\ngovuk_user { 'erinrajstaniland':\nfullname => 'Erin Raj-Staniland',\nemail    => 'erin.raj-staniland@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMcNbnQbVVQAse1UUD8OD/HuKQJ2Divi6scGvNKfL4ai erin.raj-staniland@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-erinrajstaniland.pp\n# Target line: 6\n\n      1: # Creates erinrajstaniland user\n      2: class users::erinrajstaniland {\n      3:   govuk_user { 'erinrajstaniland':\n      4:     fullname => 'Erin Raj-Staniland',\n      5:     email    => 'erin.raj-staniland@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMcNbnQbVVQAse1UUD8OD/HuKQJ2Divi6scGvNKfL4ai erin.raj-staniland@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-universal_access-ctrl_mod_zoom.pp", "content": "key    => 'HIDScrollZoomModifierMask',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: quintel@boxen-modules-osx-manifests-universal_access-ctrl_mod_zoom.pp\n\n# Public: Enables Ctrl-scroll to zoom.\nclass osx::universal_access::ctrl_mod_zoom {\nboxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) key to zoom':\nuser   => $::boxen_user,\ndomain => 'com.apple.universalaccess',\n6:     key    => 'HIDScrollZoomModifierMask',\nvalue  => 262144;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-osx-manifests-universal_access-ctrl_mod_zoom.pp\n# Target line: 6\n\n      1: # Public: Enables Ctrl-scroll to zoom.\n      2: class osx::universal_access::ctrl_mod_zoom {\n      3:   boxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) key to zoom':\n      4:     user   => $::boxen_user,\n      5:     domain => 'com.apple.universalaccess',\n>>>   6:     key    => 'HIDScrollZoomModifierMask',\n      7:     value  => 262144;\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_warehouse_db_admin.pp", "content": "key          => 'B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8',", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_warehouse_db_admin.pp\n\napt::source { 'postgresql':\nensure       => present,\nlocation     => \"http://${apt_mirror_hostname}/postgresql\",\nrelease      => \"${::lsbdistcodename}-pgdg\",\narchitecture => $::architecture,\n57:     key          => 'B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8',\n} ->\n\nclass { '::postgresql::server':\ndefault_connect_settings => $default_connect_settings,\n} ->", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_warehouse_db_admin.pp\n# Target line: 57\n\n     52:   apt::source { 'postgresql':\n     53:     ensure       => present,\n     54:     location     => \"http://${apt_mirror_hostname}/postgresql\",\n     55:     release      => \"${::lsbdistcodename}-pgdg\",\n     56:     architecture => $::architecture,\n>>>  57:     key          => 'B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8',\n     58:   } ->\n     59: \n     60:   class { '::postgresql::server':\n     61:     default_connect_settings => $default_connect_settings,\n     62:   } ->\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-bootstrap-manifests-params.pp", "content": "$docroot          = '/var/www'", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-params.pp\n\n# the following config variables should rarely be touched\n$source_path      = '/usr/src/installer/'\n$admin_user       = 'training'\n$ec2_lock_passwd  = true\n\n13:   $docroot          = '/var/www'\n$psk              = 'figaro'\n\n$courseware_cache = '/var/cache/showoff/courseware'\n$courseware_url   = 'git@github.com:puppet-training/courseware.git'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-params.pp\n# Target line: 13\n\n      8:   # the following config variables should rarely be touched\n      9:   $source_path      = '/usr/src/installer/'\n     10:   $admin_user       = 'training'\n     11:   $ec2_lock_passwd  = true\n     12: \n>>>  13:   $docroot          = '/var/www'\n     14:   $psk              = 'figaro'\n     15: \n     16:   $courseware_cache = '/var/cache/showoff/courseware'\n     17:   $courseware_url   = 'git@github.com:puppet-training/courseware.git'\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-transition-postgresql_db.pp", "content": "$password = '',", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-transition-postgresql_db.pp\n\n#\n# [*lb_ip_range*]\n#   Network range for the load balancer.\n#\nclass govuk::apps::transition::postgresql_db (\n20:   $password = '',\n$backend_ip_range = '10.3.0.0/16',\n$allow_auth_from_lb = false,\n$lb_ip_range = undef,\n$rds = false,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-transition-postgresql_db.pp\n# Target line: 20\n\n     15: #\n     16: # [*lb_ip_range*]\n     17: #   Network range for the load balancer.\n     18: #\n     19: class govuk::apps::transition::postgresql_db (\n>>>  20:   $password = '',\n     21:   $backend_ip_range = '10.3.0.0/16',\n     22:   $allow_auth_from_lb = false,\n     23:   $lb_ip_range = undef,\n     24:   $rds = false,\n     25: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus_creds.pp", "content": "$https_local_certificate = undef,", "line": 119, "detection_span": [114, 124], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus_creds.pp\n\n114:   $nve_src_intf = undef,\n$physnet      = undef,\n$vpc_pool     = undef,\n117:   $intfcfg_portchannel = undef,\n118:   $https_verify = undef,\n119:   $https_local_certificate = undef,\n120:\n121: ) {\n122:   include ::neutron::deps\n123:\n124:   ensure_resource('file', '/var/lib/neutron/.ssh',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus_creds.pp\n# Target line: 119\n\n    114:   $nve_src_intf = undef,\n    115:   $physnet      = undef,\n    116:   $vpc_pool     = undef,\n    117:   $intfcfg_portchannel = undef,\n    118:   $https_verify = undef,\n>>> 119:   $https_local_certificate = undef,\n    120: \n    121: ) {\n    122:   include ::neutron::deps\n    123: \n    124:   ensure_resource('file', '/var/lib/neutron/.ssh',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp", "content": "$default_ssl_cert     = '/etc/pki/tls/certs/localhost.crt'", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n\n$ports_file           = \"${conf_dir}/ports.conf\"\n$logroot              = '/var/log/httpd'\n$lib_path             = 'modules'\n$mpm_module           = 'prefork'\n$dev_packages         = 'httpd-devel'\n46:     $default_ssl_cert     = '/etc/pki/tls/certs/localhost.crt'\n$default_ssl_key      = '/etc/pki/tls/private/localhost.key'\n$ssl_certs_dir        = $distrelease ? {\n'5' => '/etc/pki/tls/certs',\n'6' => '/etc/ssl/certs',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n# Target line: 46\n\n     41:     $ports_file           = \"${conf_dir}/ports.conf\"\n     42:     $logroot              = '/var/log/httpd'\n     43:     $lib_path             = 'modules'\n     44:     $mpm_module           = 'prefork'\n     45:     $dev_packages         = 'httpd-devel'\n>>>  46:     $default_ssl_cert     = '/etc/pki/tls/certs/localhost.crt'\n     47:     $default_ssl_key      = '/etc/pki/tls/private/localhost.key'\n     48:     $ssl_certs_dir        = $distrelease ? {\n     49:       '5' => '/etc/pki/tls/certs',\n     50:       '6' => '/etc/ssl/certs',\n     51:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ceph-manifests-rgw-keystone.pp", "content": "$rgw_keystone_admin_token         = undef,", "line": 101, "detection_span": [96, 106], "with_context": "# Puppet file: openstack@puppet-ceph-manifests-rgw-keystone.pp\n\n$rgw_keystone_token_cache_size    = 500,\n$rgw_s3_auth_use_keystone         = true,\n$rgw_keystone_implicit_tenants    = true,\n## DEPRECATED PARAMS\n$rgw_keystone_version             = undef,\n101:   $rgw_keystone_admin_token         = undef,\n$use_pki                          = undef,\n103:   $rgw_keystone_revocation_interval = undef,\n$nss_db_path                      = undef,\n$user                             = undef,\n106: ) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ceph-manifests-rgw-keystone.pp\n# Target line: 101\n\n     96:   $rgw_keystone_token_cache_size    = 500,\n     97:   $rgw_s3_auth_use_keystone         = true,\n     98:   $rgw_keystone_implicit_tenants    = true,\n     99:   ## DEPRECATED PARAMS\n    100:   $rgw_keystone_version             = undef,\n>>> 101:   $rgw_keystone_admin_token         = undef,\n    102:   $use_pki                          = undef,\n    103:   $rgw_keystone_revocation_interval = undef,\n    104:   $nss_db_path                      = undef,\n    105:   $user                             = undef,\n    106: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-zaqar.pp", "content": "ssl_key   => \"/etc/zaqar/ssl/private/${::fqdn}.pem\",", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-zaqar.pp\n\ninclude ::apache\nclass { '::zaqar::wsgi::apache':\nbind_host => $::openstack_integration::config::ip_for_url,\nssl       => $::openstack_integration::config::ssl,\nssl_cert  => $::openstack_integration::params::cert_path,\n56:     ssl_key   => \"/etc/zaqar/ssl/private/${::fqdn}.pem\",\nworkers   => 2,\n}\ninclude ::zaqar::db::sync\n# run a second instance using websockets, the Debian system does\n# not support the use of services to run a second instance.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-zaqar.pp\n# Target line: 56\n\n     51:   include ::apache\n     52:   class { '::zaqar::wsgi::apache':\n     53:     bind_host => $::openstack_integration::config::ip_for_url,\n     54:     ssl       => $::openstack_integration::config::ssl,\n     55:     ssl_cert  => $::openstack_integration::params::cert_path,\n>>>  56:     ssl_key   => \"/etc/zaqar/ssl/private/${::fqdn}.pem\",\n     57:     workers   => 2,\n     58:   }\n     59:   include ::zaqar::db::sync\n     60:   # run a second instance using websockets, the Debian system does\n     61:   # not support the use of services to run a second instance.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-haproxy-stats.pp", "content": "$user        = 'admin'", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-haproxy-stats.pp\n\nclass tripleo::haproxy::stats (\n$haproxy_listen_bind_param,\n$ip,\n$password    = undef,\n$certificate = undef,\n48:   $user        = 'admin'\n) {\nif $certificate {\n$haproxy_stats_bind_opts = {\n\"${ip}:1993\" => union($haproxy_listen_bind_param, ['ssl', 'crt', $certificate]),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-haproxy-stats.pp\n# Target line: 48\n\n     43: class tripleo::haproxy::stats (\n     44:   $haproxy_listen_bind_param,\n     45:   $ip,\n     46:   $password    = undef,\n     47:   $certificate = undef,\n>>>  48:   $user        = 'admin'\n     49: ) {\n     50:   if $certificate {\n     51:     $haproxy_stats_bind_opts = {\n     52:       \"${ip}:1993\" => union($haproxy_listen_bind_param, ['ssl', 'crt', $certificate]),\n     53:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-ftp-vsftpd-manifests-params.pp", "content": "$nopriv_user             = 'nobody'", "line": 116, "detection_span": [111, 121], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-ftp-vsftpd-manifests-params.pp\n\n$listen_address          = ''\n$local_enable            = true\n$local_root              = ''\n$local_umask             = '022'\n$log_ftp_protocol        = false\n116:   $nopriv_user             = 'nobody'\n$pam_service_name        = 'vsftpd'\n$pasv_max_port           = 0\n$pasv_min_port           = 0\n$secure_chroot_dir       = $::osfamily ? {\n/Debian/ => '/var/run/vsftpd/empty',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-ftp-vsftpd-manifests-params.pp\n# Target line: 116\n\n    111:   $listen_address          = ''\n    112:   $local_enable            = true\n    113:   $local_root              = ''\n    114:   $local_umask             = '022'\n    115:   $log_ftp_protocol        = false\n>>> 116:   $nopriv_user             = 'nobody'\n    117:   $pam_service_name        = 'vsftpd'\n    118:   $pasv_max_port           = 0\n    119:   $pasv_min_port           = 0\n    120:   $secure_chroot_dir       = $::osfamily ? {\n    121:     /Debian/ => '/var/run/vsftpd/empty',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-link.pp", "content": "$username = '*',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-link.pp\n\n$hostname,\n$port,\n$password_connect,\n$password_receive,\n$password_receive_auth = undef,\n8:   $username = '*',\n$bind_ip = '*',\n$hub = undef,\n$leaf = undef,\n$leafdepth = undef,\n$linkclass = 'servers',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-link.pp\n# Target line: 8\n\n      3:   $hostname,\n      4:   $port,\n      5:   $password_connect,\n      6:   $password_receive,\n      7:   $password_receive_auth = undef,\n>>>   8:   $username = '*',\n      9:   $bind_ip = '*',\n     10:   $hub = undef,\n     11:   $leaf = undef,\n     12:   $leafdepth = undef,\n     13:   $linkclass = 'servers',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-ceilometer.pp", "content": "$auth_username = 'ceilometer'", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-ceilometer.pp\n\n$mongo_connection = join([ \"mongodb://ceilometer:\", $mongo_password, \"@\", join($database_ip_list,':27017,') ,\":27017/ceilometer?replicaSet=rs-ceilometer\" ],'')\n$auth_url = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n$auth_uri = \"http://${keystone_ip_to_use}:5000\"\n$auth_password = $ceilometer_password\n$auth_tenant_name = 'services'\n43:   $auth_username = 'ceilometer'\n$telemetry_secret = $metering_secret\nif ($internal_vip!='') {\n$coordination_url = join([\"kazoo://\", $database_ip_to_use, ':2181'])\nClass['::ceilometer']->\nceilometer_config {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-ceilometer.pp\n# Target line: 43\n\n     38:   $mongo_connection = join([ \"mongodb://ceilometer:\", $mongo_password, \"@\", join($database_ip_list,':27017,') ,\":27017/ceilometer?replicaSet=rs-ceilometer\" ],'')\n     39:   $auth_url = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n     40:   $auth_uri = \"http://${keystone_ip_to_use}:5000\"\n     41:   $auth_password = $ceilometer_password\n     42:   $auth_tenant_name = 'services'\n>>>  43:   $auth_username = 'ceilometer'\n     44:   $telemetry_secret = $metering_secret\n     45:   if ($internal_vip!='') {\n     46:     $coordination_url = join([\"kazoo://\", $database_ip_to_use, ':2181'])\n     47:     Class['::ceilometer']->\n     48:     ceilometer_config {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-glance-db.pp", "content": "$db_user     = pick($glance_hash['db_user'], 'glance')", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-glance-db.pp\n\n\n$mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n$mysql_db_create     = pick($mysql_hash['db_create'], true)\n$mysql_root_password = $mysql_hash['root_password']\n\n14:   $db_user     = pick($glance_hash['db_user'], 'glance')\n$db_name     = pick($glance_hash['db_name'], 'glance')\n$db_password = pick($glance_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($glance_hash['db_host'], $database_vip)\n$db_create        = pick($glance_hash['db_create'], $mysql_db_create)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-glance-db.pp\n# Target line: 14\n\n      9: \n     10:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     11:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     12:   $mysql_root_password = $mysql_hash['root_password']\n     13: \n>>>  14:   $db_user     = pick($glance_hash['db_user'], 'glance')\n     15:   $db_name     = pick($glance_hash['db_name'], 'glance')\n     16:   $db_password = pick($glance_hash['db_password'], $mysql_root_password)\n     17: \n     18:   $db_host          = pick($glance_hash['db_host'], $database_vip)\n     19:   $db_create        = pick($glance_hash['db_create'], $mysql_db_create)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp", "content": "$ssl_cert                    = hiera('public_ssl_cert'),", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n\n$proxy_ssl                   = false,\n$add_header                  = undef,\n$client_max_body_size        = '10m',\n$is_django                   = false,\n$client_max_body_size        = '10m',\n24:   $ssl_cert                    = hiera('public_ssl_cert'),\n$ssl_key                     = hiera('public_ssl_key'),\n$request_uuid                = false,\n$statsd_prefix               = $title,\n) {\nvalidate_bool($request_uuid)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n# Target line: 24\n\n     19:   $proxy_ssl                   = false,\n     20:   $add_header                  = undef,\n     21:   $client_max_body_size        = '10m',\n     22:   $is_django                   = false,\n     23:   $client_max_body_size        = '10m',\n>>>  24:   $ssl_cert                    = hiera('public_ssl_cert'),\n     25:   $ssl_key                     = hiera('public_ssl_key'),\n     26:   $request_uuid                = false,\n     27:   $statsd_prefix               = $title,\n     28: ) {\n     29:   validate_bool($request_uuid)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'AF953139C1DF9EF3476DE1D58F571BB27A86F4A2';", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'squeeze',\nkey      => 'ED75B5A4483DA07C';\n'duplicity':\nlocation => 'http://ppa.launchpad.net/duplicity-team/ppa/ubuntu',\nrelease  => 'trusty',\n43:       key      => 'AF953139C1DF9EF3476DE1D58F571BB27A86F4A2';\n'docker':\nlocation => 'https://download.docker.com/linux/ubuntu',\nrelease  => 'trusty',\nrepos    => ['stable'],\nkey      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 43\n\n     38:       release  => 'squeeze',\n     39:       key      => 'ED75B5A4483DA07C';\n     40:     'duplicity':\n     41:       location => 'http://ppa.launchpad.net/duplicity-team/ppa/ubuntu',\n     42:       release  => 'trusty',\n>>>  43:       key      => 'AF953139C1DF9EF3476DE1D58F571BB27A86F4A2';\n     44:     'docker':\n     45:       location => 'https://download.docker.com/linux/ubuntu',\n     46:       release  => 'trusty',\n     47:       repos    => ['stable'],\n     48:       key      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-mysql-manifests-user-grant.pp", "content": "mysql_user => 'root',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: boxen@puppet-mysql-manifests-user-grant.pp\n\nensure     => $ensure,\nusername   => $username,\nhost       => $host,\ndatabase   => $database,\ngrants     => $grants,\n37:     mysql_user => 'root',\nmysql_pass => '',\nmysql_host => $mysql::host,\nmysql_port => $mysql::port,\nexecutable => $mysql::client,\nrequire    => Exec['wait-for-mysql'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-mysql-manifests-user-grant.pp\n# Target line: 37\n\n     32:     ensure     => $ensure,\n     33:     username   => $username,\n     34:     host       => $host,\n     35:     database   => $database,\n     36:     grants     => $grants,\n>>>  37:     mysql_user => 'root',\n     38:     mysql_pass => '',\n     39:     mysql_host => $mysql::host,\n     40:     mysql_port => $mysql::port,\n     41:     executable => $mysql::client,\n     42:     require    => Exec['wait-for-mysql'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-enhanced_ecommerce_search_api.pp", "content": "$auth_password = undef,", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-enhanced_ecommerce_search_api.pp\n\n# Create a file on disk that can be parsed by jenkins-job-builder\n#\nclass govuk_jenkins::jobs::enhanced_ecommerce_search_api (\n$app_domain = hiera('app_domain'),\n$auth_username = undef,\n8:   $auth_password = undef,\n$rate_limit_token = undef,\n$cron_schedule = '0 5 * * *'\n) {\n\n$job_name = 'enhanced_ecommerce_search_api'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-enhanced_ecommerce_search_api.pp\n# Target line: 8\n\n      3: # Create a file on disk that can be parsed by jenkins-job-builder\n      4: #\n      5: class govuk_jenkins::jobs::enhanced_ecommerce_search_api (\n      6:   $app_domain = hiera('app_domain'),\n      7:   $auth_username = undef,\n>>>   8:   $auth_password = undef,\n      9:   $rate_limit_token = undef,\n     10:   $cron_schedule = '0 5 * * *'\n     11: ) {\n     12: \n     13:   $job_name = 'enhanced_ecommerce_search_api'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-jenkins-manifests-slave.pp", "content": "$gerrituser = 'jenkins',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n\n$ssh_key = undef,\n$user = true,\n$gitfullname = 'OpenStack Jenkins',\n$gitemail = 'jenkins@openstack.org',\n$gitpgpkey = 'jenkins@openstack.org',\n9:   $gerrituser = 'jenkins',\n$gerritkeytype = 'rsa',\n$gerritkey = undef,\n) {\n\ninclude ::haveged", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n# Target line: 9\n\n      4:   $ssh_key = undef,\n      5:   $user = true,\n      6:   $gitfullname = 'OpenStack Jenkins',\n      7:   $gitemail = 'jenkins@openstack.org',\n      8:   $gitpgpkey = 'jenkins@openstack.org',\n>>>   9:   $gerrituser = 'jenkins',\n     10:   $gerritkeytype = 'rsa',\n     11:   $gerritkey = undef,\n     12: ) {\n     13: \n     14:   include ::haveged\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp", "content": "$link_checker_api_bearer_token = undef,", "line": 84, "detection_span": [79, 89], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n\n$redis_port = undef,\n$secret_key_base = undef,\n$show_historical_edition_link = false,\n$email_alert_api_bearer_token = undef,\n$link_checker_api_secret_token = undef,\n84:   $link_checker_api_bearer_token = undef,\n) {\n$app_name = 'travel-advice-publisher'\n\ngovuk::app { $app_name:\napp_type           => 'rack',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n# Target line: 84\n\n     79:   $redis_port = undef,\n     80:   $secret_key_base = undef,\n     81:   $show_historical_edition_link = false,\n     82:   $email_alert_api_bearer_token = undef,\n     83:   $link_checker_api_secret_token = undef,\n>>>  84:   $link_checker_api_bearer_token = undef,\n     85: ) {\n     86:   $app_name = 'travel-advice-publisher'\n     87: \n     88:   govuk::app { $app_name:\n     89:     app_type           => 'rack',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-zuul_merger.pp", "content": "$gerrit_user = '',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n\n#\nclass openstackci::zuul_merger(\n$vhost_name = $::fqdn,\n$gearman_server = '127.0.0.1',\n$gerrit_server = '',\n23:   $gerrit_user = '',\n$known_hosts_content = '',\n$zuul_ssh_private_key = '',\n$layout_file_name = 'layout.yaml',\n$zuul_url = \"http://${::fqdn}/p\",\n$git_email = 'zuul@domain.example',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n# Target line: 23\n\n     18: #\n     19: class openstackci::zuul_merger(\n     20:   $vhost_name = $::fqdn,\n     21:   $gearman_server = '127.0.0.1',\n     22:   $gerrit_server = '',\n>>>  23:   $gerrit_user = '',\n     24:   $known_hosts_content = '',\n     25:   $zuul_ssh_private_key = '',\n     26:   $layout_file_name = 'layout.yaml',\n     27:   $zuul_url = \"http://${::fqdn}/p\",\n     28:   $git_email = 'zuul@domain.example',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-trackpad-scrolling_speed.pp", "content": "key    => 'com.apple.trackpad.scrolling',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-trackpad-scrolling_speed.pp\n\nclass people::felho::osx_settings::trackpad::scrolling_speed($speed = 0.6875) {\nboxen::osx_defaults { 'Set the scrolling speed of trackpad':\nuser   => $::luser,\ndomain => 'NSGlobalDomain',\n5:     key    => 'com.apple.trackpad.scrolling',\ntype   => 'float',\nvalue  => $speed,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-trackpad-scrolling_speed.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::trackpad::scrolling_speed($speed = 0.6875) {\n      2:   boxen::osx_defaults { 'Set the scrolling speed of trackpad':\n      3:     user   => $::luser,\n      4:     domain => 'NSGlobalDomain',\n>>>   5:     key    => 'com.apple.trackpad.scrolling',\n      6:     type   => 'float',\n      7:     value  => $speed,\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-itunes.pp", "content": "key    => 'play-songs-while-importing',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-itunes.pp\n\nclass people::felho::application_settings::itunes {\nboxen::osx_defaults { 'Disable playing songs when importing':\nuser   => $::luser,\ndomain => 'com.apple.iTunes',\n5:     key    => 'play-songs-while-importing',\ntype   => 'bool',\nvalue  => false,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-itunes.pp\n# Target line: 5\n\n      1: class people::felho::application_settings::itunes {\n      2:   boxen::osx_defaults { 'Disable playing songs when importing':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.iTunes',\n>>>   5:     key    => 'play-songs-while-importing',\n      6:     type   => 'bool',\n      7:     value  => false,\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp", "content": "log_user        => 'syslog',", "line": 112, "detection_span": [107, 117], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n\n}\n108:\nPackage['rssh'] -> File['/etc/rssh.conf'] -> File['/usr/lib/rssh/rssh_chroot_helper']\n110:\nclass { 'rsyslog':\n112:       log_user        => 'syslog',\nrun_user        => 'syslog',\nrun_group       => 'syslog',\npurge_rsyslog_d => true,\n}\n117:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n# Target line: 112\n\n    107:     }\n    108: \n    109:     Package['rssh'] -> File['/etc/rssh.conf'] -> File['/usr/lib/rssh/rssh_chroot_helper']\n    110: \n    111:     class { 'rsyslog':\n>>> 112:       log_user        => 'syslog',\n    113:       run_user        => 'syslog',\n    114:       run_group       => 'syslog',\n    115:       purge_rsyslog_d => true,\n    116:     }\n    117: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-devopslib-manifests-ssl_certificate.pp", "content": "$certificate = hiera_hash(\"ssl_certificates::${title}\"),", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-devopslib-manifests-ssl_certificate.pp\n\n# devopslib::ssl_certificate { 'sample_cert':\n#   owner => 'www-data'\n# }\n#\ndefine devopslib::ssl_certificate(\n28:   $certificate = hiera_hash(\"ssl_certificates::${title}\"),\n$owner       = 'root',\n$group       = 'root',\n$mode        = '0400',\n) {\nfile { $certificate['crt']['filename'] :", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-devopslib-manifests-ssl_certificate.pp\n# Target line: 28\n\n     23: # devopslib::ssl_certificate { 'sample_cert':\n     24: #   owner => 'www-data'\n     25: # }\n     26: #\n     27: define devopslib::ssl_certificate(\n>>>  28:   $certificate = hiera_hash(\"ssl_certificates::${title}\"),\n     29:   $owner       = 'root',\n     30:   $group       = 'root',\n     31:   $mode        = '0400',\n     32: ) {\n     33:   file { $certificate['crt']['filename'] :\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellps.pp", "content": "chap_password             => hiera('cinder::backend::eqlx::eqlx_chap_password', undef),", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellps.pp\n\nsan_thin_provision        => hiera('cinder::backend::eqlx::san_thin_provision', undef),\neqlx_group_name           => hiera('cinder::backend::eqlx::eqlx_group_name', undef),\neqlx_pool                 => hiera('cinder::backend::eqlx::eqlx_pool', undef),\nuse_chap_auth             => hiera('cinder::backend::eqlx::eqlx_use_chap', undef),\nchap_username             => hiera('cinder::backend::eqlx::eqlx_chap_login', undef),\n48:       chap_password             => hiera('cinder::backend::eqlx::eqlx_chap_password', undef),\n}\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellps.pp\n# Target line: 48\n\n     43:       san_thin_provision        => hiera('cinder::backend::eqlx::san_thin_provision', undef),\n     44:       eqlx_group_name           => hiera('cinder::backend::eqlx::eqlx_group_name', undef),\n     45:       eqlx_pool                 => hiera('cinder::backend::eqlx::eqlx_pool', undef),\n     46:       use_chap_auth             => hiera('cinder::backend::eqlx::eqlx_use_chap', undef),\n     47:       chap_username             => hiera('cinder::backend::eqlx::eqlx_chap_login', undef),\n>>>  48:       chap_password             => hiera('cinder::backend::eqlx::eqlx_chap_password', undef),\n     49:     }\n     50:   }\n     51: \n     52: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp", "content": "password             => hiera('CONFIG_CINDER_KS_PW'),", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n\n}\n\nclass { '::cinder::keystone::authtoken':\nwww_authenticate_uri => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\nauth_url             => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n31:       password             => hiera('CONFIG_CINDER_KS_PW'),\n}\n\nclass { '::cinder::api':\nbind_host               => $bind_host,\nservice_workers         => hiera('CONFIG_SERVICE_WORKERS'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n# Target line: 31\n\n     26:     }\n     27: \n     28:     class { '::cinder::keystone::authtoken':\n     29:       www_authenticate_uri => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\n     30:       auth_url             => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n>>>  31:       password             => hiera('CONFIG_CINDER_KS_PW'),\n     32:     }\n     33: \n     34:     class { '::cinder::api':\n     35:       bind_host               => $bind_host,\n     36:       service_workers         => hiera('CONFIG_SERVICE_WORKERS'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mroth@my-boxen-modules-people-manifests-mroth.pp", "content": "key    => 'AppleAquaColorVariant',", "line": 163, "detection_span": [158, 168], "with_context": "# Puppet file: mroth@my-boxen-modules-people-manifests-mroth.pp\n\n158:   # some sensible OSX defaults\n159:   #\n160:   boxen::osx_defaults {\n\"Set aqua color variant to graphite\":\nensure => present,\n163:       key    => 'AppleAquaColorVariant',\ndomain => 'NSGlobalDomain',\nuser   => $::boxen_user,\ntype   => 'int',\nvalue  => 6;\n\"disables Dashboard\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: mroth@my-boxen-modules-people-manifests-mroth.pp\n# Target line: 163\n\n    158:   # some sensible OSX defaults\n    159:   #\n    160:   boxen::osx_defaults {\n    161:     \"Set aqua color variant to graphite\":\n    162:       ensure => present,\n>>> 163:       key    => 'AppleAquaColorVariant',\n    164:       domain => 'NSGlobalDomain',\n    165:       user   => $::boxen_user,\n    166:       type   => 'int',\n    167:       value  => 6;\n    168:     \"disables Dashboard\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@puppet-foreman-manifests-config.pp", "content": "ssl_content => template('foreman/auth_kerb.conf.erb'),", "line": 136, "detection_span": [131, 141], "with_context": "# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n\nforeman::config::apache::fragment { 'lookup_identity':\nssl_content => template('foreman/lookup_identity.conf.erb'),\n}\n134:\nforeman::config::apache::fragment { 'auth_kerb':\n136:         ssl_content => template('foreman/auth_kerb.conf.erb'),\n}\n138:\n139:\nif $::foreman::ipa_manage_sssd {\n$sssd_services = join(unique(pick($facts['sssd']['services'], []) + ['ifp']), ', ')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n# Target line: 136\n\n    131:       foreman::config::apache::fragment { 'lookup_identity':\n    132:         ssl_content => template('foreman/lookup_identity.conf.erb'),\n    133:       }\n    134: \n    135:       foreman::config::apache::fragment { 'auth_kerb':\n>>> 136:         ssl_content => template('foreman/auth_kerb.conf.erb'),\n    137:       }\n    138: \n    139: \n    140:       if $::foreman::ipa_manage_sssd {\n    141:         $sssd_services = join(unique(pick($facts['sssd']['services'], []) + ['ifp']), ', ')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp", "content": "www_root             => '/opt/stagecraft/current/assets',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n\nlocation             => '/stagecraft/',\nrewrite_rules        => [\n'^/stagecraft(.*)$ $1 break'\n],\nvhost                => $::assets_internal_vhost,\n43:     www_root             => '/opt/stagecraft/current/assets',\nlocation_cfg_prepend => {\n'expires' => '1h',\n},\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n# Target line: 43\n\n     38:     location             => '/stagecraft/',\n     39:     rewrite_rules        => [\n     40:       '^/stagecraft(.*)$ $1 break'\n     41:     ],\n     42:     vhost                => $::assets_internal_vhost,\n>>>  43:     www_root             => '/opt/stagecraft/current/assets',\n     44:     location_cfg_prepend => {\n     45:       'expires' => '1h',\n     46:     },\n     47:   }\n     48: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-httpd-manifests-params.pp", "content": "$user          = 'www-data'", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: openstack-infra@puppet-httpd-manifests-params.pp\n\n$redirect_ssl  = false\n$serveraliases = undef\n$servername    = undef\n$ssl           = true\n$template      = 'httpd/vhost-default.conf.erb'\n31:   $user          = 'www-data'\n$vhost_name    = '*'\n\ncase $::operatingsystem {\n'centos', 'redhat', 'fedora', 'scientific': {\n$apache_name = 'httpd'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-httpd-manifests-params.pp\n# Target line: 31\n\n     26:   $redirect_ssl  = false\n     27:   $serveraliases = undef\n     28:   $servername    = undef\n     29:   $ssl           = true\n     30:   $template      = 'httpd/vhost-default.conf.erb'\n>>>  31:   $user          = 'www-data'\n     32:   $vhost_name    = '*'\n     33: \n     34:   case $::operatingsystem {\n     35:     'centos', 'redhat', 'fedora', 'scientific': {\n     36:       $apache_name = 'httpd'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-boxen-manifests-security.pp", "content": "key    => 'askForPassword',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: boxen@puppet-boxen-manifests-security.pp\n\n$screensaver_delay_sec = 5\n) {\nboxen::osx_defaults { 'require password at screensaver':\nensure => present,\ndomain => 'com.apple.screensaver',\n10:     key    => 'askForPassword',\nvalue  => $require_password,\ntype   => 'bool',\nuser   => $::boxen_user\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-boxen-manifests-security.pp\n# Target line: 10\n\n      5:   $screensaver_delay_sec = 5\n      6: ) {\n      7:   boxen::osx_defaults { 'require password at screensaver':\n      8:     ensure => present,\n      9:     domain => 'com.apple.screensaver',\n>>>  10:     key    => 'askForPassword',\n     11:     value  => $require_password,\n     12:     type   => 'bool',\n     13:     user   => $::boxen_user\n     14:   }\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp", "content": "user        => 'postgres',", "line": 191, "detection_span": [186, 196], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n\n186:\n187:   postgresql::server::pg_hba_rule { 'Allow local connections with authentication under postgres user' :\ndescription => 'Allow local connections with authentication under postgres user',\ntype        => 'local',\ndatabase    => 'all',\n191:     user        => 'postgres',\nauth_method => 'md5',\n193:   }\n194:\n195:   file { '/var/log/nailgun' :\nensure  => directory,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n# Target line: 191\n\n    186: \n    187:   postgresql::server::pg_hba_rule { 'Allow local connections with authentication under postgres user' :\n    188:     description => 'Allow local connections with authentication under postgres user',\n    189:     type        => 'local',\n    190:     database    => 'all',\n>>> 191:     user        => 'postgres',\n    192:     auth_method => 'md5',\n    193:   }\n    194: \n    195:   file { '/var/log/nailgun' :\n    196:     ensure  => directory,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-log_server_site.pp", "content": "jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n\n# usage.\n\nnode default {\nclass { '::openstackci::logserver':\ndomain                  => hiera('domain'),\n25:     jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\nara_middleware          => hiera('ara_middleware', false),\nswift_authurl           => hiera('swift_authurl', ''),\nswift_user              => hiera('swift_user', ''),\nswift_key               => hiera('swift_key', ''),\nswift_tenant_name       => hiera('swift_tenant_name', ''),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n# Target line: 25\n\n     20: # usage.\n     21: \n     22: node default {\n     23:   class { '::openstackci::logserver':\n     24:     domain                  => hiera('domain'),\n>>>  25:     jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\n     26:     ara_middleware          => hiera('ara_middleware', false),\n     27:     swift_authurl           => hiera('swift_authurl', ''),\n     28:     swift_user              => hiera('swift_user', ''),\n     29:     swift_key               => hiera('swift_key', ''),\n     30:     swift_tenant_name       => hiera('swift_tenant_name', ''),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-netapp.pp", "content": "netapp_password                      => hiera('CONFIG_MANILA_NETAPP_PASSWORD'),", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-netapp.pp\n\n{\nmanila::backend::netapp{ 'netapp':\ndriver_handles_share_servers         => hiera('CONFIG_MANILA_NETAPP_DRV_HANDLES_SHARE_SERVERS'),\nnetapp_transport_type                => hiera('CONFIG_MANILA_NETAPP_TRANSPORT_TYPE'),\nnetapp_login                         => hiera('CONFIG_MANILA_NETAPP_LOGIN'),\n7:       netapp_password                      => hiera('CONFIG_MANILA_NETAPP_PASSWORD'),\nnetapp_server_hostname               => hiera('CONFIG_MANILA_NETAPP_SERVER_HOSTNAME'),\nnetapp_storage_family                => hiera('CONFIG_MANILA_NETAPP_STORAGE_FAMILY'),\nnetapp_server_port                   => hiera('CONFIG_MANILA_NETAPP_SERVER_PORT'),\nnetapp_vserver                       => hiera('CONFIG_MANILA_NETAPP_VSERVER', undef),\nnetapp_aggregate_name_search_pattern => hiera('CONFIG_MANILA_NETAPP_AGGREGATE_NAME_SEARCH_PATTERN'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-netapp.pp\n# Target line: 7\n\n      2: {\n      3:     manila::backend::netapp{ 'netapp':\n      4:       driver_handles_share_servers         => hiera('CONFIG_MANILA_NETAPP_DRV_HANDLES_SHARE_SERVERS'),\n      5:       netapp_transport_type                => hiera('CONFIG_MANILA_NETAPP_TRANSPORT_TYPE'),\n      6:       netapp_login                         => hiera('CONFIG_MANILA_NETAPP_LOGIN'),\n>>>   7:       netapp_password                      => hiera('CONFIG_MANILA_NETAPP_PASSWORD'),\n      8:       netapp_server_hostname               => hiera('CONFIG_MANILA_NETAPP_SERVER_HOSTNAME'),\n      9:       netapp_storage_family                => hiera('CONFIG_MANILA_NETAPP_STORAGE_FAMILY'),\n     10:       netapp_server_port                   => hiera('CONFIG_MANILA_NETAPP_SERVER_PORT'),\n     11:       netapp_vserver                       => hiera('CONFIG_MANILA_NETAPP_VSERVER', undef),\n     12:       netapp_aggregate_name_search_pattern => hiera('CONFIG_MANILA_NETAPP_AGGREGATE_NAME_SEARCH_PATTERN'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp", "content": "$ssl_cert              = '/etc/mysql/server-cert.pem'", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n\n$ruby_package_name     = 'ruby-mysql'\n$ruby_package_provider = 'gem'\n$service_name          = 'mysqld'\n$socket                = '/var/lib/mysql/mysql.sock'\n$ssl_ca                = '/etc/mysql/cacert.pem'\n72:       $ssl_cert              = '/etc/mysql/server-cert.pem'\n$ssl_key               = '/etc/mysql/server-key.pem'\n}\n\n'Suse': {\n$basedir               = '/usr'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n# Target line: 72\n\n     67:       $ruby_package_name     = 'ruby-mysql'\n     68:       $ruby_package_provider = 'gem'\n     69:       $service_name          = 'mysqld'\n     70:       $socket                = '/var/lib/mysql/mysql.sock'\n     71:       $ssl_ca                = '/etc/mysql/cacert.pem'\n>>>  72:       $ssl_cert              = '/etc/mysql/server-cert.pem'\n     73:       $ssl_key               = '/etc/mysql/server-key.pem'\n     74:     }\n     75: \n     76:     'Suse': {\n     77:       $basedir               = '/usr'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fraenki@puppet-galera-examples-centos7.pp", "content": "root_password   => 'pa$$w0rd',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: fraenki@puppet-galera-examples-centos7.pp\n\nnode default {\nclass { 'galera':\ngalera_servers  => ['10.0.99.101', '10.0.99.102'],\ngalera_master   => 'node1.example.com',\nvendor_type     => 'mariadb',\n6:     root_password   => 'pa$$w0rd',\nstatus_password => 'pa$$w0rd',\nbind_address    => $::ipaddress_enp0s8,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-examples-centos7.pp\n# Target line: 6\n\n      1: node default {\n      2:   class { 'galera':\n      3:     galera_servers  => ['10.0.99.101', '10.0.99.102'],\n      4:     galera_master   => 'node1.example.com',\n      5:     vendor_type     => 'mariadb',\n>>>   6:     root_password   => 'pa$$w0rd',\n      7:     status_password => 'pa$$w0rd',\n      8:     bind_address    => $::ipaddress_enp0s8,\n      9:   }\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-web_training-dvwa-manifests-config.pp", "content": "$docroot = '/var/www/dvwa'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-web_training-dvwa-manifests-config.pp\n\nclass dvwa::config {\n$secgen_parameters = secgen_functions::get_parameters($::base64_inputs_file)\n$port = $secgen_parameters['port'][0]\n$db_password = $secgen_parameters['db_password'][0]\n\n6:   $docroot = '/var/www/dvwa'\n\nfile { \"$docroot/config/config.inc.php\":\nensure  => present,\nmode   => '0600',\nowner => 'www-data',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-web_training-dvwa-manifests-config.pp\n# Target line: 6\n\n      1: class dvwa::config {\n      2:   $secgen_parameters = secgen_functions::get_parameters($::base64_inputs_file)\n      3:   $port = $secgen_parameters['port'][0]\n      4:   $db_password = $secgen_parameters['db_password'][0]\n      5:   \n>>>   6:   $docroot = '/var/www/dvwa'\n      7: \n      8:   file { \"$docroot/config/config.inc.php\":\n      9:     ensure  => present,\n     10:     mode   => '0600',\n     11:     owner => 'www-data',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@puppet-foreman-manifests-config.pp", "content": "ssl_content => template('foreman/lookup_identity.conf.erb'),", "line": 132, "detection_span": [127, 137], "with_context": "# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n\nforeman::config::apache::fragment { 'intercept_form_submit':\nssl_content => template('foreman/intercept_form_submit.conf.erb'),\n}\n130:\nforeman::config::apache::fragment { 'lookup_identity':\n132:         ssl_content => template('foreman/lookup_identity.conf.erb'),\n}\n134:\nforeman::config::apache::fragment { 'auth_kerb':\nssl_content => template('foreman/auth_kerb.conf.erb'),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n# Target line: 132\n\n    127:       foreman::config::apache::fragment { 'intercept_form_submit':\n    128:         ssl_content => template('foreman/intercept_form_submit.conf.erb'),\n    129:       }\n    130: \n    131:       foreman::config::apache::fragment { 'lookup_identity':\n>>> 132:         ssl_content => template('foreman/lookup_identity.conf.erb'),\n    133:       }\n    134: \n    135:       foreman::config::apache::fragment { 'auth_kerb':\n    136:         ssl_content => template('foreman/auth_kerb.conf.erb'),\n    137:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-osx_config-manifests-trackpad-doubleclick_speed.pp", "content": "key    => 'com.apple.mouse.doubleClickThreshold',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-doubleclick_speed.pp\n\nclass osx_config::trackpad::doubleclick_speed($speed = 1.1) {\nboxen::osx_defaults { 'Set the double-click speed of trackpad':\nuser   => $::luser,\ndomain => 'NSGlobalDomain',\n5:     key    => 'com.apple.mouse.doubleClickThreshold',\ntype   => 'float',\nvalue  => $speed,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-doubleclick_speed.pp\n# Target line: 5\n\n      1: class osx_config::trackpad::doubleclick_speed($speed = 1.1) {\n      2:   boxen::osx_defaults { 'Set the double-click speed of trackpad':\n      3:     user   => $::luser,\n      4:     domain => 'NSGlobalDomain',\n>>>   5:     key    => 'com.apple.mouse.doubleClickThreshold',\n      6:     type   => 'float',\n      7:     value  => $speed,\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "user     => 'contacts',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\nuser     => 'collections_pub',\npassword => 'collections_publisher',\nrequire  => Class['::mysql::server'];\n\n'contacts_test':\n24:       user     => 'contacts',\npassword => 'contacts',\nrequire  => Class['::mysql::server'];\n\n'content_planner_test':\nuser     => 'content_planner',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 24\n\n     19:       user     => 'collections_pub',\n     20:       password => 'collections_publisher',\n     21:       require  => Class['::mysql::server'];\n     22: \n     23:     'contacts_test':\n>>>  24:       user     => 'contacts',\n     25:       password => 'contacts',\n     26:       require  => Class['::mysql::server'];\n     27: \n     28:     'content_planner_test':\n     29:       user     => 'content_planner',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "zend-patterns@ZendServerPuppet-manifests-sdk-command.pp", "content": "$zssecret           = undef,", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-sdk-command.pp\n\ndefine zendserver::sdk::command (\n$target,\n$api_command        = $name,\n$zsurl              = undef,\n$zskey              = undef,\n29:   $zssecret           = undef,\n$http_timeout       = 60,\n$additional_options = '',\n$tries              = 3,\n$try_sleep          = 5,\n$cwd                = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-sdk-command.pp\n# Target line: 29\n\n     24: define zendserver::sdk::command (\n     25:   $target,\n     26:   $api_command        = $name,\n     27:   $zsurl              = undef,\n     28:   $zskey              = undef,\n>>>  29:   $zssecret           = undef,\n     30:   $http_timeout       = 60,\n     31:   $additional_options = '',\n     32:   $tries              = 3,\n     33:   $try_sleep          = 5,\n     34:   $cwd                = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-gnocchi.pp", "content": "ceph_username => 'openstack',", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n\nmetric_processing_delay => 5,\ncoordination_url        => $::openstack_integration::config::tooz_url,\n}\nif $integration_enable {\nclass { '::gnocchi::storage::ceph':\n77:       ceph_username => 'openstack',\nceph_keyring  => '/etc/ceph/ceph.client.openstack.keyring',\nmanage_cradox => ($::osfamily == 'RedHat'),\nmanage_rados  => ($::osfamily == 'Debian'),\n}\n# make sure ceph pool exists before running gnocchi (dbsync & services)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n# Target line: 77\n\n     72:     metric_processing_delay => 5,\n     73:     coordination_url        => $::openstack_integration::config::tooz_url,\n     74:   }\n     75:   if $integration_enable {\n     76:     class { '::gnocchi::storage::ceph':\n>>>  77:       ceph_username => 'openstack',\n     78:       ceph_keyring  => '/etc/ceph/ceph.client.openstack.keyring',\n     79:       manage_cradox => ($::osfamily == 'RedHat'),\n     80:       manage_rados  => ($::osfamily == 'Debian'),\n     81:     }\n     82:     # make sure ceph pool exists before running gnocchi (dbsync & services)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-ci-params.pp", "content": "$gitlabci_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n\n$gitlabci_domain_alias      = false\n$gitlabci_repodir           = $ci_home\n$gitlabci_relative_url_root = false\n$gitlabci_ssl               = false\n$gitlabci_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n32:   $gitlabci_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$gitlabci_ssl_self_signed   = false\n$gitlabci_projects          = '10'\n$gitlabci_username_change   = true\n$gitlabci_unicorn_listen    = '127.0.0.1'\n$gitlabci_unicorn_port      = '8081'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n# Target line: 32\n\n     27:   $gitlabci_domain_alias      = false\n     28:   $gitlabci_repodir           = $ci_home\n     29:   $gitlabci_relative_url_root = false\n     30:   $gitlabci_ssl               = false\n     31:   $gitlabci_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n>>>  32:   $gitlabci_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     33:   $gitlabci_ssl_self_signed   = false\n     34:   $gitlabci_projects          = '10'\n     35:   $gitlabci_username_change   = true\n     36:   $gitlabci_unicorn_listen    = '127.0.0.1'\n     37:   $gitlabci_unicorn_port      = '8081'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-oauth-consumer.pp", "content": "$access_secret = undef,", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-oauth-consumer.pp\n\n$grants        = ['authonly'],\n$restrictions  = {'IPAddresses' => ['0.0.0.0/0','::/0']},\n$user          = 'Admin',\n$owner_only    = false,\n$access_token  = undef,\n42:     $access_secret = undef,\n$db_name       = $::mediawiki::db_name,\n) {\ninclude ::role::oauth\n\n$grants_json = ordered_json($grants)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-oauth-consumer.pp\n# Target line: 42\n\n     37:     $grants        = ['authonly'],\n     38:     $restrictions  = {'IPAddresses' => ['0.0.0.0/0','::/0']},\n     39:     $user          = 'Admin',\n     40:     $owner_only    = false,\n     41:     $access_token  = undef,\n>>>  42:     $access_secret = undef,\n     43:     $db_name       = $::mediawiki::db_name,\n     44: ) {\n     45:     include ::role::oauth\n     46: \n     47:     $grants_json = ordered_json($grants)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-params.pp", "content": "$mcollective_user = 'root'", "line": 84, "detection_span": [79, 89], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-params.pp\n\ncentos  => \"/usr/libexec/mcollective/mcollective\",\nredhat  => \"/usr/libexec/mcollective/mcollective\",\ndefault => \"/usr/libexec/mcollective/mcollective\",\n}\n\n84:   $mcollective_user = 'root'\n$mcollective_group = 'root'\n\n\n# Commands used in puppi info templates\n$info_package_query = $::operatingsystem ? {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-params.pp\n# Target line: 84\n\n     79:     centos  => \"/usr/libexec/mcollective/mcollective\",\n     80:     redhat  => \"/usr/libexec/mcollective/mcollective\",\n     81:     default => \"/usr/libexec/mcollective/mcollective\",\n     82:   }\n     83: \n>>>  84:   $mcollective_user = 'root'\n     85:   $mcollective_group = 'root'\n     86: \n     87: \n     88: # Commands used in puppi info templates\n     89:   $info_package_query = $::operatingsystem ? {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-pp_postgres-manifests-monitoring-primary.pp", "content": "login         => true,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-monitoring-primary.pp\n\nclass pp_postgres::monitoring::primary {\ninclude('pp_postgres::monitoring::base')\n\npostgresql::server::role { 'monitoring':\n5:     login         => true,\npassword_hash => postgresql_password('monitoring', 'monitoring'),\n}\npostgresql::server::database_grant { 'GRANT monitoring - CONNECT - stagecraft':\nprivilege => 'CONNECT',\ndb        => 'stagecraft',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-monitoring-primary.pp\n# Target line: 5\n\n      1: class pp_postgres::monitoring::primary {\n      2:   include('pp_postgres::monitoring::base')\n      3: \n      4:   postgresql::server::role { 'monitoring':\n>>>   5:     login         => true,\n      6:     password_hash => postgresql_password('monitoring', 'monitoring'),\n      7:   }\n      8:   postgresql::server::database_grant { 'GRANT monitoring - CONNECT - stagecraft':\n      9:     privilege => 'CONNECT',\n     10:     db        => 'stagecraft',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-deploy.pp", "content": "$vpn_pass          = undef,", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-deploy.pp\n\nclass performanceplatform::deploy (\n$vpn_url           = undef,\n$vpn_user          = undef,\n4:     $vpn_pass          = undef,\n$basic_auth        = undef,\n$jenkins_key       = undef,\n$jenkins_publickey = undef,\n) {\n#Only phone home if the vpn credentials are set", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-deploy.pp\n# Target line: 4\n\n      1: class performanceplatform::deploy (\n      2:     $vpn_url           = undef,\n      3:     $vpn_user          = undef,\n>>>   4:     $vpn_pass          = undef,\n      5:     $basic_auth        = undef,\n      6:     $jenkins_key       = undef,\n      7:     $jenkins_publickey = undef,\n      8: ) {\n      9:     #Only phone home if the vpn credentials are set\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_asset_master.pp", "content": "$cron_user = 'assets'", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_asset_master.pp\n\n} else {\ninclude assets::ssh_private_key\n\ncreate_resources('ufw::allow', $asset_slave_ip_ranges)\n\n26:     $cron_user = 'assets'\n}\n\n# daemontools provides setlock\n$cron_requires = [\nFile['/usr/local/bin/copy-attachments.sh'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_asset_master.pp\n# Target line: 26\n\n     21:   } else {\n     22:     include assets::ssh_private_key\n     23: \n     24:     create_resources('ufw::allow', $asset_slave_ip_ranges)\n     25: \n>>>  26:     $cron_user = 'assets'\n     27:   }\n     28: \n     29:   # daemontools provides setlock\n     30:   $cron_requires = [\n     31:     File['/usr/local/bin/copy-attachments.sh'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@mediawiki-vagrant-puppet-modules-npm-manifests-update.pp", "content": "user        => 'vagrant',", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-npm-manifests-update.pp\n\nrequire ::npm\n\nexec { \"${title}_npm_install\":\ncommand     => '/usr/bin/npm update --no-bin-links',\ncwd         => $directory,\n22:         user        => 'vagrant',\nenvironment => [\n\"NPM_CONFIG_CACHE=${::npm::cache_dir}\",\n'NPM_CONFIG_GLOBAL=false',\n'LINK=g++',\n'HOME=/home/vagrant',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-npm-manifests-update.pp\n# Target line: 22\n\n     17:     require ::npm\n     18: \n     19:     exec { \"${title}_npm_install\":\n     20:         command     => '/usr/bin/npm update --no-bin-links',\n     21:         cwd         => $directory,\n>>>  22:         user        => 'vagrant',\n     23:         environment => [\n     24:             \"NPM_CONFIG_CACHE=${::npm::cache_dir}\",\n     25:             'NPM_CONFIG_GLOBAL=false',\n     26:             'LINK=g++',\n     27:             'HOME=/home/vagrant',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp", "content": "$pp_data_bearer_token = undef,", "line": 98, "detection_span": [93, 103], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n\n$sentry_dsn = undef,\n$oauth_id = undef,\n$oauth_secret = undef,\n$port = '3075',\n$pp_data_url = undef,\n98:   $pp_data_bearer_token = undef,\n$redis_host = undef,\n100:   $redis_port = undef,\n101:   $secret_key_base = undef,\n102:   $zendesk_anonymous_ticket_email = undef,\n103:   $zendesk_client_password = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n# Target line: 98\n\n     93:   $sentry_dsn = undef,\n     94:   $oauth_id = undef,\n     95:   $oauth_secret = undef,\n     96:   $port = '3075',\n     97:   $pp_data_url = undef,\n>>>  98:   $pp_data_bearer_token = undef,\n     99:   $redis_host = undef,\n    100:   $redis_port = undef,\n    101:   $secret_key_base = undef,\n    102:   $zendesk_anonymous_ticket_email = undef,\n    103:   $zendesk_client_password = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-designate-central.pp", "content": "user    => 'designate',", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-designate-central.pp\n\ninclude ::designate::quota\n}\nif ($step == 5 and $sync_db) {\nexec { 'pool update':\ncommand => '/bin/designate-manage pool update',\n65:       user    => 'designate',\n}\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-designate-central.pp\n# Target line: 65\n\n     60:     include ::designate::quota\n     61:   }\n     62:   if ($step == 5 and $sync_db) {\n     63:     exec { 'pool update':\n     64:       command => '/bin/designate-manage pool update',\n>>>  65:       user    => 'designate',\n     66:     }\n     67:   }\n     68: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mozilla@socorro-infra-puppet-modules-socorro-manifests-role-common.pp", "content": "$datadog_api_key=hiera(\"${::environment}/datadog_api_key\")", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: mozilla@socorro-infra-puppet-modules-socorro-manifests-role-common.pp\n\nensure => running,\nenable => true\n}\n\n# Datadog agent install\n43:   $datadog_api_key=hiera(\"${::environment}/datadog_api_key\")\n\nfile {\n'/etc/dd-agent/datadog.conf':\nmode    => '0640',\nowner   => 'dd-agent',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: mozilla@socorro-infra-puppet-modules-socorro-manifests-role-common.pp\n# Target line: 43\n\n     38:       ensure => running,\n     39:       enable => true\n     40:   }\n     41: \n     42:   # Datadog agent install\n>>>  43:   $datadog_api_key=hiera(\"${::environment}/datadog_api_key\")\n     44: \n     45:   file {\n     46:     '/etc/dd-agent/datadog.conf':\n     47:       mode    => '0640',\n     48:       owner   => 'dd-agent',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhost_ip_based.pp", "content": "docroot  => '/var/www/first',", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhost_ip_based.pp\n\napache::listen { '81': }\n\n# IP-based vhosts\napache::vhost { 'first.example.com':\nip       => '10.0.0.10',\n18:   docroot  => '/var/www/first',\nip_based => true,\n}\napache::vhost { 'second.example.com':\nip       => '10.0.0.11',\ndocroot  => '/var/www/second',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhost_ip_based.pp\n# Target line: 18\n\n     13: apache::listen { '81': }\n     14: \n     15: # IP-based vhosts\n     16: apache::vhost { 'first.example.com':\n     17:   ip       => '10.0.0.10',\n>>>  18:   docroot  => '/var/www/first',\n     19:   ip_based => true,\n     20: }\n     21: apache::vhost { 'second.example.com':\n     22:   ip       => '10.0.0.11',\n     23:   docroot  => '/var/www/second',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-sshkeygen.pp", "content": "$username = \"root\",", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-sshkeygen.pp\n\ndefine fuel::sshkeygen (\n$length = 2048,\n$homedir = \"/root\",\n4:   $username = \"root\",\n$groupname = \"root\",\n$keytype = \"rsa\",\n){\n\nExec { path => '/usr/bin:/bin:/usr/sbin:/sbin' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-sshkeygen.pp\n# Target line: 4\n\n      1: define fuel::sshkeygen (\n      2:   $length = 2048,\n      3:   $homedir = \"/root\",\n>>>   4:   $username = \"root\",\n      5:   $groupname = \"root\",\n      6:   $keytype = \"rsa\",\n      7: ){\n      8: \n      9:   Exec { path => '/usr/bin:/bin:/usr/sbin:/sbin' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-heat.pp", "content": "domain_password   => hiera('CONFIG_HEAT_DOMAIN_PASSWORD'),", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-heat.pp\n\n}\n\nclass { '::heat::keystone::domain':\ndomain_name       => hiera('CONFIG_HEAT_DOMAIN'),\ndomain_admin      => hiera('CONFIG_HEAT_DOMAIN_ADMIN'),\n23:       domain_password   => hiera('CONFIG_HEAT_DOMAIN_PASSWORD'),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-heat.pp\n# Target line: 23\n\n     18:     }\n     19: \n     20:     class { '::heat::keystone::domain':\n     21:       domain_name       => hiera('CONFIG_HEAT_DOMAIN'),\n     22:       domain_admin      => hiera('CONFIG_HEAT_DOMAIN_ADMIN'),\n>>>  23:       domain_password   => hiera('CONFIG_HEAT_DOMAIN_PASSWORD'),\n     24:     }\n     25: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-stash-manifests-init.pp", "content": "$backupuser             = 'admin',", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: voxpupuli@puppet-stash-manifests-init.pp\n\n# Backup Settings\n$backup_ensure          = 'present',\n$backupclient_url       = 'https://maven.atlassian.com/public/com/atlassian/stash/backup/stash-backup-distribution',\n$backupclient_version   = '1.9.1',\n$backup_home            = '/opt/stash-backup',\n58:   $backupuser             = 'admin',\n$backuppass             = 'password',\n$backup_schedule_hour   = '5',\n$backup_schedule_minute = '0',\n$backup_keep_age        = '4w',\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-stash-manifests-init.pp\n# Target line: 58\n\n     53:   # Backup Settings\n     54:   $backup_ensure          = 'present',\n     55:   $backupclient_url       = 'https://maven.atlassian.com/public/com/atlassian/stash/backup/stash-backup-distribution',\n     56:   $backupclient_version   = '1.9.1',\n     57:   $backup_home            = '/opt/stash-backup',\n>>>  58:   $backupuser             = 'admin',\n     59:   $backuppass             = 'password',\n     60:   $backup_schedule_hour   = '5',\n     61:   $backup_schedule_minute = '0',\n     62:   $backup_keep_age        = '4w',\n     63: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$puppetdb_user     = '_puppetdb'", "line": 146, "detection_span": [141, 151], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n$puppetdb_user     = 'puppetdb'\n$puppetdb_group    = 'puppetdb'\n$puppetdb_initconf = '/etc/default/puppetdb'\n}\n'OpenBSD': {\n146:       $puppetdb_user     = '_puppetdb'\n$puppetdb_group    = '_puppetdb'\n$puppetdb_initconf = undef\n}\n'FreeBSD': {\n$puppetdb_user     = 'puppetdb'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 146\n\n    141:       $puppetdb_user     = 'puppetdb'\n    142:       $puppetdb_group    = 'puppetdb'\n    143:       $puppetdb_initconf = '/etc/default/puppetdb'\n    144:     }\n    145:     'OpenBSD': {\n>>> 146:       $puppetdb_user     = '_puppetdb'\n    147:       $puppetdb_group    = '_puppetdb'\n    148:       $puppetdb_initconf = undef\n    149:     }\n    150:     'FreeBSD': {\n    151:       $puppetdb_user     = 'puppetdb'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-rochtrinque.pp", "content": "ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNw0X1UURCTVJ05JzGNr182vI3pft/MDzz2KffYWurcS4rtxxQB9lm2ZyfJLC/OCIVhqsjNJbGWA66f3Hh/LO7GRkjJ1fKfWxDf4Gf307nVjhElo4ZfQHjKU1QBmS9KNavrLTv0vMXp4I9j3QxJsuuCkgt7p5nkR+2nPFywKwMqvTzkt/RhW13BgWN4/J+I65luNqkdgFupjZ+HKTswz9scnOblT2xShGpCXzBPqHuNWCcBaElWNFTY4lWRP6Qyuibku6qPW1+BI3S9iJgnGi8LiktZljxS79Lmx+Qj/CDaS3XLp+VqsAlRVBvUzjdE5hfTphIpZp04kCOs4aY8xMxzulB7a8knggxEuJ8PL8S7nKXi21KulURH9yN91hjV1dS4h9E6NRIwibSjGAiQ8leghbzWmMQX9fAczTKx33U9DHrLUSH9mh85eqlRnkkeiaI6by+8RojvM8m3Q4DPjfc4PQ6Lw9AnbTvOkxRHo5IPQGhuZ5jn11XxVEkBWcXV7cVRUq6g1Iyxz722EeWJ0VE0tkDIqCCW3urU5VOinJTehVOdT+D0tYI320Vwuxa42G5OjUfEsOb+UiQOifVgGZHlJIBRFWJNjn8jqaeo/y/C7OT2rm//Jn4jcR3jOuSmb2SUeg0icZKsLAnYyqz/zd/7+Y+E8MqH/b/HCRjDZ3wJw== rochtrinque@gds8064.local','ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNo1GmCNbA4m+myfuUGmZZWfED773dX8u7a48vimUCUa72ajaKK+kBUa29JFzCHW/GYV7lNpgbj9LitR9FA75Lk28ZhDVPeg3czn0ygb4yuN1APXS2NnCeuz6pPwvCWoSJTAHRXRZRBuM/xMYjsKz5uAL3528jnmaosmKSCks7mMXPhqZ00IFBmd974g2kGF0PGz8QHGTcDl2niyJf/EERNpzFGjf7PdVvEJFcPmnUPH1uk6RUqSqd87ZtReDJLUgVgkpYXZpZPEQTi6JNzhCNQ55fBkZrVNbdF+Wxomar9D/6Z2jFygZAFV3ZXlJl6Xd9yWrzfQtOxwOjeDPbjW920D4xDZR+whs4X2BVebzUMARQX1ZRwwbybYlGilW5iS7l+CCAUTakBwM5+3CXZ2WgZxyTLjIkNjmyFWD5CEodlO8hNqB8I59t6uI1fCpMFGxEKSL7LyVUgD2Whp0wZlDfR4c4LBq5T7j2NXVnsfWTQ1WceTVtT2ExFpPgfrnc/9OUL1fSxtyJwFIGqO7VmwKzI4+5Kj5AUHgo7wAnLr4n+wKzsYDrarLG32bXRxFMzJxhWdwkAlM+lE80f50SxYp9RgsTGa0PkbV51tEcxVYwT9us24pZgwzGulcFpQCDgqXg98Q8UcVjdmWQQZLptY23bmfHOzatoaMmr2Zh+P492Q== roch@simu' ,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-rochtrinque.pp\n\n# Creates the rochtrinque user\nclass users::rochtrinque {\ngovuk_user { 'rochtrinque':\nfullname => 'Roch Trinque',\nemail    => 'roch.trinque@digital.cabinet-office.gov.uk',\n6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNw0X1UURCTVJ05JzGNr182vI3pft/MDzz2KffYWurcS4rtxxQB9lm2ZyfJLC/OCIVhqsjNJbGWA66f3Hh/LO7GRkjJ1fKfWxDf4Gf307nVjhElo4ZfQHjKU1QBmS9KNavrLTv0vMXp4I9j3QxJsuuCkgt7p5nkR+2nPFywKwMqvTzkt/RhW13BgWN4/J+I65luNqkdgFupjZ+HKTswz9scnOblT2xShGpCXzBPqHuNWCcBaElWNFTY4lWRP6Qyuibku6qPW1+BI3S9iJgnGi8LiktZljxS79Lmx+Qj/CDaS3XLp+VqsAlRVBvUzjdE5hfTphIpZp04kCOs4aY8xMxzulB7a8knggxEuJ8PL8S7nKXi21KulURH9yN91hjV1dS4h9E6NRIwibSjGAiQ8leghbzWmMQX9fAczTKx33U9DHrLUSH9mh85eqlRnkkeiaI6by+8RojvM8m3Q4DPjfc4PQ6Lw9AnbTvOkxRHo5IPQGhuZ5jn11XxVEkBWcXV7cVRUq6g1Iyxz722EeWJ0VE0tkDIqCCW3urU5VOinJTehVOdT+D0tYI320Vwuxa42G5OjUfEsOb+UiQOifVgGZHlJIBRFWJNjn8jqaeo/y/C7OT2rm//Jn4jcR3jOuSmb2SUeg0icZKsLAnYyqz/zd/7+Y+E8MqH/b/HCRjDZ3wJw== rochtrinque@gds8064.local','ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNo1GmCNbA4m+myfuUGmZZWfED773dX8u7a48vimUCUa72ajaKK+kBUa29JFzCHW/GYV7lNpgbj9LitR9FA75Lk28ZhDVPeg3czn0ygb4yuN1APXS2NnCeuz6pPwvCWoSJTAHRXRZRBuM/xMYjsKz5uAL3528jnmaosmKSCks7mMXPhqZ00IFBmd974g2kGF0PGz8QHGTcDl2niyJf/EERNpzFGjf7PdVvEJFcPmnUPH1uk6RUqSqd87ZtReDJLUgVgkpYXZpZPEQTi6JNzhCNQ55fBkZrVNbdF+Wxomar9D/6Z2jFygZAFV3ZXlJl6Xd9yWrzfQtOxwOjeDPbjW920D4xDZR+whs4X2BVebzUMARQX1ZRwwbybYlGilW5iS7l+CCAUTakBwM5+3CXZ2WgZxyTLjIkNjmyFWD5CEodlO8hNqB8I59t6uI1fCpMFGxEKSL7LyVUgD2Whp0wZlDfR4c4LBq5T7j2NXVnsfWTQ1WceTVtT2ExFpPgfrnc/9OUL1fSxtyJwFIGqO7VmwKzI4+5Kj5AUHgo7wAnLr4n+wKzsYDrarLG32bXRxFMzJxhWdwkAlM+lE80f50SxYp9RgsTGa0PkbV51tEcxVYwT9us24pZgwzGulcFpQCDgqXg98Q8UcVjdmWQQZLptY23bmfHOzatoaMmr2Zh+P492Q== roch@simu' ,\n],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-rochtrinque.pp\n# Target line: 6\n\n      1: # Creates the rochtrinque user\n      2: class users::rochtrinque {\n      3:   govuk_user { 'rochtrinque':\n      4:     fullname => 'Roch Trinque',\n      5:     email    => 'roch.trinque@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNw0X1UURCTVJ05JzGNr182vI3pft/MDzz2KffYWurcS4rtxxQB9lm2ZyfJLC/OCIVhqsjNJbGWA66f3Hh/LO7GRkjJ1fKfWxDf4Gf307nVjhElo4ZfQHjKU1QBmS9KNavrLTv0vMXp4I9j3QxJsuuCkgt7p5nkR+2nPFywKwMqvTzkt/RhW13BgWN4/J+I65luNqkdgFupjZ+HKTswz9scnOblT2xShGpCXzBPqHuNWCcBaElWNFTY4lWRP6Qyuibku6qPW1+BI3S9iJgnGi8LiktZljxS79Lmx+Qj/CDaS3XLp+VqsAlRVBvUzjdE5hfTphIpZp04kCOs4aY8xMxzulB7a8knggxEuJ8PL8S7nKXi21KulURH9yN91hjV1dS4h9E6NRIwibSjGAiQ8leghbzWmMQX9fAczTKx33U9DHrLUSH9mh85eqlRnkkeiaI6by+8RojvM8m3Q4DPjfc4PQ6Lw9AnbTvOkxRHo5IPQGhuZ5jn11XxVEkBWcXV7cVRUq6g1Iyxz722EeWJ0VE0tkDIqCCW3urU5VOinJTehVOdT+D0tYI320Vwuxa42G5OjUfEsOb+UiQOifVgGZHlJIBRFWJNjn8jqaeo/y/C7OT2rm//Jn4jcR3jOuSmb2SUeg0icZKsLAnYyqz/zd/7+Y+E8MqH/b/HCRjDZ3wJw== rochtrinque@gds8064.local','ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNo1GmCNbA4m+myfuUGmZZWfED773dX8u7a48vimUCUa72ajaKK+kBUa29JFzCHW/GYV7lNpgbj9LitR9FA75Lk28ZhDVPeg3czn0ygb4yuN1APXS2NnCeuz6pPwvCWoSJTAHRXRZRBuM/xMYjsKz5uAL3528jnmaosmKSCks7mMXPhqZ00IFBmd974g2kGF0PGz8QHGTcDl2niyJf/EERNpzFGjf7PdVvEJFcPmnUPH1uk6RUqSqd87ZtReDJLUgVgkpYXZpZPEQTi6JNzhCNQ55fBkZrVNbdF+Wxomar9D/6Z2jFygZAFV3ZXlJl6Xd9yWrzfQtOxwOjeDPbjW920D4xDZR+whs4X2BVebzUMARQX1ZRwwbybYlGilW5iS7l+CCAUTakBwM5+3CXZ2WgZxyTLjIkNjmyFWD5CEodlO8hNqB8I59t6uI1fCpMFGxEKSL7LyVUgD2Whp0wZlDfR4c4LBq5T7j2NXVnsfWTQ1WceTVtT2ExFpPgfrnc/9OUL1fSxtyJwFIGqO7VmwKzI4+5Kj5AUHgo7wAnLr4n+wKzsYDrarLG32bXRxFMzJxhWdwkAlM+lE80f50SxYp9RgsTGa0PkbV51tEcxVYwT9us24pZgwzGulcFpQCDgqXg98Q8UcVjdmWQQZLptY23bmfHOzatoaMmr2Zh+P492Q== roch@simu' ,\n      7:     ],\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-nodepool_builder.pp", "content": "$mysql_root_password = '',", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool_builder.pp\n\n\n# == Class: openstackci::nodepool_builder\n#\nclass openstackci::nodepool_builder (\n$oscc_file_contents = undef,\n20:   $mysql_root_password = '',\n$mysql_password = '',\n$nodepool_ssh_public_key = undef,\n$git_source_repo = 'https://git.openstack.org/openstack-infra/nodepool',\n$revision = 'master',\n$environment = {},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool_builder.pp\n# Target line: 20\n\n     15: \n     16: # == Class: openstackci::nodepool_builder\n     17: #\n     18: class openstackci::nodepool_builder (\n     19:   $oscc_file_contents = undef,\n>>>  20:   $mysql_root_password = '',\n     21:   $mysql_password = '',\n     22:   $nodepool_ssh_public_key = undef,\n     23:   $git_source_repo = 'https://git.openstack.org/openstack-infra/nodepool',\n     24:   $revision = 'master',\n     25:   $environment = {},\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$ks_encrypted_root_password    = '\\$6\\$tCD3X7ji\\$1urw6qEMDkVxOkD33b4TpQAjRiCeDZx0jmgMhDYhfB9KuGfqO9OcMaKyUxnGGWslEDQ4HxTw7vcAMP85NxQe61'", "line": 91, "detection_span": [86, 96], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$admin_network                 = '10.20.0.*'\n$extra_networks                = undef\n\n$nailgun_api_url               = \"http://${::ipaddress}:8000/api\"\n# default password is 'r00tme'\n91:   $ks_encrypted_root_password    = '\\$6\\$tCD3X7ji\\$1urw6qEMDkVxOkD33b4TpQAjRiCeDZx0jmgMhDYhfB9KuGfqO9OcMaKyUxnGGWslEDQ4HxTw7vcAMP85NxQe61'\n\n$ntp_upstream                  = ''\n\n$mco_host                      = $::ipaddress\n$mco_port                      = '61613'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 91\n\n     86:   $admin_network                 = '10.20.0.*'\n     87:   $extra_networks                = undef\n     88: \n     89:   $nailgun_api_url               = \"http://${::ipaddress}:8000/api\"\n     90:   # default password is 'r00tme'\n>>>  91:   $ks_encrypted_root_password    = '\\$6\\$tCD3X7ji\\$1urw6qEMDkVxOkD33b4TpQAjRiCeDZx0jmgMhDYhfB9KuGfqO9OcMaKyUxnGGWslEDQ4HxTw7vcAMP85NxQe61'\n     92: \n     93:   $ntp_upstream                  = ''\n     94: \n     95:   $mco_host                      = $::ipaddress\n     96:   $mco_port                      = '61613'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan-db.pp", "content": "user                    => 'ckan',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan-db.pp\n\nif !$rds {\nclass { 'postgresql::server::postgis': }\n}\n\ngovuk_postgresql::db { 'ckan_production':\n31:     user                    => 'ckan',\npassword                => $password,\nallow_auth_from_backend => true,\nbackend_ip_range        => $backend_ip_range,\nallow_auth_from_lb      => $allow_auth_from_lb,\nlb_ip_range             => $lb_ip_range,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan-db.pp\n# Target line: 31\n\n     26:   if !$rds {\n     27:     class { 'postgresql::server::postgis': }\n     28:   }\n     29: \n     30:   govuk_postgresql::db { 'ckan_production':\n>>>  31:     user                    => 'ckan',\n     32:     password                => $password,\n     33:     allow_auth_from_backend => true,\n     34:     backend_ip_range        => $backend_ip_range,\n     35:     allow_auth_from_lb      => $allow_auth_from_lb,\n     36:     lb_ip_range             => $lb_ip_range,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp", "content": "$cobbler_password    = 'cobbler'", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n\n$dhcp_start_address  = '10.0.0.201'\n$dhcp_end_address    = '10.0.0.254'\n$dhcp_netmask        = '255.255.255.0'\n$dhcp_gateway        = '10.0.0.100'\n$cobbler_user        = 'cobbler'\n10: $cobbler_password    = 'cobbler'\n$pxetimeout          = '0'\n$dhcp_interface      = 'eth0'\n\nstage {'openstack-custom-repo': before => Stage['main']}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n# Target line: 10\n\n      5: $dhcp_start_address  = '10.0.0.201'\n      6: $dhcp_end_address    = '10.0.0.254'\n      7: $dhcp_netmask        = '255.255.255.0'\n      8: $dhcp_gateway        = '10.0.0.100'\n      9: $cobbler_user        = 'cobbler'\n>>>  10: $cobbler_password    = 'cobbler'\n     11: $pxetimeout          = '0'\n     12: $dhcp_interface      = 'eth0'\n     13: \n     14: stage {'openstack-custom-repo': before => Stage['main']}\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$rabbitmq_astute_user          = 'naily'", "line": 60, "detection_span": [55, 65], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n# network interface configuration timeout (in seconds)\n$bootstrap_ethdevice_timeout   = '120'\n$bootstrap_profile             = 'ubuntu_bootstrap'\n\n$rabbitmq_host                 = '127.0.0.1'\n60:   $rabbitmq_astute_user          = 'naily'\n$rabbitmq_astute_password      = 'naily'\n\n$rabbitmq_gid                  = 495\n$rabbitmq_uid                  = 495\n$rabbitmq_management_port      = 15672", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 60\n\n     55:   # network interface configuration timeout (in seconds)\n     56:   $bootstrap_ethdevice_timeout   = '120'\n     57:   $bootstrap_profile             = 'ubuntu_bootstrap'\n     58: \n     59:   $rabbitmq_host                 = '127.0.0.1'\n>>>  60:   $rabbitmq_astute_user          = 'naily'\n     61:   $rabbitmq_astute_password      = 'naily'\n     62: \n     63:   $rabbitmq_gid                  = 495\n     64:   $rabbitmq_uid                  = 495\n     65:   $rabbitmq_management_port      = 15672\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-config.pp", "content": "$rabbitmq_user = undef,", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n\n$mysql_user_neutron = undef,\n$mysql_pass_neutron = undef,\n$mysql_user_heat = undef,\n$mysql_pass_heat = undef,\n$rabbitmq_hosts = undef,\n38:   $rabbitmq_user = undef,\n$rabbitmq_password = undef,\n$keystone_admin_token = undef,\n$keystone_admin_email = undef,\n$keystone_admin_password = undef,\n$keystone_tenants = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n# Target line: 38\n\n     33:   $mysql_user_neutron = undef,\n     34:   $mysql_pass_neutron = undef,\n     35:   $mysql_user_heat = undef,\n     36:   $mysql_pass_heat = undef,\n     37:   $rabbitmq_hosts = undef,\n>>>  38:   $rabbitmq_user = undef,\n     39:   $rabbitmq_password = undef,\n     40:   $keystone_admin_token = undef,\n     41:   $keystone_admin_email = undef,\n     42:   $keystone_admin_password = undef,\n     43:   $keystone_tenants = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$keystone_ostf_password        = 'ostf'", "line": 110, "detection_span": [105, 115], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n'ironic-fa-bootstrap-configs',\n'fuel-bootstrap-cli',\n107:   ]\n108:\n$keystone_ostf_user            = 'ostf'\n110:   $keystone_ostf_password        = 'ostf'\n111:\n$puppet_master_hostname        = \"${::hostname}.${::domain}\"\n113:\n$repo_root                     = '/var/www/nailgun'\n$repo_port                     = '8080'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 110\n\n    105:     'ironic-fa-bootstrap-configs',\n    106:     'fuel-bootstrap-cli',\n    107:   ]\n    108: \n    109:   $keystone_ostf_user            = 'ostf'\n>>> 110:   $keystone_ostf_password        = 'ostf'\n    111: \n    112:   $puppet_master_hostname        = \"${::hostname}.${::domain}\"\n    113: \n    114:   $repo_root                     = '/var/www/nailgun'\n    115:   $repo_port                     = '8080'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp", "content": "$admin_password        = hiera('admin_password', ''),", "line": 66, "detection_span": [61, 71], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n\n# [*zookeeper_hostnames*]\n#   (Optional) The IPs of the Zookeeper Servers\n#   Defaults to hiera('controller_node_names')\n#\nclass tripleo::profile::base::neutron::midonet (\n66:   $admin_password        = hiera('admin_password', ''),\n$bind_address          = hiera('neutron::bind_host', ''),\n$keystone_admin_token  = hiera('keystone::admin_token', ''),\n$neutron_api_node_ips  = hiera('neutron_api_node_ips', ''),\n$neutron_auth_password = hiera('neutron::keystone::authtoken::password', ''),\n$neutron_auth_tenant   = hiera('neutron::keystone::authtoken::project_name', ''),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n# Target line: 66\n\n     61: # [*zookeeper_hostnames*]\n     62: #   (Optional) The IPs of the Zookeeper Servers\n     63: #   Defaults to hiera('controller_node_names')\n     64: #\n     65: class tripleo::profile::base::neutron::midonet (\n>>>  66:   $admin_password        = hiera('admin_password', ''),\n     67:   $bind_address          = hiera('neutron::bind_host', ''),\n     68:   $keystone_admin_token  = hiera('keystone::admin_token', ''),\n     69:   $neutron_api_node_ips  = hiera('neutron_api_node_ips', ''),\n     70:   $neutron_auth_password = hiera('neutron::keystone::authtoken::password', ''),\n     71:   $neutron_auth_tenant   = hiera('neutron::keystone::authtoken::project_name', ''),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support.pp", "content": "$oauth_secret = undef,", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support.pp\n\nclass govuk::apps::support(\n$emergency_contact_details = undef,\n$sentry_dsn = undef,\n$enable_procfile_worker = true,\n$oauth_id = undef,\n68:   $oauth_secret = undef,\n$port = '3031',\n$redis_host = undef,\n$redis_port = undef,\n$secret_key_base = undef,\n$support_api_bearer_token = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support.pp\n# Target line: 68\n\n     63: class govuk::apps::support(\n     64:   $emergency_contact_details = undef,\n     65:   $sentry_dsn = undef,\n     66:   $enable_procfile_worker = true,\n     67:   $oauth_id = undef,\n>>>  68:   $oauth_secret = undef,\n     69:   $port = '3031',\n     70:   $redis_host = undef,\n     71:   $redis_port = undef,\n     72:   $secret_key_base = undef,\n     73:   $support_api_bearer_token = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-search_admin-db.pp", "content": "user     => 'search_admin',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-search_admin-db.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::apps::search_admin::db(\n$mysql_search_admin,\n) {\nmysql::db {'search_admin_production':\n6:     user     => 'search_admin',\nhost     => '%',\npassword => $mysql_search_admin,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-search_admin-db.pp\n# Target line: 6\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::apps::search_admin::db(\n      3:   $mysql_search_admin,\n      4: ) {\n      5:   mysql::db {'search_admin_production':\n>>>   6:     user     => 'search_admin',\n      7:     host     => '%',\n      8:     password => $mysql_search_admin,\n      9:   }\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-andysellick.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCzgYIqGtST23/OgNRRLtJD7m7+Lsvos3oQxuktiRfBKZ8SblLSssbjGC1DJG24ZGT6f+BBROpz86uxEVe86K0NWU6I1UIZZoBHzidg7tyX2WFjgMUBqlgAKkEaKsm1Xp0JiJjPc1bhyf2gOYu+0dng3fiS8hS28J7y+FMx7ejKvcIcMApD/dTgKwePtQT7T1HO3bYRs2lj1dMwCsLjdUyKtysCmRirQC8wVHvUUCyH++Chov27uU5QrbfGWZOa0D+9GZf4OoViNtTD0zq4DbD1ioGHRRi+FRhnLhucwVSrdAwy8fhMO2edhwNLLRnDvOJla1AMO+QshR9kOhl4PRiMbWngxtJnfRmkSlU/5VrFornOntOIS7RNjGoqwgp4hYI3TQ4OP8hXZ+NkPpNJyf3vyfoCDFtkUCJzxvhjbZ0d9T4NTPUdoVjkvUL12riEsX2SD/z9qnEnXFtM1c1vggwUHPX1GriOg5HJ78poH+VGvlwWs2rL/SvMWnBkCnuZsYo3D7CS+k6dCv/DbuobrPvN7sivzJHW5Tcnx0V1LwaSCPDaHUxJFWYUnGBpJDS8/zOjfLa7mboYtFDKY+lpt9g1oC4NYjZzfFQiQrcX/HzUn0thJ0RahzwsOKljDjMG6jway+aEH+YcsEV8HF8C39hAhthI7z1oz7sJBgvNxA679Q== andy.sellick@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-andysellick.pp\n\n# Creates the andysellick user\nclass users::andysellick {\ngovuk_user { 'andysellick':\nfullname => 'Andy Sellick',\nemail    => 'andy.sellick@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCzgYIqGtST23/OgNRRLtJD7m7+Lsvos3oQxuktiRfBKZ8SblLSssbjGC1DJG24ZGT6f+BBROpz86uxEVe86K0NWU6I1UIZZoBHzidg7tyX2WFjgMUBqlgAKkEaKsm1Xp0JiJjPc1bhyf2gOYu+0dng3fiS8hS28J7y+FMx7ejKvcIcMApD/dTgKwePtQT7T1HO3bYRs2lj1dMwCsLjdUyKtysCmRirQC8wVHvUUCyH++Chov27uU5QrbfGWZOa0D+9GZf4OoViNtTD0zq4DbD1ioGHRRi+FRhnLhucwVSrdAwy8fhMO2edhwNLLRnDvOJla1AMO+QshR9kOhl4PRiMbWngxtJnfRmkSlU/5VrFornOntOIS7RNjGoqwgp4hYI3TQ4OP8hXZ+NkPpNJyf3vyfoCDFtkUCJzxvhjbZ0d9T4NTPUdoVjkvUL12riEsX2SD/z9qnEnXFtM1c1vggwUHPX1GriOg5HJ78poH+VGvlwWs2rL/SvMWnBkCnuZsYo3D7CS+k6dCv/DbuobrPvN7sivzJHW5Tcnx0V1LwaSCPDaHUxJFWYUnGBpJDS8/zOjfLa7mboYtFDKY+lpt9g1oC4NYjZzfFQiQrcX/HzUn0thJ0RahzwsOKljDjMG6jway+aEH+YcsEV8HF8C39hAhthI7z1oz7sJBgvNxA679Q== andy.sellick@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-andysellick.pp\n# Target line: 6\n\n      1: # Creates the andysellick user\n      2: class users::andysellick {\n      3:   govuk_user { 'andysellick':\n      4:     fullname => 'Andy Sellick',\n      5:     email    => 'andy.sellick@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCzgYIqGtST23/OgNRRLtJD7m7+Lsvos3oQxuktiRfBKZ8SblLSssbjGC1DJG24ZGT6f+BBROpz86uxEVe86K0NWU6I1UIZZoBHzidg7tyX2WFjgMUBqlgAKkEaKsm1Xp0JiJjPc1bhyf2gOYu+0dng3fiS8hS28J7y+FMx7ejKvcIcMApD/dTgKwePtQT7T1HO3bYRs2lj1dMwCsLjdUyKtysCmRirQC8wVHvUUCyH++Chov27uU5QrbfGWZOa0D+9GZf4OoViNtTD0zq4DbD1ioGHRRi+FRhnLhucwVSrdAwy8fhMO2edhwNLLRnDvOJla1AMO+QshR9kOhl4PRiMbWngxtJnfRmkSlU/5VrFornOntOIS7RNjGoqwgp4hYI3TQ4OP8hXZ+NkPpNJyf3vyfoCDFtkUCJzxvhjbZ0d9T4NTPUdoVjkvUL12riEsX2SD/z9qnEnXFtM1c1vggwUHPX1GriOg5HJ78poH+VGvlwWs2rL/SvMWnBkCnuZsYo3D7CS+k6dCv/DbuobrPvN7sivzJHW5Tcnx0V1LwaSCPDaHUxJFWYUnGBpJDS8/zOjfLa7mboYtFDKY+lpt9g1oC4NYjZzfFQiQrcX/HzUn0thJ0RahzwsOKljDjMG6jway+aEH+YcsEV8HF8C39hAhthI7z1oz7sJBgvNxA679Q== andy.sellick@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-gerrit-manifests-cron.pp", "content": "user        => 'gerrit2',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: openstack-infra@puppet-gerrit-manifests-cron.pp\n\ncron { 'gerrit_repack':\nensure => absent,\nuser   => 'gerrit2',\n}\ncron { 'optimize_git_repo':\n21:     user        => 'gerrit2',\nweekday     => '0',\nhour        => '4',\nminute      => '7',\ncommand     => \"find /home/gerrit2/review_site/git/ -type d -name \\\"*.git\\\" -print -exec git --git-dir=\\\"{}\\\" ${git_cmd} \\\\;\",\nenvironment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-gerrit-manifests-cron.pp\n# Target line: 21\n\n     16:   cron { 'gerrit_repack':\n     17:     ensure => absent,\n     18:     user   => 'gerrit2',\n     19:   }\n     20:   cron { 'optimize_git_repo':\n>>>  21:     user        => 'gerrit2',\n     22:     weekday     => '0',\n     23:     hour        => '4',\n     24:     minute      => '7',\n     25:     command     => \"find /home/gerrit2/review_site/git/ -type d -name \\\"*.git\\\" -print -exec git --git-dir=\\\"{}\\\" ${git_cmd} \\\\;\",\n     26:     environment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "password => 'content_planner',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\npassword => 'contacts',\nrequire  => Class['::mysql::server'];\n\n'content_planner_test':\nuser     => 'content_planner',\n30:       password => 'content_planner',\nrequire  => Class['::mysql::server'];\n\n[\n'efg_test',\n'efg_test1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 30\n\n     25:       password => 'contacts',\n     26:       require  => Class['::mysql::server'];\n     27: \n     28:     'content_planner_test':\n     29:       user     => 'content_planner',\n>>>  30:       password => 'content_planner',\n     31:       require  => Class['::mysql::server'];\n     32: \n     33:     [\n     34:       'efg_test',\n     35:       'efg_test1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance.pp", "content": "$_user = pick($user, $::tomcat::user)", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance.pp\n\ninclude tomcat\n$_catalina_home = pick($catalina_home, $::tomcat::catalina_home)\n$_catalina_base = pick($catalina_base, $_catalina_home) #default to home\ntag(sha1($_catalina_home))\ntag(sha1($_catalina_base))\n52:   $_user = pick($user, $::tomcat::user)\n$_group = pick($group, $::tomcat::group)\n$_manage_user = pick($manage_user, $::tomcat::manage_user)\n$_manage_group = pick($manage_group, $::tomcat::manage_group)\n$_manage_base = pick($manage_base, $::tomcat::manage_base)\n$_manage_properties = pick($manage_properties, $::tomcat::manage_properties)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance.pp\n# Target line: 52\n\n     47:   include tomcat\n     48:   $_catalina_home = pick($catalina_home, $::tomcat::catalina_home)\n     49:   $_catalina_base = pick($catalina_base, $_catalina_home) #default to home\n     50:   tag(sha1($_catalina_home))\n     51:   tag(sha1($_catalina_base))\n>>>  52:   $_user = pick($user, $::tomcat::user)\n     53:   $_group = pick($group, $::tomcat::group)\n     54:   $_manage_user = pick($manage_user, $::tomcat::manage_user)\n     55:   $_manage_group = pick($manage_group, $::tomcat::manage_group)\n     56:   $_manage_base = pick($manage_base, $::tomcat::manage_base)\n     57:   $_manage_properties = pick($manage_properties, $::tomcat::manage_properties)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus1000v.pp", "content": "'ml2_cisco_n1kv/password'                      : value => $n1kv_vsm_password, secret => true;", "line": 97, "detection_span": [92, 102], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus1000v.pp\n\ninclude ::neutron::plugins::ml2::cisco\n\nneutron_plugin_ml2 {\n'ml2_cisco_n1kv/n1kv_vsm_ips'                  : value => $n1kv_vsm_ip;\n'ml2_cisco_n1kv/username'                      : value => $n1kv_vsm_username;\n97:     'ml2_cisco_n1kv/password'                      : value => $n1kv_vsm_password, secret => true;\n'ml2_cisco_n1kv/default_policy_profile'        : value => $default_policy_profile;\n'ml2_cisco_n1kv/default_vlan_network_profile'  : value => $default_vlan_network_profile;\n'ml2_cisco_n1kv/default_vxlan_network_profile' : value => $default_vxlan_network_profile;\n'ml2_cisco_n1kv/poll_duration'                 : value => $poll_duration;\n'ml2_cisco_n1kv/http_pool_size'                : value => $http_pool_size;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus1000v.pp\n# Target line: 97\n\n     92:   include ::neutron::plugins::ml2::cisco\n     93: \n     94:   neutron_plugin_ml2 {\n     95:     'ml2_cisco_n1kv/n1kv_vsm_ips'                  : value => $n1kv_vsm_ip;\n     96:     'ml2_cisco_n1kv/username'                      : value => $n1kv_vsm_username;\n>>>  97:     'ml2_cisco_n1kv/password'                      : value => $n1kv_vsm_password, secret => true;\n     98:     'ml2_cisco_n1kv/default_policy_profile'        : value => $default_policy_profile;\n     99:     'ml2_cisco_n1kv/default_vlan_network_profile'  : value => $default_vlan_network_profile;\n    100:     'ml2_cisco_n1kv/default_vxlan_network_profile' : value => $default_vxlan_network_profile;\n    101:     'ml2_cisco_n1kv/poll_duration'                 : value => $poll_duration;\n    102:     'ml2_cisco_n1kv/http_pool_size'                : value => $http_pool_size;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-mapit.pp", "content": "user                => 'mapit',", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-mapit.pp\n\nsentry_dsn            => $sentry_dsn,\nmonitor_unicornherder => true,\n}\n\ngovuk_postgresql::db { 'mapit':\n41:       user                => 'mapit',\npassword            => $db_password,\nextensions          => ['plpgsql', 'postgis'],\nenable_in_pgbouncer => false,\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-mapit.pp\n# Target line: 41\n\n     36:       sentry_dsn            => $sentry_dsn,\n     37:       monitor_unicornherder => true,\n     38:     }\n     39: \n     40:     govuk_postgresql::db { 'mapit':\n>>>  41:       user                => 'mapit',\n     42:       password            => $db_password,\n     43:       extensions          => ['plpgsql', 'postgis'],\n     44:       enable_in_pgbouncer => false,\n     45:     }\n     46: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-kentsang.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7b3NnBnUVDh9fDud8HtxJ8KKL+EeHKNomIrurFZ716G3j00FHX3igkFVILQKJ5B5aZAwpwHcIWDkoRd4VItUAhfWIHndLFb86A+c+YADQHqCeNIzOLUg4Qac6YTGY64iFfDSuox6UHRLK5k/JrmGAYQWsrhUivsezu3Xjab/r5dTjcLiOeSLqInrNqusvYKfU39ZS6sewpOXULEyAnb+n11QP+1EiMtRP1dpxZWxOLFjHnXKDzO0CWDm2VNquFK8C85gnFZ6bsfz7JPnpO18eh2PIZNgyo7sWjd3iArBHhZeflgmjnBJBEeeGYCE92wnuFvjdRfyhOAbMZmKSW44R7u1h5QsB3rkUp5kgha5hAfmNRO+ww25U0Fn+L1f6fHBoSlyfXy6AQuGNZw+zkIfNOLleABToH6zDWMLIJOWly85wWdpABWjQ3siekOgCyhblU1cORgGiOAPHriQz8caYGB2LkSMZ2TY2odseWDqLSe0x2XBu+XNbuJFK+hnkcoVjLcaeYDCN2T2aQnhhhbY22BTkA729LyS+V1O7vNWL8/CrBvLtGNgraz/bv+6l4x/Cuj4pqRBanMWBbfL276O3HEd4Y2psWRlTXhqBXOsfeyFavBP8KkPO5wqutg13Ncgy7Vo2bfKafou89jMYoe4gqC8ZL01I6Od9SDFbgXhMdQ== ken.tsang@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-kentsang.pp\n\n# Create the kentsang user\nclass users::kentsang {\ngovuk_user { 'kentsang':\nfullname => 'Ken Tsang',\nemail    => 'ken.tsang@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7b3NnBnUVDh9fDud8HtxJ8KKL+EeHKNomIrurFZ716G3j00FHX3igkFVILQKJ5B5aZAwpwHcIWDkoRd4VItUAhfWIHndLFb86A+c+YADQHqCeNIzOLUg4Qac6YTGY64iFfDSuox6UHRLK5k/JrmGAYQWsrhUivsezu3Xjab/r5dTjcLiOeSLqInrNqusvYKfU39ZS6sewpOXULEyAnb+n11QP+1EiMtRP1dpxZWxOLFjHnXKDzO0CWDm2VNquFK8C85gnFZ6bsfz7JPnpO18eh2PIZNgyo7sWjd3iArBHhZeflgmjnBJBEeeGYCE92wnuFvjdRfyhOAbMZmKSW44R7u1h5QsB3rkUp5kgha5hAfmNRO+ww25U0Fn+L1f6fHBoSlyfXy6AQuGNZw+zkIfNOLleABToH6zDWMLIJOWly85wWdpABWjQ3siekOgCyhblU1cORgGiOAPHriQz8caYGB2LkSMZ2TY2odseWDqLSe0x2XBu+XNbuJFK+hnkcoVjLcaeYDCN2T2aQnhhhbY22BTkA729LyS+V1O7vNWL8/CrBvLtGNgraz/bv+6l4x/Cuj4pqRBanMWBbfL276O3HEd4Y2psWRlTXhqBXOsfeyFavBP8KkPO5wqutg13Ncgy7Vo2bfKafou89jMYoe4gqC8ZL01I6Od9SDFbgXhMdQ== ken.tsang@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-kentsang.pp\n# Target line: 6\n\n      1: # Create the kentsang user\n      2: class users::kentsang {\n      3:   govuk_user { 'kentsang':\n      4:     fullname => 'Ken Tsang',\n      5:     email    => 'ken.tsang@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7b3NnBnUVDh9fDud8HtxJ8KKL+EeHKNomIrurFZ716G3j00FHX3igkFVILQKJ5B5aZAwpwHcIWDkoRd4VItUAhfWIHndLFb86A+c+YADQHqCeNIzOLUg4Qac6YTGY64iFfDSuox6UHRLK5k/JrmGAYQWsrhUivsezu3Xjab/r5dTjcLiOeSLqInrNqusvYKfU39ZS6sewpOXULEyAnb+n11QP+1EiMtRP1dpxZWxOLFjHnXKDzO0CWDm2VNquFK8C85gnFZ6bsfz7JPnpO18eh2PIZNgyo7sWjd3iArBHhZeflgmjnBJBEeeGYCE92wnuFvjdRfyhOAbMZmKSW44R7u1h5QsB3rkUp5kgha5hAfmNRO+ww25U0Fn+L1f6fHBoSlyfXy6AQuGNZw+zkIfNOLleABToH6zDWMLIJOWly85wWdpABWjQ3siekOgCyhblU1cORgGiOAPHriQz8caYGB2LkSMZ2TY2odseWDqLSe0x2XBu+XNbuJFK+hnkcoVjLcaeYDCN2T2aQnhhhbY22BTkA729LyS+V1O7vNWL8/CrBvLtGNgraz/bv+6l4x/Cuj4pqRBanMWBbfL276O3HEd4Y2psWRlTXhqBXOsfeyFavBP8KkPO5wqutg13Ncgy7Vo2bfKafou89jMYoe4gqC8ZL01I6Od9SDFbgXhMdQ== ken.tsang@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq.pp", "content": "$amqp_pass  = 'email_alert_service',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq.pp\n\n#   a warning.\n#\nclass govuk::apps::email_alert_service::rabbitmq (\n$ensure = 'present',\n$amqp_user  = 'email_alert_service',\n38:   $amqp_pass  = 'email_alert_service',\n$amqp_exchange = 'published_documents',\n$amqp_major_change_queue = 'email_alert_service',\n$amqp_unpublishing_queue = 'email_unpublishing',\n$amqp_workflow_queue = 'email_alert_service_workflow',\n$queue_size_critical_threshold,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq.pp\n# Target line: 38\n\n     33: #   a warning.\n     34: #\n     35: class govuk::apps::email_alert_service::rabbitmq (\n     36:   $ensure = 'present',\n     37:   $amqp_user  = 'email_alert_service',\n>>>  38:   $amqp_pass  = 'email_alert_service',\n     39:   $amqp_exchange = 'published_documents',\n     40:   $amqp_major_change_queue = 'email_alert_service',\n     41:   $amqp_unpublishing_queue = 'email_unpublishing',\n     42:   $amqp_workflow_queue = 'email_alert_service_workflow',\n     43:   $queue_size_critical_threshold,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-postfix-manifests-init.pp", "content": "$smarthost_user = undef,", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n\n# [*smarthost_pass*]\n#   Pass to authenticate all relayed mail with.\n#\nclass postfix (\n$smarthost = undef,\n27:   $smarthost_user = undef,\n$smarthost_pass = undef,\n$rewrite_mail_domain = 'localhost',\n$rewrite_mail_list = 'noemail'\n) {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n# Target line: 27\n\n     22: # [*smarthost_pass*]\n     23: #   Pass to authenticate all relayed mail with.\n     24: #\n     25: class postfix (\n     26:   $smarthost = undef,\n>>>  27:   $smarthost_user = undef,\n     28:   $smarthost_pass = undef,\n     29:   $rewrite_mail_domain = 'localhost',\n     30:   $rewrite_mail_list = 'noemail'\n     31: ) {\n     32: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-mouse-swipe_between_pages.pp", "content": "key    => 'AppleEnableMouseSwipeNavigateWithScrolls',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: boxen@puppet-osx-manifests-mouse-swipe_between_pages.pp\n\n# Public: Enable/disable swipe between pages for multitouch mice (default = disabled). Requires re-login.\nclass osx::mouse::swipe_between_pages($enabled = false) {\nboxen::osx_defaults { 'Enable swipe between pages for multitouch mice':\nuser   => $::boxen_user,\ndomain => 'NSGlobalDomain',\n6:     key    => 'AppleEnableMouseSwipeNavigateWithScrolls',\nvalue  => $enabled,\ntype   => 'boolean'\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-mouse-swipe_between_pages.pp\n# Target line: 6\n\n      1: # Public: Enable/disable swipe between pages for multitouch mice (default = disabled). Requires re-login.\n      2: class osx::mouse::swipe_between_pages($enabled = false) {\n      3:   boxen::osx_defaults { 'Enable swipe between pages for multitouch mice':\n      4:     user   => $::boxen_user,\n      5:     domain => 'NSGlobalDomain',\n>>>   6:     key    => 'AppleEnableMouseSwipeNavigateWithScrolls',\n      7:     value  => $enabled,\n      8:     type   => 'boolean'\n      9:   }\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'D27A72F32D867DF9300A241574490FD6EC51E8C4';", "line": 136, "detection_span": [131, 141], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'testing',\nkey      => '6026DFCA';\n'sysdig':\nlocation => 'http://download.draios.com/stable/deb',\nrelease  => 'stable-amd64/',\n136:       key      => 'D27A72F32D867DF9300A241574490FD6EC51E8C4';\n'yarn':\nlocation => 'https://dl.yarnpkg.com/debian/',\nrelease  => 'stable',\nrepos    => ['main'],\nkey      => '72ECF46A56B4AD39C907BBB71646B01B86E50310';", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 136\n\n    131:       release  => 'testing',\n    132:       key      => '6026DFCA';\n    133:     'sysdig':\n    134:       location => 'http://download.draios.com/stable/deb',\n    135:       release  => 'stable-amd64/',\n>>> 136:       key      => 'D27A72F32D867DF9300A241574490FD6EC51E8C4';\n    137:     'yarn':\n    138:       location => 'https://dl.yarnpkg.com/debian/',\n    139:       release  => 'stable',\n    140:       repos    => ['main'],\n    141:       key      => '72ECF46A56B4AD39C907BBB71646B01B86E50310';\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-init.pp", "content": "$mms_token       = undef,", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-init.pp\n\n$nohttpinterface = undef,\n$noscripting     = undef,\n$notablescan     = undef,\n$noprealloc      = undef,\n$nssize          = undef,\n68:   $mms_token       = undef,\n$mms_name        = undef,\n$mms_interval    = undef,\n$slave           = undef,\n$only            = undef,\n$master          = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-init.pp\n# Target line: 68\n\n     63:   $nohttpinterface = undef,\n     64:   $noscripting     = undef,\n     65:   $notablescan     = undef,\n     66:   $noprealloc      = undef,\n     67:   $nssize          = undef,\n>>>  68:   $mms_token       = undef,\n     69:   $mms_name        = undef,\n     70:   $mms_interval    = undef,\n     71:   $slave           = undef,\n     72:   $only            = undef,\n     73:   $master          = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring.pp", "content": "key     => 'crm.node.check[*]',", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring.pp\n\ncommand => '/etc/zabbix/scripts/vfs.mdadm.discovery.sh';\n'proc.vmstat':\nkey     => 'proc.vmstat[*]',\ncommand => 'grep \\'$1\\' /proc/vmstat | awk \\'{print $$2}\\'';\n'crm.node.check':\n86:         key     => 'crm.node.check[*]',\ncommand => '/etc/zabbix/scripts/crm_node_check.sh $1';\n'netns.udp.listen':\nkey     => 'netns.udp.listen[*]',\ncommand => '/usr/bin/sudo /etc/zabbix/scripts/netns.listen.sh UDP $1 $2 $3';\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring.pp\n# Target line: 86\n\n     81:         command => '/etc/zabbix/scripts/vfs.mdadm.discovery.sh';\n     82:       'proc.vmstat':\n     83:         key     => 'proc.vmstat[*]',\n     84:         command => 'grep \\'$1\\' /proc/vmstat | awk \\'{print $$2}\\'';\n     85:       'crm.node.check':\n>>>  86:         key     => 'crm.node.check[*]',\n     87:         command => '/etc/zabbix/scripts/crm_node_check.sh $1';\n     88:       'netns.udp.listen':\n     89:         key     => 'netns.udp.listen[*]',\n     90:         command => '/usr/bin/sudo /etc/zabbix/scripts/netns.listen.sh UDP $1 $2 $3';\n     91:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "epost-dev@opennebula-puppet-module-manifests-prerequisites.pp", "content": "key_source => 'http://downloads.opennebula.org/repo/Debian/repo.key',", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: epost-dev@opennebula-puppet-module-manifests-prerequisites.pp\n\ndefault: { fail(\"Unrecognized operating system ${::operatingsystem}\") }\n}\n\napt::key { 'one_repo_key':\nkey        => '85E16EBF',\n58:           key_source => 'http://downloads.opennebula.org/repo/Debian/repo.key',\n} ->\n\napt::source { 'one-official': # lint:ignore:security_apt_no_key\nlocation          => \"http://downloads.opennebula.org/repo/${apt_location}\",\nrelease           => 'stable',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: epost-dev@opennebula-puppet-module-manifests-prerequisites.pp\n# Target line: 58\n\n     53:           default: { fail(\"Unrecognized operating system ${::operatingsystem}\") }\n     54:         }\n     55: \n     56:         apt::key { 'one_repo_key':\n     57:           key        => '85E16EBF',\n>>>  58:           key_source => 'http://downloads.opennebula.org/repo/Debian/repo.key',\n     59:         } ->\n     60: \n     61:         apt::source { 'one-official': # lint:ignore:security_apt_no_key\n     62:           location          => \"http://downloads.opennebula.org/repo/${apt_location}\",\n     63:           release           => 'stable',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@foreman-installer-staypuft-modules-foreman-manifests-plugin-staypuft_client.pp", "content": "$puppetssh_user = 'root',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: theforeman@foreman-installer-staypuft-modules-foreman-manifests-plugin-staypuft_client.pp\n\n# $puppetssh_user::             A user to use when connecting using SSH\n#\n# $staypuft_ssh_public_key::    This key will be added to SSH authorized keys\n#\nclass foreman::plugin::staypuft_client(\n12:   $puppetssh_user = 'root',\n$staypuft_ssh_public_key,\n) {\nssh_authorized_key { 'staypuft public key':\nkey  => $staypuft_ssh_public_key,\nuser => $puppetssh_user,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@foreman-installer-staypuft-modules-foreman-manifests-plugin-staypuft_client.pp\n# Target line: 12\n\n      7: # $puppetssh_user::             A user to use when connecting using SSH\n      8: #\n      9: # $staypuft_ssh_public_key::    This key will be added to SSH authorized keys\n     10: #\n     11: class foreman::plugin::staypuft_client(\n>>>  12:   $puppetssh_user = 'root',\n     13:   $staypuft_ssh_public_key,\n     14: ) {\n     15:   ssh_authorized_key { 'staypuft public key':\n     16:     key  => $staypuft_ssh_public_key,\n     17:     user => $puppetssh_user,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-server-monitor.pp", "content": "$mysql_monitor_username = '',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-manifests-server-monitor.pp\n\n#This is a helper class to add a monitoring user to the database\nclass mysql::server::monitor (\n3:   $mysql_monitor_username = '',\n$mysql_monitor_password = '',\n$mysql_monitor_hostname = ''\n) {\n\nAnchor['mysql::server::end'] -> Class['mysql::server::monitor']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-manifests-server-monitor.pp\n# Target line: 3\n\n      1: #This is a helper class to add a monitoring user to the database\n      2: class mysql::server::monitor (\n>>>   3:   $mysql_monitor_username = '',\n      4:   $mysql_monitor_password = '',\n      5:   $mysql_monitor_hostname = ''\n      6: ) {\n      7: \n      8:   Anchor['mysql::server::end'] -> Class['mysql::server::monitor']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$ostf_db_user                  = 'ostf'", "line": 128, "detection_span": [123, 133], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n123:   $nailgun_serialization_port    = '8002'\n$nailgun_ssl_port              = '8443'\n125:\n$ostf_host                     = '127.0.0.1'\n$ostf_port                     = '8777'\n128:   $ostf_db_user                  = 'ostf'\n$ostf_db_password              = 'ostf'\n$ostf_db_name                  = 'ostf'\n131: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 128\n\n    123:   $nailgun_serialization_port    = '8002'\n    124:   $nailgun_ssl_port              = '8443'\n    125: \n    126:   $ostf_host                     = '127.0.0.1'\n    127:   $ostf_port                     = '8777'\n>>> 128:   $ostf_db_user                  = 'ostf'\n    129:   $ostf_db_password              = 'ostf'\n    130:   $ostf_db_name                  = 'ostf'\n    131: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-master.pp", "content": "www_root => '/usr/share/error_pages',", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-master.pp\n\nensure   => 'present',\nvhost    => 'jenkins',\nlocation => '~ ^\\/(mirantis|fuel-infra)\\/(403|404|5xx)\\.html$',\nssl      => true,\nssl_only => true,\n64:     www_root => '/usr/share/error_pages',\nrequire  => Package['error-pages'],\n}\n\n$jenkins_additional_ssh_keys = hiera_hash('fuel_project::jenkins::master::jenkins_additional_ssh_keys', {})\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-master.pp\n# Target line: 64\n\n     59:     ensure   => 'present',\n     60:     vhost    => 'jenkins',\n     61:     location => '~ ^\\/(mirantis|fuel-infra)\\/(403|404|5xx)\\.html$',\n     62:     ssl      => true,\n     63:     ssl_only => true,\n>>>  64:     www_root => '/usr/share/error_pages',\n     65:     require  => Package['error-pages'],\n     66:   }\n     67: \n     68:   $jenkins_additional_ssh_keys = hiera_hash('fuel_project::jenkins::master::jenkins_additional_ssh_keys', {})\n     69: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder.pp", "content": "$jenkins_api_token = '',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder.pp\n\n#\nclass govuk_jenkins::job_builder (\n$app_domain = hiera('app_domain'),\n$environment = 'development',\n$jenkins_api_user = 'jenkins_api_user',\n38:   $jenkins_api_token = '',\n$jenkins_url = 'http://localhost:8080/',\n$jobs = [],\n) {\n\nvalidate_array($jobs)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder.pp\n# Target line: 38\n\n     33: #\n     34: class govuk_jenkins::job_builder (\n     35:   $app_domain = hiera('app_domain'),\n     36:   $environment = 'development',\n     37:   $jenkins_api_user = 'jenkins_api_user',\n>>>  38:   $jenkins_api_token = '',\n     39:   $jenkins_url = 'http://localhost:8080/',\n     40:   $jobs = [],\n     41: ) {\n     42: \n     43:   validate_array($jobs)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-zuul-manifests-merger.pp", "content": "user        => 'zuul',", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: openstack-infra@puppet-zuul-manifests-merger.pp\n\nrequire    => [File['/etc/init.d/zuul-merger'],\nClass['zuul::systemd_reload']]\n}\n\ncron { 'zuul_repack':\n32:     user        => 'zuul',\nhour        => '4',\nminute      => '7',\ncommand     => 'find /var/lib/zuul/git/ -maxdepth 3 -type d -name \".git\" -exec git --git-dir=\"{}\" pack-refs --all \\;',\nenvironment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',\nrequire     => [User['zuul'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-zuul-manifests-merger.pp\n# Target line: 32\n\n     27:     require    => [File['/etc/init.d/zuul-merger'],\n     28:                   Class['zuul::systemd_reload']]\n     29:   }\n     30: \n     31:   cron { 'zuul_repack':\n>>>  32:     user        => 'zuul',\n     33:     hour        => '4',\n     34:     minute      => '7',\n     35:     command     => 'find /var/lib/zuul/git/ -maxdepth 3 -type d -name \".git\" -exec git --git-dir=\"{}\" pack-refs --all \\;',\n     36:     environment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',\n     37:     require     => [User['zuul'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-nginx.pp", "content": "ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-nginx.pp\n\nlisten_port            => 4637,\ngzip_types             => 'application/octet-stream',\nssl_port               => 4637,\nssl                    => true,\nssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\n27:       ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\nssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\nssl_crl                => '/var/lib/puppet/ssl/crl.pem',\nssl_verify_client      => 'on',\nwww_root               => '/var/log',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-nginx.pp\n# Target line: 27\n\n     22:       listen_port            => 4637,\n     23:       gzip_types             => 'application/octet-stream',\n     24:       ssl_port               => 4637,\n     25:       ssl                    => true,\n     26:       ssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\n>>>  27:       ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\n     28:       ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\n     29:       ssl_crl                => '/var/lib/puppet/ssl/crl.pem',\n     30:       ssl_verify_client      => 'on',\n     31:       www_root               => '/var/log',\n     32:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-custom_scripts.pp", "content": "$docker_user   = 'jenkins',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-custom_scripts.pp\n\n#\n\nclass fuel_project::jenkins::slave::custom_scripts (\n$configs_dir   = '/etc/custom_scripts/',\n$configs_paths = {},\n13:   $docker_user   = 'jenkins',\n$known_hosts   = undef,\n) {\n$configs = hiera_hash('fuel_project::jenkins::slave::custom_scripts::configs', {})\n$packages = [\n'git',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-custom_scripts.pp\n# Target line: 13\n\n      8: #\n      9: \n     10: class fuel_project::jenkins::slave::custom_scripts (\n     11:   $configs_dir   = '/etc/custom_scripts/',\n     12:   $configs_paths = {},\n>>>  13:   $docker_user   = 'jenkins',\n     14:   $known_hosts   = undef,\n     15: ) {\n     16:   $configs = hiera_hash('fuel_project::jenkins::slave::custom_scripts::configs', {})\n     17:   $packages = [\n     18:     'git',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-cisco-vts.pp", "content": "'ml2_cc/password':     value => $vts_password, secret => true;", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-vts.pp\n\n}\n)\n\nneutron_plugin_ml2 {\n'ml2_cc/username':     value => $vts_username;\n68:     'ml2_cc/password':     value => $vts_password, secret => true;\n'ml2_cc/url':          value => $vts_url;\n'ml2_cc/timeout':      value => $vts_timeout;\n'ml2_cc/sync_timeout': value => $vts_sync_timeout;\n'ml2_cc/retry_count':  value => $vts_retry_count;\n'ml2_cc/vmm_id':       value => $vts_vmmid;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-vts.pp\n# Target line: 68\n\n     63:     }\n     64:   )\n     65: \n     66:   neutron_plugin_ml2 {\n     67:     'ml2_cc/username':     value => $vts_username;\n>>>  68:     'ml2_cc/password':     value => $vts_password, secret => true;\n     69:     'ml2_cc/url':          value => $vts_url;\n     70:     'ml2_cc/timeout':      value => $vts_timeout;\n     71:     'ml2_cc/sync_timeout': value => $vts_sync_timeout;\n     72:     'ml2_cc/retry_count':  value => $vts_retry_count;\n     73:     'ml2_cc/vmm_id':       value => $vts_vmmid;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "echoes-tech@puppet-monit-manifests-params.pp", "content": "$httpd_password            = 'monit'", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: echoes-tech@puppet-monit-manifests-params.pp\n\n$config_dir_purge          = false\n$httpd                     = false\n$httpd_port                = 2812\n$httpd_address             = 'localhost'\n$httpd_user                = 'admin'\n11:   $httpd_password            = 'monit'\n$manage_firewall           = false\n$package_ensure            = 'present'\n$package_name              = 'monit'\n$service_enable            = true\n$service_ensure            = 'running'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: echoes-tech@puppet-monit-manifests-params.pp\n# Target line: 11\n\n      6:   $config_dir_purge          = false\n      7:   $httpd                     = false\n      8:   $httpd_port                = 2812\n      9:   $httpd_address             = 'localhost'\n     10:   $httpd_user                = 'admin'\n>>>  11:   $httpd_password            = 'monit'\n     12:   $manage_firewall           = false\n     13:   $package_ensure            = 'present'\n     14:   $package_name              = 'monit'\n     15:   $service_enable            = true\n     16:   $service_ensure            = 'running'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-userprefs-manifests-editors_registry.pp", "content": "key    => 'HKLM\\Software\\Classes\\sourcecode',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n\nclass userprefs::editors_registry {\nregistry::value { 'Filetype description':\n3:     key    => 'HKLM\\Software\\Classes\\sourcecode',\nvalue  => '(Default)',\ndata   => 'Source Code',\n}\n\nregistry::value { 'Puppet Manifests':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n# Target line: 3\n\n      1: class userprefs::editors_registry {\n      2:   registry::value { 'Filetype description':\n>>>   3:     key    => 'HKLM\\Software\\Classes\\sourcecode',\n      4:     value  => '(Default)',\n      5:     data   => 'Source Code',\n      6:   }\n      7: \n      8:   registry::value { 'Puppet Manifests':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "garethr@garethr-docker-manifests-registry.pp", "content": "$password    = undef,", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: garethr@garethr-docker-manifests-registry.pp\n\n#\ndefine docker::registry(\n$server      = $title,\n$ensure      = 'present',\n$username    = undef,\n34:   $password    = undef,\n$email       = undef,\n$local_user  = 'root',\n) {\ninclude docker::params\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: garethr@garethr-docker-manifests-registry.pp\n# Target line: 34\n\n     29: #\n     30: define docker::registry(\n     31:   $server      = $title,\n     32:   $ensure      = 'present',\n     33:   $username    = undef,\n>>>  34:   $password    = undef,\n     35:   $email       = undef,\n     36:   $local_user  = 'root',\n     37: ) {\n     38:   include docker::params\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp", "content": "netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n\nensure_packages(['iscsi-initiator-utils'], {'ensure' => 'present'})\n}\n\nelsif $netapp_storage_protocol == 'fc' {\ncinder::backend::netapp { $netapp_backend_name:\n95:           netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\nnetapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\nnetapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\nnetapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\nnetapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\nnetapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n# Target line: 95\n\n     90:         ensure_packages(['iscsi-initiator-utils'], {'ensure' => 'present'})\n     91:       }\n     92: \n     93:       elsif $netapp_storage_protocol == 'fc' {\n     94:         cinder::backend::netapp { $netapp_backend_name:\n>>>  95:           netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\n     96:           netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\n     97:           netapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\n     98:           netapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\n     99:           netapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\n    100:           netapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "user     => 'release',", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\nuser     => 'efg',\npassword => 'efg',\nrequire  => Class['::mysql::server'];\n\n['release_development', 'release_test']:\n49:       user     => 'release',\npassword => 'release',\nrequire  => Class['::mysql::server'];\n\n'search_admin_test':\nuser     => 'search_admin',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 49\n\n     44:       user     => 'efg',\n     45:       password => 'efg',\n     46:       require  => Class['::mysql::server'];\n     47: \n     48:     ['release_development', 'release_test']:\n>>>  49:       user     => 'release',\n     50:       password => 'release',\n     51:       require  => Class['::mysql::server'];\n     52: \n     53:     'search_admin_test':\n     54:       user     => 'search_admin',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "$ssl_kibana_key_file          = '/etc/nginx/ssl_kibana.key',", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\n$ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n$ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n$ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n$ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',\n$ssl_kibana_certificate       = $log_storage::params::nginx_ssl_kibana_certificate,\n47:   $ssl_kibana_key_file          = '/etc/nginx/ssl_kibana.key',\n$ssl_kibana_key               = $log_storage::params::nginx_ssl_kibana_key,\n$www_root                     = '/var/www/html',\n) inherits log_storage::params {\n\nif ($ssl_elastic_certificate and $ssl_elastic_key_file) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 47\n\n     42:   $ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n     43:   $ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n     44:   $ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n     45:   $ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',\n     46:   $ssl_kibana_certificate       = $log_storage::params::nginx_ssl_kibana_certificate,\n>>>  47:   $ssl_kibana_key_file          = '/etc/nginx/ssl_kibana.key',\n     48:   $ssl_kibana_key               = $log_storage::params::nginx_ssl_kibana_key,\n     49:   $www_root                     = '/var/www/html',\n     50: ) inherits log_storage::params {\n     51: \n     52:   if ($ssl_elastic_certificate and $ssl_elastic_key_file) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-system-two_shell_calls-manifests-account.pp", "content": "password   => pw_hash($password, 'SHA-512', 'mysalt'),", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-two_shell_calls-manifests-account.pp\n\ndefine two_shell_calls::account($username, $password, $strings_to_leak, $leaked_filenames) {\n::accounts::user { $username:\nshell      => '/bin/bash',\n4:     password   => pw_hash($password, 'SHA-512', 'mysalt'),\nmanagehome => true,\nhome_mode  => '0755',\n}\n\n# Leak strings in a text file in the users home directory", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-two_shell_calls-manifests-account.pp\n# Target line: 4\n\n      1: define two_shell_calls::account($username, $password, $strings_to_leak, $leaked_filenames) {\n      2:   ::accounts::user { $username:\n      3:     shell      => '/bin/bash',\n>>>   4:     password   => pw_hash($password, 'SHA-512', 'mysalt'),\n      5:     managehome => true,\n      6:     home_mode  => '0755',\n      7:   }\n      8: \n      9:   # Leak strings in a text file in the users home directory\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-jenkins-manifests-slave.pp", "content": "$user = true,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n\n# == Class: jenkins::slave\n#\nclass jenkins::slave(\n$ssh_key = undef,\n5:   $user = true,\n$gitfullname = 'OpenStack Jenkins',\n$gitemail = 'jenkins@openstack.org',\n$gitpgpkey = 'jenkins@openstack.org',\n$gerrituser = 'jenkins',\n$gerritkeytype = 'rsa',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n# Target line: 5\n\n      1: # == Class: jenkins::slave\n      2: #\n      3: class jenkins::slave(\n      4:   $ssh_key = undef,\n>>>   5:   $user = true,\n      6:   $gitfullname = 'OpenStack Jenkins',\n      7:   $gitemail = 'jenkins@openstack.org',\n      8:   $gitpgpkey = 'jenkins@openstack.org',\n      9:   $gerrituser = 'jenkins',\n     10:   $gerritkeytype = 'rsa',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp", "content": "$access_token = '',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n\n#   [*sshprivkey_contents*] - SSH private key file contents\n#   [*update_status*] - update ticket statuses\n#   [*username*] - SSH username\n#\nclass fuel_project::devops_tools::lpupdatebug (\n26:   $access_token = '',\n$access_secret = '',\n$appname = 'lpupdatebug',\n$cachedir = '/var/tmp/launchpadlib/',\n$consumer_key = '',\n$consumer_secret = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n# Target line: 26\n\n     21: #   [*sshprivkey_contents*] - SSH private key file contents\n     22: #   [*update_status*] - update ticket statuses\n     23: #   [*username*] - SSH username\n     24: #\n     25: class fuel_project::devops_tools::lpupdatebug (\n>>>  26:   $access_token = '',\n     27:   $access_secret = '',\n     28:   $appname = 'lpupdatebug',\n     29:   $cachedir = '/var/tmp/launchpadlib/',\n     30:   $consumer_key = '',\n     31:   $consumer_secret = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service.pp", "content": "$rabbitmq_user = 'email_alert_service',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service.pp\n\n#   Bearer token for communication with the email-alert-api\n#\nclass govuk::apps::email_alert_service(\n$enabled = false,\n$rabbitmq_hosts = ['localhost'],\n34:   $rabbitmq_user = 'email_alert_service',\n$rabbitmq_password = 'email_alert_service',\n$sentry_dsn = undef,\n$redis_host = undef,\n$email_alert_api_bearer_token = undef,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service.pp\n# Target line: 34\n\n     29: #   Bearer token for communication with the email-alert-api\n     30: #\n     31: class govuk::apps::email_alert_service(\n     32:   $enabled = false,\n     33:   $rabbitmq_hosts = ['localhost'],\n>>>  34:   $rabbitmq_user = 'email_alert_service',\n     35:   $rabbitmq_password = 'email_alert_service',\n     36:   $sentry_dsn = undef,\n     37:   $redis_host = undef,\n     38:   $email_alert_api_bearer_token = undef,\n     39: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-package-debian.pp", "content": "key_source => 'http://nginx.org/keys/nginx_signing.key',", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-package-debian.pp\n\n'nginx': {\napt::source { 'nginx':\nlocation   => \"http://nginx.org/packages/${distro}\",\nrepos      => 'nginx',\nkey        => '7BD9BF62',\n42:           key_source => 'http://nginx.org/keys/nginx_signing.key',\nnotify     => Exec['apt_get_update_for_nginx'],\n}\n}\n'passenger': {\nensure_resource('package', 'apt-transport-https', {'ensure' => 'present' })", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-package-debian.pp\n# Target line: 42\n\n     37:       'nginx': {\n     38:         apt::source { 'nginx':\n     39:           location   => \"http://nginx.org/packages/${distro}\",\n     40:           repos      => 'nginx',\n     41:           key        => '7BD9BF62',\n>>>  42:           key_source => 'http://nginx.org/keys/nginx_signing.key',\n     43:           notify     => Exec['apt_get_update_for_nginx'],\n     44:         }\n     45:       }\n     46:       'passenger': {\n     47:         ensure_resource('package', 'apt-transport-https', {'ensure' => 'present' })\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "Optional[Boolean]               $chroot              = undef,", "line": 115, "detection_span": [110, 120], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nString                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\nString                          $myorigin            = $::fqdn,\nOptional[String]                $relayhost           = undef,         # postfix_relayhost\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n115:   Optional[Boolean]               $chroot              = undef,\nBoolean                         $satellite           = false,\nString                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\nBoolean                         $use_amavisd         = false,         # postfix_use_amavisd\nBoolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\nVariant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 115\n\n    110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n    111:   String                          $myorigin            = $::fqdn,\n    112:   Optional[String]                $relayhost           = undef,         # postfix_relayhost\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n>>> 115:   Optional[Boolean]               $chroot              = undef,\n    116:   Boolean                         $satellite           = false,\n    117:   String                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\n    118:   Boolean                         $use_amavisd         = false,         # postfix_use_amavisd\n    119:   Boolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\n    120:   Variant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp", "content": "user    => 'jboss',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n\n\n# The standard puppet way to create dirs recursively does not work when paths overlap\n# They do, because many modules are created in /usr/share/jbossas/modules/com...\nexec { $client_module_base_path:\ncommand => \"mkdir -p ${client_module_base_path}\",\n34:         user    => 'jboss',\n}\n\n$module_path = \"${client_module_base_path}/healthcheck/main\"\n$module_dirs = [\"${client_module_base_path}/healthcheck\", $module_path]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n# Target line: 34\n\n     29: \n     30:     # The standard puppet way to create dirs recursively does not work when paths overlap\n     31:     # They do, because many modules are created in /usr/share/jbossas/modules/com...\n     32:     exec { $client_module_base_path:\n     33:         command => \"mkdir -p ${client_module_base_path}\",\n>>>  34:         user    => 'jboss',\n     35:     }\n     36: \n     37:     $module_path = \"${client_module_base_path}/healthcheck/main\"\n     38:     $module_dirs = [\"${client_module_base_path}/healthcheck\", $module_path]\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp", "content": "routing_key      => '*.minor',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n\nensure           => 'present',\nname             => \"${amqp_exchange}@${amqp_queue}@minor@/\",\nuser             => 'root',\npassword         => $::govuk_rabbitmq::root_password,\ndestination_type => 'queue',\n51:     routing_key      => '*.minor',\narguments        => {},\n}\n\nrabbitmq_binding { \"binding_links_${amqp_exchange}@${amqp_queue}@/\":\nensure           => 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n# Target line: 51\n\n     46:     ensure           => 'present',\n     47:     name             => \"${amqp_exchange}@${amqp_queue}@minor@/\",\n     48:     user             => 'root',\n     49:     password         => $::govuk_rabbitmq::root_password,\n     50:     destination_type => 'queue',\n>>>  51:     routing_key      => '*.minor',\n     52:     arguments        => {},\n     53:   }\n     54: \n     55:   rabbitmq_binding { \"binding_links_${amqp_exchange}@${amqp_queue}@/\":\n     56:     ensure           => 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_monitoring.pp", "content": "user       => 'nagios',", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_monitoring.pp\n\nroot         => '/dev/null',\n}\n\nlimits::limits { 'nagios_nofile':\nensure     => present,\n69:     user       => 'nagios',\nlimit_type => 'nofile',\nboth       => 16384,\n}\n\nfile { '/opt/smokey':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_monitoring.pp\n# Target line: 69\n\n     64:     root         => '/dev/null',\n     65:   }\n     66: \n     67:   limits::limits { 'nagios_nofile':\n     68:     ensure     => present,\n>>>  69:     user       => 'nagios',\n     70:     limit_type => 'nofile',\n     71:     both       => 16384,\n     72:   }\n     73: \n     74:   file { '/opt/smokey':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-gnocchi.pp", "content": "ssl_key   => \"/etc/gnocchi/ssl/private/${::fqdn}.pem\",", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n\n}\ninclude ::apache\nclass { '::gnocchi::wsgi::apache':\nbind_host => $::openstack_integration::config::ip_for_url,\nssl       => $::openstack_integration::config::ssl,\n54:     ssl_key   => \"/etc/gnocchi/ssl/private/${::fqdn}.pem\",\nssl_cert  => $::openstack_integration::params::cert_path,\nworkers   => 2,\n}\nclass { '::gnocchi::client': }\nclass { '::gnocchi::metricd':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n# Target line: 54\n\n     49:   }\n     50:   include ::apache\n     51:   class { '::gnocchi::wsgi::apache':\n     52:     bind_host => $::openstack_integration::config::ip_for_url,\n     53:     ssl       => $::openstack_integration::config::ssl,\n>>>  54:     ssl_key   => \"/etc/gnocchi/ssl/private/${::fqdn}.pem\",\n     55:     ssl_cert  => $::openstack_integration::params::cert_path,\n     56:     workers   => 2,\n     57:   }\n     58:   class { '::gnocchi::client': }\n     59:   class { '::gnocchi::metricd':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp", "content": "$http_password = undef,", "line": 73, "detection_span": [68, 78], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n\n$port = 3111,\n$secret_key_base = undef,\n$publishing_api_bearer_token = undef,\n$asset_manager_bearer_token = undef,\n$http_username = undef,\n73:   $http_password = undef,\n) {\n\ninclude govuk_postgresql::client #installs libpq-dev package needed for pg gem\n\n$app_name = 'service-manual-publisher'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n# Target line: 73\n\n     68:   $port = 3111,\n     69:   $secret_key_base = undef,\n     70:   $publishing_api_bearer_token = undef,\n     71:   $asset_manager_bearer_token = undef,\n     72:   $http_username = undef,\n>>>  73:   $http_password = undef,\n     74: ) {\n     75: \n     76:   include govuk_postgresql::client #installs libpq-dev package needed for pg gem\n     77: \n     78:   $app_name = 'service-manual-publisher'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-mistral.pp", "content": "ssl_key   => \"/etc/mistral/ssl/private/${::fqdn}.pem\",", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n\n}\ninclude ::apache\nclass { '::mistral::wsgi::apache':\nbind_host => $::openstack_integration::config::ip_for_url,\nssl       => $::openstack_integration::config::ssl,\n52:     ssl_key   => \"/etc/mistral/ssl/private/${::fqdn}.pem\",\nssl_cert  => $::openstack_integration::params::cert_path,\nworkers   => 2,\nthreads   => 1,\n}\nclass { '::mistral::client': }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n# Target line: 52\n\n     47:   }\n     48:   include ::apache\n     49:   class { '::mistral::wsgi::apache':\n     50:     bind_host => $::openstack_integration::config::ip_for_url,\n     51:     ssl       => $::openstack_integration::config::ssl,\n>>>  52:     ssl_key   => \"/etc/mistral/ssl/private/${::fqdn}.pem\",\n     53:     ssl_cert  => $::openstack_integration::params::cert_path,\n     54:     workers   => 2,\n     55:     threads   => 1,\n     56:   }\n     57:   class { '::mistral::client': }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp", "content": "key     => 'haproxy.fe.discovery',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n\ncommand => '/etc/zabbix/scripts/haproxy.sh -b';\n'haproxy.be':\nkey     => 'haproxy.be[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.fe.discovery':\n34:         key     => 'haproxy.fe.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -f';\n'haproxy.fe':\nkey     => 'haproxy.fe[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.sv.discovery':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n# Target line: 34\n\n     29:         command => '/etc/zabbix/scripts/haproxy.sh -b';\n     30:       'haproxy.be':\n     31:         key     => 'haproxy.be[*]',\n     32:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     33:       'haproxy.fe.discovery':\n>>>  34:         key     => 'haproxy.fe.discovery',\n     35:         command => '/etc/zabbix/scripts/haproxy.sh -f';\n     36:       'haproxy.fe':\n     37:         key     => 'haproxy.fe[*]',\n     38:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     39:       'haproxy.sv.discovery':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_SAHARA_DB_PW'),", "line": 122, "detection_span": [117, 127], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\n}\n}\n119:\nif hiera('CONFIG_SAHARA_INSTALL') == 'y' {\nclass { '::sahara::db::mysql':\n122:           password      => hiera('CONFIG_SAHARA_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\n}\n126:\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 122\n\n    117:         }\n    118:     }\n    119: \n    120:     if hiera('CONFIG_SAHARA_INSTALL') == 'y' {\n    121:         class { '::sahara::db::mysql':\n>>> 122:           password      => hiera('CONFIG_SAHARA_DB_PW'),\n    123:           host          => '%',\n    124:           allowed_hosts => '%',\n    125:         }\n    126: \n    127:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp", "content": "mysql_root_password         => hiera('mysql_root_password'),", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n\nzuulv2                      => hiera('zuulv2', true),\nzuul_revision               => hiera('zuul_revision', 'master'),\nzuul_git_source_repo        => hiera('zuul_git_source_repo',\n'https://git.openstack.org/openstack-infra/zuul'),\noscc_file_contents          => hiera('oscc_file_contents', ''),\n59:     mysql_root_password         => hiera('mysql_root_password'),\nmysql_nodepool_password     => hiera('mysql_nodepool_password'),\nnodepool_jenkins_target     => hiera('nodepool_jenkins_target', 'jenkins1'),\njenkins_api_key             => hiera('jenkins_api_key', 'XXX'),\njenkins_credentials_id      => hiera('jenkins_credentials_id', 'XXX'),\nnodepool_revision           => hiera('nodepool_revision', 'master'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n# Target line: 59\n\n     54:     zuulv2                      => hiera('zuulv2', true),\n     55:     zuul_revision               => hiera('zuul_revision', 'master'),\n     56:     zuul_git_source_repo        => hiera('zuul_git_source_repo',\n     57:       'https://git.openstack.org/openstack-infra/zuul'),\n     58:     oscc_file_contents          => hiera('oscc_file_contents', ''),\n>>>  59:     mysql_root_password         => hiera('mysql_root_password'),\n     60:     mysql_nodepool_password     => hiera('mysql_nodepool_password'),\n     61:     nodepool_jenkins_target     => hiera('nodepool_jenkins_target', 'jenkins1'),\n     62:     jenkins_api_key             => hiera('jenkins_api_key', 'XXX'),\n     63:     jenkins_credentials_id      => hiera('jenkins_credentials_id', 'XXX'),\n     64:     nodepool_revision           => hiera('nodepool_revision', 'master'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-ceph_compute.pp", "content": "user    => 'nova',", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-ceph_compute.pp\n\ncap_osd => 'allow *',\ncap_mds => 'allow',\n}\n\nceph::key { \"client.${compute_user}\":\n69:       user    => 'nova',\ngroup   => 'nova',\nsecret  => $secret,\ncap_mon => 'allow r',\ncap_osd => \"allow class-read object_prefix rbd_children, allow rwx pool=${cinder_pool}, allow rwx pool=${glance_pool}, allow rwx pool=${compute_pool}\",\ninject  => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-ceph_compute.pp\n# Target line: 69\n\n     64:       cap_osd => 'allow *',\n     65:       cap_mds => 'allow',\n     66:     }\n     67: \n     68:     ceph::key { \"client.${compute_user}\":\n>>>  69:       user    => 'nova',\n     70:       group   => 'nova',\n     71:       secret  => $secret,\n     72:       cap_mon => 'allow r',\n     73:       cap_osd => \"allow class-read object_prefix rbd_children, allow rwx pool=${cinder_pool}, allow rwx pool=${glance_pool}, allow rwx pool=${compute_pool}\",\n     74:       inject  => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-link_checker_api-db.pp", "content": "user                    => 'link_checker_api',", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-link_checker_api-db.pp\n\n$allow_auth_from_lb = false,\n$lb_ip_range = undef,\n$rds = false,\n) {\ngovuk_postgresql::db { 'link_checker_api_production':\n27:     user                    => 'link_checker_api',\npassword                => $password,\nallow_auth_from_backend => true,\nbackend_ip_range        => $backend_ip_range,\nallow_auth_from_lb      => $allow_auth_from_lb,\nlb_ip_range             => $lb_ip_range,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-link_checker_api-db.pp\n# Target line: 27\n\n     22:   $allow_auth_from_lb = false,\n     23:   $lb_ip_range = undef,\n     24:   $rds = false,\n     25: ) {\n     26:   govuk_postgresql::db { 'link_checker_api_production':\n>>>  27:     user                    => 'link_checker_api',\n     28:     password                => $password,\n     29:     allow_auth_from_backend => true,\n     30:     backend_ip_range        => $backend_ip_range,\n     31:     allow_auth_from_lb      => $allow_auth_from_lb,\n     32:     lb_ip_range             => $lb_ip_range,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_NOVA_DB_PW'),", "line": 104, "detection_span": [99, 109], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\nhost          => '%',\nallowed_hosts => '%',\ncharset       => 'utf8',\n}\nclass { '::nova::db::mysql_placement':\n104:           password      => hiera('CONFIG_NOVA_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\ncharset       => 'utf8',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 104\n\n     99:           host          => '%',\n    100:           allowed_hosts => '%',\n    101:           charset       => 'utf8',\n    102:         }\n    103:         class { '::nova::db::mysql_placement':\n>>> 104:           password      => hiera('CONFIG_NOVA_DB_PW'),\n    105:           host          => '%',\n    106:           allowed_hosts => '%',\n    107:           charset       => 'utf8',\n    108:         }\n    109:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp", "content": "$admin_password        = hiera('CONFIG_KEYSTONE_ADMIN_PW')", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n\n# Authentication/Keystone\n$identity_uri          = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v3', 'v2.0')\n$identity_uri_v3       = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v2.0', 'v3')\n$auth_version          = regsubst(hiera('CONFIG_KEYSTONE_API_VERSION'), '.0', '')\n$admin_username        = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n21:     $admin_password        = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$admin_tenant_name     = 'admin'\n$admin_domain_name     = 'Default'\n\n# get image and network id\n$configure_images          = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n# Target line: 21\n\n     16:     # Authentication/Keystone\n     17:     $identity_uri          = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v3', 'v2.0')\n     18:     $identity_uri_v3       = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v2.0', 'v3')\n     19:     $auth_version          = regsubst(hiera('CONFIG_KEYSTONE_API_VERSION'), '.0', '')\n     20:     $admin_username        = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n>>>  21:     $admin_password        = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     22:     $admin_tenant_name     = 'admin'\n     23:     $admin_domain_name     = 'Default'\n     24: \n     25:     # get image and network id\n     26:     $configure_images          = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-nodes-hhvm.pp", "content": "user        => 'hhvm',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-hhvm.pp\n\n$supervisord_hhvm_cmd = \"hhvm --mode server -vServer.Type=fastcgi -vServer.Port=${hhvm_values['settings']['port']}\"\n\nsupervisord::program { 'hhvm':\ncommand     => $supervisord_hhvm_cmd,\npriority    => '100',\n40:     user        => 'hhvm',\nautostart   => true,\nautorestart => 'true',\nenvironment => { 'PATH' => '/bin:/sbin:/usr/bin:/usr/sbin' },\nrequire     => [\nUser['hhvm'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-hhvm.pp\n# Target line: 40\n\n     35:   $supervisord_hhvm_cmd = \"hhvm --mode server -vServer.Type=fastcgi -vServer.Port=${hhvm_values['settings']['port']}\"\n     36: \n     37:   supervisord::program { 'hhvm':\n     38:     command     => $supervisord_hhvm_cmd,\n     39:     priority    => '100',\n>>>  40:     user        => 'hhvm',\n     41:     autostart   => true,\n     42:     autorestart => 'true',\n     43:     environment => { 'PATH' => '/bin:/sbin:/usr/bin:/usr/sbin' },\n     44:     require     => [\n     45:       User['hhvm'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker-rabbitmq.pp", "content": "$amqp_user  = 'govuk_crawler_worker'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker-rabbitmq.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::apps::govuk_crawler_worker::rabbitmq (\n$amqp_pass  = 'guest',\n) {\n\n6:   $amqp_user  = 'govuk_crawler_worker'\n\nrabbitmq_user { $amqp_user:\nadmin    => false,\npassword => $amqp_pass,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker-rabbitmq.pp\n# Target line: 6\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::apps::govuk_crawler_worker::rabbitmq (\n      3:   $amqp_pass  = 'guest',\n      4: ) {\n      5: \n>>>   6:   $amqp_user  = 'govuk_crawler_worker'\n      7: \n      8:   rabbitmq_user { $amqp_user:\n      9:     admin    => false,\n     10:     password => $amqp_pass,\n     11:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp", "content": "$cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n\n\nclass { '::cinder::volume': }\n\nclass { '::cinder::client': }\n\n46:     $cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n$cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n$cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n\n# Cinder::Type requires keystone credentials", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n# Target line: 46\n\n     41: \n     42:     class { '::cinder::volume': }\n     43: \n     44:     class { '::cinder::client': }\n     45: \n>>>  46:     $cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n     47:     $cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     48:     $cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n     49:     $cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n     50: \n     51:     # Cinder::Type requires keystone credentials\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-params.pp", "content": "$gitlab_relative_url_root = false", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n\n$gitlab_backup            = false\n$gitlab_backup_path       = 'tmp/backups/'\n$gitlab_backup_keep_time  = '0'\n$gitlab_backup_time       = fqdn_rand(5)+1\n$gitlab_backup_postscript = false\n46:   $gitlab_relative_url_root = false\n$gitlab_issue_closing_pattern = undef\n$gitlab_repository_downloads_path = 'tmp/repositories'\n$gitlab_restricted_visibility_levels = undef\n$gitlab_default_projects_features_issues = true\n$gitlab_default_projects_features_merge_requests = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n# Target line: 46\n\n     41:   $gitlab_backup            = false\n     42:   $gitlab_backup_path       = 'tmp/backups/'\n     43:   $gitlab_backup_keep_time  = '0'\n     44:   $gitlab_backup_time       = fqdn_rand(5)+1\n     45:   $gitlab_backup_postscript = false\n>>>  46:   $gitlab_relative_url_root = false\n     47:   $gitlab_issue_closing_pattern = undef\n     48:   $gitlab_repository_downloads_path = 'tmp/repositories'\n     49:   $gitlab_restricted_visibility_levels = undef\n     50:   $gitlab_default_projects_features_issues = true\n     51:   $gitlab_default_projects_features_merge_requests = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "willdurand@puppet-nodejs-manifests-npm-file.pp", "content": "$exec_user = undef,", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: willdurand@puppet-nodejs-manifests-npm-file.pp\n\n# [*exec_env*]\n#   Exec environment.\n#\ndefine nodejs::npm::file(\n$directory,\n22:   $exec_user = undef,\n$exec_env  = undef,\n$options   = undef,\n) {\nif $caller_module_name != $module_name {\nwarning('::nodejs::npm::file is not meant for public use!')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: willdurand@puppet-nodejs-manifests-npm-file.pp\n# Target line: 22\n\n     17: # [*exec_env*]\n     18: #   Exec environment.\n     19: #\n     20: define nodejs::npm::file(\n     21:   $directory,\n>>>  22:   $exec_user = undef,\n     23:   $exec_env  = undef,\n     24:   $options   = undef,\n     25: ) {\n     26:   if $caller_module_name != $module_name {\n     27:     warning('::nodejs::npm::file is not meant for public use!')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-release.pp", "content": "$github_access_token = undef,", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-release.pp\n\n$db_hostname = undef,\n$db_username = undef,\n$db_password = undef,\n$db_name = 'release_production',\n$github_username = undef,\n50:   $github_access_token = undef,\n$oauth_id = undef,\n$oauth_secret = undef,\n) {\n$app_name = 'release'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-release.pp\n# Target line: 50\n\n     45:   $db_hostname = undef,\n     46:   $db_username = undef,\n     47:   $db_password = undef,\n     48:   $db_name = 'release_production',\n     49:   $github_username = undef,\n>>>  50:   $github_access_token = undef,\n     51:   $oauth_id = undef,\n     52:   $oauth_secret = undef,\n     53: ) {\n     54:   $app_name = 'release'\n     55: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp", "content": "key        => '420851BC',", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n\n'Debian': {\nclass { '::apt':\nstage => 'openstack-ci-repo'\n}->\nclass { '::openstack::repo::apt':\n22:       key        => '420851BC',\nlocation   => 'http://172.18.66.213/deb',\nkey_source => 'http://172.18.66.213/gpg.pub',\norigin     => '172.18.66.213',\nstage      => 'openstack-ci-repo'\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n# Target line: 22\n\n     17:   'Debian': {\n     18:     class { '::apt':\n     19:       stage => 'openstack-ci-repo'\n     20:     }->\n     21:     class { '::openstack::repo::apt':\n>>>  22:       key        => '420851BC',\n     23:       location   => 'http://172.18.66.213/deb',\n     24:       key_source => 'http://172.18.66.213/gpg.pub',\n     25:       origin     => '172.18.66.213',\n     26:       stage      => 'openstack-ci-repo'\n     27:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_slave.pp", "content": "$master_cert = 'master.localdomain'", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_slave.pp\n\n1: $master_cert = 'master.localdomain'\n$master_ip   = '192.168.5.16'\n\nclass { '::icinga2':\nmanage_repo  => true,\nconstants    => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_slave.pp\n# Target line: 1\n\n>>>   1: $master_cert = 'master.localdomain'\n      2: $master_ip   = '192.168.5.16'\n      3: \n      4: class { '::icinga2':\n      5:   manage_repo  => true,\n      6:   constants    => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp", "content": "$zendesk_client_password = undef,", "line": 103, "detection_span": [98, 108], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n\n$pp_data_bearer_token = undef,\n$redis_host = undef,\n100:   $redis_port = undef,\n101:   $secret_key_base = undef,\n102:   $zendesk_anonymous_ticket_email = undef,\n103:   $zendesk_client_password = undef,\n104:   $zendesk_client_username = undef,\n105:   $aws_access_key_id = undef,\n106:   $aws_secret_access_key = undef,\n107:   $aws_region = 'eu-west-1',\n108:   $aws_s3_bucket_name = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n# Target line: 103\n\n     98:   $pp_data_bearer_token = undef,\n     99:   $redis_host = undef,\n    100:   $redis_port = undef,\n    101:   $secret_key_base = undef,\n    102:   $zendesk_anonymous_ticket_email = undef,\n>>> 103:   $zendesk_client_password = undef,\n    104:   $zendesk_client_username = undef,\n    105:   $aws_access_key_id = undef,\n    106:   $aws_secret_access_key = undef,\n    107:   $aws_region = 'eu-west-1',\n    108:   $aws_s3_bucket_name = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-system-passwordless_user_account-manifests-init.pp", "content": "super_user      => str2bool($account['super_user']),", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-passwordless_user_account-manifests-init.pp\n\n$username = $account['username']\n\n::parameterised_accounts::account { \"passwordless_user_account_$username\":\nusername        => $username,\npassword        => '',\n10:     super_user      => str2bool($account['super_user']),\nstrings_to_leak => $secgen_parameters['strings_to_leak'],\nleaked_filenames => $account['leaked_filenames']\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-passwordless_user_account-manifests-init.pp\n# Target line: 10\n\n      5:   $username = $account['username']\n      6: \n      7:   ::parameterised_accounts::account { \"passwordless_user_account_$username\":\n      8:     username        => $username,\n      9:     password        => '',\n>>>  10:     super_user      => str2bool($account['super_user']),\n     11:     strings_to_leak => $secgen_parameters['strings_to_leak'],\n     12:     leaked_filenames => $account['leaked_filenames']\n     13:   }\n     14: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-phpmyadmin.pp", "content": "apt::key { '80E7349A06ED541C': key_server => 'hkp://keyserver.ubuntu.com:80' }", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-phpmyadmin.pp\n\n$webroot_location = '/var/www'\n) inherits puphpet::params {\n\nif $::osfamily == 'debian' {\nif $::operatingsystem == 'ubuntu' {\n11:       apt::key { '80E7349A06ED541C': key_server => 'hkp://keyserver.ubuntu.com:80' }\napt::ppa { 'ppa:nijel/phpmyadmin': require => Apt::Key['80E7349A06ED541C'] }\n}\n\n$phpMyAdmin_package = 'phpmyadmin'\n$phpMyAdmin_folder  = 'phpmyadmin'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-phpmyadmin.pp\n# Target line: 11\n\n      6:   $webroot_location = '/var/www'\n      7: ) inherits puphpet::params {\n      8: \n      9:   if $::osfamily == 'debian' {\n     10:     if $::operatingsystem == 'ubuntu' {\n>>>  11:       apt::key { '80E7349A06ED541C': key_server => 'hkp://keyserver.ubuntu.com:80' }\n     12:       apt::ppa { 'ppa:nijel/phpmyadmin': require => Apt::Key['80E7349A06ED541C'] }\n     13:     }\n     14: \n     15:     $phpMyAdmin_package = 'phpmyadmin'\n     16:     $phpMyAdmin_folder  = 'phpmyadmin'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "maxchk@puppet-varnish-manifests-shmlog.pp", "content": "pass    => '0',", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: maxchk@puppet-varnish-manifests-shmlog.pp\n\nname    => $shmlog_dir,\ntarget  => '/etc/fstab',\nfstype  => 'tmpfs',\ndevice  => 'tmpfs',\noptions => $options,\n50:     pass    => '0',\ndump    => '0',\nnotify  => Service['varnish'],\nrequire => File['shmlog-dir'],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: maxchk@puppet-varnish-manifests-shmlog.pp\n# Target line: 50\n\n     45:     name    => $shmlog_dir,\n     46:     target  => '/etc/fstab',\n     47:     fstype  => 'tmpfs',\n     48:     device  => 'tmpfs',\n     49:     options => $options,\n>>>  50:     pass    => '0',\n     51:     dump    => '0',\n     52:     notify  => Service['varnish'],\n     53:     require => File['shmlog-dir'],\n     54:   }\n     55: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Mirantis@solar-resources-nova_api_puppet-actions-remove.pp", "content": "admin_password => 'not important as removed'", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: Mirantis@solar-resources-nova_api_puppet-actions-remove.pp\n\nclass { 'nova::api':\nensure_package => 'absent',\nenabled        => false,\n4:   admin_password => 'not important as removed'\n}\n\ninclude nova::params\n\nexec { 'post-nova_config':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Mirantis@solar-resources-nova_api_puppet-actions-remove.pp\n# Target line: 4\n\n      1: class { 'nova::api':\n      2:   ensure_package => 'absent',\n      3:   enabled        => false,\n>>>   4:   admin_password => 'not important as removed'\n      5: }\n      6: \n      7: include nova::params\n      8: \n      9: exec { 'post-nova_config':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-obs_server-manifests-nginx.pp", "content": "$ssl_cert_file = '/srv/obs/certs/server.crt',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-obs_server-manifests-nginx.pp\n\n#\nclass obs_server::nginx (\n$access_log_file = '/srv/www/obs/api/log/nginx-obs-api-access.log',\n$error_log_file = '/srv/www/obs/api/log/nginx-obs-api-error.log',\n$ssl_key_file = '/srv/obs/certs/server.key',\n17:   $ssl_cert_file = '/srv/obs/certs/server.crt',\n$ssl_key_file_contents = '',\n$ssl_cert_file_contents = '',\n) inherits obs_server::folders {\n\npackage { 'nginx':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-obs_server-manifests-nginx.pp\n# Target line: 17\n\n     12: #\n     13: class obs_server::nginx (\n     14:   $access_log_file = '/srv/www/obs/api/log/nginx-obs-api-access.log',\n     15:   $error_log_file = '/srv/www/obs/api/log/nginx-obs-api-error.log',\n     16:   $ssl_key_file = '/srv/obs/certs/server.key',\n>>>  17:   $ssl_cert_file = '/srv/obs/certs/server.crt',\n     18:   $ssl_key_file_contents = '',\n     19:   $ssl_cert_file_contents = '',\n     20: ) inherits obs_server::folders {\n     21: \n     22: package { 'nginx':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp", "content": "san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n\n}\n\ncinder::backend::dellsc_iscsi { $backend_name :\nbackend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\nsan_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\n49:       san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\nsan_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\ndell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\ntarget_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\ntarget_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\ndell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n# Target line: 49\n\n     44:     }\n     45: \n     46:     cinder::backend::dellsc_iscsi { $backend_name :\n     47:       backend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\n     48:       san_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\n>>>  49:       san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\n     50:       san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\n     51:       dell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\n     52:       target_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\n     53:       target_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\n     54:       dell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-search_benchmark.pp", "content": "$auth_username = undef,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-search_benchmark.pp\n\n# == Class: govuk_jenkins::jobs::search_benchmark\n#\n# Create a file on disk that can be parsed by jenkins-job-builder\n#\nclass govuk_jenkins::jobs::search_benchmark (\n6:   $auth_username = undef,\n$auth_password = undef,\n$rate_limit_token = undef,\n$cron_schedule = '30 4 * * *'\n) {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-search_benchmark.pp\n# Target line: 6\n\n      1: # == Class: govuk_jenkins::jobs::search_benchmark\n      2: #\n      3: # Create a file on disk that can be parsed by jenkins-job-builder\n      4: #\n      5: class govuk_jenkins::jobs::search_benchmark (\n>>>   6:   $auth_username = undef,\n      7:   $auth_password = undef,\n      8:   $rate_limit_token = undef,\n      9:   $cron_schedule = '30 4 * * *'\n     10: ) {\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "$oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\n$oauth_access_file            = '/etc/nginx/oauth-access.lua',\n$oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n$oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n$oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n$oauth_domain                 = 'domain.com',\n40:   $oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n$ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n$ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n$ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n$ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n$ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 40\n\n     35:   $oauth_access_file            = '/etc/nginx/oauth-access.lua',\n     36:   $oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n     37:   $oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n     38:   $oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n     39:   $oauth_domain                 = 'domain.com',\n>>>  40:   $oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n     41:   $ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n     42:   $ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n     43:   $ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n     44:   $ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n     45:   $ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-icinga-manifests-config.pp", "content": "$http_password = '',", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config.pp\n\n#  Graphite host to check against\n#\nclass icinga::config (\n$enable_event_handlers = true,\n$http_username = '',\n22:   $http_password = '',\n$graphite_hostname = 'graphite.cluster',\n) {\n\nvalidate_bool($enable_event_handlers)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config.pp\n# Target line: 22\n\n     17: #  Graphite host to check against\n     18: #\n     19: class icinga::config (\n     20:   $enable_event_handlers = true,\n     21:   $http_username = '',\n>>>  22:   $http_password = '',\n     23:   $graphite_hostname = 'graphite.cluster',\n     24: ) {\n     25: \n     26:   validate_bool($enable_event_handlers)\n     27: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "camptocamp@puppet-archive-manifests-extract.pp", "content": "$user=undef,", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: camptocamp@puppet-archive-manifests-extract.pp\n\n$extension='tar.gz',\n$timeout=120,\n$path=$::path,\n$strip_components=0,\n$purge=false,\n43:   $user=undef,\n$tar_command=$::osfamily ? {\n'Solaris' => 'gtar',\ndefault   => 'tar',\n},\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-archive-manifests-extract.pp\n# Target line: 43\n\n     38:   $extension='tar.gz',\n     39:   $timeout=120,\n     40:   $path=$::path,\n     41:   $strip_components=0,\n     42:   $purge=false,\n>>>  43:   $user=undef,\n     44:   $tar_command=$::osfamily ? {\n     45:     'Solaris' => 'gtar',\n     46:     default   => 'tar',\n     47:   },\n     48: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "KrisBuytaert@puppet-graphite-manifests-params.pp", "content": "$carbon_amqp_password                      = 'guest',", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n\n$aggregator_use_whitelist                  = 'False',\n$aggregator_user                           = 'carbon',\n$carbon_ampq_user                          = 'guest',\n$carbon_amqp_exchange                      = 'graphite',\n$carbon_amqp_host                          = 'localhost',\n54:   $carbon_amqp_password                      = 'guest',\n$carbon_amqp_port                          = '5672',\n$carbon_amqp_verbose                       = 'False',\n$carbon_amqp_vhost                         = '/',\n$carbon_cache_amount                       = $::processorcount,\n$carbon_cache_query_interface              = '0.0.0.0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n# Target line: 54\n\n     49:   $aggregator_use_whitelist                  = 'False',\n     50:   $aggregator_user                           = 'carbon',\n     51:   $carbon_ampq_user                          = 'guest',\n     52:   $carbon_amqp_exchange                      = 'graphite',\n     53:   $carbon_amqp_host                          = 'localhost',\n>>>  54:   $carbon_amqp_password                      = 'guest',\n     55:   $carbon_amqp_port                          = '5672',\n     56:   $carbon_amqp_verbose                       = 'False',\n     57:   $carbon_amqp_vhost                         = '/',\n     58:   $carbon_cache_amount                       = $::processorcount,\n     59:   $carbon_cache_query_interface              = '0.0.0.0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-trove.pp", "content": "nova_proxy_admin_pass      => 'a_big_secret',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-trove.pp\n\n'password'  => 'an_even_bigger_secret',\n}),\ndatabase_connection        => 'mysql+pymysql://trove:trove@127.0.0.1/trove?charset=utf8',\nrabbit_use_ssl             => $::openstack_integration::config::ssl,\namqp_sasl_mechanisms       => 'PLAIN',\n45:     nova_proxy_admin_pass      => 'a_big_secret',\n}\nclass { '::trove::db::mysql':\npassword => 'trove',\n}\nclass { '::trove::keystone::auth':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-trove.pp\n# Target line: 45\n\n     40:       'password'  => 'an_even_bigger_secret',\n     41:     }),\n     42:     database_connection        => 'mysql+pymysql://trove:trove@127.0.0.1/trove?charset=utf8',\n     43:     rabbit_use_ssl             => $::openstack_integration::config::ssl,\n     44:     amqp_sasl_mechanisms       => 'PLAIN',\n>>>  45:     nova_proxy_admin_pass      => 'a_big_secret',\n     46:   }\n     47:   class { '::trove::db::mysql':\n     48:     password => 'trove',\n     49:   }\n     50:   class { '::trove::keystone::auth':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-stash-examples-stash_postgres_java_install.pp", "content": "password => postgresql_password('stash', 'password'),", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: voxpupuli@puppet-stash-examples-stash_postgres_java_install.pp\n\n}\nclass { 'stash::gc': }\nclass { 'stash::facts': }\npostgresql::server::db { 'stash':\nuser     => 'stash',\n30:     password => postgresql_password('stash', 'password'),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-stash-examples-stash_postgres_java_install.pp\n# Target line: 30\n\n     25:   }\n     26:   class { 'stash::gc': }\n     27:   class { 'stash::facts': }\n     28:   postgresql::server::db { 'stash':\n     29:     user     => 'stash',\n>>>  30:     password => postgresql_password('stash', 'password'),\n     31:   }\n     32: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-arista.pp", "content": "'ml2_arista/eapi_password': value => $eapi_password, secret => true;", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-arista.pp\n\nrequire ::neutron::plugins::ml2\n\nneutron_plugin_ml2 {\n'ml2_arista/eapi_host'    : value => $eapi_host;\n'ml2_arista/eapi_username': value => $eapi_username;\n61:     'ml2_arista/eapi_password': value => $eapi_password, secret => true;\n'ml2_arista/region_name'  : value => $region_name;\n'ml2_arista/sync_interval': value => $sync_interval;\n'ml2_arista/use_fqdn'     : value => $use_fqdn;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-arista.pp\n# Target line: 61\n\n     56:   require ::neutron::plugins::ml2\n     57: \n     58:   neutron_plugin_ml2 {\n     59:     'ml2_arista/eapi_host'    : value => $eapi_host;\n     60:     'ml2_arista/eapi_username': value => $eapi_username;\n>>>  61:     'ml2_arista/eapi_password': value => $eapi_password, secret => true;\n     62:     'ml2_arista/region_name'  : value => $region_name;\n     63:     'ml2_arista/sync_interval': value => $sync_interval;\n     64:     'ml2_arista/use_fqdn'     : value => $use_fqdn;\n     65:   }\n     66: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-global-enable_dark_mode_shortcut.pp", "content": "key    => '_HIEnableThemeSwitchHotKey',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: boxen@puppet-osx-manifests-global-enable_dark_mode_shortcut.pp\n\n# Public: Enables dark mode toggler shortcut\nclass osx::global::enable_dark_mode_shortcut {\nboxen::osx_defaults { 'Enable \"dark mode\" shortcut':\nensure => present,\ndomain => 'NSGlobalDomain',\n6:     key    => '_HIEnableThemeSwitchHotKey',\nvalue  => true,\ntype   => bool,\nuser   => $::boxen_user;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-global-enable_dark_mode_shortcut.pp\n# Target line: 6\n\n      1: # Public: Enables dark mode toggler shortcut\n      2: class osx::global::enable_dark_mode_shortcut {\n      3:   boxen::osx_defaults { 'Enable \"dark mode\" shortcut':\n      4:     ensure => present,\n      5:     domain => 'NSGlobalDomain',\n>>>   6:     key    => '_HIEnableThemeSwitchHotKey',\n      7:     value  => true,\n      8:     type   => bool,\n      9:     user   => $::boxen_user;\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bodepd@puppetlabs-openstack-examples-site.pp", "content": "$keystone_admin_token    = 'keystone_admin_token'", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n\n$private_interface       = 'eth1'\n# credentials\n$admin_email             = 'root@localhost'\n$admin_password          = 'keystone_admin'\n$keystone_db_password    = 'keystone_db_pass'\n26: $keystone_admin_token    = 'keystone_admin_token'\n$nova_db_password        = 'nova_pass'\n$nova_user_password      = 'nova_pass'\n$glance_db_password      = 'glance_pass'\n$glance_user_password    = 'glance_pass'\n$rabbit_password         = 'openstack_rabbit_password'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n# Target line: 26\n\n     21: $private_interface       = 'eth1'\n     22: # credentials\n     23: $admin_email             = 'root@localhost'\n     24: $admin_password          = 'keystone_admin'\n     25: $keystone_db_password    = 'keystone_db_pass'\n>>>  26: $keystone_admin_token    = 'keystone_admin_token'\n     27: $nova_db_password        = 'nova_pass'\n     28: $nova_user_password      = 'nova_pass'\n     29: $glance_db_password      = 'glance_pass'\n     30: $glance_user_password    = 'glance_pass'\n     31: $rabbit_password         = 'openstack_rabbit_password'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-appstore.pp", "content": "key    => 'WebKitDeveloperExtras',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-appstore.pp\n\nclass people::felho::osx_settings::appstore {\nboxen::osx_defaults { 'Enable the WebKit Developer Tools in the Mac App Store':\nuser   => $::luser,\ndomain => 'com.apple.appstore',\n5:     key    => 'WebKitDeveloperExtras',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Enable Debug Menu in the Mac App Store':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-appstore.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::appstore {\n      2:   boxen::osx_defaults { 'Enable the WebKit Developer Tools in the Mac App Store':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.appstore',\n>>>   5:     key    => 'WebKitDeveloperExtras',\n      6:     type   => 'bool',\n      7:     value  => true,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Enable Debug Menu in the Mac App Store':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp", "content": "$image_alt_ssh_user = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n\n\n# Image\n$uec_image_name     = hiera('CONFIG_PROVISION_UEC_IMAGE_NAME')\n$image_ssh_user     = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n$image_name_alt     = \"${uec_image_name}_alt\"\n33:     $image_alt_ssh_user = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n$image_source       = hiera('CONFIG_PROVISION_IMAGE_URL')\n$image_format       = hiera('CONFIG_PROVISION_IMAGE_FORMAT')\n\n# network name\n$public_network_name = 'public'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n# Target line: 33\n\n     28: \n     29:     # Image\n     30:     $uec_image_name     = hiera('CONFIG_PROVISION_UEC_IMAGE_NAME')\n     31:     $image_ssh_user     = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n     32:     $image_name_alt     = \"${uec_image_name}_alt\"\n>>>  33:     $image_alt_ssh_user = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n     34:     $image_source       = hiera('CONFIG_PROVISION_IMAGE_URL')\n     35:     $image_format       = hiera('CONFIG_PROVISION_IMAGE_FORMAT')\n     36: \n     37:     # network name\n     38:     $public_network_name = 'public'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-postfix-manifests-init.pp", "content": "$smarthost_pass = undef,", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n\n#   Pass to authenticate all relayed mail with.\n#\nclass postfix (\n$smarthost = undef,\n$smarthost_user = undef,\n28:   $smarthost_pass = undef,\n$rewrite_mail_domain = 'localhost',\n$rewrite_mail_list = 'noemail'\n) {\n\nanchor { 'postfix::begin':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n# Target line: 28\n\n     23: #   Pass to authenticate all relayed mail with.\n     24: #\n     25: class postfix (\n     26:   $smarthost = undef,\n     27:   $smarthost_user = undef,\n>>>  28:   $smarthost_pass = undef,\n     29:   $rewrite_mail_domain = 'localhost',\n     30:   $rewrite_mail_list = 'noemail'\n     31: ) {\n     32: \n     33:   anchor { 'postfix::begin':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-windows-update-windows_update-manifests-params.pp", "content": "$p_reg_key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU'", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-windows-update-windows_update-manifests-params.pp\n\n$use_wuserver                        = '0'\n\nif $::operatingsystemrelease == 'Server 2012' {\n$p_reg_key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update'\n} else {\n31:     $p_reg_key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU'\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-windows-update-windows_update-manifests-params.pp\n# Target line: 31\n\n     26:   $use_wuserver                        = '0'\n     27: \n     28:   if $::operatingsystemrelease == 'Server 2012' {\n     29:     $p_reg_key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update'\n     30:   } else {\n>>>  31:     $p_reg_key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU'\n     32:   }\n     33: \n     34: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bastelfreak@puppet-prometheus2-manifests-params.pp", "content": "$user = 'prometheus'", "line": 89, "detection_span": [84, 94], "with_context": "# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n\n$statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n$statsd_exporter_package_ensure = 'latest'\n$statsd_exporter_package_name = 'statsd_exporter'\n$statsd_exporter_user = 'statsd-exporter'\n$statsd_exporter_version = '0.3.0'\n89:   $user = 'prometheus'\n$version = '1.5.2'\ncase $::architecture {\n'x86_64', 'amd64': { $arch = 'amd64' }\n'i386':            { $arch = '386'   }\ndefault:           {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n# Target line: 89\n\n     84:   $statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n     85:   $statsd_exporter_package_ensure = 'latest'\n     86:   $statsd_exporter_package_name = 'statsd_exporter'\n     87:   $statsd_exporter_user = 'statsd-exporter'\n     88:   $statsd_exporter_version = '0.3.0'\n>>>  89:   $user = 'prometheus'\n     90:   $version = '1.5.2'\n     91:   case $::architecture {\n     92:     'x86_64', 'amd64': { $arch = 'amd64' }\n     93:     'i386':            { $arch = '386'   }\n     94:     default:           {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-storage-cephmon.pp", "content": "$dashboard_user       = 'admin',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: norcams@himlar-profile-manifests-storage-cephmon.pp\n\n# Class: profile::storage::cephmon\n#\n#\nclass profile::storage::cephmon (\n$dashboard_password,\n6:   $dashboard_user       = 'admin',\n$manage_dashboard     = false,\n$crt_dir              = '/etc/pki/tls/certs',\n$key_dir              = '/etc/pki/tls/private',\n$cert_name            = $::fqdn,\n$flagfile             = '/var/lib/ceph/.ceph-dashboard-set-up',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-storage-cephmon.pp\n# Target line: 6\n\n      1: # Class: profile::storage::cephmon\n      2: #\n      3: #\n      4: class profile::storage::cephmon (\n      5:   $dashboard_password,\n>>>   6:   $dashboard_user       = 'admin',\n      7:   $manage_dashboard     = false,\n      8:   $crt_dir              = '/etc/pki/tls/certs',\n      9:   $key_dir              = '/etc/pki/tls/private',\n     10:   $cert_name            = $::fqdn,\n     11:   $flagfile             = '/var/lib/ceph/.ceph-dashboard-set-up',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp", "content": "$db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n\n$db_name     = pick($murano_hash['db_name'], 'murano')\n$db_password = pick($murano_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($murano_hash['db_host'], $database_vip)\n$db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n22:   $db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n$db_root_password = pick($murano_hash['root_password'], $mysql_root_password)\n\n$allowed_hosts = [ $node_name, 'localhost', '127.0.0.1', '%' ]\n\nvalidate_string($mysql_root_user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n# Target line: 22\n\n     17:   $db_name     = pick($murano_hash['db_name'], 'murano')\n     18:   $db_password = pick($murano_hash['db_password'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($murano_hash['db_host'], $database_vip)\n     21:   $db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n>>>  22:   $db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n     23:   $db_root_password = pick($murano_hash['root_password'], $mysql_root_password)\n     24: \n     25:   $allowed_hosts = [ $node_name, 'localhost', '127.0.0.1', '%' ]\n     26: \n     27:   validate_string($mysql_root_user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-global-expand_save_dialog.pp", "content": "key    => 'NSNavPanelExpandedStateForSaveMode',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: boxen@puppet-osx-manifests-global-expand_save_dialog.pp\n\n# Public: Expand the Save panel by default.\nclass osx::global::expand_save_dialog {\nboxen::osx_defaults { 'Expand save panel by default':\nuser   => $::boxen_user,\n5:     key    => 'NSNavPanelExpandedStateForSaveMode',\ndomain => 'NSGlobalDomain',\nvalue  => true;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-global-expand_save_dialog.pp\n# Target line: 5\n\n      1: # Public: Expand the Save panel by default.\n      2: class osx::global::expand_save_dialog {\n      3:   boxen::osx_defaults { 'Expand save panel by default':\n      4:     user   => $::boxen_user,\n>>>   5:     key    => 'NSNavPanelExpandedStateForSaveMode',\n      6:     domain => 'NSGlobalDomain',\n      7:     value  => true;\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_stats-manifests-db.pp", "content": "password => postgresql_password($psql_user, $psql_pass),", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_stats-manifests-db.pp\n\n],\n}\n}\npostgresql::server::db { $psql_db:\nuser     => $psql_user,\n37:       password => postgresql_password($psql_user, $psql_pass),\n}\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_stats-manifests-db.pp\n# Target line: 37\n\n     32:         ],\n     33:       }\n     34:     }\n     35:     postgresql::server::db { $psql_db:\n     36:       user     => $psql_user,\n>>>  37:       password => postgresql_password($psql_user, $psql_pass),\n     38:     }\n     39:   }\n     40: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-jenkins-manifests-job_builder.pp", "content": "$manage_user = false,", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n\n$git_url = 'https://git.openstack.org/openstack-infra/jenkins-job-builder',\n$config_dir = '',\n$jenkins_jobs_update_timeout = '600',\n$query_plugins_info = true,\n$extensions = [],\n13:   $manage_user = false,\n) {\nvalidate_array($extensions)\n\n# A lot of things need yaml, be conservative requiring this package to avoid\n# conflicts with other modules.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n# Target line: 13\n\n      8:   $git_url = 'https://git.openstack.org/openstack-infra/jenkins-job-builder',\n      9:   $config_dir = '',\n     10:   $jenkins_jobs_update_timeout = '600',\n     11:   $query_plugins_info = true,\n     12:   $extensions = [],\n>>>  13:   $manage_user = false,\n     14: ) {\n     15:   validate_array($extensions)\n     16: \n     17:   # A lot of things need yaml, be conservative requiring this package to avoid\n     18:   # conflicts with other modules.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-dock-hot_corner.pp", "content": "key    => \"wvous-${position_value}-modifier\",", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: boxen@puppet-osx-manifests-dock-hot_corner.pp\n\nnotify => Exec['killall Dock'];\n}\n\nboxen::osx_defaults { \"Hot Corners ${position} Modifier\":\ndomain => 'com.apple.dock',\n61:     key    => \"wvous-${position_value}-modifier\",\ntype   => int,\nvalue  => 0,\nuser   => $::boxen_user,\nnotify => Exec['killall Dock'];\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-dock-hot_corner.pp\n# Target line: 61\n\n     56:     notify => Exec['killall Dock'];\n     57:   }\n     58: \n     59:   boxen::osx_defaults { \"Hot Corners ${position} Modifier\":\n     60:     domain => 'com.apple.dock',\n>>>  61:     key    => \"wvous-${position_value}-modifier\",\n     62:     type   => int,\n     63:     value  => 0,\n     64:     user   => $::boxen_user,\n     65:     notify => Exec['killall Dock'];\n     66:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-jenkins_master.pp", "content": "$jenkins_username        = 'jenkins',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-jenkins_master.pp\n\n# == Class: openstackci::jenkins_master\n#\nclass openstackci::jenkins_master (\n$serveradmin,\n$jenkins_password,\n6:   $jenkins_username        = 'jenkins',\n$vhost_name              = $::fqdn,\n$logo                    = '', # Logo must be present in puppet-jenkins/files\n$ssl_cert_file           = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$ssl_key_file            = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$ssl_chain_file          = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-jenkins_master.pp\n# Target line: 6\n\n      1: # == Class: openstackci::jenkins_master\n      2: #\n      3: class openstackci::jenkins_master (\n      4:   $serveradmin,\n      5:   $jenkins_password,\n>>>   6:   $jenkins_username        = 'jenkins',\n      7:   $vhost_name              = $::fqdn,\n      8:   $logo                    = '', # Logo must be present in puppet-jenkins/files\n      9:   $ssl_cert_file           = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     10:   $ssl_key_file            = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     11:   $ssl_chain_file          = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-openstack-resource-imagebuilder.pp", "content": "$user    = 'imagebuilder',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-resource-imagebuilder.pp\n\n# Manage imagebuilder user and project\nclass profile::openstack::resource::imagebuilder(\n$password,\n$manage  = false,\n$ensure  = present,\n6:   $user    = 'imagebuilder',\n$project = 'imagebuilder',\n$domain  = 'default'\n) {\n\nif $manage {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-resource-imagebuilder.pp\n# Target line: 6\n\n      1: # Manage imagebuilder user and project\n      2: class profile::openstack::resource::imagebuilder(\n      3:   $password,\n      4:   $manage  = false,\n      5:   $ensure  = present,\n>>>   6:   $user    = 'imagebuilder',\n      7:   $project = 'imagebuilder',\n      8:   $domain  = 'default'\n      9: ) {\n     10: \n     11:   if $manage {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp", "content": "service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n\nvcpus  => '1',\nrequire => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n} ->\nmanila::service_instance{ 'generic':\nservice_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\n35:       service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\nservice_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\nservice_instance_network_helper_type => $service_instance_network_helper_type,\nservice_instance_flavor_id           => 66,\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n# Target line: 35\n\n     30:       vcpus  => '1',\n     31:       require => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n     32:     } ->\n     33:     manila::service_instance{ 'generic':\n     34:       service_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\n>>>  35:       service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\n     36:       service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\n     37:       service_instance_network_helper_type => $service_instance_network_helper_type,\n     38:       service_instance_flavor_id           => 66,\n     39:     }\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-qdr.pp", "content": "key_path => \"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\",", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-qdr.pp\n\nmode                    => '0755',\nselinux_ignore_defaults => true,\nbefore                  => File[\"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\"],\n}\nopenstack_integration::ssl_key { 'qdrouterd':\n36:       key_path => \"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\",\nrequire  => File['/etc/qpid-dispatch/ssl/private'],\nnotify   => Service['qdrouterd'],\n}\nclass { '::qdr':\nlistener_require_ssl   => 'yes',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-qdr.pp\n# Target line: 36\n\n     31:       mode                    => '0755',\n     32:       selinux_ignore_defaults => true,\n     33:       before                  => File[\"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\"],\n     34:     }\n     35:     openstack_integration::ssl_key { 'qdrouterd':\n>>>  36:       key_path => \"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\",\n     37:       require  => File['/etc/qpid-dispatch/ssl/private'],\n     38:       notify   => Service['qdrouterd'],\n     39:     }\n     40:     class { '::qdr':\n     41:       listener_require_ssl   => 'yes',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp", "content": "$db_root_password = pick($neutron_db['root_password'], $mysql_root_password)", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n\n$db_password = pick($neutron_db['passwd'], $mysql_root_password)\n\n$db_host          = pick($neutron_db['db_host'], $database_vip)\n$db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n$db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n23:   $db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n\n$allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n\nvalidate_string($mysql_root_user)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n# Target line: 23\n\n     18:   $db_password = pick($neutron_db['passwd'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($neutron_db['db_host'], $database_vip)\n     21:   $db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n     22:   $db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n>>>  23:   $db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n     24: \n     25:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     26: \n     27:   validate_string($mysql_root_user)\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-openstackclient.pp", "content": "$ost_cl_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-openstackclient.pp\n\n\nif hiera('CONFIG_MANILA_INSTALL') == 'y' {\nensure_packages(['/usr/bin/manila'], {'ensure' => 'present'})\n}\n\n13:     $ost_cl_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n$ost_cl_keystone_admin_pw       = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$ost_cl_ctrl_keystone_url       = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n$ost_cl_keystone_region         = hiera('CONFIG_KEYSTONE_REGION')\n$ost_cl_keystone_demo_pw        = hiera('CONFIG_KEYSTONE_DEMO_PW')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-openstackclient.pp\n# Target line: 13\n\n      8: \n      9:     if hiera('CONFIG_MANILA_INSTALL') == 'y' {\n     10:       ensure_packages(['/usr/bin/manila'], {'ensure' => 'present'})\n     11:     }\n     12: \n>>>  13:     $ost_cl_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n     14:     $ost_cl_keystone_admin_pw       = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     15:     $ost_cl_ctrl_keystone_url       = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n     16:     $ost_cl_keystone_region         = hiera('CONFIG_KEYSTONE_REGION')\n     17:     $ost_cl_keystone_demo_pw        = hiera('CONFIG_KEYSTONE_DEMO_PW')\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_AODH_DB_PW'),", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\n}\n\nif hiera('CONFIG_AODH_INSTALL') == 'y' and\nhiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\nclass { '::aodh::db::mysql':\n39:           password      => hiera('CONFIG_AODH_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 39\n\n     34:     }\n     35: \n     36:     if hiera('CONFIG_AODH_INSTALL') == 'y' and\n     37:        hiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\n     38:         class { '::aodh::db::mysql':\n>>>  39:           password      => hiera('CONFIG_AODH_DB_PW'),\n     40:           host          => '%',\n     41:           allowed_hosts => '%',\n     42:         }\n     43:     }\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-ironic.pp", "content": "password     => hiera('CONFIG_IRONIC_KS_PW'),", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-ironic.pp\n\n$ironic_port = '6385'\n$ironic_url = \"${ironic_protocol}://${ironic_host}:$ironic_port\"\n\nclass { '::ironic::keystone::auth':\nregion       => hiera('CONFIG_KEYSTONE_REGION'),\n10:         password     => hiera('CONFIG_IRONIC_KS_PW'),\npublic_url   => $ironic_url,\nadmin_url    => $ironic_url,\ninternal_url => $ironic_url,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-ironic.pp\n# Target line: 10\n\n      5:     $ironic_port = '6385'\n      6:     $ironic_url = \"${ironic_protocol}://${ironic_host}:$ironic_port\"\n      7: \n      8:     class { '::ironic::keystone::auth':\n      9:         region       => hiera('CONFIG_KEYSTONE_REGION'),\n>>>  10:         password     => hiera('CONFIG_IRONIC_KS_PW'),\n     11:         public_url   => $ironic_url,\n     12:         admin_url    => $ironic_url,\n     13:         internal_url => $ironic_url,\n     14:     }\n     15: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-windows-alias.pp", "content": "$ps_module_root = 'C:/Users/Administrator/Documents/WindowsPowerShell'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-alias.pp\n\nclass classroom::windows::alias {\n\nassert_private('This class should not be called directly')\n\n5:   $ps_module_root = 'C:/Users/Administrator/Documents/WindowsPowerShell'\n$ps_module_path = 'C:/Users/Administrator/Documents/WindowsPowerShell/Modules'\n$alias_dir      = \"${ps_module_path}/alias\"\n$psm_file       = 'alias.psm1'\n$psd_file       = 'alias.psd1'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-alias.pp\n# Target line: 5\n\n      1: class classroom::windows::alias {\n      2: \n      3:   assert_private('This class should not be called directly')\n      4: \n>>>   5:   $ps_module_root = 'C:/Users/Administrator/Documents/WindowsPowerShell'\n      6:   $ps_module_path = 'C:/Users/Administrator/Documents/WindowsPowerShell/Modules'\n      7:   $alias_dir      = \"${ps_module_path}/alias\"\n      8:   $psm_file       = 'alias.psm1'\n      9:   $psd_file       = 'alias.psd1'\n     10: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puphpet@puppet-puphpet-manifests-rabbitmq-params.pp", "content": "$gpg_key     = '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB'", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: puphpet@puppet-puphpet-manifests-rabbitmq-params.pp\n\n$repo_location = $::osfamily ? {\n'debian' => 'https://packagecloud.io/rabbitmq/rabbitmq-server',\n'redhat' => \"https://packagecloud.io/rabbitmq/rabbitmq-server/el/${facts['os'][release][major]}/\\$basearch\",\n}\n\n10:   $gpg_key     = '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB'\n\nif array_true($puphpet::params::hiera['apache'], 'install') or\narray_true($puphpet::params::hiera['nginx'], 'install')\n{\n$webserver_restart = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puphpet@puppet-puphpet-manifests-rabbitmq-params.pp\n# Target line: 10\n\n      5:   $repo_location = $::osfamily ? {\n      6:     'debian' => 'https://packagecloud.io/rabbitmq/rabbitmq-server',\n      7:     'redhat' => \"https://packagecloud.io/rabbitmq/rabbitmq-server/el/${facts['os'][release][major]}/\\$basearch\",\n      8:   }\n      9: \n>>>  10:   $gpg_key     = '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB'\n     11: \n     12:   if array_true($puphpet::params::hiera['apache'], 'install') or\n     13:      array_true($puphpet::params::hiera['nginx'], 'install')\n     14:   {\n     15:     $webserver_restart = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-gearman-manifests-server.pp", "content": "user         => 'gearman',", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-gearman-manifests-server.pp\n\n->\n\ndaemon { $fullname:\nbinary       => '/usr/sbin/gearmand',\nargs         => $daemon_args,\n65:     user         => 'gearman',\nlimit_nofile => 16384,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-gearman-manifests-server.pp\n# Target line: 65\n\n     60:   ->\n     61: \n     62:   daemon { $fullname:\n     63:     binary       => '/usr/sbin/gearmand',\n     64:     args         => $daemon_args,\n>>>  65:     user         => 'gearman',\n     66:     limit_nofile => 16384,\n     67:   }\n     68: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-git-manifests-config-local.pp", "content": "$split_key = split($key, '\\.')", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: boxen@puppet-git-manifests-config-local.pp\n\n#   git::config::local { '/tmp/foo':\n#     key   => 'user.name',\n#     value => 'Hugh Bot',\n#   }\ndefine git::config::local($key, $value, $repo = $name, $ensure = present) {\n17:   $split_key = split($key, '\\.')\n\nini_setting { \"set ${key} to ${value} in ${repo}\":\nensure  => $ensure,\npath    => \"${repo}/.git/config\",\nsection => $split_key[0],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-git-manifests-config-local.pp\n# Target line: 17\n\n     12: #   git::config::local { '/tmp/foo':\n     13: #     key   => 'user.name',\n     14: #     value => 'Hugh Bot',\n     15: #   }\n     16: define git::config::local($key, $value, $repo = $name, $ensure = present) {\n>>>  17:   $split_key = split($key, '\\.')\n     18: \n     19:   ini_setting { \"set ${key} to ${value} in ${repo}\":\n     20:     ensure  => $ensure,\n     21:     path    => \"${repo}/.git/config\",\n     22:     section => $split_key[0],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-apache-examples-vhost_directories.pp", "content": "docroot     => '/var/www/location',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-examples-vhost_directories.pp\n\n],\n}\n\n# location test\napache::vhost { 'location.example.net':\n23:   docroot     => '/var/www/location',\ndirectories => [\n{\n'path'         => '/location',\n'provider'     => 'location',\n'ServerTokens' => 'prod'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-examples-vhost_directories.pp\n# Target line: 23\n\n     18:   ],\n     19: }\n     20: \n     21: # location test\n     22: apache::vhost { 'location.example.net':\n>>>  23:   docroot     => '/var/www/location',\n     24:   directories => [\n     25:     {\n     26:       'path'         => '/location',\n     27:       'provider'     => 'location',\n     28:       'ServerTokens' => 'prod'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-placement.pp", "content": "password => 'placement',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-placement.pp\n\n}\nExec['update-ca-certificates'] ~> Service['httpd']\n}\n\nclass { '::placement::db::mysql':\n19:     password => 'placement',\n}\n\nif ($::os_package_type == 'debian') {\nclass { '::placement::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:8778\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-placement.pp\n# Target line: 19\n\n     14:     }\n     15:     Exec['update-ca-certificates'] ~> Service['httpd']\n     16:   }\n     17: \n     18:   class { '::placement::db::mysql':\n>>>  19:     password => 'placement',\n     20:   }\n     21: \n     22:   if ($::os_package_type == 'debian') {\n     23:     class { '::placement::keystone::auth':\n     24:       public_url   => \"${::openstack_integration::config::base_url}:8778\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@puppet-foreman-manifests-cli-params.pp", "content": "$password = undef", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: theforeman@puppet-foreman-manifests-cli-params.pp\n\nclass foreman::cli::params {\n$foreman_url = undef\n$version = 'installed'\n$manage_root_config = true\n$username = undef\n7:   $password = undef\n$refresh_cache = false\n$request_timeout = 120\n$ssl_ca_file = undef\n\n# OS specific paths", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@puppet-foreman-manifests-cli-params.pp\n# Target line: 7\n\n      2: class foreman::cli::params {\n      3:   $foreman_url = undef\n      4:   $version = 'installed'\n      5:   $manage_root_config = true\n      6:   $username = undef\n>>>   7:   $password = undef\n      8:   $refresh_cache = false\n      9:   $request_timeout = 120\n     10:   $ssl_ca_file = undef\n     11: \n     12:   # OS specific paths\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-jira-examples-jira_mysql_nativessl_install.pp", "content": "user     => 'jiraadm',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: voxpupuli@puppet-jira-examples-jira_mysql_nativessl_install.pp\n\nclass { 'mysql::server':\nroot_password    => 'strongpassword',\n}\n\nmysql::db { 'jira':\n11:     user     => 'jiraadm',\npassword => 'mypassword',\nhost     => 'localhost',\ngrant    => ['ALL'],\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-jira-examples-jira_mysql_nativessl_install.pp\n# Target line: 11\n\n      6:   class { 'mysql::server':\n      7:     root_password    => 'strongpassword',\n      8:   }\n      9: \n     10:   mysql::db { 'jira':\n>>>  11:     user     => 'jiraadm',\n     12:     password => 'mypassword',\n     13:     host     => 'localhost',\n     14:     grant    => ['ALL'],\n     15:   }\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp", "content": "san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n\n\ncinder::backend::dellsc_iscsi { $backend_name :\nbackend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\nsan_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\nsan_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\n50:       san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\ndell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\ntarget_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\ntarget_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\ndell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),\ndell_sc_server_folder        => hiera('cinder::backend::dellsc_iscsi::dell_sc_server_folder', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n# Target line: 50\n\n     45: \n     46:     cinder::backend::dellsc_iscsi { $backend_name :\n     47:       backend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\n     48:       san_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\n     49:       san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\n>>>  50:       san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\n     51:       dell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\n     52:       target_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\n     53:       target_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\n     54:       dell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),\n     55:       dell_sc_server_folder        => hiera('cinder::backend::dellsc_iscsi::dell_sc_server_folder', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-nodes-xhprof.pp", "content": "apt::key { '8D0DC64F': key_server => 'hkp://keyserver.ubuntu.com:80' }", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-xhprof.pp\n\nand hash_key_equals($php_values, 'install', 1)\n{\nif $::operatingsystem == 'ubuntu'\nand $::lsbdistcodename in ['lucid', 'maverick', 'natty', 'oneiric', 'precise']\n{\n14:     apt::key { '8D0DC64F': key_server => 'hkp://keyserver.ubuntu.com:80' }\napt::ppa { 'ppa:brianmercer/php5-xhprof': require => Apt::Key['8D0DC64F'] }\n}\n\n$xhprof_php_prefix = $::osfamily ? {\n'debian' => 'php5-',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-xhprof.pp\n# Target line: 14\n\n      9:   and hash_key_equals($php_values, 'install', 1)\n     10: {\n     11:   if $::operatingsystem == 'ubuntu'\n     12:     and $::lsbdistcodename in ['lucid', 'maverick', 'natty', 'oneiric', 'precise']\n     13:   {\n>>>  14:     apt::key { '8D0DC64F': key_server => 'hkp://keyserver.ubuntu.com:80' }\n     15:     apt::ppa { 'ppa:brianmercer/php5-xhprof': require => Apt::Key['8D0DC64F'] }\n     16:   }\n     17: \n     18:   $xhprof_php_prefix = $::osfamily ? {\n     19:     'debian' => 'php5-',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-ci-runner.pp", "content": "$user                = 'gitlab_ci_runner',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-runner.pp\n\n$ensure              = 'present',\n$branch              = '5-0-stable',\n$exec_path           = '/home/gitlab_ci_runner/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin',\n$ruby_version        = '2.1.6',\n$source              = 'https://gitlab.com/gitlab-org/gitlab-ci-runner.git',\n51:   $user                = 'gitlab_ci_runner',\n$user_home           = '/home/gitlab_ci_runner',\n){\n\nuser { $user:\nensure     => $ensure,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-runner.pp\n# Target line: 51\n\n     46:   $ensure              = 'present',\n     47:   $branch              = '5-0-stable',\n     48:   $exec_path           = '/home/gitlab_ci_runner/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin',\n     49:   $ruby_version        = '2.1.6',\n     50:   $source              = 'https://gitlab.com/gitlab-org/gitlab-ci-runner.git',\n>>>  51:   $user                = 'gitlab_ci_runner',\n     52:   $user_home           = '/home/gitlab_ci_runner',\n     53: ){\n     54: \n     55:   user { $user:\n     56:     ensure     => $ensure,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp", "content": "$ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n\n#\nclass ci_environment::jenkins_master (\n$github_enterprise_cert,\n$vhost,\n$ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n26:   $ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$legacy_vhost = undef,\n$legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$slave_user = 'slave',\n$jenkins_home", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n# Target line: 26\n\n     21: #\n     22: class ci_environment::jenkins_master (\n     23:   $github_enterprise_cert,\n     24:   $vhost,\n     25:   $ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n>>>  26:   $ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     27:   $legacy_vhost = undef,\n     28:   $legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     29:   $legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     30:   $slave_user = 'slave',\n     31:   $jenkins_home\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-icinga-manifests-config-pingdom.pp", "content": "$password = 'UNSET',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config-pingdom.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass icinga::config::pingdom (\n$username = 'UNSET',\n4:   $password = 'UNSET',\n$key = 'UNSET'\n) {\n\nfile { '/etc/pingdom.ini':\ncontent => template('icinga/etc/pingdom.ini.erb'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config-pingdom.pp\n# Target line: 4\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class icinga::config::pingdom (\n      3:   $username = 'UNSET',\n>>>   4:   $password = 'UNSET',\n      5:   $key = 'UNSET'\n      6: ) {\n      7: \n      8:   file { '/etc/pingdom.ini':\n      9:     content => template('icinga/etc/pingdom.ini.erb'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp", "content": "$etc_root_password   = false", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n\nclass mysql::params {\n\n$bind_address        = '127.0.0.1'\n$config_template     = 'mysql/my.cnf.erb'\n$default_engine      = 'UNSET'\n18:   $etc_root_password   = false\n$manage_service      = true\n$old_root_password   = ''\n$package_ensure      = 'present'\n$purge_conf_dir      = false\n$max_connections     = 151", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n# Target line: 18\n\n     13: class mysql::params {\n     14: \n     15:   $bind_address        = '127.0.0.1'\n     16:   $config_template     = 'mysql/my.cnf.erb'\n     17:   $default_engine      = 'UNSET'\n>>>  18:   $etc_root_password   = false\n     19:   $manage_service      = true\n     20:   $old_root_password   = ''\n     21:   $package_ensure      = 'present'\n     22:   $purge_conf_dir      = false\n     23:   $max_connections     = 151\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n}\n\ncase $::staging_http_get {\n'curl', default: {\n$http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n55:       $http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n$http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n$ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n$ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n}\n'wget': {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 55\n\n     50:   }\n     51: \n     52:   case $::staging_http_get {\n     53:     'curl', default: {\n     54:       $http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n>>>  55:       $http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n     56:       $http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n     57:       $ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n     58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n     59:     }\n     60:     'wget': {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-socket_redis-manifests-init.pp", "content": "$statusToken = undef,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-socket_redis-manifests-init.pp\n\nclass socket_redis (\n$version     = 'latest',\n$redisHost   = 'localhost',\n$socketPorts = [8090],\n$statusPort  = '8085',\n6:   $statusToken = undef,\n) {\n\nrequire 'nodejs'\n\nif $redisHost == 'localhost' {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-socket_redis-manifests-init.pp\n# Target line: 6\n\n      1: class socket_redis (\n      2:   $version     = 'latest',\n      3:   $redisHost   = 'localhost',\n      4:   $socketPorts = [8090],\n      5:   $statusPort  = '8085',\n>>>   6:   $statusToken = undef,\n      7: ) {\n      8: \n      9:   require 'nodejs'\n     10: \n     11:   if $redisHost == 'localhost' {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-service_catalog.pp", "content": "'service_catalog/password':            value => $password, secret => true;", "line": 63, "detection_span": [58, 68], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-service_catalog.pp\n\ninclude ::ironic::deps\n\nironic_config {\n'service_catalog/auth_type':           value => $auth_type;\n'service_catalog/username':            value => $username;\n63:     'service_catalog/password':            value => $password, secret => true;\n'service_catalog/auth_url':            value => $auth_url;\n'service_catalog/project_name':        value => $project_name;\n'service_catalog/user_domain_name':    value => $user_domain_name;\n'service_catalog/project_domain_name': value => $project_domain_name;\n'service_catalog/endpoint_override':   value => $endpoint_override;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-service_catalog.pp\n# Target line: 63\n\n     58:   include ::ironic::deps\n     59: \n     60:   ironic_config {\n     61:     'service_catalog/auth_type':           value => $auth_type;\n     62:     'service_catalog/username':            value => $username;\n>>>  63:     'service_catalog/password':            value => $password, secret => true;\n     64:     'service_catalog/auth_url':            value => $auth_url;\n     65:     'service_catalog/project_name':        value => $project_name;\n     66:     'service_catalog/user_domain_name':    value => $user_domain_name;\n     67:     'service_catalog/project_domain_name': value => $project_domain_name;\n     68:     'service_catalog/endpoint_override':   value => $endpoint_override;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-distributed-replicate-example.pp", "content": "fsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n\n\ngluster::brick { 'annex2.example.com:/mnt/storage2a':\ndev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\nlabeltype => 'gpt',\nfstype => 'xfs',\n57: \t\tfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n# Target line: 57\n\n     52: \n     53: \tgluster::brick { 'annex2.example.com:/mnt/storage2a':\n     54: \t\tdev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\n     55: \t\tlabeltype => 'gpt',\n     56: \t\tfstype => 'xfs',\n>>>  57: \t\tfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\n     58: \t\txfs_inode64 => true,\n     59: \t\txfs_nobarrier => true,\n     60: \t\tareyousure => true,\n     61: \t}\n     62: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-mysql.pp", "content": "user     => 'signonotron2',", "line": 82, "detection_span": [77, 87], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-mysql.pp\n\nuser     => 'search_admin',\npassword => 'search_admin',\nrequire  => Class['::mysql::server'];\n\n['signonotron2_test', 'signonotron2_integration_test']:\n82:       user     => 'signonotron2',\npassword => 'signonotron2',\nrequire  => Class['::mysql::server'];\n\n'support_contacts_test':\nuser     => 'support_contacts',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-mysql.pp\n# Target line: 82\n\n     77:       user     => 'search_admin',\n     78:       password => 'search_admin',\n     79:       require  => Class['::mysql::server'];\n     80: \n     81:     ['signonotron2_test', 'signonotron2_integration_test']:\n>>>  82:       user     => 'signonotron2',\n     83:       password => 'signonotron2',\n     84:       require  => Class['::mysql::server'];\n     85: \n     86:     'support_contacts_test':\n     87:       user     => 'support_contacts',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-publishing_api-rabbitmq.pp", "content": "$amqp_user  = 'publishing_api',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-publishing_api-rabbitmq.pp\n\n#\n# [*configure_test_exchange*]\n#   Whether or not to set up a test exchange for development (default: false)\n#\nclass govuk::apps::publishing_api::rabbitmq (\n24:   $amqp_user  = 'publishing_api',\n$amqp_pass  = 'publishing_api',\n$amqp_exchange = 'published_documents',\n$configure_test_exchange = false,\n) {\nrabbitmq_user { $amqp_user:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-publishing_api-rabbitmq.pp\n# Target line: 24\n\n     19: #\n     20: # [*configure_test_exchange*]\n     21: #   Whether or not to set up a test exchange for development (default: false)\n     22: #\n     23: class govuk::apps::publishing_api::rabbitmq (\n>>>  24:   $amqp_user  = 'publishing_api',\n     25:   $amqp_pass  = 'publishing_api',\n     26:   $amqp_exchange = 'published_documents',\n     27:   $configure_test_exchange = false,\n     28: ) {\n     29:   rabbitmq_user { $amqp_user:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_jenkins.pp", "content": "$jenkins_api_token = undef,", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_jenkins.pp\n\n#   A hash of environment variables that should be set for all Jenkins jobs.\n#\nclass govuk::node::s_jenkins (\n$github_client_id = undef,\n$github_client_secret_encrypted = undef,\n22:   $jenkins_api_token = undef,\n$environment_variables = {},\n) inherits govuk::node::s_base {\ninclude google_chrome\ninclude nginx\ninclude govuk_postgresql::client", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_jenkins.pp\n# Target line: 22\n\n     17: #   A hash of environment variables that should be set for all Jenkins jobs.\n     18: #\n     19: class govuk::node::s_jenkins (\n     20:   $github_client_id = undef,\n     21:   $github_client_secret_encrypted = undef,\n>>>  22:   $jenkins_api_token = undef,\n     23:   $environment_variables = {},\n     24: ) inherits govuk::node::s_base {\n     25:   include google_chrome\n     26:   include nginx\n     27:   include govuk_postgresql::client\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$brick2a = {", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n38: $brick2a = {\ndev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\nlabeltype => 'gpt',\nfstype => 'xfs',\nfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\nxfs_inode64 => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 38\n\n     33: \txfs_inode64 => true,\n     34: \txfs_nobarrier => true,\n     35: \tareyousure => true,\n     36: }\n     37: \n>>>  38: $brick2a = {\n     39: \tdev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\n     40: \tlabeltype => 'gpt',\n     41: \tfstype => 'xfs',\n     42: \tfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\n     43: \txfs_inode64 => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp", "content": "$http_username = undef,", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n\n$oauth_secret = '',\n$port = 3111,\n$secret_key_base = undef,\n$publishing_api_bearer_token = undef,\n$asset_manager_bearer_token = undef,\n72:   $http_username = undef,\n$http_password = undef,\n) {\n\ninclude govuk_postgresql::client #installs libpq-dev package needed for pg gem\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n# Target line: 72\n\n     67:   $oauth_secret = '',\n     68:   $port = 3111,\n     69:   $secret_key_base = undef,\n     70:   $publishing_api_bearer_token = undef,\n     71:   $asset_manager_bearer_token = undef,\n>>>  72:   $http_username = undef,\n     73:   $http_password = undef,\n     74: ) {\n     75: \n     76:   include govuk_postgresql::client #installs libpq-dev package needed for pg gem\n     77: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-manifests-init.pp", "content": "$cobbler_user       = 'cobbler',", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-manifests-init.pp\n\n$dhcp_end_address   = '10.0.0.254',\n$dhcp_netmask       = '255.255.255.0',\n$dhcp_gateway       = $ipaddress,\n$dhcp_ipaddress     = '127.0.0.1',\n\n59:   $cobbler_user       = 'cobbler',\n$cobbler_password   = 'cobbler',\n\n$pxetimeout         = '0'\n\n){", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-manifests-init.pp\n# Target line: 59\n\n     54:   $dhcp_end_address   = '10.0.0.254',\n     55:   $dhcp_netmask       = '255.255.255.0',\n     56:   $dhcp_gateway       = $ipaddress,\n     57:   $dhcp_ipaddress     = '127.0.0.1',\n     58: \n>>>  59:   $cobbler_user       = 'cobbler',\n     60:   $cobbler_password   = 'cobbler',\n     61: \n     62:   $pxetimeout         = '0'\n     63: \n     64:   ){\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_publishing_api_db_admin.pp", "content": "$postgres_user        = undef,", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_publishing_api_db_admin.pp\n\n# === Parameters\n#\nclass govuk::node::s_publishing_api_db_admin(\n$backup_s3_bucket     = undef,\n$postgres_host        = undef,\n10:   $postgres_user        = undef,\n$postgres_password    = undef,\n$postgres_port        = '5432',\n$postgres_backup_hour = 7,\n$postgres_backup_min  = 30,\n$apt_mirror_hostname,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_publishing_api_db_admin.pp\n# Target line: 10\n\n      5: # === Parameters\n      6: #\n      7: class govuk::node::s_publishing_api_db_admin(\n      8:   $backup_s3_bucket     = undef,\n      9:   $postgres_host        = undef,\n>>>  10:   $postgres_user        = undef,\n     11:   $postgres_password    = undef,\n     12:   $postgres_port        = '5432',\n     13:   $postgres_backup_hour = 7,\n     14:   $postgres_backup_min  = 30,\n     15:   $apt_mirror_hostname,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_compute.pp", "content": "key => 'vm.max_map_count',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_compute.pp\n\nif ($enable_dpdk) {\nmount { '/hugepages':\nensure => absent,\n} ->\ncontrail::lib::augeas_conf_rm { \"max_map_count_value_removed\":\n38:         key => 'vm.max_map_count',\nconfig_file => '/etc/sysctl.conf',\nlens_to_use => 'properties.lns',\n} ->\nfile_line {'fstab_hugetlbfs':\nensure  => absent,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_compute.pp\n# Target line: 38\n\n     33:     if ($enable_dpdk) {\n     34:       mount { '/hugepages':\n     35:         ensure => absent,\n     36:       } ->\n     37:       contrail::lib::augeas_conf_rm { \"max_map_count_value_removed\":\n>>>  38:         key => 'vm.max_map_count',\n     39:         config_file => '/etc/sysctl.conf',\n     40:         lens_to_use => 'properties.lns',\n     41:       } ->\n     42:       file_line {'fstab_hugetlbfs':\n     43:         ensure  => absent,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-jenkins-manifests-plugin-github.pp", "content": "$username = undef,", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-jenkins-manifests-plugin-github.pp\n\nclass jenkins::plugin::github(\n$oauth_access_token = undef,\n3:   $username = undef,\n$password = undef,\n$api_url = undef\n) {\n\nrequire 'jenkins::plugin::git'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-jenkins-manifests-plugin-github.pp\n# Target line: 3\n\n      1: class jenkins::plugin::github(\n      2:   $oauth_access_token = undef,\n>>>   3:   $username = undef,\n      4:   $password = undef,\n      5:   $api_url = undef\n      6: ) {\n      7: \n      8:   require 'jenkins::plugin::git'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-params.pp", "content": "$ca_bundle_cert_path = '/etc/ssl/certs/ca-bundle.crt'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-params.pp\n\nclass openstack_integration::params {\n\ncase $::osfamily {\n'RedHat': {\n5:       $ca_bundle_cert_path = '/etc/ssl/certs/ca-bundle.crt'\n$cert_path           = '/etc/pki/ca-trust/source/anchors/puppet_openstack.pem'\n$update_ca_certs_cmd = '/usr/bin/update-ca-trust force-enable && /usr/bin/update-ca-trust extract'\n}\n'Debian': {\n$ca_bundle_cert_path = '/etc/ssl/certs/puppet_openstack.pem'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-params.pp\n# Target line: 5\n\n      1: class openstack_integration::params {\n      2: \n      3:   case $::osfamily {\n      4:     'RedHat': {\n>>>   5:       $ca_bundle_cert_path = '/etc/ssl/certs/ca-bundle.crt'\n      6:       $cert_path           = '/etc/pki/ca-trust/source/anchors/puppet_openstack.pem'\n      7:       $update_ca_certs_cmd = '/usr/bin/update-ca-trust force-enable && /usr/bin/update-ca-trust extract'\n      8:     }\n      9:     'Debian': {\n     10:       $ca_bundle_cert_path = '/etc/ssl/certs/puppet_openstack.pem'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-horizon.pp", "content": "horizon_key      => \"/etc/openstack-dashboard/ssl/private/${::fqdn}.pem\",", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-horizon.pp\n\nsecret_key       => 'big_secret',\nallowed_hosts    => $::openstack_integration::config::ip_for_url,\nlisten_ssl       => $::openstack_integration::config::ssl,\nssl_redirect     => $::openstack_integration::config::ssl,\nhorizon_cert     => $::openstack_integration::params::cert_path,\n37:     horizon_key      => \"/etc/openstack-dashboard/ssl/private/${::fqdn}.pem\",\nhorizon_ca       => $::openstack_integration::params::ca_bundle_cert_path,\nkeystone_url     => $::openstack_integration::config::keystone_auth_uri,\nlog_level        => 'DEBUG',\n# need to disable offline compression due to\n# https://bugs.launchpad.net/ubuntu/+source/horizon/+bug/1424042", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-horizon.pp\n# Target line: 37\n\n     32:     secret_key       => 'big_secret',\n     33:     allowed_hosts    => $::openstack_integration::config::ip_for_url,\n     34:     listen_ssl       => $::openstack_integration::config::ssl,\n     35:     ssl_redirect     => $::openstack_integration::config::ssl,\n     36:     horizon_cert     => $::openstack_integration::params::cert_path,\n>>>  37:     horizon_key      => \"/etc/openstack-dashboard/ssl/private/${::fqdn}.pem\",\n     38:     horizon_ca       => $::openstack_integration::params::ca_bundle_cert_path,\n     39:     keystone_url     => $::openstack_integration::config::keystone_auth_uri,\n     40:     log_level        => 'DEBUG',\n     41:     # need to disable offline compression due to\n     42:     # https://bugs.launchpad.net/ubuntu/+source/horizon/+bug/1424042\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_api_mongo.pp", "content": "user       => 'mongodb',", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_api_mongo.pp\n\noutgoing => 27017,\n}\n\nlimits::limits { 'api_mongo_nofile':\nensure     => present,\n16:     user       => 'mongodb',\nlimit_type => 'nofile',\nboth       => 4096,\n}\n\nif ! $::aws_migration {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_api_mongo.pp\n# Target line: 16\n\n     11:     outgoing => 27017,\n     12:   }\n     13: \n     14:   limits::limits { 'api_mongo_nofile':\n     15:     ensure     => present,\n>>>  16:     user       => 'mongodb',\n     17:     limit_type => 'nofile',\n     18:     both       => 4096,\n     19:   }\n     20: \n     21:   if ! $::aws_migration {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp", "content": "key    => 'numberOfItemsPlaceInsideFolder',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n\n}\n\nboxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInsideFolder':\nuser   => $::luser,\ndomain => 'com.naotaka.ClipMenu',\n19:     key    => 'numberOfItemsPlaceInsideFolder',\nvalue  => 20,\n}\n\nboxen::osx_defaults { 'Clipmenu maxMenuItemTitleLength':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n# Target line: 19\n\n     14:   }\n     15: \n     16:   boxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInsideFolder':\n     17:     user   => $::luser,\n     18:     domain => 'com.naotaka.ClipMenu',\n>>>  19:     key    => 'numberOfItemsPlaceInsideFolder',\n     20:     value  => 20,\n     21:   }\n     22: \n     23:   boxen::osx_defaults { 'Clipmenu maxMenuItemTitleLength':\n     24:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ceph@puppet-ceph-manifests-rgw-apache.pp", "content": "$docroot = '/var/www',", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: ceph@puppet-ceph-manifests-rgw-apache.pp\n\n#   http://ceph.com/docs/master/install/install-ceph-gateway/\n#   for more info on repository recommendations.\n#\ndefine ceph::rgw::apache (\n$admin_email = 'root@localhost',\n55:   $docroot = '/var/www',\n$fcgi_file = '/var/www/s3gw.fcgi',\n$rgw_dns_name = $::fqdn,\n$rgw_port = 80,\n$rgw_socket_path = $::ceph::params::rgw_socket_path,\n$syslog = true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: ceph@puppet-ceph-manifests-rgw-apache.pp\n# Target line: 55\n\n     50: #   http://ceph.com/docs/master/install/install-ceph-gateway/\n     51: #   for more info on repository recommendations.\n     52: #\n     53: define ceph::rgw::apache (\n     54:   $admin_email = 'root@localhost',\n>>>  55:   $docroot = '/var/www',\n     56:   $fcgi_file = '/var/www/s3gw.fcgi',\n     57:   $rgw_dns_name = $::fqdn,\n     58:   $rgw_port = 80,\n     59:   $rgw_socket_path = $::ceph::params::rgw_socket_path,\n     60:   $syslog = true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-influxdb-bootstrap.pp", "content": "$influxdb_password = undef,", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n\n#\n# [*influxdb_retention_replication*]\n#   influxdb retention policy replication factor\n#\nclass monasca::influxdb::bootstrap(\n29:   $influxdb_password = undef,\n$influxdb_dbuser_ro_password = undef,\n$influxdb_def_ret_pol_name = 'raw',\n$influxdb_def_ret_pol_duration = '390d',\n$influxdb_tmp_ret_pol_name = 'tmp',\n$influxdb_tmp_ret_pol_duration = '1h',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n# Target line: 29\n\n     24: #\n     25: # [*influxdb_retention_replication*]\n     26: #   influxdb retention policy replication factor\n     27: #\n     28: class monasca::influxdb::bootstrap(\n>>>  29:   $influxdb_password = undef,\n     30:   $influxdb_dbuser_ro_password = undef,\n     31:   $influxdb_def_ret_pol_name = 'raw',\n     32:   $influxdb_def_ret_pol_duration = '390d',\n     33:   $influxdb_tmp_ret_pol_name = 'tmp',\n     34:   $influxdb_tmp_ret_pol_duration = '1h',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp", "content": "key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n\nclass classroom::windows::disable_esc {\nassert_private('This class should not be called directly')\n\n# Disable Internet Explorer ESC for users and admins, both\nregistry::value { 'IE_ESC_users':\n6:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}',\nvalue => 'IsInstalled',\ntype  => dword,\ndata  => '0',\n}\nregistry::value { 'IE_ESC_admin':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n# Target line: 6\n\n      1: class classroom::windows::disable_esc {\n      2:   assert_private('This class should not be called directly')\n      3: \n      4:   # Disable Internet Explorer ESC for users and admins, both\n      5:   registry::value { 'IE_ESC_users':\n>>>   6:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}',\n      7:     value => 'IsInstalled',\n      8:     type  => dword,\n      9:     data  => '0',\n     10:   }\n     11:   registry::value { 'IE_ESC_admin':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-deploy.pp", "content": "$aws_ses_smtp_username = 'UNSET',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::deploy (\n$setup_actionmailer_ses_config = true,\n$actionmailer_enable_delivery = true,\n$aws_ses_smtp_host = 'UNSET',\n6:     $aws_ses_smtp_username = 'UNSET',\n$aws_ses_smtp_password = 'UNSET',\n){\ninclude govuk_harden\ninclude govuk_logging\ninclude govuk_python", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy.pp\n# Target line: 6\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::deploy (\n      3:     $setup_actionmailer_ses_config = true,\n      4:     $actionmailer_enable_delivery = true,\n      5:     $aws_ses_smtp_host = 'UNSET',\n>>>   6:     $aws_ses_smtp_username = 'UNSET',\n      7:     $aws_ses_smtp_password = 'UNSET',\n      8: ){\n      9:   include govuk_harden\n     10:   include govuk_logging\n     11:   include govuk_python\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-gerrit-manifests-mysql.pp", "content": "$database_password = '',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-mysql.pp\n\n#   [*database_password*] - database user password\n#   [*database_user*] - database user name\n#\nclass gerrit::mysql (\n$database_name     = '',\n13:   $database_password = '',\n$database_user     = '',\n) {\n\nclass { '::mysql::server' :}\nclass { '::mysql::client' :}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-mysql.pp\n# Target line: 13\n\n      8: #   [*database_password*] - database user password\n      9: #   [*database_user*] - database user name\n     10: #\n     11: class gerrit::mysql (\n     12:   $database_name     = '',\n>>>  13:   $database_password = '',\n     14:   $database_user     = '',\n     15: ) {\n     16: \n     17:   class { '::mysql::server' :}\n     18:   class { '::mysql::client' :}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-apt-manifests-params.pp", "content": "$root           = '/etc/apt'", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-params.pp\n\nclass apt::params {\n2:   $root           = '/etc/apt'\n$provider       = '/usr/bin/apt-get'\n$sources_list_d = \"${root}/sources.list.d\"\n$apt_conf_d     = \"${root}/apt.conf.d\"\n$preferences_d  = \"${root}/preferences.d\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-params.pp\n# Target line: 2\n\n      1: class apt::params {\n>>>   2:   $root           = '/etc/apt'\n      3:   $provider       = '/usr/bin/apt-get'\n      4:   $sources_list_d = \"${root}/sources.list.d\"\n      5:   $apt_conf_d     = \"${root}/apt.conf.d\"\n      6:   $preferences_d  = \"${root}/preferences.d\"\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp", "content": "$username = 'lpupdatebug',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n\n$port = '29418',\n$projects = [],\n$sshprivkey = '/etc/lpupdatebug/lpupdatebug.key',\n$sshprivkey_contents = undef,\n$update_status = 'yes',\n43:   $username = 'lpupdatebug',\n) {\n\nensure_packages([$package_name])\n\nif ($sshprivkey_contents)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n# Target line: 43\n\n     38:   $port = '29418',\n     39:   $projects = [],\n     40:   $sshprivkey = '/etc/lpupdatebug/lpupdatebug.key',\n     41:   $sshprivkey_contents = undef,\n     42:   $update_status = 'yes',\n>>>  43:   $username = 'lpupdatebug',\n     44: ) {\n     45: \n     46:   ensure_packages([$package_name])\n     47: \n     48:   if ($sshprivkey_contents)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "password => 'contacts',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\npassword => 'collections_publisher',\nrequire  => Class['::mysql::server'];\n\n'contacts_test':\nuser     => 'contacts',\n25:       password => 'contacts',\nrequire  => Class['::mysql::server'];\n\n'content_planner_test':\nuser     => 'content_planner',\npassword => 'content_planner',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 25\n\n     20:       password => 'collections_publisher',\n     21:       require  => Class['::mysql::server'];\n     22: \n     23:     'contacts_test':\n     24:       user     => 'contacts',\n>>>  25:       password => 'contacts',\n     26:       require  => Class['::mysql::server'];\n     27: \n     28:     'content_planner_test':\n     29:       user     => 'content_planner',\n     30:       password => 'content_planner',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp", "content": "$slave_user = 'slave',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n\n$ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$legacy_vhost = undef,\n$legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n30:   $slave_user = 'slave',\n$jenkins_home\n) {\nvalidate_string($github_enterprise_cert, $vhost, $jenkins_home)\n\napt::source { 'govuk-jenkins':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n# Target line: 30\n\n     25:   $ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     26:   $ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     27:   $legacy_vhost = undef,\n     28:   $legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     29:   $legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n>>>  30:   $slave_user = 'slave',\n     31:   $jenkins_home\n     32: ) {\n     33:   validate_string($github_enterprise_cert, $vhost, $jenkins_home)\n     34: \n     35:   apt::source { 'govuk-jenkins':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-mistral.pp", "content": "password => 'mistral',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n\nadmin_url    => \"${::openstack_integration::config::base_url}:8989/v2\",\ninternal_url => \"${::openstack_integration::config::base_url}:8989/v2\",\npassword     => 'a_big_secret',\n}\nclass { '::mistral::db::mysql':\n43:     password => 'mistral',\n}\nclass { '::mistral::api':\nservice_name => 'httpd',\n}\ninclude ::apache", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n# Target line: 43\n\n     38:     admin_url    => \"${::openstack_integration::config::base_url}:8989/v2\",\n     39:     internal_url => \"${::openstack_integration::config::base_url}:8989/v2\",\n     40:     password     => 'a_big_secret',\n     41:   }\n     42:   class { '::mistral::db::mysql':\n>>>  43:     password => 'mistral',\n     44:   }\n     45:   class { '::mistral::api':\n     46:     service_name => 'httpd',\n     47:   }\n     48:   include ::apache\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp", "content": "key    => 'ShowDevelopMenu',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n\nclass people::felho::application_settings::twitter {\nboxen::osx_defaults { 'Enable the hidden \\'Develop\\' menu':\nuser   => $::luser,\ndomain => 'com.twitter.twitter-mac',\n5:     key    => 'ShowDevelopMenu',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Open links in the background':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n# Target line: 5\n\n      1: class people::felho::application_settings::twitter {\n      2:   boxen::osx_defaults { 'Enable the hidden \\'Develop\\' menu':\n      3:     user   => $::luser,\n      4:     domain => 'com.twitter.twitter-mac',\n>>>   5:     key    => 'ShowDevelopMenu',\n      6:     type   => 'bool',\n      7:     value  => true,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Open links in the background':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-pp_postgres-manifests-db.pp", "content": "password => postgresql_password($title, $password),", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-db.pp\n\ndefine pp_postgres::db(\n$password\n) {\npostgresql::server::db { $title:\nuser     => $title,\n6:     password => postgresql_password($title, $password),\n}\n\npp_postgres::hba_rule { $title:\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-db.pp\n# Target line: 6\n\n      1: define pp_postgres::db(\n      2:   $password\n      3: ) {\n      4:   postgresql::server::db { $title:\n      5:     user     => $title,\n>>>   6:     password => postgresql_password($title, $password),\n      7:   }\n      8: \n      9:   pp_postgres::hba_rule { $title:\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-server-notifications.pp", "content": "'nova/password':            value => $password, secret => true;", "line": 117, "detection_span": [112, 122], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-server-notifications.pp\n\n112:   }\n113:\n114:   neutron_config {\n'nova/auth_url':            value => $auth_url;\n'nova/username':            value => $username;\n117:     'nova/password':            value => $password, secret => true;\n'nova/project_domain_id':   value => $project_domain_id;\n'nova/project_domain_name': value => $project_domain_name;\n'nova/project_name':        value => $project_name;\n'nova/user_domain_id':      value => $user_domain_id;\n'nova/user_domain_name':    value => $user_domain_name;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-server-notifications.pp\n# Target line: 117\n\n    112:   }\n    113: \n    114:   neutron_config {\n    115:     'nova/auth_url':            value => $auth_url;\n    116:     'nova/username':            value => $username;\n>>> 117:     'nova/password':            value => $password, secret => true;\n    118:     'nova/project_domain_id':   value => $project_domain_id;\n    119:     'nova/project_domain_name': value => $project_domain_name;\n    120:     'nova/project_name':        value => $project_name;\n    121:     'nova/user_domain_id':      value => $user_domain_id;\n    122:     'nova/user_domain_name':    value => $user_domain_name;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "attachmentgenie@attachmentgenie-ssh-manifests-params.pp", "content": "$permit_root_login               = 'no'", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: attachmentgenie@attachmentgenie-ssh-manifests-params.pp\n\n$max_sessions                    = 10\n$max_startups                    = '10:30:100'\n$password_authentication_groups  = []\n$password_authentication_users   = []\n$password_authentication         = 'no'\n38:   $permit_root_login               = 'no'\n$permit_tunnel                   = 'no'\n$permit_tty_users                = {}\n$permit_user_environment         = 'no'\n$port                            = '22'\n$print_motd                      = 'no'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: attachmentgenie@attachmentgenie-ssh-manifests-params.pp\n# Target line: 38\n\n     33:   $max_sessions                    = 10\n     34:   $max_startups                    = '10:30:100'\n     35:   $password_authentication_groups  = []\n     36:   $password_authentication_users   = []\n     37:   $password_authentication         = 'no'\n>>>  38:   $permit_root_login               = 'no'\n     39:   $permit_tunnel                   = 'no'\n     40:   $permit_tty_users                = {}\n     41:   $permit_user_environment         = 'no'\n     42:   $port                            = '22'\n     43:   $print_motd                      = 'no'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-dev@devstack-vagrant-puppet-modules-user-manifests-vagrant.pp", "content": "$username = 'vagrant'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-vagrant.pp\n\n# == Class: user::vagrant\n#\n\nclass user::vagrant(\n5:   $username = 'vagrant'\n)\n{\nfile {\"/home/${username}/.bashrc\":\nowner => $username,\ngroup => $username,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-vagrant.pp\n# Target line: 5\n\n      1: # == Class: user::vagrant\n      2: #\n      3: \n      4: class user::vagrant(\n>>>   5:   $username = 'vagrant'\n      6: )\n      7: {\n      8:   file {\"/home/${username}/.bashrc\":\n      9:     owner => $username,\n     10:     group => $username,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_ci-manifests-limits.pp", "content": "user       => 'jenkins',", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-limits.pp\n\nboth       => 8192,\n}\n\nlimits::limits { 'jenkins_nproc':\nensure     => present,\n15:     user       => 'jenkins',\nlimit_type => 'nproc',\nboth       => 30654,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-limits.pp\n# Target line: 15\n\n     10:     both       => 8192,\n     11:   }\n     12: \n     13:   limits::limits { 'jenkins_nproc':\n     14:     ensure     => present,\n>>>  15:     user       => 'jenkins',\n     16:     limit_type => 'nproc',\n     17:     both       => 30654,\n     18:   }\n     19: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-tor-manifests-onionbalance.pp", "content": "$instance_user = '_tor-onionbalance'", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: duritong@puppet-tor-manifests-onionbalance.pp\n\n\ncase $facts['osfamily'] {\n'Debian': {\n$pkg_name = 'onionbalance'\n$instance_file = '/etc/tor/instances/onionbalance/torrc'\n24:       $instance_user = '_tor-onionbalance'\nexec{'/usr/sbin/tor-instance-create onionbalance':\ncreates => '/etc/tor/instances/onionbalance',\nrequire => Package['tor'],\nbefore  => File[$instance_file],\n} -> augeas{\"manage_onionbalance_in_group_${instance_user}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-tor-manifests-onionbalance.pp\n# Target line: 24\n\n     19: \n     20:   case $facts['osfamily'] {\n     21:     'Debian': {\n     22:       $pkg_name = 'onionbalance'\n     23:       $instance_file = '/etc/tor/instances/onionbalance/torrc'\n>>>  24:       $instance_user = '_tor-onionbalance'\n     25:       exec{'/usr/sbin/tor-instance-create onionbalance':\n     26:         creates => '/etc/tor/instances/onionbalance',\n     27:         require => Package['tor'],\n     28:         before  => File[$instance_file],\n     29:       } -> augeas{\"manage_onionbalance_in_group_${instance_user}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp", "content": "$default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'", "line": 93, "detection_span": [88, 98], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n\n$logroot          = '/var/log/apache2'\n$lib_path         = '/usr/lib/apache2/modules'\n$mpm_module       = 'worker'\n$dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n$default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n93:     $default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$ssl_certs_dir    = '/etc/ssl/certs'\n$passenger_root   = '/usr'\n$passenger_ruby   = '/usr/bin/ruby'\n$mod_packages     = {\n'auth_kerb'  => 'libapache2-mod-auth-kerb',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n# Target line: 93\n\n     88:     $logroot          = '/var/log/apache2'\n     89:     $lib_path         = '/usr/lib/apache2/modules'\n     90:     $mpm_module       = 'worker'\n     91:     $dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n     92:     $default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n>>>  93:     $default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     94:     $ssl_certs_dir    = '/etc/ssl/certs'\n     95:     $passenger_root   = '/usr'\n     96:     $passenger_ruby   = '/usr/bin/ruby'\n     97:     $mod_packages     = {\n     98:       'auth_kerb'  => 'libapache2-mod-auth-kerb',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-fujitsu-fossw.pp", "content": "'fujitsu_fossw/password'               : value => $password, secret => true;", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-fujitsu-fossw.pp\n\nrequire ::neutron::plugins::ml2\n\nneutron_plugin_ml2 {\n'fujitsu_fossw/fossw_ips'              : value => join(any2array($fossw_ips), ',');\n'fujitsu_fossw/username'               : value => $username;\n65:     'fujitsu_fossw/password'               : value => $password, secret => true;\n'fujitsu_fossw/port'                   : value => $port;\n'fujitsu_fossw/timeout'                : value => $timeout;\n'fujitsu_fossw/udp_dest_port'          : value => $udp_dest_port;\n'fujitsu_fossw/ovsdb_vlanid_range_min' : value => $ovsdb_vlanid_range_min;\n'fujitsu_fossw/ovsdb_port'             : value => $ovsdb_port;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-fujitsu-fossw.pp\n# Target line: 65\n\n     60:   require ::neutron::plugins::ml2\n     61: \n     62:   neutron_plugin_ml2 {\n     63:     'fujitsu_fossw/fossw_ips'              : value => join(any2array($fossw_ips), ',');\n     64:     'fujitsu_fossw/username'               : value => $username;\n>>>  65:     'fujitsu_fossw/password'               : value => $password, secret => true;\n     66:     'fujitsu_fossw/port'                   : value => $port;\n     67:     'fujitsu_fossw/timeout'                : value => $timeout;\n     68:     'fujitsu_fossw/udp_dest_port'          : value => $udp_dest_port;\n     69:     'fujitsu_fossw/ovsdb_vlanid_range_min' : value => $ovsdb_vlanid_range_min;\n     70:     'fujitsu_fossw/ovsdb_port'             : value => $ovsdb_port;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-aide-cron.pp", "content": "$aide_cron_user = hiera('aide_cron_user', 'root'),", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aide-cron.pp\n\n#   Defaults to mailx\n#\nclass tripleo::profile::base::aide::cron (\n$step           = Integer(hiera('step')),\n$aide_command   = '/usr/sbin/aide',\n53:   $aide_cron_user = hiera('aide_cron_user', 'root'),\n$aide_hour      = hiera('aide_hour', 3),\n$aide_minute    = hiera('aide_minute', 0),\n$aide_email     = hiera('aide_email', undef),\n$aide_mua_path  = hiera('aide_mua_path', '/bin/mailx')\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aide-cron.pp\n# Target line: 53\n\n     48: #   Defaults to mailx\n     49: #\n     50: class tripleo::profile::base::aide::cron (\n     51:   $step           = Integer(hiera('step')),\n     52:   $aide_command   = '/usr/sbin/aide',\n>>>  53:   $aide_cron_user = hiera('aide_cron_user', 'root'),\n     54:   $aide_hour      = hiera('aide_hour', 3),\n     55:   $aide_minute    = hiera('aide_minute', 0),\n     56:   $aide_email     = hiera('aide_email', undef),\n     57:   $aide_mua_path  = hiera('aide_mua_path', '/bin/mailx')\n     58:   ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-ceilometer.pp", "content": "auth_password => hiera('CONFIG_CEILOMETER_KS_PW'),", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-ceilometer.pp\n\nevent_pipeline_publishers => [\"gnocchi://\", \"panko://\"],\n}\n\nclass { '::ceilometer::agent::auth':\nauth_url      => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\n48:       auth_password => hiera('CONFIG_CEILOMETER_KS_PW'),\nauth_region   => hiera('CONFIG_KEYSTONE_REGION'),\n}\n\nclass { '::ceilometer::agent::central':\ncoordination_url => $coordination_url,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-ceilometer.pp\n# Target line: 48\n\n     43:       event_pipeline_publishers => [\"gnocchi://\", \"panko://\"],\n     44:     }\n     45: \n     46:     class { '::ceilometer::agent::auth':\n     47:       auth_url      => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\n>>>  48:       auth_password => hiera('CONFIG_CEILOMETER_KS_PW'),\n     49:       auth_region   => hiera('CONFIG_KEYSTONE_REGION'),\n     50:     }\n     51: \n     52:     class { '::ceilometer::agent::central':\n     53:       coordination_url => $coordination_url,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "key    => 'ShowPercent',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\nclass people::felho::osx_settings::miscellaneous {\n# Please note that this feature was removed in Lion\nboxen::osx_defaults { 'Show remaining battery percentage':\nuser   => $::luser,\ndomain => 'com.apple.menuextra.battery',\n6:     key    => 'ShowPercent',\ntype   => 'string',\nvalue  => 'YES',\n}\n\nboxen::osx_defaults { 'Expand save panel by default':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 6\n\n      1: class people::felho::osx_settings::miscellaneous {\n      2:   # Please note that this feature was removed in Lion\n      3:   boxen::osx_defaults { 'Show remaining battery percentage':\n      4:     user   => $::luser,\n      5:     domain => 'com.apple.menuextra.battery',\n>>>   6:     key    => 'ShowPercent',\n      7:     type   => 'string',\n      8:     value  => 'YES',\n      9:   }\n     10: \n     11:   boxen::osx_defaults { 'Expand save panel by default':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_multigesture.pp", "content": "key    => 'TrackpadThreeFingerTapGesture',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_multigesture.pp\n\n}\n\nboxen::osx_defaults { 'Enable Lookup with Tree Fingers on Trackpad':\nuser   => $::luser,\ndomain => 'com.apple.driver.AppleBluetoothMultitouch.trackpad',\n26:     key    => 'TrackpadThreeFingerTapGesture',\ntype   => 'int',\nvalue  => 2,\n}\n\nboxen::osx_defaults { 'Enable Notification Center on Trackpad':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_multigesture.pp\n# Target line: 26\n\n     21:   }\n     22: \n     23:   boxen::osx_defaults { 'Enable Lookup with Tree Fingers on Trackpad':\n     24:     user   => $::luser,\n     25:     domain => 'com.apple.driver.AppleBluetoothMultitouch.trackpad',\n>>>  26:     key    => 'TrackpadThreeFingerTapGesture',\n     27:     type   => 'int',\n     28:     value  => 2,\n     29:   }\n     30: \n     31:   boxen::osx_defaults { 'Enable Notification Center on Trackpad':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-params.pp", "content": "$user                = pick($user, 'mongodb')", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-params.pp\n\n$bind_ip     = pick($bind_ip, ['127.0.0.1'])\n$fork        = true\n} else {\n# RedHat/CentOS doesn't come with a prepacked mongodb\n# so we assume that you are using EPEL repository.\n31:         $user                = pick($user, 'mongodb')\n$group               = pick($group, 'mongodb')\n$server_package_name = pick($server_package_name, 'mongodb-server')\n$client_package_name = pick($client_package_name, 'mongodb')\n\n$service_name        = pick($service_name, 'mongod')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-params.pp\n# Target line: 31\n\n     26:         $bind_ip     = pick($bind_ip, ['127.0.0.1'])\n     27:         $fork        = true\n     28:       } else {\n     29:         # RedHat/CentOS doesn't come with a prepacked mongodb\n     30:         # so we assume that you are using EPEL repository.\n>>>  31:         $user                = pick($user, 'mongodb')\n     32:         $group               = pick($group, 'mongodb')\n     33:         $server_package_name = pick($server_package_name, 'mongodb-server')\n     34:         $client_package_name = pick($client_package_name, 'mongodb')\n     35: \n     36:         $service_name        = pick($service_name, 'mongod')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-vmdk.pp", "content": "set_key   => 'volume_backend_name',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-vmdk.pp\n\nhost_username => hiera('CONFIG_VCENTER_USER'),\nhost_password => hiera('CONFIG_VCENTER_PASSWORD'),\n}\n\ncinder::type { 'vmdk':\n10:       set_key   => 'volume_backend_name',\nset_value => 'vmdk',\nrequire   => Class['cinder::api'],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-vmdk.pp\n# Target line: 10\n\n      5:       host_username => hiera('CONFIG_VCENTER_USER'),\n      6:       host_password => hiera('CONFIG_VCENTER_PASSWORD'),\n      7:     }\n      8: \n      9:     cinder::type { 'vmdk':\n>>>  10:       set_key   => 'volume_backend_name',\n     11:       set_value => 'vmdk',\n     12:       require   => Class['cinder::api'],\n     13:     }\n     14: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp", "content": "$asset_manager_bearer_token = undef,", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n\n$oauth_id = '',\n$oauth_secret = '',\n$port = 3111,\n$secret_key_base = undef,\n$publishing_api_bearer_token = undef,\n71:   $asset_manager_bearer_token = undef,\n$http_username = undef,\n$http_password = undef,\n) {\n\ninclude govuk_postgresql::client #installs libpq-dev package needed for pg gem", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n# Target line: 71\n\n     66:   $oauth_id = '',\n     67:   $oauth_secret = '',\n     68:   $port = 3111,\n     69:   $secret_key_base = undef,\n     70:   $publishing_api_bearer_token = undef,\n>>>  71:   $asset_manager_bearer_token = undef,\n     72:   $http_username = undef,\n     73:   $http_password = undef,\n     74: ) {\n     75: \n     76:   include govuk_postgresql::client #installs libpq-dev package needed for pg gem\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-authenticating_proxy.pp", "content": "$jwt_auth_secret = undef,", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-authenticating_proxy.pp\n\n$sentry_dsn = undef,\n$govuk_upstream_uri = 'http://localhost:3054',\n$oauth_id = undef,\n$oauth_secret = undef,\n$secret_key_base = undef,\n54:   $jwt_auth_secret = undef,\n$signon_uri_scheme = 'https',\n) {\n$app_name = 'authenticating-proxy'\n\ngovuk::app::envvar::mongodb_uri { $app_name:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-authenticating_proxy.pp\n# Target line: 54\n\n     49:   $sentry_dsn = undef,\n     50:   $govuk_upstream_uri = 'http://localhost:3054',\n     51:   $oauth_id = undef,\n     52:   $oauth_secret = undef,\n     53:   $secret_key_base = undef,\n>>>  54:   $jwt_auth_secret = undef,\n     55:   $signon_uri_scheme = 'https',\n     56: ) {\n     57:   $app_name = 'authenticating-proxy'\n     58: \n     59:   govuk::app::envvar::mongodb_uri { $app_name:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-finder-show_removable_media_on_desktop.pp", "content": "key    => 'ShowRemovableMediaOnDesktop',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: boxen@puppet-osx-manifests-finder-show_removable_media_on_desktop.pp\n\ninclude osx::finder\n\nboxen::osx_defaults { 'Show mounted media on the desktop':\nuser   => $::boxen_user,\ndomain => 'com.apple.finder',\n8:     key    => 'ShowRemovableMediaOnDesktop',\nvalue  => true,\nnotify => Exec['killall Finder'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-finder-show_removable_media_on_desktop.pp\n# Target line: 8\n\n      3:   include osx::finder\n      4: \n      5:   boxen::osx_defaults { 'Show mounted media on the desktop':\n      6:     user   => $::boxen_user,\n      7:     domain => 'com.apple.finder',\n>>>   8:     key    => 'ShowRemovableMediaOnDesktop',\n      9:     value  => true,\n     10:     notify => Exec['killall Finder'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-gerrit-manifests-cron.pp", "content": "user   => 'gerrit',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-cron.pp\n\nuser   => 'gerrit',\n}\n\ncron { 'removedbdumps':\nensure => 'absent',\n23:     user   => 'gerrit',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-cron.pp\n# Target line: 23\n\n     18:     user   => 'gerrit',\n     19:   }\n     20: \n     21:   cron { 'removedbdumps':\n     22:     ensure => 'absent',\n>>>  23:     user   => 'gerrit',\n     24:   }\n     25: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-etherpad_lite-manifests-webapp.pp", "content": "$ssl_certificate          = '/etc/ssl/certs/etherpad.crt',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-etherpad_lite-manifests-webapp.pp\n\n$nginx_error_log          = '/var/log/nginx/error.log',\n$nginx_log_format         = undef,\n$nginx_proxy_pass         = 'http://127.0.0.1:9001',\n$nginx_server_name        = $::fqdn,\n$packages                 = ['etherpad-lite'],\n45:   $ssl_certificate          = '/etc/ssl/certs/etherpad.crt',\n$ssl_key                  = '/etc/ssl/private/etherpad.key',\n) {\n$config = hiera_hash('etherpad_lite::webapp::config', {})\n$files = hiera_hash('etherpad_lite::webapp::files', {})\nensure_packages($packages)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-etherpad_lite-manifests-webapp.pp\n# Target line: 45\n\n     40:   $nginx_error_log          = '/var/log/nginx/error.log',\n     41:   $nginx_log_format         = undef,\n     42:   $nginx_proxy_pass         = 'http://127.0.0.1:9001',\n     43:   $nginx_server_name        = $::fqdn,\n     44:   $packages                 = ['etherpad-lite'],\n>>>  45:   $ssl_certificate          = '/etc/ssl/certs/etherpad.crt',\n     46:   $ssl_key                  = '/etc/ssl/private/etherpad.key',\n     47: ) {\n     48:   $config = hiera_hash('etherpad_lite::webapp::config', {})\n     49:   $files = hiera_hash('etherpad_lite::webapp::files', {})\n     50:   ensure_packages($packages)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-nodejs-manifests-params.pp", "content": "$nodenv_root = '/usr/local/share/nodenv'", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: quintel@boxen-modules-nodejs-manifests-params.pp\n\n$nodenv_root = \"${boxen::config::home}/nodenv\"\n}\n\ndefault: {\n$nodenv_user = 'root'\n14:       $nodenv_root = '/usr/local/share/nodenv'\n}\n}\n\n$nodenv_version = 'v0.3.3'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-nodejs-manifests-params.pp\n# Target line: 14\n\n      9:       $nodenv_root = \"${boxen::config::home}/nodenv\"\n     10:     }\n     11: \n     12:     default: {\n     13:       $nodenv_user = 'root'\n>>>  14:       $nodenv_root = '/usr/local/share/nodenv'\n     15:     }\n     16:   }\n     17: \n     18:   $nodenv_version = 'v0.3.3'\n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_cinder-db.pp", "content": "$db_password = pick($cinder_hash['db_password'], $mysql_root_password)", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_cinder-db.pp\n\n$mysql_db_create     = pick($mysql_hash['db_create'], true)\n$mysql_root_password = $mysql_hash['root_password']\n\n$db_user     = pick($cinder_hash['db_user'], 'cinder')\n$db_name     = pick($cinder_hash['db_name'], 'cinder')\n16:   $db_password = pick($cinder_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($cinder_hash['db_host'], $database_vip)\n$db_create        = pick($cinder_hash['db_create'], $mysql_db_create)\n$db_root_user     = pick($cinder_hash['root_user'], $mysql_root_user)\n$db_root_password = pick($cinder_hash['root_password'], $mysql_root_password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_cinder-db.pp\n# Target line: 16\n\n     11:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     12:   $mysql_root_password = $mysql_hash['root_password']\n     13: \n     14:   $db_user     = pick($cinder_hash['db_user'], 'cinder')\n     15:   $db_name     = pick($cinder_hash['db_name'], 'cinder')\n>>>  16:   $db_password = pick($cinder_hash['db_password'], $mysql_root_password)\n     17: \n     18:   $db_host          = pick($cinder_hash['db_host'], $database_vip)\n     19:   $db_create        = pick($cinder_hash['db_create'], $mysql_db_create)\n     20:   $db_root_user     = pick($cinder_hash['root_user'], $mysql_root_user)\n     21:   $db_root_password = pick($cinder_hash['root_password'], $mysql_root_password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-openssl-manifests-certificate.pp", "content": "define openssl::certificate($user='root', $group='root'){", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-openssl-manifests-certificate.pp\n\n# Create a ssl certificate at the location specified by the name\n# (a '.crt' extension will be appended to the filename).\n3: define openssl::certificate($user='root', $group='root'){\nopenssl::key{$name:\nuser  => $user,\ngroup => $group\n}\nexec{\"create_${name}_certificate\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-openssl-manifests-certificate.pp\n# Target line: 3\n\n      1: # Create a ssl certificate at the location specified by the name\n      2: # (a '.crt' extension will be appended to the filename).\n>>>   3: define openssl::certificate($user='root', $group='root'){\n      4:   openssl::key{$name:\n      5:      user  => $user,\n      6:      group => $group \n      7:   }\n      8:   exec{\"create_${name}_certificate\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache_api_proxy.pp", "content": "docroot          => '/var/www/html',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache_api_proxy.pp\n\ninclude ::apache::mod::reqtimeout\n\n$apache_api_proxy_address = hiera('apache_api_proxy_address', '0.0.0.0')\n\napache::vhost { 'apache_api_proxy':\n40:     docroot          => '/var/www/html',\ncustom_fragment  => template('osnailyfacter/api_proxy.conf.erb'),\nport             => '8888',\nip               => $apache_api_proxy_address,\nadd_listen       => false,\nerror_log_syslog => 'syslog:local0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache_api_proxy.pp\n# Target line: 40\n\n     35:   include ::apache::mod::reqtimeout\n     36: \n     37:   $apache_api_proxy_address = hiera('apache_api_proxy_address', '0.0.0.0')\n     38: \n     39:   apache::vhost { 'apache_api_proxy':\n>>>  40:     docroot          => '/var/www/html',\n     41:     custom_fragment  => template('osnailyfacter/api_proxy.conf.erb'),\n     42:     port             => '8888',\n     43:     ip               => $apache_api_proxy_address,\n     44:     add_listen       => false,\n     45:     error_log_syslog => 'syslog:local0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-server_nova.pp", "content": "$admin_password            = dig44($neutron_config, ['keystone', 'admin_password'])", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-server_nova.pp\n\n\n$neutron_config            = hiera_hash('neutron_config')\n$management_vip            = hiera('management_vip')\n$service_endpoint          = hiera('service_endpoint', $management_vip)\n$neutron_endpoint          = hiera('neutron_endpoint', $management_vip)\n9:   $admin_password            = dig44($neutron_config, ['keystone', 'admin_password'])\n$admin_tenant_name         = dig44($neutron_config, ['keystone', 'admin_tenant'], 'services')\n$admin_username            = dig44($neutron_config, ['keystone', 'admin_user'], 'neutron')\n$region_name               = hiera('region', 'RegionOne')\n$auth_api_version          = 'v3'\n$ssl_hash                  = hiera_hash('use_ssl', {})", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-server_nova.pp\n# Target line: 9\n\n      4: \n      5:   $neutron_config            = hiera_hash('neutron_config')\n      6:   $management_vip            = hiera('management_vip')\n      7:   $service_endpoint          = hiera('service_endpoint', $management_vip)\n      8:   $neutron_endpoint          = hiera('neutron_endpoint', $management_vip)\n>>>   9:   $admin_password            = dig44($neutron_config, ['keystone', 'admin_password'])\n     10:   $admin_tenant_name         = dig44($neutron_config, ['keystone', 'admin_tenant'], 'services')\n     11:   $admin_username            = dig44($neutron_config, ['keystone', 'admin_user'], 'neutron')\n     12:   $region_name               = hiera('region', 'RegionOne')\n     13:   $auth_api_version          = 'v3'\n     14:   $ssl_hash                  = hiera_hash('use_ssl', {})\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "KrisBuytaert@puppet-graphite-manifests-params.pp", "content": "$carbon_ampq_user                          = 'guest',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n\n$aggregator_pickle_receiver_port           = '2014',\n$aggregator_replication_factor             = '1',\n$aggregator_use_flow_control               = 'True',\n$aggregator_use_whitelist                  = 'False',\n$aggregator_user                           = 'carbon',\n51:   $carbon_ampq_user                          = 'guest',\n$carbon_amqp_exchange                      = 'graphite',\n$carbon_amqp_host                          = 'localhost',\n$carbon_amqp_password                      = 'guest',\n$carbon_amqp_port                          = '5672',\n$carbon_amqp_verbose                       = 'False',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n# Target line: 51\n\n     46:   $aggregator_pickle_receiver_port           = '2014',\n     47:   $aggregator_replication_factor             = '1',\n     48:   $aggregator_use_flow_control               = 'True',\n     49:   $aggregator_use_whitelist                  = 'False',\n     50:   $aggregator_user                           = 'carbon',\n>>>  51:   $carbon_ampq_user                          = 'guest',\n     52:   $carbon_amqp_exchange                      = 'graphite',\n     53:   $carbon_amqp_host                          = 'localhost',\n     54:   $carbon_amqp_password                      = 'guest',\n     55:   $carbon_amqp_port                          = '5672',\n     56:   $carbon_amqp_verbose                       = 'False',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-thomasleese.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsFqOid5M3C4r4pqJOSF27LphXyGaVjRMVT6UWSi7VayzI6IaJRn4RsBq1A9fd/aXKySimAFGzEEx6sFBV/uU0b/jPDLZxk406wDjsAQc2nBhUR1eahsvkHCLJZzdcWEpqOgxQ+hzewRPLYBBmrd6PrzJOia3ieN/tkw8E1pAc9vmlQNavwx+1QPLHAY1DEtT6muTuOkfnfMJj6Z1o9y2/ZF/nSiu3g8gR1mgEK50xAhHlQ5lWc98GamZIQTRqd2fgbAN5d/bBH3f2m/UXCRL6S4ZLgpjsqzVO/84iG35iOXHI4hpL5w2Vr5ciaWGSDFDzMR8W/A/aNQLkyOWmltbvzo+3lmd+vwTbVAlIyHfMzxt9BYiCNMYxyk08J/3E+1W9+7RaniG103mup1UVllR0W32pZFYgvptwHIsVRPyS6kRbcyOKw4EXMY3RDV4cLXrA2WTKQaX1mr8iPDA3zYRiqs5Nc07yRPVWcFVZmS/IiMMf5uMUVsdA8PLxWpOM+P/quJkpJNHFsCwI4sG5xXlhne3gmr+HhbeYVf6jPcnRyqQ0/+SqoitafEP5ssEtRUZ0sKLIXO73HAzZrmxLZt2AhO1md1+RweNpbL6jt3aIaYaffV2hvpXo1Cd5V331Gx2yLODqRCceUjZP9Dg03zvIqewC0yD7u+/39qoPd6uNRw== thomas.leese@digital.cabinetoffice.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-thomasleese.pp\n\n# Creates the thomasleese user\nclass users::thomasleese {\ngovuk_user { 'thomasleese':\nfullname => 'Thomas Leese',\nemail    => 'thomas.leese@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsFqOid5M3C4r4pqJOSF27LphXyGaVjRMVT6UWSi7VayzI6IaJRn4RsBq1A9fd/aXKySimAFGzEEx6sFBV/uU0b/jPDLZxk406wDjsAQc2nBhUR1eahsvkHCLJZzdcWEpqOgxQ+hzewRPLYBBmrd6PrzJOia3ieN/tkw8E1pAc9vmlQNavwx+1QPLHAY1DEtT6muTuOkfnfMJj6Z1o9y2/ZF/nSiu3g8gR1mgEK50xAhHlQ5lWc98GamZIQTRqd2fgbAN5d/bBH3f2m/UXCRL6S4ZLgpjsqzVO/84iG35iOXHI4hpL5w2Vr5ciaWGSDFDzMR8W/A/aNQLkyOWmltbvzo+3lmd+vwTbVAlIyHfMzxt9BYiCNMYxyk08J/3E+1W9+7RaniG103mup1UVllR0W32pZFYgvptwHIsVRPyS6kRbcyOKw4EXMY3RDV4cLXrA2WTKQaX1mr8iPDA3zYRiqs5Nc07yRPVWcFVZmS/IiMMf5uMUVsdA8PLxWpOM+P/quJkpJNHFsCwI4sG5xXlhne3gmr+HhbeYVf6jPcnRyqQ0/+SqoitafEP5ssEtRUZ0sKLIXO73HAzZrmxLZt2AhO1md1+RweNpbL6jt3aIaYaffV2hvpXo1Cd5V331Gx2yLODqRCceUjZP9Dg03zvIqewC0yD7u+/39qoPd6uNRw== thomas.leese@digital.cabinetoffice.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-thomasleese.pp\n# Target line: 6\n\n      1: # Creates the thomasleese user\n      2: class users::thomasleese {\n      3:   govuk_user { 'thomasleese':\n      4:     fullname => 'Thomas Leese',\n      5:     email    => 'thomas.leese@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsFqOid5M3C4r4pqJOSF27LphXyGaVjRMVT6UWSi7VayzI6IaJRn4RsBq1A9fd/aXKySimAFGzEEx6sFBV/uU0b/jPDLZxk406wDjsAQc2nBhUR1eahsvkHCLJZzdcWEpqOgxQ+hzewRPLYBBmrd6PrzJOia3ieN/tkw8E1pAc9vmlQNavwx+1QPLHAY1DEtT6muTuOkfnfMJj6Z1o9y2/ZF/nSiu3g8gR1mgEK50xAhHlQ5lWc98GamZIQTRqd2fgbAN5d/bBH3f2m/UXCRL6S4ZLgpjsqzVO/84iG35iOXHI4hpL5w2Vr5ciaWGSDFDzMR8W/A/aNQLkyOWmltbvzo+3lmd+vwTbVAlIyHfMzxt9BYiCNMYxyk08J/3E+1W9+7RaniG103mup1UVllR0W32pZFYgvptwHIsVRPyS6kRbcyOKw4EXMY3RDV4cLXrA2WTKQaX1mr8iPDA3zYRiqs5Nc07yRPVWcFVZmS/IiMMf5uMUVsdA8PLxWpOM+P/quJkpJNHFsCwI4sG5xXlhne3gmr+HhbeYVf6jPcnRyqQ0/+SqoitafEP5ssEtRUZ0sKLIXO73HAzZrmxLZt2AhO1md1+RweNpbL6jt3aIaYaffV2hvpXo1Cd5V331Gx2yLODqRCceUjZP9Dg03zvIqewC0yD7u+/39qoPd6uNRw== thomas.leese@digital.cabinetoffice.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "$config_admin_user = false", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\n$tenant_id = \"/%(tenant_id)s\"\n}\n$endpoint_version = \"v2\"\n\nif ($keystone_version == \"v3\" ) {\n39:     $config_admin_user = false\n} else {\n$config_admin_user = true\n}\n\nclass { 'keystone::endpoint':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 39\n\n     34:     $tenant_id = \"/%(tenant_id)s\"\n     35:   }\n     36:   $endpoint_version = \"v2\"\n     37: \n     38:   if ($keystone_version == \"v3\" ) {\n>>>  39:     $config_admin_user = false\n     40:   } else {\n     41:     $config_admin_user = true\n     42:   }\n     43: \n     44:   class { 'keystone::endpoint':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$puppetdb_user     = 'puppetdb'", "line": 136, "detection_span": [131, 141], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n131:   $confdir = \"${etcdir}/conf.d\"\n132:   $ssl_dir = \"${etcdir}/ssl\"\n133:\n134:   case $::osfamily {\n'RedHat', 'Suse', 'Archlinux': {\n136:       $puppetdb_user     = 'puppetdb'\n$puppetdb_group    = 'puppetdb'\n$puppetdb_initconf = '/etc/sysconfig/puppetdb'\n}\n'Debian': {\n$puppetdb_user     = 'puppetdb'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 136\n\n    131:   $confdir = \"${etcdir}/conf.d\"\n    132:   $ssl_dir = \"${etcdir}/ssl\"\n    133: \n    134:   case $::osfamily {\n    135:     'RedHat', 'Suse', 'Archlinux': {\n>>> 136:       $puppetdb_user     = 'puppetdb'\n    137:       $puppetdb_group    = 'puppetdb'\n    138:       $puppetdb_initconf = '/etc/sysconfig/puppetdb'\n    139:     }\n    140:     'Debian': {\n    141:       $puppetdb_user     = 'puppetdb'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "key    => 'DateFormat',", "line": 79, "detection_span": [74, 84], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\n}\n\nboxen::osx_defaults { 'Set clock format':\nuser   => $::luser,\ndomain => 'com.apple.menuextra.clock',\n79:     key    => 'DateFormat',\ntype   => 'string',\nvalue  => 'EEE d h:mm:ss a',\n}\n\nboxen::osx_defaults { 'Enable Dashboard dev mode (allows keeping widgets on the desktop)':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 79\n\n     74:   }\n     75: \n     76:   boxen::osx_defaults { 'Set clock format':\n     77:     user   => $::luser,\n     78:     domain => 'com.apple.menuextra.clock',\n>>>  79:     key    => 'DateFormat',\n     80:     type   => 'string',\n     81:     value  => 'EEE d h:mm:ss a',\n     82:   }\n     83: \n     84:   boxen::osx_defaults { 'Enable Dashboard dev mode (allows keeping widgets on the desktop)':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-iterm2.pp", "content": "key    => 'OnlyWhenMoreTabs',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-iterm2.pp\n\n}\n\nboxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':\nuser   => $::luser,\ndomain => 'com.googlecode.iterm2',\n13:     key    => 'OnlyWhenMoreTabs',\ntype   => 'bool',\nvalue  => false,\n}\n\npeople::felho::plistbuddy { 'Left option key acts as Meta+Esc':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-iterm2.pp\n# Target line: 13\n\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':\n     11:     user   => $::luser,\n     12:     domain => 'com.googlecode.iterm2',\n>>>  13:     key    => 'OnlyWhenMoreTabs',\n     14:     type   => 'bool',\n     15:     value  => false,\n     16:   }\n     17: \n     18:   people::felho::plistbuddy { 'Left option key acts as Meta+Esc':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp", "content": "password => 'nailgun',", "line": 170, "detection_span": [165, 175], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n\n165:\n166:   $ostf_db = ['ostf']\n167:\n168:   postgresql::server::db { $nailgun_db :\nuser     => 'nailgun',\n170:     password => 'nailgun',\n171:   }\n172:\n173:   postgresql::server::db { $ostf_db :\nuser     => 'ostf',\npassword => 'ostf',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n# Target line: 170\n\n    165: \n    166:   $ostf_db = ['ostf']\n    167: \n    168:   postgresql::server::db { $nailgun_db :\n    169:     user     => 'nailgun',\n>>> 170:     password => 'nailgun',\n    171:   }\n    172: \n    173:   postgresql::server::db { $ostf_db :\n    174:     user     => 'ostf',\n    175:     password => 'ostf',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision.pp", "content": "$username             = 'demo'", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision.pp\n\n$provision_tempest         = str2bool(hiera('CONFIG_PROVISION_TEMPEST'))\n$provision_neutron         = str2bool(hiera('CONFIG_NEUTRON_INSTALL'))\n$heat_available            = str2bool(hiera('CONFIG_HEAT_INSTALL'))\n\nif $provision_demo {\n9:       $username             = 'demo'\n$password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n$tenant_name          = 'demo'\n$floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n$allocation_pools     = hiera(\n'CONFIG_PROVISION_DEMO_ALLOCATION_POOLS')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision.pp\n# Target line: 9\n\n      4:     $provision_tempest         = str2bool(hiera('CONFIG_PROVISION_TEMPEST'))\n      5:     $provision_neutron         = str2bool(hiera('CONFIG_NEUTRON_INSTALL'))\n      6:     $heat_available            = str2bool(hiera('CONFIG_HEAT_INSTALL'))\n      7: \n      8:     if $provision_demo {\n>>>   9:       $username             = 'demo'\n     10:       $password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n     11:       $tenant_name          = 'demo'\n     12:       $floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n     13:       $allocation_pools     = hiera(\n     14:                               'CONFIG_PROVISION_DEMO_ALLOCATION_POOLS')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-config.pp", "content": "$keystone_admin_token = undef,", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n\n$mysql_user_heat = undef,\n$mysql_pass_heat = undef,\n$rabbitmq_hosts = undef,\n$rabbitmq_user = undef,\n$rabbitmq_password = undef,\n40:   $keystone_admin_token = undef,\n$keystone_admin_email = undef,\n$keystone_admin_password = undef,\n$keystone_tenants = undef,\n$keystone_users = undef,\n$keystone_use_httpd = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n# Target line: 40\n\n     35:   $mysql_user_heat = undef,\n     36:   $mysql_pass_heat = undef,\n     37:   $rabbitmq_hosts = undef,\n     38:   $rabbitmq_user = undef,\n     39:   $rabbitmq_password = undef,\n>>>  40:   $keystone_admin_token = undef,\n     41:   $keystone_admin_email = undef,\n     42:   $keystone_admin_password = undef,\n     43:   $keystone_tenants = undef,\n     44:   $keystone_users = undef,\n     45:   $keystone_use_httpd = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-puppet-manifests-master.pp", "content": "ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',", "line": 114, "detection_span": [109, 119], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-master.pp\n\nserver_name            => [$::fqdn],\nssl                    => true,\nssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\nssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\nssl_crl                => '/var/lib/puppet/ssl/crl.pem',\n114:       ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\nssl_verify_client      => 'optional',\naccess_log             => $nginx_access_log,\nerror_log              => $nginx_error_log,\nformat_log             => $nginx_log_format,\nuwsgi                  => '127.0.0.1:8141',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-master.pp\n# Target line: 114\n\n    109:       server_name            => [$::fqdn],\n    110:       ssl                    => true,\n    111:       ssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\n    112:       ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\n    113:       ssl_crl                => '/var/lib/puppet/ssl/crl.pem',\n>>> 114:       ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\n    115:       ssl_verify_client      => 'optional',\n    116:       access_log             => $nginx_access_log,\n    117:       error_log              => $nginx_error_log,\n    118:       format_log             => $nginx_log_format,\n    119:       uwsgi                  => '127.0.0.1:8141',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp", "content": "key    => 'CheckQuit',", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n\n}\n\nboxen::osx_defaults { 'Turn off prompt for removal of active transfers':\nuser   => $::luser,\ndomain => 'org.m0k.transmission',\n28:     key    => 'CheckQuit',\ntype   => 'bool',\nvalue  => false,\n}\n\nboxen::osx_defaults { 'Turn off prompt for quiting with active transfers':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n# Target line: 28\n\n     23:   }\n     24: \n     25:   boxen::osx_defaults { 'Turn off prompt for removal of active transfers':\n     26:     user   => $::luser,\n     27:     domain => 'org.m0k.transmission',\n>>>  28:     key    => 'CheckQuit',\n     29:     type   => 'bool',\n     30:     value  => false,\n     31:   }\n     32: \n     33:   boxen::osx_defaults { 'Turn off prompt for quiting with active transfers':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp", "content": "key_server        => 'keys.gnupg.net',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n\nlocation          => 'http://repo.puphpet.com/dotdeb/',\nrelease           => 'squeeze-php54',\nrepos             => 'all',\nrequired_packages => 'debian-keyring debian-archive-keyring',\nkey               => '89DF5277',\n19:           key_server        => 'keys.gnupg.net',\ninclude_src       => true\n}\n}\n# Wheezy : 5.4 (default) && 5.5 && 5.6\nelsif $::lsbdistcodename == 'wheezy' and $php_version == '55' {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n# Target line: 19\n\n     14:           location          => 'http://repo.puphpet.com/dotdeb/',\n     15:           release           => 'squeeze-php54',\n     16:           repos             => 'all',\n     17:           required_packages => 'debian-keyring debian-archive-keyring',\n     18:           key               => '89DF5277',\n>>>  19:           key_server        => 'keys.gnupg.net',\n     20:           include_src       => true\n     21:         }\n     22:       }\n     23:       # Wheezy : 5.4 (default) && 5.5 && 5.6\n     24:       elsif $::lsbdistcodename == 'wheezy' and $php_version == '55' {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-params.pp", "content": "$user_name          = 'monasca-user',", "line": 76, "detection_span": [71, 81], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-params.pp\n\n$port               = '8070',\n$api_version        = 'v2.0',\n$region             = 'RegionOne',\n$admin_name         = 'monasca-admin',\n$agent_name         = 'monasca-agent',\n76:     $user_name          = 'monasca-user',\n$auth_method        = 'token',\n$admin_password     = undef,\n$admin_project_name = undef,\n$agent_password     = undef,\n$user_password      = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-params.pp\n# Target line: 76\n\n     71:     $port               = '8070',\n     72:     $api_version        = 'v2.0',\n     73:     $region             = 'RegionOne',\n     74:     $admin_name         = 'monasca-admin',\n     75:     $agent_name         = 'monasca-agent',\n>>>  76:     $user_name          = 'monasca-user',\n     77:     $auth_method        = 'token',\n     78:     $admin_password     = undef,\n     79:     $admin_project_name = undef,\n     80:     $agent_password     = undef,\n     81:     $user_password      = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp", "content": "proxy_pass => [", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n\n\n# vhost with proxy_pass and keywords\napache::vhost { 'third.example.com':\nport       => 80,\ndocroot    => '/var/www/third',\n42:   proxy_pass => [\n{\n'path'     => '/third',\n'url'      => 'http://localhost:8080/third',\n'keywords' => ['noquery', 'interpolate']\n},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n# Target line: 42\n\n     37: \n     38: # vhost with proxy_pass and keywords\n     39: apache::vhost { 'third.example.com':\n     40:   port       => 80,\n     41:   docroot    => '/var/www/third',\n>>>  42:   proxy_pass => [\n     43:     {\n     44:       'path'     => '/third',\n     45:       'url'      => 'http://localhost:8080/third',\n     46:       'keywords' => ['noquery', 'interpolate']\n     47:     },\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-heat.pp", "content": "domain_password => 'oh_my_no_secret',", "line": 75, "detection_span": [70, 80], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-heat.pp\n\npublic_url                => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\ninternal_url              => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\nadmin_url                 => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n}\nclass { '::heat::keystone::domain':\n75:     domain_password => 'oh_my_no_secret',\n}\nclass { '::heat::client': }\nclass { '::heat::api':\nservice_name => 'httpd',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-heat.pp\n# Target line: 75\n\n     70:     public_url                => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n     71:     internal_url              => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n     72:     admin_url                 => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n     73:   }\n     74:   class { '::heat::keystone::domain':\n>>>  75:     domain_password => 'oh_my_no_secret',\n     76:   }\n     77:   class { '::heat::client': }\n     78:   class { '::heat::api':\n     79:     service_name => 'httpd',\n     80:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp", "content": "password => 'ostf',", "line": 175, "detection_span": [170, 180], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n\npassword => 'nailgun',\n171:   }\n172:\n173:   postgresql::server::db { $ostf_db :\nuser     => 'ostf',\n175:     password => 'ostf',\n176:   }\n177:\n178:   postgresql::server::pg_hba_rule { 'Allow local TCP connections with authentication under postgres user' :\ndescription => 'Allow local TCP connections with authentication under postgres user',\ntype        => 'host',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n# Target line: 175\n\n    170:     password => 'nailgun',\n    171:   }\n    172: \n    173:   postgresql::server::db { $ostf_db :\n    174:     user     => 'ostf',\n>>> 175:     password => 'ostf',\n    176:   }\n    177: \n    178:   postgresql::server::pg_hba_rule { 'Allow local TCP connections with authentication under postgres user' :\n    179:     description => 'Allow local TCP connections with authentication under postgres user',\n    180:     type        => 'host',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp", "content": "$cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n\nclass { '::cinder::volume': }\n\nclass { '::cinder::client': }\n\n$cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n47:     $cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n$cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n\n# Cinder::Type requires keystone credentials\nCinder::Type {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n# Target line: 47\n\n     42:     class { '::cinder::volume': }\n     43: \n     44:     class { '::cinder::client': }\n     45: \n     46:     $cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n>>>  47:     $cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     48:     $cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n     49:     $cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n     50: \n     51:     # Cinder::Type requires keystone credentials\n     52:     Cinder::Type {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_crawler-manifests-config.pp", "content": "$crawler_user   = 'govuk-crawler',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_crawler-manifests-config.pp\n\n#   Default: 'govuk-crawler'\n#\nclass govuk_crawler::config (\n$aws_access_key = undef,\n$aws_secret_key = undef,\n21:   $crawler_user   = 'govuk-crawler',\n) {\n$env_name = 's3_sync_mirror'\n\nfile { [\"/etc/govuk/${env_name}\", \"/etc/govuk/${env_name}/env.d\"]:\nensure  => 'directory',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_crawler-manifests-config.pp\n# Target line: 21\n\n     16: #   Default: 'govuk-crawler'\n     17: #\n     18: class govuk_crawler::config (\n     19:   $aws_access_key = undef,\n     20:   $aws_secret_key = undef,\n>>>  21:   $crawler_user   = 'govuk-crawler',\n     22: ) {\n     23:   $env_name = 's3_sync_mirror'\n     24: \n     25:   file { [\"/etc/govuk/${env_name}\", \"/etc/govuk/${env_name}/env.d\"]:\n     26:     ensure  => 'directory',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-panko.pp", "content": "password => 'panko',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-panko.pp\n\nclass { '::panko::db':\ndatabase_connection => 'mysql+pymysql://panko:panko@127.0.0.1/panko?charset=utf8',\n}\n\nclass { '::panko::db::mysql':\n25:     password => 'panko',\n}\nclass { '::panko::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:8977\",\ninternal_url => \"${::openstack_integration::config::base_url}:8977\",\nadmin_url    => \"${::openstack_integration::config::base_url}:8977\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-panko.pp\n# Target line: 25\n\n     20:   class { '::panko::db':\n     21:     database_connection => 'mysql+pymysql://panko:panko@127.0.0.1/panko?charset=utf8',\n     22:   }\n     23: \n     24:   class { '::panko::db::mysql':\n>>>  25:     password => 'panko',\n     26:   }\n     27:   class { '::panko::keystone::auth':\n     28:     public_url   => \"${::openstack_integration::config::base_url}:8977\",\n     29:     internal_url => \"${::openstack_integration::config::base_url}:8977\",\n     30:     admin_url    => \"${::openstack_integration::config::base_url}:8977\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp", "content": "key     => 'haproxy.be[*]',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n\nplugin_zabbix::agent::userparameter {\n'haproxy.be.discovery':\nkey     => 'haproxy.be.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -b';\n'haproxy.be':\n31:         key     => 'haproxy.be[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.fe.discovery':\nkey     => 'haproxy.fe.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -f';\n'haproxy.fe':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n# Target line: 31\n\n     26:     plugin_zabbix::agent::userparameter {\n     27:       'haproxy.be.discovery':\n     28:         key     => 'haproxy.be.discovery',\n     29:         command => '/etc/zabbix/scripts/haproxy.sh -b';\n     30:       'haproxy.be':\n>>>  31:         key     => 'haproxy.be[*]',\n     32:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     33:       'haproxy.fe.discovery':\n     34:         key     => 'haproxy.fe.discovery',\n     35:         command => '/etc/zabbix/scripts/haproxy.sh -f';\n     36:       'haproxy.fe':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "zend-patterns@ZendServerPuppet-manifests-repo-debian.pp", "content": "key_source => 'http://repos.zend.com/zend.key',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n\nwarning(\"${name} should not be directly included in the manifest.\")\n}\n\napt::key { 'zend':\nkey        => 'F7D2C623',\n11:     key_source => 'http://repos.zend.com/zend.key',\n}\n\n# TODO: maybe move $zend_repository setting to params.pp\n#\n#  For Ubuntu 12.04 or Debian 7 and above, use:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n# Target line: 11\n\n      6:     warning(\"${name} should not be directly included in the manifest.\")\n      7:   }\n      8: \n      9:   apt::key { 'zend':\n     10:     key        => 'F7D2C623',\n>>>  11:     key_source => 'http://repos.zend.com/zend.key',\n     12:   }\n     13: \n     14:   # TODO: maybe move $zend_repository setting to params.pp\n     15:   #\n     16:   #  For Ubuntu 12.04 or Debian 7 and above, use:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_package_idopgsql.pp", "content": "user => \"icinga2\",", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_package_idopgsql.pp\n\nmanage_package => false,\n}\n\nclass{ 'icinga2::feature::idopgsql':\nhost => \"127.0.0.1\",\n11:   user => \"icinga2\",\npassword => \"icinga2\",\ndatabase => \"icinga2\",\nimport_schema => true\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_package_idopgsql.pp\n# Target line: 11\n\n      6:   manage_package => false,\n      7: }\n      8: \n      9: class{ 'icinga2::feature::idopgsql':\n     10:   host => \"127.0.0.1\",\n>>>  11:   user => \"icinga2\",\n     12:   password => \"icinga2\",\n     13:   database => \"icinga2\",\n     14:   import_schema => true\n     15: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-build-unix-cleanup-manifests-init.pp", "content": "password   => pw_hash($root_password, 'SHA-512', 'mysalt'),", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: SecGen@SecGen-modules-build-unix-cleanup-manifests-init.pp\n\nExec { path => ['/bin','/sbin','/usr/bin', '/usr/sbin'] }\n\n# Set root password\n::accounts::user { 'root':\nshell      => '/bin/bash',\n13:     password   => pw_hash($root_password, 'SHA-512', 'mysalt'),\nmanagehome => true,\n}\n\n# Disable ssh\nif $disable_ssh {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-build-unix-cleanup-manifests-init.pp\n# Target line: 13\n\n      8:   Exec { path => ['/bin','/sbin','/usr/bin', '/usr/sbin'] }\n      9: \n     10:   # Set root password\n     11:   ::accounts::user { 'root':\n     12:     shell      => '/bin/bash',\n>>>  13:     password   => pw_hash($root_password, 'SHA-512', 'mysalt'),\n     14:     managehome => true,\n     15:   }\n     16: \n     17:   # Disable ssh\n     18:   if $disable_ssh {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-global_controller-keystone-auth.pp", "content": "$configure_user      = false,", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-global_controller-keystone-auth.pp\n\n$cgc_ip = $::contrail::params::ext_global_controller_ip,\n$cgc_port = $::contrail::params::ext_global_controller_port,\n$email               = 'gcg@localhost',\n$tenant              = 'services',\n$configure_endpoint  = true,\n18:   $configure_user      = false,\n$configure_user_role = false,\n) {\n\n$api_public_url = \"http://${api_server_ip}:${api_server_port}\"\n$api_internal_url = $api_public_url", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-global_controller-keystone-auth.pp\n# Target line: 18\n\n     13:   $cgc_ip = $::contrail::params::ext_global_controller_ip,\n     14:   $cgc_port = $::contrail::params::ext_global_controller_port,\n     15:   $email               = 'gcg@localhost',\n     16:   $tenant              = 'services',\n     17:   $configure_endpoint  = true,\n>>>  18:   $configure_user      = false,\n     19:   $configure_user_role = false,\n     20: ) {\n     21: \n     22:   $api_public_url = \"http://${api_server_ip}:${api_server_port}\"\n     23:   $api_internal_url = $api_public_url\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tsuru@puppet-tsuru-gandalf-manifests-init.pp", "content": "$tsuru_api_token        = undef", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: tsuru@puppet-tsuru-gandalf-manifests-init.pp\n\n$gandalf_group          = 'git',\n$gandalf_user_home      = '/var/lib/gandalf',\n$gandalf_authorized_keys_path = '/var/lib/gandalf/.ssh/authorized_keys',\n$gandalf_version        = 'latest',\n$tsuru_api_host         = 'localhost:8081',\n39:   $tsuru_api_token        = undef\n) {\n\ninclude base\n\npackage { 'gandalf-server':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: tsuru@puppet-tsuru-gandalf-manifests-init.pp\n# Target line: 39\n\n     34:   $gandalf_group          = 'git',\n     35:   $gandalf_user_home      = '/var/lib/gandalf',\n     36:   $gandalf_authorized_keys_path = '/var/lib/gandalf/.ssh/authorized_keys',\n     37:   $gandalf_version        = 'latest',\n     38:   $tsuru_api_host         = 'localhost:8081',\n>>>  39:   $tsuru_api_token        = undef\n     40: ) {\n     41: \n     42:   include base\n     43: \n     44:   package { 'gandalf-server':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-keystone.pp", "content": "ssl_key         => \"/etc/keystone/ssl/private/${::fqdn}.pem\",", "line": 101, "detection_span": [96, 106], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-keystone.pp\n\ninclude ::apache\nclass { '::keystone::wsgi::apache':\nbind_host       => $::openstack_integration::config::ip_for_url,\nadmin_bind_host => $::openstack_integration::config::ip_for_url,\nssl             => $::openstack_integration::config::ssl,\n101:     ssl_key         => \"/etc/keystone/ssl/private/${::fqdn}.pem\",\nssl_cert        => $::openstack_integration::params::cert_path,\nworkers         => 2,\n104:   }\n105:   # Workaround to empty Keystone vhost that is provided & activated by default with running\n106:   # Canonical packaging (called 'keystone'). This will make sure upgrading the package is", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-keystone.pp\n# Target line: 101\n\n     96:   include ::apache\n     97:   class { '::keystone::wsgi::apache':\n     98:     bind_host       => $::openstack_integration::config::ip_for_url,\n     99:     admin_bind_host => $::openstack_integration::config::ip_for_url,\n    100:     ssl             => $::openstack_integration::config::ssl,\n>>> 101:     ssl_key         => \"/etc/keystone/ssl/private/${::fqdn}.pem\",\n    102:     ssl_cert        => $::openstack_integration::params::cert_path,\n    103:     workers         => 2,\n    104:   }\n    105:   # Workaround to empty Keystone vhost that is provided & activated by default with running\n    106:   # Canonical packaging (called 'keystone'). This will make sure upgrading the package is\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@puppet-cdh-manifests-hadoop-users.pp", "content": "user         => 'hdfs',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-users.pp\n\n}\n\ncdh::exec { 'create_hdfs_user_directories':\ncommand      => \"/usr/local/bin/create_hdfs_user_directories.sh --verbose ${groups}\",\nunless       => \"/usr/local/bin/create_hdfs_user_directories.sh --check-for-changes ${groups}\",\n34:         user         => 'hdfs',\nlogoutput    => true,\ntimeout      => 120,\nuse_kerberos => $use_kerberos,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-users.pp\n# Target line: 34\n\n     29:     }\n     30: \n     31:     cdh::exec { 'create_hdfs_user_directories':\n     32:         command      => \"/usr/local/bin/create_hdfs_user_directories.sh --verbose ${groups}\",\n     33:         unless       => \"/usr/local/bin/create_hdfs_user_directories.sh --check-for-changes ${groups}\",\n>>>  34:         user         => 'hdfs',\n     35:         logoutput    => true,\n     36:         timeout      => 120,\n     37:         use_kerberos => $use_kerberos,\n     38:     }\n     39: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-nodepool.pp", "content": "$image_log_document_root = '/var/log/nodepool/image',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool.pp\n\n$environment = {},\n$nodepool_ssh_private_key = '',\n$nodepool_ssh_public_key = '',\n$vhost_name = $::fqdn,\n$statsd_host = '',\n29:   $image_log_document_root = '/var/log/nodepool/image',\n$image_log_periodic_cleanup = true,\n$enable_image_log_via_http = true,\n$upload_log_document_root = '/var/log/nodepool/upload',\n$upload_log_periodic_cleanup = true,\n$enable_upload_log_via_http = false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool.pp\n# Target line: 29\n\n     24:   $environment = {},\n     25:   $nodepool_ssh_private_key = '',\n     26:   $nodepool_ssh_public_key = '',\n     27:   $vhost_name = $::fqdn,\n     28:   $statsd_host = '',\n>>>  29:   $image_log_document_root = '/var/log/nodepool/image',\n     30:   $image_log_periodic_cleanup = true,\n     31:   $enable_image_log_via_http = true,\n     32:   $upload_log_document_root = '/var/log/nodepool/upload',\n     33:   $upload_log_periodic_cleanup = true,\n     34:   $enable_upload_log_via_http = false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-signon.pp", "content": "$db_username = undef,", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-signon.pp\n\n#\nclass govuk::apps::signon(\n$db_hostname = undef,\n$db_name = undef,\n$db_password = undef,\n68:   $db_username = undef,\n$devise_pepper = undef,\n$devise_secret_key = undef,\n$enable_procfile_worker = true,\n$sentry_dsn = undef,\n$instance_name = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-signon.pp\n# Target line: 68\n\n     63: #\n     64: class govuk::apps::signon(\n     65:   $db_hostname = undef,\n     66:   $db_name = undef,\n     67:   $db_password = undef,\n>>>  68:   $db_username = undef,\n     69:   $devise_pepper = undef,\n     70:   $devise_secret_key = undef,\n     71:   $enable_procfile_worker = true,\n     72:   $sentry_dsn = undef,\n     73:   $instance_name = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp", "content": "$rabbit_user                = 'nova',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n\n$verbose                    = true,\n# Rabbit details necessary for cinder\n$rabbit_nodes               = false,\n$rabbit_password            = 'rabbit_pw',\n$rabbit_host                = false,\n45:   $rabbit_user                = 'nova',\n$rabbit_ha_virtual_ip       = false,\n$queue_provider             = 'rabbitmq',\n$qpid_password              = 'qpid_pw',\n$qpid_user                  = 'nova',\n$qpid_nodes                 = ['127.0.0.1'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n# Target line: 45\n\n     40:   $verbose                    = true,\n     41:   # Rabbit details necessary for cinder\n     42:   $rabbit_nodes               = false,\n     43:   $rabbit_password            = 'rabbit_pw',\n     44:   $rabbit_host                = false,\n>>>  45:   $rabbit_user                = 'nova',\n     46:   $rabbit_ha_virtual_ip       = false,\n     47:   $queue_provider             = 'rabbitmq',\n     48:   $qpid_password              = 'qpid_pw',\n     49:   $qpid_user                  = 'nova',\n     50:   $qpid_nodes                 = ['127.0.0.1'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "key    => 'ScheduleFrequency',", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\n}\n\nboxen::osx_defaults { 'Check for software updates daily, not just once per week':\nuser   => $::luser,\ndomain => 'com.apple.SoftwareUpdate',\n71:     key    => 'ScheduleFrequency',\ntype   => 'int',\nvalue  => 1,\n}\n\nboxen::osx_defaults { 'Set clock format':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 71\n\n     66:   }\n     67: \n     68:   boxen::osx_defaults { 'Check for software updates daily, not just once per week':\n     69:     user   => $::luser,\n     70:     domain => 'com.apple.SoftwareUpdate',\n>>>  71:     key    => 'ScheduleFrequency',\n     72:     type   => 'int',\n     73:     value  => 1,\n     74:   }\n     75: \n     76:   boxen::osx_defaults { 'Set clock format':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-finder-show_warning_before_emptying_trash.pp", "content": "key    => 'WarnOnEmptyTrash',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: boxen@puppet-osx-manifests-finder-show_warning_before_emptying_trash.pp\n\nclass osx::finder::show_warning_before_emptying_trash {\ninclude osx::finder\n\nboxen::osx_defaults { 'Show warning before emptying the trash':\nuser   => $::boxen_user,\n7:     key    => 'WarnOnEmptyTrash',\ndomain => 'com.apple.finder',\nvalue  => true,\nnotify => Exec['killall Finder'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-finder-show_warning_before_emptying_trash.pp\n# Target line: 7\n\n      2: class osx::finder::show_warning_before_emptying_trash {\n      3:   include osx::finder\n      4: \n      5:   boxen::osx_defaults { 'Show warning before emptying the trash':\n      6:     user   => $::boxen_user,\n>>>   7:     key    => 'WarnOnEmptyTrash',\n      8:     domain => 'com.apple.finder',\n      9:     value  => true,\n     10:     notify => Exec['killall Finder'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-postgresql-manifests-server-config_entry.pp", "content": "$requires_restart_until = {", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-config_entry.pp\n\n# Those are the variables that are marked as \"(change requires restart)\"\n# on postgresql.conf.  Items are ordered as on postgresql.conf.\n#\n# XXX: This resource supports setting other variables without knowing\n# their names.  Do not add them here.\n19:   $requires_restart_until = {\n'data_directory'                      => undef,\n'hba_file'                            => undef,\n'ident_file'                          => undef,\n'external_pid_file'                   => undef,\n'listen_addresses'                    => undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-config_entry.pp\n# Target line: 19\n\n     14:   # Those are the variables that are marked as \"(change requires restart)\"\n     15:   # on postgresql.conf.  Items are ordered as on postgresql.conf.\n     16:   #\n     17:   # XXX: This resource supports setting other variables without knowing\n     18:   # their names.  Do not add them here.\n>>>  19:   $requires_restart_until = {\n     20:     'data_directory'                      => undef,\n     21:     'hba_file'                            => undef,\n     22:     'ident_file'                          => undef,\n     23:     'external_pid_file'                   => undef,\n     24:     'listen_addresses'                    => undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-cinder.pp", "content": "rbd_secret_uuid    => '7200aea0-2ddd-4a32-aa2a-d49f66ab554c',", "line": 145, "detection_span": [140, 150], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-cinder.pp\n\n}\n'rbd': {\ncinder::backend::rbd { 'BACKEND_1':\nrbd_user           => 'openstack',\nrbd_pool           => 'cinder',\n145:         rbd_secret_uuid    => '7200aea0-2ddd-4a32-aa2a-d49f66ab554c',\nmanage_volume_type => true,\n}\n# make sure ceph pool exists before running Cinder API & Volume\nExec['create-cinder'] -> Service['httpd']\nExec['create-cinder'] -> Service['cinder-volume']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-cinder.pp\n# Target line: 145\n\n    140:     }\n    141:     'rbd': {\n    142:       cinder::backend::rbd { 'BACKEND_1':\n    143:         rbd_user           => 'openstack',\n    144:         rbd_pool           => 'cinder',\n>>> 145:         rbd_secret_uuid    => '7200aea0-2ddd-4a32-aa2a-d49f66ab554c',\n    146:         manage_volume_type => true,\n    147:       }\n    148:       # make sure ceph pool exists before running Cinder API & Volume\n    149:       Exec['create-cinder'] -> Service['httpd']\n    150:       Exec['create-cinder'] -> Service['cinder-volume']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-db-mysql.pp", "content": "$user          = 'ironic',", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-db-mysql.pp\n\n#   Defaults to undef\n#\nclass ironic::db::mysql (\n$password,\n$dbname        = 'ironic',\n50:   $user          = 'ironic',\n$host          = '127.0.0.1',\n$allowed_hosts = undef,\n$charset       = 'utf8',\n$collate       = 'utf8_general_ci',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-db-mysql.pp\n# Target line: 50\n\n     45: #   Defaults to undef\n     46: #\n     47: class ironic::db::mysql (\n     48:   $password,\n     49:   $dbname        = 'ironic',\n>>>  50:   $user          = 'ironic',\n     51:   $host          = '127.0.0.1',\n     52:   $allowed_hosts = undef,\n     53:   $charset       = 'utf8',\n     54:   $collate       = 'utf8_general_ci',\n     55: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_idomysql_ssl.pp", "content": "ssl_cert_path   => '/etc/mysql/server-cert.pem',", "line": 110, "detection_span": [105, 115], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql_ssl.pp\n\npassword        => 'supersecret',\ndatabase        => 'icinga',\n107:   import_schema   => true,\nenable_ssl      => true,\n109:   ssl_key_path    => '/etc/mysql/server-key.pem',\n110:   ssl_cert_path   => '/etc/mysql/server-cert.pem',\n111:   ssl_cacert_path => '/etc/mysql/cacert.pem',\nrequire         => Mysql::Db['icinga'],\n113: }\n114:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql_ssl.pp\n# Target line: 110\n\n    105:   password        => 'supersecret',\n    106:   database        => 'icinga',\n    107:   import_schema   => true,\n    108:   enable_ssl      => true,\n    109:   ssl_key_path    => '/etc/mysql/server-key.pem',\n>>> 110:   ssl_cert_path   => '/etc/mysql/server-cert.pem',\n    111:   ssl_cacert_path => '/etc/mysql/cacert.pem',\n    112:   require         => Mysql::Db['icinga'],\n    113: }\n    114: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-set.pp", "content": "$hosts_admin = \"\",", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-set.pp\n\n$help_channel = \"#help\",\n$hiddenhost_prefix = \"+x\",\n$hosts_local = undef,\n$hosts_global = \"\",\n$hosts_coadmin = \"\",\n64:   $hosts_admin = \"\",\n$hosts_servicesadmin = \"\",\n$hosts_netadmin = \"\",\n$hosts_host_on_oper_up = undef,\n$ssl_egd = undef,\n$ssl_certificate = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-set.pp\n# Target line: 64\n\n     59:   $help_channel = \"#help\",\n     60:   $hiddenhost_prefix = \"+x\",\n     61:   $hosts_local = undef,\n     62:   $hosts_global = \"\",\n     63:   $hosts_coadmin = \"\",\n>>>  64:   $hosts_admin = \"\",\n     65:   $hosts_servicesadmin = \"\",\n     66:   $hosts_netadmin = \"\",\n     67:   $hosts_host_on_oper_up = undef,\n     68:   $ssl_egd = undef,\n     69:   $ssl_certificate = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-feedback.pp", "content": "$support_bearer_token = undef,", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-feedback.pp\n\n#\nclass govuk::apps::feedback(\n$port = '3028',\n$sentry_dsn = undef,\n$secret_key_base = undef,\n31:   $support_bearer_token = undef,\n$support_api_bearer_token = undef,\n$publishing_api_bearer_token = undef,\n$assisted_digital_google_spreadsheet_key = undef,\n$google_client_email = undef,\n$google_private_key = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-feedback.pp\n# Target line: 31\n\n     26: #\n     27: class govuk::apps::feedback(\n     28:   $port = '3028',\n     29:   $sentry_dsn = undef,\n     30:   $secret_key_base = undef,\n>>>  31:   $support_bearer_token = undef,\n     32:   $support_api_bearer_token = undef,\n     33:   $publishing_api_bearer_token = undef,\n     34:   $assisted_digital_google_spreadsheet_key = undef,\n     35:   $google_client_email = undef,\n     36:   $google_private_key = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp", "content": "$ssl_cert_file = '/etc/ssl/jenkins.crt'", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n\n$swarm_user = ''\n$swarm_password = ''\n$swarm_package = 'jenkins-swarm-slave'\n$swarm_service = 'jenkins-swarm-slave'\n\n31:   $ssl_cert_file = '/etc/ssl/jenkins.crt'\n$ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\nMIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\nVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\ncyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\nMDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n# Target line: 31\n\n     26:   $swarm_user = ''\n     27:   $swarm_password = ''\n     28:   $swarm_package = 'jenkins-swarm-slave'\n     29:   $swarm_service = 'jenkins-swarm-slave'\n     30: \n>>>  31:   $ssl_cert_file = '/etc/ssl/jenkins.crt'\n     32:   $ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\n     33: MIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\n     34: VTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\n     35: cyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\n     36: MDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-storage-ceph_extraconf.pp", "content": "$config_key            = 'default',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: norcams@himlar-profile-manifests-storage-ceph_extraconf.pp\n\n#\n# Create extra configuration for ceph\n#\ndefine profile::storage::ceph_extraconf (\n$manage                = true,\n6:   $config_key            = 'default',\n$config_value          = 'default',\n) {\n\nif $manage {\nceph_config {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-storage-ceph_extraconf.pp\n# Target line: 6\n\n      1: #\n      2: # Create extra configuration for ceph\n      3: #\n      4: define profile::storage::ceph_extraconf (\n      5:   $manage                = true,\n>>>   6:   $config_key            = 'default',\n      7:   $config_value          = 'default',\n      8: ) {\n      9: \n     10:   if $manage {\n     11:     ceph_config {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-config-beforeservice.pp", "content": "user => 'all',", "line": 63, "detection_span": [58, 68], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-config-beforeservice.pp\n\nnotify => Exec['reload_postgresql'],\n}\n\nPostgresql::Pg_hba_rule {\ndatabase => 'all',\n63:       user => 'all',\n}\n\n# Lets setup the base rules\npostgresql::pg_hba_rule { 'local access as postgres user':\ntype        => 'local',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-config-beforeservice.pp\n# Target line: 63\n\n     58:       notify => Exec['reload_postgresql'],\n     59:     }\n     60: \n     61:     Postgresql::Pg_hba_rule {\n     62:       database => 'all',\n>>>  63:       user => 'all',\n     64:     }\n     65: \n     66:     # Lets setup the base rules\n     67:     postgresql::pg_hba_rule { 'local access as postgres user':\n     68:       type        => 'local',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp", "content": "routing_key   => '*.bulk.reindex',", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_bulk_reindex':\nensure        => $toggled_bulk_ensure,\namqp_exchange => $amqp_exchange,\namqp_queue    => 'rummager_bulk_reindex',\n69:     routing_key   => '*.bulk.reindex',\ndurable       => true,\n}\n\n# match everything on queue 2 while we test\ngovuk_rabbitmq::consumer { 'rummager-v2':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n# Target line: 69\n\n     64: \n     65:   govuk_rabbitmq::queue_with_binding { 'rummager_bulk_reindex':\n     66:     ensure        => $toggled_bulk_ensure,\n     67:     amqp_exchange => $amqp_exchange,\n     68:     amqp_queue    => 'rummager_bulk_reindex',\n>>>  69:     routing_key   => '*.bulk.reindex',\n     70:     durable       => true,\n     71:   }\n     72: \n     73:   # match everything on queue 2 while we test\n     74:   govuk_rabbitmq::consumer { 'rummager-v2':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-dock-magnification.pp", "content": "key    => 'largesize',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: boxen@puppet-osx-manifests-dock-magnification.pp\n\nnotify => Exec['killall Dock'];\n}\n\nboxen::osx_defaults { 'magnification_size':\ndomain => 'com.apple.dock',\n31:     key    => 'largesize',\ntype   => int,\nvalue  => $magnification_size,\nuser   => $::boxen_user,\nnotify => Exec['killall Dock'];\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-dock-magnification.pp\n# Target line: 31\n\n     26:     notify => Exec['killall Dock'];\n     27:   }\n     28: \n     29:   boxen::osx_defaults { 'magnification_size':\n     30:     domain => 'com.apple.dock',\n>>>  31:     key    => 'largesize',\n     32:     type   => int,\n     33:     value  => $magnification_size,\n     34:     user   => $::boxen_user,\n     35:     notify => Exec['killall Dock'];\n     36:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp", "content": "neutron_metadata_proxy_shared_secret => hiera('CONFIG_NEUTRON_METADATA_PW_UNQUOTED', undef),", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n\n\nclass { '::nova::api':\napi_bind_address                     => $bind_host,\nmetadata_listen                      => $bind_host,\nenabled                              => true,\n30:       neutron_metadata_proxy_shared_secret => hiera('CONFIG_NEUTRON_METADATA_PW_UNQUOTED', undef),\nsync_db                              => false,\nsync_db_api                          => false,\nosapi_compute_workers                => hiera('CONFIG_SERVICE_WORKERS'),\nmetadata_workers                     => hiera('CONFIG_SERVICE_WORKERS'),\nallow_resize_to_same_host            => hiera('CONFIG_NOVA_ALLOW_RESIZE_TO_SAME'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n# Target line: 30\n\n     25: \n     26:     class { '::nova::api':\n     27:       api_bind_address                     => $bind_host,\n     28:       metadata_listen                      => $bind_host,\n     29:       enabled                              => true,\n>>>  30:       neutron_metadata_proxy_shared_secret => hiera('CONFIG_NEUTRON_METADATA_PW_UNQUOTED', undef),\n     31:       sync_db                              => false,\n     32:       sync_db_api                          => false,\n     33:       osapi_compute_workers                => hiera('CONFIG_SERVICE_WORKERS'),\n     34:       metadata_workers                     => hiera('CONFIG_SERVICE_WORKERS'),\n     35:       allow_resize_to_same_host            => hiera('CONFIG_NOVA_ALLOW_RESIZE_TO_SAME'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-aodh.pp", "content": "$oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),", "line": 85, "detection_span": [80, 90], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n\n$bootstrap_node          = hiera('aodh_api_bootstrap_node_name', undef),\n$oslomsg_rpc_proto       = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n$oslomsg_rpc_hosts       = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n$oslomsg_rpc_password    = hiera('oslo_messaging_rpc_password'),\n$oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n85:   $oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n$oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n$oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n$oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n$oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n$oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n# Target line: 85\n\n     80:   $bootstrap_node          = hiera('aodh_api_bootstrap_node_name', undef),\n     81:   $oslomsg_rpc_proto       = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n     82:   $oslomsg_rpc_hosts       = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n     83:   $oslomsg_rpc_password    = hiera('oslo_messaging_rpc_password'),\n     84:   $oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n>>>  85:   $oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n     86:   $oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     87:   $oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n     88:   $oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n     89:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n     90:   $oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bastelfreak@puppet-prometheus2-manifests-params.pp", "content": "$statsd_exporter_user = 'statsd-exporter'", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n\n$statsd_exporter_group = 'statsd-exporter'\n$statsd_exporter_mapping_config_path = '/etc/statsd_mappings.conf'\n$statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n$statsd_exporter_package_ensure = 'latest'\n$statsd_exporter_package_name = 'statsd_exporter'\n87:   $statsd_exporter_user = 'statsd-exporter'\n$statsd_exporter_version = '0.3.0'\n$user = 'prometheus'\n$version = '1.5.2'\ncase $::architecture {\n'x86_64', 'amd64': { $arch = 'amd64' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n# Target line: 87\n\n     82:   $statsd_exporter_group = 'statsd-exporter'\n     83:   $statsd_exporter_mapping_config_path = '/etc/statsd_mappings.conf'\n     84:   $statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n     85:   $statsd_exporter_package_ensure = 'latest'\n     86:   $statsd_exporter_package_name = 'statsd_exporter'\n>>>  87:   $statsd_exporter_user = 'statsd-exporter'\n     88:   $statsd_exporter_version = '0.3.0'\n     89:   $user = 'prometheus'\n     90:   $version = '1.5.2'\n     91:   case $::architecture {\n     92:     'x86_64', 'amd64': { $arch = 'amd64' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp", "content": "$user     = hiera('monitoring_rabbitmq_username', 'sensu'),", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n\n#   (Optional) String. RabbitMQ vhost to be used by Sensu\n#   Defaults to '/sensu'\n#\nclass tripleo::profile::base::monitoring::rabbitmq (\n$password = hiera('monitoring_rabbitmq_password', undef),\n35:   $user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n$vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n) {\nwarning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n\nrabbitmq_vhost { 'sensu-rabbit-vhost':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n# Target line: 35\n\n     30: #   (Optional) String. RabbitMQ vhost to be used by Sensu\n     31: #   Defaults to '/sensu'\n     32: #\n     33: class tripleo::profile::base::monitoring::rabbitmq (\n     34:   $password = hiera('monitoring_rabbitmq_password', undef),\n>>>  35:   $user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n     36:   $vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n     37: ) {\n     38:   warning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n     39: \n     40:   rabbitmq_vhost { 'sensu-rabbit-vhost':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp", "content": "$db_password = pick($murano_hash['db_password'], $mysql_root_password)", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n\n$mysql_db_create     = pick($mysql_hash['db_create'], true)\n$mysql_root_password = $mysql_hash['root_password']\n\n$db_user     = pick($murano_hash['db_user'], 'murano')\n$db_name     = pick($murano_hash['db_name'], 'murano')\n18:   $db_password = pick($murano_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($murano_hash['db_host'], $database_vip)\n$db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n$db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n$db_root_password = pick($murano_hash['root_password'], $mysql_root_password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n# Target line: 18\n\n     13:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     14:   $mysql_root_password = $mysql_hash['root_password']\n     15: \n     16:   $db_user     = pick($murano_hash['db_user'], 'murano')\n     17:   $db_name     = pick($murano_hash['db_name'], 'murano')\n>>>  18:   $db_password = pick($murano_hash['db_password'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($murano_hash['db_host'], $database_vip)\n     21:   $db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n     22:   $db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n     23:   $db_root_password = pick($murano_hash['root_password'], $mysql_root_password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder.pp", "content": "$oslomsg_notify_password = hiera('oslo_messaging_notify_password'),", "line": 93, "detection_span": [88, 98], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder.pp\n\n$oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n$oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n$oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n$oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n$oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n93:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n$oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n$oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n$oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n) {\nif $::hostname == downcase($bootstrap_node) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder.pp\n# Target line: 93\n\n     88:   $oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n     89:   $oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n     90:   $oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     91:   $oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n     92:   $oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n>>>  93:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n     94:   $oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n     95:   $oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n     96:   $oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n     97: ) {\n     98:   if $::hostname == downcase($bootstrap_node) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-params.pp", "content": "$ip_mask_deny_postgres_user = '0.0.0.0/0'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-params.pp\n\n# PRIVATE CLASS: do not use directly\nclass postgresql::params inherits postgresql::globals {\n$ensure                     = true\n$version                    = $globals_version\n$listen_addresses           = 'localhost'\n6:   $ip_mask_deny_postgres_user = '0.0.0.0/0'\n$ip_mask_allow_all_users    = '127.0.0.1/32'\n$ipv4acls                   = []\n$ipv6acls                   = []\n$user                       = pick($user, 'postgres')\n$group                      = pick($group, 'postgres')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-params.pp\n# Target line: 6\n\n      1: # PRIVATE CLASS: do not use directly\n      2: class postgresql::params inherits postgresql::globals {\n      3:   $ensure                     = true\n      4:   $version                    = $globals_version\n      5:   $listen_addresses           = 'localhost'\n>>>   6:   $ip_mask_deny_postgres_user = '0.0.0.0/0'\n      7:   $ip_mask_allow_all_users    = '127.0.0.1/32'\n      8:   $ipv4acls                   = []\n      9:   $ipv6acls                   = []\n     10:   $user                       = pick($user, 'postgres')\n     11:   $group                      = pick($group, 'postgres')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-swift-ceilometer.pp", "content": "password              => hiera('CONFIG_SWIFT_KS_PW'),", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-swift-ceilometer.pp\n\ncontrol_exchange      => 'swift',\ndriver                => 'messaging',\nignore_projects       => ['service'],\nauth_uri              => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\nauth_url              => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n16:       password              => hiera('CONFIG_SWIFT_KS_PW'),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-swift-ceilometer.pp\n# Target line: 16\n\n     11:       control_exchange      => 'swift',\n     12:       driver                => 'messaging',\n     13:       ignore_projects       => ['service'],\n     14:       auth_uri              => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\n     15:       auth_url              => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n>>>  16:       password              => hiera('CONFIG_SWIFT_KS_PW'),\n     17:     }\n     18: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp", "content": "$sahara_password = pick($sahara_hash['user_password'])", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n\n$public_ssl_hash = hiera_hash('public_ssl')\n$public_vip      = hiera('public_vip')\n$admin_address   = hiera('management_vip')\n$api_bind_port   = '8386'\n$sahara_user     = pick($sahara_hash['user'], 'sahara')\n11:   $sahara_password = pick($sahara_hash['user_password'])\n$tenant          = pick($sahara_hash['tenant'], 'services')\n$region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n$service_name    = pick($sahara_hash['service_name'], 'sahara')\n$public_address = $public_ssl_hash['services'] ? {\ntrue    => $public_ssl_hash['hostname'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n# Target line: 11\n\n      6:   $public_ssl_hash = hiera_hash('public_ssl')\n      7:   $public_vip      = hiera('public_vip')\n      8:   $admin_address   = hiera('management_vip')\n      9:   $api_bind_port   = '8386'\n     10:   $sahara_user     = pick($sahara_hash['user'], 'sahara')\n>>>  11:   $sahara_password = pick($sahara_hash['user_password'])\n     12:   $tenant          = pick($sahara_hash['tenant'], 'services')\n     13:   $region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n     14:   $service_name    = pick($sahara_hash['service_name'], 'sahara')\n     15:   $public_address = $public_ssl_hash['services'] ? {\n     16:     true    => $public_ssl_hash['hostname'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-vmware.pp", "content": "host_username => hiera('CONFIG_VCENTER_USER'),", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-vmware.pp\n\n$my_ip = choose_my_ip(hiera('HOST_LIST'))\n$nova_vcenter_cluster_name = $cluster_list[$my_ip]\n\nclass { '::nova::compute::vmware':\nhost_ip       => hiera('CONFIG_VCENTER_HOST'),\n9:       host_username => hiera('CONFIG_VCENTER_USER'),\nhost_password => hiera('CONFIG_VCENTER_PASSWORD'),\ncluster_name  => $nova_vcenter_cluster_name,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-vmware.pp\n# Target line: 9\n\n      4:     $my_ip = choose_my_ip(hiera('HOST_LIST'))\n      5:     $nova_vcenter_cluster_name = $cluster_list[$my_ip]\n      6: \n      7:     class { '::nova::compute::vmware':\n      8:       host_ip       => hiera('CONFIG_VCENTER_HOST'),\n>>>   9:       host_username => hiera('CONFIG_VCENTER_USER'),\n     10:       host_password => hiera('CONFIG_VCENTER_PASSWORD'),\n     11:       cluster_name  => $nova_vcenter_cluster_name,\n     12:     }\n     13: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-plugins-ml2-opendaylight.pp", "content": "$odl_password        = hiera('opendaylight::password'),", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-plugins-ml2-opendaylight.pp\n\n#   Defaults to hiera(''enable_ipv6', false)\n#\nclass tripleo::profile::base::neutron::plugins::ml2::opendaylight (\n$odl_port            = hiera('opendaylight::odl_rest_port'),\n$odl_username        = hiera('opendaylight::username'),\n61:   $odl_password        = hiera('opendaylight::password'),\n$odl_url_ip          = hiera('opendaylight_api_vip'),\n$conn_proto          = 'http',\n$enable_internal_tls = hiera('enable_internal_tls', false),\n$internal_api_fqdn   = hiera('cloud_name_internal_api'),\n$step                = Integer(hiera('step')),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-plugins-ml2-opendaylight.pp\n# Target line: 61\n\n     56: #   Defaults to hiera(''enable_ipv6', false)\n     57: #\n     58: class tripleo::profile::base::neutron::plugins::ml2::opendaylight (\n     59:   $odl_port            = hiera('opendaylight::odl_rest_port'),\n     60:   $odl_username        = hiera('opendaylight::username'),\n>>>  61:   $odl_password        = hiera('opendaylight::password'),\n     62:   $odl_url_ip          = hiera('opendaylight_api_vip'),\n     63:   $conn_proto          = 'http',\n     64:   $enable_internal_tls = hiera('enable_internal_tls', false),\n     65:   $internal_api_fqdn   = hiera('cloud_name_internal_api'),\n     66:   $step                = Integer(hiera('step')),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp", "content": "routing_key   => '*.workflow.#',", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n\n} ->\n\ngovuk_rabbitmq::queue_with_binding { $amqp_workflow_queue:\namqp_exchange => $amqp_exchange,\namqp_queue    => $amqp_workflow_queue,\n58:     routing_key   => '*.workflow.#',\ndurable       => true,\n} ->\n\ngovuk_rabbitmq::consumer { $amqp_user:\namqp_pass            => $amqp_pass,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n# Target line: 58\n\n     53:   } ->\n     54: \n     55:   govuk_rabbitmq::queue_with_binding { $amqp_workflow_queue:\n     56:     amqp_exchange => $amqp_exchange,\n     57:     amqp_queue    => $amqp_workflow_queue,\n>>>  58:     routing_key   => '*.workflow.#',\n     59:     durable       => true,\n     60:   } ->\n     61: \n     62:   govuk_rabbitmq::consumer { $amqp_user:\n     63:     amqp_pass            => $amqp_pass,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-whitehall-db.pp", "content": "$mysql_whitehall_admin = '',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-whitehall-db.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::apps::whitehall::db (\n3:   $mysql_whitehall_admin = '',\n$whitehall_fe_password = '',\n){\nmysql::db { 'whitehall_production':\nuser     => 'whitehall',\nhost     => '%',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-whitehall-db.pp\n# Target line: 3\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::apps::whitehall::db (\n>>>   3:   $mysql_whitehall_admin = '',\n      4:   $whitehall_fe_password = '',\n      5: ){\n      6:   mysql::db { 'whitehall_production':\n      7:     user     => 'whitehall',\n      8:     host     => '%',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-common.pp", "content": "$temp_admin_login = \"temporary-administrative-user-${random}\"", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-common.pp\n\n#   limitations under the License.\n\nclass aeolus::profiles::common {\n#we will use one random hex string to name the temporary admin user\n$random = secure_random()\n18:   $temp_admin_login = \"temporary-administrative-user-${random}\"\n#and another random hex string for the temp user's password\n$temp_admin_password = secure_random()\n\naeolus::create_bucket{\"aeolus\":}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-common.pp\n# Target line: 18\n\n     13: #   limitations under the License.\n     14: \n     15: class aeolus::profiles::common {\n     16:   #we will use one random hex string to name the temporary admin user\n     17:   $random = secure_random()\n>>>  18:   $temp_admin_login = \"temporary-administrative-user-${random}\"\n     19:   #and another random hex string for the temp user's password\n     20:   $temp_admin_password = secure_random()\n     21: \n     22:   aeolus::create_bucket{\"aeolus\":}\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-content_audit_tool.pp", "content": "$db_username = 'content_audit_tool',", "line": 78, "detection_span": [73, 83], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_audit_tool.pp\n\n$db_hostname = undef,\n$db_port = undef,\n$db_allow_prepared_statements = undef,\n$db_name = 'content_audit_tool_production',\n$db_password = undef,\n78:   $db_username = 'content_audit_tool',\n$enable_procfile_worker = true,\n$google_analytics_govuk_view_id = undef,\n$google_client_email = undef,\n$google_private_key = undef,\n$oauth_id = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_audit_tool.pp\n# Target line: 78\n\n     73:   $db_hostname = undef,\n     74:   $db_port = undef,\n     75:   $db_allow_prepared_statements = undef,\n     76:   $db_name = 'content_audit_tool_production',\n     77:   $db_password = undef,\n>>>  78:   $db_username = 'content_audit_tool',\n     79:   $enable_procfile_worker = true,\n     80:   $google_analytics_govuk_view_id = undef,\n     81:   $google_client_email = undef,\n     82:   $google_private_key = undef,\n     83:   $oauth_id = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp", "content": "key    => 'BadgeDownloadRate',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n\n}\n\nboxen::osx_defaults { 'Disable total download rate on badge icon':\nuser   => $::luser,\ndomain => 'org.m0k.transmission',\n12:     key    => 'BadgeDownloadRate',\ntype   => 'bool',\nvalue  => false,\n}\n\nboxen::osx_defaults { 'Disable total upload rate on badge icon':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n# Target line: 12\n\n      7:   }\n      8: \n      9:   boxen::osx_defaults { 'Disable total download rate on badge icon':\n     10:     user   => $::luser,\n     11:     domain => 'org.m0k.transmission',\n>>>  12:     key    => 'BadgeDownloadRate',\n     13:     type   => 'bool',\n     14:     value  => false,\n     15:   }\n     16: \n     17:   boxen::osx_defaults { 'Disable total upload rate on badge icon':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-stephenharker.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7ctK3AiOjlVc/B1ECkueKBoj9z/ty5tbzaGTosie4o1tSd2vG6JRhIkGywBDbpGTEOtkCVGbgXkSsgm/7qD9kmfp/hMw11+C9aiVNcUQACXZmeUziitv4xTONVETebaNxzsS/0rdR8fRsxVuO1eX+Cr3F+ZogOpNLMOJDVd2nqUwiqgieomNqTTJU9jtRiabh/BddbvdRbAzZahY5owNT0kjqUmJcA86F0Phn0cjwQDhMsunsAa6pYnfIi/z9R1/kUE+XxKStrJRauQAXnWOXsV/7oacDtOD70rDfyLKfNDA475Q69sMdC8XFi35QrHpI5KsLtTSTKo2Y0IZBaQ4Iv2tr47Gb4zpNcez4fPHhW/1Ia+G32V/keAD3dPGE/0R7vDq4uX+udLle/oTWd+j0dr0HelZ3aqD9gNZAivRe9bKjtSPefEQD4dGPshCMP516BTb0NW1bWQLD2Qnzw9BQgh1lDDlGW0XblYAwKIZJq/KrLiMwXmv0XHcKCG41G3/JbQrXWOP0D4BnJ7nlLrUIj6ug/zk528+kMOudfbSZQwLJX/AKQ/7Dt5MGPLR8r1XSPIDoMUlrc9iBaN6tbz1J5CqGrLyMGQahP6yjRISZzgFwp9plkj87H76ApGNmRE7PnXTUMBj7/OgksrCsrj6DkOkbyeBKkudodXEkWol9AQ== stephenharker@gds5125.local',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-stephenharker.pp\n\n# Creates the stephenharker user\nclass users::stephenharker {\ngovuk_user { 'stephenharker':\nfullname => 'Stephen Harker',\nemail    => 'stephen.harker@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7ctK3AiOjlVc/B1ECkueKBoj9z/ty5tbzaGTosie4o1tSd2vG6JRhIkGywBDbpGTEOtkCVGbgXkSsgm/7qD9kmfp/hMw11+C9aiVNcUQACXZmeUziitv4xTONVETebaNxzsS/0rdR8fRsxVuO1eX+Cr3F+ZogOpNLMOJDVd2nqUwiqgieomNqTTJU9jtRiabh/BddbvdRbAzZahY5owNT0kjqUmJcA86F0Phn0cjwQDhMsunsAa6pYnfIi/z9R1/kUE+XxKStrJRauQAXnWOXsV/7oacDtOD70rDfyLKfNDA475Q69sMdC8XFi35QrHpI5KsLtTSTKo2Y0IZBaQ4Iv2tr47Gb4zpNcez4fPHhW/1Ia+G32V/keAD3dPGE/0R7vDq4uX+udLle/oTWd+j0dr0HelZ3aqD9gNZAivRe9bKjtSPefEQD4dGPshCMP516BTb0NW1bWQLD2Qnzw9BQgh1lDDlGW0XblYAwKIZJq/KrLiMwXmv0XHcKCG41G3/JbQrXWOP0D4BnJ7nlLrUIj6ug/zk528+kMOudfbSZQwLJX/AKQ/7Dt5MGPLR8r1XSPIDoMUlrc9iBaN6tbz1J5CqGrLyMGQahP6yjRISZzgFwp9plkj87H76ApGNmRE7PnXTUMBj7/OgksrCsrj6DkOkbyeBKkudodXEkWol9AQ== stephenharker@gds5125.local',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-stephenharker.pp\n# Target line: 6\n\n      1: # Creates the stephenharker user\n      2: class users::stephenharker {\n      3:   govuk_user { 'stephenharker':\n      4:     fullname => 'Stephen Harker',\n      5:     email    => 'stephen.harker@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7ctK3AiOjlVc/B1ECkueKBoj9z/ty5tbzaGTosie4o1tSd2vG6JRhIkGywBDbpGTEOtkCVGbgXkSsgm/7qD9kmfp/hMw11+C9aiVNcUQACXZmeUziitv4xTONVETebaNxzsS/0rdR8fRsxVuO1eX+Cr3F+ZogOpNLMOJDVd2nqUwiqgieomNqTTJU9jtRiabh/BddbvdRbAzZahY5owNT0kjqUmJcA86F0Phn0cjwQDhMsunsAa6pYnfIi/z9R1/kUE+XxKStrJRauQAXnWOXsV/7oacDtOD70rDfyLKfNDA475Q69sMdC8XFi35QrHpI5KsLtTSTKo2Y0IZBaQ4Iv2tr47Gb4zpNcez4fPHhW/1Ia+G32V/keAD3dPGE/0R7vDq4uX+udLle/oTWd+j0dr0HelZ3aqD9gNZAivRe9bKjtSPefEQD4dGPshCMP516BTb0NW1bWQLD2Qnzw9BQgh1lDDlGW0XblYAwKIZJq/KrLiMwXmv0XHcKCG41G3/JbQrXWOP0D4BnJ7nlLrUIj6ug/zk528+kMOudfbSZQwLJX/AKQ/7Dt5MGPLR8r1XSPIDoMUlrc9iBaN6tbz1J5CqGrLyMGQahP6yjRISZzgFwp9plkj87H76ApGNmRE7PnXTUMBj7/OgksrCsrj6DkOkbyeBKkudodXEkWol9AQ== stephenharker@gds5125.local',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-manifests-nodes.pp", "content": "$basic_auth_username = hiera('basic_auth_username')", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: alphagov@pp-puppet-manifests-nodes.pp\n\n$spotlight_vhost = join(['spotlight',$domain_name],'.')\n$screenshot_as_a_service_vhost = join(['screenshot', $public_domain_name], '.')\n\n$rabbitmq_sensu_password = hiera('rabbitmq_sensu_password')\n\n37: $basic_auth_username = hiera('basic_auth_username')\n$basic_auth_password = hiera('basic_auth_password')\n$basic_auth_password_hashed = hiera('basic_auth_password_hashed')\n\n$pp_environment = hiera('pp_environment')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-manifests-nodes.pp\n# Target line: 37\n\n     32: $spotlight_vhost = join(['spotlight',$domain_name],'.')\n     33: $screenshot_as_a_service_vhost = join(['screenshot', $public_domain_name], '.')\n     34: \n     35: $rabbitmq_sensu_password = hiera('rabbitmq_sensu_password')\n     36: \n>>>  37: $basic_auth_username = hiera('basic_auth_username')\n     38: $basic_auth_password = hiera('basic_auth_password')\n     39: $basic_auth_password_hashed = hiera('basic_auth_password_hashed')\n     40: \n     41: $pp_environment = hiera('pp_environment')\n     42: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_to_integration.pp", "content": "$jenkins_api_user_password = undef,", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_to_integration.pp\n\n$mysql_dst_root_pw = undef,\n$pg_src_env_sync_pw = undef,\n$pg_dst_env_sync_pw = undef,\n$pg_tr_dst_env_sync_pw = undef,\n$pg_wh_dst_env_sync_pw = undef,\n12:   $jenkins_api_user_password = undef,\n$enable_slack_notifications = true,\n$app_domain = hiera('app_domain'),\n) {\n\n$check_name = 'copy_data_to_integration'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_to_integration.pp\n# Target line: 12\n\n      7:   $mysql_dst_root_pw = undef,\n      8:   $pg_src_env_sync_pw = undef,\n      9:   $pg_dst_env_sync_pw = undef,\n     10:   $pg_tr_dst_env_sync_pw = undef,\n     11:   $pg_wh_dst_env_sync_pw = undef,\n>>>  12:   $jenkins_api_user_password = undef,\n     13:   $enable_slack_notifications = true,\n     14:   $app_domain = hiera('app_domain'),\n     15: ) {\n     16: \n     17:   $check_name = 'copy_data_to_integration'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-userprefs-manifests-editors_registry.pp", "content": "key    => 'HKLM\\Software\\Classes\\.erb',", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n\nvalue  => '(Default)',\ndata   => 'sourcecode',\n}\n\nregistry::value { 'ERB Templates':\n27:     key    => 'HKLM\\Software\\Classes\\.erb',\nvalue  => '(Default)',\ndata   => 'sourcecode',\n}\n\nregistry::value { 'Ruby Source Code':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n# Target line: 27\n\n     22:     value  => '(Default)',\n     23:     data   => 'sourcecode',\n     24:   }\n     25: \n     26:   registry::value { 'ERB Templates':\n>>>  27:     key    => 'HKLM\\Software\\Classes\\.erb',\n     28:     value  => '(Default)',\n     29:     data   => 'sourcecode',\n     30:   }\n     31: \n     32:   registry::value { 'Ruby Source Code':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-network-contrail-provision.pp", "content": "$admin_token       = hiera('contrail::admin_token'),", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-provision.pp\n\n#  Defaults to hiera('step')\n#\nclass tripleo::network::contrail::provision(\n$admin_password    = hiera('contrail::admin_password'),\n$admin_tenant_name = hiera('contrail::admin_tenant_name'),\n72:   $admin_token       = hiera('contrail::admin_token'),\n$admin_user        = hiera('contrail::admin_user'),\n$api_server        = hiera('contrail_config_vip'),\n$auth_host         = hiera('contrail::auth_host'),\n$auth_port         = hiera('contrail::auth_port'),\n$auth_protocol     = hiera('contrail::auth_protocol'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-provision.pp\n# Target line: 72\n\n     67: #  Defaults to hiera('step')\n     68: #\n     69: class tripleo::network::contrail::provision(\n     70:   $admin_password    = hiera('contrail::admin_password'),\n     71:   $admin_tenant_name = hiera('contrail::admin_tenant_name'),\n>>>  72:   $admin_token       = hiera('contrail::admin_token'),\n     73:   $admin_user        = hiera('contrail::admin_user'),\n     74:   $api_server        = hiera('contrail_config_vip'),\n     75:   $auth_host         = hiera('contrail::auth_host'),\n     76:   $auth_port         = hiera('contrail::auth_port'),\n     77:   $auth_protocol     = hiera('contrail::auth_protocol'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp", "content": "$middleware_user           = 'mcollective',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n\n#\nclass mco_profile::params (\n$main_collective           = 'mcollective',\n$collectives               = undef,\n$middleware_hosts          = undef,\n8:   $middleware_user           = 'mcollective',\n$middleware_password       = 'mcollective',\n$middleware_ssl_port       = '61613',\n$ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n$ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n$ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n# Target line: 8\n\n      3: #\n      4: class mco_profile::params (\n      5:   $main_collective           = 'mcollective',\n      6:   $collectives               = undef,\n      7:   $middleware_hosts          = undef,\n>>>   8:   $middleware_user           = 'mcollective',\n      9:   $middleware_password       = 'mcollective',\n     10:   $middleware_ssl_port       = '61613',\n     11:   $ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n     12:   $ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n     13:   $ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$brick1c = {", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n28: $brick1c = {\ndev => '/dev/disk/by-id/scsi-36003048007e26c00173ad3b633a36700',\t# /dev/sdb\nlabeltype => 'gpt',\nfstype => 'xfs',\nfsuuid => '1c9ee010-9cd1-4d81-9a73-f0788d5b3e33',\nxfs_inode64 => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 28\n\n     23: \txfs_inode64 => true,\n     24: \txfs_nobarrier => true,\n     25: \tareyousure => true,\n     26: }\n     27: \n>>>  28: $brick1c = {\n     29: \tdev => '/dev/disk/by-id/scsi-36003048007e26c00173ad3b633a36700',\t# /dev/sdb\n     30: \tlabeltype => 'gpt',\n     31: \tfstype => 'xfs',\n     32: \tfsuuid => '1c9ee010-9cd1-4d81-9a73-f0788d5b3e33',\n     33: \txfs_inode64 => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-finder.pp", "content": "key    => 'ShowStatusBar',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n\n}\n\nboxen::osx_defaults { 'Finder: show status bar':\nuser   => $::luser,\ndomain => 'com.apple.finder',\n29:     key    => 'ShowStatusBar',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Finder: show path bar':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n# Target line: 29\n\n     24:   }\n     25: \n     26:   boxen::osx_defaults { 'Finder: show status bar':\n     27:     user   => $::luser,\n     28:     domain => 'com.apple.finder',\n>>>  29:     key    => 'ShowStatusBar',\n     30:     type   => 'bool',\n     31:     value  => true,\n     32:   }\n     33: \n     34:   boxen::osx_defaults { 'Finder: show path bar':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$keystone_monitord_password = 'monitord'", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$keystone_admin_password    = 'admin'\n$keystone_admin_tenant      = 'admin'\n$keystone_nailgun_user      = 'nailgun'\n$keystone_nailgun_password  = 'nailgun'\n$keystone_monitord_user     = 'monitord'\n49:   $keystone_monitord_password = 'monitord'\n$keystone_monitord_tenant   = 'services'\n\n$keystone_admin_token       = 'admin'\n$keystone_token_expiration  = '86400'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 49\n\n     44:   $keystone_admin_password    = 'admin'\n     45:   $keystone_admin_tenant      = 'admin'\n     46:   $keystone_nailgun_user      = 'nailgun'\n     47:   $keystone_nailgun_password  = 'nailgun'\n     48:   $keystone_monitord_user     = 'monitord'\n>>>  49:   $keystone_monitord_password = 'monitord'\n     50:   $keystone_monitord_tenant   = 'services'\n     51: \n     52:   $keystone_admin_token       = 'admin'\n     53:   $keystone_token_expiration  = '86400'\n     54: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-tor-manifests-daemon-params.pp", "content": "$user          = 'toranon'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n\n# setup variables for different distributions\nclass tor::daemon::params {\ncase $facts['osfamily'] {\n'RedHat': {\n5:       $user          = 'toranon'\n$group         = 'toranon'\n$manage_user   = false\n$data_dir_mode = '0750'\n}\n'Debian': {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n# Target line: 5\n\n      1: # setup variables for different distributions\n      2: class tor::daemon::params {\n      3:   case $facts['osfamily'] {\n      4:     'RedHat': {\n>>>   5:       $user          = 'toranon'\n      6:       $group         = 'toranon'\n      7:       $manage_user   = false\n      8:       $data_dir_mode = '0750'\n      9:     }\n     10:     'Debian': {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ceph-manifests-profile-mgr.pp", "content": "inject_key          => true,", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: openstack@puppet-ceph-manifests-profile-mgr.pp\n\nrequire ::ceph::profile::base\n\nceph::mgr { $::hostname:\nauthentication_type => $ceph::profile::params::authentication_type,\nkey                 => $ceph::profile::params::mgr_key,\n28:     inject_key          => true,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ceph-manifests-profile-mgr.pp\n# Target line: 28\n\n     23:   require ::ceph::profile::base\n     24: \n     25:   ceph::mgr { $::hostname:\n     26:     authentication_type => $ceph::profile::params::authentication_type,\n     27:     key                 => $ceph::profile::params::mgr_key,\n>>>  28:     inject_key          => true,\n     29:   }\n     30: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-pure.pp", "content": "pure_api_token               => hiera('cinder::backend::pure::pure_api_token', undef),", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-pure.pp\n\n\nif $step >= 4 {\ncinder::backend::pure { $backend_name :\nbackend_availability_zone    => hiera('cinder::backend::pure::backend_availability_zone', undef),\nsan_ip                       => hiera('cinder::backend::pure::san_ip', undef),\n64:       pure_api_token               => hiera('cinder::backend::pure::pure_api_token', undef),\npure_storage_protocol        => hiera('cinder::backend::pure::pure_storage_protocol', undef),\nuse_chap_auth                => hiera('cinder::backend::pure::use_chap_auth', undef),\nuse_multipath_for_image_xfer => hiera('cinder::backend::pure::use_multipath_for_image_xfer', undef),\nimage_volume_cache_enabled   => hiera('cinder::backend::pure::image_volume_cache_enabled', undef),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-pure.pp\n# Target line: 64\n\n     59: \n     60:   if $step >= 4 {\n     61:     cinder::backend::pure { $backend_name :\n     62:       backend_availability_zone    => hiera('cinder::backend::pure::backend_availability_zone', undef),\n     63:       san_ip                       => hiera('cinder::backend::pure::san_ip', undef),\n>>>  64:       pure_api_token               => hiera('cinder::backend::pure::pure_api_token', undef),\n     65:       pure_storage_protocol        => hiera('cinder::backend::pure::pure_storage_protocol', undef),\n     66:       use_chap_auth                => hiera('cinder::backend::pure::use_chap_auth', undef),\n     67:       use_multipath_for_image_xfer => hiera('cinder::backend::pure::use_multipath_for_image_xfer', undef),\n     68:       image_volume_cache_enabled   => hiera('cinder::backend::pure::image_volume_cache_enabled', undef),\n     69:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp", "content": "jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n\nserveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\njenkins_version             => hiera('jenkins_version', 'present'),\njenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\njenkins_username            => hiera('jenkins_username', 'jenkins'),\njenkins_password            => hiera('jenkins_password', 'XXX'),\n39:     jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\njenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\njava_args_override          => hiera('java_args_override', undef),\ngerrit_server               => hiera('gerrit_server', 'review.openstack.org'),\ngerrit_user                 => hiera('gerrit_user'),\ngerrit_user_ssh_public_key  => hiera('gerrit_user_ssh_public_key'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n# Target line: 39\n\n     34:     serveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\n     35:     jenkins_version             => hiera('jenkins_version', 'present'),\n     36:     jenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\n     37:     jenkins_username            => hiera('jenkins_username', 'jenkins'),\n     38:     jenkins_password            => hiera('jenkins_password', 'XXX'),\n>>>  39:     jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\n     40:     jenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\n     41:     java_args_override          => hiera('java_args_override', undef),\n     42:     gerrit_server               => hiera('gerrit_server', 'review.openstack.org'),\n     43:     gerrit_user                 => hiera('gerrit_user'),\n     44:     gerrit_user_ssh_public_key  => hiera('gerrit_user_ssh_public_key'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-aodh-keystone.pp", "content": "$aodh_user_name       = pick($aodh_hash['user'], 'aodh')", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-aodh-keystone.pp\n\nclass openstack_tasks::aodh::keystone {\n\nnotice('MODULAR: aodh/keystone.pp')\n\n$aodh_hash            = hiera_hash('aodh', {})\n6:   $aodh_user_name       = pick($aodh_hash['user'], 'aodh')\n$aodh_user_password   = $aodh_hash['user_password']\n$service_name         = pick($aodh_hash['service'], 'aodh')\n$region               = pick($aodh_hash['region'], hiera('region', 'RegionOne'))\n$tenant               = pick($aodh_hash['tenant'], 'services')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-aodh-keystone.pp\n# Target line: 6\n\n      1: class openstack_tasks::aodh::keystone {\n      2: \n      3:   notice('MODULAR: aodh/keystone.pp')\n      4: \n      5:   $aodh_hash            = hiera_hash('aodh', {})\n>>>   6:   $aodh_user_name       = pick($aodh_hash['user'], 'aodh')\n      7:   $aodh_user_password   = $aodh_hash['user_password']\n      8:   $service_name         = pick($aodh_hash['service'], 'aodh')\n      9:   $region               = pick($aodh_hash['region'], hiera('region', 'RegionOne'))\n     10:   $tenant               = pick($aodh_hash['tenant'], 'services')\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-monitor_messages.pp", "content": "$rabbitmq_user = 'monitoring',", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-monitor_messages.pp\n\n$rabbitmq_queue,\n$critical_threshold,\n$warning_threshold,\n$ensure = present,\n$rabbitmq_hostname = 'rabbitmq-1.backend',\n35:   $rabbitmq_user = 'monitoring',\n$rabbitmq_admin_port = 15672,\n){\n\nif $ensure == present {\ninclude icinga::plugin::check_rabbitmq_messages", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-monitor_messages.pp\n# Target line: 35\n\n     30:   $rabbitmq_queue,\n     31:   $critical_threshold,\n     32:   $warning_threshold,\n     33:   $ensure = present,\n     34:   $rabbitmq_hostname = 'rabbitmq-1.backend',\n>>>  35:   $rabbitmq_user = 'monitoring',\n     36:   $rabbitmq_admin_port = 15672,\n     37: ){\n     38: \n     39:   if $ensure == present {\n     40:     include icinga::plugin::check_rabbitmq_messages\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-nova-libvirt.pp", "content": "$tls_password    = '',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-nova-libvirt.pp\n\n#   Defaults to '' (disabled)\n#\nclass tripleo::profile::base::nova::libvirt (\n$step = Integer(hiera('step')),\n$libvirtd_config = {},\n37:   $tls_password    = '',\n) {\ninclude ::tripleo::profile::base::nova::compute_libvirt_shared\n\nif $step >= 4 {\ninclude ::tripleo::profile::base::nova", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-nova-libvirt.pp\n# Target line: 37\n\n     32: #   Defaults to '' (disabled)\n     33: #\n     34: class tripleo::profile::base::nova::libvirt (\n     35:   $step = Integer(hiera('step')),\n     36:   $libvirtd_config = {},\n>>>  37:   $tls_password    = '',\n     38: ) {\n     39:   include ::tripleo::profile::base::nova::compute_libvirt_shared\n     40: \n     41:   if $step >= 4 {\n     42:     include ::tripleo::profile::base::nova\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-compute.pp", "content": "$default_ceilometer_hash = {", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-compute.pp\n\n$syslog_log_facility      = hiera('syslog_log_facility_ceilometer', 'LOG_LOCAL0')\n$rabbit_hash              = hiera_hash('rabbit')\n$management_vip           = hiera('management_vip')\n$service_endpoint         = hiera('service_endpoint', $management_vip)\n\n12:   $default_ceilometer_hash = {\n'enabled'                    => false,\n'db_password'                => 'ceilometer',\n'user_password'              => 'ceilometer',\n'metering_secret'            => 'ceilometer',\n'http_timeout'               => '600',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-compute.pp\n# Target line: 12\n\n      7:   $syslog_log_facility      = hiera('syslog_log_facility_ceilometer', 'LOG_LOCAL0')\n      8:   $rabbit_hash              = hiera_hash('rabbit')\n      9:   $management_vip           = hiera('management_vip')\n     10:   $service_endpoint         = hiera('service_endpoint', $management_vip)\n     11: \n>>>  12:   $default_ceilometer_hash = {\n     13:     'enabled'                    => false,\n     14:     'db_password'                => 'ceilometer',\n     15:     'user_password'              => 'ceilometer',\n     16:     'metering_secret'            => 'ceilometer',\n     17:     'http_timeout'               => '600',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-cli.pp", "content": "$jenkins_api_user = 'jenkins_api_user',", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-cli.pp\n\n# [*jenkins_api_token*]\n#   The token used to authenticate with the Jenkins API.\n#\nclass govuk_jenkins::cli (\n$jenkins_home = '/var/lib/jenkins',\n27:   $jenkins_api_user = 'jenkins_api_user',\n$jenkins_api_token = '',\n) {\nrequire ::govuk_jenkins\n\ncurl::fetch { 'Jenkins CLI tool':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-cli.pp\n# Target line: 27\n\n     22: # [*jenkins_api_token*]\n     23: #   The token used to authenticate with the Jenkins API.\n     24: #\n     25: class govuk_jenkins::cli (\n     26:   $jenkins_home = '/var/lib/jenkins',\n>>>  27:   $jenkins_api_user = 'jenkins_api_user',\n     28:   $jenkins_api_token = '',\n     29: ) {\n     30:   require ::govuk_jenkins\n     31: \n     32:   curl::fetch { 'Jenkins CLI tool':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-disk_cache.pp", "content": "$cache_root = undef,", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-disk_cache.pp\n\nclass apache::mod::disk_cache (\n2:   $cache_root = undef,\n) {\ninclude ::apache\nif $cache_root {\n$_cache_root = $cache_root\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-disk_cache.pp\n# Target line: 2\n\n      1: class apache::mod::disk_cache (\n>>>   2:   $cache_root = undef,\n      3: ) {\n      4:   include ::apache\n      5:   if $cache_root {\n      6:     $_cache_root = $cache_root\n      7:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-resources-database.pp", "content": "$user = getvar(\"::openstack::config::mysql_user_${title}\"),", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-database.pp\n\ndefine openstack::resources::database (\n2:   $user = getvar(\"::openstack::config::mysql_user_${title}\"),\n$password = getvar(\"::openstack::config::mysql_pass_${title}\"),\n) {\nclass { \"::${title}::db::mysql\":\nuser          => $user,\npassword      => $password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-database.pp\n# Target line: 2\n\n      1: define openstack::resources::database (\n>>>   2:   $user = getvar(\"::openstack::config::mysql_user_${title}\"),\n      3:   $password = getvar(\"::openstack::config::mysql_pass_${title}\"),\n      4: ) {\n      5:   class { \"::${title}::db::mysql\":\n      6:     user          => $user,\n      7:     password      => $password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-mahmudhussain.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCx9sd0QWv6mbNVp6EYcZ0RWS3VBu3gRqt5EvJBscWnPrxcK265df0NXFFQ0HdNFVYybcfNw7wjBuz7WLUd8M3p3uWoZtoaQNq8fH5AxUC1yvQbOaFLFcFuOGOLvS+ej3CBns3OQ+r02kuZijYHVPbGFwjKJps2621gP6E3LWGuJMnf58GUu5TEte6jKDGhiIe/3/0dAhlv+epKa9kCmi+uRgKZoxZyucjsQ8LrdLuw1kIghJ04qkDiMqyCasG9omwsAdMbEDA6kj8IJpbJV7wX1e8KSCQZFy8d+OxwN+9FMkvly7ZpET2ABbw69Wj0kTs4g4gXX5wW6w35Zd6OX+asnQztL4sRaTkhtNCpSjuiIpIO09Rq7+V7shy16P5OAZS/EDA7XTtV/CGDE6Id2hccFzwqJBkPqaWwTHfWRbmXSJuqfiHDF+5nViOgkQGd0J2OLwxN/cKFPW5zo5Wj7RCbkowM2UVO19QsU7EXVrPWc/t+CfDSRgu+uAEJZbH6kmOsrhBXtdU35J46MY8nPQjHc0FHaiXA8mdrK4EDZ/y5dAGW2fyAlgf5lPk/kxeWAv8+c9yX3u3uIzsO//iQTpC3y0jZgpZYLN21ehoLtiZS/c1H/OR8CwhH2eW973C7RUO3UXPlLiAbtpvjJ6PUCQQbrIe9/nwlZvX5l8S3JGnqRQ== mahmud.hussain@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-mahmudhussain.pp\n\n# Creates mahmudhussain user\nclass users::mahmudhussain {\ngovuk_user { 'mahmudhussain':\nfullname => 'Mahmud Hussain',\nemail    => 'mahmud.hussain@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCx9sd0QWv6mbNVp6EYcZ0RWS3VBu3gRqt5EvJBscWnPrxcK265df0NXFFQ0HdNFVYybcfNw7wjBuz7WLUd8M3p3uWoZtoaQNq8fH5AxUC1yvQbOaFLFcFuOGOLvS+ej3CBns3OQ+r02kuZijYHVPbGFwjKJps2621gP6E3LWGuJMnf58GUu5TEte6jKDGhiIe/3/0dAhlv+epKa9kCmi+uRgKZoxZyucjsQ8LrdLuw1kIghJ04qkDiMqyCasG9omwsAdMbEDA6kj8IJpbJV7wX1e8KSCQZFy8d+OxwN+9FMkvly7ZpET2ABbw69Wj0kTs4g4gXX5wW6w35Zd6OX+asnQztL4sRaTkhtNCpSjuiIpIO09Rq7+V7shy16P5OAZS/EDA7XTtV/CGDE6Id2hccFzwqJBkPqaWwTHfWRbmXSJuqfiHDF+5nViOgkQGd0J2OLwxN/cKFPW5zo5Wj7RCbkowM2UVO19QsU7EXVrPWc/t+CfDSRgu+uAEJZbH6kmOsrhBXtdU35J46MY8nPQjHc0FHaiXA8mdrK4EDZ/y5dAGW2fyAlgf5lPk/kxeWAv8+c9yX3u3uIzsO//iQTpC3y0jZgpZYLN21ehoLtiZS/c1H/OR8CwhH2eW973C7RUO3UXPlLiAbtpvjJ6PUCQQbrIe9/nwlZvX5l8S3JGnqRQ== mahmud.hussain@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-mahmudhussain.pp\n# Target line: 6\n\n      1: # Creates mahmudhussain user\n      2: class users::mahmudhussain {\n      3:   govuk_user { 'mahmudhussain':\n      4:     fullname => 'Mahmud Hussain',\n      5:     email    => 'mahmud.hussain@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCx9sd0QWv6mbNVp6EYcZ0RWS3VBu3gRqt5EvJBscWnPrxcK265df0NXFFQ0HdNFVYybcfNw7wjBuz7WLUd8M3p3uWoZtoaQNq8fH5AxUC1yvQbOaFLFcFuOGOLvS+ej3CBns3OQ+r02kuZijYHVPbGFwjKJps2621gP6E3LWGuJMnf58GUu5TEte6jKDGhiIe/3/0dAhlv+epKa9kCmi+uRgKZoxZyucjsQ8LrdLuw1kIghJ04qkDiMqyCasG9omwsAdMbEDA6kj8IJpbJV7wX1e8KSCQZFy8d+OxwN+9FMkvly7ZpET2ABbw69Wj0kTs4g4gXX5wW6w35Zd6OX+asnQztL4sRaTkhtNCpSjuiIpIO09Rq7+V7shy16P5OAZS/EDA7XTtV/CGDE6Id2hccFzwqJBkPqaWwTHfWRbmXSJuqfiHDF+5nViOgkQGd0J2OLwxN/cKFPW5zo5Wj7RCbkowM2UVO19QsU7EXVrPWc/t+CfDSRgu+uAEJZbH6kmOsrhBXtdU35J46MY8nPQjHc0FHaiXA8mdrK4EDZ/y5dAGW2fyAlgf5lPk/kxeWAv8+c9yX3u3uIzsO//iQTpC3y0jZgpZYLN21ehoLtiZS/c1H/OR8CwhH2eW973C7RUO3UXPlLiAbtpvjJ6PUCQQbrIe9/nwlZvX5l8S3JGnqRQ== mahmud.hussain@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-course-virtual-practitioner.pp", "content": "stomp_password   => chomp(file('/etc/puppetlabs/mcollective/credentials','/dev/null')),", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-course-virtual-practitioner.pp\n\npuppet_enterprise::mcollective::client { 'peadmin':\nactivemq_brokers => ['master.puppetlabs.vm'],\nkeypair_name     => 'pe-internal-peadmin-mcollective-client',\ncreate_user      => true,\nlogfile          => '/var/lib/peadmin/.mcollective.d/client.log',\n46:       stomp_password   => chomp(file('/etc/puppetlabs/mcollective/credentials','/dev/null')),\nstomp_port       => 61613,\nstomp_user       => 'mcollective',\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-course-virtual-practitioner.pp\n# Target line: 46\n\n     41:     puppet_enterprise::mcollective::client { 'peadmin':\n     42:       activemq_brokers => ['master.puppetlabs.vm'],\n     43:       keypair_name     => 'pe-internal-peadmin-mcollective-client',\n     44:       create_user      => true,\n     45:       logfile          => '/var/lib/peadmin/.mcollective.d/client.log',\n>>>  46:       stomp_password   => chomp(file('/etc/puppetlabs/mcollective/credentials','/dev/null')),\n     47:       stomp_port       => 61613,\n     48:       stomp_user       => 'mcollective',\n     49:     }\n     50:   }\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp", "content": "key        => '16d09fb4',", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n\n$os = downcase($::operatingsystem)\n\ncase $::osfamily {\n'debian': {\napt::key { 'hhvm':\n95:         key        => '16d09fb4',\nkey_source => 'http://dl.hhvm.com/conf/hhvm.gpg.key',\n}\n\napt::source { 'hhvm':\nlocation          => \"http://dl.hhvm.com/${os}\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n# Target line: 95\n\n     90:   $os = downcase($::operatingsystem)\n     91: \n     92:   case $::osfamily {\n     93:     'debian': {\n     94:       apt::key { 'hhvm':\n>>>  95:         key        => '16d09fb4',\n     96:         key_source => 'http://dl.hhvm.com/conf/hhvm.gpg.key',\n     97:       }\n     98: \n     99:       apt::source { 'hhvm':\n    100:         location          => \"http://dl.hhvm.com/${os}\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-log_server_site.pp", "content": "swift_key               => hiera('swift_key', ''),", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n\ndomain                  => hiera('domain'),\njenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\nara_middleware          => hiera('ara_middleware', false),\nswift_authurl           => hiera('swift_authurl', ''),\nswift_user              => hiera('swift_user', ''),\n29:     swift_key               => hiera('swift_key', ''),\nswift_tenant_name       => hiera('swift_tenant_name', ''),\nswift_region_name       => hiera('swift_region_name', ''),\nswift_default_container => hiera('swift_default_container', ''),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n# Target line: 29\n\n     24:     domain                  => hiera('domain'),\n     25:     jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\n     26:     ara_middleware          => hiera('ara_middleware', false),\n     27:     swift_authurl           => hiera('swift_authurl', ''),\n     28:     swift_user              => hiera('swift_user', ''),\n>>>  29:     swift_key               => hiera('swift_key', ''),\n     30:     swift_tenant_name       => hiera('swift_tenant_name', ''),\n     31:     swift_region_name       => hiera('swift_region_name', ''),\n     32:     swift_default_container => hiera('swift_default_container', ''),\n     33:   }\n     34: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhosts_without_listen.pp", "content": "docroot    => '/var/www/fifth',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhosts_without_listen.pp\n\ndocroot    => '/var/www/fourth',\nadd_listen => false,\n}\napache::vhost { 'fifth.example.com':\nport       => '80',\n51:   docroot    => '/var/www/fifth',\nadd_listen => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhosts_without_listen.pp\n# Target line: 51\n\n     46:   docroot    => '/var/www/fourth',\n     47:   add_listen => false,\n     48: }\n     49: apache::vhost { 'fifth.example.com':\n     50:   port       => '80',\n>>>  51:   docroot    => '/var/www/fifth',\n     52:   add_listen => false,\n     53: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-global-key_repeat_delay.pp", "content": "key    => 'InitialKeyRepeat',", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: boxen@puppet-osx-manifests-global-key_repeat_delay.pp\n\n#   }\nclass osx::global::key_repeat_delay($delay = 35) {\nboxen::osx_defaults { 'key repeat delay':\ndomain => 'NSGlobalDomain',\ntype   => 'int',\n18:     key    => 'InitialKeyRepeat',\nvalue  => $delay,\nuser   => $::boxen_user\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-global-key_repeat_delay.pp\n# Target line: 18\n\n     13: #   }\n     14: class osx::global::key_repeat_delay($delay = 35) {\n     15:   boxen::osx_defaults { 'key repeat delay':\n     16:     domain => 'NSGlobalDomain',\n     17:     type   => 'int',\n>>>  18:     key    => 'InitialKeyRepeat',\n     19:     value  => $delay,\n     20:     user   => $::boxen_user\n     21:   }\n     22: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-ironic.pp", "content": "password => 'ironic',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-ironic.pp\n\nrabbit_use_ssl        => $::openstack_integration::config::ssl,\namqp_sasl_mechanisms  => 'PLAIN',\ndatabase_connection   => 'mysql+pymysql://ironic:ironic@127.0.0.1/ironic?charset=utf8',\n}\nclass { '::ironic::db::mysql':\n34:     password => 'ironic',\n}\nclass { '::ironic::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:6385\",\ninternal_url => \"${::openstack_integration::config::base_url}:6385\",\nadmin_url    => \"${::openstack_integration::config::base_url}:6385\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-ironic.pp\n# Target line: 34\n\n     29:     rabbit_use_ssl        => $::openstack_integration::config::ssl,\n     30:     amqp_sasl_mechanisms  => 'PLAIN',\n     31:     database_connection   => 'mysql+pymysql://ironic:ironic@127.0.0.1/ironic?charset=utf8',\n     32:   }\n     33:   class { '::ironic::db::mysql':\n>>>  34:     password => 'ironic',\n     35:   }\n     36:   class { '::ironic::keystone::auth':\n     37:     public_url   => \"${::openstack_integration::config::base_url}:6385\",\n     38:     internal_url => \"${::openstack_integration::config::base_url}:6385\",\n     39:     admin_url    => \"${::openstack_integration::config::base_url}:6385\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-router-manifests-errorpage.pp", "content": "user    => 'deploy',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n\n$cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n\nexec { \"update_error_page_${title}\":\ncommand => $cmd,\nunless  => \"find ${filename} -mmin -360 -print 2>/dev/null | grep -Eqs '^${filename}$'\",\n24:     user    => 'deploy',\ngroup   => 'deploy',\nrequire => Class['curl'],\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n# Target line: 24\n\n     19:   $cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n     20: \n     21:   exec { \"update_error_page_${title}\":\n     22:     command => $cmd,\n     23:     unless  => \"find ${filename} -mmin -360 -print 2>/dev/null | grep -Eqs '^${filename}$'\",\n>>>  24:     user    => 'deploy',\n     25:     group   => 'deploy',\n     26:     require => Class['curl'],\n     27:   }\n     28: \n     29: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-nginx-manifests-params.pp", "content": "$_module_os_overrides = {", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-params.pp\n\n}\ndefault: {\n## For cases not covered in $::osfamily\ncase $::operatingsystem {\n'SmartOS': {\n71:           $_module_os_overrides = {\n'conf_dir'    => '/usr/local/etc/nginx',\n'daemon_user' => 'www',\n}\n}\ndefault: { $_module_os_overrides = {} }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-params.pp\n# Target line: 71\n\n     66:     }\n     67:     default: {\n     68:       ## For cases not covered in $::osfamily\n     69:       case $::operatingsystem {\n     70:         'SmartOS': {\n>>>  71:           $_module_os_overrides = {\n     72:             'conf_dir'    => '/usr/local/etc/nginx',\n     73:             'daemon_user' => 'www',\n     74:           }\n     75:         }\n     76:         default: { $_module_os_overrides = {} }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-config.pp", "content": "docroot => '/var/www/labs',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-config.pp\n\ndefault_vhost => false,\n# overwrite_ports => false,\n}\napache::vhost { 'vhost.labs.com':\nport    => \"$port\",\n43:     docroot => '/var/www/labs',\n}\n\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-config.pp\n# Target line: 43\n\n     38:     default_vhost => false,\n     39:     # overwrite_ports => false,\n     40:   }\n     41:   apache::vhost { 'vhost.labs.com':\n     42:     port    => \"$port\",\n>>>  43:     docroot => '/var/www/labs',\n     44:   }\n     45: \n     46: \n     47: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-perestroika-publisher.pp", "content": "$gpg_pub_key_owner  = 'jenkins',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-perestroika-publisher.pp\n\nclass fuel_project::roles::perestroika::publisher (\n$gpg_content_priv,\n$gpg_content_pub,\n$gpg_id_priv,\n$gpg_id_pub,\n21:   $gpg_pub_key_owner  = 'jenkins',\n$gpg_priv_key_owner = 'jenkins',\n$packages = [\n'createrepo',\n'devscripts',\n'expect',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-perestroika-publisher.pp\n# Target line: 21\n\n     16: class fuel_project::roles::perestroika::publisher (\n     17:   $gpg_content_priv,\n     18:   $gpg_content_pub,\n     19:   $gpg_id_priv,\n     20:   $gpg_id_pub,\n>>>  21:   $gpg_pub_key_owner  = 'jenkins',\n     22:   $gpg_priv_key_owner = 'jenkins',\n     23:   $packages = [\n     24:     'createrepo',\n     25:     'devscripts',\n     26:     'expect',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-local_links_manager-db.pp", "content": "user                    => 'local_links_manager',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-local_links_manager-db.pp\n\n$allow_auth_from_lb = false,\n$lb_ip_range = undef,\n$rds = false,\n) {\ngovuk_postgresql::db { 'local-links-manager_production':\n31:     user                    => 'local_links_manager',\npassword                => $password,\nallow_auth_from_backend => true,\nbackend_ip_range        => $backend_ip_range,\nallow_auth_from_lb      => $allow_auth_from_lb,\nlb_ip_range             => $lb_ip_range,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-local_links_manager-db.pp\n# Target line: 31\n\n     26:   $allow_auth_from_lb = false,\n     27:   $lb_ip_range = undef,\n     28:   $rds = false,\n     29: ) {\n     30:   govuk_postgresql::db { 'local-links-manager_production':\n>>>  31:     user                    => 'local_links_manager',\n     32:     password                => $password,\n     33:     allow_auth_from_backend => true,\n     34:     backend_ip_range        => $backend_ip_range,\n     35:     allow_auth_from_lb      => $allow_auth_from_lb,\n     36:     lb_ip_range             => $lb_ip_range,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-finder-empty_trash_securely.pp", "content": "key    => 'EmptyTrashSecurely',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: boxen@puppet-osx-manifests-finder-empty_trash_securely.pp\n\nclass osx::finder::empty_trash_securely {\ninclude osx::finder\n\nboxen::osx_defaults { 'Securely Empty Trash':\nuser   => $::boxen_user,\n7:     key    => 'EmptyTrashSecurely',\ndomain => 'com.apple.finder',\nvalue  => true,\nnotify => Exec['killall Finder'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-finder-empty_trash_securely.pp\n# Target line: 7\n\n      2: class osx::finder::empty_trash_securely {\n      3:   include osx::finder\n      4: \n      5:   boxen::osx_defaults { 'Securely Empty Trash':\n      6:     user   => $::boxen_user,\n>>>   7:     key    => 'EmptyTrashSecurely',\n      8:     domain => 'com.apple.finder',\n      9:     value  => true,\n     10:     notify => Exec['killall Finder'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "garethr@garethr-docker-manifests-swarm.pp", "content": "$token = undef,", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: garethr@garethr-docker-manifests-swarm.pp\n\n$external_ca = undef,\n$force_new_cluster = false,\n$listen_addr = undef,\n$max_snapshots = undef,\n$snapshot_interval = undef,\n87:   $token = undef,\n$manager_ip = undef,\n){\n\ninclude docker::params\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: garethr@garethr-docker-manifests-swarm.pp\n# Target line: 87\n\n     82:   $external_ca = undef,\n     83:   $force_new_cluster = false,\n     84:   $listen_addr = undef,\n     85:   $max_snapshots = undef,\n     86:   $snapshot_interval = undef,\n>>>  87:   $token = undef,\n     88:   $manager_ip = undef,\n     89:   ){\n     90: \n     91:   include docker::params\n     92: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp", "content": "$password = hiera('monitoring_rabbitmq_password', undef),", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n\n# [*vhost*]\n#   (Optional) String. RabbitMQ vhost to be used by Sensu\n#   Defaults to '/sensu'\n#\nclass tripleo::profile::base::monitoring::rabbitmq (\n34:   $password = hiera('monitoring_rabbitmq_password', undef),\n$user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n$vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n) {\nwarning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n# Target line: 34\n\n     29: # [*vhost*]\n     30: #   (Optional) String. RabbitMQ vhost to be used by Sensu\n     31: #   Defaults to '/sensu'\n     32: #\n     33: class tripleo::profile::base::monitoring::rabbitmq (\n>>>  34:   $password = hiera('monitoring_rabbitmq_password', undef),\n     35:   $user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n     36:   $vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n     37: ) {\n     38:   warning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp", "content": "netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),", "line": 96, "detection_span": [91, 101], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n\n}\n\nelsif $netapp_storage_protocol == 'fc' {\ncinder::backend::netapp { $netapp_backend_name:\nnetapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\n96:           netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\nnetapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\nnetapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\nnetapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\nnetapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),\nnetapp_storage_protocol     => hiera('CONFIG_CINDER_NETAPP_STORAGE_PROTOCOL'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n# Target line: 96\n\n     91:       }\n     92: \n     93:       elsif $netapp_storage_protocol == 'fc' {\n     94:         cinder::backend::netapp { $netapp_backend_name:\n     95:           netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\n>>>  96:           netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\n     97:           netapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\n     98:           netapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\n     99:           netapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\n    100:           netapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),\n    101:           netapp_storage_protocol     => hiera('CONFIG_CINDER_NETAPP_STORAGE_PROTOCOL'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp", "content": "service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n\nrequire => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n} ->\nmanila::service_instance{ 'generic':\nservice_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\nservice_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\n36:       service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\nservice_instance_network_helper_type => $service_instance_network_helper_type,\nservice_instance_flavor_id           => 66,\n}\n\nclass { '::manila::compute::nova':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n# Target line: 36\n\n     31:       require => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n     32:     } ->\n     33:     manila::service_instance{ 'generic':\n     34:       service_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\n     35:       service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\n>>>  36:       service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\n     37:       service_instance_network_helper_type => $service_instance_network_helper_type,\n     38:       service_instance_flavor_id           => 66,\n     39:     }\n     40: \n     41:     class { '::manila::compute::nova':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-examples-server.pp", "content": "root_password => 'password',", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-server.pp\n\nclass { 'mysql::server':\n2:   root_password => 'password',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-server.pp\n# Target line: 2\n\n      1: class { 'mysql::server':\n>>>   2:   root_password => 'password',\n      3: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$cobbler_user                  = 'cobbler'", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$rabbitmq_management_port      = 15672\n$rabbitmq_management_bind_ip   = '127.0.0.1'\n\n$cobbler_host                  = $::ipaddress\n$cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n70:   $cobbler_user                  = 'cobbler'\n$cobbler_password              = 'cobbler'\n$centos_repos = [\n{\n'id'   => 'nailgun',\n'name' => 'Nailgun',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 70\n\n     65:   $rabbitmq_management_port      = 15672\n     66:   $rabbitmq_management_bind_ip   = '127.0.0.1'\n     67: \n     68:   $cobbler_host                  = $::ipaddress\n     69:   $cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n>>>  70:   $cobbler_user                  = 'cobbler'\n     71:   $cobbler_password              = 'cobbler'\n     72:   $centos_repos = [\n     73:     {\n     74:     'id'   => 'nailgun',\n     75:     'name' => 'Nailgun',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gds-operations@puppet-graphite-manifests-params.pp", "content": "$admin_password = 'sha1$1b11b$edeb0a67a9622f1f2cfeabf9188a711f5ac7d236'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: gds-operations@puppet-graphite-manifests-params.pp\n\n# == Class: graphite::params\n#\n# Class to set default graphite params\n#\nclass graphite::params {\n6:   $admin_password = 'sha1$1b11b$edeb0a67a9622f1f2cfeabf9188a711f5ac7d236'\n$bind_address = '127.0.0.1'\n$port = 8000\n$root_dir = '/opt/graphite'\n$version = '0.9.12'\n$worker_processes = 2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: gds-operations@puppet-graphite-manifests-params.pp\n# Target line: 6\n\n      1: # == Class: graphite::params\n      2: #\n      3: # Class to set default graphite params\n      4: #\n      5: class graphite::params {\n>>>   6:   $admin_password = 'sha1$1b11b$edeb0a67a9622f1f2cfeabf9188a711f5ac7d236'\n      7:   $bind_address = '127.0.0.1'\n      8:   $port = 8000\n      9:   $root_dir = '/opt/graphite'\n     10:   $version = '0.9.12'\n     11:   $worker_processes = 2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp", "content": "# Postfix MTA service", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n\n# == Class: postfix\n#\n3: # Postfix MTA service\n#\nclass postfix {\n\n# T160660: Upgrade openssl before installing postfix.\n# Note: ensure => latest here is gross but there really isn't another way", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n# Target line: 3\n\n      1: # == Class: postfix\n      2: #\n>>>   3: # Postfix MTA service\n      4: #\n      5: class postfix {\n      6: \n      7:     # T160660: Upgrade openssl before installing postfix.\n      8:     # Note: ensure => latest here is gross but there really isn't another way\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "zend-patterns@ZendServerPuppet-manifests-zsmanage.pp", "content": "# TODO: use params class pattern", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-zsmanage.pp\n\n# Options to supply to the Zend Server command. See \"/usr/local/zend/bin/zs-manage --help\" for a list of the relevant options for each command.\n# [*zsurl*]\n# URL To the Zend Server web API (Default: http://localhost:10081/ZendServer)\n# [*onlyif*]\n# If this parameter is set, then this will only run if the command has an exit code of 0.\n19: # TODO: use params class pattern\n# TODO: merge into zendserver::sdk class as a provider\ndefine zendserver::zsmanage (\n$command,\n$zskey,\n$zssecret,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-zsmanage.pp\n# Target line: 19\n\n     14: # Options to supply to the Zend Server command. See \"/usr/local/zend/bin/zs-manage --help\" for a list of the relevant options for each command.\n     15: # [*zsurl*]\n     16: # URL To the Zend Server web API (Default: http://localhost:10081/ZendServer)\n     17: # [*onlyif*]\n     18: # If this parameter is set, then this will only run if the command has an exit code of 0.\n>>>  19: # TODO: use params class pattern\n     20: # TODO: merge into zendserver::sdk class as a provider\n     21: define zendserver::zsmanage (\n     22:   $command,\n     23:   $zskey,\n     24:   $zssecret,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "String                          $mydestination       = '$myorigin',   # postfix_mydestination", "line": 109, "detection_span": [104, 114], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nOptional[String]                $master_submission   = undef,         # postfix_master_submission\nOptional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\nString                          $master_bounce_command = 'bounce',\nString                          $master_defer_command  = 'bounce',\nBoolean                         $mta                 = false,\n109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\nString                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\nString                          $myorigin            = $::fqdn,\nOptional[String]                $relayhost           = undef,         # postfix_relayhost\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 109\n\n    104:   Optional[String]                $master_submission   = undef,         # postfix_master_submission\n    105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\n    106:   String                          $master_bounce_command = 'bounce',\n    107:   String                          $master_defer_command  = 'bounce',\n    108:   Boolean                         $mta                 = false,\n>>> 109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\n    110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n    111:   String                          $myorigin            = $::fqdn,\n    112:   Optional[String]                $relayhost           = undef,         # postfix_relayhost\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-nginx-manifests-resource-streamhost.pp", "content": "#   [*resolver*]            - Array: Configures name servers used to resolve", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-resource-streamhost.pp\n\n#   [*proxy*]               - Proxy server(s) for the root location to connect\n#     to.  Accepts a single value, can be used in conjunction with\n#     nginx::resource::upstream\n#   [*proxy_read_timeout*]  - Override the default the proxy read timeout value\n#     of 90 seconds\n29: #   [*resolver*]            - Array: Configures name servers used to resolve\n#     names of upstream servers into addresses.\n#   [*server_name*]         - List of streamhost names for which this streamhost will\n#     respond. Default [$name].\n#   [*raw_prepend*]            - A single string, or an array of strings to\n#     prepend to the server directive (after cfg prepend directives). NOTE:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-resource-streamhost.pp\n# Target line: 29\n\n     24: #   [*proxy*]               - Proxy server(s) for the root location to connect\n     25: #     to.  Accepts a single value, can be used in conjunction with\n     26: #     nginx::resource::upstream\n     27: #   [*proxy_read_timeout*]  - Override the default the proxy read timeout value\n     28: #     of 90 seconds\n>>>  29: #   [*resolver*]            - Array: Configures name servers used to resolve\n     30: #     names of upstream servers into addresses.\n     31: #   [*server_name*]         - List of streamhost names for which this streamhost will\n     32: #     respond. Default [$name].\n     33: #   [*raw_prepend*]            - A single string, or an array of strings to\n     34: #     prepend to the server directive (after cfg prepend directives). NOTE:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sbadia@puppet-gitlab-manifests-ci-setup.pp", "content": "# solution, please see issue #114 if you have a better solution.", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-setup.pp\n\n\n# By default, puppet-rbenv sets ~/.profile to load rbenv, which is\n# read when bash is invoked as an interactive login shell, but we\n# also need ~/.bashrc to load rbenv (which is read by interactive\n# but non-login shells). This works, but may not be the best\n67:   # solution, please see issue #114 if you have a better solution.\nfile { \"${ci_home}/.bashrc\":\nensure  => file,\ncontent => \"source ${ci_home}/.rbenvrc\",\nrequire => Rbenv::Install[$ci_user],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-setup.pp\n# Target line: 67\n\n     62: \n     63:   # By default, puppet-rbenv sets ~/.profile to load rbenv, which is\n     64:   # read when bash is invoked as an interactive login shell, but we\n     65:   # also need ~/.bashrc to load rbenv (which is read by interactive\n     66:   # but non-login shells). This works, but may not be the best\n>>>  67:   # solution, please see issue #114 if you have a better solution.\n     68:   file { \"${ci_home}/.bashrc\":\n     69:     ensure  => file,\n     70:     content => \"source ${ci_home}/.rbenvrc\",\n     71:     require => Rbenv::Install[$ci_user],\n     72:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-psql.pp", "content": "# TODO: FIXME: shellquote does not work, and this regex works for trivial", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-psql.pp\n\n$user        = $postgresql::params::user\n) {\n\ninclude postgresql::params\n\n29:   # TODO: FIXME: shellquote does not work, and this regex works for trivial\n# things but not nested escaping.  Need a lexer, preferably a ruby SQL parser\n# to catch errors at catalog time.  Possibly https://github.com/omghax/sql ?\n\nif ($postgresql::params::version != '8.1') {\n$no_password_option = '--no-password'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-psql.pp\n# Target line: 29\n\n     24:     $user        = $postgresql::params::user\n     25: ) {\n     26: \n     27:   include postgresql::params\n     28: \n>>>  29:   # TODO: FIXME: shellquote does not work, and this regex works for trivial\n     30:   # things but not nested escaping.  Need a lexer, preferably a ruby SQL parser\n     31:   # to catch errors at catalog time.  Possibly https://github.com/omghax/sql ?\n     32: \n     33:   if ($postgresql::params::version != '8.1') {\n     34:     $no_password_option = '--no-password'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-config.pp", "content": "# == Definition: postfix::config", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n\n#\n2: # == Definition: postfix::config\n#\n# Uses Augeas to add/alter/remove options in postfix main\n# configuation file (/etc/postfix/main.cf).\n#\n# TODO: make this a type with an Augeas and a postconf providers.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n# Target line: 2\n\n      1: #\n>>>   2: # == Definition: postfix::config\n      3: #\n      4: # Uses Augeas to add/alter/remove options in postfix main\n      5: # configuation file (/etc/postfix/main.cf).\n      6: #\n      7: # TODO: make this a type with an Augeas and a postconf providers.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-astute.pp", "content": "# FIXME(dteselkin): use correct versions of rubygem packages", "line": 90, "detection_span": [85, 95], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-astute.pp\n\nowner  => 'root',\ngroup  => 'root',\nmode   => '0755',\n}\n\n90:   # FIXME(dteselkin): use correct versions of rubygem packages\nexec {'use correct versions of rubygem packages':\ncommand => '/usr/bin/sed -i \"/amq-protocol/ s/~>/>=/\" /usr/share/gems/specifications/amqp-*.gemspec',\nrequire => Package[$packages],\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-astute.pp\n# Target line: 90\n\n     85:     owner  => 'root',\n     86:     group  => 'root',\n     87:     mode   => '0755',\n     88:   }\n     89: \n>>>  90:   # FIXME(dteselkin): use correct versions of rubygem packages\n     91:   exec {'use correct versions of rubygem packages':\n     92:     command => '/usr/bin/sed -i \"/amq-protocol/ s/~>/>=/\" /usr/share/gems/specifications/amqp-*.gemspec',\n     93:     require => Package[$packages],\n     94:   }\n     95: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp", "content": "# This define creates a basic todo file that simply contains informations", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n\n# Define puppi::todo\n#\n3: # This define creates a basic todo file that simply contains informations\n# on how to complete tasks that for time or other reasons could not be\n# entirely automated by Puppet.\n# The basic idea is to have a quick way to document and check if are completed\n# some specific operations that are required to bring a new, puppettized system\n# to full operative status.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n# Target line: 3\n\n      1: # Define puppi::todo\n      2: #\n>>>   3: # This define creates a basic todo file that simply contains informations\n      4: # on how to complete tasks that for time or other reasons could not be\n      5: # entirely automated by Puppet.\n      6: # The basic idea is to have a quick way to document and check if are completed\n      7: # some specific operations that are required to bring a new, puppettized system\n      8: # to full operative status.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-gnocchi-manifests-storage-s3.pp", "content": "#   (optional) S3 bucket prefix for gnocchi", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack@puppet-gnocchi-manifests-storage-s3.pp\n\n# [*s3_secret_access_key*]\n#   (optional) S3 storage secret access key.\n#   Defaults to undef\n#\n# [*s3_bucket_prefix*]\n25: #   (optional) S3 bucket prefix for gnocchi\n#   Defaults to undef\n#\nclass gnocchi::storage::s3(\n$s3_endpoint_url      = $::os_service_default,\n$s3_region_name       = $::os_service_default,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-gnocchi-manifests-storage-s3.pp\n# Target line: 25\n\n     20: # [*s3_secret_access_key*]\n     21: #   (optional) S3 storage secret access key.\n     22: #   Defaults to undef\n     23: #\n     24: # [*s3_bucket_prefix*]\n>>>  25: #   (optional) S3 bucket prefix for gnocchi\n     26: #   Defaults to undef\n     27: #\n     28: class gnocchi::storage::s3(\n     29:   $s3_endpoint_url      = $::os_service_default,\n     30:   $s3_region_name       = $::os_service_default,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod-php.pp", "content": "# Controls php version and libphp prefix", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n\n$_php_major = regsubst($php_version, '^(\\d+)\\..*$', '\\1')\n$_php_version_no_dot = regsubst($php_version, '\\.', '')\nif $apache::version::scl_httpd_version {\n$_lib = \"librh-php${_php_version_no_dot}-php${_php_major}.so\"\n} else {\n61:     # Controls php version and libphp prefix\n$_lib = \"${libphp_prefix}${php_version}.so\"\n}\n\nif $::operatingsystem == 'SLES' {\n::apache::mod { $mod:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n# Target line: 61\n\n     56:   $_php_major = regsubst($php_version, '^(\\d+)\\..*$', '\\1')\n     57:   $_php_version_no_dot = regsubst($php_version, '\\.', '')\n     58:   if $apache::version::scl_httpd_version {\n     59:     $_lib = \"librh-php${_php_version_no_dot}-php${_php_major}.so\"\n     60:   } else {\n>>>  61:     # Controls php version and libphp prefix\n     62:     $_lib = \"${libphp_prefix}${php_version}.so\"\n     63:   }\n     64: \n     65:   if $::operatingsystem == 'SLES' {\n     66:     ::apache::mod { $mod:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack-infra@puppet-jenkins-manifests-job_builder.pp", "content": "#       at some point, but that still has some problems.", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n\nPackage['python-yaml'],\n],\n}\n\n# TODO: We should put in  notify Exec['jenkins_jobs_update']\n86: #       at some point, but that still has some problems.\nfile { '/etc/jenkins_jobs/jenkins_jobs.ini':\nensure  => present,\nmode    => '0400',\ncontent => template('jenkins/jenkins_jobs.ini.erb'),\nrequire => File['/etc/jenkins_jobs'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n# Target line: 86\n\n     81:       Package['python-yaml'],\n     82:     ],\n     83:   }\n     84: \n     85: # TODO: We should put in  notify Exec['jenkins_jobs_update']\n>>>  86: #       at some point, but that still has some problems.\n     87:   file { '/etc/jenkins_jobs/jenkins_jobs.ini':\n     88:     ensure  => present,\n     89:     mode    => '0400',\n     90:     content => template('jenkins/jenkins_jobs.ini.erb'),\n     91:     require => File['/etc/jenkins_jobs'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-puppet-manifests-package.pp", "content": "# Install packages for Puppet and various fixups that we require.", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-package.pp\n\n# == Class: puppet::package\n#\n3: # Install packages for Puppet and various fixups that we require.\n#\nclass puppet::package (\n$facter_version = '2.0.2-1puppetlabs1',\n$hiera_version = '1.3.4-1puppetlabs1',\n$puppet_version = '3.8.5-1puppetlabs1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-package.pp\n# Target line: 3\n\n      1: # == Class: puppet::package\n      2: #\n>>>   3: # Install packages for Puppet and various fixups that we require.\n      4: #\n      5: class puppet::package (\n      6:   $facter_version = '2.0.2-1puppetlabs1',\n      7:   $hiera_version = '1.3.4-1puppetlabs1',\n      8:   $puppet_version = '3.8.5-1puppetlabs1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Icinga@puppet-icinga2-manifests-feature-debuglog.pp", "content": "#   /var/log/icinga2/debug.log on Linux", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-feature-debuglog.pp\n\n# [*ensure*]\n#   Set to present enables the feature mainlog, absent disables it. Defaults to present.\n#\n# [*path*]\n#   Absolute path to the log file. Default depends on platform:\n12: #   /var/log/icinga2/debug.log on Linux\n#   C:/ProgramData/icinga2/var/log/icinga2/debug.log on Windows\n#\n#\nclass icinga2::feature::debuglog(\nEnum['absent', 'present'] $ensure   = present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-feature-debuglog.pp\n# Target line: 12\n\n      7: # [*ensure*]\n      8: #   Set to present enables the feature mainlog, absent disables it. Defaults to present.\n      9: #\n     10: # [*path*]\n     11: #   Absolute path to the log file. Default depends on platform:\n>>>  12: #   /var/log/icinga2/debug.log on Linux\n     13: #   C:/ProgramData/icinga2/var/log/icinga2/debug.log on Windows\n     14: #\n     15: #\n     16: class icinga2::feature::debuglog(\n     17:   Enum['absent', 'present'] $ensure   = present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-cluster-zookeeper.pp", "content": "# TODO: Remove comments below once we can guarantee that all the distros", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n\n$zookeeper_server_ips,\n$zookeeper_client_ip,\n$zookeeper_hostnames\n)\n{\n42:   # TODO: Remove comments below once we can guarantee that all the distros\n# deploying TripleO use Puppet > 3.7 because of this bug:\n# https://tickets.puppetlabs.com/browse/PUP-1299\n\n# validate_array($zookeeper_server_ips)\nvalidate_ipv4_address($zookeeper_client_ip)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n# Target line: 42\n\n     37:   $zookeeper_server_ips,\n     38:   $zookeeper_client_ip,\n     39:   $zookeeper_hostnames\n     40: )\n     41: {\n>>>  42:   # TODO: Remove comments below once we can guarantee that all the distros\n     43:   # deploying TripleO use Puppet > 3.7 because of this bug:\n     44:   # https://tickets.puppetlabs.com/browse/PUP-1299\n     45: \n     46:   # validate_array($zookeeper_server_ips)\n     47:   validate_ipv4_address($zookeeper_client_ip)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-upgrade_kernel.pp", "content": "# TODO: Document the function", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-upgrade_kernel.pp\n\n1: # TODO: Document the function\n\ndefine contrail::lib::upgrade_kernel(\n$contrail_kernel_upgrade,\n$contrail_kernel_version_to_upgrade = $::contrail::params::contrail_dist_kernel_version,\n$contrail_logoutput = false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-upgrade_kernel.pp\n# Target line: 1\n\n>>>   1: # TODO: Document the function\n      2: \n      3: define contrail::lib::upgrade_kernel(\n      4:     $contrail_kernel_upgrade,\n      5:     $contrail_kernel_version_to_upgrade = $::contrail::params::contrail_dist_kernel_version,\n      6:     $contrail_logoutput = false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-fuel-examples-cobbler.pp", "content": "# TODO(mmalchuk): the right way with updated loadyaml function", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-examples-cobbler.pp\n\n$dns_domain                  = $::fuel_settings['DNS_DOMAIN']\n$dns_search                  = $::fuel_settings['DNS_SEARCH']\n$dns_upstream                = split($::fuel_settings['DNS_UPSTREAM'], ',')\n$cobbler_host                = $::fuel_settings['ADMIN_NETWORK']['ipaddress']\n\n17: # TODO(mmalchuk): the right way with updated loadyaml function\n# $bootstrap_meta = loadyaml(\"${bootstrap_path}/metadata.yaml\", {})\n# and remove if else block\n$metadata_yaml = file(\"${bootstrap_path}/metadata.yaml\", '/dev/null')\nif empty($metadata_yaml) {\n$bootstrap_meta = {}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-examples-cobbler.pp\n# Target line: 17\n\n     12: $dns_domain                  = $::fuel_settings['DNS_DOMAIN']\n     13: $dns_search                  = $::fuel_settings['DNS_SEARCH']\n     14: $dns_upstream                = split($::fuel_settings['DNS_UPSTREAM'], ',')\n     15: $cobbler_host                = $::fuel_settings['ADMIN_NETWORK']['ipaddress']\n     16: \n>>>  17: # TODO(mmalchuk): the right way with updated loadyaml function\n     18: # $bootstrap_meta = loadyaml(\"${bootstrap_path}/metadata.yaml\", {})\n     19: # and remove if else block\n     20: $metadata_yaml = file(\"${bootstrap_path}/metadata.yaml\", '/dev/null')\n     21: if empty($metadata_yaml) {\n     22:   $bootstrap_meta = {}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-apache-manifests-mod.pp", "content": "$mod_package = $mod_packages[$mod] # 2.6 compatibility hack", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod.pp\n\n$_id = \"${mod}_module\"\n}\n\n# Determine if we have a package\n$mod_packages = $::apache::params::mod_packages\n43:   $mod_package = $mod_packages[$mod] # 2.6 compatibility hack\nif $package {\n$_package = $package\n} elsif $mod_package {\n$_package = $mod_package\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod.pp\n# Target line: 43\n\n     38:     $_id = \"${mod}_module\"\n     39:   }\n     40: \n     41:   # Determine if we have a package\n     42:   $mod_packages = $::apache::params::mod_packages\n>>>  43:   $mod_package = $mod_packages[$mod] # 2.6 compatibility hack\n     44:   if $package {\n     45:     $_package = $package\n     46:   } elsif $mod_package {\n     47:     $_package = $mod_package\n     48:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp", "content": "# Also output to a file for handy debugging", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n\n$outputs = [\n# Output to Kafka.  All messages will produced to topics prefixed\n# with a datacenter name.\n# In mediawiki-vagrant this defaults to 'datacenter1'.\n'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n40:         # Also output to a file for handy debugging\n'file:///vagrant/logs/eventbus.log',\n]\neventlogging::service { 'eventbus':\nport         => 8085,\nschemas_path => \"${::eventschemas::path}/jsonschema\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n# Target line: 40\n\n     35:     $outputs = [\n     36:         # Output to Kafka.  All messages will produced to topics prefixed\n     37:         # with a datacenter name.\n     38:         # In mediawiki-vagrant this defaults to 'datacenter1'.\n     39:         'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n>>>  40:         # Also output to a file for handy debugging\n     41:         'file:///vagrant/logs/eventbus.log',\n     42:     ]\n     43:     eventlogging::service { 'eventbus':\n     44:         port         => 8085,\n     45:         schemas_path => \"${::eventschemas::path}/jsonschema\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp", "content": "# /FIXME.", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n\n$logstash_beats_ssl_key,\n# FIXME: deprecated, to be removed when Lumberjack will get replaced by Filebeat.\n$logstash_ssl_ca               = undef,\n$logstash_ssl_certificate      = undef,\n$logstash_ssl_key              = undef,\n15:   # /FIXME.\n$nginx_ssl_elastic_certificate = undef,\n$nginx_ssl_elastic_key         = undef,\n$nginx_ssl_kibana_certificate  = undef,\n$nginx_ssl_kibana_key          = undef,\n) { }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n# Target line: 15\n\n     10:   $logstash_beats_ssl_key,\n     11:   # FIXME: deprecated, to be removed when Lumberjack will get replaced by Filebeat.\n     12:   $logstash_ssl_ca               = undef,\n     13:   $logstash_ssl_certificate      = undef,\n     14:   $logstash_ssl_key              = undef,\n>>>  15:   # /FIXME.\n     16:   $nginx_ssl_elastic_certificate = undef,\n     17:   $nginx_ssl_elastic_key         = undef,\n     18:   $nginx_ssl_kibana_certificate  = undef,\n     19:   $nginx_ssl_kibana_key          = undef,\n     20:   ) { }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-buggy.pp", "content": "# == Class: role::buggy", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-buggy.pp\n\n1: # == Class: role::buggy\n# Buggy extension - an extension that generates bugs.\n#\nclass role::buggy {\nmediawiki::extension { 'Buggy': }\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-buggy.pp\n# Target line: 1\n\n>>>   1: # == Class: role::buggy\n      2: # Buggy extension - an extension that generates bugs.\n      3: #\n      4: class role::buggy {\n      5:     mediawiki::extension { 'Buggy': }\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-cluster-manifests-neutron-dhcp.pp", "content": "#TODO (bogdando) move to extras ha wrappers", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-neutron-dhcp.pp\n\n$dhcp_agent_package = $::neutron::params::dhcp_agent_package ? {\nfalse   => $::neutron::params::package_name,\ndefault => $::neutron::params::dhcp_agent_package\n}\n\n25:   #TODO (bogdando) move to extras ha wrappers\ncluster::corosync::cs_service {'dhcp':\nocf_script      => 'neutron-dhcp-agent',\ncsr_parameters  => {\n'plugin_config'                  => $plugin_config,\n'remove_artifacts_on_stop_start' => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-neutron-dhcp.pp\n# Target line: 25\n\n     20:   $dhcp_agent_package = $::neutron::params::dhcp_agent_package ? {\n     21:     false   => $::neutron::params::package_name,\n     22:     default => $::neutron::params::dhcp_agent_package\n     23:   }\n     24: \n>>>  25:   #TODO (bogdando) move to extras ha wrappers\n     26:   cluster::corosync::cs_service {'dhcp':\n     27:     ocf_script      => 'neutron-dhcp-agent',\n     28:     csr_parameters  => {\n     29:       'plugin_config'                  => $plugin_config,\n     30:       'remove_artifacts_on_stop_start' => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@puppet-cdh-manifests-hadoop-directory.pp", "content": "#                 gets a ticket for the service principal via a keytab. This", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-directory.pp\n\n# $owner        - HDFS directory owner. Default: hdfs\n# $group        - HDFS directory group owner. Default: hdfs\n# $mode         - HDFS directory mode. Default 0755\n# $use_kerberos - Configure whether Secure HDFS is used or not. Default: false\n#                 If $use_kerberos is enabled, a wrapper is launched which\n31: #                 gets a ticket for the service principal via a keytab. This\n#                 wrapper is not part of the cdh module, but can be found at\n#                 https://github.com/wikimedia/puppet/modules/kerberos.\n#\ndefine cdh::hadoop::directory (\n$path         = $title,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-directory.pp\n# Target line: 31\n\n     26: # $owner        - HDFS directory owner. Default: hdfs\n     27: # $group        - HDFS directory group owner. Default: hdfs\n     28: # $mode         - HDFS directory mode. Default 0755\n     29: # $use_kerberos - Configure whether Secure HDFS is used or not. Default: false\n     30: #                 If $use_kerberos is enabled, a wrapper is launched which\n>>>  31: #                 gets a ticket for the service principal via a keytab. This\n     32: #                 wrapper is not part of the cdh module, but can be found at\n     33: #                 https://github.com/wikimedia/puppet/modules/kerberos.\n     34: #\n     35: define cdh::hadoop::directory (\n     36:     $path         = $title,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-config.pp", "content": "# Uses Augeas to add/alter/remove options in postfix main", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n\n#\n# == Definition: postfix::config\n#\n4: # Uses Augeas to add/alter/remove options in postfix main\n# configuation file (/etc/postfix/main.cf).\n#\n# TODO: make this a type with an Augeas and a postconf providers.\n#\n# === Parameters", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n# Target line: 4\n\n      1: #\n      2: # == Definition: postfix::config\n      3: #\n>>>   4: # Uses Augeas to add/alter/remove options in postfix main\n      5: # configuation file (/etc/postfix/main.cf).\n      6: #\n      7: # TODO: make this a type with an Augeas and a postconf providers.\n      8: #\n      9: # === Parameters\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#    postfix::config { \"canonical_alias_maps\":", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#    include postfix\n#\n#    postfix::hash { \"/etc/postfix/recipient_canonical\":\n#      ensure => present,\n#    }\n25: #    postfix::config { \"canonical_alias_maps\":\n#      value => \"hash:/etc/postfix/recipient_canonical\"\n#    }\n#    postfix::canonical {\n#      \"user@example.com\":\n#        file        => \"/etc/postfix/recipient_canonical\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 25\n\n     20: #    include postfix\n     21: #\n     22: #    postfix::hash { \"/etc/postfix/recipient_canonical\":\n     23: #      ensure => present,\n     24: #    }\n>>>  25: #    postfix::config { \"canonical_alias_maps\":\n     26: #      value => \"hash:/etc/postfix/recipient_canonical\"\n     27: #    }\n     28: #    postfix::canonical {\n     29: #      \"user@example.com\":\n     30: #        file        => \"/etc/postfix/recipient_canonical\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "jippi@puppet-php-manifests-extension-xdebug.pp", "content": "# == Class: php::extension::xdebug", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n\n1: # == Class: php::extension::xdebug\n#\n# Install and configure the xdebug PHP extension\n#\n# === Parameters\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n# Target line: 1\n\n>>>   1: # == Class: php::extension::xdebug\n      2: #\n      3: # Install and configure the xdebug PHP extension\n      4: #\n      5: # === Parameters\n      6: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Yelp@puppet-cron-manifests-job.pp", "content": "# that is its \"ticket\" to exist.  If a job is present without a ticket,", "line": 80, "detection_span": [75, 85], "with_context": "# Puppet file: Yelp@puppet-cron-manifests-job.pp\n\n# 1) Use symlinks anyway, and do 'initctl reload-configuration' a\n# bunch.\n# 2) Create the jobs as regular files, and find some other way to purge\n# them.\n# We've opted for #2, so each job is associated with a marker file\n80:   # that is its \"ticket\" to exist.  If a job is present without a ticket,\n# a cleanup job is programmed to remove it.\nfile { $job_ticket:\nensure  => 'file',\n} ->\nfile { $job_file:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Yelp@puppet-cron-manifests-job.pp\n# Target line: 80\n\n     75:   # 1) Use symlinks anyway, and do 'initctl reload-configuration' a\n     76:   # bunch.\n     77:   # 2) Create the jobs as regular files, and find some other way to purge\n     78:   # them.\n     79:   # We've opted for #2, so each job is associated with a marker file\n>>>  80:   # that is its \"ticket\" to exist.  If a job is present without a ticket,\n     81:   # a cleanup job is programmed to remove it.\n     82:   file { $job_ticket:\n     83:     ensure  => 'file',\n     84:   } ->\n     85:   file { $job_file:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-puppetdb-manifests-master-config.pp", "content": "# **WARNING**: Ugly hack to work around a yum bug with metadata parsing. This", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-master-config.pp\n\n$puppetdb_startup_timeout    = $puppetdb::params::puppetdb_startup_timeout,\n$test_url                    = $puppetdb::params::test_url,\n$restart_puppet              = true,\n) inherits puppetdb::params {\n\n33:   # **WARNING**: Ugly hack to work around a yum bug with metadata parsing. This\n# should not be copied, replicated or even looked at. In short, never rename\n# your packages...\n#\n# With `yum` we can't have the termini package override the terminus package\n# because that would prevent users from installing v2.3 of the terminus in", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-master-config.pp\n# Target line: 33\n\n     28:   $puppetdb_startup_timeout    = $puppetdb::params::puppetdb_startup_timeout,\n     29:   $test_url                    = $puppetdb::params::test_url,\n     30:   $restart_puppet              = true,\n     31: ) inherits puppetdb::params {\n     32: \n>>>  33:   # **WARNING**: Ugly hack to work around a yum bug with metadata parsing. This\n     34:   # should not be copied, replicated or even looked at. In short, never rename\n     35:   # your packages...\n     36:   #\n     37:   # With `yum` we can't have the termini package override the terminus package\n     38:   # because that would prevent users from installing v2.3 of the terminus in\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod-jk.pp", "content": "# Ensure that we are not using variables with the typo fixed by MODULES-6225", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-jk.pp\n\n# Provides important variables\ninclude ::apache\n# Manages basic module config\n::apache::mod { 'jk': }\n\n70:   # Ensure that we are not using variables with the typo fixed by MODULES-6225\n# anymore:\nif !empty($workers_file_content) and has_key($workers_file_content, 'worker_mantain') {\nfail('Please replace $workers_file_content[\\'worker_mantain\\'] by $workers_file_content[\\'worker_maintain\\']. See MODULES-6225 for details.')\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-jk.pp\n# Target line: 70\n\n     65:   # Provides important variables\n     66:   include ::apache\n     67:   # Manages basic module config\n     68:   ::apache::mod { 'jk': }\n     69: \n>>>  70:   # Ensure that we are not using variables with the typo fixed by MODULES-6225\n     71:   # anymore:\n     72:   if !empty($workers_file_content) and has_key($workers_file_content, 'worker_mantain') {\n     73:     fail('Please replace $workers_file_content[\\'worker_mantain\\'] by $workers_file_content[\\'worker_maintain\\']. See MODULES-6225 for details.')\n     74:   }\n     75: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-router-manifests-errorpage.pp", "content": "# To solve this we want router to try to get the templates from static", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n\n$filename = \"/usr/share/nginx/www/${title}.html\"\n\n$static_url = \"https://static.${app_domain}/templates/${title}.html.erb\"\n\n# We're dealing with a chicken and egg problem when building gov.uk here, static is not up before router, and router needs static for its error pages templates\n16: # To solve this we want router to try to get the templates from static\n# If that fails : keep the templates it has\n# If that fails and it has no templates: we generate basic tamplates for it.\n$cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n\nexec { \"update_error_page_${title}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n# Target line: 16\n\n     11:   $filename = \"/usr/share/nginx/www/${title}.html\"\n     12: \n     13:   $static_url = \"https://static.${app_domain}/templates/${title}.html.erb\"\n     14: \n     15: # We're dealing with a chicken and egg problem when building gov.uk here, static is not up before router, and router needs static for its error pages templates\n>>>  16: # To solve this we want router to try to get the templates from static\n     17: # If that fails : keep the templates it has\n     18: # If that fails and it has no templates: we generate basic tamplates for it.\n     19:   $cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n     20: \n     21:   exec { \"update_error_page_${title}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "theforeman@foreman-installer-staypuft-modules-network-manifests-global.pp", "content": "# === TODO:", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: theforeman@foreman-installer-staypuft-modules-network-manifests-global.pp\n\n#     nisdomain  => 'domain.tld',\n#     vlan       => 'yes',\n#     nozeroconf => 'yes',\n#   }\n#\n42: # === TODO:\n#\n#   NETWORKING_IPV6=yes|no\n#\n# === Authors:\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@foreman-installer-staypuft-modules-network-manifests-global.pp\n# Target line: 42\n\n     37: #     nisdomain  => 'domain.tld',\n     38: #     vlan       => 'yes',\n     39: #     nozeroconf => 'yes',\n     40: #   }\n     41: #\n>>>  42: # === TODO:\n     43: #\n     44: #   NETWORKING_IPV6=yes|no\n     45: #\n     46: # === Authors:\n     47: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpbugmanage.pp", "content": "# Class fuel_project::devops_tools::lpbugmanage", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpbugmanage.pp\n\n1: # Class fuel_project::devops_tools::lpbugmanage\n#\n# This class deploys lpbugmanage package and it's configuration.\n#\n# Parameters:\n#   [*id*] - unique ID used in config file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpbugmanage.pp\n# Target line: 1\n\n>>>   1: # Class fuel_project::devops_tools::lpbugmanage\n      2: #\n      3: # This class deploys lpbugmanage package and it's configuration.\n      4: #\n      5: # Parameters:\n      6: #   [*id*] - unique ID used in config file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-fixtures-scenario002.pp", "content": "# FIXME(ykarel) Disable SSL until services are ready to work with SSL + Python3", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: openstack@puppet-openstack-integration-fixtures-scenario002.pp\n\n}\n}\n\nif ($::os['name'] == 'Ubuntu') or ($::os['name'] == 'Fedora') or\n($::os['family'] == 'RedHat' and Integer.new($::os['release']['major']) > 7) {\n41:   # FIXME(ykarel) Disable SSL until services are ready to work with SSL + Python3\n$ssl = false\n} else {\n$ssl = true\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-fixtures-scenario002.pp\n# Target line: 41\n\n     36:   }\n     37: }\n     38: \n     39: if ($::os['name'] == 'Ubuntu') or ($::os['name'] == 'Fedora') or\n     40:   ($::os['family'] == 'RedHat' and Integer.new($::os['release']['major']) > 7) {\n>>>  41:   # FIXME(ykarel) Disable SSL until services are ready to work with SSL + Python3\n     42:   $ssl = false\n     43: } else {\n     44:   $ssl = true\n     45: }\n     46: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-enable_kernel_core.pp", "content": "# enable kernel core , below python code has bug, for now ignore by executing echo regardless and thus returning true for cmd.", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-enable_kernel_core.pp\n\nmode   => '0755',\nowner  => root,\ngroup  => root,\nsource => \"puppet:///modules/${module_name}/enable_kernel_core.py\"\n}\n11:     # enable kernel core , below python code has bug, for now ignore by executing echo regardless and thus returning true for cmd.\n# need to revisit afterwards.\n\nif ($::operatingsystem == 'Ubuntu') {\npackage { 'linux-crashdump' : ensure => present,}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-enable_kernel_core.pp\n# Target line: 11\n\n      6:         mode   => '0755',\n      7:         owner  => root,\n      8:         group  => root,\n      9:         source => \"puppet:///modules/${module_name}/enable_kernel_core.py\"\n     10:     }\n>>>  11:     # enable kernel core , below python code has bug, for now ignore by executing echo regardless and thus returning true for cmd.\n     12:     # need to revisit afterwards.\n     13: \n     14:     if ($::operatingsystem == 'Ubuntu') {\n     15:         package { 'linux-crashdump' : ensure => present,}\n     16:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-virtual.pp", "content": "#     postfix::virtual { \"user@example.com\":", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n\n#       ensure => present,\n#     }\n#     postfix::config { \"virtual_alias_maps\":\n#       value => \"hash:/etc/postfix/virtual\"\n#     }\n30: #     postfix::virtual { \"user@example.com\":\n#       ensure      => present,\n#       destination => ['root', 'postmaster'],\n#     }\n#   }\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n# Target line: 30\n\n     25: #       ensure => present,\n     26: #     }\n     27: #     postfix::config { \"virtual_alias_maps\":\n     28: #       value => \"hash:/etc/postfix/virtual\"\n     29: #     }\n>>>  30: #     postfix::virtual { \"user@example.com\":\n     31: #       ensure      => present,\n     32: #       destination => ['root', 'postmaster'],\n     33: #     }\n     34: #   }\n     35: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Icinga@puppet-icinga2-manifests-object.pp", "content": "#   Set object_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-object.pp\n\n# [*apply*]\n#   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n#   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n#\n# [*prefix*]\n22: #   Set object_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n#\n# [*apply_target*]\n#   Optional for an object type on which to target the apply rule. Valid values are `Host` and `Service`.\n#\n# [*import*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-object.pp\n# Target line: 22\n\n     17: # [*apply*]\n     18: #   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n     19: #   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n     20: #\n     21: # [*prefix*]\n>>>  22: #   Set object_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n     23: #\n     24: # [*apply_target*]\n     25: #   Optional for an object type on which to target the apply rule. Valid values are `Host` and `Service`.\n     26: #\n     27: # [*import*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-vulnerabilities-unix-ftp-proftpd_133c_backdoor-manifests-install.pp", "content": "command => '/usr/local/src/backdoored_proftpd-1.3.3c/configure', #--prefix=/usr/local/", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ftp-proftpd_133c_backdoor-manifests-install.pp\n\nnotify  => Exec['install_proftpd-1.3.3c'],\n}\n\nexec { 'install_proftpd-1.3.3c':\ncwd     => '/usr/local/src/backdoored_proftpd-1.3.3c/',\n24:     command => '/usr/local/src/backdoored_proftpd-1.3.3c/configure', #--prefix=/usr/local/\nnotify  => Exec['make_proftpd-1.3.3c'],\n}\n\nexec { 'make_proftpd-1.3.3c':\nrequire     => Exec['install_proftpd-1.3.3c'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ftp-proftpd_133c_backdoor-manifests-install.pp\n# Target line: 24\n\n     19:     notify  => Exec['install_proftpd-1.3.3c'],\n     20:   }\n     21: \n     22:   exec { 'install_proftpd-1.3.3c':\n     23:     cwd     => '/usr/local/src/backdoored_proftpd-1.3.3c/',\n>>>  24:     command => '/usr/local/src/backdoored_proftpd-1.3.3c/configure', #--prefix=/usr/local/\n     25:     notify  => Exec['make_proftpd-1.3.3c'],\n     26:   }\n     27: \n     28:   exec { 'make_proftpd-1.3.3c':\n     29:     require     => Exec['install_proftpd-1.3.3c'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wazuh@ossec-puppet-manifests-repo.pp", "content": "# apt-key added by issue #34", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: wazuh@ossec-puppet-manifests-repo.pp\n\nrequire => File['/usr/src/ossec']\n}\n\ncase $::osfamily {\n'Debian' : {\n29:       # apt-key added by issue #34\napt::key { 'puppetlabs':\nid     => '9FE55537D1713CA519DFB85114B9C8DB9A1B1C65',\nsource => 'https://ossec.wazuh.com/repos/apt/conf/ossec-key.gpg.key',\nserver => 'pgp.mit.edu'\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wazuh@ossec-puppet-manifests-repo.pp\n# Target line: 29\n\n     24:     require => File['/usr/src/ossec']\n     25:   }\n     26: \n     27:   case $::osfamily {\n     28:     'Debian' : {\n>>>  29:       # apt-key added by issue #34\n     30:       apt::key { 'puppetlabs':\n     31:         id     => '9FE55537D1713CA519DFB85114B9C8DB9A1B1C65',\n     32:         source => 'https://ossec.wazuh.com/repos/apt/conf/ossec-key.gpg.key',\n     33:         server => 'pgp.mit.edu'\n     34:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-mongodb-manifests-server.pp", "content": "#   Version of mongodb. Should resolve to 2.6", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-server.pp\n\n# Setup a MongoDB server.\n#\n# === Parameters:\n#\n# [*version*]\n8: #   Version of mongodb. Should resolve to 2.6\n#\n# [*dbpath*]\n#   Path to database on filesystem\n#\n# [*oplog_size*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-server.pp\n# Target line: 8\n\n      3: # Setup a MongoDB server.\n      4: #\n      5: # === Parameters:\n      6: #\n      7: # [*version*]\n>>>   8: #   Version of mongodb. Should resolve to 2.6\n      9: #\n     10: # [*dbpath*]\n     11: #   Path to database on filesystem\n     12: #\n     13: # [*oplog_size*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-virtual.pp", "content": "# [*name*]        - name of address postfix will lookup. See virtual(8).", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n\n#\n# Manages content of the /etc/postfix/virtual map.\n#\n# === Parameters\n#\n7: # [*name*]        - name of address postfix will lookup. See virtual(8).\n# [*destination*] - a list of destinations where the emails will be delivered to. See virtual(8).\n# [*ensure*]      - present/absent, defaults to present.\n# [*file*]        - a string defining the location of the pre-hash map.\n#\n# === Requires", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n# Target line: 7\n\n      2: #\n      3: # Manages content of the /etc/postfix/virtual map.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # [*name*]        - name of address postfix will lookup. See virtual(8).\n      8: # [*destination*] - a list of destinations where the emails will be delivered to. See virtual(8).\n      9: # [*ensure*]      - present/absent, defaults to present.\n     10: # [*file*]        - a string defining the location of the pre-hash map.\n     11: #\n     12: # === Requires\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-contrail_setup_interface.pp", "content": "#TODO: Document the class", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-contrail_setup_interface.pp\n\n1: #TODO: Document the class\ndefine contrail::lib::contrail_setup_interface(\n$contrail_device,\n$contrail_members,\n$contrail_bond_opts,\n$contrail_ip,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-contrail_setup_interface.pp\n# Target line: 1\n\n>>>   1: #TODO: Document the class\n      2: define contrail::lib::contrail_setup_interface(\n      3:   $contrail_device,\n      4:   $contrail_members,\n      5:   $contrail_bond_opts,\n      6:   $contrail_ip,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-cassandra-manifests-datastax.pp", "content": "# This is a bit of a hack to work around puppet dependency cycles that are", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-cassandra-manifests-datastax.pp\n\n# == Class: cassandra::datastax\n#\n# Add the datastax apt repo\n#\n5: # This is a bit of a hack to work around puppet dependency cycles that are\n# created when apt::repository and require_package are used in the same\n# manifest. That ends up making a circular dep on Exec['apt-get update'].\n#\nclass cassandra::datastax {\napt::repository { 'datastax':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-cassandra-manifests-datastax.pp\n# Target line: 5\n\n      1: # == Class: cassandra::datastax\n      2: #\n      3: # Add the datastax apt repo\n      4: #\n>>>   5: # This is a bit of a hack to work around puppet dependency cycles that are\n      6: # created when apt::repository and require_package are used in the same\n      7: # manifest. That ends up making a circular dep on Exec['apt-get update'].\n      8: #\n      9: class cassandra::datastax {\n     10:     apt::repository { 'datastax':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-repos.pp", "content": "# Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141", "line": 117, "detection_span": [112, 122], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n\n# NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n# that causes the puppet-openvswitch module to fail parsing the output.\n# This issue does not occur in integration testing but only beaker tests since some\n# other package (probably nova) causes this package to be installed, or the yum upgrade\n# part in integration catches it.\n117:     # Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141\npackage { 'libibverbs':\nensure => 'present',\n}\n121:   }\n122:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n# Target line: 117\n\n    112:     # NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n    113:     # that causes the puppet-openvswitch module to fail parsing the output.\n    114:     # This issue does not occur in integration testing but only beaker tests since some\n    115:     # other package (probably nova) causes this package to be installed, or the yum upgrade\n    116:     # part in integration catches it.\n>>> 117:     # Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141\n    118:     package { 'libibverbs':\n    119:       ensure => 'present',\n    120:     }\n    121:   }\n    122: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp", "content": "# FIXME: remove this vhost when we're no longer using the old domain anywhere", "line": 66, "detection_span": [61, 71], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n\nssl_key          => $ssl_key,\nindex_files      => [],\nadd_header       => {'Strict-Transport-Security' => '\"max-age=31536000\"'},\n}\n\n66:   # FIXME: remove this vhost when we're no longer using the old domain anywhere\nif $legacy_vhost != undef {\nnginx::resource::vhost { $legacy_vhost:\nproxy            => 'http://localhost:8080/',\nproxy_set_header => $::nginx::config::proxy_set_header, # Necessary until https://github.com/jfryman/puppet-nginx/pull/700 is released\nssl              => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n# Target line: 66\n\n     61:     ssl_key          => $ssl_key,\n     62:     index_files      => [],\n     63:     add_header       => {'Strict-Transport-Security' => '\"max-age=31536000\"'},\n     64:   }\n     65: \n>>>  66:   # FIXME: remove this vhost when we're no longer using the old domain anywhere\n     67:   if $legacy_vhost != undef {\n     68:     nginx::resource::vhost { $legacy_vhost:\n     69:       proxy            => 'http://localhost:8080/',\n     70:       proxy_set_header => $::nginx::config::proxy_set_header, # Necessary until https://github.com/jfryman/puppet-nginx/pull/700 is released\n     71:       ssl              => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-cluster-zookeeper.pp", "content": "# deploying TripleO use Puppet > 3.7 because of this bug:", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n\n$zookeeper_client_ip,\n$zookeeper_hostnames\n)\n{\n# TODO: Remove comments below once we can guarantee that all the distros\n43:   # deploying TripleO use Puppet > 3.7 because of this bug:\n# https://tickets.puppetlabs.com/browse/PUP-1299\n\n# validate_array($zookeeper_server_ips)\nvalidate_ipv4_address($zookeeper_client_ip)\n# validate_array($zookeeper_hostnames)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n# Target line: 43\n\n     38:   $zookeeper_client_ip,\n     39:   $zookeeper_hostnames\n     40: )\n     41: {\n     42:   # TODO: Remove comments below once we can guarantee that all the distros\n>>>  43:   # deploying TripleO use Puppet > 3.7 because of this bug:\n     44:   # https://tickets.puppetlabs.com/browse/PUP-1299\n     45: \n     46:   # validate_array($zookeeper_server_ips)\n     47:   validate_ipv4_address($zookeeper_client_ip)\n     48:   # validate_array($zookeeper_hostnames)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-rabbitmq-manifests-init.pp", "content": "validate_re($version, '^\\d+\\.\\d+\\.\\d+(-\\d+)*$') # Allow 3 digits and optional -n postfix.", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-rabbitmq-manifests-init.pp\n\nvalidate_string($package_ensure)\nvalidate_string($package_gpg_key)\nvalidate_string($package_name)\nvalidate_string($package_provider)\nvalidate_bool($manage_repos)\n65:   validate_re($version, '^\\d+\\.\\d+\\.\\d+(-\\d+)*$') # Allow 3 digits and optional -n postfix.\n# Validate config parameters.\nvalidate_array($cluster_disk_nodes)\nvalidate_re($cluster_node_type, '^(ram|disc)$')\nvalidate_array($cluster_nodes)\nvalidate_string($config)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-rabbitmq-manifests-init.pp\n# Target line: 65\n\n     60:   validate_string($package_ensure)\n     61:   validate_string($package_gpg_key)\n     62:   validate_string($package_name)\n     63:   validate_string($package_provider)\n     64:   validate_bool($manage_repos)\n>>>  65:   validate_re($version, '^\\d+\\.\\d+\\.\\d+(-\\d+)*$') # Allow 3 digits and optional -n postfix.\n     66:   # Validate config parameters.\n     67:   validate_array($cluster_disk_nodes)\n     68:   validate_re($cluster_node_type, '^(ram|disc)$')\n     69:   validate_array($cluster_nodes)\n     70:   validate_string($config)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "willdurand@puppet-nodejs-manifests-instance.pp", "content": "$node_version    = $source_filename # use custom file format as version infix for resource names", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: willdurand@puppet-nodejs-manifests-instance.pp\n\nfail(\"Unexpected state reached! Either \\$source or \\$version must not be undef!\")\n}\n\nif $source != undef {\n$source_filename = source_filename($source)\n51:     $node_version    = $source_filename # use custom file format as version infix for resource names\n} else {\n$node_version = $version\n}\n\n$node_unpack_folder = \"${install_dir}/node-${node_version}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: willdurand@puppet-nodejs-manifests-instance.pp\n# Target line: 51\n\n     46:     fail(\"Unexpected state reached! Either \\$source or \\$version must not be undef!\")\n     47:   }\n     48: \n     49:   if $source != undef {\n     50:     $source_filename = source_filename($source)\n>>>  51:     $node_version    = $source_filename # use custom file format as version infix for resource names\n     52:   } else {\n     53:     $node_version = $version\n     54:   }\n     55: \n     56:   $node_unpack_folder = \"${install_dir}/node-${node_version}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-neutron-manifests-logging.pp", "content": "# [*logging_exception_prefix*]", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-logging.pp\n\n# [*logging_debug_format_suffix*]\n#   (Optional) Additional data to append to log message when logging level for the message is DEBUG'\n#   Defaults to $::os_service_default\n#   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n#\n72: # [*logging_exception_prefix*]\n#   (Optional) Prefix each line of exception output with this format.\n#   Defaults to $::os_service_default\n#   Example: '%(asctime)s.%(msecs)03d %(process)d ERROR %(name)s %(instance)s'\n#\n# [*logging_user_identity_format*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-logging.pp\n# Target line: 72\n\n     67: # [*logging_debug_format_suffix*]\n     68: #   (Optional) Additional data to append to log message when logging level for the message is DEBUG'\n     69: #   Defaults to $::os_service_default\n     70: #   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n     71: #\n>>>  72: # [*logging_exception_prefix*]\n     73: #   (Optional) Prefix each line of exception output with this format.\n     74: #   Defaults to $::os_service_default\n     75: #   Example: '%(asctime)s.%(msecs)03d %(process)d ERROR %(name)s %(instance)s'\n     76: #\n     77: # [*logging_user_identity_format*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "biemond@biemond-wildfly-functions-patch_args.pp", "content": "# @param override_all Whether it should solve all conflicts by overriding current files.", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: biemond@biemond-wildfly-functions-patch_args.pp\n\n# Generate args for JBoss-CLI `patch` command.\n#\n# @param source path to patch file.\n4: # @param override_all Whether it should solve all conflicts by overriding current files.\n# @param override List of files to be overridden.\n# @param preserve List of files to be preserved.\n# @return [String] args for patch command.\nfunction wildfly::patch_args(\nStdlib::Unixpath $source,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-wildfly-functions-patch_args.pp\n# Target line: 4\n\n      1: # Generate args for JBoss-CLI `patch` command.\n      2: #\n      3: # @param source path to patch file.\n>>>   4: # @param override_all Whether it should solve all conflicts by overriding current files.\n      5: # @param override List of files to be overridden.\n      6: # @param preserve List of files to be preserved.\n      7: # @return [String] args for patch command.\n      8: function wildfly::patch_args(\n      9:   Stdlib::Unixpath $source,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-nmap.pp", "content": "# FIXME: Remove once deployed", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-nmap.pp\n\n#\n# Configures nmap, ready to be used by Jenkins jobs\n#\nclass ci_environment::jenkins_job_support::nmap (){\n\n7:   # FIXME: Remove once deployed\npackage { 'nmap':\nensure => purged,\n}\nfile { '/etc/sudoers.d/jenkins-nmap':\nensure  => absent,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-nmap.pp\n# Target line: 7\n\n      2: #\n      3: # Configures nmap, ready to be used by Jenkins jobs\n      4: #\n      5: class ci_environment::jenkins_job_support::nmap (){\n      6: \n>>>   7:   # FIXME: Remove once deployed\n      8:   package { 'nmap':\n      9:     ensure => purged,\n     10:   }\n     11:   file { '/etc/sudoers.d/jenkins-nmap':\n     12:     ensure  => absent,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-server.pp", "content": "$clients = []\t# list of allowed client ip's\t# TODO: get from exported resources", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n\n$baseport = '',\t# specify base port option as used in glusterd.vol file\n$rpcauthallowinsecure = false,\t# needed in some setups in glusterd.vol\n$shorewall = false,\n$zone = 'net',\t\t\t\t\t\t\t\t# TODO: allow a list of zones\n$ips = false,\t# an optional list of ip's for each in hosts[]\n30: \t$clients = []\t# list of allowed client ip's\t# TODO: get from exported resources\n) {\n$FW = '$FW'\t\t\t# make using $FW in shorewall easier\n\ninclude gluster::vardir\ninclude gluster::params", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n# Target line: 30\n\n     25: \t$baseport = '',\t# specify base port option as used in glusterd.vol file\n     26: \t$rpcauthallowinsecure = false,\t# needed in some setups in glusterd.vol\n     27: \t$shorewall = false,\n     28: \t$zone = 'net',\t\t\t\t\t\t\t\t# TODO: allow a list of zones\n     29: \t$ips = false,\t# an optional list of ip's for each in hosts[]\n>>>  30: \t$clients = []\t# list of allowed client ip's\t# TODO: get from exported resources\n     31: ) {\n     32: \t$FW = '$FW'\t\t\t# make using $FW in shorewall easier\n     33: \n     34: \tinclude gluster::vardir\n     35: \tinclude gluster::params\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-config-server-realm.pp", "content": "# https://github.com/hercules-team/augeas/issues/319", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-config-server-realm.pp\n\nfail('$realm_ensure must be set to \\'true\\' or \\'present\\' to use $purge_realms')\n}\n\nif $_purge_realms {\n# Perform deletions in reverse depth order as workaround for\n54:     # https://github.com/hercules-team/augeas/issues/319\n$__purge_realms = [\n'rm //Realm//Realm',\n'rm //Context//Realm',\n'rm //Host//Realm',\n'rm //Engine//Realm',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-config-server-realm.pp\n# Target line: 54\n\n     49:     fail('$realm_ensure must be set to \\'true\\' or \\'present\\' to use $purge_realms')\n     50:   }\n     51: \n     52:   if $_purge_realms {\n     53:     # Perform deletions in reverse depth order as workaround for\n>>>  54:     # https://github.com/hercules-team/augeas/issues/319\n     55:     $__purge_realms = [\n     56:       'rm //Realm//Realm',\n     57:       'rm //Context//Realm',\n     58:       'rm //Host//Realm',\n     59:       'rm //Engine//Realm',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-repos.pp", "content": "# TODO(tobasco): Remove this CBS candidate repo for Mimic and Nautilus when Storage SIG release it.", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n\n'descr'    => 'master delorean-deps',\n'gpgcheck' => 'no',\n},\n},\n}\n68:       # TODO(tobasco): Remove this CBS candidate repo for Mimic and Nautilus when Storage SIG release it.\n$ceph_mirror_fallback = $ceph_version_real ? {\n'mimic'    => 'http://cbs.centos.org/repos/storage7-ceph-mimic-candidate/x86_64/os/',\n'nautilus' => 'http://cbs.centos.org/repos/storage7-ceph-nautilus-candidate/x86_64/os/',\ndefault    => \"https://buildlogs.centos.org/centos/7/storage/x86_64/ceph-${ceph_version_real}/\"\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n# Target line: 68\n\n     63:             'descr'    => 'master delorean-deps',\n     64:             'gpgcheck' => 'no',\n     65:           },\n     66:         },\n     67:       }\n>>>  68:       # TODO(tobasco): Remove this CBS candidate repo for Mimic and Nautilus when Storage SIG release it.\n     69:       $ceph_mirror_fallback = $ceph_version_real ? {\n     70:         'mimic'    => 'http://cbs.centos.org/repos/storage7-ceph-mimic-candidate/x86_64/os/',\n     71:         'nautilus' => 'http://cbs.centos.org/repos/storage7-ceph-nautilus-candidate/x86_64/os/',\n     72:         default    => \"https://buildlogs.centos.org/centos/7/storage/x86_64/ceph-${ceph_version_real}/\"\n     73:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-openstack-object-proxy.pp", "content": "# Hack until swift::config also supports proxy config", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n\n\nif $test_file {\ninclude ::swift::test_file\n}\n\n55:   # Hack until swift::config also supports proxy config\ncreate_resources('swift_proxy_config', $proxy_config)\n\ncreate_resources('swift::ringsync', $ring_server)\n\nif $manage_firewall {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n# Target line: 55\n\n     50: \n     51:   if $test_file {\n     52:     include ::swift::test_file\n     53:   }\n     54: \n>>>  55:   # Hack until swift::config also supports proxy config\n     56:   create_resources('swift_proxy_config', $proxy_config)\n     57: \n     58:   create_resources('swift::ringsync', $ring_server)\n     59: \n     60:   if $manage_firewall {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp", "content": "#    Optional prefix for the sysctl.d file to be created. Default: none.", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n\n#\n# Parameters:\n#  $value:\n#    The value for the sysctl parameter. Mandatory, unless $ensure is 'absent'.\n#  $prefix:\n9: #    Optional prefix for the sysctl.d file to be created. Default: none.\n#  $ensure:\n#    Whether the variable's value should be 'present' or 'absent'.\n#    Defaults to 'present'.\n#\n# Sample Usage :", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: # Parameters:\n      6: #  $value:\n      7: #    The value for the sysctl parameter. Mandatory, unless $ensure is 'absent'.\n      8: #  $prefix:\n>>>   9: #    Optional prefix for the sysctl.d file to be created. Default: none.\n     10: #  $ensure:\n     11: #    Whether the variable's value should be 'present' or 'absent'.\n     12: #    Defaults to 'present'.\n     13: #\n     14: # Sample Usage :\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks", "line": 110, "detection_span": [105, 115], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nOptional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\nString                          $master_bounce_command = 'bounce',\nString                          $master_defer_command  = 'bounce',\nBoolean                         $mta                 = false,\nString                          $mydestination       = '$myorigin',   # postfix_mydestination\n110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\nString                          $myorigin            = $::fqdn,\nOptional[String]                $relayhost           = undef,         # postfix_relayhost\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\nOptional[Boolean]               $chroot              = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 110\n\n    105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\n    106:   String                          $master_bounce_command = 'bounce',\n    107:   String                          $master_defer_command  = 'bounce',\n    108:   Boolean                         $mta                 = false,\n    109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\n>>> 110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n    111:   String                          $myorigin            = $::fqdn,\n    112:   Optional[String]                $relayhost           = undef,         # postfix_relayhost\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n    115:   Optional[Boolean]               $chroot              = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-openldap-manifests-server-access_wrapper.pp", "content": "#   Mandatory. The suffix to apply acls", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n\n#\n# === Parameters\n#\n# [*suffix*]\n#   Default: $name\n9: #   Mandatory. The suffix to apply acls\n#\n# [*acl*]\n#   Default:\n#   Mandatory. Hash in the form { <what> => <access>, ... }\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n# Target line: 9\n\n      4: #\n      5: # === Parameters\n      6: #\n      7: # [*suffix*]\n      8: #   Default: $name\n>>>   9: #   Mandatory. The suffix to apply acls\n     10: #\n     11: # [*acl*]\n     12: #   Default:\n     13: #   Mandatory. Hash in the form { <what> => <access>, ... }\n     14: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack-infra@puppet-zuul-manifests-executor.pp", "content": "# This is a hack to make sure that systemd is aware of the new service", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: openstack-infra@puppet-zuul-manifests-executor.pp\n\nprovider => 'pip3',\nrequire  => Class['pip'],\n}\n\nif ($::operatingsystem == 'Ubuntu') and ($::operatingsystemrelease >= '16.04') {\n77:     # This is a hack to make sure that systemd is aware of the new service\n# before we attempt to start it.\nexec { 'zuul-executor-systemd-daemon-reload':\ncommand     => '/bin/systemctl daemon-reload',\nbefore      => Service['zuul-executor'],\nsubscribe   => File['/etc/init.d/zuul-executor'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-zuul-manifests-executor.pp\n# Target line: 77\n\n     72:     provider => 'pip3',\n     73:     require  => Class['pip'],\n     74:   }\n     75: \n     76:   if ($::operatingsystem == 'Ubuntu') and ($::operatingsystemrelease >= '16.04') {\n>>>  77:     # This is a hack to make sure that systemd is aware of the new service\n     78:     # before we attempt to start it.\n     79:     exec { 'zuul-executor-systemd-daemon-reload':\n     80:       command     => '/bin/systemctl daemon-reload',\n     81:       before      => Service['zuul-executor'],\n     82:       subscribe   => File['/etc/init.d/zuul-executor'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-base-physical.pp", "content": "# FIXME: This should be done more efficient when more vendors enter our scene", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: norcams@himlar-profile-manifests-base-physical.pp\n\ncontent => template(\"${module_name}/monitoring/sensu/redfish_check.sh.erb\"),\nmode    => '0755',\n}\n}\n\n87:   # FIXME: This should be done more efficient when more vendors enter our scene\nif ($configure_bmc_nic) and ($::runmode == 'default') {\n$addresslist = lookup('profile::network::services::dns_records', Hash, 'deep', '')\n$cname = $addresslist['CNAME'][$::clientcert]\nif empty($cname) {\n$mgmtaddress = $addresslist['A'][$::clientcert]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-base-physical.pp\n# Target line: 87\n\n     82:       content => template(\"${module_name}/monitoring/sensu/redfish_check.sh.erb\"),\n     83:       mode    => '0755',\n     84:     }\n     85:   }\n     86: \n>>>  87:   # FIXME: This should be done more efficient when more vendors enter our scene\n     88:   if ($configure_bmc_nic) and ($::runmode == 'default') {\n     89:     $addresslist = lookup('profile::network::services::dns_records', Hash, 'deep', '')\n     90:     $cname = $addresslist['CNAME'][$::clientcert]\n     91:     if empty($cname) {\n     92:       $mgmtaddress = $addresslist['A'][$::clientcert]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-user.pp", "content": "# Ruby's capitalize has a bug/feature where it *lower-cases* every", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-user.pp\n\n\n# Ideally, this would use the same canonicalization as core.\n# In the meantime, just address one common issue.\n\n# Capitalize first character\n53:     # Ruby's capitalize has a bug/feature where it *lower-cases* every\n# character except the first even when they were already\n# capitalized.  Puppet inherits this.\n$canonical_username = inline_template('<%= @username[0].capitalize + @username[1..-1] %>')\n\nmediawiki::maintenance { \"mediawiki_user_${canonical_username}_${wiki}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-user.pp\n# Target line: 53\n\n     48: \n     49:     # Ideally, this would use the same canonicalization as core.\n     50:     # In the meantime, just address one common issue.\n     51: \n     52:     # Capitalize first character\n>>>  53:     # Ruby's capitalize has a bug/feature where it *lower-cases* every\n     54:     # character except the first even when they were already\n     55:     # capitalized.  Puppet inherits this.\n     56:     $canonical_username = inline_template('<%= @username[0].capitalize + @username[1..-1] %>')\n     57: \n     58:     mediawiki::maintenance { \"mediawiki_user_${canonical_username}_${wiki}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp", "content": "# Set EnableSendfile to 'Off' to work around a bug with Vagrant.", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n\nonlyif      => '/usr/sbin/service apache2 status',\nrefreshonly => true,\nnotify      => Service['apache2'],\n}\n\n38:     # Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n# See <https://github.com/hashicorp/vagrant/issues/351>.\napache::conf { 'disable sendfile':\ncontent => 'EnableSendfile Off',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n# Target line: 38\n\n     33:         onlyif      => '/usr/sbin/service apache2 status',\n     34:         refreshonly => true,\n     35:         notify      => Service['apache2'],\n     36:     }\n     37: \n>>>  38:     # Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n     39:     # See <https://github.com/hashicorp/vagrant/issues/351>.\n     40:     apache::conf { 'disable sendfile':\n     41:         content => 'EnableSendfile Off',\n     42:     }\n     43: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "voxpupuli@puppet-nginx-manifests-resource-geo.pp", "content": "#                         name (automatically prefixed with $)", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: voxpupuli@puppet-nginx-manifests-resource-geo.pp\n\n#   [*ensure*]          - Enables or disables the specified location\n#   [*ranges*]          - Indicates that lookup keys (network addresses) are\n#                         specified as ranges.\n#   [*address*]         - Nginx defaults to using $remote_addr for testing.\n#                         This allows you to override that with another variable\n14: #                         name (automatically prefixed with $)\n#   [*delete*]          - deletes the specified network (see: geo module docs)\n#   [*proxy_recursive*] - Changes the behavior of address acquisition when\n#                         specifying trusted proxies via 'proxies' directive\n#   [*proxies*]         - Hash of network->value mappings.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-nginx-manifests-resource-geo.pp\n# Target line: 14\n\n      9: #   [*ensure*]          - Enables or disables the specified location\n     10: #   [*ranges*]          - Indicates that lookup keys (network addresses) are\n     11: #                         specified as ranges.\n     12: #   [*address*]         - Nginx defaults to using $remote_addr for testing.\n     13: #                         This allows you to override that with another variable\n>>>  14: #                         name (automatically prefixed with $)\n     15: #   [*delete*]          - deletes the specified network (see: geo module docs)\n     16: #   [*proxy_recursive*] - Changes the behavior of address acquisition when\n     17: #                         specifying trusted proxies via 'proxies' directive\n     18: #   [*proxies*]         - Hash of network->value mappings.\n     19: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod-php.pp", "content": "} elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n\n\n# Determine if we have a package\n$mod_packages = $::apache::mod_packages\nif $package_name {\n$_package_name = $package_name\n48:   } elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n$_package_name = $mod_packages[$mod]\n} elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n$_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n} else {\n$_package_name = undef", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n# Target line: 48\n\n     43: \n     44:   # Determine if we have a package\n     45:   $mod_packages = $::apache::mod_packages\n     46:   if $package_name {\n     47:     $_package_name = $package_name\n>>>  48:   } elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n     49:     $_package_name = $mod_packages[$mod]\n     50:   } elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n     51:     $_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n     52:   } else {\n     53:     $_package_name = undef\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "zend-patterns@ZendServerPuppet-manifests-bootstrap-zsmanage.pp", "content": "# TODO:if api_key was not specified then save Zend Server API key as a fact.", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-bootstrap-zsmanage.pp\n\n# == Class: zendserver::bootstrap::zsmanage\n#  Bootstrap single server if the fact zend_gui.completed is not true\n#  Use the zsmanage tool\nclass zendserver::bootstrap::zsmanage inherits zendserver::bootstrap {\n5:     # TODO:if api_key was not specified then save Zend Server API key as a fact.\n$options = \"-p ${zendserver::admin_password} -a ${zendserver::accept_eula}\"\n\n#Check if Zend Server is already bootstrapped.\n#The zend_gui_completed fact is a string and not a boolean.\nif $::zend_gui_completed != true {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-bootstrap-zsmanage.pp\n# Target line: 5\n\n      1: # == Class: zendserver::bootstrap::zsmanage\n      2: #  Bootstrap single server if the fact zend_gui.completed is not true\n      3: #  Use the zsmanage tool\n      4: class zendserver::bootstrap::zsmanage inherits zendserver::bootstrap {\n>>>   5:     # TODO:if api_key was not specified then save Zend Server API key as a fact.\n      6:   $options = \"-p ${zendserver::admin_password} -a ${zendserver::accept_eula}\"\n      7: \n      8:   #Check if Zend Server is already bootstrapped.\n      9:   #The zend_gui_completed fact is a string and not a boolean.\n     10:   if $::zend_gui_completed != true {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "justindowning@puppet-rbenv-manifests-build.pp", "content": "# Updating rdoc before installing gems via rbenv::gem also fixes this issue", "line": 156, "detection_span": [151, 161], "with_context": "# Puppet file: justindowning@puppet-rbenv-manifests-build.pp\n\n151:   # Install Bundler with no docs\n152:   # The 2.5.x version of rdoc (used in Ruby 1.8.x and 1.9.x) causes\n153:   # this error if docs are included during puppet run:\n154:   #   ERROR:  While executing gem ... (TypeError)\n#     can't convert nil into String\n156:   # Updating rdoc before installing gems via rbenv::gem also fixes this issue\n157:   rbenv::gem { \"bundler-${title}\":\ngem          => 'bundler',\nruby_version => $title,\nskip_docs    => true,\nversion      => $bundler_version,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: justindowning@puppet-rbenv-manifests-build.pp\n# Target line: 156\n\n    151:   # Install Bundler with no docs\n    152:   # The 2.5.x version of rdoc (used in Ruby 1.8.x and 1.9.x) causes\n    153:   # this error if docs are included during puppet run:\n    154:   #   ERROR:  While executing gem ... (TypeError)\n    155:   #     can't convert nil into String\n>>> 156:   # Updating rdoc before installing gems via rbenv::gem also fixes this issue\n    157:   rbenv::gem { \"bundler-${title}\":\n    158:     gem          => 'bundler',\n    159:     ruby_version => $title,\n    160:     skip_docs    => true,\n    161:     version      => $bundler_version,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "#   source => 'puppet:///modules/postfix/ldapoptions.cf',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n#     result_attribute => 'uid',\n#   }\n# }\n#\n# postfix::conffile { 'ldapoptions.cf':\n43: #   source => 'puppet:///modules/postfix/ldapoptions.cf',\n# }\n#\ndefine postfix::conffile (\nEnum['present', 'absent', 'directory'] $ensure   = 'present',\nVariant[Array[String], String, Undef]  $source   = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 43\n\n     38: #     result_attribute => 'uid',\n     39: #   }\n     40: # }\n     41: #\n     42: # postfix::conffile { 'ldapoptions.cf':\n>>>  43: #   source => 'puppet:///modules/postfix/ldapoptions.cf',\n     44: # }\n     45: #\n     46: define postfix::conffile (\n     47:   Enum['present', 'absent', 'directory'] $ensure   = 'present',\n     48:   Variant[Array[String], String, Undef]  $source   = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder_update.pp", "content": "# extracted to its own wrapper class to allow each of the jobs to issue", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder_update.pp\n\n# Class: govuk_jenkins::job_builder_update\n#\n# This class updates the jobs deployed to a Jenkins instance. It is\n4: # extracted to its own wrapper class to allow each of the jobs to issue\n# a `notify` against it without risk of side effects on other resources.\n#\n# == Parameters:\n#\n# [*jenkins_url*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder_update.pp\n# Target line: 4\n\n      1: # Class: govuk_jenkins::job_builder_update\n      2: #\n      3: # This class updates the jobs deployed to a Jenkins instance. It is\n>>>   4: # extracted to its own wrapper class to allow each of the jobs to issue\n      5: # a `notify` against it without risk of side effects on other resources.\n      6: #\n      7: # == Parameters:\n      8: #\n      9: # [*jenkins_url*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "jippi@puppet-php-manifests-extension-xdebug.pp", "content": "#  include php::extension::xdebug", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n\n#\n# No variables\n#\n# === Examples\n#\n31: #  include php::extension::xdebug\n#\n# === Authors\n#\n# Christian \"Jippi\" Winther <jippignu@gmail.com>\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n# Target line: 31\n\n     26: #\n     27: # No variables\n     28: #\n     29: # === Examples\n     30: #\n>>>  31: #  include php::extension::xdebug\n     32: #\n     33: # === Authors\n     34: #\n     35: # Christian \"Jippi\" Winther <jippignu@gmail.com>\n     36: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries", "line": 105, "detection_span": [100, 110], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nBoolean                         $manage_mailx        = true,\nOptional[String]                $mastercf_source     = undef,\nOptional[String]                $master_smtp         = undef,         # postfix_master_smtp\nOptional[String]                $master_smtps        = undef,         # postfix_master_smtps\nOptional[String]                $master_submission   = undef,         # postfix_master_submission\n105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\nString                          $master_bounce_command = 'bounce',\nString                          $master_defer_command  = 'bounce',\nBoolean                         $mta                 = false,\nString                          $mydestination       = '$myorigin',   # postfix_mydestination\nString                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 105\n\n    100:   Boolean                         $manage_mailx        = true,\n    101:   Optional[String]                $mastercf_source     = undef,\n    102:   Optional[String]                $master_smtp         = undef,         # postfix_master_smtp\n    103:   Optional[String]                $master_smtps        = undef,         # postfix_master_smtps\n    104:   Optional[String]                $master_submission   = undef,         # postfix_master_submission\n>>> 105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\n    106:   String                          $master_bounce_command = 'bounce',\n    107:   String                          $master_defer_command  = 'bounce',\n    108:   Boolean                         $mta                 = false,\n    109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\n    110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-ldap.pp", "content": "# include postfix::ldap", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n\n# - Class[\"postfix\"]\n#\n# === Examples\n#\n# include postfix\n14: # include postfix::ldap\n#\nclass postfix::ldap {\n\nassert_type(String, $postfix::ldap_base)\nassert_type(String, $postfix::ldap_host)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n# Target line: 14\n\n      9: # - Class[\"postfix\"]\n     10: #\n     11: # === Examples\n     12: #\n     13: # include postfix\n>>>  14: # include postfix::ldap\n     15: #\n     16: class postfix::ldap {\n     17: \n     18:   assert_type(String, $postfix::ldap_base)\n     19:   assert_type(String, $postfix::ldap_host)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp", "content": "# == Class: postfix", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n\n1: # == Class: postfix\n#\n# Postfix MTA service\n#\nclass postfix {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n# Target line: 1\n\n>>>   1: # == Class: postfix\n      2: #\n      3: # Postfix MTA service\n      4: #\n      5: class postfix {\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp", "content": "# Class fuel_project::devops_tools::lpupdatebug", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n\n1: # Class fuel_project::devops_tools::lpupdatebug\n#\n# This class deploys lpupdatebug package and it's configuration.\n#\n# Parameters:\n#   [*access_token*] - OAuth access token", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n# Target line: 1\n\n>>>   1: # Class fuel_project::devops_tools::lpupdatebug\n      2: #\n      3: # This class deploys lpupdatebug package and it's configuration.\n      4: #\n      5: # Parameters:\n      6: #   [*access_token*] - OAuth access token\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-citoid-manifests-init.pp", "content": "#  the lowest level to log (trace, debug, info, warn, error, fatal)", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-citoid-manifests-init.pp\n\n#\n# [*port*]\n#   the port Citoid will be running on\n#\n# [*log_level*]\n11: #  the lowest level to log (trace, debug, info, warn, error, fatal)\n#\nclass citoid (\n$port,\n$log_level = undef,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-citoid-manifests-init.pp\n# Target line: 11\n\n      6: #\n      7: # [*port*]\n      8: #   the port Citoid will be running on\n      9: #\n     10: # [*log_level*]\n>>>  11: #  the lowest level to log (trace, debug, info, warn, error, fatal)\n     12: #\n     13: class citoid (\n     14:     $port,\n     15:     $log_level = undef,\n     16: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-neutron-manifests-agents-l2gw.pp", "content": "#   (optional) Print debug info in logs", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-agents-l2gw.pp\n\n# [*manage_service*]\n#   (optional) Whether to start/stop the service\n#   Defaults to true\n#\n# [*debug*]\n21: #   (optional) Print debug info in logs\n#   Defaults to $::os_service_default\n#\n# [*ovsdb_hosts*]\n#   (optional) OVSDB server tuples in the format\n#   Example: ovsdb_hosts = 'ovsdb1:16.95.16.1:6632,ovsdb2:16.95.16.2:6632'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-agents-l2gw.pp\n# Target line: 21\n\n     16: # [*manage_service*]\n     17: #   (optional) Whether to start/stop the service\n     18: #   Defaults to true\n     19: #\n     20: # [*debug*]\n>>>  21: #   (optional) Print debug info in logs\n     22: #   Defaults to $::os_service_default\n     23: #\n     24: # [*ovsdb_hosts*]\n     25: #   (optional) OVSDB server tuples in the format\n     26: #   Example: ovsdb_hosts = 'ovsdb1:16.95.16.1:6632,ovsdb2:16.95.16.2:6632'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-https.pp", "content": "# Fix wgServer in wgConf to take", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-https.pp\n\n'mwvSupportsHttps' => true,\n},\npriority => 1,\n}\n\n36:     # Fix wgServer in wgConf to take\n# wgAssumeProxiesUseDefaultProtocolPorts and preserving the port\n# when referencing other wikis into account.\n#\n# We don't need to change $wgServer, because CommonSettings.php\n# changes it anyway after the settings.d are handled.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-https.pp\n# Target line: 36\n\n     31:             'mwvSupportsHttps' => true,\n     32:         },\n     33:         priority => 1,\n     34:     }\n     35: \n>>>  36:     # Fix wgServer in wgConf to take\n     37:     # wgAssumeProxiesUseDefaultProtocolPorts and preserving the port\n     38:     # when referencing other wikis into account.\n     39:     #\n     40:     # We don't need to change $wgServer, because CommonSettings.php\n     41:     # changes it anyway after the settings.d are handled.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp", "content": "# Output to Kafka.  All messages will produced to topics prefixed", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n\n}\n\n# TODO: This will be deprecated in favor of eventgate service\n#       once schemas and events are compatible.\n$outputs = [\n36:         # Output to Kafka.  All messages will produced to topics prefixed\n# with a datacenter name.\n# In mediawiki-vagrant this defaults to 'datacenter1'.\n'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n# Also output to a file for handy debugging\n'file:///vagrant/logs/eventbus.log',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n# Target line: 36\n\n     31:     }\n     32: \n     33:     # TODO: This will be deprecated in favor of eventgate service\n     34:     #       once schemas and events are compatible.\n     35:     $outputs = [\n>>>  36:         # Output to Kafka.  All messages will produced to topics prefixed\n     37:         # with a datacenter name.\n     38:         # In mediawiki-vagrant this defaults to 'datacenter1'.\n     39:         'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n     40:         # Also output to a file for handy debugging\n     41:         'file:///vagrant/logs/eventbus.log',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_graphite.pp", "content": "# FIXME: Remove this patch when Graphite is upgraded past 0.9.13", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_graphite.pp\n\nstorage_schemas_source     => 'puppet:///modules/govuk/node/s_graphite/storage-schemas.conf',\ncarbon_source              => 'puppet:///modules/govuk/node/s_graphite/carbon.conf',\nrequire                    => Govuk_mount[$graphite_path],\n}\n\n34:   # FIXME: Remove this patch when Graphite is upgraded past 0.9.13\n# This patch is https://github.com/graphite-project/carbon/pull/351 - the bug\n# that this fixes was released as part of 0.9.13 which breaks all of our\n# carbon-aggregator metrics.\n$service_py = \"${graphite_path}/lib/carbon/service.py\"\n$service_patch = \"${graphite_path}/graphite_carbon_service.patch\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_graphite.pp\n# Target line: 34\n\n     29:     storage_schemas_source     => 'puppet:///modules/govuk/node/s_graphite/storage-schemas.conf',\n     30:     carbon_source              => 'puppet:///modules/govuk/node/s_graphite/carbon.conf',\n     31:     require                    => Govuk_mount[$graphite_path],\n     32:   }\n     33: \n>>>  34:   # FIXME: Remove this patch when Graphite is upgraded past 0.9.13\n     35:   # This patch is https://github.com/graphite-project/carbon/pull/351 - the bug\n     36:   # that this fixes was released as part of 0.9.13 which breaks all of our\n     37:   # carbon-aggregator metrics.\n     38:   $service_py = \"${graphite_path}/lib/carbon/service.py\"\n     39:   $service_patch = \"${graphite_path}/graphite_carbon_service.patch\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-cluster-manifests-corosync-cs_service.pp", "content": "#TODO (bogdando) move to extras ha wrappers,", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-corosync-cs_service.pp\n\n# Not a doc string\n\n3: #TODO (bogdando) move to extras ha wrappers,\n#  remove mangling due to new pcs provider\ndefine cluster::corosync::cs_service (\n$ocf_script,\n$service_name,\n$service_title = undef,  # Title of Service, that been mangled for pacemakering", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-corosync-cs_service.pp\n# Target line: 3\n\n      1: # Not a doc string\n      2: \n>>>   3: #TODO (bogdando) move to extras ha wrappers,\n      4: #  remove mangling due to new pcs provider\n      5: define cluster::corosync::cs_service (\n      6:   $ocf_script,\n      7:   $service_name,\n      8:   $service_title = undef,  # Title of Service, that been mangled for pacemakering\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fraenki@puppet-galera-manifests-debian.pp", "content": "# Fixes Debian specific compatibility issues", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n\n# == Class: galera::debian\n#\n3: # Fixes Debian specific compatibility issues\n#\nclass galera::debian {\nif ($facts['os']['family'] != 'Debian') {\nwarn('the galera::debian class has been included on a non-debian host')\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n# Target line: 3\n\n      1: # == Class: galera::debian\n      2: #\n>>>   3: # Fixes Debian specific compatibility issues\n      4: #\n      5: class galera::debian {\n      6:   if ($facts['os']['family'] != 'Debian') {\n      7:     warn('the galera::debian class has been included on a non-debian host')\n      8:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-toragent.pp", "content": "## TODO: document the class", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-toragent.pp\n\n1: ## TODO: document the class\nclass contrail::toragent(\n$config_ip = $::contrail::params::config_ip_list[0],\n$contrail_tsn_ip = $::contrail::params::tsn_ip_list[0],\n$contrail_tsn_hostname = $::contrail::params::tsn_name_list[0],\n$contrail_openstack_ip = $::contrail::params::openstack_ip_list[0],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-toragent.pp\n# Target line: 1\n\n>>>   1: ## TODO: document the class\n      2: class contrail::toragent(\n      3:     $config_ip = $::contrail::params::config_ip_list[0],\n      4:     $contrail_tsn_ip = $::contrail::params::tsn_ip_list[0],\n      5:     $contrail_tsn_hostname = $::contrail::params::tsn_name_list[0],\n      6:     $contrail_openstack_ip = $::contrail::params::openstack_ip_list[0],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_docker-manifests-init.pp", "content": "# Docker machines should run with the latest Xenial kernel to fix", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_docker-manifests-init.pp\n\n\ngovuk_harden::sysctl::conf { 'docker-ip-forward':\ncontent => \"net.ipv4.ip_forward = 1\\n\",\n}\n\n40:   # Docker machines should run with the latest Xenial kernel to fix\n# stability issues\n$kernel_packages = [\n'linux-generic-lts-xenial',\n'linux-image-generic-lts-xenial',\n]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_docker-manifests-init.pp\n# Target line: 40\n\n     35: \n     36:   govuk_harden::sysctl::conf { 'docker-ip-forward':\n     37:     content => \"net.ipv4.ip_forward = 1\\n\",\n     38:   }\n     39: \n>>>  40:   # Docker machines should run with the latest Xenial kernel to fix\n     41:   # stability issues\n     42:   $kernel_packages = [\n     43:     'linux-generic-lts-xenial',\n     44:     'linux-image-generic-lts-xenial',\n     45:   ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-resource-mailhost.pp", "content": "#                             While issue jfryman/puppet-nginx#30 is discussed, default value is 'default'.", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-resource-mailhost.pp\n\n#   [*ipv6_enable*]         - BOOL value to enable/disable IPv6 support (false|true). Module will check to see if IPv6\n#                             support exists on your system before enabling.\n#   [*ipv6_listen_ip*]      - Default IPv6 Address for NGINX to listen with this vHost on. Defaults to all interfaces (::)\n#   [*ipv6_listen_port*]    - Default IPv6 Port for NGINX to listen with this vHost on. Defaults to TCP 80\n#   [*ipv6_listen_options*] - Extra options for listen directive like 'default' to catchall. Template will allways add ipv6only=on.\n15: #                             While issue jfryman/puppet-nginx#30 is discussed, default value is 'default'.\n#   [*index_files*]         - Default index files for NGINX to read when traversing a directory\n#   [*ssl*]                 - Indicates whether to setup SSL bindings for this mailhost.\n#   [*ssl_cert*]            - Pre-generated SSL Certificate file to reference for SSL Support. This is not generated by this module.\n#   [*ssl_key*]             - Pre-generated SSL Key file to reference for SSL Support. This is not generated by this module.\n#   [*ssl_port*]            - Default IP Port for NGINX to listen with this SSL vHost on. Defaults to TCP 443", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-resource-mailhost.pp\n# Target line: 15\n\n     10: #   [*ipv6_enable*]         - BOOL value to enable/disable IPv6 support (false|true). Module will check to see if IPv6\n     11: #                             support exists on your system before enabling.\n     12: #   [*ipv6_listen_ip*]      - Default IPv6 Address for NGINX to listen with this vHost on. Defaults to all interfaces (::)\n     13: #   [*ipv6_listen_port*]    - Default IPv6 Port for NGINX to listen with this vHost on. Defaults to TCP 80\n     14: #   [*ipv6_listen_options*] - Extra options for listen directive like 'default' to catchall. Template will allways add ipv6only=on.\n>>>  15: #                             While issue jfryman/puppet-nginx#30 is discussed, default value is 'default'.\n     16: #   [*index_files*]         - Default index files for NGINX to read when traversing a directory\n     17: #   [*ssl*]                 - Indicates whether to setup SSL bindings for this mailhost.\n     18: #   [*ssl_cert*]            - Pre-generated SSL Certificate file to reference for SSL Support. This is not generated by this module.\n     19: #   [*ssl_key*]             - Pre-generated SSL Key file to reference for SSL Support. This is not generated by this module.\n     20: #   [*ssl_port*]            - Default IP Port for NGINX to listen with this SSL vHost on. Defaults to TCP 443\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "Boolean                         $use_amavisd         = false,         # postfix_use_amavisd", "line": 118, "detection_span": [113, 123], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\nOptional[Boolean]               $chroot              = undef,\nBoolean                         $satellite           = false,\nString                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\n118:   Boolean                         $use_amavisd         = false,         # postfix_use_amavisd\nBoolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\nVariant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder\nBoolean                         $use_sympa           = false,         # postfix_use_sympa\nString                          $postfix_ensure      = 'present',\nString                          $mailx_ensure        = 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 118\n\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n    115:   Optional[Boolean]               $chroot              = undef,\n    116:   Boolean                         $satellite           = false,\n    117:   String                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\n>>> 118:   Boolean                         $use_amavisd         = false,         # postfix_use_amavisd\n    119:   Boolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\n    120:   Variant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder\n    121:   Boolean                         $use_sympa           = false,         # postfix_use_sympa\n    122:   String                          $postfix_ensure      = 'present',\n    123:   String                          $mailx_ensure        = 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-mta.pp", "content": "# == Class: postfix::mta", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-mta.pp\n\n1: # == Class: postfix::mta\n#\n# This class configures a minimal MTA, delivering mail to\n# $mydestination.\n#\n# Either a valid relay host or the special word 'direct' is required", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-mta.pp\n# Target line: 1\n\n>>>   1: # == Class: postfix::mta\n      2: #\n      3: # This class configures a minimal MTA, delivering mail to\n      4: # $mydestination.\n      5: #\n      6: # Either a valid relay host or the special word 'direct' is required\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-openstack-manifests-corosync.pp", "content": "# NOTE(bogdando) debug is *too* verbose", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack-manifests-corosync.pp\n\nset_votequorum           => true,\nmanage_pacemaker_service => true,\nquorum_members           => $quorum_members,\nquorum_members_ids       => $quorum_members_ids,\nunicast_addresses        => $unicast_addresses,\n51:     # NOTE(bogdando) debug is *too* verbose\ndebug                    => false,\nlog_stderr               => false,\nlog_function_name        => true,\n# NOTE(scsnow) workaround for rhel7.2\ncluster_name             => 'openstack',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack-manifests-corosync.pp\n# Target line: 51\n\n     46:     set_votequorum           => true,\n     47:     manage_pacemaker_service => true,\n     48:     quorum_members           => $quorum_members,\n     49:     quorum_members_ids       => $quorum_members_ids,\n     50:     unicast_addresses        => $unicast_addresses,\n>>>  51:     # NOTE(bogdando) debug is *too* verbose\n     52:     debug                    => false,\n     53:     log_stderr               => false,\n     54:     log_function_name        => true,\n     55:     # NOTE(scsnow) workaround for rhel7.2\n     56:     cluster_name             => 'openstack',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-again.pp", "content": "# TODO: we could include an option to disable this exec again and", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-again.pp\n\n# puppet run, and that stuff that is going to happen is useful to what just did\n# run, which is why we don't want to wait for it to happen naturally in 30 min.\n\nclass gluster::again {\n\n28: \t# TODO: we could include an option to disable this exec again and\n# replace it with a \"dummy\" noop if someone doesn't want to use it.\ninclude common::again\n\n# when notified, this will run puppet again, delta sec after it ends!\ncommon::again::delta { 'gluster-exec-again':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-again.pp\n# Target line: 28\n\n     23: # puppet run, and that stuff that is going to happen is useful to what just did\n     24: # run, which is why we don't want to wait for it to happen naturally in 30 min.\n     25: \n     26: class gluster::again {\n     27: \n>>>  28: \t# TODO: we could include an option to disable this exec again and\n     29: \t# replace it with a \"dummy\" noop if someone doesn't want to use it.\n     30: \tinclude common::again\n     31: \n     32: \t# when notified, this will run puppet again, delta sec after it ends!\n     33: \tcommon::again::delta { 'gluster-exec-again':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-pg_hba_rule.pp", "content": "# probably points to a bug inside ripienaar-concat.", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-pg_hba_rule.pp\n\nif($type =~ /^host/ and $address == undef) {\nfail('You must specify an address property when type is host based')\n}\n\n# This is required to make sure concat::setup is initialized first. This\n26:   # probably points to a bug inside ripienaar-concat.\ninclude concat::setup\n\n# Create a rule fragment\n$fragname = \"pg_hba_rule_${name}\"\nconcat::fragment { $fragname:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-pg_hba_rule.pp\n# Target line: 26\n\n     21:   if($type =~ /^host/ and $address == undef) {\n     22:     fail('You must specify an address property when type is host based')\n     23:   }\n     24: \n     25:   # This is required to make sure concat::setup is initialized first. This\n>>>  26:   # probably points to a bug inside ripienaar-concat.\n     27:   include concat::setup\n     28: \n     29:   # Create a rule fragment\n     30:   $fragname = \"pg_hba_rule_${name}\"\n     31:   concat::fragment { $fragname:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "# It is mainly a file resource that also restarts postfix", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n# = Define: postfix::conffile\n#\n# Adds a postfix configuration file.\n4: # It is mainly a file resource that also restarts postfix\n#\n# == Parameters\n#\n# [*ensure*]\n#   Ensure parameter for the file resource. Defaults to 'present'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 4\n\n      1: # = Define: postfix::conffile\n      2: #\n      3: # Adds a postfix configuration file.\n>>>   4: # It is mainly a file resource that also restarts postfix\n      5: #\n      6: # == Parameters\n      7: #\n      8: # [*ensure*]\n      9: #   Ensure parameter for the file resource. Defaults to 'present'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-l23network-manifests-l3-ifconfig.pp", "content": "# # todo: move routing to separated resource with his own provider", "line": 127, "detection_span": [122, 132], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-ifconfig.pp\n\n}\n123:   }\n124:\n125:   if $method == 'static' {\n$def_gateway = $gateway\n127:     # # todo: move routing to separated resource with his own provider\n# if ($def_gateway and !defined(L23network::L3::Defaultroute[$def_gateway])) {\n#   Anchor['l23network::init'] ->\n#   L3_ifconfig[$interface]\n#   ->\n#   l23network::l3::defaultroute { $def_gateway: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-ifconfig.pp\n# Target line: 127\n\n    122:     }\n    123:   }\n    124: \n    125:   if $method == 'static' {\n    126:     $def_gateway = $gateway\n>>> 127:     # # todo: move routing to separated resource with his own provider\n    128:     # if ($def_gateway and !defined(L23network::L3::Defaultroute[$def_gateway])) {\n    129:     #   Anchor['l23network::init'] ->\n    130:     #   L3_ifconfig[$interface]\n    131:     #   ->\n    132:     #   l23network::l3::defaultroute { $def_gateway: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#    include postfix", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#\n#Example usage:\n#\n#  node \"toto.example.com\" {\n#\n20: #    include postfix\n#\n#    postfix::hash { \"/etc/postfix/recipient_canonical\":\n#      ensure => present,\n#    }\n#    postfix::config { \"canonical_alias_maps\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 20\n\n     15: #\n     16: #Example usage:\n     17: #\n     18: #  node \"toto.example.com\" {\n     19: #\n>>>  20: #    include postfix\n     21: #\n     22: #    postfix::hash { \"/etc/postfix/recipient_canonical\":\n     23: #      ensure => present,\n     24: #    }\n     25: #    postfix::config { \"canonical_alias_maps\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "HewlettPackard@oneview-puppet-examples-firmware_driver.pp", "content": "# Example: hotfixUris => ['value1', 'value2', 'value3']", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: HewlettPackard@oneview-puppet-examples-firmware_driver.pp\n\n\n# NOTE: Both 'customBaselineName' or simply 'name' are accepted as the single identifier for the custom firmware package.\n# It is required to have exactly one of those on each resource declaration\n# NOTE: 1- baselineUri and hotfixUris accept either the uri or names for the drivers\n# NOTE: 2- hotfixUris values must be inserted inside an array, enclosed by [].\n21:   # Example: hotfixUris => ['value1', 'value2', 'value3']\n\noneview_firmware_driver{'firmware_driver_1':\nensure => 'present',\ndata   => {\ncustomBaselineName => 'FirmwareDriver1_Example',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: HewlettPackard@oneview-puppet-examples-firmware_driver.pp\n# Target line: 21\n\n     16: \n     17: # NOTE: Both 'customBaselineName' or simply 'name' are accepted as the single identifier for the custom firmware package.\n     18:   # It is required to have exactly one of those on each resource declaration\n     19: # NOTE: 1- baselineUri and hotfixUris accept either the uri or names for the drivers\n     20: # NOTE: 2- hotfixUris values must be inserted inside an array, enclosed by [].\n>>>  21:   # Example: hotfixUris => ['value1', 'value2', 'value3']\n     22: \n     23: oneview_firmware_driver{'firmware_driver_1':\n     24:     ensure => 'present',\n     25:     data   => {\n     26:       customBaselineName => 'FirmwareDriver1_Example',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp", "content": "# puppi::todo { \"cacti_db_install\":", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n\n#    been accomplished, so it can't be notified if the todo has been done\n# 2- ERROR - The task to do has not been accomplished becuase the command\n#    specified as check_command returns an error (exit status different from 0)\n#\n# == Usage:\n26: # puppi::todo { \"cacti_db_install\":\n#   description => \"Manual cacti db installation\" ,\n# }\n#\ndefine puppi::todo (\n$description   = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n# Target line: 26\n\n     21: #    been accomplished, so it can't be notified if the todo has been done\n     22: # 2- ERROR - The task to do has not been accomplished becuase the command\n     23: #    specified as check_command returns an error (exit status different from 0)\n     24: #\n     25: # == Usage:\n>>>  26: # puppi::todo { \"cacti_db_install\":\n     27: #   description => \"Manual cacti db installation\" ,\n     28: # }\n     29: #\n     30: define puppi::todo (\n     31:   $description   = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-server.pp", "content": "# https://bugzilla.redhat.com/show_bug.cgi?id=987555", "line": 100, "detection_span": [95, 105], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n\n#notify => Service[\"${::gluster::params::service_glusterd}\"],\t# TODO: ???\nrequire => Package[\"${::gluster::params::package_glusterfs_server}\"],\n}\n\n# NOTE: this option can be useful for users of libvirt migration as in:\n100: \t# https://bugzilla.redhat.com/show_bug.cgi?id=987555\n101: \t$valid_baseport = inline_template('<%= [Fixnum, String].include?(@baseport.class) ? @baseport.to_i : 0 %>')\n102:\n103: \t$valid_rpcauthallowinsecure = $rpcauthallowinsecure ? {\n104: \t\ttrue => true,\n105: \t\tdefault => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n# Target line: 100\n\n     95: \t\t#notify => Service[\"${::gluster::params::service_glusterd}\"],\t# TODO: ???\n     96: \t\trequire => Package[\"${::gluster::params::package_glusterfs_server}\"],\n     97: \t}\n     98: \n     99: \t# NOTE: this option can be useful for users of libvirt migration as in:\n>>> 100: \t# https://bugzilla.redhat.com/show_bug.cgi?id=987555\n    101: \t$valid_baseport = inline_template('<%= [Fixnum, String].include?(@baseport.class) ? @baseport.to_i : 0 %>')\n    102: \n    103: \t$valid_rpcauthallowinsecure = $rpcauthallowinsecure ? {\n    104: \t\ttrue => true,\n    105: \t\tdefault => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-ironic-manifests-db-sync.pp", "content": "# as \"ironic\" user, if there is an old log file owned by root. Let's fix it.", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-db-sync.pp\n\n\ninclude ::ironic::deps\ninclude ::ironic::params\n\n# NOTE(dtantsur): previous ironic-dbsync was run as root. it will fail to run\n19:   # as \"ironic\" user, if there is an old log file owned by root. Let's fix it.\n# To be removed in Rocky.\nfile { '/var/log/ironic/ironic-dbsync.log':\nensure  => 'present',\nowner   => 'ironic',\ngroup   => 'ironic',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-db-sync.pp\n# Target line: 19\n\n     14: \n     15:   include ::ironic::deps\n     16:   include ::ironic::params\n     17: \n     18:   # NOTE(dtantsur): previous ironic-dbsync was run as root. it will fail to run\n>>>  19:   # as \"ironic\" user, if there is an old log file owned by root. Let's fix it.\n     20:   # To be removed in Rocky.\n     21:   file { '/var/log/ironic/ironic-dbsync.log':\n     22:     ensure  => 'present',\n     23:     owner   => 'ironic',\n     24:     group   => 'ironic',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-agents-midonet.pp", "content": "# TODO(devvesa) provide non-controller ips for these services", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-agents-midonet.pp\n\n$midonet_libvirt_qemu_data = hiera('midonet_libvirt_qemu_data', ''),\n$neutron_api_node_ips      = hiera('neutron_api_node_ips', ''),\n$step                      = Integer(hiera('step')),\n) {\nif $step >= 4 {\n39:     # TODO(devvesa) provide non-controller ips for these services\nclass { '::tripleo::network::midonet::agent':\nzookeeper_servers => $neutron_api_node_ips,\ncassandra_seeds   => $neutron_api_node_ips\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-agents-midonet.pp\n# Target line: 39\n\n     34:   $midonet_libvirt_qemu_data = hiera('midonet_libvirt_qemu_data', ''),\n     35:   $neutron_api_node_ips      = hiera('neutron_api_node_ips', ''),\n     36:   $step                      = Integer(hiera('step')),\n     37: ) {\n     38:   if $step >= 4 {\n>>>  39:     # TODO(devvesa) provide non-controller ips for these services\n     40:     class { '::tripleo::network::midonet::agent':\n     41:       zookeeper_servers => $neutron_api_node_ips,\n     42:       cassandra_seeds   => $neutron_api_node_ips\n     43:     }\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp", "content": "# 1- WARNING - User hasn't specified a check_command to verify if the todo as", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n\n#\n# Use the command puppi todo to show the todo present in your node.\n# The exit status can be:\n# 0 - OK - The task to do has been accomplished because the command specified\n#    as check_command returns true (exit status 0)\n20: # 1- WARNING - User hasn't specified a check_command to verify if the todo as\n#    been accomplished, so it can't be notified if the todo has been done\n# 2- ERROR - The task to do has not been accomplished becuase the command\n#    specified as check_command returns an error (exit status different from 0)\n#\n# == Usage:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n# Target line: 20\n\n     15: #\n     16: # Use the command puppi todo to show the todo present in your node.\n     17: # The exit status can be:\n     18: # 0 - OK - The task to do has been accomplished because the command specified\n     19: #    as check_command returns true (exit status 0)\n>>>  20: # 1- WARNING - User hasn't specified a check_command to verify if the todo as\n     21: #    been accomplished, so it can't be notified if the todo has been done\n     22: # 2- ERROR - The task to do has not been accomplished becuase the command\n     23: #    specified as check_command returns an error (exit status different from 0)\n     24: #\n     25: # == Usage:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-apache-manifests-mod.pp", "content": "$mod_lib = $mod_libs[$mod] # 2.6 compatibility hack", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apache-manifests-mod.pp\n\n#include apache #This creates duplicate resources in rspec-puppet\n$mod_dir = $::apache::mod_dir\n\n# Determine if we have special lib\n$mod_libs = $::apache::params::mod_libs\n21:   $mod_lib = $mod_libs[$mod] # 2.6 compatibility hack\nif $lib {\n$_lib = $lib\n} elsif $mod_lib {\n$_lib = $mod_lib\n} else {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apache-manifests-mod.pp\n# Target line: 21\n\n     16:   #include apache #This creates duplicate resources in rspec-puppet\n     17:   $mod_dir = $::apache::mod_dir\n     18: \n     19:   # Determine if we have special lib\n     20:   $mod_libs = $::apache::params::mod_libs\n>>>  21:   $mod_lib = $mod_libs[$mod] # 2.6 compatibility hack\n     22:   if $lib {\n     23:     $_lib = $lib\n     24:   } elsif $mod_lib {\n     25:     $_lib = $mod_lib\n     26:   } else {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-openldap-manifests-server-access_wrapper.pp", "content": "# [*suffix*]", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n\n#\n# Generate access from a given hash.\n#\n# === Parameters\n#\n7: # [*suffix*]\n#   Default: $name\n#   Mandatory. The suffix to apply acls\n#\n# [*acl*]\n#   Default:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n# Target line: 7\n\n      2: #\n      3: # Generate access from a given hash.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # [*suffix*]\n      8: #   Default: $name\n      9: #   Mandatory. The suffix to apply acls\n     10: #\n     11: # [*acl*]\n     12: #   Default:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-murano.pp", "content": "# TODO(mmalchuk) remove this after LP#1628580 merged", "line": 118, "detection_span": [113, 123], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-murano.pp\n\n} else {\n$packages_service = 'murano'\n$enable_glare     = false\n}\n117:\n118:     # TODO(mmalchuk) remove this after LP#1628580 merged\nExec<| title == 'murano-dbmanage' |> {\ntries => '10',\ntry_sleep => '5'\n}\n123:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-murano.pp\n# Target line: 118\n\n    113:     } else {\n    114:       $packages_service = 'murano'\n    115:       $enable_glare     = false\n    116:     }\n    117: \n>>> 118:     # TODO(mmalchuk) remove this after LP#1628580 merged\n    119:     Exec<| title == 'murano-dbmanage' |> {\n    120:       tries => '10',\n    121:       try_sleep => '5'\n    122:     }\n    123: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-debian.pp", "content": "# This fixes a bug in the iptables-persistent LSB headers in 6.x, without it", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-debian.pp\n\n}\n}\n\nif($::operatingsystemrelease =~ /^6\\./ and $enable == true and $::iptables_persistent_version\nand versioncmp($::iptables_persistent_version, '0.5.0') < 0) {\n38:     # This fixes a bug in the iptables-persistent LSB headers in 6.x, without it\n# we lose idempotency\nexec { 'iptables-persistent-enable':\nlogoutput => on_failure,\ncommand   => '/usr/sbin/update-rc.d iptables-persistent enable',\nunless    => '/usr/bin/test -f /etc/rcS.d/S*iptables-persistent',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-debian.pp\n# Target line: 38\n\n     33:     }\n     34:   }\n     35: \n     36:   if($::operatingsystemrelease =~ /^6\\./ and $enable == true and $::iptables_persistent_version\n     37:   and versioncmp($::iptables_persistent_version, '0.5.0') < 0) {\n>>>  38:     # This fixes a bug in the iptables-persistent LSB headers in 6.x, without it\n     39:     # we lose idempotency\n     40:     exec { 'iptables-persistent-enable':\n     41:       logoutput => on_failure,\n     42:       command   => '/usr/sbin/update-rc.d iptables-persistent enable',\n     43:       unless    => '/usr/bin/test -f /etc/rcS.d/S*iptables-persistent',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-install.pp", "content": "# $hackerbot_xml_configs = []", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-install.pp\n\n# $json_inputs = base64('decode', $::base64_inputs)\n# $secgen_parameters = parsejson($json_inputs)\n# $server_ip = $secgen_parameters['server_ip'][0]\n# $port = $secgen_parameters['port'][0]\n\n7:   # $hackerbot_xml_configs = []\n# $hackerbot_lab_sheets = []\n\nfile { '/opt/hackerbot':\nensure => directory,\nrecurse => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-install.pp\n# Target line: 7\n\n      2:   # $json_inputs = base64('decode', $::base64_inputs)\n      3:   # $secgen_parameters = parsejson($json_inputs)\n      4:   # $server_ip = $secgen_parameters['server_ip'][0]\n      5:   # $port = $secgen_parameters['port'][0]\n      6: \n>>>   7:   # $hackerbot_xml_configs = []\n      8:   # $hackerbot_lab_sheets = []\n      9: \n     10:   file { '/opt/hackerbot':\n     11:     ensure => directory,\n     12:     recurse => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "basho-labs@puppet-riak-manifests-repository-el.pp", "content": "gpgcheck  => '0', # the rpm isn't signed, see https://github.com/basho/riak/issues/714", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: basho-labs@puppet-riak-manifests-repository-el.pp\n\n}\nyumrepo { 'basho_riak':\nbaseurl   => \"https://packagecloud.io/basho/riak/el/${::operatingsystemmajrelease}/${::architecture}\",\ndescr     => 'Riak packages distributed by Basho',\nenabled   => '1',\n17:     gpgcheck  => '0', # the rpm isn't signed, see https://github.com/basho/riak/issues/714\ngpgkey    => 'https://packagecloud.io/gpg.key',\nsslverify => '1',\nbefore    => Package[$::riak::package_name],\nrequire   => Exec['import-packagecloud_gpgkey'],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: basho-labs@puppet-riak-manifests-repository-el.pp\n# Target line: 17\n\n     12:   }\n     13:   yumrepo { 'basho_riak':\n     14:     baseurl   => \"https://packagecloud.io/basho/riak/el/${::operatingsystemmajrelease}/${::architecture}\",\n     15:     descr     => 'Riak packages distributed by Basho',\n     16:     enabled   => '1',\n>>>  17:     gpgcheck  => '0', # the rpm isn't signed, see https://github.com/basho/riak/issues/714\n     18:     gpgkey    => 'https://packagecloud.io/gpg.key',\n     19:     sslverify => '1',\n     20:     before    => Package[$::riak::package_name],\n     21:     require   => Exec['import-packagecloud_gpgkey'],\n     22:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-postfix-manifests-service.pp", "content": "# Manage the postfix service", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-service.pp\n\n# == Class: postfix::service\n#\n3: # Manage the postfix service\n#\nclass postfix::service {\nservice { 'postfix':\nensure  => running,\nrequire => Class['postfix::package'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-service.pp\n# Target line: 3\n\n      1: # == Class: postfix::service\n      2: #\n>>>   3: # Manage the postfix service\n      4: #\n      5: class postfix::service {\n      6:   service { 'postfix':\n      7:     ensure  => running,\n      8:     require => Class['postfix::package'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-pacemaker-manifests-new-setup-config.pp", "content": "#   * rrp_problem_count_timeout", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n\n#   * heartbeat_failures_allowed\n#   * max_network_delay\n#   * window_size\n#   * max_messages\n#   * miss_count_const\n55: #   * rrp_problem_count_timeout\n#   * rrp_problem_count_threshold\n#   * rrp_problem_count_mcast_threshold\n#   * rrp_token_expired_timeout\n#   * rrp_autorecovery_check_timeout\n#   Logging section:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n# Target line: 55\n\n     50: #   * heartbeat_failures_allowed\n     51: #   * max_network_delay\n     52: #   * window_size\n     53: #   * max_messages\n     54: #   * miss_count_const\n>>>  55: #   * rrp_problem_count_timeout\n     56: #   * rrp_problem_count_threshold\n     57: #   * rrp_problem_count_mcast_threshold\n     58: #   * rrp_token_expired_timeout\n     59: #   * rrp_autorecovery_check_timeout\n     60: #   Logging section:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-openstack-object-proxy.pp", "content": "# HACK: For some reason the swift::proxy::module need this directory", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n\ninclude ::swift::proxy::gatekeeper\ninclude ::swift::proxy::proxy_logging\ninclude ::swift::proxy::catch_errors\n\nif $manage_ceilometer {\n35:     # HACK: For some reason the swift::proxy::module need this directory\nfile { '/var/log/ceilometer':\nensure => directory\n}\ninclude ::swift::proxy::ceilometer\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n# Target line: 35\n\n     30:   include ::swift::proxy::gatekeeper\n     31:   include ::swift::proxy::proxy_logging\n     32:   include ::swift::proxy::catch_errors\n     33: \n     34:   if $manage_ceilometer {\n>>>  35:     # HACK: For some reason the swift::proxy::module need this directory\n     36:     file { '/var/log/ceilometer':\n     37:       ensure => directory\n     38:     }\n     39:     include ::swift::proxy::ceilometer\n     40:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-passenger.pp", "content": "gpgcheck       => 0, # To fix key autoimport", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-passenger.pp\n\nyum::managed_yumrepo { 'passenger':\ndescr          => 'Red Hat Enterprise $releasever - Phusion Passenger',\nbaseurl        => 'http://passenger.stealthymonkeys.com/rhel/$releasever/$basearch',\nmirrorlist     => 'http://passenger.stealthymonkeys.com/rhel/mirrors',\nenabled        => 1 ,\n12:     gpgcheck       => 0, # To fix key autoimport\nfailovermethod => 'priority',\ngpgkey         => 'http://passenger.stealthymonkeys.com/RPM-GPG-KEY-stealthymonkeys.asc',\nautokeyimport  => 'yes',\npriority       => 20,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-passenger.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'passenger':\n      8:     descr          => 'Red Hat Enterprise $releasever - Phusion Passenger',\n      9:     baseurl        => 'http://passenger.stealthymonkeys.com/rhel/$releasever/$basearch',\n     10:     mirrorlist     => 'http://passenger.stealthymonkeys.com/rhel/mirrors',\n     11:     enabled        => 1 ,\n>>>  12:     gpgcheck       => 0, # To fix key autoimport\n     13:     failovermethod => 'priority',\n     14:     gpgkey         => 'http://passenger.stealthymonkeys.com/RPM-GPG-KEY-stealthymonkeys.asc',\n     15:     autokeyimport  => 'yes',\n     16:     priority       => 20,\n     17:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-augeas.pp", "content": "#class postfix::augeas", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-augeas.pp\n\n1: #class postfix::augeas\n#  This class provides the augeas lenses used by the postfix class\n#\nclass postfix::augeas {\n\n$module_path = get_module_path($module_name)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-augeas.pp\n# Target line: 1\n\n>>>   1: #class postfix::augeas\n      2: #  This class provides the augeas lenses used by the postfix class\n      3: #\n      4: class postfix::augeas {\n      5: \n      6:   $module_path = get_module_path($module_name)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-virtual.pp", "content": "# - Postfix::Hash[\"/etc/postfix/virtual\"]", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n\n# [*file*]        - a string defining the location of the pre-hash map.\n#\n# === Requires\n#\n# - Class[\"postfix\"]\n15: # - Postfix::Hash[\"/etc/postfix/virtual\"]\n# - Postfix::Config[\"virtual_alias_maps\"]\n# - augeas\n#\n# === Examples\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n# Target line: 15\n\n     10: # [*file*]        - a string defining the location of the pre-hash map.\n     11: #\n     12: # === Requires\n     13: #\n     14: # - Class[\"postfix\"]\n>>>  15: # - Postfix::Hash[\"/etc/postfix/virtual\"]\n     16: # - Postfix::Config[\"virtual_alias_maps\"]\n     17: # - augeas\n     18: #\n     19: # === Examples\n     20: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-django-manifests-application.pp", "content": "#  [*debug*] - enable debug mode", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-django-manifests-application.pp\n\n#  [*apps*] - apps included in django settings file\n#  [*config*] - django configuration files location\n#  [*config_mode*] - django configuration files mode\n#  [*config_template*] - django settings file template\n#  [*database*] - django database settings file entries\n14: #  [*debug*] - enable debug mode\n#  [*group*] - django installation working group\n#  [*imports*] - imports used in django app\n#  [*logging*] - django logging settings file entries\n#  [*packages*] - system packages required by application\n#  [*secret_key*] - django application secret key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-django-manifests-application.pp\n# Target line: 14\n\n      9: #  [*apps*] - apps included in django settings file\n     10: #  [*config*] - django configuration files location\n     11: #  [*config_mode*] - django configuration files mode\n     12: #  [*config_template*] - django settings file template\n     13: #  [*database*] - django database settings file entries\n>>>  14: #  [*debug*] - enable debug mode\n     15: #  [*group*] - django installation working group\n     16: #  [*imports*] - imports used in django app\n     17: #  [*logging*] - django logging settings file entries\n     18: #  [*packages*] - system packages required by application\n     19: #  [*secret_key*] - django application secret key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-setenv-entry.pp", "content": "# - $doexport is the optional prefix before the variable.", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-setenv-entry.pp\n\n# - $ensure whether the fragment should be present or absent.\n# - $config_file is the path to the config file to edit\n# - $param is the parameter you're setting. Defaults to $name.\n# - $quote_char is the optional character to quote the value with.\n# - $order is the optional order to the param in the file. Defaults to 10\n12: # - $doexport is the optional prefix before the variable.\n# - (Deprecated) $base_path is the path to create the setenv.sh script under. Should be\n#   either $catalina_base/bin or $catalina_home/bin.\ndefine tomcat::setenv::entry (\n$value,\n$ensure        = 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-setenv-entry.pp\n# Target line: 12\n\n      7: # - $ensure whether the fragment should be present or absent.\n      8: # - $config_file is the path to the config file to edit\n      9: # - $param is the parameter you're setting. Defaults to $name.\n     10: # - $quote_char is the optional character to quote the value with.\n     11: # - $order is the optional order to the param in the file. Defaults to 10\n>>>  12: # - $doexport is the optional prefix before the variable.\n     13: # - (Deprecated) $base_path is the path to create the setenv.sh script under. Should be\n     14: #   either $catalina_base/bin or $catalina_home/bin.\n     15: define tomcat::setenv::entry (\n     16:   $value,\n     17:   $ensure        = 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack-infra@puppet-mailman-manifests-site.pp", "content": "# We alias the resource name here so that it can resolve properly", "line": 97, "detection_span": [92, 102], "with_context": "# Puppet file: openstack-infra@puppet-mailman-manifests-site.pp\n\nrequire => File['/etc/mailman/sites'],\npath    => '/etc/mailman/sites',\nline    => \"${default_email_host}: /srv/mailman/${name}\",\n}\n\n97:   # We alias the resource name here so that it can resolve properly\n# within the vhost template when evaluated as part of the vhost\n# define (which will override $name).\n100:   $mailman_site_name = $name\n101:   ::httpd::vhost { $default_url_host:\nport     => 80,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-mailman-manifests-site.pp\n# Target line: 97\n\n     92:     require => File['/etc/mailman/sites'],\n     93:     path    => '/etc/mailman/sites',\n     94:     line    => \"${default_email_host}: /srv/mailman/${name}\",\n     95:   }\n     96: \n>>>  97:   # We alias the resource name here so that it can resolve properly\n     98:   # within the vhost template when evaluated as part of the vhost\n     99:   # define (which will override $name).\n    100:   $mailman_site_name = $name\n    101:   ::httpd::vhost { $default_url_host:\n    102:     port     => 80,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp", "content": "# TODO: create a 'bind' hiera key for zookeeper", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n\n\n# Run zookeeper in the controller if configured\nif zk_on_controller {\nclass {'::tripleo::cluster::zookeeper':\nzookeeper_server_ips => $neutron_api_node_ips,\n87:         # TODO: create a 'bind' hiera key for zookeeper\nzookeeper_client_ip  => $zookeeper_client_ip,\nzookeeper_hostnames  => split($zookeeper_hostnames, ',')\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n# Target line: 87\n\n     82: \n     83:     # Run zookeeper in the controller if configured\n     84:     if zk_on_controller {\n     85:       class {'::tripleo::cluster::zookeeper':\n     86:         zookeeper_server_ips => $neutron_api_node_ips,\n>>>  87:         # TODO: create a 'bind' hiera key for zookeeper\n     88:         zookeeper_client_ip  => $zookeeper_client_ip,\n     89:         zookeeper_hostnames  => split($zookeeper_hostnames, ',')\n     90:       }\n     91:     }\n     92: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp", "content": "# NB: Until the IPaddr2 RA has a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1445628", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n\n} else {\n$pacemaker_master = false\n}\n\n$ganesha_vip = hiera('ganesha_vip')\n46:   # NB: Until the IPaddr2 RA has a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1445628\n# we need to specify the nic when creating the ipv6 vip.\nif is_ipv6_address($ganesha_vip) {\n$netmask        = '128'\n$nic            = interface_for_ip($ganesha_vip)\n$ipv6_addrlabel = '99'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n# Target line: 46\n\n     41:   } else {\n     42:     $pacemaker_master = false\n     43:   }\n     44: \n     45:   $ganesha_vip = hiera('ganesha_vip')\n>>>  46:   # NB: Until the IPaddr2 RA has a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1445628\n     47:   # we need to specify the nic when creating the ipv6 vip.\n     48:   if is_ipv6_address($ganesha_vip) {\n     49:     $netmask        = '128'\n     50:     $nic            = interface_for_ip($ganesha_vip)\n     51:     $ipv6_addrlabel = '99'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "# postfix::conffile { 'ldapoptions.cf':", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n#     query_filter     => 'mail=%s',\n#     result_attribute => 'uid',\n#   }\n# }\n#\n42: # postfix::conffile { 'ldapoptions.cf':\n#   source => 'puppet:///modules/postfix/ldapoptions.cf',\n# }\n#\ndefine postfix::conffile (\nEnum['present', 'absent', 'directory'] $ensure   = 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 42\n\n     37: #     query_filter     => 'mail=%s',\n     38: #     result_attribute => 'uid',\n     39: #   }\n     40: # }\n     41: #\n>>>  42: # postfix::conffile { 'ldapoptions.cf':\n     43: #   source => 'puppet:///modules/postfix/ldapoptions.cf',\n     44: # }\n     45: #\n     46: define postfix::conffile (\n     47:   Enum['present', 'absent', 'directory'] $ensure   = 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-puppi-manifests-netinstall.pp", "content": "#   (without suffixes). Optional.", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-puppi-manifests-netinstall.pp\n\n#   Example: /var/www/html\n#\n# [*extracted_dir*]\n#   The name of a directory or file created after the extraction\n#   Needed only if its name is different from the downloaded file name\n23: #   (without suffixes). Optional.\n#\n# [*owner*]\n#   The user owner of the directory / file created. Default: root\n#\n# [*group*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-puppi-manifests-netinstall.pp\n# Target line: 23\n\n     18: #   Example: /var/www/html\n     19: #\n     20: # [*extracted_dir*]\n     21: #   The name of a directory or file created after the extraction \n     22: #   Needed only if its name is different from the downloaded file name\n>>>  23: #   (without suffixes). Optional.\n     24: #\n     25: # [*owner*]\n     26: #   The user owner of the directory / file created. Default: root\n     27: #\n     28: # [*group*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-init.pp", "content": "# FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n\n#\n# XXX: does parted align disks properly ?\n# XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n# XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n\n56: # FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n# FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n# FIXME: can we setup gluster by using templated volume files instead ?\n\n# TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n# TODO: find out when ports are actually necessary for version 3.3", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n# Target line: 56\n\n     51: #\n     52: # XXX: does parted align disks properly ?\n     53: # XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n     54: # XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n     55: \n>>>  56: # FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n     57: # FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n     58: # FIXME: can we setup gluster by using templated volume files instead ?\n     59: \n     60: # TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n     61: # TODO: find out when ports are actually necessary for version 3.3\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp", "content": "# FIXME {", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n\n$server                = undef,\n$service               = undef,\n$ssldir                = undef,\n$vardir                = undef,\n) {\n29:   # FIXME {\n# Legacy cleanup:\n# - /etc/puppet/puppet.conf.d/agent-config.conf\n# - /etc/puppet/puppet.conf.d/master-config.conf\n# - /etc/puppet/puppet.conf.d/\nif(!defined(File['/etc/puppet/puppet.conf.d/agent-config.conf'])) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n# Target line: 29\n\n     24:   $server                = undef,\n     25:   $service               = undef,\n     26:   $ssldir                = undef,\n     27:   $vardir                = undef,\n     28: ) {\n>>>  29:   # FIXME {\n     30:   # Legacy cleanup:\n     31:   # - /etc/puppet/puppet.conf.d/agent-config.conf\n     32:   # - /etc/puppet/puppet.conf.d/master-config.conf\n     33:   # - /etc/puppet/puppet.conf.d/\n     34:   if(!defined(File['/etc/puppet/puppet.conf.d/agent-config.conf'])) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp", "content": "# } FIXME", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n\nfile { '/etc/puppet/puppet.conf.d' :\nensure => 'absent',\nforce  => true,\n}\n}\n52:   # } FIXME\n\nif(!defined(Concat[$config])) {\nconcat { $config :\nensure         => 'present',\nowner          => 'puppet',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n# Target line: 52\n\n     47:     file { '/etc/puppet/puppet.conf.d' :\n     48:       ensure => 'absent',\n     49:       force  => true,\n     50:     }\n     51:   }\n>>>  52:   # } FIXME\n     53: \n     54:   if(!defined(Concat[$config])) {\n     55:     concat { $config :\n     56:       ensure         => 'present',\n     57:       owner          => 'puppet',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#    postfix::canonical {", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#      ensure => present,\n#    }\n#    postfix::config { \"canonical_alias_maps\":\n#      value => \"hash:/etc/postfix/recipient_canonical\"\n#    }\n28: #    postfix::canonical {\n#      \"user@example.com\":\n#        file        => \"/etc/postfix/recipient_canonical\",\n#        ensure      => present,\n#        destination => \"root\";\n#    }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 28\n\n     23: #      ensure => present,\n     24: #    }\n     25: #    postfix::config { \"canonical_alias_maps\":\n     26: #      value => \"hash:/etc/postfix/recipient_canonical\"\n     27: #    }\n>>>  28: #    postfix::canonical {\n     29: #      \"user@example.com\":\n     30: #        file        => \"/etc/postfix/recipient_canonical\",\n     31: #        ensure      => present,\n     32: #        destination => \"root\";\n     33: #    }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#- Class[\"postfix\"]", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#- *name*: name of address postfix will lookup. See canonical(5).\n#- *destination*: where the emails will be delivered to. See canonical(5).\n#- *ensure*: present/absent, defaults to present.\n#\n#Requires:\n11: #- Class[\"postfix\"]\n#- Postfix::Hash[\"/etc/postfix/canonical\"]\n#- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n#- augeas\n#\n#Example usage:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 11\n\n      6: #- *name*: name of address postfix will lookup. See canonical(5).\n      7: #- *destination*: where the emails will be delivered to. See canonical(5).\n      8: #- *ensure*: present/absent, defaults to present.\n      9: #\n     10: #Requires:\n>>>  11: #- Class[\"postfix\"]\n     12: #- Postfix::Hash[\"/etc/postfix/canonical\"]\n     13: #- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n     14: #- augeas\n     15: #\n     16: #Example usage:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-queue_with_binding.pp", "content": "# Another side effect of this problem is you can't define more than one binding for a queue.", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-queue_with_binding.pp\n\n# This makes it rather awkward to add or change bindings on any queue which already has a binding, because the\n# provider will think the binding already exists even if the routing keys differ, and will assume\n# that no work needs doing.\n# At present the workaround for changing a binding is to create a new queue for the new binding. Then switch the\n# consumers over to the new queue, and remove the old queue.\n15: # Another side effect of this problem is you can't define more than one binding for a queue.\n# This is possible in version 6.0.0, however that version also drops Puppet 3 support.\n# https://forge.puppet.com/puppet/rabbitmq/changelog\n#\n# govuk_rabbitmq::remove_queues and govuk_rabbitmq::remove_bindings can be used\n# to ensure old queues and bindings are cleaned up.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-queue_with_binding.pp\n# Target line: 15\n\n     10: # This makes it rather awkward to add or change bindings on any queue which already has a binding, because the\n     11: # provider will think the binding already exists even if the routing keys differ, and will assume\n     12: # that no work needs doing.\n     13: # At present the workaround for changing a binding is to create a new queue for the new binding. Then switch the\n     14: # consumers over to the new queue, and remove the old queue.\n>>>  15: # Another side effect of this problem is you can't define more than one binding for a queue.\n     16: # This is possible in version 6.0.0, however that version also drops Puppet 3 support.\n     17: # https://forge.puppet.com/puppet/rabbitmq/changelog\n     18: #\n     19: # govuk_rabbitmq::remove_queues and govuk_rabbitmq::remove_bindings can be used\n     20: # to ensure old queues and bindings are cleaned up.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb.pp", "content": "# this is done in mysql::server::account_security but has problems", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb.pp\n\n},\n},\n}\n\n# deleting database users for security\n47:     # this is done in mysql::server::account_security but has problems\n# when there is no fqdn, so we're defining a slightly different one here\nmysql_user { [ 'root@127.0.0.1', 'root@::1', '@localhost', '@%' ]:\nensure  => 'absent',\nrequire => Class['mysql::server'],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb.pp\n# Target line: 47\n\n     42:         },\n     43:       },\n     44:     }\n     45: \n     46:     # deleting database users for security\n>>>  47:     # this is done in mysql::server::account_security but has problems\n     48:     # when there is no fqdn, so we're defining a slightly different one here\n     49:     mysql_user { [ 'root@127.0.0.1', 'root@::1', '@localhost', '@%' ]:\n     50:       ensure  => 'absent',\n     51:       require => Class['mysql::server'],\n     52:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "zend-patterns@ZendServerPuppet-manifests-directive.pp", "content": "# Todo: other types?", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-directive.pp\n\n#  zendserver::directive { 'upload_max_filesize':\n#    directive_value  => '20M',\n#  }\n#\n# Todo: paths\n23: # Todo: other types?\n\ndefine zendserver::directive (\n$directive_value,\n$target             = 'localadmin',\n$downcase_name    = downcase($name),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-directive.pp\n# Target line: 23\n\n     18: #  zendserver::directive { 'upload_max_filesize':\n     19: #    directive_value  => '20M',\n     20: #  }\n     21: #\n     22: # Todo: paths\n>>>  23: # Todo: other types?\n     24: \n     25: define zendserver::directive (\n     26:   $directive_value,\n     27:   $target             = 'localadmin',\n     28:   $downcase_name    = downcase($name),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danofthewired@puppet-bitbucket-manifests-config.pp", "content": "# See issue #16 for more detail", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: danofthewired@puppet-bitbucket-manifests-config.pp\n\n$tomcat_port  = $bitbucket::tomcat_port,\n$config_properties = $bitbucket::config_properties,\n) {\n\n# Atlassian changed where files are installed from ver 3.2.0\n16:   # See issue #16 for more detail\nif versioncmp($version, '3.2.0') > 0 {\n$moved = 'shared/'\n$shared_dir = \"${bitbucket::homedir}/${moved}\"\n# Shared directory may be already defined when installing DataCenter instances (NFS mounted)\nif ! defined(File[$shared_dir]) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: danofthewired@puppet-bitbucket-manifests-config.pp\n# Target line: 16\n\n     11:   $tomcat_port  = $bitbucket::tomcat_port,\n     12:   $config_properties = $bitbucket::config_properties,\n     13: ) {\n     14: \n     15:   # Atlassian changed where files are installed from ver 3.2.0\n>>>  16:   # See issue #16 for more detail\n     17:   if versioncmp($version, '3.2.0') > 0 {\n     18:     $moved = 'shared/'\n     19:     $shared_dir = \"${bitbucket::homedir}/${moved}\"\n     20:     # Shared directory may be already defined when installing DataCenter instances (NFS mounted)\n     21:     if ! defined(File[$shared_dir]) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-php-manifests-pecl-module.pp", "content": "#   This can help to debug installation problems (missing packages) during", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-php-manifests-pecl-module.pp\n\n# [*auto_answer*]\n#   The answer(s) to give to pecl prompts for unattended install\n#\n# [*verbose*]\n#   (Optional) - If you want to see verbose pecl output during installation.\n26: #   This can help to debug installation problems (missing packages) during\n#   installation process. Default: false\n#\n# == Examples\n# php::pecl::module { 'intl': }\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-php-manifests-pecl-module.pp\n# Target line: 26\n\n     21: # [*auto_answer*]\n     22: #   The answer(s) to give to pecl prompts for unattended install\n     23: #\n     24: # [*verbose*]\n     25: #   (Optional) - If you want to see verbose pecl output during installation.\n>>>  26: #   This can help to debug installation problems (missing packages) during\n     27: #   installation process. Default: false\n     28: #\n     29: # == Examples\n     30: # php::pecl::module { 'intl': }\n     31: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "lightblue-platform@lightblue-puppet-manifests-service-plugin-graphite.pp", "content": "# $prefix   - (optional) Prefix used for graphite.", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-graphite.pp\n\n#\n# Deploys/Removes lightblue graphite environment variables.\n#\n# === Parameters\n#\n7: # $prefix   - (optional) Prefix used for graphite.\n#             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n# $hostname - Hostname of the graphite server.\n#             If not set, puppet will remove the environment variables.\n# $port     - Port the graphite server is listening on\n#             Defaults to 2003", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-graphite.pp\n# Target line: 7\n\n      2: #\n      3: # Deploys/Removes lightblue graphite environment variables.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # $prefix   - (optional) Prefix used for graphite.\n      8: #             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n      9: # $hostname - Hostname of the graphite server.\n     10: #             If not set, puppet will remove the environment variables.\n     11: # $port     - Port the graphite server is listening on\n     12: #             Defaults to 2003\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp", "content": "# colocated. Later we expand the properties on all nodes where ceph_nfs", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n\nif $step >= 2 {\nif $pacemaker_master {\n# At step2 we only create the node property on master so that\n# both VIP and (later at step5) ceph-nfs service can start on master\n# node only. This way we can guarantee that the VIP and ceph-nfs are\n71:       # colocated. Later we expand the properties on all nodes where ceph_nfs\n# is supposed to run.\npacemaker::property { 'ceph-nfs-role-node-property':\nproperty => 'ceph-nfs-role',\nvalue    => true,\ntries    => $pcs_tries,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n# Target line: 71\n\n     66:   if $step >= 2 {\n     67:     if $pacemaker_master {\n     68:       # At step2 we only create the node property on master so that\n     69:       # both VIP and (later at step5) ceph-nfs service can start on master\n     70:       # node only. This way we can guarantee that the VIP and ceph-nfs are\n>>>  71:       # colocated. Later we expand the properties on all nodes where ceph_nfs\n     72:       # is supposed to run.\n     73:       pacemaker::property { 'ceph-nfs-role-node-property':\n     74:         property => 'ceph-nfs-role',\n     75:         value    => true,\n     76:         tries    => $pcs_tries,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_access.pp", "content": "# TODO(dilyin): but it causes duplicate declaration errors on the controller. Some solution should be found.", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_access.pp\n\nFile[\"${db_host}-mysql-access\"] ->\nFile <| path == $default_file_path |>\n\n# Ensure .my.cnf exists even if mysql on this node is disabled\n# TODO(dilyin): ensuring the default file is present is required for the external db configurations\n54:     # TODO(dilyin): but it causes duplicate declaration errors on the controller. Some solution should be found.\n# TODO(dilyin): https://bugs.launchpad.net/fuel/+bug/1618607\nensure_resource(file, $default_file_path)\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_access.pp\n# Target line: 54\n\n     49:     File[\"${db_host}-mysql-access\"] ->\n     50:     File <| path == $default_file_path |>\n     51: \n     52:     # Ensure .my.cnf exists even if mysql on this node is disabled\n     53:     # TODO(dilyin): ensuring the default file is present is required for the external db configurations\n>>>  54:     # TODO(dilyin): but it causes duplicate declaration errors on the controller. Some solution should be found.\n     55:     # TODO(dilyin): https://bugs.launchpad.net/fuel/+bug/1618607\n     56:     ensure_resource(file, $default_file_path)\n     57:   }\n     58: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "craigwatson@puppet-vmwaretools-manifests-init.pp", "content": "#   we use stdlib's ensure_package resource which should eliminate most issues.", "line": 92, "detection_span": [87, 97], "with_context": "# Puppet file: craigwatson@puppet-vmwaretools-manifests-init.pp\n\n#   Default: true (boolean)\n#\n# [*manage_curl_pkgs*]\n#   Whether to install curl, which is used to download the VMware Tools from an\n#   HTTP location. Useful when other modules are managing the package, although\n92: #   we use stdlib's ensure_package resource which should eliminate most issues.\n#   Default: true (boolean)\n#\n# [*clean_failed_download*]\n#   Whether to remove failed HTTP downloads. This ensures that broken downloads\n#   are automatically retried on the next Puppet run.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: craigwatson@puppet-vmwaretools-manifests-init.pp\n# Target line: 92\n\n     87: #   Default: true (boolean)\n     88: #\n     89: # [*manage_curl_pkgs*]\n     90: #   Whether to install curl, which is used to download the VMware Tools from an\n     91: #   HTTP location. Useful when other modules are managing the package, although\n>>>  92: #   we use stdlib's ensure_package resource which should eliminate most issues.\n     93: #   Default: true (boolean)\n     94: #\n     95: # [*clean_failed_download*]\n     96: #   Whether to remove failed HTTP downloads. This ensures that broken downloads\n     97: #   are automatically retried on the next Puppet run.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "# TODO: this should be tested", "line": 60, "detection_span": [55, 65], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\nkey    => 'AppleEnableMenuBarTransparency',\ntype   => 'bool',\nvalue  => false,\n}\n\n60:   # TODO: this should be tested\npeople::felho::plistbuddy { 'Automatically quit printer app once the print jobs complete':\ndomain   => 'com.apple.print.PrintingPrefs',\nproperty => 'Quit When Finished',\ntype     => 'bool',\nvalue    => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 60\n\n     55:     key    => 'AppleEnableMenuBarTransparency',\n     56:     type   => 'bool',\n     57:     value  => false,\n     58:   }\n     59: \n>>>  60:   # TODO: this should be tested\n     61:   people::felho::plistbuddy { 'Automatically quit printer app once the print jobs complete':\n     62:     domain   => 'com.apple.print.PrintingPrefs',\n     63:     property => 'Quit When Finished',\n     64:     type     => 'bool',\n     65:     value    => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-ldap.pp", "content": "# == Class: postfix::ldap", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n\n1: # == Class: postfix::ldap\n#\n# Configures postfix for use with LDAP.\n#\n# === Parameters\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n# Target line: 1\n\n>>>   1: # == Class: postfix::ldap\n      2: #\n      3: # Configures postfix for use with LDAP.\n      4: #\n      5: # === Parameters\n      6: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_database.pp", "content": "# Debug - Print all variables", "line": 97, "detection_span": [92, 102], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_database.pp\n\ndefault: {\n$contrail_cassandra_dir = \"/etc/cassandra/conf\"\n}\n}\n\n97:     # Debug - Print all variables\nnotify { \"Database - contrail cassandra dir is $contrail_cassandra_dir\":; } ->\nnotify { \"Database - host_control_ip = $host_control_ip\":;} ->\nnotify { \"Database - config_ip = $config_ip\":;} ->\nnotify { \"Database - internal_vip = $internal_vip\":;} ->\nnotify { \"Database - database_ip_list = $database_ip_list\":;} ->", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_database.pp\n# Target line: 97\n\n     92:         default: {\n     93:              $contrail_cassandra_dir = \"/etc/cassandra/conf\"\n     94:         }\n     95:     }\n     96: \n>>>  97:     # Debug - Print all variables\n     98:     notify { \"Database - contrail cassandra dir is $contrail_cassandra_dir\":; } ->\n     99:     notify { \"Database - host_control_ip = $host_control_ip\":;} ->\n    100:     notify { \"Database - config_ip = $config_ip\":;} ->\n    101:     notify { \"Database - internal_vip = $internal_vip\":;} ->\n    102:     notify { \"Database - database_ip_list = $database_ip_list\":;} ->\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-zaqar.pp", "content": "# TODO (bcrochet): At some point, the transports should be split out to", "line": 120, "detection_span": [115, 125], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-zaqar.pp\n\ninclude ::tripleo::profile::base::apache\ninclude ::zaqar::transport::wsgi\ninclude ::zaqar::config\ninclude ::zaqar::logging\n119:\n120:     # TODO (bcrochet): At some point, the transports should be split out to\n# separate services.\nclass { '::zaqar::server':\nservice_name => 'httpd', # TODO cleanup when passed by t-h-t.\n}\nclass { '::zaqar::wsgi::apache':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-zaqar.pp\n# Target line: 120\n\n    115:     include ::tripleo::profile::base::apache\n    116:     include ::zaqar::transport::wsgi\n    117:     include ::zaqar::config\n    118:     include ::zaqar::logging\n    119: \n>>> 120:     # TODO (bcrochet): At some point, the transports should be split out to\n    121:     # separate services.\n    122:     class { '::zaqar::server':\n    123:       service_name => 'httpd', # TODO cleanup when passed by t-h-t.\n    124:     }\n    125:     class { '::zaqar::wsgi::apache':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-server.pp", "content": "recurse => false,\t\t# TODO: eventually...", "line": 89, "detection_span": [84, 94], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n\nensure_resource('class', 'gluster::api', $api_params)\n\n# NOTE: not that we necessarily manage anything in here at the moment...\nfile { '/etc/glusterfs/':\nensure => directory,\t\t# make sure this is a directory\n89: \t\trecurse => false,\t\t# TODO: eventually...\npurge => false,\t\t\t# TODO: eventually...\nforce => false,\t\t\t# TODO: eventually...\nowner => \"${::gluster::params::misc_owner_root}\",\ngroup => \"${::gluster::params::misc_group_root}\",\nmode => 644,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n# Target line: 89\n\n     84: \tensure_resource('class', 'gluster::api', $api_params)\n     85: \n     86: \t# NOTE: not that we necessarily manage anything in here at the moment...\n     87: \tfile { '/etc/glusterfs/':\n     88: \t\tensure => directory,\t\t# make sure this is a directory\n>>>  89: \t\trecurse => false,\t\t# TODO: eventually...\n     90: \t\tpurge => false,\t\t\t# TODO: eventually...\n     91: \t\tforce => false,\t\t\t# TODO: eventually...\n     92: \t\towner => \"${::gluster::params::misc_owner_root}\",\n     93: \t\tgroup => \"${::gluster::params::misc_group_root}\",\n     94: \t\tmode => 644,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alup@puppet-rbenv-manifests-compile.pp", "content": "# This is required for some gems (e.g. debugger)", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n\n$versions    = \"${root_path}/versions\"\n$global_path = \"${root_path}/version\"\n$path        = [ $shims, $bin, '/bin', '/usr/bin' ]\n\n# Keep flag saves source tree after building.\n28:   # This is required for some gems (e.g. debugger)\nif $keep {\n$keep_flag = '--keep '\n}\nelse {\n$keep_flag = ''", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n# Target line: 28\n\n     23:   $versions    = \"${root_path}/versions\"\n     24:   $global_path = \"${root_path}/version\"\n     25:   $path        = [ $shims, $bin, '/bin', '/usr/bin' ]\n     26: \n     27:   # Keep flag saves source tree after building.\n>>>  28:   # This is required for some gems (e.g. debugger)\n     29:   if $keep {\n     30:     $keep_flag = '--keep '\n     31:   }\n     32:   else {\n     33:     $keep_flag = ''\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-large_prefix.pp", "content": "# == Class: mysql::large_prefix", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-large_prefix.pp\n\n1: # == Class: mysql::large_prefix\n#\n# Configures innodb_large_prefix support.\n#\nclass mysql::large_prefix{\ninclude ::mysql", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-large_prefix.pp\n# Target line: 1\n\n>>>   1: # == Class: mysql::large_prefix\n      2: #\n      3: # Configures innodb_large_prefix support.\n      4: #\n      5: class mysql::large_prefix{\n      6:     include ::mysql\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@pltraining-classroom-manifests-virtual.pp", "content": "# fix augeas lens until it's updated in PE", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-virtual.pp\n\n\nif $::osfamily == 'windows' {\ninclude classroom::windows\n}\nelse {\n87:     # fix augeas lens until it's updated in PE\ninclude classroom::agent::augeas\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-virtual.pp\n# Target line: 87\n\n     82: \n     83:   if $::osfamily == 'windows' {\n     84:     include classroom::windows\n     85:   }\n     86:   else {\n>>>  87:     # fix augeas lens until it's updated in PE\n     88:     include classroom::agent::augeas\n     89:   }\n     90: \n     91: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-mongodb-manifests-monitoring.pp", "content": "# git subtree pull --prefix=modules/mongodb/files/nagios-plugin-mongodb \\", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-monitoring.pp\n\n\ninclude mongodb::python\n\n# This plugin is from https://github.com/mzupan/nagios-plugin-mongodb\n# to update to the latest version, run this giant command:\n18:   # git subtree pull --prefix=modules/mongodb/files/nagios-plugin-mongodb \\\n#   https://github.com/mzupan/nagios-plugin-mongodb.git \\\n#   -m 'update to latest nagios-plugin-mongodb from github' master --squash\n@icinga::plugin { 'check_mongodb.py':\nsource  => 'puppet:///modules/mongodb/nagios-plugin-mongodb/check_mongodb.py',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-monitoring.pp\n# Target line: 18\n\n     13: \n     14:   include mongodb::python\n     15: \n     16:   # This plugin is from https://github.com/mzupan/nagios-plugin-mongodb\n     17:   # to update to the latest version, run this giant command:\n>>>  18:   # git subtree pull --prefix=modules/mongodb/files/nagios-plugin-mongodb \\\n     19:   #   https://github.com/mzupan/nagios-plugin-mongodb.git \\\n     20:   #   -m 'update to latest nagios-plugin-mongodb from github' master --squash\n     21:   @icinga::plugin { 'check_mongodb.py':\n     22:     source  => 'puppet:///modules/mongodb/nagios-plugin-mongodb/check_mongodb.py',\n     23:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache.pp", "content": "# LP#1491576 and https://github.com/GrahamDumpleton/mod_wsgi/issues/81", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache.pp\n\nClass['::apache'] ->\nanchor { 'osnailyfacter::apache end' :}\n\n# we need to override the logrotate file provided by apache to work around\n# wsgi issues on the restart caused by logrotate.\n59:   # LP#1491576 and https://github.com/GrahamDumpleton/mod_wsgi/issues/81\nfile { '/etc/logrotate.d/apache2':\nensure  => 'file',\nowner   => 'root',\ngroup   => 'root',\nmode    => '0644',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache.pp\n# Target line: 59\n\n     54:   Class['::apache'] ->\n     55:   anchor { 'osnailyfacter::apache end' :}\n     56: \n     57:   # we need to override the logrotate file provided by apache to work around\n     58:   # wsgi issues on the restart caused by logrotate.\n>>>  59:   # LP#1491576 and https://github.com/GrahamDumpleton/mod_wsgi/issues/81\n     60:   file { '/etc/logrotate.d/apache2':\n     61:     ensure  => 'file',\n     62:     owner   => 'root',\n     63:     group   => 'root',\n     64:     mode    => '0644',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "soylent@konstantin-fluentd-manifests-params.pp", "content": "# https://tickets.puppetlabs.com/browse/PUP-5296", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: soylent@konstantin-fluentd-manifests-params.pp\n\n$service_ensure = running\n$service_enable = true\n$service_manage = true\n\n# NOTE: Workaround for the following issue:\n36:   # https://tickets.puppetlabs.com/browse/PUP-5296\nif $facts['osfamily'] == 'redhat' {\n$service_provider = 'redhat'\n} else {\n$service_provider = undef\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: soylent@konstantin-fluentd-manifests-params.pp\n# Target line: 36\n\n     31:   $service_ensure = running\n     32:   $service_enable = true\n     33:   $service_manage = true\n     34: \n     35:   # NOTE: Workaround for the following issue:\n>>>  36:   # https://tickets.puppetlabs.com/browse/PUP-5296\n     37:   if $facts['osfamily'] == 'redhat' {\n     38:     $service_provider = 'redhat'\n     39:   } else {\n     40:     $service_provider = undef\n     41:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-pacemaker-manifests-new-setup-config.pp", "content": "#   * rrp_problem_count_threshold", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n\n#   * max_network_delay\n#   * window_size\n#   * max_messages\n#   * miss_count_const\n#   * rrp_problem_count_timeout\n56: #   * rrp_problem_count_threshold\n#   * rrp_problem_count_mcast_threshold\n#   * rrp_token_expired_timeout\n#   * rrp_autorecovery_check_timeout\n#   Logging section:\n#   * timestamp", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n# Target line: 56\n\n     51: #   * max_network_delay\n     52: #   * window_size\n     53: #   * max_messages\n     54: #   * miss_count_const\n     55: #   * rrp_problem_count_timeout\n>>>  56: #   * rrp_problem_count_threshold\n     57: #   * rrp_problem_count_mcast_threshold\n     58: #   * rrp_token_expired_timeout\n     59: #   * rrp_autorecovery_check_timeout\n     60: #   Logging section:\n     61: #   * timestamp\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-zabbix-manifests-agent.pp", "content": "#   [*debug_level*] - set debug level of Zabbix Agent", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-zabbix-manifests-agent.pp\n\n# This class configures Zabbix Agent instance.\n#\n# Parameters:\n#   [*allow_root*] - allow the agent to run as 'root' user\n#   [*apply_firewall_rules*] - apply embedded firewall rules\n8: #   [*debug_level*] - set debug level of Zabbix Agent\n#   [*enable_remote_commands*] - allow to run remote commands on host with Agent\n#   [*firewall_allow_sources*] - sources allowed to connect to the service\n#   [*hostname*] - unique, case sensitive hostname\n#   [*hostname_item*] - Zabbix agent item used for getting host name\n#   [*include*] - individual files or all files in a directory in the", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-zabbix-manifests-agent.pp\n# Target line: 8\n\n      3: # This class configures Zabbix Agent instance.\n      4: #\n      5: # Parameters:\n      6: #   [*allow_root*] - allow the agent to run as 'root' user\n      7: #   [*apply_firewall_rules*] - apply embedded firewall rules\n>>>   8: #   [*debug_level*] - set debug level of Zabbix Agent\n      9: #   [*enable_remote_commands*] - allow to run remote commands on host with Agent\n     10: #   [*firewall_allow_sources*] - sources allowed to connect to the service\n     11: #   [*hostname*] - unique, case sensitive hostname\n     12: #   [*hostname_item*] - Zabbix agent item used for getting host name\n     13: #   [*include*] - individual files or all files in a directory in the\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "lightblue-platform@lightblue-puppet-manifests-eap-truststore.pp", "content": "# TODO change this to use new Puppet iteration Syntax", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-eap-truststore.pp\n\ngroup  => 'jboss',\nmode   => '0600',\nnotify => Service['jbossas']\n}\n\n40:     # TODO change this to use new Puppet iteration Syntax\n# when we upgrade to Puppet 4 i.e. $certificates.each\n\n# For each certificate in $certificates:\n# Add it to the keystore used for truststore\ncreate_resources(lightblue::eap::truststore_file, $certificates)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-eap-truststore.pp\n# Target line: 40\n\n     35:         group  => 'jboss',\n     36:         mode   => '0600',\n     37:         notify => Service['jbossas']\n     38:     }\n     39: \n>>>  40:     # TODO change this to use new Puppet iteration Syntax\n     41:     # when we upgrade to Puppet 4 i.e. $certificates.each\n     42: \n     43:     # For each certificate in $certificates:\n     44:     # Add it to the keystore used for truststore\n     45:     create_resources(lightblue::eap::truststore_file, $certificates)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-zabbix-server.pp", "content": "#   [*slack_emoji_problem*] - Slack Emoji PROBLEM icon code", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-zabbix-server.pp\n\n#   [*maintenance_cron*] - maintanance script run Cron entries\n#   [*maintenance_script*] - maintanance script path\n#   [*maintenance_script_config*] - maintanance script MySQL config\n#   [*server_role*] - server mode\n#   [*slack_emoji_ok*] - Slack Emoji OK icon code\n14: #   [*slack_emoji_problem*] - Slack Emoji PROBLEM icon code\n#   [*slack_emoji_unknown*] - Slack Emoji UNKNOWN icon code\n#   [*slack_post_username*] - Slack user name for posting\n#   [*slack_web_hook_url*] - Slack web hook URL\n#\nclass fuel_project::roles::zabbix::server (", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-zabbix-server.pp\n# Target line: 14\n\n      9: #   [*maintenance_cron*] - maintanance script run Cron entries\n     10: #   [*maintenance_script*] - maintanance script path\n     11: #   [*maintenance_script_config*] - maintanance script MySQL config\n     12: #   [*server_role*] - server mode\n     13: #   [*slack_emoji_ok*] - Slack Emoji OK icon code\n>>>  14: #   [*slack_emoji_problem*] - Slack Emoji PROBLEM icon code\n     15: #   [*slack_emoji_unknown*] - Slack Emoji UNKNOWN icon code\n     16: #   [*slack_post_username*] - Slack user name for posting\n     17: #   [*slack_web_hook_url*] - Slack web hook URL\n     18: #\n     19: class fuel_project::roles::zabbix::server (\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@pltraining-bootstrap-manifests-profile-network.pp", "content": "# Remove the udev ethernet naming rules, causes problems when", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-network.pp\n\npath    => '/sbin',\nrequire => Exec['iptables -F'],\n}\n}\n\n23:   # Remove the udev ethernet naming rules, causes problems when\n# moving VMs around. This works for rhel/centos\nfile {'/etc/udev/rules.d/70-persistent-net.rules':\nensure   => absent,\nforce    => true,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-network.pp\n# Target line: 23\n\n     18:       path    => '/sbin',\n     19:       require => Exec['iptables -F'],\n     20:     }\n     21:   }\n     22: \n>>>  23:   # Remove the udev ethernet naming rules, causes problems when\n     24:   # moving VMs around. This works for rhel/centos\n     25:   file {'/etc/udev/rules.d/70-persistent-net.rules':\n     26:     ensure   => absent,\n     27:     force    => true,\n     28:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-tomcat-manifests-instance-install.pp", "content": "# TODO: managed mode with more options ?", "line": 164, "detection_span": [159, 169], "with_context": "# Puppet file: camptocamp@puppet-tomcat-manifests-instance-install.pp\n\n'absent'    => 'absent',\n160:   }\n161:\n162:   # Default rotation of catalina.out\n163:   # Not managed by default\n164:   # TODO: managed mode with more options ?\n165:   if $catalina_logrotate {\nfile{ \"/etc/logrotate.d/catalina-${name}\":\nensure  => $present,\nowner   => 'root',\ngroup   => 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-tomcat-manifests-instance-install.pp\n# Target line: 164\n\n    159:     'absent'    => 'absent',\n    160:   }\n    161: \n    162:   # Default rotation of catalina.out\n    163:   # Not managed by default\n>>> 164:   # TODO: managed mode with more options ?\n    165:   if $catalina_logrotate {\n    166:     file{ \"/etc/logrotate.d/catalina-${name}\":\n    167:       ensure  => $present,\n    168:       owner   => 'root',\n    169:       group   => 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "lightblue-platform@lightblue-puppet-manifests-service-plugin-statsd.pp", "content": "# $prefix   - (optional) Prefix used for statsd.", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-statsd.pp\n\n#\n# Deploys/Removes lightblue graphite environment variables.\n#\n# === Parameters\n#\n7: # $prefix   - (optional) Prefix used for statsd.\n#             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n# $hostname - Hostname of the statsd server.\n#             If not set, puppet will remove the environment variables.\n# $port     - Port the statsd server is listening on\n#             Defaults to 8125", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-statsd.pp\n# Target line: 7\n\n      2: #\n      3: # Deploys/Removes lightblue graphite environment variables.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # $prefix   - (optional) Prefix used for statsd.\n      8: #             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n      9: # $hostname - Hostname of the statsd server.\n     10: #             If not set, puppet will remove the environment variables.\n     11: # $port     - Port the statsd server is listening on\n     12: #             Defaults to 8125\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fraenki@puppet-galera-manifests-repo.pp", "content": "# FIXME: replace hardcoded values, specify includepkgs parameter", "line": 98, "detection_span": [93, 103], "with_context": "# Puppet file: fraenki@puppet-galera-manifests-repo.pp\n\n}\n\nif $epel_needed {\n# Needed for socat package\nyumrepo { \"${module_name}_epel\":\n98:           # FIXME: replace hardcoded values, specify includepkgs parameter\nmirrorlist     => \"https://mirrors.fedoraproject.org/metalink?repo=epel-${facts['os']['release']['major']}&arch=${facts['os']['architecture']}\",\nbaseurl        => 'absent',\nfailovermethod => 'priority',\nenabled        => '1',\ngpgcheck       => '1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-manifests-repo.pp\n# Target line: 98\n\n     93:       }\n     94: \n     95:       if $epel_needed {\n     96:         # Needed for socat package\n     97:         yumrepo { \"${module_name}_epel\":\n>>>  98:           # FIXME: replace hardcoded values, specify includepkgs parameter\n     99:           mirrorlist     => \"https://mirrors.fedoraproject.org/metalink?repo=epel-${facts['os']['release']['major']}&arch=${facts['os']['architecture']}\",\n    100:           baseurl        => 'absent',\n    101:           failovermethod => 'priority',\n    102:           enabled        => '1',\n    103:           gpgcheck       => '1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-provision-build_image.pp", "content": "# TODO(vsaienko): Use the same system packages for fuel image and ironic bootstrap, but exclude", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-provision-build_image.pp\n\n$data = loadyaml($data_file)\n}\n$cluster_id = $data['cluster']['id']\n\nif $data['ironic']['enabled'] == true {\n13:     # TODO(vsaienko): Use the same system packages for fuel image and ironic bootstrap, but exclude\n# not needed for ironic like nailgun-agent, etc...\n$ironic_packages = [\n'openssh-server',\n'ntp',\n'fuel-agent',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-provision-build_image.pp\n# Target line: 13\n\n      8:     $data = loadyaml($data_file)\n      9:   }\n     10:   $cluster_id = $data['cluster']['id']\n     11: \n     12:   if $data['ironic']['enabled'] == true {\n>>>  13:     # TODO(vsaienko): Use the same system packages for fuel image and ironic bootstrap, but exclude\n     14:     # not needed for ironic like nailgun-agent, etc...\n     15:     $ironic_packages = [\n     16:       'openssh-server',\n     17:       'ntp',\n     18:       'fuel-agent',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "garethr@garethr-diamond-manifests-init.pp", "content": "#   Define optional path_prefix for storing metrics", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: garethr@garethr-diamond-manifests-init.pp\n\n#\n# [*riemann_host*]\n#   Where to find the riemann server\n#\n# [*path_prefix*]\n46: #   Define optional path_prefix for storing metrics\n#\n# [*path_suffix*]\n#   Define optional path_suffix for storing metrics\n#\n# [*instance_prefix*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: garethr@garethr-diamond-manifests-init.pp\n# Target line: 46\n\n     41: #\n     42: # [*riemann_host*]\n     43: #   Where to find the riemann server\n     44: #\n     45: # [*path_prefix*]\n>>>  46: #   Define optional path_prefix for storing metrics\n     47: #\n     48: # [*path_suffix*]\n     49: #   Define optional path_suffix for storing metrics\n     50: #\n     51: # [*instance_prefix*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "CiscoSystems@puppet-openstack-manifests-compute.pp", "content": "# [fixed_range] Range of ipv4 network for vms.", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n\n#\n# [private_interface] Interface used for vm networking connectivity. Required.\n# [internal_address] Internal address used for management. Required.\n# [public_interface] Public interface used to route public traffic. Optional.\n#   Defaults to false.\n17: # [fixed_range] Range of ipv4 network for vms.\n# [network_manager] Nova network manager to use.\n# [multi_host] Rather node should support multi-host networking mode for HA.\n#   Optional. Defaults to false.\n# [network_config] Hash that can be used to pass implementation specifc\n#   network settings. Optioal. Defaults to {}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n# Target line: 17\n\n     12: #\n     13: # [private_interface] Interface used for vm networking connectivity. Required.\n     14: # [internal_address] Internal address used for management. Required.\n     15: # [public_interface] Public interface used to route public traffic. Optional.\n     16: #   Defaults to false.\n>>>  17: # [fixed_range] Range of ipv4 network for vms.\n     18: # [network_manager] Nova network manager to use.\n     19: # [multi_host] Rather node should support multi-host networking mode for HA.\n     20: #   Optional. Defaults to false.\n     21: # [network_config] Hash that can be used to pass implementation specifc\n     22: #   network settings. Optioal. Defaults to {}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mpm.pp", "content": "# workaround https://bugs.launchpad.net/ubuntu/+source/mpm-itk/+bug/1286882", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mpm.pp\n\n}\n}\n}\n\nif $mpm == 'itk' and $::operatingsystem == 'Ubuntu' and $::operatingsystemrelease == '14.04' {\n77:         # workaround https://bugs.launchpad.net/ubuntu/+source/mpm-itk/+bug/1286882\nexec {\n'/usr/sbin/a2dismod mpm_event':\nonlyif  => '/usr/bin/test -e /etc/apache2/mods-enabled/mpm_event.load',\nrequire => Package['httpd'],\nbefore  => Package['apache2-mpm-itk'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mpm.pp\n# Target line: 77\n\n     72:           }\n     73:         }\n     74:       }\n     75: \n     76:       if $mpm == 'itk' and $::operatingsystem == 'Ubuntu' and $::operatingsystemrelease == '14.04' {\n>>>  77:         # workaround https://bugs.launchpad.net/ubuntu/+source/mpm-itk/+bug/1286882\n     78:         exec {\n     79:           '/usr/sbin/a2dismod mpm_event':\n     80:             onlyif  => '/usr/bin/test -e /etc/apache2/mods-enabled/mpm_event.load',\n     81:             require => Package['httpd'],\n     82:             before  => Package['apache2-mpm-itk'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "# Adds a postfix configuration file.", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n# = Define: postfix::conffile\n#\n3: # Adds a postfix configuration file.\n# It is mainly a file resource that also restarts postfix\n#\n# == Parameters\n#\n# [*ensure*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 3\n\n      1: # = Define: postfix::conffile\n      2: #\n>>>   3: # Adds a postfix configuration file.\n      4: # It is mainly a file resource that also restarts postfix\n      5: #\n      6: # == Parameters\n      7: #\n      8: # [*ensure*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-logstash-manifests-conf.pp", "content": "#   logstash::conf { 'debug':", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-logstash-manifests-conf.pp\n\n# - $priority: Configuration loading priority. Default 10.\n# - $ensure: Whether the config should exist.\n#\n# == Sample usage:\n#\n19: #   logstash::conf { 'debug':\n#     content => 'output { stdout { codec => rubydebug } }'\n#   }\n#\ndefine logstash::conf(\n$ensure   = present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-logstash-manifests-conf.pp\n# Target line: 19\n\n     14: # - $priority: Configuration loading priority. Default 10.\n     15: # - $ensure: Whether the config should exist.\n     16: #\n     17: # == Sample usage:\n     18: #\n>>>  19: #   logstash::conf { 'debug':\n     20: #     content => 'output { stdout { codec => rubydebug } }'\n     21: #   }\n     22: #\n     23: define logstash::conf(\n     24:     $ensure   = present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp", "content": "# If we have a prefix, then add the dash to it", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n\n$ensure  = undef,\n) {\n\ninclude sysctl::base\n\n26:   # If we have a prefix, then add the dash to it\nif $prefix {\n$sysctl_d_file = \"${prefix}-${title}.conf\"\n} else {\n$sysctl_d_file = \"${title}.conf\"\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n# Target line: 26\n\n     21:   $ensure  = undef,\n     22: ) {\n     23: \n     24:   include sysctl::base\n     25: \n>>>  26:   # If we have a prefix, then add the dash to it\n     27:   if $prefix {\n     28:     $sysctl_d_file = \"${prefix}-${title}.conf\"\n     29:   } else {\n     30:     $sysctl_d_file = \"${title}.conf\"\n     31:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#- *ensure*: present/absent, defaults to present.\n#\n#Requires:\n#- Class[\"postfix\"]\n#- Postfix::Hash[\"/etc/postfix/canonical\"]\n13: #- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n#- augeas\n#\n#Example usage:\n#\n#  node \"toto.example.com\" {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 13\n\n      8: #- *ensure*: present/absent, defaults to present.\n      9: #\n     10: #Requires:\n     11: #- Class[\"postfix\"]\n     12: #- Postfix::Hash[\"/etc/postfix/canonical\"]\n>>>  13: #- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n     14: #- augeas\n     15: #\n     16: #Example usage:\n     17: #\n     18: #  node \"toto.example.com\" {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_control.pp", "content": "#TODO, Is this really needed?", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_control.pp\n\nfile { ['/etc/init/supervisor-control.override',\n'/etc/init/supervisor-dns.override'] :\nensure  => absent,\n} ->\nClass['contrail::delete_vnc_control']\n53:             #TODO, Is this really needed?\n# Below is temporary to work-around in Ubuntu as Service resource fails\n# as upstart is not correctly linked to /etc/init.d/service-name\n}\ndefault: {\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_control.pp\n# Target line: 53\n\n     48:                 file { ['/etc/init/supervisor-control.override',\n     49:                         '/etc/init/supervisor-dns.override'] :\n     50:                     ensure  => absent,\n     51:                 } ->\n     52:                 Class['contrail::delete_vnc_control']\n>>>  53:             #TODO, Is this really needed?\n     54:                 # Below is temporary to work-around in Ubuntu as Service resource fails\n     55:                 # as upstart is not correctly linked to /etc/init.d/service-name\n     56:         }\n     57:         default: {\n     58:         }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-openstack-manifests-profile-ceilometer-api.pp", "content": "# https://bugs.launchpad.net/cloud-archive/+bug/1281722", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-ceilometer-api.pp\n\ntime_to_live => '2592000'\n}\n\n# For the time being no upstart script are provided\n# in Ubuntu 12.04 Cloud Archive. Bug report filed\n50:   # https://bugs.launchpad.net/cloud-archive/+bug/1281722\n# https://bugs.launchpad.net/ubuntu/+source/ceilometer/+bug/1250002/comments/5\nif $::osfamily != 'Debian' {\nclass { '::ceilometer::alarm::notifier':\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-ceilometer-api.pp\n# Target line: 50\n\n     45:     time_to_live => '2592000'\n     46:   }\n     47: \n     48:   # For the time being no upstart script are provided\n     49:   # in Ubuntu 12.04 Cloud Archive. Bug report filed\n>>>  50:   # https://bugs.launchpad.net/cloud-archive/+bug/1281722\n     51:   # https://bugs.launchpad.net/ubuntu/+source/ceilometer/+bug/1250002/comments/5\n     52:   if $::osfamily != 'Debian' {\n     53:     class { '::ceilometer::alarm::notifier':\n     54:     }\n     55: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "duritong@puppet-shorewall-manifests-rules-out-razor.pp", "content": "# https://wiki.apache.org/spamassassin/NetTestFirewallIssues", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: duritong@puppet-shorewall-manifests-rules-out-razor.pp\n\n# razor calls out on 2703\n2: # https://wiki.apache.org/spamassassin/NetTestFirewallIssues\nclass shorewall::rules::out::razor {\nshorewall::rule { 'me-net-tcp_razor':\nsource          => '$FW',\ndestination     => 'net',\nproto           => 'tcp',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-shorewall-manifests-rules-out-razor.pp\n# Target line: 2\n\n      1: # razor calls out on 2703\n>>>   2: # https://wiki.apache.org/spamassassin/NetTestFirewallIssues\n      3: class shorewall::rules::out::razor {\n      4:   shorewall::rule { 'me-net-tcp_razor':\n      5:     source          => '$FW',\n      6:     destination     => 'net',\n      7:     proto           => 'tcp',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-mailman.pp", "content": "#   class { 'postfix':", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-mailman.pp\n\n# === Examples\n#\n# /!\\ Do not include this class directly,\n# use mailman => true in the postfix top class!\n#\n11: #   class { 'postfix':\n#     mailman => true,\n#   }\nclass postfix::mailman {\n\npostfix::config {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-mailman.pp\n# Target line: 11\n\n      6: # === Examples\n      7: #\n      8: # /!\\ Do not include this class directly,\n      9: # use mailman => true in the postfix top class!\n     10: #\n>>>  11: #   class { 'postfix':\n     12: #     mailman => true,\n     13: #   }\n     14: class postfix::mailman {\n     15: \n     16:   postfix::config {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "craigwatson@puppet-vmwaretools-manifests-params.pp", "content": "# https://projects.puppetlabs.com/issues/2833", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: craigwatson@puppet-vmwaretools-manifests-params.pp\n\n} else {\n$install_command = \"${vmwaretools::working_dir}/vmware-tools-distrib/vmware-install.pl -d\"\n}\n\n# Workaround for 'purge' bug on RH-based systems\n67:   # https://projects.puppetlabs.com/issues/2833\n# https://projects.puppetlabs.com/issues/11450\n# https://tickets.puppetlabs.com/browse/PUP-1198\n$purge_package_ensure = $facts['os']['family'] ? {\n'RedHat' => absent,\n'Suse'   => absent,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: craigwatson@puppet-vmwaretools-manifests-params.pp\n# Target line: 67\n\n     62:   } else {\n     63:     $install_command = \"${vmwaretools::working_dir}/vmware-tools-distrib/vmware-install.pl -d\"\n     64:   }\n     65: \n     66:   # Workaround for 'purge' bug on RH-based systems\n>>>  67:   # https://projects.puppetlabs.com/issues/2833\n     68:   # https://projects.puppetlabs.com/issues/11450\n     69:   # https://tickets.puppetlabs.com/browse/PUP-1198\n     70:   $purge_package_ensure = $facts['os']['family'] ? {\n     71:     'RedHat' => absent,\n     72:     'Suse'   => absent,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-init.pp", "content": "# FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n\n# XXX: does parted align disks properly ?\n# XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n# XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n\n# FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n57: # FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n# FIXME: can we setup gluster by using templated volume files instead ?\n\n# TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n# TODO: find out when ports are actually necessary for version 3.3\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n# Target line: 57\n\n     52: # XXX: does parted align disks properly ?\n     53: # XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n     54: # XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n     55: \n     56: # FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n>>>  57: # FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n     58: # FIXME: can we setup gluster by using templated volume files instead ?\n     59: \n     60: # TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n     61: # TODO: find out when ports are actually necessary for version 3.3\n     62: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-virtualenv-manifests-environment.pp", "content": "# This is a nasty hack which does not use package providers", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-virtualenv-manifests-environment.pp\n\n# == Class virtualenv\n# Helper class to install python packages via virtualenv.\n# Will create a virtualenv directory with the given packages.\n#\n5: # This is a nasty hack which does not use package providers\n# as puppet does not suppose using those with virtualenv:\n# https://tickets.puppetlabs.com/browse/PUP-1062\n#\n# === Parameters\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-virtualenv-manifests-environment.pp\n# Target line: 5\n\n      1: # == Class virtualenv\n      2: # Helper class to install python packages via virtualenv.\n      3: # Will create a virtualenv directory with the given packages.\n      4: #\n>>>   5: # This is a nasty hack which does not use package providers\n      6: # as puppet does not suppose using those with virtualenv:\n      7: # https://tickets.puppetlabs.com/browse/PUP-1062\n      8: #\n      9: # === Parameters\n     10: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-nginx-manifests-config-vhost-redirect.pp", "content": "#   Location to redirect to. A 301 permanent redirect will be issued and the", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config-vhost-redirect.pp\n\n# another location.\n#\n# === Parameters\n#\n# [*to*]\n9: #   Location to redirect to. A 301 permanent redirect will be issued and the\n#   query path of the original request will be appended. You probably want\n#   this to be an absolute URL starting with `http://` or `https://`\n#   otherwise you'll generate an infinite loop.\n#\n# [*certtype*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config-vhost-redirect.pp\n# Target line: 9\n\n      4: # another location.\n      5: #\n      6: # === Parameters\n      7: #\n      8: # [*to*]\n>>>   9: #   Location to redirect to. A 301 permanent redirect will be issued and the\n     10: #   query path of the original request will be appended. You probably want\n     11: #   this to be an absolute URL starting with `http://` or `https://`\n     12: #   otherwise you'll generate an infinite loop.\n     13: #\n     14: # [*certtype*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-post_openstack.pp", "content": "## TODO: document function", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-post_openstack.pp\n\n1: ## TODO: document function\ndefine contrail::lib::post_openstack(\n$host_control_ip,\n$openstack_ip_list,\n$internal_vip,\n$password  = $::contrail::params::os_mysql_service_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-post_openstack.pp\n# Target line: 1\n\n>>>   1: ## TODO: document function\n      2: define contrail::lib::post_openstack(\n      3:     $host_control_ip,\n      4:     $openstack_ip_list,\n      5:     $internal_vip,\n      6:     $password  = $::contrail::params::os_mysql_service_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp", "content": "# See <https://github.com/hashicorp/vagrant/issues/351>.", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n\nrefreshonly => true,\nnotify      => Service['apache2'],\n}\n\n# Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n39:     # See <https://github.com/hashicorp/vagrant/issues/351>.\napache::conf { 'disable sendfile':\ncontent => 'EnableSendfile Off',\n}\n\napache::conf { 'errors to syslog':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n# Target line: 39\n\n     34:         refreshonly => true,\n     35:         notify      => Service['apache2'],\n     36:     }\n     37: \n     38:     # Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n>>>  39:     # See <https://github.com/hashicorp/vagrant/issues/351>.\n     40:     apache::conf { 'disable sendfile':\n     41:         content => 'EnableSendfile Off',\n     42:     }\n     43: \n     44:     apache::conf { 'errors to syslog':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-firewall-rule.pp", "content": "if $port { # port is depricated. Use dport. FIXME report $port", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: norcams@himlar-profile-manifests-firewall-rule.pp\n\n$chain       = 'INPUT',\n$provider    = 'iptables',\n$extras      = {},\n) {\n\n30:   if $port { # port is depricated. Use dport. FIXME report $port\nwarning('NORCAMS: Use of $port in firewall rules are depricated! Use $dport.')\n$basic = {\n'dport'       => $port,\n'proto'       => $proto,\n'action'      => $action,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-firewall-rule.pp\n# Target line: 30\n\n     25:   $chain       = 'INPUT',\n     26:   $provider    = 'iptables',\n     27:   $extras      = {},\n     28: ) {\n     29: \n>>>  30:   if $port { # port is depricated. Use dport. FIXME report $port\n     31:     warning('NORCAMS: Use of $port in firewall rules are depricated! Use $dport.')\n     32:     $basic = {\n     33:       'dport'       => $port,\n     34:       'proto'       => $proto,\n     35:       'action'      => $action,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "# [*postfix_ensure*]      - (string) The ensure value of the postfix package", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\n# [*use_schleuder*]       - (2/boolean) Whether to setup for Schleuder\n#                           (2 -> Schleuder 2, 3 or true -> Schleuder 3)\n#\n# [*use_sympa*]           - (boolean) Whether to setup for Sympa\n#\n77: # [*postfix_ensure*]      - (string) The ensure value of the postfix package\n#\n# [*mailx_ensure*]        - (string) The ensure value of the mailx package\n#\n# === Examples\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 77\n\n     72: # [*use_schleuder*]       - (2/boolean) Whether to setup for Schleuder\n     73: #                           (2 -> Schleuder 2, 3 or true -> Schleuder 3)\n     74: #\n     75: # [*use_sympa*]           - (boolean) Whether to setup for Sympa\n     76: #\n>>>  77: # [*postfix_ensure*]      - (string) The ensure value of the postfix package\n     78: #\n     79: # [*mailx_ensure*]        - (string) The ensure value of the mailx package\n     80: #\n     81: # === Examples\n     82: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-puppet-manifests-puppetserver-config.pp", "content": "# https://tickets.puppetlabs.com/browse/PUP-1033", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-puppetserver-config.pp\n\ngroup  => undef,\nmode   => undef,\naudit  => 'content',\n}\n\n51:   # https://tickets.puppetlabs.com/browse/PUP-1033\nfile { [\n'/var/lib/puppet/lib/puppet/type',\n'/var/lib/puppet/lib/puppet/parser',\n]:\nensure  => undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-puppetserver-config.pp\n# Target line: 51\n\n     46:     group  => undef,\n     47:     mode   => undef,\n     48:     audit  => 'content',\n     49:   }\n     50: \n>>>  51:   # https://tickets.puppetlabs.com/browse/PUP-1033\n     52:   file { [\n     53:     '/var/lib/puppet/lib/puppet/type',\n     54:     '/var/lib/puppet/lib/puppet/parser',\n     55:     ]:\n     56:     ensure  => undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-haproxy-horizon_endpoint.pp", "content": "# isolation is not enabled. This is not a problem as both options are", "line": 103, "detection_span": [98, 108], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-haproxy-horizon_endpoint.pp\n\n# subjectaltnames set.\n$internal_bind_opts = union($haproxy_listen_bind_param, ['ssl', 'crt', $public_certificate])\n}\n# NOTE(jaosorior): If the internal_ip and the public_virtual_ip are the\n# same, the first option takes precedence. Which is the case when network\n103:     # isolation is not enabled. This is not a problem as both options are\n# identical. If network isolation is enabled, this works correctly and\n# will add a TLS binding to both the internal_ip and the\n# public_virtual_ip.\n# Even though for the public_virtual_ip the port 80 is listening, we\n# redirect to https in the horizon_options below.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-haproxy-horizon_endpoint.pp\n# Target line: 103\n\n     98:       # subjectaltnames set.\n     99:       $internal_bind_opts = union($haproxy_listen_bind_param, ['ssl', 'crt', $public_certificate])\n    100:     }\n    101:     # NOTE(jaosorior): If the internal_ip and the public_virtual_ip are the\n    102:     # same, the first option takes precedence. Which is the case when network\n>>> 103:     # isolation is not enabled. This is not a problem as both options are\n    104:     # identical. If network isolation is enabled, this works correctly and\n    105:     # will add a TLS binding to both the internal_ip and the\n    106:     # public_virtual_ip.\n    107:     # Even though for the public_virtual_ip the port 80 is listening, we\n    108:     # redirect to https in the horizon_options below.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-dhcp_agent_wrappers.pp", "content": "#   (Optional) Debug messages for the wrapper scripts.", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-dhcp_agent_wrappers.pp\n\n#   (Deprecated) Domain sockets that the wrappers should use for accessing\n#   the docker daemon.\n#   Defaults to hiera('docker_additional_sockets', ['/var/lib/openstack/docker.sock'])\n#\n# [*debug*]\n55: #   (Optional) Debug messages for the wrapper scripts.\n#   Defaults to False.\n#\nclass tripleo::profile::base::neutron::dhcp_agent_wrappers (\n$enable_dnsmasq_wrapper  = false,\n$dnsmasq_process_wrapper = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-dhcp_agent_wrappers.pp\n# Target line: 55\n\n     50: #   (Deprecated) Domain sockets that the wrappers should use for accessing\n     51: #   the docker daemon.\n     52: #   Defaults to hiera('docker_additional_sockets', ['/var/lib/openstack/docker.sock'])\n     53: #\n     54: # [*debug*]\n>>>  55: #   (Optional) Debug messages for the wrapper scripts.\n     56: #   Defaults to False.\n     57: #\n     58: class tripleo::profile::base::neutron::dhcp_agent_wrappers (\n     59:   $enable_dnsmasq_wrapper  = false,\n     60:   $dnsmasq_process_wrapper = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@puppet-openstack-integration-manifests-ceph.pp", "content": "admin_url    => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",", "line": 139, "detection_span": [134, 144], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n\npassword     => $password,\nuser         => $auth_name,\ntenant       => $project,\nroles        => ['admin', 'member'],\npublic_url   => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n139:         admin_url    => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\ninternal_url => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n}\n# FIXME(Xarses) remove when supported in puppet-ceph\nService<| tag == 'ceph-radosgw' |> -> Service <| tag == 'glance-service' |>\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n# Target line: 139\n\n    134:         password     => $password,\n    135:         user         => $auth_name,\n    136:         tenant       => $project,\n    137:         roles        => ['admin', 'member'],\n    138:         public_url   => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n>>> 139:         admin_url    => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n    140:         internal_url => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n    141:       }\n    142:       # FIXME(Xarses) remove when supported in puppet-ceph\n    143:       Service<| tag == 'ceph-radosgw' |> -> Service <| tag == 'glance-service' |>\n    144:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_postgres_java_install.pp", "content": "url             => 'http://download.oracle.com/otn-pub/java/jdk/7u71-b14/',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: danofthewired@puppet-bitbucket-examples-bitbucket_postgres_java_install.pp\n\n}->\nclass { '::postgresql::server': } ->\ndeploy::file { 'jdk-8u161-linux-x64.tar.gz':\ntarget          => '/opt/java',\nfetch_options   => '-q -c --header \"Cookie: oraclelicense=accept-securebackup-cookie\"',\n13:     url             => 'http://download.oracle.com/otn-pub/java/jdk/7u71-b14/',\ndownload_timout => 1800,\nstrip           => true,\n} ->\nclass { '::bitbucket':\nversion  => '5.10.0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: danofthewired@puppet-bitbucket-examples-bitbucket_postgres_java_install.pp\n# Target line: 13\n\n      8:   }->\n      9:   class { '::postgresql::server': } ->\n     10:   deploy::file { 'jdk-8u161-linux-x64.tar.gz':\n     11:     target          => '/opt/java',\n     12:     fetch_options   => '-q -c --header \"Cookie: oraclelicense=accept-securebackup-cookie\"',\n>>>  13:     url             => 'http://download.oracle.com/otn-pub/java/jdk/7u71-b14/',\n     14:     download_timout => 1800,\n     15:     strip           => true,\n     16:   } ->\n     17:   class { '::bitbucket':\n     18:     version  => '5.10.0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-package_source-yum_postgresql_org.pp", "content": "baseurl  => \"http://yum.postgresql.org/${version}/${label1}/${label2}-\\$releasever-\\$basearch\",", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-package_source-yum_postgresql_org.pp\n\n$label2 = 'rhel'\n}\n\nyumrepo { 'yum.postgresql.org':\ndescr    => \"PostgreSQL ${version} \\$releasever - \\$basearch\",\n23:     baseurl  => \"http://yum.postgresql.org/${version}/${label1}/${label2}-\\$releasever-\\$basearch\",\nenabled  => 1,\ngpgcheck => 1,\ngpgkey   => \"file:///etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG-${package_version}\",\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-package_source-yum_postgresql_org.pp\n# Target line: 23\n\n     18:     $label2 = 'rhel'\n     19:   }\n     20: \n     21:   yumrepo { 'yum.postgresql.org':\n     22:     descr    => \"PostgreSQL ${version} \\$releasever - \\$basearch\",\n>>>  23:     baseurl  => \"http://yum.postgresql.org/${version}/${label1}/${label2}-\\$releasever-\\$basearch\",\n     24:     enabled  => 1,\n     25:     gpgcheck => 1,\n     26:     gpgkey   => \"file:///etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG-${package_version}\",\n     27:   }\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$rabbitmq_uid                  = 495\n$rabbitmq_management_port      = 15672\n$rabbitmq_management_bind_ip   = '127.0.0.1'\n\n$cobbler_host                  = $::ipaddress\n69:   $cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n$cobbler_user                  = 'cobbler'\n$cobbler_password              = 'cobbler'\n$centos_repos = [\n{\n'id'   => 'nailgun',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 69\n\n     64:   $rabbitmq_uid                  = 495\n     65:   $rabbitmq_management_port      = 15672\n     66:   $rabbitmq_management_bind_ip   = '127.0.0.1'\n     67: \n     68:   $cobbler_host                  = $::ipaddress\n>>>  69:   $cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n     70:   $cobbler_user                  = 'cobbler'\n     71:   $cobbler_password              = 'cobbler'\n     72:   $centos_repos = [\n     73:     {\n     74:     'id'   => 'nailgun',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp", "content": "internal_url => \"http://${gnocchi_keystone_host_url}:8041\",", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n\nclass { '::gnocchi::keystone::auth':\nregion       => hiera('CONFIG_KEYSTONE_REGION'),\npassword     => hiera('CONFIG_GNOCCHI_KS_PW'),\npublic_url   => \"http://${gnocchi_keystone_host_url}:8041\",\nadmin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\n10:       internal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n# Target line: 10\n\n      5:     class { '::gnocchi::keystone::auth':\n      6:       region       => hiera('CONFIG_KEYSTONE_REGION'),\n      7:       password     => hiera('CONFIG_GNOCCHI_KS_PW'),\n      8:       public_url   => \"http://${gnocchi_keystone_host_url}:8041\",\n      9:       admin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\n>>>  10:       internal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n     11:     }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-params.pp", "content": "$api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"", "line": 191, "detection_span": [186, 196], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-params.pp\n\n186:   $use_ssl = $ssl[horizon] or $ssl[services]\n187:   if $use_ssl {\nif $ssl[horizon] {\n$api_url = \"https://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n} else {\n191:       $api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n}\n193:   } else {\n$api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n195:   }\n196:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-params.pp\n# Target line: 191\n\n    186:   $use_ssl = $ssl[horizon] or $ssl[services]\n    187:   if $use_ssl {\n    188:     if $ssl[horizon] {\n    189:       $api_url = \"https://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n    190:     } else {\n>>> 191:       $api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n    192:     }\n    193:   } else {\n    194:     $api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n    195:   }\n    196: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-neutron.pp", "content": "nova_url            => \"http://${controller_mgmt_address}:8774/v2/\",", "line": 135, "detection_span": [130, 140], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-neutron.pp\n\n}\n}\n132:   }\n133:\n134:   class { '::neutron::server::notifications':\n135:     nova_url            => \"http://${controller_mgmt_address}:8774/v2/\",\nnova_admin_auth_url => \"http://${keystone_ip_to_use}:35357/v2.0/\",\nnova_admin_password => $nova_password,\nnova_region_name    => $region_name,\nnova_admin_tenant_id => 'services'\n140:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-neutron.pp\n# Target line: 135\n\n    130:       }\n    131:     }\n    132:   }\n    133: \n    134:   class { '::neutron::server::notifications':\n>>> 135:     nova_url            => \"http://${controller_mgmt_address}:8774/v2/\",\n    136:     nova_admin_auth_url => \"http://${keystone_ip_to_use}:35357/v2.0/\",\n    137:     nova_admin_password => $nova_password,\n    138:     nova_region_name    => $region_name,\n    139:     nova_admin_tenant_id => 'services'\n    140:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@gds-boxen-modules-gds_virtualbox-manifests-init.pp", "content": "'4.3.26':  { $url = 'http://download.virtualbox.org/virtualbox/4.3.26/VirtualBox-4.3.26-98988-OSX.dmg' }", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: alphagov@gds-boxen-modules-gds_virtualbox-manifests-init.pp\n\n#\n#   include gds_virtualbox\n\nclass gds_virtualbox($version = 'recommended') {\ncase $version {\n9:     '4.3.26':  { $url = 'http://download.virtualbox.org/virtualbox/4.3.26/VirtualBox-4.3.26-98988-OSX.dmg' }\n'4.2.22':  { $url = 'http://download.virtualbox.org/virtualbox/4.2.22/VirtualBox-4.2.22-91556-OSX.dmg' }\ndefault:   { $url = 'http://download.virtualbox.org/virtualbox/4.3.14/VirtualBox-4.3.14-95030-OSX.dmg' }\n}\n\npackage { \"VirtualBox\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@gds-boxen-modules-gds_virtualbox-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: #   include gds_virtualbox\n      6: \n      7: class gds_virtualbox($version = 'recommended') {\n      8:   case $version {\n>>>   9:     '4.3.26':  { $url = 'http://download.virtualbox.org/virtualbox/4.3.26/VirtualBox-4.3.26-98988-OSX.dmg' }\n     10:     '4.2.22':  { $url = 'http://download.virtualbox.org/virtualbox/4.2.22/VirtualBox-4.2.22-91556-OSX.dmg' }\n     11:     default:   { $url = 'http://download.virtualbox.org/virtualbox/4.3.14/VirtualBox-4.3.14-95030-OSX.dmg' }\n     12:   }\n     13: \n     14:   package { \"VirtualBox\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp", "content": "location     => \"http://${apt_mirror_hostname}/gof3r\",", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n\n$ensure = 'absent'\n}\n\napt::source { 'gof3r':\nensure       => $ensure,\n28:     location     => \"http://${apt_mirror_hostname}/gof3r\",\nrelease      => $::lsbdistcodename,\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n# Target line: 28\n\n     23:     $ensure = 'absent'\n     24:   }\n     25: \n     26:   apt::source { 'gof3r':\n     27:     ensure       => $ensure,\n>>>  28:     location     => \"http://${apt_mirror_hostname}/gof3r\",\n     29:     release      => $::lsbdistcodename,\n     30:     architecture => $::architecture,\n     31:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     32:   }\n     33: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-nodes-mysql.pp", "content": "$rhel_mysql = 'http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm'", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-mysql.pp\n\n} else {\n$mysql_webserver_restart = false\n}\n\nif $::osfamily == 'redhat' {\n20:     $rhel_mysql = 'http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm'\nexec { 'mysql-community-repo':\ncommand => \"yum -y --nogpgcheck install '${rhel_mysql}' && touch /.puphpet-stuff/mysql-community-release\",\ncreates => '/.puphpet-stuff/mysql-community-release'\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-mysql.pp\n# Target line: 20\n\n     15:   } else {\n     16:     $mysql_webserver_restart = false\n     17:   }\n     18: \n     19:   if $::osfamily == 'redhat' {\n>>>  20:     $rhel_mysql = 'http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm'\n     21:     exec { 'mysql-community-repo':\n     22:       command => \"yum -y --nogpgcheck install '${rhel_mysql}' && touch /.puphpet-stuff/mysql-community-release\",\n     23:       creates => '/.puphpet-stuff/mysql-community-release'\n     24:     }\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-repoforgeextras.pp", "content": "baseurl  => 'http://apt.sw.be/redhat/el$releasever/en/$basearch/extras',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-repoforgeextras.pp\n\n#\nclass yum::repo::repoforgeextras {\n\nyum::managed_yumrepo { 'repoforgeextras':\ndescr    => 'RepoForge extra packages',\n9:     baseurl  => 'http://apt.sw.be/redhat/el$releasever/en/$basearch/extras',\nenabled  => 1,\ngpgcheck => 1,\ngpgkey   => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rpmforge-dag',\npriority => 1,\nexclude  => 'perl-IO-Compress-* perl-DBD-MySQL',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-repoforgeextras.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::repoforgeextras {\n      6: \n      7:   yum::managed_yumrepo { 'repoforgeextras':\n      8:     descr    => 'RepoForge extra packages',\n>>>   9:     baseurl  => 'http://apt.sw.be/redhat/el$releasever/en/$basearch/extras',\n     10:     enabled  => 1,\n     11:     gpgcheck => 1,\n     12:     gpgkey   => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rpmforge-dag',\n     13:     priority => 1,\n     14:     exclude  => 'perl-IO-Compress-* perl-DBD-MySQL',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "zend-patterns@ZendServerPuppet-manifests-repo-debian.pp", "content": "$zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n\ncase $::operatingsystem {\n'Ubuntu' : {\nif $::operatingsystemrelease + 0 >= 14.04 {\n$zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_apache2.4\"\n} else {\n28:         $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n}\n}\ndefault  : {\n$zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n# Target line: 28\n\n     23:   case $::operatingsystem {\n     24:     'Ubuntu' : {\n     25:       if $::operatingsystemrelease + 0 >= 14.04 {\n     26:         $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_apache2.4\"\n     27:       } else {\n>>>  28:         $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n     29:       }\n     30:     }\n     31:     default  : {\n     32:       $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n     33:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-logstash13.pp", "content": "baseurl        => 'http://packages.elasticsearch.org/logstash/1.3/centos',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-logstash13.pp\n\n#\nclass yum::repo::logstash13 {\n\nyum::managed_yumrepo { 'logstash-1.3':\ndescr          => 'logstash repository for 1.3.x packages',\n9:     baseurl        => 'http://packages.elasticsearch.org/logstash/1.3/centos',\nenabled        => 1,\ngpgcheck       => 1,\ngpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-logstash13.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::logstash13 {\n      6: \n      7:   yum::managed_yumrepo { 'logstash-1.3':\n      8:     descr          => 'logstash repository for 1.3.x packages',\n>>>   9:     baseurl        => 'http://packages.elasticsearch.org/logstash/1.3/centos',\n     10:     enabled        => 1,\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     13:   }\n     14: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@ci-puppet-modules-gds_mongodb-manifests-repo-mongodb2.pp", "content": "location    => 'http://downloads-distro.mongodb.org/repo/ubuntu-upstart',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@ci-puppet-modules-gds_mongodb-manifests-repo-mongodb2.pp\n\n# Add the packagree repo for mongodb 2 packages\nclass gds_mongodb::repo::mongodb2 {\n\nif $::lsbdistcodename == 'trusty' {\napt::source { '10gen':\n6:       location    => 'http://downloads-distro.mongodb.org/repo/ubuntu-upstart',\nrelease     => 'dist',\nrepos       => '10gen',\nkey         => '492EAFE8CD016A07919F1D2B9ECBEC467F0CEB10',\nkey_server  => 'hkp://keyserver.ubuntu.com:80',\ninclude_src => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-gds_mongodb-manifests-repo-mongodb2.pp\n# Target line: 6\n\n      1: # Add the packagree repo for mongodb 2 packages\n      2: class gds_mongodb::repo::mongodb2 {\n      3: \n      4:   if $::lsbdistcodename == 'trusty' {\n      5:     apt::source { '10gen':\n>>>   6:       location    => 'http://downloads-distro.mongodb.org/repo/ubuntu-upstart',\n      7:       release     => 'dist',\n      8:       repos       => '10gen',\n      9:       key         => '492EAFE8CD016A07919F1D2B9ECBEC467F0CEB10',\n     10:       key_server  => 'hkp://keyserver.ubuntu.com:80',\n     11:       include_src => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack-infra@puppet-openstackci-manifests-zuul_merger.pp", "content": "$zuul_url = \"http://${::fqdn}/p\",", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n\n$gerrit_server = '',\n$gerrit_user = '',\n$known_hosts_content = '',\n$zuul_ssh_private_key = '',\n$layout_file_name = 'layout.yaml',\n27:   $zuul_url = \"http://${::fqdn}/p\",\n$git_email = 'zuul@domain.example',\n$git_name = 'Zuul',\n$manage_common_zuul = true,\n$revision = 'master',\n$git_source_repo = 'https://git.openstack.org/openstack-infra/zuul',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n# Target line: 27\n\n     22:   $gerrit_server = '',\n     23:   $gerrit_user = '',\n     24:   $known_hosts_content = '',\n     25:   $zuul_ssh_private_key = '',\n     26:   $layout_file_name = 'layout.yaml',\n>>>  27:   $zuul_url = \"http://${::fqdn}/p\",\n     28:   $git_email = 'zuul@domain.example',\n     29:   $git_name = 'Zuul',\n     30:   $manage_common_zuul = true,\n     31:   $revision = 'master',\n     32:   $git_source_repo = 'https://git.openstack.org/openstack-infra/zuul',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "jippi@puppet-php-manifests-apt.pp", "content": "$location     = 'http://packages.dotdeb.org',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: jippi@puppet-php-manifests-apt.pp\n\n# === Copyright\n#\n# Copyright 2012-2015 Christian \"Jippi\" Winther, unless otherwise noted.\n#\nclass php::apt(\n26:   $location     = 'http://packages.dotdeb.org',\n$release      = 'wheezy-php55',\n$repos        = 'all',\n$include_src  = false,\n$dotdeb       = true\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: jippi@puppet-php-manifests-apt.pp\n# Target line: 26\n\n     21: # === Copyright\n     22: #\n     23: # Copyright 2012-2015 Christian \"Jippi\" Winther, unless otherwise noted.\n     24: #\n     25: class php::apt(\n>>>  26:   $location     = 'http://packages.dotdeb.org',\n     27:   $release      = 'wheezy-php55',\n     28:   $repos        = 'all',\n     29:   $include_src  = false,\n     30:   $dotdeb       = true\n     31: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@puppet-monasca-manifests-thresh.pp", "content": "$thresh_fetch_url = \"http://${blobmirror}/repos/monasca/monasca_thresh\"", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-thresh.pp\n\n$sql_host     = $::monasca::params::sql_host\n$sql_user     = $::monasca::params::sql_user\n$sql_password = $::monasca::params::sql_password\n$sql_port     = $::monasca::params::sql_port\n\n35:   $thresh_fetch_url = \"http://${blobmirror}/repos/monasca/monasca_thresh\"\n$latest_thresh_deb = \"/tmp/${mon_thresh_deb}\"\n$thresh_cfg_file = '/etc/monasca/thresh-config.yml'\n$startup_script = '/etc/init.d/monasca-thresh'\n$startup_script_src = 'puppet:///modules/monasca/monasca-thresh'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-thresh.pp\n# Target line: 35\n\n     30:   $sql_host     = $::monasca::params::sql_host\n     31:   $sql_user     = $::monasca::params::sql_user\n     32:   $sql_password = $::monasca::params::sql_password\n     33:   $sql_port     = $::monasca::params::sql_port\n     34: \n>>>  35:   $thresh_fetch_url = \"http://${blobmirror}/repos/monasca/monasca_thresh\"\n     36:   $latest_thresh_deb = \"/tmp/${mon_thresh_deb}\"\n     37:   $thresh_cfg_file = '/etc/monasca/thresh-config.yml'\n     38:   $startup_script = '/etc/init.d/monasca-thresh'\n     39:   $startup_script_src = 'puppet:///modules/monasca/monasca-thresh'\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "quintel@boxen-modules-firefox-manifests-aurora.pp", "content": "source   => \"http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-aurora/firefox-26.0a2.${locale}.mac.dmg\",", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: quintel@boxen-modules-firefox-manifests-aurora.pp\n\n# Examples\n#\n#   include firefox::aurora\nclass firefox::aurora ($locale = 'en-US'){\npackage { 'Firefox-Aurora':\n8:     source   => \"http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-aurora/firefox-26.0a2.${locale}.mac.dmg\",\nprovider => 'appdmg'\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-firefox-manifests-aurora.pp\n# Target line: 8\n\n      3: # Examples\n      4: #\n      5: #   include firefox::aurora\n      6: class firefox::aurora ($locale = 'en-US'){\n      7:   package { 'Firefox-Aurora':\n>>>   8:     source   => \"http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-aurora/firefox-26.0a2.${locale}.mac.dmg\",\n      9:     provider => 'appdmg'\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "voxpupuli@puppet-jira-examples-jira_postgres_nginx_install.pp", "content": "proxy                => 'http://jira',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: voxpupuli@puppet-jira-examples-jira_postgres_nginx_install.pp\n\n\nnginx::resource::vhost { 'jira_vhost':\nensure               => present,\nserver_name          => [ $facts['ipaddress'], $facts['fqdn'], $facts['hostname'] ],\nlisten_port          => '80',\n37:     proxy                => 'http://jira',\nproxy_read_timeout   => '300',\nlocation_cfg_prepend => {\n'proxy_set_header X-Forwarded-Host'   => '$host',\n'proxy_set_header X-Forwarded-Server' => '$host',\n'proxy_set_header X-Forwarded-For'    => '$proxy_add_x_forwarded_for',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-jira-examples-jira_postgres_nginx_install.pp\n# Target line: 37\n\n     32: \n     33:   nginx::resource::vhost { 'jira_vhost':\n     34:     ensure               => present,\n     35:     server_name          => [ $facts['ipaddress'], $facts['fqdn'], $facts['hostname'] ],\n     36:     listen_port          => '80',\n>>>  37:     proxy                => 'http://jira',\n     38:     proxy_read_timeout   => '300',\n     39:     location_cfg_prepend => {\n     40:       'proxy_set_header X-Forwarded-Host'   => '$host',\n     41:       'proxy_set_header X-Forwarded-Server' => '$host',\n     42:       'proxy_set_header X-Forwarded-For'    => '$proxy_add_x_forwarded_for',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-gcloud.pp", "content": "location     => \"http://${apt_mirror_hostname}/google-cloud-sdk-trusty\",", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-gcloud.pp\n\n#\nclass govuk_ci::agent::gcloud (\n$apt_mirror_hostname,\n){\napt::source { 'google-cloud-sdk-trusty':\n14:     location     => \"http://${apt_mirror_hostname}/google-cloud-sdk-trusty\",\nrelease      => 'stable',\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-gcloud.pp\n# Target line: 14\n\n      9: #\n     10: class govuk_ci::agent::gcloud (\n     11:   $apt_mirror_hostname,\n     12: ){\n     13:   apt::source { 'google-cloud-sdk-trusty':\n>>>  14:     location     => \"http://${apt_mirror_hostname}/google-cloud-sdk-trusty\",\n     15:     release      => 'stable',\n     16:     architecture => $::architecture,\n     17:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     18:   }\n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp", "content": "mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=5.0-updates',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n\npriority       => 10,\n}\n\nyum::managed_yumrepo { 'jpackage-generic-5.0-updates':\ndescr          => 'JPackage (free), generic updates',\n21:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=5.0-updates',\nfailovermethod => 'priority',\ngpgcheck       => 1,\ngpgkey         => 'http://www.jpackage.org/jpackage.asc',\nenabled        => 1,\npriority       => 10,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n# Target line: 21\n\n     16:     priority       => 10,\n     17:   }\n     18: \n     19:   yum::managed_yumrepo { 'jpackage-generic-5.0-updates':\n     20:     descr          => 'JPackage (free), generic updates',\n>>>  21:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=5.0-updates',\n     22:     failovermethod => 'priority',\n     23:     gpgcheck       => 1,\n     24:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     25:     enabled        => 1,\n     26:     priority       => 10,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-base.pp", "content": "location     => 'http://apt.production.alphagov.co.uk/rbenv-ruby',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-base.pp\n\nclass ci_environment::base {\napt::ppa { 'ppa:gds/govuk': }\n\nif $::lsbdistcodename == 'trusty' {\napt::source { 'govuk-rbenv':\n10:       location     => 'http://apt.production.alphagov.co.uk/rbenv-ruby',\nrelease      => $::lsbdistcodename,\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\ninclude_src  => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-base.pp\n# Target line: 10\n\n      5: class ci_environment::base {\n      6:   apt::ppa { 'ppa:gds/govuk': }\n      7: \n      8:   if $::lsbdistcodename == 'trusty' {\n      9:     apt::source { 'govuk-rbenv':\n>>>  10:       location     => 'http://apt.production.alphagov.co.uk/rbenv-ruby',\n     11:       release      => $::lsbdistcodename,\n     12:       architecture => $::architecture,\n     13:       key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     14:       include_src  => false,\n     15:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp", "content": "$jemalloc_url = 'http://files.puphpet.com/centos6/jemalloc-3.6.0-1.el6.x86_64.rpm'", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n\nif $lsbdistcodename in ['lucid', 'precise'] {\napt::ppa { 'ppa:mapnik/boost': require => Apt::Key['5D50B6BA'], options => '' }\n}\n}\n'centos': {\n53:       $jemalloc_url = 'http://files.puphpet.com/centos6/jemalloc-3.6.0-1.el6.x86_64.rpm'\n$jemalloc_download_location = '/.puphpet-stuff/jemalloc-3.6.0-1.el6.x86_64.rpm'\n\n$require = defined(Class['my_fw::post']) ? {\ntrue    => Class['my_fw::post'],\ndefault => [],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n# Target line: 53\n\n     48:       if $lsbdistcodename in ['lucid', 'precise'] {\n     49:         apt::ppa { 'ppa:mapnik/boost': require => Apt::Key['5D50B6BA'], options => '' }\n     50:       }\n     51:     }\n     52:     'centos': {\n>>>  53:       $jemalloc_url = 'http://files.puphpet.com/centos6/jemalloc-3.6.0-1.el6.x86_64.rpm'\n     54:       $jemalloc_download_location = '/.puphpet-stuff/jemalloc-3.6.0-1.el6.x86_64.rpm'\n     55: \n     56:       $require = defined(Class['my_fw::post']) ? {\n     57:         true    => Class['my_fw::post'],\n     58:         default => [],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "norcams@himlar-profile-manifests-monitoring-netdata-haproxy.pp", "content": "$stats_url = \"http://${::ipaddress_public1}:9000/;csv;norefresh\"", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: norcams@himlar-profile-manifests-monitoring-netdata-haproxy.pp\n\n#\nclass profile::monitoring::netdata::haproxy(\n3:   $stats_url = \"http://${::ipaddress_public1}:9000/;csv;norefresh\"\n) {\n\nfile_line { 'netdata-haproxy':\nensure  => present,\npath    => '/opt/netdata/netdata-configs/python.d/haproxy.conf',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-monitoring-netdata-haproxy.pp\n# Target line: 3\n\n      1: #\n      2: class profile::monitoring::netdata::haproxy(\n>>>   3:   $stats_url = \"http://${::ipaddress_public1}:9000/;csv;norefresh\"\n      4:   ) {\n      5: \n      6:   file_line { 'netdata-haproxy':\n      7:     ensure  => present,\n      8:     path    => '/opt/netdata/netdata-configs/python.d/haproxy.conf',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elrepo.pp", "content": "mirrorlist     => \"http://elrepo.org/mirrors-elrepo.${release}\",", "line": 63, "detection_span": [58, 68], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elrepo.pp\n\n}\n\nyum::managed_yumrepo { 'elrepo':\ndescr          => \"ELRepo.org Community Enterprise Linux Repository - ${release}\",\nbaseurl        => $baseurl_elrepo,\n63:     mirrorlist     => \"http://elrepo.org/mirrors-elrepo.${release}\",\nenabled        => 1,\ngpgcheck       => 1,\ngpgkey         => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-elrepo.org',\ngpgkey_source  => 'puppet:///modules/yum/rpm-gpg/RPM-GPG-KEY-elrepo.org',\nfailovermethod => 'priority',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elrepo.pp\n# Target line: 63\n\n     58:   }\n     59: \n     60:   yum::managed_yumrepo { 'elrepo':\n     61:     descr          => \"ELRepo.org Community Enterprise Linux Repository - ${release}\",\n     62:     baseurl        => $baseurl_elrepo,\n>>>  63:     mirrorlist     => \"http://elrepo.org/mirrors-elrepo.${release}\",\n     64:     enabled        => 1,\n     65:     gpgcheck       => 1,\n     66:     gpgkey         => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-elrepo.org',\n     67:     gpgkey_source  => 'puppet:///modules/yum/rpm-gpg/RPM-GPG-KEY-elrepo.org',\n     68:     failovermethod => 'priority',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp", "content": "glance_api_servers            => \"http://${nova_common_rabbitmq_cfg_storage_host}:9292\",", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n\nclass { '::nova::logging':\ndebug => hiera('CONFIG_DEBUG_MODE'),\n}\n\nclass { '::nova':\n65:       glance_api_servers            => \"http://${nova_common_rabbitmq_cfg_storage_host}:9292\",\ndefault_transport_url         => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\nrabbit_use_ssl                => hiera('CONFIG_AMQP_SSL_ENABLED'),\nnova_public_key               => $public_key,\nnova_private_key              => $private_key,\nkombu_ssl_ca_certs            => $kombu_ssl_ca_certs,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n# Target line: 65\n\n     60:     class { '::nova::logging':\n     61:       debug => hiera('CONFIG_DEBUG_MODE'),\n     62:     }\n     63: \n     64:     class { '::nova':\n>>>  65:       glance_api_servers            => \"http://${nova_common_rabbitmq_cfg_storage_host}:9292\",\n     66:       default_transport_url         => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\n     67:       rabbit_use_ssl                => hiera('CONFIG_AMQP_SSL_ENABLED'),\n     68:       nova_public_key               => $public_key,\n     69:       nova_private_key              => $private_key,\n     70:       kombu_ssl_ca_certs            => $kombu_ssl_ca_certs,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "voxpupuli@puppet-nginx-examples-location_params.pp", "content": "server        => 'www.test.com',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: voxpupuli@puppet-nginx-examples-location_params.pp\n\ninclude nginx\n\nnginx::resource::location { 'www.test.com-params':\nensure        => present,\nlocation      => '/some/url',\n6:     server        => 'www.test.com',\nfastcgi_param => {\n'APP_ENV'     => 'production',\n'APP_VERSION' => '0.1.10',\n'APP_SECRET'  => 'hisfaihicasagfkjsa',\n},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-nginx-examples-location_params.pp\n# Target line: 6\n\n      1: include nginx\n      2: \n      3: nginx::resource::location { 'www.test.com-params':\n      4:     ensure        => present,\n      5:     location      => '/some/url',\n>>>   6:     server        => 'www.test.com',\n      7:     fastcgi_param => {\n      8:       'APP_ENV'     => 'production',\n      9:       'APP_VERSION' => '0.1.10',\n     10:       'APP_SECRET'  => 'hisfaihicasagfkjsa',\n     11:     },\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-backup-manifests-repo.pp", "content": "location     => \"http://${apt_mirror_hostname}/duplicity\",", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-backup-manifests-repo.pp\n\n#\nclass backup::repo (\n$apt_mirror_hostname,\n) {\napt::source { 'duplicity':\n14:     location     => \"http://${apt_mirror_hostname}/duplicity\",\nrelease      => $::lsbdistcodename,\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-backup-manifests-repo.pp\n# Target line: 14\n\n      9: #\n     10: class backup::repo (\n     11:   $apt_mirror_hostname,\n     12: ) {\n     13:   apt::source { 'duplicity':\n>>>  14:     location     => \"http://${apt_mirror_hostname}/duplicity\",\n     15:     release      => $::lsbdistcodename,\n     16:     architecture => $::architecture,\n     17:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     18:   }\n     19: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp", "content": "location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n\n$config = {},\n$init_defaults_file = 'puppet:///modules/performanceplatform/etc/sysconfig/logstash.dev.defaults',\n) {\n\napt::source { 'logstash':\n7:     location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\nrelease     => 'stable',\nrepos       => 'main',\nkey         => 'D88E42B4',\nkey_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\ninclude_src => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n# Target line: 7\n\n      2:   $config = {},\n      3:   $init_defaults_file = 'puppet:///modules/performanceplatform/etc/sysconfig/logstash.dev.defaults',\n      4: ) {\n      5: \n      6:   apt::source { 'logstash':\n>>>   7:     location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\n      8:     release     => 'stable',\n      9:     repos       => 'main',\n     10:     key         => 'D88E42B4',\n     11:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     12:     include_src => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "puppetlabs@puppetlabs-openstack-manifests-profile-keystone.pp", "content": "admin_url    => \"http://${::openstack::config::controller_address_management}:35357\",", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-keystone.pp\n\nadmin_tenant => 'admin',\n}\n\nclass { 'keystone::endpoint':\npublic_url   => \"http://${::openstack::config::controller_address_api}:5000\",\n17:     admin_url    => \"http://${::openstack::config::controller_address_management}:35357\",\ninternal_url => \"http://${::openstack::config::controller_address_management}:5000\",\nregion       => $::openstack::config::region,\n}\n\nif $::openstack::config::keystone_use_httpd == true {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-keystone.pp\n# Target line: 17\n\n     12:     admin_tenant => 'admin',\n     13:   }\n     14: \n     15:   class { 'keystone::endpoint':\n     16:     public_url   => \"http://${::openstack::config::controller_address_api}:5000\",\n>>>  17:     admin_url    => \"http://${::openstack::config::controller_address_management}:35357\",\n     18:     internal_url => \"http://${::openstack::config::controller_address_management}:5000\",\n     19:     region       => $::openstack::config::region,\n     20:   }\n     21: \n     22:   if $::openstack::config::keystone_use_httpd == true {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mattheath@puppet-php-manifests-extension-memcache.pp", "content": "$url = \"http://pecl.php.net/get/memcache-${version}.tgz\"", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: mattheath@puppet-php-manifests-extension-memcache.pp\n\nrequire join(['php', join(split($php, '[.]'), '_')], '::')\n\n\n$extension = 'memcache'\n$package_name = \"memcache-${version}\"\n24:   $url = \"http://pecl.php.net/get/memcache-${version}.tgz\"\n\n# Final module install path\n$module_path = \"${php::config::root}/versions/${php}/modules/${extension}.so\"\n\nphp_extension { $name:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: mattheath@puppet-php-manifests-extension-memcache.pp\n# Target line: 24\n\n     19:   require join(['php', join(split($php, '[.]'), '_')], '::')\n     20: \n     21: \n     22:   $extension = 'memcache'\n     23:   $package_name = \"memcache-${version}\"\n>>>  24:   $url = \"http://pecl.php.net/get/memcache-${version}.tgz\"\n     25: \n     26:   # Final module install path\n     27:   $module_path = \"${php::config::root}/versions/${php}/modules/${extension}.so\"\n     28: \n     29:   php_extension { $name:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",", "line": 116, "detection_span": [111, 121], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\npassword         => $nova_password,\npublic_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\nadmin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\ninternal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\npublic_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\n116:     admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\ninternal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\nregion           => $region_name,\n119:   } ->\n120:   class { '::neutron::keystone::auth':\npassword         => $neutron_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 116\n\n    111:     password         => $nova_password,\n    112:     public_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    113:     admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    114:     internal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    115:     public_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\n>>> 116:     admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\n    117:     internal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\n    118:     region           => $region_name,\n    119:   } ->\n    120:   class { '::neutron::keystone::auth':\n    121:     password         => $neutron_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "admin_url        => \"http://$openstack_ip_to_use:8777\",", "line": 130, "detection_span": [125, 135], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\nregion           => $region_name,\n126:   } ->\n127:   class { '::ceilometer::keystone::auth':\npassword         => $ceilometer_password,\npublic_url       => \"http://$openstack_ip_to_use:8777\",\n130:     admin_url        => \"http://$openstack_ip_to_use:8777\",\ninternal_url     => \"http://$openstack_ip_to_use:8777\",\nregion           => $region_name,\n133:   } ->\n134:   class { '::heat::keystone::auth':\npassword         => $heat_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 130\n\n    125:     region           => $region_name,\n    126:   } ->\n    127:   class { '::ceilometer::keystone::auth':\n    128:     password         => $ceilometer_password,\n    129:     public_url       => \"http://$openstack_ip_to_use:8777\",\n>>> 130:     admin_url        => \"http://$openstack_ip_to_use:8777\",\n    131:     internal_url     => \"http://$openstack_ip_to_use:8777\",\n    132:     region           => $region_name,\n    133:   } ->\n    134:   class { '::heat::keystone::auth':\n    135:     password         => $heat_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "proxy               => \"http://${::fqdn}:9200\",", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\nssl_cache           => 'shared:SSL:10m',\nssl_port            => 9201,\nssl_session_timeout => '10m',\nssl_stapling        => true,\nssl_stapling_verify => true,\n87:       proxy               => \"http://${::fqdn}:9200\",\nproxy_read_timeout  => 120,\naccess_log          => $nginx_elastic_access_log,\nerror_log           => $nginx_elastic_error_log,\nformat_log          => $nginx_log_format,\nlocation_cfg_append => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 87\n\n     82:       ssl_cache           => 'shared:SSL:10m',\n     83:       ssl_port            => 9201,\n     84:       ssl_session_timeout => '10m',\n     85:       ssl_stapling        => true,\n     86:       ssl_stapling_verify => true,\n>>>  87:       proxy               => \"http://${::fqdn}:9200\",\n     88:       proxy_read_timeout  => 120,\n     89:       access_log          => $nginx_elastic_access_log,\n     90:       error_log           => $nginx_elastic_error_log,\n     91:       format_log          => $nginx_log_format,\n     92:       location_cfg_append => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@puppet-neutron-manifests-plugins-midonet.pp", "content": "'MIDONET/midonet_uri':  value => \"http://${cluster_ip}:${cluster_port}/midonet-api\";", "line": 149, "detection_span": [144, 154], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-midonet.pp\n\nname   => $::neutron::params::midonet_server_package,\ntag    => ['neutron-package', 'openstack'],\n}\n147:\n148:   neutron_plugin_midonet {\n149:     'MIDONET/midonet_uri':  value => \"http://${cluster_ip}:${cluster_port}/midonet-api\";\n'MIDONET/username':     value => $keystone_username;\n'MIDONET/password':     value => $keystone_password, secret =>true;\n'MIDONET/project_id':   value => $keystone_tenant;\n153:   }\n154:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-midonet.pp\n# Target line: 149\n\n    144:     name   => $::neutron::params::midonet_server_package,\n    145:     tag    => ['neutron-package', 'openstack'],\n    146:     }\n    147: \n    148:   neutron_plugin_midonet {\n>>> 149:     'MIDONET/midonet_uri':  value => \"http://${cluster_ip}:${cluster_port}/midonet-api\";\n    150:     'MIDONET/username':     value => $keystone_username;\n    151:     'MIDONET/password':     value => $keystone_password, secret =>true;\n    152:     'MIDONET/project_id':   value => $keystone_tenant;\n    153:   }\n    154: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "puppetlabs@puppetlabs-openstack-manifests-profile-tempest.pp", "content": "'boto/ec2_url':            value => \"http://${api_ip}:8773/services/Cloud\";", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-tempest.pp\n\npath    => $::tempest::tempest_conf,\nrequire => File[$::tempest::tempest_conf],\n}\n\ntempest_config {\n49:     'boto/ec2_url':            value => \"http://${api_ip}:8773/services/Cloud\";\n'boto/s3_url':             value => \"http://${api_ip}:3333\";\n'dashboard/dashboard_url': value => \"http://${api_ip}/\";\n'dashboard/login_url':     value => \"http://${api_ip}/dashboard\";\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-tempest.pp\n# Target line: 49\n\n     44:     path    => $::tempest::tempest_conf,\n     45:     require => File[$::tempest::tempest_conf],\n     46:   }\n     47: \n     48:   tempest_config {\n>>>  49:     'boto/ec2_url':            value => \"http://${api_ip}:8773/services/Cloud\";\n     50:     'boto/s3_url':             value => \"http://${api_ip}:3333\";\n     51:     'dashboard/dashboard_url': value => \"http://${api_ip}/\";\n     52:     'dashboard/login_url':     value => \"http://${api_ip}/dashboard\";\n     53:   }\n     54: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "internal_url_v3 => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\npublic_url_v2   => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\nadmin_url_v2    => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\ninternal_url_v2 => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\npublic_url_v3   => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\nadmin_url_v3    => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n87:       internal_url_v3 => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\nregion          => $region_name,\n}\n} else {\nclass { '::cinder::keystone::auth':\npassword        => $cinder_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 87\n\n     82:       public_url_v2   => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\n     83:       admin_url_v2    => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\n     84:       internal_url_v2 => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\n     85:       public_url_v3   => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n     86:       admin_url_v3    => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n>>>  87:       internal_url_v3 => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n     88:       region          => $region_name,\n     89:     }\n     90:   } else {\n     91:     class { '::cinder::keystone::auth':\n     92:       password        => $cinder_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch90.pp", "content": "baseurl        => 'http://packages.elasticsearch.org/elasticsearch/0.90/centos',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch90.pp\n\n#\nclass yum::repo::elasticsearch90 {\n\nyum::managed_yumrepo { 'elasticsearch-0.90':\ndescr          => 'Elasticsearch repository for 0.90.x packages',\n9:     baseurl        => 'http://packages.elasticsearch.org/elasticsearch/0.90/centos',\nenabled        => 1,\ngpgcheck       => 1,\ngpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch90.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::elasticsearch90 {\n      6: \n      7:   yum::managed_yumrepo { 'elasticsearch-0.90':\n      8:     descr          => 'Elasticsearch repository for 0.90.x packages',\n>>>   9:     baseurl        => 'http://packages.elasticsearch.org/elasticsearch/0.90/centos',\n     10:     enabled        => 1,\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     13:   }\n     14: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",", "line": 113, "detection_span": [108, 118], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\nregion       => $region_name,\n109:   } ->\n110:   class { '::nova::keystone::auth':\npassword         => $nova_password,\npublic_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n113:     admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\ninternal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\npublic_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\nadmin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\ninternal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\nregion           => $region_name,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 113\n\n    108:     region       => $region_name,\n    109:   } ->\n    110:   class { '::nova::keystone::auth':\n    111:     password         => $nova_password,\n    112:     public_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n>>> 113:     admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    114:     internal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    115:     public_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\n    116:     admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\n    117:     internal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\n    118:     region           => $region_name,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-elasticsearch-manifests-template.pp", "content": "$es_url = \"http://${host}:${port}/_template/${name}\"", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-elasticsearch-manifests-template.pp\n\ntries     => 3,\ntry_sleep => 10\n}\n\n# Build up the url\n67:   $es_url = \"http://${host}:${port}/_template/${name}\"\n\n# Can't do a replace and delete at the same time\n\nif ($ensure == 'present') {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-elasticsearch-manifests-template.pp\n# Target line: 67\n\n     62:     tries     => 3,\n     63:     try_sleep => 10\n     64:   }\n     65: \n     66:   # Build up the url\n>>>  67:   $es_url = \"http://${host}:${port}/_template/${name}\"\n     68: \n     69:   # Can't do a replace and delete at the same time\n     70: \n     71:   if ($ensure == 'present') {\n     72: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "quintel@boxen-modules-sublime_text_2-manifests-init.pp", "content": "source   => 'http://c758482.r82.cf2.rackcdn.com/Sublime%20Text%202.0.2.dmg';", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: quintel@boxen-modules-sublime_text_2-manifests-init.pp\n\n#\n#     include sublime_text_2\nclass sublime_text_2 {\npackage { 'SublimeText2':\nprovider => 'appdmg',\n9:     source   => 'http://c758482.r82.cf2.rackcdn.com/Sublime%20Text%202.0.2.dmg';\n}\n\nfile { \"${boxen::config::bindir}/subl\":\nensure  => link,\ntarget  => '/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-sublime_text_2-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: #     include sublime_text_2\n      6: class sublime_text_2 {\n      7:   package { 'SublimeText2':\n      8:     provider => 'appdmg',\n>>>   9:     source   => 'http://c758482.r82.cf2.rackcdn.com/Sublime%20Text%202.0.2.dmg';\n     10:   }\n     11: \n     12:   file { \"${boxen::config::bindir}/subl\":\n     13:     ensure  => link,\n     14:     target  => '/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-10gen.pp", "content": "baseurl     => \"http://downloads-distro.mongodb.org/repo/redhat/os/${::architecture}\",", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-10gen.pp\n\n# This class installs the 10gen repo for MongoDB\n#\nclass yum::repo::10gen {\nyum::managed_yumrepo { '10gen':\ndescr       => '10gen Repository',\n8:     baseurl     => \"http://downloads-distro.mongodb.org/repo/redhat/os/${::architecture}\",\nenabled     => 1,\ngpgcheck    => 0,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-10gen.pp\n# Target line: 8\n\n      3: # This class installs the 10gen repo for MongoDB\n      4: #\n      5: class yum::repo::10gen {\n      6:   yum::managed_yumrepo { '10gen':\n      7:     descr       => '10gen Repository',\n>>>   8:     baseurl     => \"http://downloads-distro.mongodb.org/repo/redhat/os/${::architecture}\",\n      9:     enabled     => 1,\n     10:     gpgcheck    => 0,\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-elasticsearch.pp", "content": "location    => 'http://packages.elasticsearch.org/elasticsearch/1.3/debian',", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-elasticsearch.pp\n\nhandlers => ['default'],\nrequire  => Package['rest-client'],\n}\n\napt::source { 'elasticsearch':\n55:     location    => 'http://packages.elasticsearch.org/elasticsearch/1.3/debian',\nrelease     => 'stable',\nrepos       => 'main',\nkey         => 'D88E42B4',\nkey_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\ninclude_src => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-elasticsearch.pp\n# Target line: 55\n\n     50:     handlers => ['default'],\n     51:     require  => Package['rest-client'],\n     52:   }\n     53: \n     54:   apt::source { 'elasticsearch':\n>>>  55:     location    => 'http://packages.elasticsearch.org/elasticsearch/1.3/debian',\n     56:     release     => 'stable',\n     57:     repos       => 'main',\n     58:     key         => 'D88E42B4',\n     59:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     60:     include_src => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-scholarships.pp", "content": "callback_url => \"http://${::scholarships::vhost_name}${::port_fragment}/\",", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-scholarships.pp\n\n\nrole::oauth::consumer { 'Wikimania Scholarships':\ndescription  => 'Wikimania Scholarships',\nconsumer_key => $oauth_consumer_key,\nsecret_key   => $oauth_secret_key,\n18:         callback_url => \"http://${::scholarships::vhost_name}${::port_fragment}/\",\ngrants       => ['authonlyprivate'],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-scholarships.pp\n# Target line: 18\n\n     13: \n     14:     role::oauth::consumer { 'Wikimania Scholarships':\n     15:         description  => 'Wikimania Scholarships',\n     16:         consumer_key => $oauth_consumer_key,\n     17:         secret_key   => $oauth_secret_key,\n>>>  18:         callback_url => \"http://${::scholarships::vhost_name}${::port_fragment}/\",\n     19:         grants       => ['authonlyprivate'],\n     20:     }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-examples-default_install_from_source.pp", "content": "source_url => 'http://mirror.nexcess.net/apache/tomcat/tomcat-8/v8.0.8/bin/apache-tomcat-8.0.8.tar.gz'", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-examples-default_install_from_source.pp\n\n#\nclass { 'tomcat': }\nclass { 'java': }\n\ntomcat::instance { 'test':\n7:   source_url => 'http://mirror.nexcess.net/apache/tomcat/tomcat-8/v8.0.8/bin/apache-tomcat-8.0.8.tar.gz'\n}\n-> tomcat::service { 'default': }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-examples-default_install_from_source.pp\n# Target line: 7\n\n      2: #\n      3: class { 'tomcat': }\n      4: class { 'java': }\n      5: \n      6: tomcat::instance { 'test':\n>>>   7:   source_url => 'http://mirror.nexcess.net/apache/tomcat/tomcat-8/v8.0.8/bin/apache-tomcat-8.0.8.tar.gz'\n      8: }\n      9: -> tomcat::service { 'default': }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@ci-puppet-modules-gds_elasticsearch-manifests-repo.pp", "content": "location     => \"http://apt.production.alphagov.co.uk/elasticsearch-${repo_version}\",", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: alphagov@ci-puppet-modules-gds_elasticsearch-manifests-repo.pp\n\n#\nclass gds_elasticsearch::repo(\n$repo_version,\n) {\napt::source { \"elasticsearch-${repo_version}\":\n15:     location     => \"http://apt.production.alphagov.co.uk/elasticsearch-${repo_version}\",\nrelease      => 'stable',\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\ninclude_src  => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-gds_elasticsearch-manifests-repo.pp\n# Target line: 15\n\n     10: #\n     11: class gds_elasticsearch::repo(\n     12:   $repo_version,\n     13: ) {\n     14:   apt::source { \"elasticsearch-${repo_version}\":\n>>>  15:     location     => \"http://apt.production.alphagov.co.uk/elasticsearch-${repo_version}\",\n     16:     release      => 'stable',\n     17:     architecture => $::architecture,\n     18:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     19:     include_src  => false,\n     20:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-heat.pp", "content": "$auth_uri = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-heat.pp\n\n$heat_server_ip = $host_control_ip\n$mysql_port_url = \"/heat\"\n$mysql_ip_address  = $host_control_ip\n}\n\n49:   $auth_uri = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n$database_credentials = join([$service_password, \"@\", $mysql_ip_address],'')\n$keystone_db_conn = join([\"mysql://heat:\",$database_credentials,$mysql_port_url],'')\n\nclass {'::heat::db::mysql':\npassword => $service_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-heat.pp\n# Target line: 49\n\n     44:     $heat_server_ip = $host_control_ip\n     45:     $mysql_port_url = \"/heat\"\n     46:     $mysql_ip_address  = $host_control_ip\n     47:   }\n     48: \n>>>  49:   $auth_uri = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n     50:   $database_credentials = join([$service_password, \"@\", $mysql_ip_address],'')\n     51:   $keystone_db_conn = join([\"mysql://heat:\",$database_credentials,$mysql_port_url],'')\n     52: \n     53:   class {'::heat::db::mysql':\n     54:     password => $service_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp", "content": "$pwd_md5 = md5(\"${password_hash}${username}\")", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n\n\nif $password_hash {\nif($password_hash =~ /^md5.+/) {\n$pwd_hash_sql = $password_hash\n} else {\n86:       $pwd_md5 = md5(\"${password_hash}${username}\")\n$pwd_hash_sql = \"md5${pwd_md5}\"\n}\npostgresql_psql {\"ALTER ROLE \\\"${username}\\\" ${password_sql}\":\nunless => \"SELECT usename FROM pg_shadow WHERE usename='${username}' and passwd='${pwd_hash_sql}'\",\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n# Target line: 86\n\n     81: \n     82:   if $password_hash {\n     83:     if($password_hash =~ /^md5.+/) {\n     84:       $pwd_hash_sql = $password_hash\n     85:     } else {\n>>>  86:       $pwd_md5 = md5(\"${password_hash}${username}\")\n     87:       $pwd_hash_sql = \"md5${pwd_md5}\"\n     88:     }\n     89:     postgresql_psql {\"ALTER ROLE \\\"${username}\\\" ${password_sql}\":\n     90:       unless => \"SELECT usename FROM pg_shadow WHERE usename='${username}' and passwd='${pwd_hash_sql}'\",\n     91:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "puppetlabs@puppetlabs-postgresql-manifests-server-role.pp", "content": "$pwd_hash_sql = \"md5${pwd_md5}\"", "line": 116, "detection_span": [111, 121], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n\nif $password_hash and $update_password {\nif($password_hash =~ /^md5.+/) {\n$pwd_hash_sql = $password_hash\n} else {\n$pwd_md5 = md5(\"${password_hash}${username}\")\n116:         $pwd_hash_sql = \"md5${pwd_md5}\"\n}\npostgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\ncommand     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\nunless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",\nenvironment => $environment,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n# Target line: 116\n\n    111:     if $password_hash and $update_password {\n    112:       if($password_hash =~ /^md5.+/) {\n    113:         $pwd_hash_sql = $password_hash\n    114:       } else {\n    115:         $pwd_md5 = md5(\"${password_hash}${username}\")\n>>> 116:         $pwd_hash_sql = \"md5${pwd_md5}\"\n    117:       }\n    118:       postgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\n    119:         command     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\n    120:         unless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",\n    121:         environment => $environment,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "wazuh@ossec-puppet-manifests-agentkey.pp", "content": "$agentkey2 = md5(\"${agent_name} ${agent_ip_address} ${agent_seed}\")", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: wazuh@ossec-puppet-manifests-agentkey.pp\n\nrequire ossec::params\n\nif ! $agent_id { fail(\"ossec::agentkey: ${agent_id} is missing\")}\n\n$agentkey1 = md5(\"${agent_id} ${agent_seed}\")\n13:   $agentkey2 = md5(\"${agent_name} ${agent_ip_address} ${agent_seed}\")\n\nconcat::fragment { \"var_ossec_etc_client.keys_${agent_name}_part\":\ntarget  => $ossec::params::keys_file,\norder   => $agent_id,\ncontent => \"${agent_id} ${agent_name} ${agent_ip_address} ${agentkey1}${agentkey2}\\n\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wazuh@ossec-puppet-manifests-agentkey.pp\n# Target line: 13\n\n      8:   require ossec::params\n      9: \n     10:   if ! $agent_id { fail(\"ossec::agentkey: ${agent_id} is missing\")}\n     11: \n     12:   $agentkey1 = md5(\"${agent_id} ${agent_seed}\")\n>>>  13:   $agentkey2 = md5(\"${agent_name} ${agent_ip_address} ${agent_seed}\")\n     14: \n     15:   concat::fragment { \"var_ossec_etc_client.keys_${agent_name}_part\":\n     16:     target  => $ossec::params::keys_file,\n     17:     order   => $agent_id,\n     18:     content => \"${agent_id} ${agent_name} ${agent_ip_address} ${agentkey1}${agentkey2}\\n\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "cargomedia@puppet-packages-modules-github-manifests-knownhost.pp", "content": "key => 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-github-manifests-knownhost.pp\n\nclass github::knownhost {\n\nssh::knownhost { 'github.com':\n4:     key => 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-github-manifests-knownhost.pp\n# Target line: 4\n\n      1: class github::knownhost {\n      2: \n      3:   ssh::knownhost { 'github.com':\n>>>   4:     key => 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==',\n      5:   }\n      6: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_KEYSTONE_DB_PW'),", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\nclass packstack::mariadb::services ()\n{\nclass { '::keystone::db::mysql':\nuser          => 'keystone_admin',\n5:       password      => hiera('CONFIG_KEYSTONE_DB_PW'),\nallowed_hosts => '%',\ncharset       => 'utf8',\n}\n\nif hiera('CONFIG_CINDER_INSTALL') == 'y' {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 5\n\n      1: class packstack::mariadb::services ()\n      2: {\n      3:     class { '::keystone::db::mysql':\n      4:       user          => 'keystone_admin',\n>>>   5:       password      => hiera('CONFIG_KEYSTONE_DB_PW'),\n      6:       allowed_hosts => '%',\n      7:       charset       => 'utf8',\n      8:     }\n      9: \n     10:     if hiera('CONFIG_CINDER_INSTALL') == 'y' {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_PANKO_DB_PW'),", "line": 114, "detection_span": [109, 119], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\n}\n110:\nif hiera('CONFIG_PANKO_INSTALL') == 'y' and\nhiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\nclass { '::panko::db::mysql':\n114:           password      => hiera('CONFIG_PANKO_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\n}\n}\n119:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 114\n\n    109:     }\n    110: \n    111:     if hiera('CONFIG_PANKO_INSTALL') == 'y' and\n    112:        hiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\n    113:         class { '::panko::db::mysql':\n>>> 114:           password      => hiera('CONFIG_PANKO_DB_PW'),\n    115:           host          => '%',\n    116:           allowed_hosts => '%',\n    117:         }\n    118:     }\n    119: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp", "content": "key   => 'GATEWAY',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n\n/(?i:redhat|centos|oraclelinux)/: {\nCfg <| name == $gateway |>\nif ! defined(Cfg[$gateway]) {\ncfg { $gateway:\nfile  => '/etc/sysconfig/network',\n26:               key   => 'GATEWAY',\nvalue => $gateway,\n} ->\n# FIXME: we should not nuke the system with 'service network restart'...\n# FIXME: but we should ensure default route will be created somehow\nexec { $exec_name :", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n# Target line: 26\n\n     21:     /(?i:redhat|centos|oraclelinux)/: {\n     22:         Cfg <| name == $gateway |>\n     23:         if ! defined(Cfg[$gateway]) {\n     24:           cfg { $gateway:\n     25:               file  => '/etc/sysconfig/network',\n>>>  26:               key   => 'GATEWAY',\n     27:               value => $gateway,\n     28:           } ->\n     29:           # FIXME: we should not nuke the system with 'service network restart'...\n     30:           # FIXME: but we should ensure default route will be created somehow\n     31:           exec { $exec_name :\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "tsuru@puppet-tsuru-base-manifests-init.pp", "content": "$tsuru_pub_key = '", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: tsuru@puppet-tsuru-base-manifests-init.pp\n\n$docker_source_list    = false,\n$docker_release        = $::lsbdistcodename,\n$docker_repos          = 'main'\n) {\n\n30:   $tsuru_pub_key = '\n-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: SKS 1.1.4\nComment: Hostname: keyserver.ubuntu.com\n\nmI0EUktBQAEEAJwPWcFy1B20SgKkF3QVvMoSJld+3bhrS6AT0fbYwv4RgpwekQGrnO5z4Otg", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: tsuru@puppet-tsuru-base-manifests-init.pp\n# Target line: 30\n\n     25:   $docker_source_list    = false,\n     26:   $docker_release        = $::lsbdistcodename,\n     27:   $docker_repos          = 'main'\n     28: ) {\n     29: \n>>>  30:   $tsuru_pub_key = '\n     31: -----BEGIN PGP PUBLIC KEY BLOCK-----\n     32: Version: SKS 1.1.4\n     33: Comment: Hostname: keyserver.ubuntu.com\n     34: \n     35: mI0EUktBQAEEAJwPWcFy1B20SgKkF3QVvMoSJld+3bhrS6AT0fbYwv4RgpwekQGrnO5z4Otg\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp", "content": "password        => \"password\",", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n\n\nclass aeolus::profiles::conductor {\n\naeolus::conductor::site_admin{\"admin\":\nemail           => 'root@localhost.localdomain',\n19:      password        => \"password\",\nfirst_name      => 'Administrator',\nlast_name       => ''}\n\naeolus::conductor::login{\"admin\": password => \"password\",\nrequire  => Aeolus::Conductor::Site_admin['admin']}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n# Target line: 19\n\n     14: \n     15: class aeolus::profiles::conductor {\n     16: \n     17:   aeolus::conductor::site_admin{\"admin\":\n     18:      email           => 'root@localhost.localdomain',\n>>>  19:      password        => \"password\",\n     20:      first_name      => 'Administrator',\n     21:      last_name       => ''}\n     22: \n     23:   aeolus::conductor::login{\"admin\": password => \"password\",\n     24:      require  => Aeolus::Conductor::Site_admin['admin']}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-qdr.pp", "content": "$qdr_username      = undef,", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-qdr.pp\n\n#   (Optional) The current step in deployment. See tripleo-heat-templates\n#   for more details.\n#   Defaults to hiera('step')\n#\nclass tripleo::profile::base::qdr (\n48:   $qdr_username      = undef,\n$qdr_password      = undef,\n$qdr_listener_port = hiera('tripleo::profile::base::qdr::qdr_listener_port', 5672),\n$qdr_log_enable    = hiera('tripleo::profile::base::qdr::qdr_log_enable', 'info+'),\n$oslomsg_rpc_hosts = hiera('oslo_messaging_rpc_node_names', undef),\n$step              = Integer(hiera('step')),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-qdr.pp\n# Target line: 48\n\n     43: #   (Optional) The current step in deployment. See tripleo-heat-templates\n     44: #   for more details.\n     45: #   Defaults to hiera('step')\n     46: #\n     47: class tripleo::profile::base::qdr (\n>>>  48:   $qdr_username      = undef,\n     49:   $qdr_password      = undef,\n     50:   $qdr_listener_port = hiera('tripleo::profile::base::qdr::qdr_listener_port', 5672),\n     51:   $qdr_log_enable    = hiera('tripleo::profile::base::qdr::qdr_log_enable', 'info+'),\n     52:   $oslomsg_rpc_hosts = hiera('oslo_messaging_rpc_node_names', undef),\n     53:   $step              = Integer(hiera('step')),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$read_database_username            = 'puppetdb'", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n# These settings are for the read database\n$read_database                     = 'postgres'\n$read_database_host                = undef\n$read_database_port                = '5432'\n$read_database_name                = 'puppetdb'\n57:   $read_database_username            = 'puppetdb'\n$read_database_password            = 'puppetdb'\n$read_database_jdbc_ssl_properties = ''\n$read_database_validate            = true\n$read_log_slow_statements          = '10'\n$read_conn_max_age                 = '60'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 57\n\n     52:   # These settings are for the read database\n     53:   $read_database                     = 'postgres'\n     54:   $read_database_host                = undef\n     55:   $read_database_port                = '5432'\n     56:   $read_database_name                = 'puppetdb'\n>>>  57:   $read_database_username            = 'puppetdb'\n     58:   $read_database_password            = 'puppetdb'\n     59:   $read_database_jdbc_ssl_properties = ''\n     60:   $read_database_validate            = true\n     61:   $read_log_slow_statements          = '10'\n     62:   $read_conn_max_age                 = '60'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-filesystem-backed-bricks-example.pp", "content": "uuid => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-filesystem-backed-bricks-example.pp\n\nshorewall => true,\n}\n\ngluster::host { 'annex1.example.com':\n# use uuidgen to make these\n15: \t\tuuid => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n}\n\n# note that this is using a folder on your existing filesystem...\n# this can be useful for prototyping gluster using virtual machines\n# if this isn't a separate partition, remember that your root fs will", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-filesystem-backed-bricks-example.pp\n# Target line: 15\n\n     10: \t\tshorewall => true,\n     11: \t}\n     12: \n     13: \tgluster::host { 'annex1.example.com':\n     14: \t\t# use uuidgen to make these\n>>>  15: \t\tuuid => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n     16: \t}\n     17: \n     18: \t# note that this is using a folder on your existing filesystem...\n     19: \t# this can be useful for prototyping gluster using virtual machines\n     20: \t# if this isn't a separate partition, remember that your root fs will\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-storage.pp", "content": "rbd_store_user => 'images',", "line": 83, "detection_span": [78, 88], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-storage.pp\n\n}\ncreate_resources('contrail::lib::storage_os_config', $pool_config, {})\nclass {'cinder::volume':}\n\nclass { 'glance::backend::rbd':\n83:     rbd_store_user => 'images',\nmulti_store    => true\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-storage.pp\n# Target line: 83\n\n     78:   }\n     79:   create_resources('contrail::lib::storage_os_config', $pool_config, {})\n     80:   class {'cinder::volume':}\n     81: \n     82:   class { 'glance::backend::rbd': \n>>>  83:     rbd_store_user => 'images',\n     84:     multi_store    => true\n     85:   }\n     86: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp", "content": "$ssl_key               = '/etc/mysql/server-key.pem'", "line": 112, "detection_span": [107, 117], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n\n$perl_package_name     = 'perl-DBD-mysql'\n$java_package_name     = 'mysql-connector-java'\n$root_group            = 'root'\n$ssl_ca                = '/etc/mysql/cacert.pem'\n$ssl_cert              = '/etc/mysql/server-cert.pem'\n112:       $ssl_key               = '/etc/mysql/server-key.pem'\n}\n114:\n'Debian': {\n$basedir              = '/usr'\n$datadir              = '/var/lib/mysql'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n# Target line: 112\n\n    107:       $perl_package_name     = 'perl-DBD-mysql'\n    108:       $java_package_name     = 'mysql-connector-java'\n    109:       $root_group            = 'root'\n    110:       $ssl_ca                = '/etc/mysql/cacert.pem'\n    111:       $ssl_cert              = '/etc/mysql/server-cert.pem'\n>>> 112:       $ssl_key               = '/etc/mysql/server-key.pem'\n    113:     }\n    114: \n    115:     'Debian': {\n    116:       $basedir              = '/usr'\n    117:       $datadir              = '/var/lib/mysql'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-trove-rabbitmq.pp", "content": "nova_proxy_admin_pass        => hiera('CONFIG_TROVE_NOVA_PW'),", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-trove-rabbitmq.pp\n\nrabbit_use_ssl               => hiera('CONFIG_AMQP_SSL_ENABLED'),\ndefault_transport_url        => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\ndatabase_connection          => \"mysql+pymysql://trove:${trove_rabmq_cfg_trove_db_pw}@${trove_rabmq_cfg_mariadb_host}/trove\",\nnova_proxy_admin_user        => hiera('CONFIG_TROVE_NOVA_USER'),\nnova_proxy_admin_tenant_name => hiera('CONFIG_TROVE_NOVA_TENANT'),\n33:       nova_proxy_admin_pass        => hiera('CONFIG_TROVE_NOVA_PW'),\nnova_compute_url             => \"http://${trove_rabmq_cfg_controller_host}:8774/v2\",\ncinder_url                   => \"http://${trove_rabmq_cfg_controller_host}:8776/v1\",\nswift_url                    => \"http://${trove_rabmq_cfg_controller_host}:8080/v1/AUTH_\",\nuse_neutron                  => hiera('CONFIG_NEUTRON_INSTALL'),\nkombu_ssl_ca_certs           => $kombu_ssl_ca_certs,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-trove-rabbitmq.pp\n# Target line: 33\n\n     28:       rabbit_use_ssl               => hiera('CONFIG_AMQP_SSL_ENABLED'),\n     29:       default_transport_url        => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\n     30:       database_connection          => \"mysql+pymysql://trove:${trove_rabmq_cfg_trove_db_pw}@${trove_rabmq_cfg_mariadb_host}/trove\",\n     31:       nova_proxy_admin_user        => hiera('CONFIG_TROVE_NOVA_USER'),\n     32:       nova_proxy_admin_tenant_name => hiera('CONFIG_TROVE_NOVA_TENANT'),\n>>>  33:       nova_proxy_admin_pass        => hiera('CONFIG_TROVE_NOVA_PW'),\n     34:       nova_compute_url             => \"http://${trove_rabmq_cfg_controller_host}:8774/v2\",\n     35:       cinder_url                   => \"http://${trove_rabmq_cfg_controller_host}:8776/v1\",\n     36:       swift_url                    => \"http://${trove_rabmq_cfg_controller_host}:8080/v1/AUTH_\",\n     37:       use_neutron                  => hiera('CONFIG_NEUTRON_INSTALL'),\n     38:       kombu_ssl_ca_certs           => $kombu_ssl_ca_certs,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp", "content": "$qpid_password              = 'qpid_pw',", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n\n$rabbit_password            = 'rabbit_pw',\n$rabbit_host                = false,\n$rabbit_user                = 'nova',\n$rabbit_ha_virtual_ip       = false,\n$queue_provider             = 'rabbitmq',\n48:   $qpid_password              = 'qpid_pw',\n$qpid_user                  = 'nova',\n$qpid_nodes                 = ['127.0.0.1'],\n$log_facility               = 'LOG_LOCAL2',\n$rsync_group                = 'glance',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n# Target line: 48\n\n     43:   $rabbit_password            = 'rabbit_pw',\n     44:   $rabbit_host                = false,\n     45:   $rabbit_user                = 'nova',\n     46:   $rabbit_ha_virtual_ip       = false,\n     47:   $queue_provider             = 'rabbitmq',\n>>>  48:   $qpid_password              = 'qpid_pw',\n     49:   $qpid_user                  = 'nova',\n     50:   $qpid_nodes                 = ['127.0.0.1'],\n     51:   $log_facility               = 'LOG_LOCAL2',\n     52:   $rsync_group                = 'glance',\n     53: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp", "content": "$db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n\n$db_name     = pick($neutron_db['db_name'], 'neutron')\n$db_password = pick($neutron_db['passwd'], $mysql_root_password)\n\n$db_host          = pick($neutron_db['db_host'], $database_vip)\n$db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n22:   $db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n$db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n\n$allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n\nvalidate_string($mysql_root_user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n# Target line: 22\n\n     17:   $db_name     = pick($neutron_db['db_name'], 'neutron')\n     18:   $db_password = pick($neutron_db['passwd'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($neutron_db['db_host'], $database_vip)\n     21:   $db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n>>>  22:   $db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n     23:   $db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n     24: \n     25:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     26: \n     27:   validate_string($mysql_root_user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-dns-rndc_key.pp", "content": "$rndc_secret_admin         = undef,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n\nclass profile::dns::rndc_key (\n$create_admin_key          = false,\n$create_mdns_key           = false,\n$host_is_bind_server       = false,\n5:   $rndc_secret_admin         = undef,\n$rndc_secret_mdns          = undef\n)\n{\n\nif $create_admin_key {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n# Target line: 5\n\n      1: class profile::dns::rndc_key (\n      2:   $create_admin_key          = false,\n      3:   $create_mdns_key           = false,\n      4:   $host_is_bind_server       = false,\n>>>   5:   $rndc_secret_admin         = undef,\n      6:   $rndc_secret_mdns          = undef\n      7: )\n      8: {\n      9: \n     10:   if $create_admin_key {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp", "content": "key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n\nvalue => 'IsInstalled',\ntype  => dword,\ndata  => '0',\n}\nregistry::value { 'IE_ESC_admin':\n12:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}',\nvalue => 'IsInstalled',\ntype  => dword,\ndata  => '0',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n# Target line: 12\n\n      7:     value => 'IsInstalled',\n      8:     type  => dword,\n      9:     data  => '0',\n     10:   }\n     11:   registry::value { 'IE_ESC_admin':\n>>>  12:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}',\n     13:     value => 'IsInstalled',\n     14:     type  => dword,\n     15:     data  => '0',\n     16:   }\n     17:   \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "djjudas21@puppet-freeradius-manifests-sql.pp", "content": "$login                       = 'radius',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: djjudas21@puppet-freeradius-manifests-sql.pp\n\n# Configure SQL support for FreeRADIUS\ndefine freeradius::sql (\n$database,\n$password,\n$server                      = 'localhost',\n6:   $login                       = 'radius',\n$radius_db                   = 'radius',\n$num_sql_socks               = '${thread[pool].max_servers}',\n$query_file                  = \"\\${modconfdir}/\\${.:name}/main/\\${dialect}/queries.conf\",\n$custom_query_file           = undef,\n$lifetime                    = '0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: djjudas21@puppet-freeradius-manifests-sql.pp\n# Target line: 6\n\n      1: # Configure SQL support for FreeRADIUS\n      2: define freeradius::sql (\n      3:   $database,\n      4:   $password,\n      5:   $server                      = 'localhost',\n>>>   6:   $login                       = 'radius',\n      7:   $radius_db                   = 'radius',\n      8:   $num_sql_socks               = '${thread[pool].max_servers}',\n      9:   $query_file                  = \"\\${modconfdir}/\\${.:name}/main/\\${dialect}/queries.conf\",\n     10:   $custom_query_file           = undef,\n     11:   $lifetime                    = '0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-db-sync.pp", "content": "user        => 'trove',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: openstack@puppet-trove-manifests-db-sync.pp\n\n\ninclude ::trove::deps\n\nexec { 'trove-manage db_sync':\npath        => '/usr/bin',\n26:     user        => 'trove',\nrefreshonly => true,\ntry_sleep   => 5,\ntries       => 10,\nlogoutput   => on_failure,\nsubscribe   => [", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-db-sync.pp\n# Target line: 26\n\n     21: \n     22:   include ::trove::deps\n     23: \n     24:   exec { 'trove-manage db_sync':\n     25:     path        => '/usr/bin',\n>>>  26:     user        => 'trove',\n     27:     refreshonly => true,\n     28:     try_sleep   => 5,\n     29:     tries       => 10,\n     30:     logoutput   => on_failure,\n     31:     subscribe   => [\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_idomysql.pp", "content": "password => 'supersecret',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql.pp\n\ninclude ::mysql::server\n\nmysql::db { 'icinga2':\nuser     => 'icinga2',\n5:   password => 'supersecret',\nhost     => 'localhost',\ngrant    => ['SELECT', 'INSERT', 'UPDATE', 'DELETE', 'DROP', 'CREATE VIEW', 'CREATE', 'INDEX', 'EXECUTE', 'ALTER'],\n}\n\nclass { '::icinga2':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql.pp\n# Target line: 5\n\n      1: include ::mysql::server\n      2: \n      3: mysql::db { 'icinga2':\n      4:   user     => 'icinga2',\n>>>   5:   password => 'supersecret',\n      6:   host     => 'localhost',\n      7:   grant    => ['SELECT', 'INSERT', 'UPDATE', 'DELETE', 'DROP', 'CREATE VIEW', 'CREATE', 'INDEX', 'EXECUTE', 'ALTER'],\n      8: }\n      9: \n     10: class { '::icinga2':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan.pp", "content": "$smtp_username                  = undef,", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan.pp\n\n$gunicorn_worker_processes      = '1',\n$priority_worker_processes      = '0',\n$bulk_worker_processes          = '0',\n$enable_harvester_fetch         = false,\n$enable_harvester_gather        = false,\n52:   $smtp_username                  = undef,\n$smtp_password                  = undef,\n$smtp_hostname                  = undef,\n$s3_aws_access_key_id           = undef,\n$s3_aws_secret_access_key       = undef,\n$s3_bucket_name                 = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan.pp\n# Target line: 52\n\n     47:   $gunicorn_worker_processes      = '1',\n     48:   $priority_worker_processes      = '0',\n     49:   $bulk_worker_processes          = '0',\n     50:   $enable_harvester_fetch         = false,\n     51:   $enable_harvester_gather        = false,\n>>>  52:   $smtp_username                  = undef,\n     53:   $smtp_password                  = undef,\n     54:   $smtp_hostname                  = undef,\n     55:   $s3_aws_access_key_id           = undef,\n     56:   $s3_aws_secret_access_key       = undef,\n     57:   $s3_bucket_name                 = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp", "content": "key    => 'openLinksInBackground',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n\n}\n\nboxen::osx_defaults { 'Open links in the background':\nuser   => $::luser,\ndomain => 'com.twitter.twitter-mac',\n13:     key    => 'openLinksInBackground',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Allow closing the \\'new tweet\\' window by pressing \\'Esc\\'':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n# Target line: 13\n\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Open links in the background':\n     11:     user   => $::luser,\n     12:     domain => 'com.twitter.twitter-mac',\n>>>  13:     key    => 'openLinksInBackground',\n     14:     type   => 'bool',\n     15:     value  => true,\n     16:   }\n     17: \n     18:   boxen::osx_defaults { 'Allow closing the \\'new tweet\\' window by pressing \\'Esc\\'':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-jeepyb-manifests-openstackwatch.pp", "content": "user    => 'openstackwatch',", "line": 62, "detection_span": [57, 67], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-jeepyb-manifests-openstackwatch.pp\n\ncron { 'openstackwatch':\nensure  => present,\ncommand => '/usr/local/bin/openstackwatch /home/openstackwatch/openstackwatch.ini',\nminute  => $minute,\nhour    => $hour,\n62:       user    => 'openstackwatch',\nrequire => [\nFile['/home/openstackwatch/openstackwatch.ini'],\nUser['openstackwatch'],\nClass['jeepyb'],\n],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-jeepyb-manifests-openstackwatch.pp\n# Target line: 62\n\n     57:     cron { 'openstackwatch':\n     58:       ensure  => present,\n     59:       command => '/usr/local/bin/openstackwatch /home/openstackwatch/openstackwatch.ini',\n     60:       minute  => $minute,\n     61:       hour    => $hour,\n>>>  62:       user    => 'openstackwatch',\n     63:       require => [\n     64:         File['/home/openstackwatch/openstackwatch.ini'],\n     65:         User['openstackwatch'],\n     66:         Class['jeepyb'],\n     67:       ],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-dns-rndc_key.pp", "content": "$create_mdns_key           = false,", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n\nclass profile::dns::rndc_key (\n$create_admin_key          = false,\n3:   $create_mdns_key           = false,\n$host_is_bind_server       = false,\n$rndc_secret_admin         = undef,\n$rndc_secret_mdns          = undef\n)\n{", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n# Target line: 3\n\n      1: class profile::dns::rndc_key (\n      2:   $create_admin_key          = false,\n>>>   3:   $create_mdns_key           = false,\n      4:   $host_is_bind_server       = false,\n      5:   $rndc_secret_admin         = undef,\n      6:   $rndc_secret_mdns          = undef\n      7: )\n      8: {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-plumgrid.pp", "content": "'PLUMgridDirector/password':             value => $password, secret =>true;", "line": 173, "detection_span": [168, 178], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-plumgrid.pp\n\n168:\n169:   neutron_plugin_plumgrid {\n'PLUMgridDirector/director_server':      value => $director_server;\n'PLUMgridDirector/director_server_port': value => $director_server_port;\n'PLUMgridDirector/username':             value => $username;\n173:     'PLUMgridDirector/password':             value => $password, secret =>true;\n'PLUMgridDirector/servertimeout':        value => $servertimeout;\n'database/connection':                   value => $connection;\n'l2gateway/vendor':                      value => $l2gateway_vendor;\n'l2gateway/sw_username':                 value => $l2gateway_sw_username;\n'l2gateway/sw_password':                 value => $l2gateway_sw_password, secret =>true;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-plumgrid.pp\n# Target line: 173\n\n    168: \n    169:   neutron_plugin_plumgrid {\n    170:     'PLUMgridDirector/director_server':      value => $director_server;\n    171:     'PLUMgridDirector/director_server_port': value => $director_server_port;\n    172:     'PLUMgridDirector/username':             value => $username;\n>>> 173:     'PLUMgridDirector/password':             value => $password, secret =>true;\n    174:     'PLUMgridDirector/servertimeout':        value => $servertimeout;\n    175:     'database/connection':                   value => $connection;\n    176:     'l2gateway/vendor':                      value => $l2gateway_vendor;\n    177:     'l2gateway/sw_username':                 value => $l2gateway_sw_username;\n    178:     'l2gateway/sw_password':                 value => $l2gateway_sw_password, secret =>true;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-repo-apt_postgresql_org.pp", "content": "key_source        => 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-repo-apt_postgresql_org.pp\n\napt::source { 'apt.postgresql.org':\nlocation          => 'http://apt.postgresql.org/pub/repos/apt/',\nrelease           => \"${::lsbdistcodename}-pgdg\",\nrepos             => \"main ${version}\",\nkey               => 'ACCC4CF8',\n17:       key_source        => 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc',\ninclude_src       => false,\n}\n\nApt::Source['apt.postgresql.org']->Package<|tag == 'postgresql'|>\n} else {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-repo-apt_postgresql_org.pp\n# Target line: 17\n\n     12:     apt::source { 'apt.postgresql.org':\n     13:       location          => 'http://apt.postgresql.org/pub/repos/apt/',\n     14:       release           => \"${::lsbdistcodename}-pgdg\",\n     15:       repos             => \"main ${version}\",\n     16:       key               => 'ACCC4CF8',\n>>>  17:       key_source        => 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc',\n     18:       include_src       => false,\n     19:     }\n     20: \n     21:     Apt::Source['apt.postgresql.org']->Package<|tag == 'postgresql'|>\n     22:   } else {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-finder.pp", "content": "key    => '_FXShowPosixPathInTitle',", "line": 62, "detection_span": [57, 67], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n\n}\n\nboxen::osx_defaults { 'Display full POSIX path as Finder window title':\nuser   => $::luser,\ndomain => 'com.apple.finder',\n62:     key    => '_FXShowPosixPathInTitle',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Allow quitting via \u2318 + Q; doing so will also hide desktop icons':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n# Target line: 62\n\n     57:   }\n     58: \n     59:   boxen::osx_defaults { 'Display full POSIX path as Finder window title':\n     60:     user   => $::luser,\n     61:     domain => 'com.apple.finder',\n>>>  62:     key    => '_FXShowPosixPathInTitle',\n     63:     type   => 'bool',\n     64:     value  => true,\n     65:   }\n     66: \n     67:   boxen::osx_defaults { 'Allow quitting via \u2318 + Q; doing so will also hide desktop icons':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-mysql-manifests-server-master.pp", "content": "$debian_sys_maint_password = undef", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-mysql-manifests-server-master.pp\n\nclass mysql::server::master (\n$replication_id,\n$server_id,\n$replication_password = undef,\n$root_password = undef,\n6:   $debian_sys_maint_password = undef\n) {\n\n@@mysql::server::instance { $replication_id:\nroot_password             => $root_password,\ndebian_sys_maint_password => $debian_sys_maint_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-mysql-manifests-server-master.pp\n# Target line: 6\n\n      1: class mysql::server::master (\n      2:   $replication_id,\n      3:   $server_id,\n      4:   $replication_password = undef,\n      5:   $root_password = undef,\n>>>   6:   $debian_sys_maint_password = undef\n      7: ) {\n      8: \n      9:   @@mysql::server::instance { $replication_id:\n     10:     root_password             => $root_password,\n     11:     debian_sys_maint_password => $debian_sys_maint_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$ssl_set_cert_paths       = false", "line": 176, "detection_span": [171, 181], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n171:   $automatic_dlo_cleanup    = true\n172:   # any value for a systemd timer is valid: https://www.freedesktop.org/software/systemd/man/systemd.time.html\n173:   $cleanup_timer_interval   = \"*-*-* ${fqdn_rand(24)}:${fqdn_rand(60)}:00\"\n$dlo_max_age              = 90\n175:\n176:   $ssl_set_cert_paths       = false\n$ssl_cert_path            = \"${ssl_dir}/public.pem\"\n$ssl_key_path             = \"${ssl_dir}/private.pem\"\n$ssl_ca_cert_path         = \"${ssl_dir}/ca.pem\"\n$ssl_deploy_certs         = false\n$ssl_key                  = undef", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 176\n\n    171:   $automatic_dlo_cleanup    = true\n    172:   # any value for a systemd timer is valid: https://www.freedesktop.org/software/systemd/man/systemd.time.html\n    173:   $cleanup_timer_interval   = \"*-*-* ${fqdn_rand(24)}:${fqdn_rand(60)}:00\"\n    174:   $dlo_max_age              = 90\n    175: \n>>> 176:   $ssl_set_cert_paths       = false\n    177:   $ssl_cert_path            = \"${ssl_dir}/public.pem\"\n    178:   $ssl_key_path             = \"${ssl_dir}/private.pem\"\n    179:   $ssl_ca_cert_path         = \"${ssl_dir}/ca.pem\"\n    180:   $ssl_deploy_certs         = false\n    181:   $ssl_key                  = undef\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp", "content": "key    => 'maxHistorySize',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n\nclass people::felho::application_settings::clipmenu {\nboxen::osx_defaults { 'Clipmenu maxHistorySize':\nuser   => $::luser,\ndomain => 'com.naotaka.ClipMenu',\n5:     key    => 'maxHistorySize',\nvalue  => 300,\n}\n\nboxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInline':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n# Target line: 5\n\n      1: class people::felho::application_settings::clipmenu {\n      2:   boxen::osx_defaults { 'Clipmenu maxHistorySize':\n      3:     user   => $::luser,\n      4:     domain => 'com.naotaka.ClipMenu',\n>>>   5:     key    => 'maxHistorySize',\n      6:     value  => 300,\n      7:   }\n      8: \n      9:   boxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInline':\n     10:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-icinga-manifests-plugin-check_rabbitmq_consumers.pp", "content": "class icinga::plugin::check_rabbitmq_consumers ($monitoring_password = ''){", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-plugin-check_rabbitmq_consumers.pp\n\n# == Class: icinga::plugin::check_rabbitmq_consumers\n#\n# Install a Nagios plugin that alerts when a rabbitmq consumer\n# has not recieved a heartbeat within the last 5 minutes\n#\n6: class icinga::plugin::check_rabbitmq_consumers ($monitoring_password = ''){\n\n@icinga::plugin { 'check_rabbitmq_consumers':\nsource  => 'puppet:///modules/icinga/usr/lib/nagios/plugins/check_rabbitmq_consumers',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-plugin-check_rabbitmq_consumers.pp\n# Target line: 6\n\n      1: # == Class: icinga::plugin::check_rabbitmq_consumers\n      2: #\n      3: # Install a Nagios plugin that alerts when a rabbitmq consumer\n      4: # has not recieved a heartbeat within the last 5 minutes\n      5: #\n>>>   6: class icinga::plugin::check_rabbitmq_consumers ($monitoring_password = ''){\n      7: \n      8:   @icinga::plugin { 'check_rabbitmq_consumers':\n      9:     source  => 'puppet:///modules/icinga/usr/lib/nagios/plugins/check_rabbitmq_consumers',\n     10:   }\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "$oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\n$nginx_kibana_service_fqdn    = 'logs.fuel-infra.org',\n$nginx_log_format             = undef,\n$oauth_access_file            = '/etc/nginx/oauth-access.lua',\n$oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n$oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n38:   $oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n$oauth_domain                 = 'domain.com',\n$oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n$ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n$ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n$ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 38\n\n     33:   $nginx_kibana_service_fqdn    = 'logs.fuel-infra.org',\n     34:   $nginx_log_format             = undef,\n     35:   $oauth_access_file            = '/etc/nginx/oauth-access.lua',\n     36:   $oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n     37:   $oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n>>>  38:   $oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n     39:   $oauth_domain                 = 'domain.com',\n     40:   $oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n     41:   $ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n     42:   $ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n     43:   $ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-mysql-examples-mysql_db.pp", "content": "password => 'mypass',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n\nclass { 'mysql::server':\nroot_password => 'password'\n}\nmysql::db { 'mydb':\nuser     => 'myuser',\n6:   password => 'mypass',\nhost     => 'localhost',\ngrant    => ['SELECT', 'UPDATE'],\n}\nmysql::db { \"mydb_${fqdn}\":\nuser     => 'myuser',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n# Target line: 6\n\n      1: class { 'mysql::server':\n      2:   root_password => 'password'\n      3: }\n      4: mysql::db { 'mydb':\n      5:   user     => 'myuser',\n>>>   6:   password => 'mypass',\n      7:   host     => 'localhost',\n      8:   grant    => ['SELECT', 'UPDATE'],\n      9: }\n     10: mysql::db { \"mydb_${fqdn}\":\n     11:   user     => 'myuser',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-ci-params.pp", "content": "$ci_user                    = 'gitlab_ci'", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n\n#\n#\nclass gitlab::ci::params {\n\n$ensure                     = 'present'\n7:   $ci_user                    = 'gitlab_ci'\n$ci_home                    = '/home/gitlab_ci'\n$ci_comment                 = 'GitLab CI'\n$ci_email                   = 'gitlab-ci@localhost'\n$ci_support_email           = 'support@localhost'\n$gitlabci_sources           = 'git://github.com/gitlabhq/gitlab-ci.git'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n# Target line: 7\n\n      2: #\n      3: #\n      4: class gitlab::ci::params {\n      5: \n      6:   $ensure                     = 'present'\n>>>   7:   $ci_user                    = 'gitlab_ci'\n      8:   $ci_home                    = '/home/gitlab_ci'\n      9:   $ci_comment                 = 'GitLab CI'\n     10:   $ci_email                   = 'gitlab-ci@localhost'\n     11:   $ci_support_email           = 'support@localhost'\n     12:   $gitlabci_sources           = 'git://github.com/gitlabhq/gitlab-ci.git'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-postgresql-manifests-validate_db_connection.pp", "content": "$database_password = undef,", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-validate_db_connection.pp\n\n#\n# See README.md for more details.\ndefine postgresql::validate_db_connection(\n$database_host     = undef,\n$database_name     = undef,\n9:   $database_password = undef,\n$database_username = undef,\n$database_port     = undef,\n$connect_settings  = undef,\n$run_as            = undef,\n$sleep             = 2,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-validate_db_connection.pp\n# Target line: 9\n\n      4: #\n      5: # See README.md for more details.\n      6: define postgresql::validate_db_connection(\n      7:   $database_host     = undef,\n      8:   $database_name     = undef,\n>>>   9:   $database_password = undef,\n     10:   $database_username = undef,\n     11:   $database_port     = undef,\n     12:   $connect_settings  = undef,\n     13:   $run_as            = undef,\n     14:   $sleep             = 2,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$nailgun_db_user          = 'nailgun'", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$db_port                  = '5432'\n\n$debug                    = false\n\n$nailgun_db_name          = 'nailgun'\n22:   $nailgun_db_user          = 'nailgun'\n$nailgun_db_password      = 'nailgun'\n\n$keystone_db_name         = 'keystone'\n$keystone_db_user         = 'keystone'\n$keystone_db_password     = 'keystone'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 22\n\n     17:   $db_port                  = '5432'\n     18: \n     19:   $debug                    = false\n     20: \n     21:   $nailgun_db_name          = 'nailgun'\n>>>  22:   $nailgun_db_user          = 'nailgun'\n     23:   $nailgun_db_password      = 'nailgun'\n     24: \n     25:   $keystone_db_name         = 'keystone'\n     26:   $keystone_db_user         = 'keystone'\n     27:   $keystone_db_password     = 'keystone'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "biemond@biemond-wildfly-manifests-undertow-https.pp", "content": "$key_password = undef,", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: biemond@biemond-wildfly-manifests-undertow-https.pp\n\n$socket_binding = undef,\n$keystore_path = undef,\n$keystore_relative_to = undef,\n$keystore_password = undef,\n$key_alias = undef,\n10:   $key_password = undef,\n$target_profile = undef,\n$enabled_protocols = undef,\n$enabled_cipher_suites = undef) {\n\nif versioncmp($wildfly::version,'9.0.0') >= 0 {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-wildfly-manifests-undertow-https.pp\n# Target line: 10\n\n      5:   $socket_binding = undef,\n      6:   $keystore_path = undef,\n      7:   $keystore_relative_to = undef,\n      8:   $keystore_password = undef,\n      9:   $key_alias = undef,\n>>>  10:   $key_password = undef,\n     11:   $target_profile = undef,\n     12:   $enabled_protocols = undef,\n     13:   $enabled_cipher_suites = undef) {\n     14: \n     15:   if versioncmp($wildfly::version,'9.0.0') >= 0 {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-mms-manifests-agent-backup.pp", "content": "user    => 'mongodb-mms-agent',", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-mms-manifests-agent-backup.pp\n\n->\n\ndaemon { $agent_name:\nbinary  => \"/usr/bin/mongodb-${agent_name}-agent\",\nargs    => \"-c ${config_file}\",\n36:     user    => 'mongodb-mms-agent',\nrequire => File[$config_file],\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-mms-manifests-agent-backup.pp\n# Target line: 36\n\n     31:   ->\n     32: \n     33:   daemon { $agent_name:\n     34:     binary  => \"/usr/bin/mongodb-${agent_name}-agent\",\n     35:     args    => \"-c ${config_file}\",\n>>>  36:     user    => 'mongodb-mms-agent',\n     37:     require => File[$config_file],\n     38:   }\n     39: \n     40: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-resources-user.pp", "content": "$admin   = false,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-user.pp\n\ndefine openstack::resources::user (\n$password,\n$tenant,\n$email,\n5:   $admin   = false,\n$enabled = true,\n) {\nkeystone_user { $name:\nensure   => present,\nenabled  => $enabled,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-user.pp\n# Target line: 5\n\n      1: define openstack::resources::user (\n      2:   $password,\n      3:   $tenant,\n      4:   $email,\n>>>   5:   $admin   = false,\n      6:   $enabled = true,\n      7: ) {\n      8:   keystone_user { $name:\n      9:     ensure   => present,\n     10:     enabled  => $enabled,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-netapp.pp", "content": "netapp_password                 => hiera('cinder::backend::netapp::netapp_password', undef),", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-netapp.pp\n\n$netapp_pool_name_search_pattern_fallback = undef\n}\ncinder::backend::netapp { $backend_name :\nbackend_availability_zone       => hiera('cinder::backend::netapp::backend_availability_zone', undef),\nnetapp_login                    => hiera('cinder::backend::netapp::netapp_login', undef),\n55:       netapp_password                 => hiera('cinder::backend::netapp::netapp_password', undef),\nnetapp_server_hostname          => hiera('cinder::backend::netapp::netapp_server_hostname', undef),\nnetapp_server_port              => hiera('cinder::backend::netapp::netapp_server_port', undef),\nnetapp_size_multiplier          => hiera('cinder::backend::netapp::netapp_size_multiplier', undef),\nnetapp_storage_family           => hiera('cinder::backend::netapp::netapp_storage_family', undef),\nnetapp_storage_protocol         => hiera('cinder::backend::netapp::netapp_storage_protocol', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-netapp.pp\n# Target line: 55\n\n     50:       $netapp_pool_name_search_pattern_fallback = undef\n     51:     }\n     52:     cinder::backend::netapp { $backend_name :\n     53:       backend_availability_zone       => hiera('cinder::backend::netapp::backend_availability_zone', undef),\n     54:       netapp_login                    => hiera('cinder::backend::netapp::netapp_login', undef),\n>>>  55:       netapp_password                 => hiera('cinder::backend::netapp::netapp_password', undef),\n     56:       netapp_server_hostname          => hiera('cinder::backend::netapp::netapp_server_hostname', undef),\n     57:       netapp_server_port              => hiera('cinder::backend::netapp::netapp_server_port', undef),\n     58:       netapp_size_multiplier          => hiera('cinder::backend::netapp::netapp_size_multiplier', undef),\n     59:       netapp_storage_family           => hiera('cinder::backend::netapp::netapp_storage_family', undef),\n     60:       netapp_storage_protocol         => hiera('cinder::backend::netapp::netapp_storage_protocol', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-mysql_mon.pp", "content": "key     => 'mysql.status[*]',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-mysql_mon.pp\n\napi      => $plugin_zabbix::monitoring::api_hash,\n}\n\nplugin_zabbix::agent::userparameter {\n'mysql.status':\n30:         key     => 'mysql.status[*]',\ncommand => join([\n'echo \"show global status where Variable_name=\\'$1\\';\"',\n' | mysql --defaults-extra-file=/var/lib/zabbix/.my.cnf -N',\n' | awk \\'{print $$2}\\''], '');\n'mysql.ping':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-mysql_mon.pp\n# Target line: 30\n\n     25:       api      => $plugin_zabbix::monitoring::api_hash,\n     26:     }\n     27: \n     28:     plugin_zabbix::agent::userparameter {\n     29:       'mysql.status':\n>>>  30:         key     => 'mysql.status[*]',\n     31:         command => join([\n     32:           'echo \"show global status where Variable_name=\\'$1\\';\"',\n     33:           ' | mysql --defaults-extra-file=/var/lib/zabbix/.my.cnf -N',\n     34:           ' | awk \\'{print $$2}\\''], '');\n     35:       'mysql.ping':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fraenki@puppet-galera-manifests-debian.pp", "content": "user       => 'debian-sys-maint@localhost',", "line": 66, "detection_span": [61, 71], "with_context": "# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n\nmysql_grant { 'debian-sys-maint@localhost/*.*':\nensure     => 'present',\noptions    => ['GRANT'],\nprivileges => ['ALL'],\ntable      => '*.*',\n66:       user       => 'debian-sys-maint@localhost',\n}\n\nfile { '/etc/mysql/debian.cnf':\nensure  => present,\nowner   => 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n# Target line: 66\n\n     61:     mysql_grant { 'debian-sys-maint@localhost/*.*':\n     62:       ensure     => 'present',\n     63:       options    => ['GRANT'],\n     64:       privileges => ['ALL'],\n     65:       table      => '*.*',\n>>>  66:       user       => 'debian-sys-maint@localhost',\n     67:     }\n     68: \n     69:     file { '/etc/mysql/debian.cnf':\n     70:       ensure  => present,\n     71:       owner   => 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-ssh_key.pp", "content": "$jenkins_user   = 'jenkins',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-ssh_key.pp\n\n#   AWS SSH key config ID (visible in AWS console).\n#\nclass govuk_jenkins::ssh_key (\n$private_key    = undef,\n$public_key     = undef,\n25:   $jenkins_user   = 'jenkins',\n$home_dir       = '/var/lib/jenkins',\n$aws_ssh_key_id = undef,\n) {\n$ssh_dir = \"${home_dir}/.ssh\"\n$private_key_filename = \"${ssh_dir}/id_rsa\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-ssh_key.pp\n# Target line: 25\n\n     20: #   AWS SSH key config ID (visible in AWS console).\n     21: #\n     22: class govuk_jenkins::ssh_key (\n     23:   $private_key    = undef,\n     24:   $public_key     = undef,\n>>>  25:   $jenkins_user   = 'jenkins',\n     26:   $home_dir       = '/var/lib/jenkins',\n     27:   $aws_ssh_key_id = undef,\n     28: ) {\n     29:   $ssh_dir = \"${home_dir}/.ssh\"\n     30:   $private_key_filename = \"${ssh_dir}/id_rsa\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'D88E42B4';", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrepos    => ['stable'],\nkey      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n'elasticsearch-1.4':\nlocation => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\nrelease  => 'stable',\n52:       key      => 'D88E42B4';\n'elasticsearch-1.5':\nlocation => 'http://packages.elastic.co/elasticsearch/1.5/debian',\nrelease  => 'stable',\nkey      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n'elasticsearch-1.7':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 52\n\n     47:       repos    => ['stable'],\n     48:       key      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n     49:     'elasticsearch-1.4':\n     50:       location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\n     51:       release  => 'stable',\n>>>  52:       key      => 'D88E42B4';\n     53:     'elasticsearch-1.5':\n     54:       location => 'http://packages.elastic.co/elasticsearch/1.5/debian',\n     55:       release  => 'stable',\n     56:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n     57:     'elasticsearch-1.7':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "bodepd@puppetlabs-openstack-examples-site.pp", "content": "$nova_user_password      = 'nova_pass'", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n\n$admin_email             = 'root@localhost'\n$admin_password          = 'keystone_admin'\n$keystone_db_password    = 'keystone_db_pass'\n$keystone_admin_token    = 'keystone_admin_token'\n$nova_db_password        = 'nova_pass'\n28: $nova_user_password      = 'nova_pass'\n$glance_db_password      = 'glance_pass'\n$glance_user_password    = 'glance_pass'\n$rabbit_password         = 'openstack_rabbit_password'\n$rabbit_user             = 'openstack_rabbit_user'\n$fixed_network_range     = '10.0.0.0/24'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n# Target line: 28\n\n     23: $admin_email             = 'root@localhost'\n     24: $admin_password          = 'keystone_admin'\n     25: $keystone_db_password    = 'keystone_db_pass'\n     26: $keystone_admin_token    = 'keystone_admin_token'\n     27: $nova_db_password        = 'nova_pass'\n>>>  28: $nova_user_password      = 'nova_pass'\n     29: $glance_db_password      = 'glance_pass'\n     30: $glance_user_password    = 'glance_pass'\n     31: $rabbit_password         = 'openstack_rabbit_password'\n     32: $rabbit_user             = 'openstack_rabbit_user'\n     33: $fixed_network_range     = '10.0.0.0/24'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "CiscoSystems@puppet-openstack-manifests-compute.pp", "content": "$nova_user_password  = 'nova_pass',", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n\n$multi_host          = false,\n$network_config      = {},\n# my address\n# conection information\n$sql_connection      = false,\n59:   $nova_user_password  = 'nova_pass',\n$rabbit_host         = false,\n$rabbit_password     = 'rabbit_pw',\n$rabbit_user         = 'nova',\n$glance_api_servers  = false,\n# nova compute configuration parameters", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n# Target line: 59\n\n     54:   $multi_host          = false,\n     55:   $network_config      = {},\n     56:   # my address\n     57:   # conection information\n     58:   $sql_connection      = false,\n>>>  59:   $nova_user_password  = 'nova_pass',\n     60:   $rabbit_host         = false,\n     61:   $rabbit_password     = 'rabbit_pw',\n     62:   $rabbit_user         = 'nova',\n     63:   $glance_api_servers  = false,\n     64:   # nova compute configuration parameters\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp", "content": "www_root             => '/opt/spotlight/shared/assets',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n\nlocation             => '/spotlight/',\nrewrite_rules        => [\n'^/spotlight(.*)$ $1 break'\n],\nvhost                => $::assets_internal_vhost,\n31:     www_root             => '/opt/spotlight/shared/assets',\nlocation_cfg_prepend => {\n'expires' => '30d',\n},\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n# Target line: 31\n\n     26:     location             => '/spotlight/',\n     27:     rewrite_rules        => [\n     28:       '^/spotlight(.*)$ $1 break'\n     29:     ],\n     30:     vhost                => $::assets_internal_vhost,\n>>>  31:     www_root             => '/opt/spotlight/shared/assets',\n     32:     location_cfg_prepend => {\n     33:       'expires' => '30d',\n     34:     },\n     35:   }\n     36: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-tor-manifests-daemon-params.pp", "content": "$manage_user   = false", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n\nclass tor::daemon::params {\ncase $facts['osfamily'] {\n'RedHat': {\n$user          = 'toranon'\n$group         = 'toranon'\n7:       $manage_user   = false\n$data_dir_mode = '0750'\n}\n'Debian': {\n$user          = 'debian-tor'\n$group         = 'debian-tor'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n# Target line: 7\n\n      2: class tor::daemon::params {\n      3:   case $facts['osfamily'] {\n      4:     'RedHat': {\n      5:       $user          = 'toranon'\n      6:       $group         = 'toranon'\n>>>   7:       $manage_user   = false\n      8:       $data_dir_mode = '0750'\n      9:     }\n     10:     'Debian': {\n     11:       $user          = 'debian-tor'\n     12:       $group         = 'debian-tor'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-haproxy-manifests-params.pp", "content": "$global_options   = {", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-haproxy-manifests-params.pp\n\n#\nclass haproxy::params {\ncase $::osfamily {\n'Archlinux', 'Debian', 'RedHat': {\n$package_name     = 'haproxy'\n11:       $global_options   = {\n'log'     => \"${::ipaddress} local0\",\n'chroot'  => '/var/lib/haproxy',\n'pidfile' => '/var/run/haproxy.pid',\n'maxconn' => '4000',\n'user'    => 'haproxy',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-haproxy-manifests-params.pp\n# Target line: 11\n\n      6: #\n      7: class haproxy::params {\n      8:   case $::osfamily {\n      9:     'Archlinux', 'Debian', 'RedHat': {\n     10:       $package_name     = 'haproxy'\n>>>  11:       $global_options   = {\n     12:         'log'     => \"${::ipaddress} local0\",\n     13:         'chroot'  => '/var/lib/haproxy',\n     14:         'pidfile' => '/var/run/haproxy.pid',\n     15:         'maxconn' => '4000',\n     16:         'user'    => 'haproxy',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Automattic@vip-quickstart-puppet-manifests-sections-webserver.pp", "content": "docroot    => '/srv/www',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: Automattic@vip-quickstart-puppet-manifests-sections-webserver.pp\n\nclient_max_body_size => '1024m',\ntypes_hash_max_size  => '2048',\n}\n\nnginx::vhost { '_':\n9:   docroot    => '/srv/www',\ntemplate   => 'nginx/vip.dev.erb',\nowner      => 'www-data',\ngroupowner => 'www-data',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Automattic@vip-quickstart-puppet-manifests-sections-webserver.pp\n# Target line: 9\n\n      4:   client_max_body_size => '1024m',\n      5:   types_hash_max_size  => '2048',\n      6: }\n      7: \n      8: nginx::vhost { '_':\n>>>   9:   docroot    => '/srv/www',\n     10:   template   => 'nginx/vip.dev.erb',\n     11:   owner      => 'www-data',\n     12:   groupowner => 'www-data',\n     13: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-webapp-onlinestore-manifests-install.pp", "content": "$docroot = '/var/www/onlinestore'", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-webapp-onlinestore-manifests-install.pp\n\n$murderer_id = $secgen_parameters['murderer_id'][0]\n$murdered_on = $secgen_parameters['murdered_on']\n$murdered_ids = $secgen_parameters['murdered_ids']\n$db_password = $secgen_parameters['db_password'][0]\n\n18:   $docroot = '/var/www/onlinestore'\n$db_username = 'csecvm'\n\nExec { path => ['/bin', '/usr/bin', '/usr/local/bin', '/sbin', '/usr/sbin'], }\n\nfile { \"$docroot/index.html\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-webapp-onlinestore-manifests-install.pp\n# Target line: 18\n\n     13:   $murderer_id = $secgen_parameters['murderer_id'][0]\n     14:   $murdered_on = $secgen_parameters['murdered_on']\n     15:   $murdered_ids = $secgen_parameters['murdered_ids']\n     16:   $db_password = $secgen_parameters['db_password'][0]\n     17: \n>>>  18:   $docroot = '/var/www/onlinestore'\n     19:   $db_username = 'csecvm'\n     20: \n     21:   Exec { path => ['/bin', '/usr/bin', '/usr/local/bin', '/sbin', '/usr/sbin'], }\n     22: \n     23:   file { \"$docroot/index.html\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-check_sentry_errors.pp", "content": "$sentry_auth_token = undef,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-check_sentry_errors.pp\n\n# == Class: govuk_jenkins::jobs::check_sentry_errors\n#\n# Create a file on disk that can be parsed by jenkins-job-builder\n#\nclass govuk_jenkins::jobs::check_sentry_errors (\n6:   $sentry_auth_token = undef,\n) {\nfile { '/etc/jenkins_jobs/jobs/check_sentry_errors.yaml':\nensure  => present,\ncontent => template('govuk_jenkins/jobs/check_sentry_errors.yaml.erb'),\nnotify  => Exec['jenkins_jobs_update'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-check_sentry_errors.pp\n# Target line: 6\n\n      1: # == Class: govuk_jenkins::jobs::check_sentry_errors\n      2: #\n      3: # Create a file on disk that can be parsed by jenkins-job-builder\n      4: #\n      5: class govuk_jenkins::jobs::check_sentry_errors (\n>>>   6:   $sentry_auth_token = undef,\n      7: ) {\n      8:   file { '/etc/jenkins_jobs/jobs/check_sentry_errors.yaml':\n      9:     ensure  => present,\n     10:     content => template('govuk_jenkins/jobs/check_sentry_errors.yaml.erb'),\n     11:     notify  => Exec['jenkins_jobs_update'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-quota.pp", "content": "$max_backups_per_user     = undef,", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: openstack@puppet-trove-manifests-quota.pp\n\n$max_backups_per_tenant   = 50,\n$quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n# Deprecated\n$max_instances_per_user   = undef,\n$max_volumes_per_user     = undef,\n52:   $max_backups_per_user     = undef,\n) {\n\ninclude ::trove::deps\n\nif $max_instances_per_user {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-quota.pp\n# Target line: 52\n\n     47:   $max_backups_per_tenant   = 50,\n     48:   $quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n     49:   # Deprecated\n     50:   $max_instances_per_user   = undef,\n     51:   $max_volumes_per_user     = undef,\n>>>  52:   $max_backups_per_user     = undef,\n     53: ) {\n     54: \n     55:   include ::trove::deps\n     56: \n     57:   if $max_instances_per_user {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-user_monitor.pp", "content": "$github_token = undef,", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-user_monitor.pp\n\n#\n# [*github_token*]\n#   A GitHub access token with the `read:org` permissions\n#\nclass govuk_jenkins::jobs::user_monitor (\n11:   $github_token = undef,\n$app_domain = hiera('app_domain'),\n) {\n\n$service_description = 'Check that correct users have access'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-user_monitor.pp\n# Target line: 11\n\n      6: #\n      7: # [*github_token*]\n      8: #   A GitHub access token with the `read:org` permissions\n      9: #\n     10: class govuk_jenkins::jobs::user_monitor (\n>>>  11:   $github_token = undef,\n     12:   $app_domain = hiera('app_domain'),\n     13: ) {\n     14: \n     15:   $service_description = 'Check that correct users have access'\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-integration_deploy.pp", "content": "$jenkins_integration_aws_api_password = undef,", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-integration_deploy.pp\n\nclass govuk_jenkins::jobs::integration_deploy (\n$applications = undef,\n$jenkins_integration_api_user = undef,\n$jenkins_integration_api_password = undef,\n$jenkins_integration_aws_api_user = undef,\n37:   $jenkins_integration_aws_api_password = undef,\n$aws_deploy_url = 'deploy.integration.publishing.service.gov.uk',\n$ci_deploy_url = 'ci-deploy.integration.publishing.service.gov.uk',\n$puppet_auth_token = undef,\n) {\nfile { '/etc/jenkins_jobs/jobs/integration_app_deploy.yaml':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-integration_deploy.pp\n# Target line: 37\n\n     32: class govuk_jenkins::jobs::integration_deploy (\n     33:   $applications = undef,\n     34:   $jenkins_integration_api_user = undef,\n     35:   $jenkins_integration_api_password = undef,\n     36:   $jenkins_integration_aws_api_user = undef,\n>>>  37:   $jenkins_integration_aws_api_password = undef,\n     38:   $aws_deploy_url = 'deploy.integration.publishing.service.gov.uk',\n     39:   $ci_deploy_url = 'ci-deploy.integration.publishing.service.gov.uk',\n     40:   $puppet_auth_token = undef,\n     41: ) {\n     42:   file { '/etc/jenkins_jobs/jobs/integration_app_deploy.yaml':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-neutron.pp", "content": "neutron_password      => hiera('CONFIG_NEUTRON_KS_PW'),", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-neutron.pp\n\n$nova_neutron_cfg_ctrl_host = hiera('CONFIG_KEYSTONE_HOST_URL')\n$neutron_auth_url = hiera('CONFIG_KEYSTONE_ADMIN_URL')\n\nclass { '::nova::network::neutron':\ndefault_floating_pool => 'public',\n8:       neutron_password      => hiera('CONFIG_NEUTRON_KS_PW'),\nneutron_auth_type     => 'v3password',\nneutron_url           => \"http://${nova_neutron_cfg_ctrl_host}:9696\",\nneutron_project_name  => 'services',\nneutron_auth_url      => \"${neutron_auth_url}/v3\",\nneutron_region_name   => hiera('CONFIG_KEYSTONE_REGION'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-neutron.pp\n# Target line: 8\n\n      3:     $nova_neutron_cfg_ctrl_host = hiera('CONFIG_KEYSTONE_HOST_URL')\n      4:     $neutron_auth_url = hiera('CONFIG_KEYSTONE_ADMIN_URL')\n      5: \n      6:     class { '::nova::network::neutron':\n      7:       default_floating_pool => 'public',\n>>>   8:       neutron_password      => hiera('CONFIG_NEUTRON_KS_PW'),\n      9:       neutron_auth_type     => 'v3password',\n     10:       neutron_url           => \"http://${nova_neutron_cfg_ctrl_host}:9696\",\n     11:       neutron_project_name  => 'services',\n     12:       neutron_auth_url      => \"${neutron_auth_url}/v3\",\n     13:       neutron_region_name   => hiera('CONFIG_KEYSTONE_REGION'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-params.pp", "content": "$admin_password     = undef,", "line": 78, "detection_span": [73, 83], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-params.pp\n\n$region             = 'RegionOne',\n$admin_name         = 'monasca-admin',\n$agent_name         = 'monasca-agent',\n$user_name          = 'monasca-user',\n$auth_method        = 'token',\n78:     $admin_password     = undef,\n$admin_project_name = undef,\n$agent_password     = undef,\n$user_password      = undef,\n$sql_host           = undef,\n$sql_user           = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-params.pp\n# Target line: 78\n\n     73:     $region             = 'RegionOne',\n     74:     $admin_name         = 'monasca-admin',\n     75:     $agent_name         = 'monasca-agent',\n     76:     $user_name          = 'monasca-user',\n     77:     $auth_method        = 'token',\n>>>  78:     $admin_password     = undef,\n     79:     $admin_project_name = undef,\n     80:     $agent_password     = undef,\n     81:     $user_password      = undef,\n     82:     $sql_host           = undef,\n     83:     $sql_user           = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-manifests-pki-ca.pp", "content": "$_ca_key_mode = '0600'", "line": 60, "detection_span": [55, 65], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-pki-ca.pp\n\nowner => $user,\ngroup => $group,\n}\n\nif $::osfamily != 'windows' {\n60:     $_ca_key_mode = '0600'\n} else {\n$_ca_key_mode = undef\n}\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-pki-ca.pp\n# Target line: 60\n\n     55:     owner => $user,\n     56:     group => $group,\n     57:   }\n     58: \n     59:   if $::osfamily != 'windows' {\n>>>  60:     $_ca_key_mode = '0600'\n     61:   } else {\n     62:     $_ca_key_mode = undef\n     63:   }\n     64: \n     65: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-server-config.pp", "content": "auth_method => 'md5',", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-server-config.pp\n\ncreate_resources('postgresql::server::pg_hba_rule', $ipv4acl_resources)\n\npostgresql::server::pg_hba_rule { 'allow access to all users':\ntype        => 'host',\naddress     => $ip_mask_allow_all_users,\n77:           auth_method => 'md5',\norder       => '100',\n}\npostgresql::server::pg_hba_rule { 'allow access to ipv6 localhost':\ntype        => 'host',\naddress     => '::1/128',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-server-config.pp\n# Target line: 77\n\n     72:         create_resources('postgresql::server::pg_hba_rule', $ipv4acl_resources)\n     73: \n     74:         postgresql::server::pg_hba_rule { 'allow access to all users':\n     75:           type        => 'host',\n     76:           address     => $ip_mask_allow_all_users,\n>>>  77:           auth_method => 'md5',\n     78:           order       => '100',\n     79:         }\n     80:         postgresql::server::pg_hba_rule { 'allow access to ipv6 localhost':\n     81:           type        => 'host',\n     82:           address     => '::1/128',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "camptocamp@puppet-tomcat-manifests-source.pp", "content": "digest_url   => \"${tomcaturl}.md5\",", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: camptocamp@puppet-tomcat-manifests-source.pp\n\n\narchive{ $tomcat_name:\nsource       => $tomcaturl,\nextract      => true,\npath         => \"/var/tmp/${tomcat_name}.tar.gz\",\n49:     digest_url   => \"${tomcaturl}.md5\",\ndigest_type  => 'md5',\nextract_path => '/opt',\ncreates      => \"/opt/${tomcat_name}/bin\",\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-tomcat-manifests-source.pp\n# Target line: 49\n\n     44: \n     45:   archive{ $tomcat_name:\n     46:     source       => $tomcaturl,\n     47:     extract      => true,\n     48:     path         => \"/var/tmp/${tomcat_name}.tar.gz\",\n>>>  49:     digest_url   => \"${tomcaturl}.md5\",\n     50:     digest_type  => 'md5',\n     51:     extract_path => '/opt',\n     52:     creates      => \"/opt/${tomcat_name}/bin\",\n     53:   }\n     54: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "camptocamp@puppet-archive-manifests-download.pp", "content": "$digest_type='md5',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: camptocamp@puppet-archive-manifests-download.pp\n\n$url,\n$ensure=present,\n$checksum=true,\n$digest_url=undef,\n$digest_string=undef,\n40:   $digest_type='md5',\n$timeout=120,\n$src_target='/usr/src',\n$allow_insecure=false,\n$follow_redirects=false,\n$verbose=true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-archive-manifests-download.pp\n# Target line: 40\n\n     35:   $url,\n     36:   $ensure=present,\n     37:   $checksum=true,\n     38:   $digest_url=undef,\n     39:   $digest_string=undef,\n>>>  40:   $digest_type='md5',\n     41:   $timeout=120,\n     42:   $src_target='/usr/src',\n     43:   $allow_insecure=false,\n     44:   $follow_redirects=false,\n     45:   $verbose=true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "duritong@puppet-shorewall-manifests-rules-torify-reject_non_tor.pp", "content": "$rule = \"reject-non-tor-from-${user}-to=${originaldest_sha1}\"", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: duritong@puppet-shorewall-manifests-rules-torify-reject_non_tor.pp\n\n$allow_rfc1918 = true\n){\n\n# hash the destination as it may contain slashes\n$originaldest_sha1 = sha1($originaldest)\n9:   $rule = \"reject-non-tor-from-${user}-to=${originaldest_sha1}\"\n\nif $originaldest == '-' {\n$originaldest_real = $allow_rfc1918 ? {\nfalse   => '!127.0.0.1',\ndefault => '!127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-shorewall-manifests-rules-torify-reject_non_tor.pp\n# Target line: 9\n\n      4:   $allow_rfc1918 = true\n      5: ){\n      6: \n      7:   # hash the destination as it may contain slashes\n      8:   $originaldest_sha1 = sha1($originaldest)\n>>>   9:   $rule = \"reject-non-tor-from-${user}-to=${originaldest_sha1}\"\n     10: \n     11:   if $originaldest == '-' {\n     12:     $originaldest_real = $allow_rfc1918 ? {\n     13:       false   => '!127.0.0.1',\n     14:       default => '!127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
