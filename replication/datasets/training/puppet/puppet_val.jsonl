{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-heat-keystone.pp", "content": "$configure_user      = pick($heat_hash['configure_user'], true)", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-heat-keystone.pp\n\n$admin_address     = get_ssl_property($ssl_hash, {}, 'heat', 'admin', 'hostname', [hiera('heat_endpoint', ''), $management_vip])\n\n$password            = $heat_hash['user_password']\n$auth_name           = pick($heat_hash['auth_name'], 'heat')\n$configure_endpoint  = pick($heat_hash['configure_endpoint'], true)\n24:   $configure_user      = pick($heat_hash['configure_user'], true)\n$configure_user_role = pick($heat_hash['configure_user_role'], true)\n$service_name        = pick($heat_hash['service_name'], 'heat')\n$tenant              = pick($heat_hash['tenant'], 'services')\n\nClass['::osnailyfacter::wait_for_keystone_backends'] -> Class['::heat::keystone::auth']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-heat-keystone.pp\n# Target line: 24\n\n     19:   $admin_address     = get_ssl_property($ssl_hash, {}, 'heat', 'admin', 'hostname', [hiera('heat_endpoint', ''), $management_vip])\n     20: \n     21:   $password            = $heat_hash['user_password']\n     22:   $auth_name           = pick($heat_hash['auth_name'], 'heat')\n     23:   $configure_endpoint  = pick($heat_hash['configure_endpoint'], true)\n>>>  24:   $configure_user      = pick($heat_hash['configure_user'], true)\n     25:   $configure_user_role = pick($heat_hash['configure_user_role'], true)\n     26:   $service_name        = pick($heat_hash['service_name'], 'heat')\n     27:   $tenant              = pick($heat_hash['tenant'], 'services')\n     28: \n     29:   Class['::osnailyfacter::wait_for_keystone_backends'] -> Class['::heat::keystone::auth']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-glance.pp", "content": "$username                   = 'ironic',", "line": 96, "detection_span": [91, 101], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-glance.pp\n\n#\nclass ironic::glance (\n$auth_type                  = 'password',\n$auth_url                   = $::os_service_default,\n$project_name               = 'services',\n96:   $username                   = 'ironic',\n$password                   = $::os_service_default,\n$user_domain_name           = 'Default',\n$project_domain_name        = 'Default',\n$api_servers                = $::os_service_default,\n$num_retries                = $::os_service_default,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-glance.pp\n# Target line: 96\n\n     91: #\n     92: class ironic::glance (\n     93:   $auth_type                  = 'password',\n     94:   $auth_url                   = $::os_service_default,\n     95:   $project_name               = 'services',\n>>>  96:   $username                   = 'ironic',\n     97:   $password                   = $::os_service_default,\n     98:   $user_domain_name           = 'Default',\n     99:   $project_domain_name        = 'Default',\n    100:   $api_servers                = $::os_service_default,\n    101:   $num_retries                = $::os_service_default,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-examples-neutron.pp", "content": "auth_password       => 'password',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack@puppet-neutron-examples-neutron.pp\n\nservice_plugins       => ['metering']\n}\n\n# The API server talks to keystone for authorisation\nclass { '::neutron::server':\n13:   auth_password       => 'password',\ndatabase_connection => 'mysql+pymysql://neutron:password@192.168.1.1/neutron',\n}\n\n# Configure nova notifications system\nclass { '::neutron::server::notifications':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-examples-neutron.pp\n# Target line: 13\n\n      8:   service_plugins       => ['metering']\n      9: }\n     10: \n     11: # The API server talks to keystone for authorisation\n     12: class { '::neutron::server':\n>>>  13:   auth_password       => 'password',\n     14:   database_connection => 'mysql+pymysql://neutron:password@192.168.1.1/neutron',\n     15: }\n     16: \n     17: # Configure nova notifications system\n     18: class { '::neutron::server::notifications':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-init.pp", "content": "password => 'ignored',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-init.pp\n\n}\n\n# Setup password free auth for VM's vagrant user\nmysql::user { 'vagrant':\nensure   => present,\n38:         password => 'ignored',\ngrant    => 'ALL PRIVILEGES ON *.*',\nhostname => 'localhost',\nsocket   => true,\n}\nfile { '/home/vagrant/.my.cnf':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-init.pp\n# Target line: 38\n\n     33:     }\n     34: \n     35:     # Setup password free auth for VM's vagrant user\n     36:     mysql::user { 'vagrant':\n     37:         ensure   => present,\n>>>  38:         password => 'ignored',\n     39:         grant    => 'ALL PRIVILEGES ON *.*',\n     40:         hostname => 'localhost',\n     41:         socket   => true,\n     42:     }\n     43:     file { '/home/vagrant/.my.cnf':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "$config_admin_user = true", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\n$endpoint_version = \"v2\"\n\nif ($keystone_version == \"v3\" ) {\n$config_admin_user = false\n} else {\n41:     $config_admin_user = true\n}\n\nclass { 'keystone::endpoint':\npublic_url   => \"${keystone_auth_protocol}://${keystone_ip_to_use}:5000\",\nadmin_url    => \"${keystone_auth_protocol}://${keystone_ip_to_use}:35357\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 41\n\n     36:   $endpoint_version = \"v2\"\n     37: \n     38:   if ($keystone_version == \"v3\" ) {\n     39:     $config_admin_user = false\n     40:   } else {\n>>>  41:     $config_admin_user = true\n     42:   }\n     43: \n     44:   class { 'keystone::endpoint':\n     45:     public_url   => \"${keystone_auth_protocol}://${keystone_ip_to_use}:5000\",\n     46:     admin_url    => \"${keystone_auth_protocol}://${keystone_ip_to_use}:35357\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-distributed-replicate-example.pp", "content": "fsuuid => '4dfa7e50-2315-44d3-909b-8e9423def6e5',", "line": 115, "detection_span": [110, 120], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n\n110:\n111: \tgluster::brick { 'annex4.example.com:/mnt/storage4d':\n112: \t\tdev => '/dev/disk/by-id/scsi-36003048007e36700174029270d82724d',\t# /dev/sdd\n113: \t\tlabeltype => 'gpt',\n114: \t\tfstype => 'xfs',\n115: \t\tfsuuid => '4dfa7e50-2315-44d3-909b-8e9423def6e5',\n116: \t\txfs_inode64 => true,\n117: \t\txfs_nobarrier => true,\n118: \t\tareyousure => true,\n119: \t}\n120:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n# Target line: 115\n\n    110: \n    111: \tgluster::brick { 'annex4.example.com:/mnt/storage4d':\n    112: \t\tdev => '/dev/disk/by-id/scsi-36003048007e36700174029270d82724d',\t# /dev/sdd\n    113: \t\tlabeltype => 'gpt',\n    114: \t\tfstype => 'xfs',\n>>> 115: \t\tfsuuid => '4dfa7e50-2315-44d3-909b-8e9423def6e5',\n    116: \t\txfs_inode64 => true,\n    117: \t\txfs_nobarrier => true,\n    118: \t\tareyousure => true,\n    119: \t}\n    120: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-conductor-site_admin.pp", "content": "user        => 'aeolus',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-conductor-site_admin.pp\n\n# Create a new site admin conductor web user\ndefine aeolus::conductor::site_admin($email=\"\", $password=\"\", $first_name=\"\", $last_name=\"\"){\nexec{\"create_site_admin_user\":\ncwd         => '/usr/share/aeolus-conductor',\nenvironment => \"RAILS_ENV=production\",\n6:          user        => 'aeolus',\ncommand     => \"rake dc:create_user[${name},${password},${email},${first_name},${last_name}]\",\nunless      => 'rake dc:admin_exists',\nrequire     => Aeolus::Rails::Seed::Db[\"seed_aeolus_database\"]}\nexec{\"grant_site_admin_privs\":\ncwd         => '/usr/share/aeolus-conductor',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-conductor-site_admin.pp\n# Target line: 6\n\n      1: # Create a new site admin conductor web user\n      2: define aeolus::conductor::site_admin($email=\"\", $password=\"\", $first_name=\"\", $last_name=\"\"){\n      3:   exec{\"create_site_admin_user\":\n      4:          cwd         => '/usr/share/aeolus-conductor',\n      5:          environment => \"RAILS_ENV=production\",\n>>>   6:          user        => 'aeolus',\n      7:          command     => \"rake dc:create_user[${name},${password},${email},${first_name},${last_name}]\",\n      8:          unless      => 'rake dc:admin_exists',\n      9:          require     => Aeolus::Rails::Seed::Db[\"seed_aeolus_database\"]}\n     10:   exec{\"grant_site_admin_privs\":\n     11:          cwd         => '/usr/share/aeolus-conductor',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-manifests-mod-ldap.pp", "content": "Optional[String] $ldap_trusted_global_cert_type  = 'CA_BASE64',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-manifests-mod-ldap.pp\n\nclass apache::mod::ldap (\n$apache_version                                  = undef,\n$package_name                                    = undef,\n$ldap_trusted_global_cert_file                   = undef,\n5:   Optional[String] $ldap_trusted_global_cert_type  = 'CA_BASE64',\n$ldap_shared_cache_size                          = undef,\n$ldap_cache_entries                              = undef,\n$ldap_cache_ttl                                  = undef,\n$ldap_opcache_entries                            = undef,\n$ldap_opcache_ttl                                = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-manifests-mod-ldap.pp\n# Target line: 5\n\n      1: class apache::mod::ldap (\n      2:   $apache_version                                  = undef,\n      3:   $package_name                                    = undef,\n      4:   $ldap_trusted_global_cert_file                   = undef,\n>>>   5:   Optional[String] $ldap_trusted_global_cert_type  = 'CA_BASE64',\n      6:   $ldap_shared_cache_size                          = undef,\n      7:   $ldap_cache_entries                              = undef,\n      8:   $ldap_cache_ttl                                  = undef,\n      9:   $ldap_opcache_entries                            = undef,\n     10:   $ldap_opcache_ttl                                = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$password    = undef, #: https or ftp user password or https certificate password", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\ndefine staging::file (\n$source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n$target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n$username    = undef, #: https or ftp username\n$certificate = undef, #: https certificate file\n17:   $password    = undef, #: https or ftp user password or https certificate password\n$environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n$timeout     = undef, #: the the time to wait for the file transfer to complete\n$curl_option = undef, #: options to pass to curl\n$wget_option = undef, #: options to pass to wget\n$subdir      = $caller_module_name", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 17\n\n     12: define staging::file (\n     13:   $source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n     14:   $target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n     15:   $username    = undef, #: https or ftp username\n     16:   $certificate = undef, #: https certificate file\n>>>  17:   $password    = undef, #: https or ftp user password or https certificate password\n     18:   $environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n     19:   $timeout     = undef, #: the the time to wait for the file transfer to complete\n     20:   $curl_option = undef, #: options to pass to curl\n     21:   $wget_option = undef, #: options to pass to wget\n     22:   $subdir      = $caller_module_name\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-auth_file.pp", "content": "$admin_user               = 'admin',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-auth_file.pp\n\n# The profile to install an OpenStack specific mysql server\nclass contrail::profile::openstack::auth_file(\n$admin_password           = $::contrail::params::keystone_admin_password,\n$keystone_admin_token     = $::contrail::params::os_keystone_admin_token,\n$internal_vip             = $::contrail::params::internal_vip,\n6:   $admin_user               = 'admin',\n$admin_tenant             = 'admin',\n$region_name              = $::contrail::params::os_region,\n$keystone_version         = $::contrail::params::keystone_version,\n$use_no_cache             = true,\n$cinder_endpoint_type     = 'publicURL',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-auth_file.pp\n# Target line: 6\n\n      1: # The profile to install an OpenStack specific mysql server\n      2: class contrail::profile::openstack::auth_file(\n      3:   $admin_password           = $::contrail::params::keystone_admin_password,\n      4:   $keystone_admin_token     = $::contrail::params::os_keystone_admin_token,\n      5:   $internal_vip             = $::contrail::params::internal_vip,\n>>>   6:   $admin_user               = 'admin',\n      7:   $admin_tenant             = 'admin',\n      8:   $region_name              = $::contrail::params::os_region,\n      9:   $keystone_version         = $::contrail::params::keystone_version,\n     10:   $use_no_cache             = true,\n     11:   $cinder_endpoint_type     = 'publicURL',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-gds_rabbitmq-manifests-init.pp", "content": "admin    => true,", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: alphagov@ci-puppet-modules-gds_rabbitmq-manifests-init.pp\n\nclass { '::rabbitmq':\nmanage_repos => false,\n}\n\nrabbitmq_user { 'root':\n14:     admin    => true,\npassword => $root_password,\n}\n\nrabbitmq_user_permissions { 'root@/':\nconfigure_permission => '.*',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-gds_rabbitmq-manifests-init.pp\n# Target line: 14\n\n      9:   class { '::rabbitmq':\n     10:     manage_repos => false,\n     11:   }\n     12: \n     13:   rabbitmq_user { 'root':\n>>>  14:     admin    => true,\n     15:     password => $root_password,\n     16:   }\n     17: \n     18:   rabbitmq_user_permissions { 'root@/':\n     19:     configure_permission => '.*',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_grant.pp", "content": "$user          = 'root',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_grant.pp\n\n#    password_hash => mysql_password('apassword')\n#  }\n#\ndefine osnailyfacter::mysql_grant (\n$network       = $title,\n45:   $user          = 'root',\n$password_hash = '',\n$database      = '*',\n$table         = '*',\n$options       = ['GRANT'],\n$privileges    = ['ALL']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_grant.pp\n# Target line: 45\n\n     40: #    password_hash => mysql_password('apassword')\n     41: #  }\n     42: #\n     43: define osnailyfacter::mysql_grant (\n     44:   $network       = $title,\n>>>  45:   $user          = 'root',\n     46:   $password_hash = '',\n     47:   $database      = '*',\n     48:   $table         = '*',\n     49:   $options       = ['GRANT'],\n     50:   $privileges    = ['ALL']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-apache-manifests-mod-userdir.pp", "content": "$disable_root = true,", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod-userdir.pp\n\nclass apache::mod::userdir (\n$home = '/home',\n$dir = 'public_html',\n4:   $disable_root = true,\n) {\n::apache::mod { 'userdir': }\n\n# Template uses $home, $dir, $disable_root\nfile { 'userdir.conf':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod-userdir.pp\n# Target line: 4\n\n      1: class apache::mod::userdir (\n      2:   $home = '/home',\n      3:   $dir = 'public_html',\n>>>   4:   $disable_root = true,\n      5: ) {\n      6:   ::apache::mod { 'userdir': }\n      7: \n      8:   # Template uses $home, $dir, $disable_root\n      9:   file { 'userdir.conf':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-iso_build.pp", "content": "www_root    => '/var/www',", "line": 142, "detection_span": [137, 147], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-iso_build.pp\n\n137:   })\n138:\n139:   ::nginx::resource::vhost { 'share':\nserver_name => ['_'],\nautoindex   => 'on',\n142:     www_root    => '/var/www',\nrequire     => [\nFile['/var/www'],\n],\n146:   }\n147: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-iso_build.pp\n# Target line: 142\n\n    137:   })\n    138: \n    139:   ::nginx::resource::vhost { 'share':\n    140:     server_name => ['_'],\n    141:     autoindex   => 'on',\n>>> 142:     www_root    => '/var/www',\n    143:     require     => [\n    144:       File['/var/www'],\n    145:     ],\n    146:   }\n    147: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@puppet-cdh-manifests-hive.pp", "content": "$jdbc_username               = 'hive',", "line": 74, "detection_span": [69, 79], "with_context": "# Puppet file: wikimedia@puppet-cdh-manifests-hive.pp\n\nclass cdh::hive(\n$metastore_host,\n$zookeeper_hosts             = undef,\n$support_concurrency         = false,\n$jdbc_database               = 'hive_metastore',\n74:     $jdbc_username               = 'hive',\n$jdbc_password               = 'hive',\n$jdbc_host                   = 'localhost',\n$jdbc_port                   = 3306,\n$jdbc_driver                 = 'com.mysql.jdbc.Driver',\n$jdbc_protocol               = 'mysql',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@puppet-cdh-manifests-hive.pp\n# Target line: 74\n\n     69: class cdh::hive(\n     70:     $metastore_host,\n     71:     $zookeeper_hosts             = undef,\n     72:     $support_concurrency         = false,\n     73:     $jdbc_database               = 'hive_metastore',\n>>>  74:     $jdbc_username               = 'hive',\n     75:     $jdbc_password               = 'hive',\n     76:     $jdbc_host                   = 'localhost',\n     77:     $jdbc_port                   = 3306,\n     78:     $jdbc_driver                 = 'com.mysql.jdbc.Driver',\n     79:     $jdbc_protocol               = 'mysql',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-ceph_mon.pp", "content": "key     => 'ceph.health',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-ceph_mon.pp\n\ntemplate => 'Template App OpenStack Ceph',\napi      => $plugin_zabbix::monitoring::api_hash,\n}\nplugin_zabbix::agent::userparameter {\n'ceph_health':\n34:         key     => 'ceph.health',\ncommand => '/etc/zabbix/scripts/ceph_health.sh'\n}\n\nplugin_zabbix_template_link { \"${plugin_zabbix::params::host_name} Template App OpenStack Ceph MON\":\nhost     => $plugin_zabbix::params::host_name,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-ceph_mon.pp\n# Target line: 34\n\n     29:       template => 'Template App OpenStack Ceph',\n     30:       api      => $plugin_zabbix::monitoring::api_hash,\n     31:     }\n     32:     plugin_zabbix::agent::userparameter {\n     33:       'ceph_health':\n>>>  34:         key     => 'ceph.health',\n     35:         command => '/etc/zabbix/scripts/ceph_health.sh'\n     36:     }\n     37: \n     38:     plugin_zabbix_template_link { \"${plugin_zabbix::params::host_name} Template App OpenStack Ceph MON\":\n     39:       host     => $plugin_zabbix::params::host_name,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp", "content": "$client_cert_keys = keys($client_certificates)", "line": 91, "detection_span": [86, 96], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n\nmode   => '0440',\nowner  => 'jboss',\ngroup  => 'jboss',\n}\n\n91:     $client_cert_keys = keys($client_certificates)\n\nconcat::fragment { $clients_config_file_path:\ntarget  => $clients_config_file_path,\ncontent => join($client_cert_keys, \".properties\\n\"),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n# Target line: 91\n\n     86:         mode   => '0440',\n     87:         owner  => 'jboss',\n     88:         group  => 'jboss',\n     89:     }\n     90: \n>>>  91:     $client_cert_keys = keys($client_certificates)\n     92: \n     93:     concat::fragment { $clients_config_file_path:\n     94:         target  => $clients_config_file_path,\n     95:         content => join($client_cert_keys, \".properties\\n\"),\n     96:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-bootstrap-manifests-profile-ciab_web_interface.pp", "content": "$docroot = '/usr/share/nginx/html'", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-ciab_web_interface.pp\n\n# Contain here because ordering dependencies are set on the\n# ciab_web_interface class so these resources are applied after\n# the bootstrap::profile::vagrant class\ncontain nginx\n\n19:     $docroot = '/usr/share/nginx/html'\n\nfile { \"${docroot}/index.html\":\ncontent => epp('bootstrap/ciab_web_interface/index.html.epp',\n{ ciab_ip => $ciab_ip } ),\nrequire => Class['nginx'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-ciab_web_interface.pp\n# Target line: 19\n\n     14:     # Contain here because ordering dependencies are set on the\n     15:     # ciab_web_interface class so these resources are applied after\n     16:     # the bootstrap::profile::vagrant class\n     17:     contain nginx\n     18: \n>>>  19:     $docroot = '/usr/share/nginx/html'\n     20: \n     21:     file { \"${docroot}/index.html\":\n     22:       content => epp('bootstrap/ciab_web_interface/index.html.epp',\n     23:                      { ciab_ip => $ciab_ip } ),\n     24:       require => Class['nginx'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp", "content": "$password             = hiera('CONFIG_PROVISION_TEMPEST_USER_PW')", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n\n$password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n$tenant_name          = 'demo'\n$floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n} else {\n$username             = hiera('CONFIG_PROVISION_TEMPEST_USER')\n11:       $password             = hiera('CONFIG_PROVISION_TEMPEST_USER_PW')\n$tenant_name          = 'tempest'\n$floating_range       = hiera('CONFIG_PROVISION_TEMPEST_FLOATRANGE')\n}\n\n# Authentication/Keystone", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n# Target line: 11\n\n      6:       $password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n      7:       $tenant_name          = 'demo'\n      8:       $floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n      9:     } else {\n     10:       $username             = hiera('CONFIG_PROVISION_TEMPEST_USER')\n>>>  11:       $password             = hiera('CONFIG_PROVISION_TEMPEST_USER_PW')\n     12:       $tenant_name          = 'tempest'\n     13:       $floating_range       = hiera('CONFIG_PROVISION_TEMPEST_FLOATRANGE')\n     14:     }\n     15: \n     16:     # Authentication/Keystone\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp", "content": "$rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n\n$nova_mariadb_host = hiera('CONFIG_MARIADB_HOST_URL')\n\n$rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n$rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n$rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n9:     $rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n\n$private_key = {\n'type' => hiera('NOVA_MIGRATION_KEY_TYPE'),\nkey  => hiera('NOVA_MIGRATION_KEY_SECRET'),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n# Target line: 9\n\n      4:     $nova_mariadb_host = hiera('CONFIG_MARIADB_HOST_URL')\n      5: \n      6:     $rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n      7:     $rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n      8:     $rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n>>>   9:     $rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n     10: \n     11:     $private_key = {\n     12:       'type' => hiera('NOVA_MIGRATION_KEY_TYPE'),\n     13:       key  => hiera('NOVA_MIGRATION_KEY_SECRET'),\n     14:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-christopherashton.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC9li9eNlp+KvuOpkBvkuKgTx16RLmGC6Qogc7O7A/aT7Q6m4EBOU5pb1+jv2TmybTzNXP8TGWhqGa9WJuOkUCR9K1Z/CFdu+hMPHpzw32P5yv0uDaJJCoOzYIrM0EQ7QWq7e9oIhJ+rW+66f//Ux7urifnBEwum3DMPLqsFaGCwxhD8Ydn6inYtF4IaY125YuLH5Pyq9Bx6/wj2MsZPxjMRM7kIoZrCUh6gKvt1OGTwRTHAnMFp5QVhS2s/Y7M0fmIuhnQ8s1UGeTAQoHX9ZahrG/hJd+tqsMk8NogQSHVAcdqZKbHdIAaEG0o72NTh8vUqIGPTVZ75ZhFEzppUcpCfcvWCmKWhDtm7AZnB3WZbV5fHHT3q2eB6nbMzzHHRzvrYDQR4DK8YIuj4fwLVV+I/XErthWos3tLn/99ME/h7+aKqCunNix7EWa8zJpOp2H8CBB5RVvHI44hgdsyXUdbT1BG/InpJpGYmNFMSF8DOutS3FC4yl0PM5OqAE51uF9znLF35gJyoavN77RD5ykQskTZsUtV73zFWNF3Dl5fbOj+VW2VbORMa8GgQNNKaVX00u8aqa28jTsDZ2ZIyucl2Fm7FvFHl8lJg9q5D8wxixGhwYMgskaumDGI+e3LP9SiGrYOyC0B+Mhn4Eiw3aO+n84ibQIbfHeEPYUoJXpiyQ== christopher.ashton@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-christopherashton.pp\n\n# Creates the christopherashton user\nclass users::christopherashton {\ngovuk_user { 'christopherashton':\nfullname => 'Christopher Ashton',\nemail    => 'christopher.ashton@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC9li9eNlp+KvuOpkBvkuKgTx16RLmGC6Qogc7O7A/aT7Q6m4EBOU5pb1+jv2TmybTzNXP8TGWhqGa9WJuOkUCR9K1Z/CFdu+hMPHpzw32P5yv0uDaJJCoOzYIrM0EQ7QWq7e9oIhJ+rW+66f//Ux7urifnBEwum3DMPLqsFaGCwxhD8Ydn6inYtF4IaY125YuLH5Pyq9Bx6/wj2MsZPxjMRM7kIoZrCUh6gKvt1OGTwRTHAnMFp5QVhS2s/Y7M0fmIuhnQ8s1UGeTAQoHX9ZahrG/hJd+tqsMk8NogQSHVAcdqZKbHdIAaEG0o72NTh8vUqIGPTVZ75ZhFEzppUcpCfcvWCmKWhDtm7AZnB3WZbV5fHHT3q2eB6nbMzzHHRzvrYDQR4DK8YIuj4fwLVV+I/XErthWos3tLn/99ME/h7+aKqCunNix7EWa8zJpOp2H8CBB5RVvHI44hgdsyXUdbT1BG/InpJpGYmNFMSF8DOutS3FC4yl0PM5OqAE51uF9znLF35gJyoavN77RD5ykQskTZsUtV73zFWNF3Dl5fbOj+VW2VbORMa8GgQNNKaVX00u8aqa28jTsDZ2ZIyucl2Fm7FvFHl8lJg9q5D8wxixGhwYMgskaumDGI+e3LP9SiGrYOyC0B+Mhn4Eiw3aO+n84ibQIbfHeEPYUoJXpiyQ== christopher.ashton@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-christopherashton.pp\n# Target line: 6\n\n      1: # Creates the christopherashton user\n      2: class users::christopherashton {\n      3:   govuk_user { 'christopherashton':\n      4:     fullname => 'Christopher Ashton',\n      5:     email    => 'christopher.ashton@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC9li9eNlp+KvuOpkBvkuKgTx16RLmGC6Qogc7O7A/aT7Q6m4EBOU5pb1+jv2TmybTzNXP8TGWhqGa9WJuOkUCR9K1Z/CFdu+hMPHpzw32P5yv0uDaJJCoOzYIrM0EQ7QWq7e9oIhJ+rW+66f//Ux7urifnBEwum3DMPLqsFaGCwxhD8Ydn6inYtF4IaY125YuLH5Pyq9Bx6/wj2MsZPxjMRM7kIoZrCUh6gKvt1OGTwRTHAnMFp5QVhS2s/Y7M0fmIuhnQ8s1UGeTAQoHX9ZahrG/hJd+tqsMk8NogQSHVAcdqZKbHdIAaEG0o72NTh8vUqIGPTVZ75ZhFEzppUcpCfcvWCmKWhDtm7AZnB3WZbV5fHHT3q2eB6nbMzzHHRzvrYDQR4DK8YIuj4fwLVV+I/XErthWos3tLn/99ME/h7+aKqCunNix7EWa8zJpOp2H8CBB5RVvHI44hgdsyXUdbT1BG/InpJpGYmNFMSF8DOutS3FC4yl0PM5OqAE51uF9znLF35gJyoavN77RD5ykQskTZsUtV73zFWNF3Dl5fbOj+VW2VbORMa8GgQNNKaVX00u8aqa28jTsDZ2ZIyucl2Fm7FvFHl8lJg9q5D8wxixGhwYMgskaumDGI+e3LP9SiGrYOyC0B+Mhn4Eiw3aO+n84ibQIbfHeEPYUoJXpiyQ== christopher.ashton@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-boxen-manifests-security.pp", "content": "key    => 'askForPasswordDelay',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: boxen@puppet-boxen-manifests-security.pp\n\n}\n\nboxen::osx_defaults { 'short delay for password dialog on screensaver':\nensure => present,\ndomain => 'com.apple.screensaver',\n19:     key    => 'askForPasswordDelay',\nvalue  => $screensaver_delay_sec,\ntype   => 'float',\nuser   => $::boxen_user\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-boxen-manifests-security.pp\n# Target line: 19\n\n     14:   }\n     15: \n     16:   boxen::osx_defaults { 'short delay for password dialog on screensaver':\n     17:     ensure => present,\n     18:     domain => 'com.apple.screensaver',\n>>>  19:     key    => 'askForPasswordDelay',\n     20:     value  => $screensaver_delay_sec,\n     21:     type   => 'float',\n     22:     user   => $::boxen_user\n     23:   }\n     24: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Mirantis@solar-resources-cinder_puppet-actions-remove.pp", "content": "rabbit_password    => 'not important as removed',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: Mirantis@solar-resources-cinder_puppet-actions-remove.pp\n\nclass {'cinder':\npackage_ensure     => 'absent',\n3:   rabbit_password    => 'not important as removed',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Mirantis@solar-resources-cinder_puppet-actions-remove.pp\n# Target line: 3\n\n      1: class {'cinder':\n      2:   package_ensure     => 'absent',\n>>>   3:   rabbit_password    => 'not important as removed',\n      4: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-policy.pp", "content": "file_user  => 'root',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: openstack@puppet-trove-manifests-policy.pp\n\n\nvalidate_legacy(Hash, 'validate_hash', $policies)\n\nOpenstacklib::Policy::Base {\nfile_path  => $policy_path,\n38:     file_user  => 'root',\nfile_group => $::trove::params::group,\n}\n\ncreate_resources('openstacklib::policy::base', $policies)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-policy.pp\n# Target line: 38\n\n     33: \n     34:   validate_legacy(Hash, 'validate_hash', $policies)\n     35: \n     36:   Openstacklib::Policy::Base {\n     37:     file_path  => $policy_path,\n>>>  38:     file_user  => 'root',\n     39:     file_group => $::trove::params::group,\n     40:   }\n     41: \n     42:   create_resources('openstacklib::policy::base', $policies)\n     43: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-webserver-apache-status.pp", "content": "$vhost = {", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: norcams@himlar-profile-manifests-webserver-apache-status.pp\n\nif $manage_status {\n\ninclude ::apache::mod::status\ninclude ::profile::webserver::apache\n\n14:     $vhost = {\n'status' => {\n'ip'             => '127.0.0.1',\n'port'           => 80,\n'manage_docroot' => false,\n'docroot'        => '/var/www/html'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-webserver-apache-status.pp\n# Target line: 14\n\n      9:   if $manage_status {\n     10: \n     11:     include ::apache::mod::status\n     12:     include ::profile::webserver::apache\n     13: \n>>>  14:     $vhost = {\n     15:       'status' => {\n     16:         'ip'             => '127.0.0.1',\n     17:         'port'           => 80,\n     18:         'manage_docroot' => false,\n     19:         'docroot'        => '/var/www/html'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-mysql-examples-mysql_db.pp", "content": "user     => 'myuser',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n\npassword => 'mypass',\nhost     => 'localhost',\ngrant    => ['SELECT', 'UPDATE'],\n}\nmysql::db { \"mydb_${fqdn}\":\n11:   user     => 'myuser',\npassword => 'mypass',\ndbname   => 'mydb',\nhost     => $::fqdn,\ngrant    => ['SELECT', 'UPDATE'],\ntag      => $domain,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n# Target line: 11\n\n      6:   password => 'mypass',\n      7:   host     => 'localhost',\n      8:   grant    => ['SELECT', 'UPDATE'],\n      9: }\n     10: mysql::db { \"mydb_${fqdn}\":\n>>>  11:   user     => 'myuser',\n     12:   password => 'mypass',\n     13:   dbname   => 'mydb',\n     14:   host     => $::fqdn,\n     15:   grant    => ['SELECT', 'UPDATE'],\n     16:   tag      => $domain,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp", "content": "$zendesk_client_username = undef,", "line": 104, "detection_span": [99, 109], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n\n$redis_host = undef,\n100:   $redis_port = undef,\n101:   $secret_key_base = undef,\n102:   $zendesk_anonymous_ticket_email = undef,\n103:   $zendesk_client_password = undef,\n104:   $zendesk_client_username = undef,\n105:   $aws_access_key_id = undef,\n106:   $aws_secret_access_key = undef,\n107:   $aws_region = 'eu-west-1',\n108:   $aws_s3_bucket_name = undef,\n109: ) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n# Target line: 104\n\n     99:   $redis_host = undef,\n    100:   $redis_port = undef,\n    101:   $secret_key_base = undef,\n    102:   $zendesk_anonymous_ticket_email = undef,\n    103:   $zendesk_client_password = undef,\n>>> 104:   $zendesk_client_username = undef,\n    105:   $aws_access_key_id = undef,\n    106:   $aws_secret_access_key = undef,\n    107:   $aws_region = 'eu-west-1',\n    108:   $aws_s3_bucket_name = undef,\n    109: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp", "content": "key     => 'haproxy.fe[*]',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.fe.discovery':\nkey     => 'haproxy.fe.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -f';\n'haproxy.fe':\n37:         key     => 'haproxy.fe[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.sv.discovery':\nkey     => 'haproxy.sv.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -s';\n'haproxy.sv':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n# Target line: 37\n\n     32:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     33:       'haproxy.fe.discovery':\n     34:         key     => 'haproxy.fe.discovery',\n     35:         command => '/etc/zabbix/scripts/haproxy.sh -f';\n     36:       'haproxy.fe':\n>>>  37:         key     => 'haproxy.fe[*]',\n     38:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     39:       'haproxy.sv.discovery':\n     40:         key     => 'haproxy.sv.discovery',\n     41:         command => '/etc/zabbix/scripts/haproxy.sh -s';\n     42:       'haproxy.sv':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_containers-manifests-terraboard.pp", "content": "$db_password = undef,", "line": 44, "detection_span": [39, 49], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_containers-manifests-terraboard.pp\n\nclass govuk_containers::terraboard(\n$aws_region = 'eu-west-1',\n$aws_access_key_id = undef,\n$aws_secret_access_key = undef,\n$aws_bucket = undef,\n44:   $db_password = undef,\n$github_oauth_client_id = undef,\n$github_oauth_client_secret = undef,\n$oauth2_proxy_base_url = undef,\n$oauth2_proxy_cookie_secret = undef,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_containers-manifests-terraboard.pp\n# Target line: 44\n\n     39: class govuk_containers::terraboard(\n     40:   $aws_region = 'eu-west-1',\n     41:   $aws_access_key_id = undef,\n     42:   $aws_secret_access_key = undef,\n     43:   $aws_bucket = undef,\n>>>  44:   $db_password = undef,\n     45:   $github_oauth_client_id = undef,\n     46:   $github_oauth_client_secret = undef,\n     47:   $oauth2_proxy_base_url = undef,\n     48:   $oauth2_proxy_cookie_secret = undef,\n     49: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp", "content": "key    => 'tilesize',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n\nclass people::felho::osx_settings::dock {\nboxen::osx_defaults { 'Set the icon size of Dock items to 48 pixels':\nuser   => $::luser,\ndomain => 'com.apple.dock',\n5:     key    => 'tilesize',\ntype   => 'int',\nvalue  => 48,\n}\n\nboxen::osx_defaults { 'Activating Dock auto-hide':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::dock {\n      2:   boxen::osx_defaults { 'Set the icon size of Dock items to 48 pixels':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.dock',\n>>>   5:     key    => 'tilesize',\n      6:     type   => 'int',\n      7:     value  => 48,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Activating Dock auto-hide':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "KrisBuytaert@puppet-graphite-manifests-params.pp", "content": "$relay_user                                = 'carbon',", "line": 102, "detection_span": [97, 107], "with_context": "# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n\n$relay_pickle_receiver_port                = '2004',\n$relay_replication_factor                  = '1',\n$relay_service_enable                      = 'running',\n$relay_service_name                        = 'carbon-relay',\n$relay_use_flow_control                    = 'True',\n102:   $relay_user                                = 'carbon',\n$web_basic_http_auth                       = false,\n$web_conf_dir                              = '/etc/graphite-web',\n$web_content_dir                           = '/usr/share/graphite/webapp/content',\n$web_data_dirs                             = '[WHISPER_DIR, RRD_DIR]',\n$web_dir                                   = '/etc/graphite-web/',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n# Target line: 102\n\n     97:   $relay_pickle_receiver_port                = '2004',\n     98:   $relay_replication_factor                  = '1',\n     99:   $relay_service_enable                      = 'running',\n    100:   $relay_service_name                        = 'carbon-relay',\n    101:   $relay_use_flow_control                    = 'True',\n>>> 102:   $relay_user                                = 'carbon',\n    103:   $web_basic_http_auth                       = false,\n    104:   $web_conf_dir                              = '/etc/graphite-web',\n    105:   $web_content_dir                           = '/usr/share/graphite/webapp/content',\n    106:   $web_data_dirs                             = '[WHISPER_DIR, RRD_DIR]',\n    107:   $web_dir                                   = '/etc/graphite-web/',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp", "content": "cinder_admin_password    => hiera('CONFIG_CINDER_KS_PW'),", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n\nnova_admin_password    => hiera('CONFIG_NOVA_KS_PW'),\nnova_admin_tenant_name => 'services',\n}\n\nclass { '::manila::volume::cinder':\n47:       cinder_admin_password    => hiera('CONFIG_CINDER_KS_PW'),\ncinder_admin_tenant_name => 'services',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n# Target line: 47\n\n     42:       nova_admin_password    => hiera('CONFIG_NOVA_KS_PW'),\n     43:       nova_admin_tenant_name => 'services',\n     44:     }\n     45: \n     46:     class { '::manila::volume::cinder':\n>>>  47:       cinder_admin_password    => hiera('CONFIG_CINDER_KS_PW'),\n     48:       cinder_admin_tenant_name => 'services',\n     49:     }\n     50: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-openstack-identity.pp", "content": "$manage_ssl_cert          = false,", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-identity.pp\n\n$gnocchi_enabled          = false,\n$roles_extra              = [],\n$manage_firewall          = true,\n$firewall_extras          = {},\n$firewall_extras_a        = {},\n17:   $manage_ssl_cert          = false,\n$manage_openidc           = false,\n$disable_admin_token_auth = false,\n$token_rotation_sync      = false,\n$manage_token_rotate      = false,\n$token_db                 = 'token_keys',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-identity.pp\n# Target line: 17\n\n     12:   $gnocchi_enabled          = false,\n     13:   $roles_extra              = [],\n     14:   $manage_firewall          = true,\n     15:   $firewall_extras          = {},\n     16:   $firewall_extras_a        = {},\n>>>  17:   $manage_ssl_cert          = false,\n     18:   $manage_openidc           = false,\n     19:   $disable_admin_token_auth = false,\n     20:   $token_rotation_sync      = false,\n     21:   $manage_token_rotate      = false,\n     22:   $token_db                 = 'token_keys',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-install.pp", "content": "$user                   = undef,", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-install.pp\n\n\n# source options\n$source_url             = undef,\n$source_strip_first_dir = true,\n$environment            = undef,\n10:   $user                   = undef,\n$group                  = undef,\n$manage_user            = undef,\n$manage_group           = undef,\n$manage_home            = undef,\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-install.pp\n# Target line: 10\n\n      5: \n      6:   # source options\n      7:   $source_url             = undef,\n      8:   $source_strip_first_dir = true,\n      9:   $environment            = undef,\n>>>  10:   $user                   = undef,\n     11:   $group                  = undef,\n     12:   $manage_user            = undef,\n     13:   $manage_group           = undef,\n     14:   $manage_home            = undef,\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-finder.pp", "content": "key    => 'FXDefaultSearchScope',", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n\n}\n\nboxen::osx_defaults { 'When performing a search, search the current folder by default':\nuser   => $::luser,\ndomain => 'com.apple.finder',\n86:     key    => 'FXDefaultSearchScope',\ntype   => 'string',\nvalue  => 'SCcf',\n}\n\n$new_window_folder = \"/Users/${::luser}/Downloads\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n# Target line: 86\n\n     81:   }\n     82: \n     83:   boxen::osx_defaults { 'When performing a search, search the current folder by default':\n     84:     user   => $::luser,\n     85:     domain => 'com.apple.finder',\n>>>  86:     key    => 'FXDefaultSearchScope',\n     87:     type   => 'string',\n     88:     value  => 'SCcf',\n     89:   }\n     90: \n     91:   $new_window_folder = \"/Users/${::luser}/Downloads\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "basho-labs@puppet-riak-manifests-repository-debian.pp", "content": "key        => '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: basho-labs@puppet-riak-manifests-repository-debian.pp\n\nclass riak::repository::debian {\nensure_packages('apt-transport-https') # packagecloud is https-only\ninclude ::apt\napt::source { 'riak':\nlocation   => 'https://packagecloud.io/basho/riak/debian/',\n10:     key        => '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB',\npin        => '550',\nrepos      => 'main',\nrelease    => $::lsbdistcodename,\nbefore     => Package[$::riak::package_name],\nrequire    => Package['apt-transport-https'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: basho-labs@puppet-riak-manifests-repository-debian.pp\n# Target line: 10\n\n      5: class riak::repository::debian {\n      6:   ensure_packages('apt-transport-https') # packagecloud is https-only\n      7:   include ::apt\n      8:   apt::source { 'riak':\n      9:     location   => 'https://packagecloud.io/basho/riak/debian/',\n>>>  10:     key        => '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB',\n     11:     pin        => '550',\n     12:     repos      => 'main',\n     13:     release    => $::lsbdistcodename,\n     14:     before     => Package[$::riak::package_name],\n     15:     require    => Package['apt-transport-https'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-apt-manifests-debian-testing.pp", "content": "key               => '55BE302B',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-debian-testing.pp\n\napt::source { 'debian_testing':\nlocation          => 'http://debian.mirror.iweb.ca/debian/',\nrelease           => 'testing',\nrepos             => 'main contrib non-free',\nrequired_packages => 'debian-keyring debian-archive-keyring',\n17:     key               => '55BE302B',\nkey_server        => 'subkeys.pgp.net',\npin               => '-10',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-debian-testing.pp\n# Target line: 17\n\n     12:   apt::source { 'debian_testing':\n     13:     location          => 'http://debian.mirror.iweb.ca/debian/',\n     14:     release           => 'testing',\n     15:     repos             => 'main contrib non-free',\n     16:     required_packages => 'debian-keyring debian-archive-keyring',\n>>>  17:     key               => '55BE302B',\n     18:     key_server        => 'subkeys.pgp.net',\n     19:     pin               => '-10',\n     20:   }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"", "line": 62, "detection_span": [57, 67], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n$ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n$ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n}\n'wget': {\n$http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n62:       $http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n$http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"\n$ftp_get         = $http_get\n$ftp_get_passwd  = $http_get_passwd\n}\n'powershell':{", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 62\n\n     57:       $ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n     58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n     59:     }\n     60:     'wget': {\n     61:       $http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n>>>  62:       $http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n     63:       $http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"\n     64:       $ftp_get         = $http_get\n     65:       $ftp_get_passwd  = $http_get_passwd\n     66:     }\n     67:     'powershell':{\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp", "content": "$amqp_pass  = 'email_alert_service_test',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n\n#   Must be vhost-unique.\n#   (default: 'email_alert_service_published_documents_test_queue')\n#\nclass govuk::apps::email_alert_service::rabbitmq_test_permissions (\n$amqp_user  = 'email_alert_service_test',\n29:   $amqp_pass  = 'email_alert_service_test',\n$amqp_exchange = 'email_alert_service_published_documents_test_exchange',\n$amqp_major_change_queue = 'email_alert_service_published_documents_test_queue',\n$amqp_unpublishing_queue = 'email_alert_service_unpublishing_documents_test_queue',\n$amqp_workflow_queue = 'email_alert_service_workflow_test_queue',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n# Target line: 29\n\n     24: #   Must be vhost-unique.\n     25: #   (default: 'email_alert_service_published_documents_test_queue')\n     26: #\n     27: class govuk::apps::email_alert_service::rabbitmq_test_permissions (\n     28:   $amqp_user  = 'email_alert_service_test',\n>>>  29:   $amqp_pass  = 'email_alert_service_test',\n     30:   $amqp_exchange = 'email_alert_service_published_documents_test_exchange',\n     31:   $amqp_major_change_queue = 'email_alert_service_published_documents_test_queue',\n     32:   $amqp_unpublishing_queue = 'email_alert_service_unpublishing_documents_test_queue',\n     33:   $amqp_workflow_queue = 'email_alert_service_workflow_test_queue',\n     34: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp", "content": "admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n\nclass { '::keystone::logging':\ndebug => hiera('CONFIG_DEBUG_MODE'),\n}\n\nclass { '::keystone':\n35:       admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\nadmin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\ndatabase_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\ntoken_provider      => \"${keystone_token_provider_str}\",\nenable_fernet_setup => true,\nservice_name        => 'httpd',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n# Target line: 35\n\n     30:     class { '::keystone::logging':\n     31:       debug => hiera('CONFIG_DEBUG_MODE'),\n     32:     }\n     33: \n     34:     class { '::keystone':\n>>>  35:       admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\n     36:       admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\n     37:       database_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\n     38:       token_provider      => \"${keystone_token_provider_str}\",\n     39:       enable_fernet_setup => true,\n     40:       service_name        => 'httpd',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_mysql_master.pp", "content": "$root_password = hiera('mysql_root', '')", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_mysql_master.pp\n\n$aws_secret_access_key = undef,\n$s3_bucket_name = undef,\n$encryption_key = undef,\n) inherits govuk::node::s_base {\n$replica_password = hiera('mysql_replica_password', '')\n26:   $root_password = hiera('mysql_root', '')\n\nclass { 'govuk_mysql::server':\nroot_password => $root_password,\n}\nclass { 'govuk_mysql::server::master':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_mysql_master.pp\n# Target line: 26\n\n     21:   $aws_secret_access_key = undef,\n     22:   $s3_bucket_name = undef,\n     23:   $encryption_key = undef,\n     24: ) inherits govuk::node::s_base {\n     25:   $replica_password = hiera('mysql_replica_password', '')\n>>>  26:   $root_password = hiera('mysql_root', '')\n     27: \n     28:   class { 'govuk_mysql::server':\n     29:     root_password => $root_password,\n     30:   }\n     31:   class { 'govuk_mysql::server::master':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-application_settings-manifests-iterm2.pp", "content": "key    => 'PromptOnQuit',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: nrako@my-boxen-modules-application_settings-manifests-iterm2.pp\n\nclass application_settings::iterm2 {\nboxen::osx_defaults { 'Turn off prompt on quit':\nuser   => $::luser,\ndomain => 'com.googlecode.iterm2',\n5:     key    => 'PromptOnQuit',\ntype   => 'bool',\nvalue  => false,\n}\n\nboxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-application_settings-manifests-iterm2.pp\n# Target line: 5\n\n      1: class application_settings::iterm2 {\n      2:   boxen::osx_defaults { 'Turn off prompt on quit':\n      3:     user   => $::luser,\n      4:     domain => 'com.googlecode.iterm2',\n>>>   5:     key    => 'PromptOnQuit',\n      6:     type   => 'bool',\n      7:     value  => false,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-quota.pp", "content": "$max_instances_per_user   = undef,", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: openstack@puppet-trove-manifests-quota.pp\n\n$max_accepted_volume_size = 5,\n$max_volumes_per_tenant   = 20,\n$max_backups_per_tenant   = 50,\n$quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n# Deprecated\n50:   $max_instances_per_user   = undef,\n$max_volumes_per_user     = undef,\n$max_backups_per_user     = undef,\n) {\n\ninclude ::trove::deps", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-quota.pp\n# Target line: 50\n\n     45:   $max_accepted_volume_size = 5,\n     46:   $max_volumes_per_tenant   = 20,\n     47:   $max_backups_per_tenant   = 50,\n     48:   $quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n     49:   # Deprecated\n>>>  50:   $max_instances_per_user   = undef,\n     51:   $max_volumes_per_user     = undef,\n     52:   $max_backups_per_user     = undef,\n     53: ) {\n     54: \n     55:   include ::trove::deps\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_idopgsql.pp", "content": "password      => \"supersecret\",", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_idopgsql.pp\n\nmanage_repo => true,\n}\n\nclass{ 'icinga2::feature::idopgsql':\nuser          => \"icinga2\",\n14:   password      => \"supersecret\",\ndatabase      => \"icinga2\",\nimport_schema => true,\nrequire       => Postgresql::Server::Db['icinga2'],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_idopgsql.pp\n# Target line: 14\n\n      9:   manage_repo => true,\n     10: }\n     11: \n     12: class{ 'icinga2::feature::idopgsql':\n     13:   user          => \"icinga2\",\n>>>  14:   password      => \"supersecret\",\n     15:   database      => \"icinga2\",\n     16:   import_schema => true,\n     17:   require       => Postgresql::Server::Db['icinga2'],\n     18: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp", "content": "key_source => 'http://172.18.66.213/gpg.pub',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n\nstage => 'openstack-ci-repo'\n}->\nclass { '::openstack::repo::apt':\nkey        => '420851BC',\nlocation   => 'http://172.18.66.213/deb',\n24:       key_source => 'http://172.18.66.213/gpg.pub',\norigin     => '172.18.66.213',\nstage      => 'openstack-ci-repo'\n}\n}\n'RedHat': {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n# Target line: 24\n\n     19:       stage => 'openstack-ci-repo'\n     20:     }->\n     21:     class { '::openstack::repo::apt':\n     22:       key        => '420851BC',\n     23:       location   => 'http://172.18.66.213/deb',\n>>>  24:       key_source => 'http://172.18.66.213/gpg.pub',\n     25:       origin     => '172.18.66.213',\n     26:       stage      => 'openstack-ci-repo'\n     27:     }\n     28:   }\n     29:   'RedHat': {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-octavia.pp", "content": "$oslomsg_rpc_password = hiera('oslo_messaging_rpc_password'),", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-octavia.pp\n\n\nclass tripleo::profile::base::octavia (\n$step                 = Integer(hiera('step')),\n$oslomsg_rpc_proto    = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n$oslomsg_rpc_hosts    = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n53:   $oslomsg_rpc_password = hiera('oslo_messaging_rpc_password'),\n$oslomsg_rpc_port     = hiera('oslo_messaging_rpc_port', '5672'),\n$oslomsg_rpc_username = hiera('oslo_messaging_rpc_user_name', 'guest'),\n$oslomsg_rpc_use_ssl  = hiera('oslo_messaging_rpc_use_ssl', '0'),\n) {\nif $step >= 3 {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-octavia.pp\n# Target line: 53\n\n     48: \n     49: class tripleo::profile::base::octavia (\n     50:   $step                 = Integer(hiera('step')),\n     51:   $oslomsg_rpc_proto    = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n     52:   $oslomsg_rpc_hosts    = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n>>>  53:   $oslomsg_rpc_password = hiera('oslo_messaging_rpc_password'),\n     54:   $oslomsg_rpc_port     = hiera('oslo_messaging_rpc_port', '5672'),\n     55:   $oslomsg_rpc_username = hiera('oslo_messaging_rpc_user_name', 'guest'),\n     56:   $oslomsg_rpc_use_ssl  = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     57: ) {\n     58:   if $step >= 3 {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-manifests-params.pp", "content": "$program_xfsadmin = '/usr/sbin/xfs_admin',", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n\n$program_vgs = '/sbin/vgs',\n$program_lvs = '/sbin/lvs',\n$program_pvdisplay = '/sbin/pvdisplay',\n$program_vgdisplay = '/sbin/vgdisplay',\n#$program_lvdisplay = '/sbin/lvdisplay',\n48: \t$program_xfsadmin = '/usr/sbin/xfs_admin',\n$program_mkfs_xfs = '/sbin/mkfs.xfs',\n$program_mkfs_ext4 = '/sbin/mkfs.ext4',\n$program_mkfs_btrfs = '/sbin/mkfs.btrfs',\n\n$program_fping = '/usr/sbin/fping',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n# Target line: 48\n\n     43: \t$program_vgs = '/sbin/vgs',\n     44: \t$program_lvs = '/sbin/lvs',\n     45: \t$program_pvdisplay = '/sbin/pvdisplay',\n     46: \t$program_vgdisplay = '/sbin/vgdisplay',\n     47: \t#$program_lvdisplay = '/sbin/lvdisplay',\n>>>  48: \t$program_xfsadmin = '/usr/sbin/xfs_admin',\n     49: \t$program_mkfs_xfs = '/sbin/mkfs.xfs',\n     50: \t$program_mkfs_ext4 = '/sbin/mkfs.ext4',\n     51: \t$program_mkfs_btrfs = '/sbin/mkfs.btrfs',\n     52: \n     53: \t$program_fping = '/usr/sbin/fping',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp", "content": "docroot    => '/var/www/second',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n\n}\n\n# vhost with proxy_pass and parameters\napache::vhost { 'second.example.com':\nport       => 80,\n25:   docroot    => '/var/www/second',\nproxy_pass => [\n{\n'path'   => '/second',\n'url'    => 'http://localhost:8080/second',\n'params' => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n# Target line: 25\n\n     20: }\n     21: \n     22: # vhost with proxy_pass and parameters\n     23: apache::vhost { 'second.example.com':\n     24:   port       => 80,\n>>>  25:   docroot    => '/var/www/second',\n     26:   proxy_pass => [\n     27:     {\n     28:       'path'   => '/second',\n     29:       'url'    => 'http://localhost:8080/second',\n     30:       'params' => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bfraser@puppet-grafana-manifests-install.pp", "content": "user            => 'grafana',", "line": 143, "detection_span": [138, 148], "with_context": "# Puppet file: bfraser@puppet-grafana-manifests-install.pp\n\nensure          => present,\nextract         => true,\nextract_command => 'tar xfz %s --strip-components=1',\nextract_path    => $::grafana::install_dir,\nsource          => $real_archive_source,\n143:         user            => 'grafana',\ngroup           => 'grafana',\ncleanup         => true,\nrequire         => File[$::grafana::install_dir]\n}\n148:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bfraser@puppet-grafana-manifests-install.pp\n# Target line: 143\n\n    138:         ensure          => present,\n    139:         extract         => true,\n    140:         extract_command => 'tar xfz %s --strip-components=1',\n    141:         extract_path    => $::grafana::install_dir,\n    142:         source          => $real_archive_source,\n>>> 143:         user            => 'grafana',\n    144:         group           => 'grafana',\n    145:         cleanup         => true,\n    146:         require         => File[$::grafana::install_dir]\n    147:       }\n    148: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-config-unicorn.pp", "content": "$relative_url_root = false", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-config-unicorn.pp\n\n$owner,\n$path,\n$unicorn_listen,\n$unicorn_port,\n$unicorn_worker,\n39:   $relative_url_root = false\n){\n\nfile { $path:\nensure  => file,\ncontent => template('gitlab/unicorn.rb.erb'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-config-unicorn.pp\n# Target line: 39\n\n     34:   $owner,\n     35:   $path,\n     36:   $unicorn_listen,\n     37:   $unicorn_port,\n     38:   $unicorn_worker,\n>>>  39:   $relative_url_root = false\n     40: ){\n     41: \n     42:   file { $path:\n     43:     ensure  => file,\n     44:     content => template('gitlab/unicorn.rb.erb'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "vamsee@puppet-solr-manifests-params.pp", "content": "$jetty_user     = 'jetty'", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: vamsee@puppet-solr-manifests-params.pp\n\n$mirror_site    = 'http://www.us.apache.org/dist/lucene/solr'\n$data_dir       = '/var/lib/solr'\n$cores          = ['default']\n$dist_root      = '/tmp'\n\n19:   $jetty_user     = 'jetty'\n$jetty_group    = 'jetty'\n\ncase $::operatingsystem {\n'Debian': {\ncase $::operatingsystemmajrelease {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: vamsee@puppet-solr-manifests-params.pp\n# Target line: 19\n\n     14:   $mirror_site    = 'http://www.us.apache.org/dist/lucene/solr'\n     15:   $data_dir       = '/var/lib/solr'\n     16:   $cores          = ['default']\n     17:   $dist_root      = '/tmp'\n     18: \n>>>  19:   $jetty_user     = 'jetty'\n     20:   $jetty_group    = 'jetty'\n     21: \n     22:   case $::operatingsystem {\n     23:     'Debian': {\n     24:       case $::operatingsystemmajrelease {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-examples-mysql_plugin.pp", "content": "root_password => 'password'", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-mysql_plugin.pp\n\nclass { 'mysql::server':\n2:   root_password => 'password'\n}\n\n$validate_password_soname = $::osfamily ? {\nwindows => 'validate_password.dll',\ndefault => 'validate_password.so'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-mysql_plugin.pp\n# Target line: 2\n\n      1: class { 'mysql::server':\n>>>   2:   root_password => 'password'\n      3: }\n      4: \n      5: $validate_password_soname = $::osfamily ? {\n      6:   windows => 'validate_password.dll',\n      7:   default => 'validate_password.so'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp", "content": "$publishing_api_bearer_token = undef,", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n\n$mongodb_name = undef,\n$mongodb_nodes = undef,\n$oauth_id = undef,\n$oauth_secret = undef,\n$port = '3035',\n77:   $publishing_api_bearer_token = undef,\n$redis_host = undef,\n$redis_port = undef,\n$secret_key_base = undef,\n$show_historical_edition_link = false,\n$email_alert_api_bearer_token = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n# Target line: 77\n\n     72:   $mongodb_name = undef,\n     73:   $mongodb_nodes = undef,\n     74:   $oauth_id = undef,\n     75:   $oauth_secret = undef,\n     76:   $port = '3035',\n>>>  77:   $publishing_api_bearer_token = undef,\n     78:   $redis_host = undef,\n     79:   $redis_port = undef,\n     80:   $secret_key_base = undef,\n     81:   $show_historical_edition_link = false,\n     82:   $email_alert_api_bearer_token = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write.pp", "content": "$stagecraft_collection_endpoint_token = undef,", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write.pp\n\n#\nclass govuk::apps::backdrop_write (\n$enabled = true,\n$enable_procfile_worker = true,\n$signon_api_user_token = undef,\n32:   $stagecraft_collection_endpoint_token = undef,\n$transformer_rabbitmq_password = undef,\n$transformer_stagecraft_oauth_token = undef,\n) {\nif $enabled {\n$app_name = 'backdrop-write'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write.pp\n# Target line: 32\n\n     27: #\n     28: class govuk::apps::backdrop_write (\n     29:   $enabled = true,\n     30:   $enable_procfile_worker = true,\n     31:   $signon_api_user_token = undef,\n>>>  32:   $stagecraft_collection_endpoint_token = undef,\n     33:   $transformer_rabbitmq_password = undef,\n     34:   $transformer_stagecraft_oauth_token = undef,\n     35: ) {\n     36:   if $enabled {\n     37:     $app_name = 'backdrop-write'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp", "content": "$middleware_password       = 'mcollective',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n\nclass mco_profile::params (\n$main_collective           = 'mcollective',\n$collectives               = undef,\n$middleware_hosts          = undef,\n$middleware_user           = 'mcollective',\n9:   $middleware_password       = 'mcollective',\n$middleware_ssl_port       = '61613',\n$ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n$ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n$ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",\n$ssl_ca_cert               = \"${::settings::ssldir}/certs/ca.pem\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n# Target line: 9\n\n      4: class mco_profile::params (\n      5:   $main_collective           = 'mcollective',\n      6:   $collectives               = undef,\n      7:   $middleware_hosts          = undef,\n      8:   $middleware_user           = 'mcollective',\n>>>   9:   $middleware_password       = 'mcollective',\n     10:   $middleware_ssl_port       = '61613',\n     11:   $ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n     12:   $ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n     13:   $ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",\n     14:   $ssl_ca_cert               = \"${::settings::ssldir}/certs/ca.pem\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_development.pp", "content": "password => 'search_admin';", "line": 113, "detection_span": [108, 118], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_development.pp\n\nuser     => 'release',\npassword => 'release';\n110:\n['search_admin_development', 'search_admin_test']:\nuser     => 'search_admin',\n113:       password => 'search_admin';\n114:\n[\n'signonotron2_development',\n'signonotron2_test',\n'signonotron2_integration_test',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_development.pp\n# Target line: 113\n\n    108:       user     => 'release',\n    109:       password => 'release';\n    110: \n    111:     ['search_admin_development', 'search_admin_test']:\n    112:       user     => 'search_admin',\n>>> 113:       password => 'search_admin';\n    114: \n    115:     [\n    116:       'signonotron2_development',\n    117:       'signonotron2_test',\n    118:       'signonotron2_integration_test',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-sahara-rabbitmq.pp", "content": "$rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-sahara-rabbitmq.pp\n\n$kombu_ssl_keyfile = hiera('CONFIG_SAHARA_SSL_KEY', $::os_service_default)\n$kombu_ssl_certfile = hiera('CONFIG_SAHARA_SSL_CERT', $::os_service_default)\n\n$rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n$rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n12:     $rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n$rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n\nif ! is_service_default($kombu_ssl_keyfile) {\n$files_to_set_owner = [ $kombu_ssl_keyfile, $kombu_ssl_certfile ]\nfile { $files_to_set_owner:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-sahara-rabbitmq.pp\n# Target line: 12\n\n      7:     $kombu_ssl_keyfile = hiera('CONFIG_SAHARA_SSL_KEY', $::os_service_default)\n      8:     $kombu_ssl_certfile = hiera('CONFIG_SAHARA_SSL_CERT', $::os_service_default)\n      9: \n     10:     $rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n     11:     $rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n>>>  12:     $rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n     13:     $rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n     14: \n     15:     if ! is_service_default($kombu_ssl_keyfile) {\n     16:       $files_to_set_owner = [ $kombu_ssl_keyfile, $kombu_ssl_certfile ]\n     17:       file { $files_to_set_owner:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-drivers-inspector.pp", "content": "'inspector/password':            value => $password, secret => true;", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-drivers-inspector.pp\n\n\nironic_config {\n'inspector/service_url':         value => $service_url;\n'inspector/auth_type':           value => $auth_type;\n'inspector/username':            value => $username;\n86:     'inspector/password':            value => $password, secret => true;\n'inspector/auth_url':            value => $auth_url;\n'inspector/project_name':        value => $project_name;\n'inspector/user_domain_name':    value => $user_domain_name;\n'inspector/project_domain_name': value => $project_domain_name;\n'inspector/endpoint_override':   value => $endpoint_override;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-drivers-inspector.pp\n# Target line: 86\n\n     81: \n     82:   ironic_config {\n     83:     'inspector/service_url':         value => $service_url;\n     84:     'inspector/auth_type':           value => $auth_type;\n     85:     'inspector/username':            value => $username;\n>>>  86:     'inspector/password':            value => $password, secret => true;\n     87:     'inspector/auth_url':            value => $auth_url;\n     88:     'inspector/project_name':        value => $project_name;\n     89:     'inspector/user_domain_name':    value => $user_domain_name;\n     90:     'inspector/project_domain_name': value => $project_domain_name;\n     91:     'inspector/endpoint_override':   value => $endpoint_override;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-murano.pp", "content": "rabbit_own_password   => 'an_even_bigger_secret',", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-murano.pp\n\n'username'  => 'murano',\n'password'  => 'an_even_bigger_secret',\n}),\nrabbit_os_use_ssl     => $::openstack_integration::config::ssl,\nrabbit_own_user       => 'murano_private',\n59:     rabbit_own_password   => 'an_even_bigger_secret',\nrabbit_own_vhost      => '/murano',\nrabbit_own_host       => $::openstack_integration::config::host,\nrabbit_own_port       => $::openstack_integration::config::rabbit_port,\nrabbit_own_use_ssl    => $::openstack_integration::config::ssl,\ndatabase_connection   => 'mysql+pymysql://murano:a_big_secret@127.0.0.1/murano?charset=utf8',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-murano.pp\n# Target line: 59\n\n     54:       'username'  => 'murano',\n     55:       'password'  => 'an_even_bigger_secret',\n     56:     }),\n     57:     rabbit_os_use_ssl     => $::openstack_integration::config::ssl,\n     58:     rabbit_own_user       => 'murano_private',\n>>>  59:     rabbit_own_password   => 'an_even_bigger_secret',\n     60:     rabbit_own_vhost      => '/murano',\n     61:     rabbit_own_host       => $::openstack_integration::config::host,\n     62:     rabbit_own_port       => $::openstack_integration::config::rabbit_port,\n     63:     rabbit_own_use_ssl    => $::openstack_integration::config::ssl,\n     64:     database_connection   => 'mysql+pymysql://murano:a_big_secret@127.0.0.1/murano?charset=utf8',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp", "content": "# make sure all PHP files are available from the host machine so they can be debugged", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n\nensure => 'link',\ntarget => $docroot,\n}\n}\n\n95:     # make sure all PHP files are available from the host machine so they can be debugged\nfile { '/vagrant/srv/docroot':\nensure             => present,\nsource             => $docroot,\nsource_permissions => ignore,\nrecurse            => remote,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n# Target line: 95\n\n     90:             ensure => 'link',\n     91:             target => $docroot,\n     92:         }\n     93:     }\n     94: \n>>>  95:     # make sure all PHP files are available from the host machine so they can be debugged\n     96:     file { '/vagrant/srv/docroot':\n     97:         ensure             => present,\n     98:         source             => $docroot,\n     99:         source_permissions => ignore,\n    100:         recurse            => remote,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-common_config.pp", "content": "# TODO(aschultz): LP#1499620 - neutron in UCA liberty fails to start with", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-common_config.pp\n\n$rabbit_hash      = hiera_hash('rabbit', {})\n$ceilometer_hash  = hiera_hash('ceilometer', {})\n$network_scheme   = hiera_hash('network_scheme', {})\n\n$debug        = pick($openstack_network_hash['debug'], hiera('debug', true))\n30:   # TODO(aschultz): LP#1499620 - neutron in UCA liberty fails to start with\n# syslog enabled.\n$use_syslog = $::os_package_type ? {\n'ubuntu' => false,\ndefault  => hiera('use_syslog', true)\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-common_config.pp\n# Target line: 30\n\n     25:   $rabbit_hash      = hiera_hash('rabbit', {})\n     26:   $ceilometer_hash  = hiera_hash('ceilometer', {})\n     27:   $network_scheme   = hiera_hash('network_scheme', {})\n     28: \n     29:   $debug        = pick($openstack_network_hash['debug'], hiera('debug', true))\n>>>  30:   # TODO(aschultz): LP#1499620 - neutron in UCA liberty fails to start with\n     31:   # syslog enabled.\n     32:   $use_syslog = $::os_package_type ? {\n     33:     'ubuntu' => false,\n     34:     default  => hiera('use_syslog', true)\n     35:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-nailgun-server.pp", "content": "# FIXME(kozhukalov): fuel-nailgun package should provide nailgun group", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-nailgun-server.pp\n\n'oswl_volume_collectord',\n'receiverd',\n'statsenderd',\n]\n\n68:   # FIXME(kozhukalov): fuel-nailgun package should provide nailgun group\ngroup { 'nailgun' :\nprovider => \"groupadd\",\nensure   => \"present\",\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-nailgun-server.pp\n# Target line: 68\n\n     63:     'oswl_volume_collectord',\n     64:     'receiverd',\n     65:     'statsenderd',\n     66:   ]\n     67: \n>>>  68:   # FIXME(kozhukalov): fuel-nailgun package should provide nailgun group\n     69:   group { 'nailgun' :\n     70:     provider => \"groupadd\",\n     71:     ensure   => \"present\",\n     72:   }\n     73: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "voxpupuli@puppet-gluster-manifests-peer.pp", "content": "#       peering attempt only resolves a cosmetic issue, not a functional one.", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: voxpupuli@puppet-gluster-manifests-peer.pp\n\n# Note: http://www.gluster.org/pipermail/gluster-users/2013-December/038354.html\n#       When server-a probes server-b, server-b will only record the IP address\n#       for server-a.  When server-b next runs Puppet, it will probe server-a\n#       because server-a's fqdn is not in the list of peers. The peering will\n#       have been successfully established the first time, so this second\n42: #       peering attempt only resolves a cosmetic issue, not a functional one.\n#\ndefine gluster::peer (\n$pool = 'default',\n$fqdn = $::fqdn,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-gluster-manifests-peer.pp\n# Target line: 42\n\n     37: # Note: http://www.gluster.org/pipermail/gluster-users/2013-December/038354.html\n     38: #       When server-a probes server-b, server-b will only record the IP address\n     39: #       for server-a.  When server-b next runs Puppet, it will probe server-a\n     40: #       because server-a's fqdn is not in the list of peers. The peering will\n     41: #       have been successfully established the first time, so this second\n>>>  42: #       peering attempt only resolves a cosmetic issue, not a functional one.\n     43: #\n     44: define gluster::peer (\n     45:   $pool = 'default',\n     46:   $fqdn = $::fqdn,\n     47: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-rds_sql.pp", "content": "# This defined type attempts to solve this issue.", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-rds_sql.pp\n\n#\n# In Amazon RDS, an admin role is created to manage databases and roles. To create\n# a database owned by a specified role, the admin role must have membership of the\n# role you're trying to assign.\n#\n7: # This defined type attempts to solve this issue.\n#\n# === Parameters\n#\n# [*title*]\n#   The title of the defined type is the role that must be assigned to the admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-rds_sql.pp\n# Target line: 7\n\n      2: #\n      3: # In Amazon RDS, an admin role is created to manage databases and roles. To create\n      4: # a database owned by a specified role, the admin role must have membership of the\n      5: # role you're trying to assign.\n      6: #\n>>>   7: # This defined type attempts to solve this issue.\n      8: #\n      9: # === Parameters\n     10: #\n     11: # [*title*]\n     12: #   The title of the defined type is the role that must be assigned to the admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Icinga@puppet-icinga2-manifests-object-scheduleddowntime.pp", "content": "#   Set scheduleddowntime_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-object-scheduleddowntime.pp\n\n# [*apply*]\n#   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n#   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n#\n# [*prefix*]\n39: #   Set scheduleddowntime_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n#\n# [*apply_target*]\n#   An object type on which to target the apply rule. Valid values are `Host` and `Service`. Defaults to `Host`.\n#\n# [*assign*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-object-scheduleddowntime.pp\n# Target line: 39\n\n     34: # [*apply*]\n     35: #   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n     36: #   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n     37: #\n     38: # [*prefix*]\n>>>  39: #   Set scheduleddowntime_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n     40: #\n     41: # [*apply_target*]\n     42: #   An object type on which to target the apply rule. Valid values are `Host` and `Service`. Defaults to `Host`.\n     43: #\n     44: # [*assign*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp", "content": "# FIXME: we should not nuke the system with 'service network restart'...", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n\ncfg { $gateway:\nfile  => '/etc/sysconfig/network',\nkey   => 'GATEWAY',\nvalue => $gateway,\n} ->\n29:           # FIXME: we should not nuke the system with 'service network restart'...\n# FIXME: but we should ensure default route will be created somehow\nexec { $exec_name :\npath    => '/bin:/usr/bin:/sbin:/usr/sbin',\ncommand => \"ip route replace default via ${gateway} || true\",\nunless  => \"netstat -r | grep -q 'default.*${gateway}'\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n# Target line: 29\n\n     24:           cfg { $gateway:\n     25:               file  => '/etc/sysconfig/network',\n     26:               key   => 'GATEWAY',\n     27:               value => $gateway,\n     28:           } ->\n>>>  29:           # FIXME: we should not nuke the system with 'service network restart'...\n     30:           # FIXME: but we should ensure default route will be created somehow\n     31:           exec { $exec_name :\n     32:               path    => '/bin:/usr/bin:/sbin:/usr/sbin',\n     33:               command => \"ip route replace default via ${gateway} || true\",\n     34:               unless  => \"netstat -r | grep -q 'default.*${gateway}'\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-nvmeof.pp", "content": "# [*target_prefix*]", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-nvmeof.pp\n\n#   (Required) Target user-land tool to use\n#\n# [*target_protocol*]\n#   (Required) Target rotocol to use\n#\n20: # [*target_prefix*]\n#   (Optional) Prefix for LVM volumes\n#   Defaults to 'nvme-subsystem'\n#\n# [*nvmet_port_id*]\n#   (Optional) Port id of the NVMe target", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-nvmeof.pp\n# Target line: 20\n\n     15: #   (Required) Target user-land tool to use\n     16: #\n     17: # [*target_protocol*]\n     18: #   (Required) Target rotocol to use\n     19: #\n>>>  20: # [*target_prefix*]\n     21: #   (Optional) Prefix for LVM volumes\n     22: #   Defaults to 'nvme-subsystem'\n     23: #\n     24: # [*nvmet_port_id*]\n     25: #   (Optional) Port id of the NVMe target\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp", "content": "# FIXME: We don't manage the version of Puppet in the Vagrant box and", "line": 118, "detection_span": [113, 123], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n\nrun_user        => 'syslog',\nrun_group       => 'syslog',\npurge_rsyslog_d => true,\n}\n117:\n118:     # FIXME: We don't manage the version of Puppet in the Vagrant box and\n# 3.0.2 doesn't lookup the correct boolean for `log_remote` from hiera.\nclass { 'rsyslog::client':\nlog_local  => true,\nlog_remote => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n# Target line: 118\n\n    113:       run_user        => 'syslog',\n    114:       run_group       => 'syslog',\n    115:       purge_rsyslog_d => true,\n    116:     }\n    117: \n>>> 118:     # FIXME: We don't manage the version of Puppet in the Vagrant box and\n    119:     # 3.0.2 doesn't lookup the correct boolean for `log_remote` from hiera.\n    120:     class { 'rsyslog::client':\n    121:       log_local  => true,\n    122:       log_remote => false,\n    123:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod.pp", "content": "} elsif has_key($mod_libs, $mod) { # 2.6 compatibility hack", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod.pp\n\n\n# Determine if we have special lib\n$mod_libs = $::apache::mod_libs\nif $lib {\n$_lib = $lib\n23:   } elsif has_key($mod_libs, $mod) { # 2.6 compatibility hack\n$_lib = $mod_libs[$mod]\n} else {\n$_lib = \"mod_${mod}.so\"\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod.pp\n# Target line: 23\n\n     18: \n     19:   # Determine if we have special lib\n     20:   $mod_libs = $::apache::mod_libs\n     21:   if $lib {\n     22:     $_lib = $lib\n>>>  23:   } elsif has_key($mod_libs, $mod) { # 2.6 compatibility hack\n     24:     $_lib = $mod_libs[$mod]\n     25:   } else {\n     26:     $_lib = \"mod_${mod}.so\"\n     27:   }\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mathoid-manifests-init.pp", "content": "#   Whether to provide extended information on the tex input and potential problems with it.", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mathoid-manifests-init.pp\n\n#\n# [*png*]\n#   Whether to generate PNGs. Default: true\n#\n# [*texvcinfo*]\n20: #   Whether to provide extended information on the tex input and potential problems with it.\n#   Default: true\n#\n# [*speak_text*]\n#   Whether to generate speakText representation. Default: true\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mathoid-manifests-init.pp\n# Target line: 20\n\n     15: #\n     16: # [*png*]\n     17: #   Whether to generate PNGs. Default: true\n     18: #\n     19: # [*texvcinfo*]\n>>>  20: #   Whether to provide extended information on the tex input and potential problems with it.\n     21: #   Default: true\n     22: #\n     23: # [*speak_text*]\n     24: #   Whether to generate speakText representation. Default: true\n     25: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-nginx-manifests-config.pp", "content": "#   from DNS if an upstream lookup fails. This is the prefix address defined for a VPC.", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config.pp\n\n# [*denied_ip_addresses*]\n#   An array of IP addresses that Nginx should prevent from accessing this machine.\n#\n# [*stack_network_prefix*]\n#   This is only used in AWS. This adds a resolver so that nginx refreshes resolved addresses\n18: #   from DNS if an upstream lookup fails. This is the prefix address defined for a VPC.\n#\nclass nginx::config (\n$server_names_hash_max_size,\n$variables_hash_max_size = 1024,\n$denied_ip_addresses,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config.pp\n# Target line: 18\n\n     13: # [*denied_ip_addresses*]\n     14: #   An array of IP addresses that Nginx should prevent from accessing this machine.\n     15: #\n     16: # [*stack_network_prefix*]\n     17: #   This is only used in AWS. This adds a resolver so that nginx refreshes resolved addresses\n>>>  18: #   from DNS if an upstream lookup fails. This is the prefix address defined for a VPC.\n     19: #\n     20: class nginx::config (\n     21:   $server_names_hash_max_size,\n     22:   $variables_hash_max_size = 1024,\n     23:   $denied_ip_addresses,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-libvirt.pp", "content": "# We have to fix the permissions after the installation has been done", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-libvirt.pp\n\nowner  => 'root',\ngroup  => 'kvm',\nmode   => '666',\n}\n\n23:         # We have to fix the permissions after the installation has been done\n# and before the service is started.\nPackage <| title == 'libvirt' |> ->\nFile['/dev/kvm'] ->\nService <| title == 'libvirt' |>\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-libvirt.pp\n# Target line: 23\n\n     18:           owner  => 'root',\n     19:           group  => 'kvm',\n     20:           mode   => '666',\n     21:         }\n     22: \n>>>  23:         # We have to fix the permissions after the installation has been done\n     24:         # and before the service is started.\n     25:         Package <| title == 'libvirt' |> ->\n     26:         File['/dev/kvm'] ->\n     27:         Service <| title == 'libvirt' |>\n     28:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-settings.pp", "content": "#     values => template('db_debug/settings.php.erb'),", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-settings.pp\n\n# Finally, 'settings' can also be specified as a string value. This can be\n# especially powerful when used in combination with Puppet's template()\n# function, as the following example illustrates:\n#\n#   mediawiki::settings { 'database debug':\n68: #     values => template('db_debug/settings.php.erb'),\n#   }\n#\n# If you have configured multiple wikis, settings can be applied to a particular\n# wiki by either providing a value for the 'wiki' parameter:\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-settings.pp\n# Target line: 68\n\n     63: # Finally, 'settings' can also be specified as a string value. This can be\n     64: # especially powerful when used in combination with Puppet's template()\n     65: # function, as the following example illustrates:\n     66: #\n     67: #   mediawiki::settings { 'database debug':\n>>>  68: #     values => template('db_debug/settings.php.erb'),\n     69: #   }\n     70: #\n     71: # If you have configured multiple wikis, settings can be applied to a particular\n     72: # wiki by either providing a value for the 'wiki' parameter:\n     73: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-php.pp", "content": "} elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-php.pp\n\n$mod_packages = $::apache::params::mod_packages\nif $package_name {\n$_package_name = $package_name\n} elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n$_package_name = $mod_packages[$mod]\n46:   } elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n$_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n} else {\n$_package_name = undef\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-php.pp\n# Target line: 46\n\n     41:   $mod_packages = $::apache::params::mod_packages\n     42:   if $package_name {\n     43:     $_package_name = $package_name\n     44:   } elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n     45:     $_package_name = $mod_packages[$mod]\n>>>  46:   } elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n     47:     $_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n     48:   } else {\n     49:     $_package_name = undef\n     50:   }\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp", "content": "# TO-DO(mmagr): Add IPv6 support when hostnames are used", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n\ncreate_resources(packstack::firewall, hiera('FIREWALL_NOVA_API_RULES', {}))\n\n$bind_host = hiera('CONFIG_IP_VERSION') ? {\n'ipv6'  => '::0',\ndefault => '0.0.0.0',\n8:       # TO-DO(mmagr): Add IPv6 support when hostnames are used\n}\n\n$www_authenticate_uri = hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS')\n$admin_password = hiera('CONFIG_NOVA_KS_PW')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n# Target line: 8\n\n      3:     create_resources(packstack::firewall, hiera('FIREWALL_NOVA_API_RULES', {}))\n      4: \n      5:     $bind_host = hiera('CONFIG_IP_VERSION') ? {\n      6:       'ipv6'  => '::0',\n      7:       default => '0.0.0.0',\n>>>   8:       # TO-DO(mmagr): Add IPv6 support when hostnames are used\n      9:     }\n     10: \n     11:     $www_authenticate_uri = hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS')\n     12:     $admin_password = hiera('CONFIG_NOVA_KS_PW')\n     13: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "willdurand@puppet-nodejs-manifests-init.pp", "content": "# TODO remove!", "line": 85, "detection_span": [80, 90], "with_context": "# Puppet file: willdurand@puppet-nodejs-manifests-init.pp\n\nnodejs_default_path => $nodejs_default_path,\ndownload_timeout    => $download_timeout,\ninstall_dir         => $install_dir,\nsource              => $source,\n} ->\n85:     # TODO remove!\nfile { '/etc/profile.d/nodejs.sh':\nensure  => file,\nowner   => 'root',\ngroup   => 'root',\nmode    => '0644',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: willdurand@puppet-nodejs-manifests-init.pp\n# Target line: 85\n\n     80:       nodejs_default_path => $nodejs_default_path,\n     81:       download_timeout    => $download_timeout,\n     82:       install_dir         => $install_dir,\n     83:       source              => $source,\n     84:     } ->\n>>>  85:     # TODO remove!\n     86:     file { '/etc/profile.d/nodejs.sh':\n     87:       ensure  => file,\n     88:       owner   => 'root',\n     89:       group   => 'root',\n     90:       mode    => '0644',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-repos.pp", "content": "# NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors", "line": 112, "detection_span": [107, 117], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n\n107:   if $::osfamily == 'RedHat' {\npackage { 'python2-chardet':\nensure => 'latest',\n}\nYumrepo<||> -> Package<| title == 'python2-chardet' |>\n112:     # NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n# that causes the puppet-openvswitch module to fail parsing the output.\n# This issue does not occur in integration testing but only beaker tests since some\n# other package (probably nova) causes this package to be installed, or the yum upgrade\n# part in integration catches it.\n# Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n# Target line: 112\n\n    107:   if $::osfamily == 'RedHat' {\n    108:     package { 'python2-chardet':\n    109:       ensure => 'latest',\n    110:     }\n    111:     Yumrepo<||> -> Package<| title == 'python2-chardet' |>\n>>> 112:     # NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n    113:     # that causes the puppet-openvswitch module to fail parsing the output.\n    114:     # This issue does not occur in integration testing but only beaker tests since some\n    115:     # other package (probably nova) causes this package to be installed, or the yum upgrade\n    116:     # part in integration catches it.\n    117:     # Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-install.pp", "content": "# Below code is not required when keepalive dependency is fixed.", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-install.pp\n\n$upgrade_needed        = $::contrail::params::upgrade_needed,\n$manage_neutron        = $::contrail::params::manage_neutron\n) {\n# Install a specific version of keepalived in non-ha\n# case also, to support upgrade of contrail software.\n10:   # Below code is not required when keepalive dependency is fixed.\n#\nif ($contrail_internal_vip == \"\" and ($internal_vip == \"\" or !('openstack' in $contrail_host_roles))) {\n\nif ($::operatingsystem == 'Ubuntu') {\ncase $lsbdistrelease {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-install.pp\n# Target line: 10\n\n      5:  $upgrade_needed        = $::contrail::params::upgrade_needed,\n      6:  $manage_neutron        = $::contrail::params::manage_neutron\n      7: ) {\n      8:   # Install a specific version of keepalived in non-ha\n      9:   # case also, to support upgrade of contrail software.\n>>>  10:   # Below code is not required when keepalive dependency is fixed.\n     11:   #\n     12:   if ($contrail_internal_vip == \"\" and ($internal_vip == \"\" or !('openstack' in $contrail_host_roles))) {\n     13: \n     14:       if ($::operatingsystem == 'Ubuntu') {\n     15:           case $lsbdistrelease {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alup@puppet-rbenv-manifests-compile.pp", "content": "# Workaround http://projects.puppetlabs.com/issues/9848", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n\n$keep           = false,\n$configure_opts = '--disable-install-doc',\n$bundler        = present,\n) {\n\n17:   # Workaround http://projects.puppetlabs.com/issues/9848\n$home_path = $home ? { '' => \"/home/${user}\", default => $home }\n$root_path = $root ? { '' => \"${home_path}/.rbenv\", default => $root }\n\n$bin         = \"${root_path}/bin\"\n$shims       = \"${root_path}/shims\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n# Target line: 17\n\n     12:   $keep           = false,\n     13:   $configure_opts = '--disable-install-doc',\n     14:   $bundler        = present,\n     15: ) {\n     16: \n>>>  17:   # Workaround http://projects.puppetlabs.com/issues/9848\n     18:   $home_path = $home ? { '' => \"/home/${user}\", default => $home }\n     19:   $root_path = $root ? { '' => \"${home_path}/.rbenv\", default => $root }\n     20: \n     21:   $bin         = \"${root_path}/bin\"\n     22:   $shims       = \"${root_path}/shims\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-trove-manifests-logging.pp", "content": "#   (Optional) Prefix each line of exception output with this format.", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@puppet-trove-manifests-logging.pp\n\n#   (Optional) Formatted data to append to log format when level is DEBUG.\n#   Defaults to $::os_service_default\n#   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n#\n# [*logging_exception_prefix*]\n59: #   (Optional) Prefix each line of exception output with this format.\n#   Defaults to $::os_service_default\n#   Example: '%(asctime)s.%(msecs)03d %(process)d TRACE %(name)s %(instance)s'\n#\n# [*log_config_append*]\n#   (Optional) The name of an additional logging configuration file.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-logging.pp\n# Target line: 59\n\n     54: #   (Optional) Formatted data to append to log format when level is DEBUG.\n     55: #   Defaults to $::os_service_default\n     56: #   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n     57: #\n     58: # [*logging_exception_prefix*]\n>>>  59: #   (Optional) Prefix each line of exception output with this format.\n     60: #   Defaults to $::os_service_default\n     61: #   Example: '%(asctime)s.%(msecs)03d %(process)d TRACE %(name)s %(instance)s'\n     62: #\n     63: # [*log_config_append*]\n     64: #   (Optional) The name of an additional logging configuration file.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "felho@boxen-modules-people-manifests-felho-applications-bettertouchtool.pp", "content": "source   => 'http://www.boastr.de/BetterTouchTool.zip',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-applications-bettertouchtool.pp\n\nclass people::felho::applications::bettertouchtool {\npackage { 'BetterTouchTool':\nprovider => 'compressed_app',\n4:     source   => 'http://www.boastr.de/BetterTouchTool.zip',\nensure   => present,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-applications-bettertouchtool.pp\n# Target line: 4\n\n      1: class people::felho::applications::bettertouchtool {\n      2:   package { 'BetterTouchTool':\n      3:     provider => 'compressed_app',\n>>>   4:     source   => 'http://www.boastr.de/BetterTouchTool.zip',\n      5:     ensure   => present,\n      6:   }\n      7: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nlocation => 'https://download.docker.com/linux/ubuntu',\nrelease  => 'trusty',\nrepos    => ['stable'],\nkey      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n'elasticsearch-1.4':\n50:       location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\nrelease  => 'stable',\nkey      => 'D88E42B4';\n'elasticsearch-1.5':\nlocation => 'http://packages.elastic.co/elasticsearch/1.5/debian',\nrelease  => 'stable',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 50\n\n     45:       location => 'https://download.docker.com/linux/ubuntu',\n     46:       release  => 'trusty',\n     47:       repos    => ['stable'],\n     48:       key      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n     49:     'elasticsearch-1.4':\n>>>  50:       location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\n     51:       release  => 'stable',\n     52:       key      => 'D88E42B4';\n     53:     'elasticsearch-1.5':\n     54:       location => 'http://packages.elastic.co/elasticsearch/1.5/debian',\n     55:       release  => 'stable',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "quintel@boxen-modules-skype-manifests-init.pp", "content": "source   => 'http://download.skype.com/macosx/Skype_6.7.60.373.dmg',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: quintel@boxen-modules-skype-manifests-init.pp\n\n#\n#   include skype\nclass skype {\npackage { 'Skype':\nprovider => 'appdmg',\n9:     source   => 'http://download.skype.com/macosx/Skype_6.7.60.373.dmg',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-skype-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: #   include skype\n      6: class skype {\n      7:   package { 'Skype':\n      8:     provider => 'appdmg',\n>>>   9:     source   => 'http://download.skype.com/macosx/Skype_6.7.60.373.dmg',\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "use_of_http", "file": "danofthewired@puppet-bitbucket-manifests-facts.pp", "content": "$http = 'http://'", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: danofthewired@puppet-bitbucket-manifests-facts.pp\n\n}\n\nif $is_https {\n$http = 'https://'\n}else{\n33:     $http = 'http://'\n}\n\nfile{'/etc/bitbucket_url.txt':\nensure  => $ensure,\ncontent => \"${http}${uri}:${port}${context_path}/rest/api/1.0/\\", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: danofthewired@puppet-bitbucket-manifests-facts.pp\n# Target line: 33\n\n     28:   }\n     29: \n     30:   if $is_https {\n     31:     $http = 'https://'\n     32:   }else{\n>>>  33:     $http = 'http://'\n     34:   }\n     35: \n     36:   file{'/etc/bitbucket_url.txt':\n     37:     ensure  => $ensure,\n     38:     content => \"${http}${uri}:${port}${context_path}/rest/api/1.0/\\\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp", "content": "baseurl        => 'http://mirrors.dotsrc.org/jpackage/5.0/generic/devel',", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n\npriority       => 10,\n}\n\nyum::managed_yumrepo { 'jpackage-generic-5.0-devel':\ndescr          => 'JPackage (free), generic',\n41:     baseurl        => 'http://mirrors.dotsrc.org/jpackage/5.0/generic/devel',\nfailovermethod => 'priority',\ngpgcheck       => 1,\ngpgkey         => 'http://www.jpackage.org/jpackage.asc',\nenabled        => 0,\npriority       => 10,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n# Target line: 41\n\n     36:     priority       => 10,\n     37:   }\n     38: \n     39:   yum::managed_yumrepo { 'jpackage-generic-5.0-devel':\n     40:     descr          => 'JPackage (free), generic',\n>>>  41:     baseurl        => 'http://mirrors.dotsrc.org/jpackage/5.0/generic/devel',\n     42:     failovermethod => 'priority',\n     43:     gpgcheck       => 1,\n     44:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     45:     enabled        => 0,\n     46:     priority       => 10,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch10.pp", "content": "gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch10.pp\n\nyum::managed_yumrepo { 'elasticsearch-1.0':\ndescr          => 'Elasticsearch repository for 1.0.x packages',\nbaseurl        => 'http://packages.elasticsearch.org/elasticsearch/1.0/centos',\nenabled        => 1,\ngpgcheck       => 1,\n12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch10.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'elasticsearch-1.0':\n      8:     descr          => 'Elasticsearch repository for 1.0.x packages',\n      9:     baseurl        => 'http://packages.elasticsearch.org/elasticsearch/1.0/centos',\n     10:     enabled        => 1,\n     11:     gpgcheck       => 1,\n>>>  12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     13:   }\n     14: \n     15: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "weak_cryptography_algorithms", "file": "openstack@puppet-tripleo-manifests-profile-base-swift-ringbuilder.pp", "content": "unless  => 'swift-recon --md5 | grep -q \"doesn\\'t match\"',", "line": 155, "detection_span": [150, 160], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-swift-ringbuilder.pp\n\n}\n} else {\nexec{'create_swift_ring_tarball':\npath    => ['/bin', '/usr/bin'],\ncommand => 'tar cvzf /tmp/swift-rings.tar.gz /etc/swift/*.builder /etc/swift/*.ring.gz /etc/swift/backups/',\n155:         unless  => 'swift-recon --md5 | grep -q \"doesn\\'t match\"',\n}\n}\nexec{'upload_swift_ring_tarball':\npath        => ['/usr/bin'],\ncommand     => \"curl -g --insecure --silent --retry 3 -X PUT '${$swift_ring_put_tempurl}' --data-binary @/tmp/swift-rings.tar.gz\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-swift-ringbuilder.pp\n# Target line: 155\n\n    150:       }\n    151:     } else {\n    152:       exec{'create_swift_ring_tarball':\n    153:         path    => ['/bin', '/usr/bin'],\n    154:         command => 'tar cvzf /tmp/swift-rings.tar.gz /etc/swift/*.builder /etc/swift/*.ring.gz /etc/swift/backups/',\n>>> 155:         unless  => 'swift-recon --md5 | grep -q \"doesn\\'t match\"',\n    156:       }\n    157:     }\n    158:     exec{'upload_swift_ring_tarball':\n    159:       path        => ['/usr/bin'],\n    160:       command     => \"curl -g --insecure --silent --retry 3 -X PUT '${$swift_ring_put_tempurl}' --data-binary @/tmp/swift-rings.tar.gz\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
