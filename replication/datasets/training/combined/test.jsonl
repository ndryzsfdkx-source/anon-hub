{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-ironic-install-defaults-required_defaults_Fedora_26.yml", "content": "nginx_user: nginx", "line": 8, "detection_span": [6, 10], "with_context": "# File: bifrost-playbooks-roles-bifrost-ironic-install-defaults-required_defaults_Fedora_26.yml\n# Target line: 8\n\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n      5: ipxe_dir: /usr/share/ipxe/\n      6: ipxe_full_binary: ipxe.lkrn\n      7: ironic_rootwrap_dir: /usr/bin/\n>>>   8: nginx_user: nginx\n      9: mysql_service_name: mariadb\n     10: tftp_service_name: tftp\n     11: required_packages:\n     12:   - mariadb-server\n     13:   - dnsmasq", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-ironic-install-defaults-required_defaults_Fedora_26.yml\n# Target line: 8\n\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n      5: ipxe_dir: /usr/share/ipxe/\n      6: ipxe_full_binary: ipxe.lkrn\n      7: ironic_rootwrap_dir: /usr/bin/\n>>>   8: nginx_user: nginx\n      9: mysql_service_name: mariadb\n     10: tftp_service_name: tftp\n     11: required_packages:\n     12:   - mariadb-server\n     13:   - dnsmasq\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "mysql_username: \"root\"", "line": 15, "detection_span": [13, 17], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 15\n\n     10: skip_bootstrap: False\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n>>>  15: mysql_username: \"root\"\n     16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 15\n\n     10: skip_bootstrap: False\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n>>>  15: mysql_username: \"root\"\n     16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "username: admin", "line": 47, "detection_span": [45, 49], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 47\n\n     42: \n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n>>>  47:     username: admin\n     48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 47\n\n     42: \n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n>>>  47:     username: admin\n     48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "password: ChangeThisPa55w0rd", "line": 48, "detection_span": [46, 50], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 48\n\n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n     47:     username: admin\n>>>  48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 48\n\n     43: keystone:\n     44:   debug: true\n     45:   bootstrap:\n     46:     enabled: true\n     47:     username: admin\n>>>  48:     password: ChangeThisPa55w0rd\n     49:     project_name: admin\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "username: keystone", "line": 55, "detection_span": [53, 57], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 55\n\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"\n     54:   message_queue:\n>>>  55:     username: keystone\n     56:     password: ChangeThisPa55w0rd\n     57:     host: localhost\n     58:     port: 5672\n     59:   database:\n     60:     name: keystone", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 55\n\n     50:     admin_url: \"http://127.0.0.1:35357/v3/\"\n     51:     public_url: \"http://127.0.0.1:5000/v3/\"\n     52:     internal_url: \"http://127.0.0.1:5000/v3/\"\n     53:     region_name: \"RegionOne\"\n     54:   message_queue:\n>>>  55:     username: keystone\n     56:     password: ChangeThisPa55w0rd\n     57:     host: localhost\n     58:     port: 5672\n     59:   database:\n     60:     name: keystone\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "mysql_password: \"\"", "line": 16, "detection_span": [14, 18], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 16\n\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n     15: mysql_username: \"root\"\n>>>  16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 16\n\n     11: # set to true to skip starting ironic services and dependencies\n     12: skip_start: False\n     13: \n     14: # Parameters for connecting to mysql for database manipulation.\n     15: mysql_username: \"root\"\n>>>  16: mysql_password: \"\"\n     17: \n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-required_defaults_Debian_jessie.yml", "content": "nginx_user: www-data", "line": 5, "detection_span": [3, 7], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-required_defaults_Debian_jessie.yml\n# Target line: 5\n\n      1: ---\n      2: init_template: systemd_template.j2\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n>>>   5: nginx_user: www-data\n      6: mysql_service_name: mysql\n      7: required_packages:\n      8:   - mysql-server\n      9:   - rabbitmq-server\n     10:   - python-dev", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-required_defaults_Debian_jessie.yml\n# Target line: 5\n\n      1: ---\n      2: init_template: systemd_template.j2\n      3: init_dest_dir: /usr/lib/systemd/system/\n      4: init_ext: .service\n>>>   5: nginx_user: www-data\n      6: mysql_service_name: mysql\n      7: required_packages:\n      8:   - mysql-server\n      9:   - rabbitmq-server\n     10:   - python-dev\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "browbeat-ansible-install-roles-fluentd-tasks-main.yml", "content": "key=https://packages.treasuredata.com/GPG-KEY-td-agent", "line": 17, "detection_span": [15, 19], "with_context": "# File: browbeat-ansible-install-roles-fluentd-tasks-main.yml\n# Target line: 17\n\n     12:     mode=0644\n     13:   become: true\n     14: \n     15: - name: Import fluentd GPG Key\n     16:   rpm_key:\n>>>  17:     key=https://packages.treasuredata.com/GPG-KEY-td-agent\n     18:     state=present\n     19: \n     20: - name: Install fluentd\n     21:   yum: name={{ item }} state=present\n     22:   become: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: browbeat-ansible-install-roles-fluentd-tasks-main.yml\n# Target line: 17\n\n     12:     mode=0644\n     13:   become: true\n     14: \n     15: - name: Import fluentd GPG Key\n     16:   rpm_key:\n>>>  17:     key=https://packages.treasuredata.com/GPG-KEY-td-agent\n     18:     state=present\n     19: \n     20: - name: Install fluentd\n     21:   yum: name={{ item }} state=present\n     22:   become: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack-ansible-ops-leap-upgrades-upgrade-utilities-mitaka-playbooks-deploy-config-changes-mitaka.yml", "content": "user: root", "line": 20, "detection_span": [18, 22], "with_context": "# File: openstack-ansible-ops-leap-upgrades-upgrade-utilities-mitaka-playbooks-deploy-config-changes-mitaka.yml\n# Target line: 20\n\n     15: \n     16: - name: Upgrade environment/inventory configuration\n     17:   hosts: localhost\n     18:   connection: local\n     19:   gather_facts: false\n>>>  20:   user: root\n     21:   tasks:\n     22:       - name: Create an old copy of openstack_deploy\n     23:         copy:\n     24:           src: \"/etc/openstack_deploy/\"\n     25:           dest: \"/etc/openstack_deploy.LIBERTY/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-leap-upgrades-upgrade-utilities-mitaka-playbooks-deploy-config-changes-mitaka.yml\n# Target line: 20\n\n     15: \n     16: - name: Upgrade environment/inventory configuration\n     17:   hosts: localhost\n     18:   connection: local\n     19:   gather_facts: false\n>>>  20:   user: root\n     21:   tasks:\n     22:       - name: Create an old copy of openstack_deploy\n     23:         copy:\n     24:           src: \"/etc/openstack_deploy/\"\n     25:           dest: \"/etc/openstack_deploy.LIBERTY/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack-ansible-playbooks-lxc-containers-destroy.yml", "content": "key: lxc_containers", "line": 22, "detection_span": [20, 24], "with_context": "# File: openstack-ansible-playbooks-lxc-containers-destroy.yml\n# Target line: 22\n\n     17:   hosts: \"{{ container_group | default('all_containers') }}\"\n     18:   gather_facts: false\n     19:   tasks:\n     20:     - name: Add hosts to dynamic inventory group\n     21:       group_by:\n>>>  22:         key: lxc_containers\n     23:         parents: all_lxc_containers\n     24:       when:\n     25:         - container_tech == 'lxc'\n     26:   tags:\n     27:     - always", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-lxc-containers-destroy.yml\n# Target line: 22\n\n     17:   hosts: \"{{ container_group | default('all_containers') }}\"\n     18:   gather_facts: false\n     19:   tasks:\n     20:     - name: Add hosts to dynamic inventory group\n     21:       group_by:\n>>>  22:         key: lxc_containers\n     23:         parents: all_lxc_containers\n     24:       when:\n     25:         - container_tech == 'lxc'\n     26:   tags:\n     27:     - always\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack-ansible-playbooks-utility-install.yml", "content": "dest: /root/.ssh/id_rsa", "line": 70, "detection_span": [68, 72], "with_context": "# File: openstack-ansible-playbooks-utility-install.yml\n# Target line: 70\n\n     65:         cache_valid_time: \"{{ (ansible_pkg_mgr == 'apt') | ternary(cache_timeout, omit) }}\"\n     66: \n     67:     - name: Distribute private ssh key\n     68:       copy:\n     69:         content: \"{{ utility_ssh_private_key }}\"\n>>>  70:         dest: /root/.ssh/id_rsa\n     71:         mode: 0600\n     72:         owner: root\n     73:         group: root\n     74:       when: utility_ssh_private_key is defined\n     75: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-utility-install.yml\n# Target line: 70\n\n     65:         cache_valid_time: \"{{ (ansible_pkg_mgr == 'apt') | ternary(cache_timeout, omit) }}\"\n     66: \n     67:     - name: Distribute private ssh key\n     68:       copy:\n     69:         content: \"{{ utility_ssh_private_key }}\"\n>>>  70:         dest: /root/.ssh/id_rsa\n     71:         mode: 0600\n     72:         owner: root\n     73:         group: root\n     74:       when: utility_ssh_private_key is defined\n     75: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "tripleo-quickstart-roles-libvirt-setup-overcloud-tasks-vars-libvirt_nodepool_vars.yml", "content": "vm_pass: random", "line": 16, "detection_span": [14, 18], "with_context": "# File: tripleo-quickstart-roles-libvirt-setup-overcloud-tasks-vars-libvirt_nodepool_vars.yml\n# Target line: 16\n\n     11:     flavor: control\n     12: pub_key: \"{{ lookup('env', 'HOME') }}/.ssh/id_rsa.pub\"\n     13: image_fetch_dir: \"{{ local_working_dir }}\"\n     14: libvirt_nodepool_vms: true\n     15: create_instackenv_json: false\n>>>  16: vm_pass: random\n     17: control_vcpu: 6\n     18: control_memory: 16384\n     19: images:\n     20:   - name: centos\n     21:     url: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1802.qcow2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: tripleo-quickstart-roles-libvirt-setup-overcloud-tasks-vars-libvirt_nodepool_vars.yml\n# Target line: 16\n\n     11:     flavor: control\n     12: pub_key: \"{{ lookup('env', 'HOME') }}/.ssh/id_rsa.pub\"\n     13: image_fetch_dir: \"{{ local_working_dir }}\"\n     14: libvirt_nodepool_vms: true\n     15: create_instackenv_json: false\n>>>  16: vm_pass: random\n     17: control_vcpu: 6\n     18: control_memory: 16384\n     19: images:\n     20:   - name: centos\n     21:     url: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1802.qcow2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "ansible-role-tripleo-modify-image-tasks-modify_image.yml", "content": "#FIXME: buildah should not required root commands to build an image", "line": 35, "detection_span": [33, 37], "with_context": "# File: ansible-role-tripleo-modify-image-tasks-modify_image.yml\n# Target line: 35\n\n     30:     insertafter: \"^FROM \"\n     31:     line: \"LABEL modified_append_tag={{ modified_append_tag }}\"\n     32: \n     33: - name: Modify image from {{ modify_dir_path }}\n     34:   command: \"{{ build_commands[container_build_tool] }} --tag {{ target_image | default(source_image) }}{{ modified_append_tag }} --file Dockerfile.modified --network host ./\"\n>>>  35:   #FIXME: buildah should not required root commands to build an image\n     36:   become: \"{{ true if build_commands[container_build_tool] == 'buildah' else false }}\"\n     37:   args:\n     38:     chdir: \"{{ modify_dir_path }}\"\n     39: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: ansible-role-tripleo-modify-image-tasks-modify_image.yml\n# Target line: 35\n\n     30:     insertafter: \"^FROM \"\n     31:     line: \"LABEL modified_append_tag={{ modified_append_tag }}\"\n     32: \n     33: - name: Modify image from {{ modify_dir_path }}\n     34:   command: \"{{ build_commands[container_build_tool] }} --tag {{ target_image | default(source_image) }}{{ modified_append_tag }} --file Dockerfile.modified --network host ./\"\n>>>  35:   #FIXME: buildah should not required root commands to build an image\n     36:   become: \"{{ true if build_commands[container_build_tool] == 'buildah' else false }}\"\n     37:   args:\n     38:     chdir: \"{{ modify_dir_path }}\"\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "browbeat-ansible-browbeat-roles-gnocchi-config-tasks-main.yml", "content": "# (akrzos) Commented out Group as to prevent in Pike incorrect permissions on config file", "line": 11, "detection_span": [9, 13], "with_context": "# File: browbeat-ansible-browbeat-roles-gnocchi-config-tasks-main.yml\n# Target line: 11\n\n      6: - name: Configure gnocchi.conf\n      7:   become: true\n      8:   ini_file:\n      9:     dest: \"{{gnocchi_config_file}}\"\n     10:     mode: 0640\n>>>  11:     # (akrzos) Commented out Group as to prevent in Pike incorrect permissions on config file\n     12:     # group: gnocchi\n     13:     section: \"{{item.section}}\"\n     14:     option: \"{{item.option}}\"\n     15:     value: \"{{item.value}}\"\n     16:     backup: yes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: browbeat-ansible-browbeat-roles-gnocchi-config-tasks-main.yml\n# Target line: 11\n\n      6: - name: Configure gnocchi.conf\n      7:   become: true\n      8:   ini_file:\n      9:     dest: \"{{gnocchi_config_file}}\"\n     10:     mode: 0640\n>>>  11:     # (akrzos) Commented out Group as to prevent in Pike incorrect permissions on config file\n     12:     # group: gnocchi\n     13:     section: \"{{item.section}}\"\n     14:     option: \"{{item.option}}\"\n     15:     value: \"{{item.value}}\"\n     16:     backup: yes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml", "content": "# TODO(odyssey4me): revisit this once the bug is fixed and released", "line": 98, "detection_span": [96, 100], "with_context": "# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 98\n\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n     96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n>>>  98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart\n    102:   command: >\n    103:     lxc-stop --name {{ inventory_hostname }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 98\n\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n     96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n>>>  98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart\n    102:   command: >\n    103:     lxc-stop --name {{ inventory_hostname }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack-ansible-playbooks-healthcheck-hosts.yml", "content": "# TO BE IMPLEMENTED", "line": 20, "detection_span": [18, 22], "with_context": "# File: openstack-ansible-playbooks-healthcheck-hosts.yml\n# Target line: 20\n\n     15: \n     16: # This playbook is meant to run after setup-hosts.\n     17: # To succeed, it expects the setup-hosts playbook to have run successfuly.\n     18: \n     19: # Test if the openstack-hosts-setup play was a success.\n>>>  20: # TO BE IMPLEMENTED\n     21: \n     22: # Test if security-hardening was a success.\n     23: # TO BE IMPLEMENTED\n     24: \n     25: # Test if containers-deploy was a success.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-healthcheck-hosts.yml\n# Target line: 20\n\n     15: \n     16: # This playbook is meant to run after setup-hosts.\n     17: # To succeed, it expects the setup-hosts playbook to have run successfuly.\n     18: \n     19: # Test if the openstack-hosts-setup play was a success.\n>>>  20: # TO BE IMPLEMENTED\n     21: \n     22: # Test if security-hardening was a success.\n     23: # TO BE IMPLEMENTED\n     24: \n     25: # Test if containers-deploy was a success.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml", "content": "# Due to https://github.com/ansible/ansible-modules-extras/issues/2691", "line": 96, "detection_span": [94, 98], "with_context": "# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 96\n\n     91:   retries: 3\n     92:   delay: 5\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n>>>  96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n     98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-playbooks-common-tasks-os-lxc-container-setup.yml\n# Target line: 96\n\n     91:   retries: 3\n     92:   delay: 5\n     93:   when:\n     94:     - (_mc is defined and _mc | changed) or (_ec is defined and _ec | changed)\n     95: \n>>>  96: # Due to https://github.com/ansible/ansible-modules-extras/issues/2691\n     97: # this uses the LXC CLI tools to ensure that we get logging.\n     98: # TODO(odyssey4me): revisit this once the bug is fixed and released\n     99: # NOTE(cloudnull): The `lxc-stop` command will have an RC of 2 if the command\n    100: #                  fails due to a container already being in a stopped state.\n    101: - name: Lxc container restart\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'", "line": 24, "detection_span": [22, 26], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 24\n\n     19: default_os_families:\n     20:   ubuntu-16.04-amd64: debian\n     21:   ubuntu-14.04-amd64: debian\n     22: \n     23: default_ubuntu_kernel: linux-generic\n>>>  24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 24\n\n     19: default_os_families:\n     20:   ubuntu-16.04-amd64: debian\n     21:   ubuntu-14.04-amd64: debian\n     22: \n     23: default_ubuntu_kernel: linux-generic\n>>>  24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "default_proxy_url: 'http://10.0.2.1:3142/'", "line": 28, "detection_span": [26, 30], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 28\n\n     23: default_ubuntu_kernel: linux-generic\n     24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n>>>  28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n     32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 28\n\n     23: default_ubuntu_kernel: linux-generic\n     24: default_ubuntu_mirror_proxy: 'http://10.0.2.1:3142/'\n     25: default_ubuntu_mirror_hostname: archive.ubuntu.com\n     26: default_ubuntu_mirror_directory: /ubuntu\n     27: \n>>>  28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n     32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "ipxe_kernel_base_url: \"http://boot.ipxe.org\"", "line": 32, "detection_span": [30, 34], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 32\n\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n>>>  32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: \n     34: # The timeout for the SSH check to the vm_servers\n     35: vm_ssh_timeout: 1500\n     36: \n     37: # Whether to use snapshots (if they are available) for file-backed VM's", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 32\n\n     27: \n     28: default_proxy_url: 'http://10.0.2.1:3142/'\n     29: \n     30: default_container_tech: \"{{ container_tech | default('lxc') }}\"\n     31: \n>>>  32: ipxe_kernel_base_url: \"http://boot.ipxe.org\"\n     33: \n     34: # The timeout for the SSH check to the vm_servers\n     35: vm_ssh_timeout: 1500\n     36: \n     37: # Whether to use snapshots (if they are available) for file-backed VM's\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"", "line": 53, "detection_span": [51, 55], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 53\n\n     48:     image_type: \"debian\"\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 53\n\n     48:     image_type: \"debian\"\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"", "line": 54, "detection_span": [52, 56], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 54\n\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 54\n\n     49:     network_setup: \"systemd-networkd\"\n     50:     image_os: \"ubuntu\"\n     51:     image-version: \"bionic\"\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "url: \"http://{{ tftp_server }}/configs/vm.config\"", "line": 57, "detection_span": [55, 59], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 57\n\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n>>>  57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n     60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 57\n\n     52:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     53:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     54:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/bionic/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     55:     image_configs:\n     56:       vm:\n>>>  57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n     60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "url: \"http://{{ tftp_server }}/configs/vm-compute.config\"", "line": 60, "detection_span": [58, 62], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 60\n\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n>>>  60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 60\n\n     55:     image_configs:\n     56:       vm:\n     57:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     58:         template_name: \"vm.config\"\n     59:       vm-compute:\n>>>  60:         url: \"http://{{ tftp_server }}/configs/vm-compute.config\"\n     61:         template_name: \"vm-compute.config\"\n     62:   ubuntu-16.04-amd64:\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"", "line": 68, "detection_span": [66, 70], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 68\n\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 68\n\n     63:     image_type: \"debian\"\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n>>>  68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"", "line": 69, "detection_span": [67, 71], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 69\n\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"\n     74:       vm-compute:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 69\n\n     64:     network_setup: \"eni\"\n     65:     image_os: \"ubuntu\"\n     66:     image-version: \"xenial\"\n     67:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical\"\n     68:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  69:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/xenial/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     70:     image_configs:\n     71:       vm:\n     72:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     73:         template_name: \"vm.config\"\n     74:       vm-compute:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"", "line": 83, "detection_span": [81, 85], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 83\n\n     78:     image_type: \"debian\"\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n>>>  83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 83\n\n     78:     image_type: \"debian\"\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n>>>  83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n     84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"", "line": 84, "detection_span": [82, 86], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 84\n\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n     83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"\n     89:       vm-compute:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 84\n\n     79:     network_setup: \"eni\"\n     80:     image_os: \"ubuntu\"\n     81:     image_version: \"trusty\"\n     82:     image_kernel_options: \"biosdevname=0 net.ifnames=0 auto=true priority=critical quiet splash\"\n     83:     image_netboot_kernel_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/linux\"\n>>>  84:     image_netboot_initrd_url: \"http://archive.ubuntu.com/ubuntu/dists/trusty/main/installer-amd64/current/images/netboot/ubuntu-installer/amd64/initrd.gz\"\n     85:     image_configs:\n     86:       vm:\n     87:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n     88:         template_name: \"vm.config\"\n     89:       vm-compute:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"", "line": 96, "detection_span": [94, 98], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 96\n\n     91:         template_name: \"vm-compute.config\"\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n>>>  96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 96\n\n     91:         template_name: \"vm-compute.config\"\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n>>>  96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"", "line": 97, "detection_span": [95, 99], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 97\n\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n>>>  97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 97\n\n     92:   centos-7-amd64:\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n>>>  97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n     98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml", "content": "image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"", "line": 98, "detection_span": [96, 100], "with_context": "# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 98\n\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n>>>  98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n    103:         template_name: \"vm.config\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: openstack-ansible-ops-multi-node-aio-playbooks-group_vars-all.yml\n# Target line: 98\n\n     93:     image_type: \"redhat\"\n     94:     network_setup: \"systemd-networkd\"\n     95:     image_version: 7\n     96:     image_netboot_kernel_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/vmlinuz\"\n     97:     image_netboot_initrd_url: \"http://mirrors.edge.kernel.org/centos/7/os/x86_64/images/pxeboot/initrd.img\"\n>>>  98:     image_repo_base_url: \"http://mirrors.edge.kernel.org/centos/7\"\n     99:     image_kernel_options: \"\"\n    100:     image_configs:\n    101:       vm:\n    102:         url: \"http://{{ tftp_server }}/configs/vm.config\"\n    103:         template_name: \"vm.config\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml", "content": "cors_allowed_origin2: \"www.google.com\"", "line": 23, "detection_span": [21, 25], "with_context": "# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 23\n\n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests\n     22: cors_allowed_origin: \"http://localhost:8000\"\n>>>  23: cors_allowed_origin2: \"www.google.com\"\n     24: # bifrost utilizes noauth mode by default and as such\n     25: # the setting should be set to false. This setting should\n     26: # not need to be modified by the user.\n     27: enable_cors_credential_support: false\n     28: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# File: bifrost-playbooks-roles-bifrost-keystone-install-defaults-main.yml\n# Target line: 23\n\n     18: # Support for CORS configuration\n     19: # By default CORS support is disabled.\n     20: enable_cors: false\n     21: # Origin to accept for CORS requests\n     22: cors_allowed_origin: \"http://localhost:8000\"\n>>>  23: cors_allowed_origin2: \"www.google.com\"\n     24: # bifrost utilizes noauth mode by default and as such\n     25: # the setting should be set to false. This setting should\n     26: # not need to be modified by the user.\n     27: enable_cors_credential_support: false\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "chef-boneyard_qa-chef-server-cluster-attributes-default.rb", "content": "node.default['qa-chef-server-cluster']['private-key'] = \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEA2lzwvnpTObhbhrzgiOaaoj04hsGi2PIvWqQeF6dk9wP9rpPQ\\nmEqCpEwVNzoOAT4hgB5VvlGBvchOkdV/4TiJGIKP6mGlHglKCEAnOir/FCP1+jb7\\nIvSW6t752+tYffCA9ywRSu1OIub+fO6dQ+3nZvYT0vYttBUjHOG24F7XHvE6G6G9\\nI5RF1MtCR7JWP/WOenHKtdXAPXC9eKtK6HKqh4OZVGWZOUvcOPNRyA2SfZ7XS2rl\\nfgYZj0/Lxsirc6frR9jSFrHksBSUWuWQv7LhzzIi1YimR7jf//WR9CjcCm06o/Qp\\nJVefpIfYFiqzFIRzpPsVcRChX4BkwBy/23B6iwIDAQABAoIBAQDQqD7jxMACR8gt\\n2A42wyTAIwAAxMd3xvS5CFo5ABvablXanCSXYZu0o38iZrc7OMOKSXJlij0PvHhX\\nokuwSvW2FgyvSt8c9INpnuPdEXjtJe/GSQNxQ4dyp97Z5umIbmjNx64+isQ/VbuY\\nZeqhHpQgLsSCsfq6OfhzgLvfasDlLpkOwKTQPYIj2PC1CHXCUMti9GQKYKO96Xgt\\nXjIjrQ/J/DsmgmISLBGTLUBdClyJpt+Pqk/vBVsFZ+hZECFtwUEuotLDxkT2F/oK\\nzczrdqAtg272SWupINE2g4LRWVn31utGWA2uijHQgUgvAtF03FiTR9j4HnLGUmtk\\nt3g224EBAoGBAPAmbh4JFpvpj6zF4AQDINuZDO8IK0k+aNePICQ2p5VZ5TIr0/+f\\nFbvbbEdoCT+OGgUJKfVSrAwr7sKZRrodaYmPHpUqEeureAbiI2PMmfuJFpHyyu4f\\ny6+GwYvEmC/G/SGt2QZH9QryHHB7/DTnfi9VIKGE+kIUxb6YPHbhHEQnAoGBAOjG\\nZYMKZDYDdALPKN/+iY5vEJYXV91MJ/zXh+ICo39vPMu993fEzGoli2iEmbzxVhVn\\nfq7r0hjbD3vD+QEsgOd6UEYvXiNqhucRH3qMhpqEOpU6aqU+PpPtJi9v8MYYEeZZ\\nHhAhs9BefZ4Vn6TMsKkaveK4c5jUdBGWyxsiieD9AoGAEUQyFqbAoWUhl2KCwMcY\\nzbErZORJeHKsRxNbVD85vVtBR2IvU+m0PlWAa4HnaFJnPIV0JtdS120xNXyfwTHs\\nLJ/FqyPjNfaWIqiPstU7HQK2RLgYLxbKJkyiDdKMvqKoAIvnVrRFwgu2T8AaWhNq\\n1yxftD1DYQztSs7XShTVW3ECgYAWerpo6kL9OF4mu0zOPO2Z1L38UKrKk0U1VLcp\\nq2mQr/RmFKVmapn3EkMhR9T0+zV+Aa2pRNrYTad0I1vTsjGMqTJBZOepcesvO2cX\\n1aRWHbjummKcLKOsc3WBlUTiTIbGAQs3MZoE4GsvLhVpu96/pfZ6g6eeNb4zyKU6\\nrJ42HQKBgF5g0H0HvSlKRhVsISdINHKXcB++d+mYz3f7i8o88bxsB9IU7xOKiNPY\\n3pjf2xfYScjHZOg+T93YfOtP7NY9bc5yuTYvXC7/5bMK/5zvxwhFYGkNuD53113m\\n5KwYhHhWLiizsCC6ghbgDHbf1heu+Wn7IOwRG7wh3QaDm0JDpJ9l\\n-----END RSA PRIVATE KEY-----\"", "line": 3, "detection_span": [1, 7], "with_context": "# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 3\n\n      1: # unsecured default keys\n      2: # provisioner-setup recipe will clear the private and public attributes so they are not added to any nodes\n>>>   3: node.default['qa-chef-server-cluster']['private-key'] = \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEA2lzwvnpTObhbhrzgiOaaoj04hsGi2PIvWqQeF6dk9wP9rpPQ\\nmEqCpEwVNzoOAT4hgB5VvlGBvchOkdV/4TiJGIKP6mGlHglKCEAnOir/FCP1+jb7\\nIvSW6t752+tYffCA9ywRSu1OIub+fO6dQ+3nZvYT0vYttBUjHOG24F7XHvE6G6G9\\nI5RF1MtCR7JWP/WOenHKtdXAPXC9eKtK6HKqh4OZVGWZOUvcOPNRyA2SfZ7XS2rl\\nfgYZj0/Lxsirc6frR9jSFrHksBSUWuWQv7LhzzIi1YimR7jf//WR9CjcCm06o/Qp\\nJVefpIfYFiqzFIRzpPsVcRChX4BkwBy/23B6iwIDAQABAoIBAQDQqD7jxMACR8gt\\n2A42wyTAIwAAxMd3xvS5CFo5ABvablXanCSXYZu0o38iZrc7OMOKSXJlij0PvHhX\\nokuwSvW2FgyvSt8c9INpnuPdEXjtJe/GSQNxQ4dyp97Z5umIbmjNx64+isQ/VbuY\\nZeqhHpQgLsSCsfq6OfhzgLvfasDlLpkOwKTQPYIj2PC1CHXCUMti9GQKYKO96Xgt\\nXjIjrQ/J/DsmgmISLBGTLUBdClyJpt+Pqk/vBVsFZ+hZECFtwUEuotLDxkT2F/oK\\nzczrdqAtg272SWupINE2g4LRWVn31utGWA2uijHQgUgvAtF03FiTR9j4HnLGUmtk\\nt3g224EBAoGBAPAmbh4JFpvpj6zF4AQDINuZDO8IK0k+aNePICQ2p5VZ5TIr0/+f\\nFbvbbEdoCT+OGgUJKfVSrAwr7sKZRrodaYmPHpUqEeureAbiI2PMmfuJFpHyyu4f\\ny6+GwYvEmC/G/SGt2QZH9QryHHB7/DTnfi9VIKGE+kIUxb6YPHbhHEQnAoGBAOjG\\nZYMKZDYDdALPKN/+iY5vEJYXV91MJ/zXh+ICo39vPMu993fEzGoli2iEmbzxVhVn\\nfq7r0hjbD3vD+QEsgOd6UEYvXiNqhucRH3qMhpqEOpU6aqU+PpPtJi9v8MYYEeZZ\\nHhAhs9BefZ4Vn6TMsKkaveK4c5jUdBGWyxsiieD9AoGAEUQyFqbAoWUhl2KCwMcY\\nzbErZORJeHKsRxNbVD85vVtBR2IvU+m0PlWAa4HnaFJnPIV0JtdS120xNXyfwTHs\\nLJ/FqyPjNfaWIqiPstU7HQK2RLgYLxbKJkyiDdKMvqKoAIvnVrRFwgu2T8AaWhNq\\n1yxftD1DYQztSs7XShTVW3ECgYAWerpo6kL9OF4mu0zOPO2Z1L38UKrKk0U1VLcp\\nq2mQr/RmFKVmapn3EkMhR9T0+zV+Aa2pRNrYTad0I1vTsjGMqTJBZOepcesvO2cX\\n1aRWHbjummKcLKOsc3WBlUTiTIbGAQs3MZoE4GsvLhVpu96/pfZ6g6eeNb4zyKU6\\nrJ42HQKBgF5g0H0HvSlKRhVsISdINHKXcB++d+mYz3f7i8o88bxsB9IU7xOKiNPY\\n3pjf2xfYScjHZOg+T93YfOtP7NY9bc5yuTYvXC7/5bMK/5zvxwhFYGkNuD53113m\\n5KwYhHhWLiizsCC6ghbgDHbf1heu+Wn7IOwRG7wh3QaDm0JDpJ9l\\n-----END RSA PRIVATE KEY-----\"\n      4: node.default['qa-chef-server-cluster']['public-key'] = 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaXPC+elM5uFuGvOCI5pqiPTiGwaLY8i9apB4Xp2T3A/2uk9CYSoKkTBU3Og4BPiGAHlW+UYG9yE6R1X/hOIkYgo/qYaUeCUoIQCc6Kv8UI/X6Nvsi9Jbq3vnb61h98ID3LBFK7U4i5v587p1D7edm9hPS9i20FSMc4bbgXtce8Tobob0jlEXUy0JHslY/9Y56ccq11cA9cL14q0rocqqHg5lUZZk5S9w481HIDZJ9ntdLauV+BhmPT8vGyKtzp+tH2NIWseSwFJRa5ZC/suHPMiLViKZHuN//9ZH0KNwKbTqj9CklV5+kh9gWKrMUhHOk+xVxEKFfgGTAHL/bcHqL ociv'\n      5: \n      6: node.default['qa-chef-server-cluster']['aws'].tap do |aws|\n      7:   aws['region'] = 'us-west-2'\n      8:   aws['availability_zone'] = 'b'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 3\n\n      1: # unsecured default keys\n      2: # provisioner-setup recipe will clear the private and public attributes so they are not added to any nodes\n>>>   3: node.default['qa-chef-server-cluster']['private-key'] = \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEA2lzwvnpTObhbhrzgiOaaoj04hsGi2PIvWqQeF6dk9wP9rpPQ\\nmEqCpEwVNzoOAT4hgB5VvlGBvchOkdV/4TiJGIKP6mGlHglKCEAnOir/FCP1+jb7\\nIvSW6t752+tYffCA9ywRSu1OIub+fO6dQ+3nZvYT0vYttBUjHOG24F7XHvE6G6G9\\nI5RF1MtCR7JWP/WOenHKtdXAPXC9eKtK6HKqh4OZVGWZOUvcOPNRyA2SfZ7XS2rl\\nfgYZj0/Lxsirc6frR9jSFrHksBSUWuWQv7LhzzIi1YimR7jf//WR9CjcCm06o/Qp\\nJVefpIfYFiqzFIRzpPsVcRChX4BkwBy/23B6iwIDAQABAoIBAQDQqD7jxMACR8gt\\n2A42wyTAIwAAxMd3xvS5CFo5ABvablXanCSXYZu0o38iZrc7OMOKSXJlij0PvHhX\\nokuwSvW2FgyvSt8c9INpnuPdEXjtJe/GSQNxQ4dyp97Z5umIbmjNx64+isQ/VbuY\\nZeqhHpQgLsSCsfq6OfhzgLvfasDlLpkOwKTQPYIj2PC1CHXCUMti9GQKYKO96Xgt\\nXjIjrQ/J/DsmgmISLBGTLUBdClyJpt+Pqk/vBVsFZ+hZECFtwUEuotLDxkT2F/oK\\nzczrdqAtg272SWupINE2g4LRWVn31utGWA2uijHQgUgvAtF03FiTR9j4HnLGUmtk\\nt3g224EBAoGBAPAmbh4JFpvpj6zF4AQDINuZDO8IK0k+aNePICQ2p5VZ5TIr0/+f\\nFbvbbEdoCT+OGgUJKfVSrAwr7sKZRrodaYmPHpUqEeureAbiI2PMmfuJFpHyyu4f\\ny6+GwYvEmC/G/SGt2QZH9QryHHB7/DTnfi9VIKGE+kIUxb6YPHbhHEQnAoGBAOjG\\nZYMKZDYDdALPKN/+iY5vEJYXV91MJ/zXh+ICo39vPMu993fEzGoli2iEmbzxVhVn\\nfq7r0hjbD3vD+QEsgOd6UEYvXiNqhucRH3qMhpqEOpU6aqU+PpPtJi9v8MYYEeZZ\\nHhAhs9BefZ4Vn6TMsKkaveK4c5jUdBGWyxsiieD9AoGAEUQyFqbAoWUhl2KCwMcY\\nzbErZORJeHKsRxNbVD85vVtBR2IvU+m0PlWAa4HnaFJnPIV0JtdS120xNXyfwTHs\\nLJ/FqyPjNfaWIqiPstU7HQK2RLgYLxbKJkyiDdKMvqKoAIvnVrRFwgu2T8AaWhNq\\n1yxftD1DYQztSs7XShTVW3ECgYAWerpo6kL9OF4mu0zOPO2Z1L38UKrKk0U1VLcp\\nq2mQr/RmFKVmapn3EkMhR9T0+zV+Aa2pRNrYTad0I1vTsjGMqTJBZOepcesvO2cX\\n1aRWHbjummKcLKOsc3WBlUTiTIbGAQs3MZoE4GsvLhVpu96/pfZ6g6eeNb4zyKU6\\nrJ42HQKBgF5g0H0HvSlKRhVsISdINHKXcB++d+mYz3f7i8o88bxsB9IU7xOKiNPY\\n3pjf2xfYScjHZOg+T93YfOtP7NY9bc5yuTYvXC7/5bMK/5zvxwhFYGkNuD53113m\\n5KwYhHhWLiizsCC6ghbgDHbf1heu+Wn7IOwRG7wh3QaDm0JDpJ9l\\n-----END RSA PRIVATE KEY-----\"\n      4: node.default['qa-chef-server-cluster']['public-key'] = 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaXPC+elM5uFuGvOCI5pqiPTiGwaLY8i9apB4Xp2T3A/2uk9CYSoKkTBU3Og4BPiGAHlW+UYG9yE6R1X/hOIkYgo/qYaUeCUoIQCc6Kv8UI/X6Nvsi9Jbq3vnb61h98ID3LBFK7U4i5v587p1D7edm9hPS9i20FSMc4bbgXtce8Tobob0jlEXUy0JHslY/9Y56ccq11cA9cL14q0rocqqHg5lUZZk5S9w481HIDZJ9ntdLauV+BhmPT8vGyKtzp+tH2NIWseSwFJRa5ZC/suHPMiLViKZHuN//9ZH0KNwKbTqj9CklV5+kh9gWKrMUhHOk+xVxEKFfgGTAHL/bcHqL ociv'\n      5: \n      6: node.default['qa-chef-server-cluster']['aws'].tap do |aws|\n      7:   aws['region'] = 'us-west-2'\n      8:   aws['availability_zone'] = 'b'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:database][:root_user]       = \"root\"", "line": 34, "detection_span": [30, 38], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 34\n\n     29: default[:zabbix][:server][:log_dir]           = '/var/log/zabbix_server'\n     30: \n     31: # Database\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n>>>  34: default[:zabbix][:database][:root_user]       = \"root\"\n     35: default[:zabbix][:database][:root_password]   = nil\n     36: default[:zabbix][:database][:user]            = \"zabbix\"\n     37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 34\n\n     29: default[:zabbix][:server][:log_dir]           = '/var/log/zabbix_server'\n     30: \n     31: # Database\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n>>>  34: default[:zabbix][:database][:root_user]       = \"root\"\n     35: default[:zabbix][:database][:root_password]   = nil\n     36: default[:zabbix][:database][:user]            = \"zabbix\"\n     37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:database][:root_password]   = nil", "line": 35, "detection_span": [31, 39], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 35\n\n     30: \n     31: # Database\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n     34: default[:zabbix][:database][:root_user]       = \"root\"\n>>>  35: default[:zabbix][:database][:root_password]   = nil\n     36: default[:zabbix][:database][:user]            = \"zabbix\"\n     37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n     40: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 35\n\n     30: \n     31: # Database\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n     34: default[:zabbix][:database][:root_user]       = \"root\"\n>>>  35: default[:zabbix][:database][:root_password]   = nil\n     36: default[:zabbix][:database][:user]            = \"zabbix\"\n     37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:database][:user]            = \"zabbix\"", "line": 36, "detection_span": [32, 40], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 36\n\n     31: # Database\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n     34: default[:zabbix][:database][:root_user]       = \"root\"\n     35: default[:zabbix][:database][:root_password]   = nil\n>>>  36: default[:zabbix][:database][:user]            = \"zabbix\"\n     37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n     40: \n     41: # Web frontend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 36\n\n     31: # Database\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n     34: default[:zabbix][:database][:root_user]       = \"root\"\n     35: default[:zabbix][:database][:root_password]   = nil\n>>>  36: default[:zabbix][:database][:user]            = \"zabbix\"\n     37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n     40: \n     41: # Web frontend\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:database][:password]        = nil", "line": 37, "detection_span": [33, 41], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 37\n\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n     34: default[:zabbix][:database][:root_user]       = \"root\"\n     35: default[:zabbix][:database][:root_password]   = nil\n     36: default[:zabbix][:database][:user]            = \"zabbix\"\n>>>  37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n     40: \n     41: # Web frontend\n     42: default[:zabbix][:web][:fqdn]           = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 37\n\n     32: default[:zabbix][:database][:host]            = \"localhost\"\n     33: default[:zabbix][:database][:port]            = \"3306\"\n     34: default[:zabbix][:database][:root_user]       = \"root\"\n     35: default[:zabbix][:database][:root_password]   = nil\n     36: default[:zabbix][:database][:user]            = \"zabbix\"\n>>>  37: default[:zabbix][:database][:password]        = nil\n     38: default[:zabbix][:database][:name]            = \"zabbix\"\n     39: default[:zabbix][:database][:install_method]  = 'mysql'\n     40: \n     41: # Web frontend\n     42: default[:zabbix][:web][:fqdn]           = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:api][:username]   = 'chef'", "line": 51, "detection_span": [47, 55], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 51\n\n     46: default[:zabbix][:web][:install_method] = 'apache'\n     47: default[:zabbix][:web][:timezone]       = 'Europe/London' # UTC\n     48: \n     49: # API\n     50: default[:zabbix][:api][:path]       = 'api_jsonrpc.php'\n>>>  51: default[:zabbix][:api][:username]   = 'chef'\n     52: default[:zabbix][:api][:password]   = 'fixme'\n     53: default[:zabbix][:api][:user_group] = 'chefs'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 51\n\n     46: default[:zabbix][:web][:install_method] = 'apache'\n     47: default[:zabbix][:web][:timezone]       = 'Europe/London' # UTC\n     48: \n     49: # API\n     50: default[:zabbix][:api][:path]       = 'api_jsonrpc.php'\n>>>  51: default[:zabbix][:api][:username]   = 'chef'\n     52: default[:zabbix][:api][:password]   = 'fixme'\n     53: default[:zabbix][:api][:user_group] = 'chefs'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:api][:password]   = 'fixme'", "line": 52, "detection_span": [48, 56], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 52\n\n     47: default[:zabbix][:web][:timezone]       = 'Europe/London' # UTC\n     48: \n     49: # API\n     50: default[:zabbix][:api][:path]       = 'api_jsonrpc.php'\n     51: default[:zabbix][:api][:username]   = 'chef'\n>>>  52: default[:zabbix][:api][:password]   = 'fixme'\n     53: default[:zabbix][:api][:user_group] = 'chefs'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 52\n\n     47: default[:zabbix][:web][:timezone]       = 'Europe/London' # UTC\n     48: \n     49: # API\n     50: default[:zabbix][:api][:path]       = 'api_jsonrpc.php'\n     51: default[:zabbix][:api][:username]   = 'chef'\n>>>  52: default[:zabbix][:api][:password]   = 'fixme'\n     53: default[:zabbix][:api][:user_group] = 'chefs'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb", "content": "default[:mongodb][:password]    = \"\"", "line": 35, "detection_span": [31, 39], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 35\n\n     30: \n     31: ### EXTRA\n     32: default[:mongodb][:log_cpu_io]  = false\n     33: default[:mongodb][:auth]        = false\n     34: default[:mongodb][:username]    = \"\"\n>>>  35: default[:mongodb][:password]    = \"\"\n     36: default[:mongodb][:verbose]     = false\n     37: default[:mongodb][:objcheck]    = false\n     38: default[:mongodb][:quota]       = false\n     39: default[:mongodb][:diaglog]     = false\n     40: default[:mongodb][:nocursors]   = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 35\n\n     30: \n     31: ### EXTRA\n     32: default[:mongodb][:log_cpu_io]  = false\n     33: default[:mongodb][:auth]        = false\n     34: default[:mongodb][:username]    = \"\"\n>>>  35: default[:mongodb][:password]    = \"\"\n     36: default[:mongodb][:verbose]     = false\n     37: default[:mongodb][:objcheck]    = false\n     38: default[:mongodb][:quota]       = false\n     39: default[:mongodb][:diaglog]     = false\n     40: default[:mongodb][:nocursors]   = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "jonmthomson_cookbooks-mingw-recipes-default.rb", "content": "password 'vagrant'", "line": 14, "detection_span": [10, 18], "with_context": "# File: jonmthomson_cookbooks-mingw-recipes-default.rb\n# Target line: 14\n\n      9: include_recipe 'boxstarter::default'\n     10: \n     11: boxstarter \"boxstarter run\" do\n     12: \n     13:   # retries 3\n>>>  14:   password 'vagrant'\n     15:   disable_reboots true\n     16: \n     17:   code <<-EOH\n     18:     choco install mingw\n     19:   EOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: jonmthomson_cookbooks-mingw-recipes-default.rb\n# Target line: 14\n\n      9: include_recipe 'boxstarter::default'\n     10: \n     11: boxstarter \"boxstarter run\" do\n     12: \n     13:   # retries 3\n>>>  14:   password 'vagrant'\n     15:   disable_reboots true\n     16: \n     17:   code <<-EOH\n     18:     choco install mingw\n     19:   EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-recipes-graphite.rb", "content": "user \"root\"", "line": 130, "detection_span": [126, 134], "with_context": "# File: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-graphite.rb\n# Target line: 130\n\n    125:     mode 00644\n    126:     notifies :restart, \"service[apache2]\", :delayed\n    127: end\n    128: \n    129: bash \"apache-enable-graphite-web\" do\n>>> 130:     user \"root\"\n    131:     code \"a2ensite graphite-web\"\n    132:     not_if \"test -r /etc/apache2/sites-enabled/graphite-web\"\n    133:     notifies :restart, \"service[apache2]\", :delayed\n    134: end\n    135: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-graphite.rb\n# Target line: 130\n\n    125:     mode 00644\n    126:     notifies :restart, \"service[apache2]\", :delayed\n    127: end\n    128: \n    129: bash \"apache-enable-graphite-web\" do\n>>> 130:     user \"root\"\n    131:     code \"a2ensite graphite-web\"\n    132:     not_if \"test -r /etc/apache2/sites-enabled/graphite-web\"\n    133:     notifies :restart, \"service[apache2]\", :delayed\n    134: end\n    135: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-recipes-mysql.rb", "content": "key \"percona-release.key\"", "line": 33, "detection_span": [29, 37], "with_context": "# File: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-mysql.rb\n# Target line: 33\n\n     28: \n     29: apt_repository \"percona\" do\n     30:   uri node['bcpc']['repos']['mysql']\n     31:   distribution node['lsb']['codename']\n     32:   components [\"main\"]\n>>>  33:   key \"percona-release.key\"\n     34: end\n     35: \n     36: package \"percona-xtradb-cluster-server\" do\n     37:     action :upgrade\n     38: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-mysql.rb\n# Target line: 33\n\n     28: \n     29: apt_repository \"percona\" do\n     30:   uri node['bcpc']['repos']['mysql']\n     31:   distribution node['lsb']['codename']\n     32:   components [\"main\"]\n>>>  33:   key \"percona-release.key\"\n     34: end\n     35: \n     36: package \"percona-xtradb-cluster-server\" do\n     37:     action :upgrade\n     38: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-slurm-recipes-install_slurm.rb", "content": "user 'root'", "line": 75, "detection_span": [71, 79], "with_context": "# File: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-slurm-recipes-install_slurm.rb\n# Target line: 75\n\n     70:   end\n     71: end\n     72: \n     73: # Install Slurm\n     74: bash 'make install' do\n>>>  75:   user 'root'\n     76:   group 'root'\n     77:   cwd Chef::Config[:file_cache_path]\n     78:   code <<-SLURM\n     79:     set -e\n     80: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-slurm-recipes-install_slurm.rb\n# Target line: 75\n\n     70:   end\n     71: end\n     72: \n     73: # Install Slurm\n     74: bash 'make install' do\n>>>  75:   user 'root'\n     76:   group 'root'\n     77:   cwd Chef::Config[:file_cache_path]\n     78:   code <<-SLURM\n     79:     set -e\n     80: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "chef-boneyard_qa-chef-server-cluster-attributes-default.rb", "content": "node.default['qa-chef-server-cluster']['public-key'] = 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaXPC+elM5uFuGvOCI5pqiPTiGwaLY8i9apB4Xp2T3A/2uk9CYSoKkTBU3Og4BPiGAHlW+UYG9yE6R1X/hOIkYgo/qYaUeCUoIQCc6Kv8UI/X6Nvsi9Jbq3vnb61h98ID3LBFK7U4i5v587p1D7edm9hPS9i20FSMc4bbgXtce8Tobob0jlEXUy0JHslY/9Y56ccq11cA9cL14q0rocqqHg5lUZZk5S9w481HIDZJ9ntdLauV+BhmPT8vGyKtzp+tH2NIWseSwFJRa5ZC/suHPMiLViKZHuN//9ZH0KNwKbTqj9CklV5+kh9gWKrMUhHOk+xVxEKFfgGTAHL/bcHqL ociv'", "line": 4, "detection_span": [1, 8], "with_context": "# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 4\n\n      1: # unsecured default keys\n      2: # provisioner-setup recipe will clear the private and public attributes so they are not added to any nodes\n      3: node.default['qa-chef-server-cluster']['private-key'] = \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEA2lzwvnpTObhbhrzgiOaaoj04hsGi2PIvWqQeF6dk9wP9rpPQ\\nmEqCpEwVNzoOAT4hgB5VvlGBvchOkdV/4TiJGIKP6mGlHglKCEAnOir/FCP1+jb7\\nIvSW6t752+tYffCA9ywRSu1OIub+fO6dQ+3nZvYT0vYttBUjHOG24F7XHvE6G6G9\\nI5RF1MtCR7JWP/WOenHKtdXAPXC9eKtK6HKqh4OZVGWZOUvcOPNRyA2SfZ7XS2rl\\nfgYZj0/Lxsirc6frR9jSFrHksBSUWuWQv7LhzzIi1YimR7jf//WR9CjcCm06o/Qp\\nJVefpIfYFiqzFIRzpPsVcRChX4BkwBy/23B6iwIDAQABAoIBAQDQqD7jxMACR8gt\\n2A42wyTAIwAAxMd3xvS5CFo5ABvablXanCSXYZu0o38iZrc7OMOKSXJlij0PvHhX\\nokuwSvW2FgyvSt8c9INpnuPdEXjtJe/GSQNxQ4dyp97Z5umIbmjNx64+isQ/VbuY\\nZeqhHpQgLsSCsfq6OfhzgLvfasDlLpkOwKTQPYIj2PC1CHXCUMti9GQKYKO96Xgt\\nXjIjrQ/J/DsmgmISLBGTLUBdClyJpt+Pqk/vBVsFZ+hZECFtwUEuotLDxkT2F/oK\\nzczrdqAtg272SWupINE2g4LRWVn31utGWA2uijHQgUgvAtF03FiTR9j4HnLGUmtk\\nt3g224EBAoGBAPAmbh4JFpvpj6zF4AQDINuZDO8IK0k+aNePICQ2p5VZ5TIr0/+f\\nFbvbbEdoCT+OGgUJKfVSrAwr7sKZRrodaYmPHpUqEeureAbiI2PMmfuJFpHyyu4f\\ny6+GwYvEmC/G/SGt2QZH9QryHHB7/DTnfi9VIKGE+kIUxb6YPHbhHEQnAoGBAOjG\\nZYMKZDYDdALPKN/+iY5vEJYXV91MJ/zXh+ICo39vPMu993fEzGoli2iEmbzxVhVn\\nfq7r0hjbD3vD+QEsgOd6UEYvXiNqhucRH3qMhpqEOpU6aqU+PpPtJi9v8MYYEeZZ\\nHhAhs9BefZ4Vn6TMsKkaveK4c5jUdBGWyxsiieD9AoGAEUQyFqbAoWUhl2KCwMcY\\nzbErZORJeHKsRxNbVD85vVtBR2IvU+m0PlWAa4HnaFJnPIV0JtdS120xNXyfwTHs\\nLJ/FqyPjNfaWIqiPstU7HQK2RLgYLxbKJkyiDdKMvqKoAIvnVrRFwgu2T8AaWhNq\\n1yxftD1DYQztSs7XShTVW3ECgYAWerpo6kL9OF4mu0zOPO2Z1L38UKrKk0U1VLcp\\nq2mQr/RmFKVmapn3EkMhR9T0+zV+Aa2pRNrYTad0I1vTsjGMqTJBZOepcesvO2cX\\n1aRWHbjummKcLKOsc3WBlUTiTIbGAQs3MZoE4GsvLhVpu96/pfZ6g6eeNb4zyKU6\\nrJ42HQKBgF5g0H0HvSlKRhVsISdINHKXcB++d+mYz3f7i8o88bxsB9IU7xOKiNPY\\n3pjf2xfYScjHZOg+T93YfOtP7NY9bc5yuTYvXC7/5bMK/5zvxwhFYGkNuD53113m\\n5KwYhHhWLiizsCC6ghbgDHbf1heu+Wn7IOwRG7wh3QaDm0JDpJ9l\\n-----END RSA PRIVATE KEY-----\"\n>>>   4: node.default['qa-chef-server-cluster']['public-key'] = 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaXPC+elM5uFuGvOCI5pqiPTiGwaLY8i9apB4Xp2T3A/2uk9CYSoKkTBU3Og4BPiGAHlW+UYG9yE6R1X/hOIkYgo/qYaUeCUoIQCc6Kv8UI/X6Nvsi9Jbq3vnb61h98ID3LBFK7U4i5v587p1D7edm9hPS9i20FSMc4bbgXtce8Tobob0jlEXUy0JHslY/9Y56ccq11cA9cL14q0rocqqHg5lUZZk5S9w481HIDZJ9ntdLauV+BhmPT8vGyKtzp+tH2NIWseSwFJRa5ZC/suHPMiLViKZHuN//9ZH0KNwKbTqj9CklV5+kh9gWKrMUhHOk+xVxEKFfgGTAHL/bcHqL ociv'\n      5: \n      6: node.default['qa-chef-server-cluster']['aws'].tap do |aws|\n      7:   aws['region'] = 'us-west-2'\n      8:   aws['availability_zone'] = 'b'\n      9: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 4\n\n      1: # unsecured default keys\n      2: # provisioner-setup recipe will clear the private and public attributes so they are not added to any nodes\n      3: node.default['qa-chef-server-cluster']['private-key'] = \"-----BEGIN RSA PRIVATE KEY-----\\nMIIEowIBAAKCAQEA2lzwvnpTObhbhrzgiOaaoj04hsGi2PIvWqQeF6dk9wP9rpPQ\\nmEqCpEwVNzoOAT4hgB5VvlGBvchOkdV/4TiJGIKP6mGlHglKCEAnOir/FCP1+jb7\\nIvSW6t752+tYffCA9ywRSu1OIub+fO6dQ+3nZvYT0vYttBUjHOG24F7XHvE6G6G9\\nI5RF1MtCR7JWP/WOenHKtdXAPXC9eKtK6HKqh4OZVGWZOUvcOPNRyA2SfZ7XS2rl\\nfgYZj0/Lxsirc6frR9jSFrHksBSUWuWQv7LhzzIi1YimR7jf//WR9CjcCm06o/Qp\\nJVefpIfYFiqzFIRzpPsVcRChX4BkwBy/23B6iwIDAQABAoIBAQDQqD7jxMACR8gt\\n2A42wyTAIwAAxMd3xvS5CFo5ABvablXanCSXYZu0o38iZrc7OMOKSXJlij0PvHhX\\nokuwSvW2FgyvSt8c9INpnuPdEXjtJe/GSQNxQ4dyp97Z5umIbmjNx64+isQ/VbuY\\nZeqhHpQgLsSCsfq6OfhzgLvfasDlLpkOwKTQPYIj2PC1CHXCUMti9GQKYKO96Xgt\\nXjIjrQ/J/DsmgmISLBGTLUBdClyJpt+Pqk/vBVsFZ+hZECFtwUEuotLDxkT2F/oK\\nzczrdqAtg272SWupINE2g4LRWVn31utGWA2uijHQgUgvAtF03FiTR9j4HnLGUmtk\\nt3g224EBAoGBAPAmbh4JFpvpj6zF4AQDINuZDO8IK0k+aNePICQ2p5VZ5TIr0/+f\\nFbvbbEdoCT+OGgUJKfVSrAwr7sKZRrodaYmPHpUqEeureAbiI2PMmfuJFpHyyu4f\\ny6+GwYvEmC/G/SGt2QZH9QryHHB7/DTnfi9VIKGE+kIUxb6YPHbhHEQnAoGBAOjG\\nZYMKZDYDdALPKN/+iY5vEJYXV91MJ/zXh+ICo39vPMu993fEzGoli2iEmbzxVhVn\\nfq7r0hjbD3vD+QEsgOd6UEYvXiNqhucRH3qMhpqEOpU6aqU+PpPtJi9v8MYYEeZZ\\nHhAhs9BefZ4Vn6TMsKkaveK4c5jUdBGWyxsiieD9AoGAEUQyFqbAoWUhl2KCwMcY\\nzbErZORJeHKsRxNbVD85vVtBR2IvU+m0PlWAa4HnaFJnPIV0JtdS120xNXyfwTHs\\nLJ/FqyPjNfaWIqiPstU7HQK2RLgYLxbKJkyiDdKMvqKoAIvnVrRFwgu2T8AaWhNq\\n1yxftD1DYQztSs7XShTVW3ECgYAWerpo6kL9OF4mu0zOPO2Z1L38UKrKk0U1VLcp\\nq2mQr/RmFKVmapn3EkMhR9T0+zV+Aa2pRNrYTad0I1vTsjGMqTJBZOepcesvO2cX\\n1aRWHbjummKcLKOsc3WBlUTiTIbGAQs3MZoE4GsvLhVpu96/pfZ6g6eeNb4zyKU6\\nrJ42HQKBgF5g0H0HvSlKRhVsISdINHKXcB++d+mYz3f7i8o88bxsB9IU7xOKiNPY\\n3pjf2xfYScjHZOg+T93YfOtP7NY9bc5yuTYvXC7/5bMK/5zvxwhFYGkNuD53113m\\n5KwYhHhWLiizsCC6ghbgDHbf1heu+Wn7IOwRG7wh3QaDm0JDpJ9l\\n-----END RSA PRIVATE KEY-----\"\n>>>   4: node.default['qa-chef-server-cluster']['public-key'] = 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaXPC+elM5uFuGvOCI5pqiPTiGwaLY8i9apB4Xp2T3A/2uk9CYSoKkTBU3Og4BPiGAHlW+UYG9yE6R1X/hOIkYgo/qYaUeCUoIQCc6Kv8UI/X6Nvsi9Jbq3vnb61h98ID3LBFK7U4i5v587p1D7edm9hPS9i20FSMc4bbgXtce8Tobob0jlEXUy0JHslY/9Y56ccq11cA9cL14q0rocqqHg5lUZZk5S9w481HIDZJ9ntdLauV+BhmPT8vGyKtzp+tH2NIWseSwFJRa5ZC/suHPMiLViKZHuN//9ZH0KNwKbTqj9CklV5+kh9gWKrMUhHOk+xVxEKFfgGTAHL/bcHqL ociv'\n      5: \n      6: node.default['qa-chef-server-cluster']['aws'].tap do |aws|\n      7:   aws['region'] = 'us-west-2'\n      8:   aws['availability_zone'] = 'b'\n      9: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "chef-boneyard_qa-chef-server-cluster-attributes-default.rb", "content": "machine_options['ssh_username'] = 'ubuntu'", "line": 14, "detection_span": [10, 18], "with_context": "# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 14\n\n      9: end\n     10: \n     11: node.default['qa-chef-server-cluster']['aws']['machine_options'].tap do |machine_options|\n     12:   machine_options['aws_tags'] = { 'X-Project' => 'qa-chef-server-cluster' }\n     13:   machine_options['transport_address_location'] = :private_ip\n>>>  14:   machine_options['ssh_username'] = 'ubuntu'\n     15:   machine_options['bootstrap_options'].tap do |bootstrap_options|\n     16:     bootstrap_options['key_name'] = 'qa-chef-server-cluster-default'\n     17:     bootstrap_options['subnet_id'] = 'subnet-d3d9b8b4' # chef-cd -- acceptance-us-west-2a-private\n     18:     bootstrap_options['security_group_ids'] = ['sg-b3ed07c8'] # acceptance-default\n     19:     bootstrap_options['image_id'] = 'ami-4218403a' # Ubuntu 14.04", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 14\n\n      9: end\n     10: \n     11: node.default['qa-chef-server-cluster']['aws']['machine_options'].tap do |machine_options|\n     12:   machine_options['aws_tags'] = { 'X-Project' => 'qa-chef-server-cluster' }\n     13:   machine_options['transport_address_location'] = :private_ip\n>>>  14:   machine_options['ssh_username'] = 'ubuntu'\n     15:   machine_options['bootstrap_options'].tap do |bootstrap_options|\n     16:     bootstrap_options['key_name'] = 'qa-chef-server-cluster-default'\n     17:     bootstrap_options['subnet_id'] = 'subnet-d3d9b8b4' # chef-cd -- acceptance-us-west-2a-private\n     18:     bootstrap_options['security_group_ids'] = ['sg-b3ed07c8'] # acceptance-default\n     19:     bootstrap_options['image_id'] = 'ami-4218403a' # Ubuntu 14.04\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "chef-boneyard_qa-chef-server-cluster-attributes-default.rb", "content": "bootstrap_options['key_name'] = 'qa-chef-server-cluster-default'", "line": 16, "detection_span": [12, 20], "with_context": "# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 16\n\n     11: node.default['qa-chef-server-cluster']['aws']['machine_options'].tap do |machine_options|\n     12:   machine_options['aws_tags'] = { 'X-Project' => 'qa-chef-server-cluster' }\n     13:   machine_options['transport_address_location'] = :private_ip\n     14:   machine_options['ssh_username'] = 'ubuntu'\n     15:   machine_options['bootstrap_options'].tap do |bootstrap_options|\n>>>  16:     bootstrap_options['key_name'] = 'qa-chef-server-cluster-default'\n     17:     bootstrap_options['subnet_id'] = 'subnet-d3d9b8b4' # chef-cd -- acceptance-us-west-2a-private\n     18:     bootstrap_options['security_group_ids'] = ['sg-b3ed07c8'] # acceptance-default\n     19:     bootstrap_options['image_id'] = 'ami-4218403a' # Ubuntu 14.04\n     20:     bootstrap_options['instance_type'] = 't2.large'\n     21:   end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: chef-boneyard_qa-chef-server-cluster-attributes-default.rb\n# Target line: 16\n\n     11: node.default['qa-chef-server-cluster']['aws']['machine_options'].tap do |machine_options|\n     12:   machine_options['aws_tags'] = { 'X-Project' => 'qa-chef-server-cluster' }\n     13:   machine_options['transport_address_location'] = :private_ip\n     14:   machine_options['ssh_username'] = 'ubuntu'\n     15:   machine_options['bootstrap_options'].tap do |bootstrap_options|\n>>>  16:     bootstrap_options['key_name'] = 'qa-chef-server-cluster-default'\n     17:     bootstrap_options['subnet_id'] = 'subnet-d3d9b8b4' # chef-cd -- acceptance-us-west-2a-private\n     18:     bootstrap_options['security_group_ids'] = ['sg-b3ed07c8'] # acceptance-default\n     19:     bootstrap_options['image_id'] = 'ami-4218403a' # Ubuntu 14.04\n     20:     bootstrap_options['instance_type'] = 't2.large'\n     21:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:user]  = \"zabbix\"", "line": 20, "detection_span": [16, 24], "with_context": "# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 20\n\n     15: default[:zabbix][:agent][:log_dir]                = '/var/log/zabbix_agent'\n     16: default[:zabbix][:agent][:create_host]            = true\n     17: default[:zabbix][:agent][:unmonitor_on_shutdown]  = false\n     18: default[:zabbix][:agent][:unsafe_user_parameters] = true\n     19: \n>>>  20: default[:zabbix][:user]  = \"zabbix\"\n     21: default[:users ]['zabbix'][:uid]    = 447\n     22: default[:groups]['zabbix'][:gid]    = 447\n     23: \n     24: # Server\n     25: default[:zabbix][:server][:version]           = \"1.8.8\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-pig-cookbooks-zabbix-attributes-default.rb\n# Target line: 20\n\n     15: default[:zabbix][:agent][:log_dir]                = '/var/log/zabbix_agent'\n     16: default[:zabbix][:agent][:create_host]            = true\n     17: default[:zabbix][:agent][:unmonitor_on_shutdown]  = false\n     18: default[:zabbix][:agent][:unsafe_user_parameters] = true\n     19: \n>>>  20: default[:zabbix][:user]  = \"zabbix\"\n     21: default[:users ]['zabbix'][:uid]    = 447\n     22: default[:groups]['zabbix'][:gid]    = 447\n     23: \n     24: # Server\n     25: default[:zabbix][:server][:version]           = \"1.8.8\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb", "content": "default[:graphite][:user]                             = 'www-data'", "line": 10, "detection_span": [6, 14], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb\n# Target line: 10\n\n      5: default[:graphite][:conf_dir]                         = '/etc/graphite'\n      6: default[:graphite][:pid_dir]                          = '/var/run/graphite'\n      7: default[:graphite][:carbon   ][:log_dir]              = '/var/log/graphite/carbon'\n      8: default[:graphite][:dashboard][:log_dir]              = '/var/log/graphite/dashboard'\n      9: \n>>>  10: default[:graphite][:user]                             = 'www-data'\n     11: default[:graphite][:carbon   ][:user]                 = 'www-data'\n     12: default[:graphite][:dashboard][:user]                 = 'www-data'\n     13: \n     14: default[:users ]['graphite'][:uid]                    = 446\n     15: default[:groups]['graphite'][:gid]                    = 446", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb\n# Target line: 10\n\n      5: default[:graphite][:conf_dir]                         = '/etc/graphite'\n      6: default[:graphite][:pid_dir]                          = '/var/run/graphite'\n      7: default[:graphite][:carbon   ][:log_dir]              = '/var/log/graphite/carbon'\n      8: default[:graphite][:dashboard][:log_dir]              = '/var/log/graphite/dashboard'\n      9: \n>>>  10: default[:graphite][:user]                             = 'www-data'\n     11: default[:graphite][:carbon   ][:user]                 = 'www-data'\n     12: default[:graphite][:dashboard][:user]                 = 'www-data'\n     13: \n     14: default[:users ]['graphite'][:uid]                    = 446\n     15: default[:groups]['graphite'][:gid]                    = 446\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb", "content": "default[:graphite][:carbon   ][:user]                 = 'www-data'", "line": 11, "detection_span": [7, 15], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb\n# Target line: 11\n\n      6: default[:graphite][:pid_dir]                          = '/var/run/graphite'\n      7: default[:graphite][:carbon   ][:log_dir]              = '/var/log/graphite/carbon'\n      8: default[:graphite][:dashboard][:log_dir]              = '/var/log/graphite/dashboard'\n      9: \n     10: default[:graphite][:user]                             = 'www-data'\n>>>  11: default[:graphite][:carbon   ][:user]                 = 'www-data'\n     12: default[:graphite][:dashboard][:user]                 = 'www-data'\n     13: \n     14: default[:users ]['graphite'][:uid]                    = 446\n     15: default[:groups]['graphite'][:gid]                    = 446\n     16: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb\n# Target line: 11\n\n      6: default[:graphite][:pid_dir]                          = '/var/run/graphite'\n      7: default[:graphite][:carbon   ][:log_dir]              = '/var/log/graphite/carbon'\n      8: default[:graphite][:dashboard][:log_dir]              = '/var/log/graphite/dashboard'\n      9: \n     10: default[:graphite][:user]                             = 'www-data'\n>>>  11: default[:graphite][:carbon   ][:user]                 = 'www-data'\n     12: default[:graphite][:dashboard][:user]                 = 'www-data'\n     13: \n     14: default[:users ]['graphite'][:uid]                    = 446\n     15: default[:groups]['graphite'][:gid]                    = 446\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb", "content": "default[:graphite][:dashboard][:user]                 = 'www-data'", "line": 12, "detection_span": [8, 16], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb\n# Target line: 12\n\n      7: default[:graphite][:carbon   ][:log_dir]              = '/var/log/graphite/carbon'\n      8: default[:graphite][:dashboard][:log_dir]              = '/var/log/graphite/dashboard'\n      9: \n     10: default[:graphite][:user]                             = 'www-data'\n     11: default[:graphite][:carbon   ][:user]                 = 'www-data'\n>>>  12: default[:graphite][:dashboard][:user]                 = 'www-data'\n     13: \n     14: default[:users ]['graphite'][:uid]                    = 446\n     15: default[:groups]['graphite'][:gid]                    = 446\n     16: \n     17: default[:graphite][:carbon   ][:run_state]            = :start", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-graphite-attributes-default.rb\n# Target line: 12\n\n      7: default[:graphite][:carbon   ][:log_dir]              = '/var/log/graphite/carbon'\n      8: default[:graphite][:dashboard][:log_dir]              = '/var/log/graphite/dashboard'\n      9: \n     10: default[:graphite][:user]                             = 'www-data'\n     11: default[:graphite][:carbon   ][:user]                 = 'www-data'\n>>>  12: default[:graphite][:dashboard][:user]                 = 'www-data'\n     13: \n     14: default[:users ]['graphite'][:uid]                    = 446\n     15: default[:groups]['graphite'][:gid]                    = 446\n     16: \n     17: default[:graphite][:carbon   ][:run_state]            = :start\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb", "content": "user = (node.platform == 'centos' ? 'mongod' : 'mongodb')", "line": 7, "detection_span": [3, 11], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 7\n\n      2: default[:mongodb][:version]           = \"1.8.0\"\n      3: default[:mongodb][:source]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-#{node[:kernel][:machine]}-#{mongodb[:version]}.tgz\"\n      4: default[:mongodb][:i686][:checksum]   = \"b0b4d98968960cc90d2900ab0135bc24\"\n      5: default[:mongodb][:x86_64][:checksum] = \"d764d869f2a3984251cfea5335cc6c53\"\n      6: \n>>>   7: user = (node.platform == 'centos' ? 'mongod' : 'mongodb')\n      8: default[:mongodb][:user]        = user\n      9: default[:users ][user][:uid]    = 460\n     10: default[:groups][user][:gid]    = 460\n     11: \n     12: ### GENERAL", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 7\n\n      2: default[:mongodb][:version]           = \"1.8.0\"\n      3: default[:mongodb][:source]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-#{node[:kernel][:machine]}-#{mongodb[:version]}.tgz\"\n      4: default[:mongodb][:i686][:checksum]   = \"b0b4d98968960cc90d2900ab0135bc24\"\n      5: default[:mongodb][:x86_64][:checksum] = \"d764d869f2a3984251cfea5335cc6c53\"\n      6: \n>>>   7: user = (node.platform == 'centos' ? 'mongod' : 'mongodb')\n      8: default[:mongodb][:user]        = user\n      9: default[:users ][user][:uid]    = 460\n     10: default[:groups][user][:gid]    = 460\n     11: \n     12: ### GENERAL\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb", "content": "default[:mongodb][:username]    = \"\"", "line": 34, "detection_span": [30, 38], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 34\n\n     29: default[:mongodb][:bind_ip]     = \"0.0.0.0\"\n     30: \n     31: ### EXTRA\n     32: default[:mongodb][:log_cpu_io]  = false\n     33: default[:mongodb][:auth]        = false\n>>>  34: default[:mongodb][:username]    = \"\"\n     35: default[:mongodb][:password]    = \"\"\n     36: default[:mongodb][:verbose]     = false\n     37: default[:mongodb][:objcheck]    = false\n     38: default[:mongodb][:quota]       = false\n     39: default[:mongodb][:diaglog]     = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 34\n\n     29: default[:mongodb][:bind_ip]     = \"0.0.0.0\"\n     30: \n     31: ### EXTRA\n     32: default[:mongodb][:log_cpu_io]  = false\n     33: default[:mongodb][:auth]        = false\n>>>  34: default[:mongodb][:username]    = \"\"\n     35: default[:mongodb][:password]    = \"\"\n     36: default[:mongodb][:verbose]     = false\n     37: default[:mongodb][:objcheck]    = false\n     38: default[:mongodb][:quota]       = false\n     39: default[:mongodb][:diaglog]     = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb", "content": "default[:mongodb][:token]     = \"\"", "line": 56, "detection_span": [52, 60], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 56\n\n     51: default[:mongodb][:syncdelay]   = 60\n     52: \n     53: \n     54: ### MMS\n     55: default[:mongodb][:mms]       = false\n>>>  56: default[:mongodb][:token]     = \"\"\n     57: default[:mongodb][:name]      = \"\"\n     58: default[:mongodb][:interval]  = \"\"\n     59: \n     60: \n     61: ### REPLICATION", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 56\n\n     51: default[:mongodb][:syncdelay]   = 60\n     52: \n     53: \n     54: ### MMS\n     55: default[:mongodb][:mms]       = false\n>>>  56: default[:mongodb][:token]     = \"\"\n     57: default[:mongodb][:name]      = \"\"\n     58: default[:mongodb][:interval]  = \"\"\n     59: \n     60: \n     61: ### REPLICATION\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-volumes_ebs-cookbooks-resque-attributes-default.rb", "content": "default[:resque][:user]                 = 'resque'", "line": 17, "detection_span": [13, 21], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-resque-attributes-default.rb\n# Target line: 17\n\n     12: default[:resque][:data_dir]             = '/data/db/resque/data'\n     13: default[:resque][:journal_dir]          = '/data/db/resque/swap'\n     14: \n     15: default[:resque][:db_basename]          = 'resque_queue.rdb'\n     16: \n>>>  17: default[:resque][:user]                 = 'resque'\n     18: default[:resque][:group]                = 'resque'\n     19: default[:users ]['resque' ][:uid]       = 336\n     20: default[:groups]['resque' ][:gid]       = 336\n     21: \n     22: default[:resque][:namespace]            = node[:cluster_name]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-resque-attributes-default.rb\n# Target line: 17\n\n     12: default[:resque][:data_dir]             = '/data/db/resque/data'\n     13: default[:resque][:journal_dir]          = '/data/db/resque/swap'\n     14: \n     15: default[:resque][:db_basename]          = 'resque_queue.rdb'\n     16: \n>>>  17: default[:resque][:user]                 = 'resque'\n     18: default[:resque][:group]                = 'resque'\n     19: default[:users ]['resque' ][:uid]       = 336\n     20: default[:groups]['resque' ][:gid]       = 336\n     21: \n     22: default[:resque][:namespace]            = node[:cluster_name]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-oozie.rb", "content": "user \"hdfs\"", "line": 96, "detection_span": [92, 100], "with_context": "# File: desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-oozie.rb\n# Target line: 96\n\n     91: bash \"make_oozie_user_dir\" do\n     92:   code <<-EOH\n     93:     hdfs dfs -mkdir -p #{HDFS_URL}/user/oozie && \\\n     94:     hdfs dfs -chown -R oozie #{HDFS_URL}/user/oozie\n     95:   EOH\n>>>  96:   user \"hdfs\"\n     97:   not_if \"hdfs dfs -test -d #{HDFS_URL}/user/oozie\", :user => \"hdfs\"\n     98: end\n     99: \n    100: bash \"oozie_create_shared_libs\" do\n    101:   code \"#{OOZIE_CLIENT_PATH}/bin/oozie-setup.sh sharelib create -fs #{HDFS_URL} -locallib #{OOZIE_SHARELIB_TARBALL_PATH}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-oozie.rb\n# Target line: 96\n\n     91: bash \"make_oozie_user_dir\" do\n     92:   code <<-EOH\n     93:     hdfs dfs -mkdir -p #{HDFS_URL}/user/oozie && \\\n     94:     hdfs dfs -chown -R oozie #{HDFS_URL}/user/oozie\n     95:   EOH\n>>>  96:   user \"hdfs\"\n     97:   not_if \"hdfs dfs -test -d #{HDFS_URL}/user/oozie\", :user => \"hdfs\"\n     98: end\n     99: \n    100: bash \"oozie_create_shared_libs\" do\n    101:   code \"#{OOZIE_CLIENT_PATH}/bin/oozie-setup.sh sharelib create -fs #{HDFS_URL} -locallib #{OOZIE_SHARELIB_TARBALL_PATH}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-oozie.rb", "content": "user \"oozie\"", "line": 102, "detection_span": [98, 106], "with_context": "# File: desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-oozie.rb\n# Target line: 102\n\n     97:   not_if \"hdfs dfs -test -d #{HDFS_URL}/user/oozie\", :user => \"hdfs\"\n     98: end\n     99: \n    100: bash \"oozie_create_shared_libs\" do\n    101:   code \"#{OOZIE_CLIENT_PATH}/bin/oozie-setup.sh sharelib create -fs #{HDFS_URL} -locallib #{OOZIE_SHARELIB_TARBALL_PATH}\"\n>>> 102:   user \"oozie\"\n    103:   not_if {\n    104:     require 'digest'\n    105:     chksum = node[:bcpc][:hadoop][:oozie][:sharelib_checksum]\n    106:     not chksum.nil? and Digest::MD5.hexdigest(File.read(OOZIE_SHARELIB_TARBALL_PATH)) == chksum\n    107:   } ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-oozie.rb\n# Target line: 102\n\n     97:   not_if \"hdfs dfs -test -d #{HDFS_URL}/user/oozie\", :user => \"hdfs\"\n     98: end\n     99: \n    100: bash \"oozie_create_shared_libs\" do\n    101:   code \"#{OOZIE_CLIENT_PATH}/bin/oozie-setup.sh sharelib create -fs #{HDFS_URL} -locallib #{OOZIE_SHARELIB_TARBALL_PATH}\"\n>>> 102:   user \"oozie\"\n    103:   not_if {\n    104:     require 'digest'\n    105:     chksum = node[:bcpc][:hadoop][:oozie][:sharelib_checksum]\n    106:     not chksum.nil? and Digest::MD5.hexdigest(File.read(OOZIE_SHARELIB_TARBALL_PATH)) == chksum\n    107:   } \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-hive-attributes-default.rb", "content": "default[:hive][:db_user] = \"hive\"", "line": 19, "detection_span": [15, 23], "with_context": "# File: guymatz_chef-cookbooks-hive-attributes-default.rb\n# Target line: 19\n\n     14: default[:hive][:mysql_migration_script] = \"hive-schema-0.9.0.mysql.sql\"\n     15: \n     16: # MySQL stuff\n     17: \n     18: default[:hive][:app_name] = \"hive\"\n>>>  19: default[:hive][:db_user] = \"hive\"\n     20: default[:hive][:db_name] = \"metastore\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: guymatz_chef-cookbooks-hive-attributes-default.rb\n# Target line: 19\n\n     14: default[:hive][:mysql_migration_script] = \"hive-schema-0.9.0.mysql.sql\"\n     15: \n     16: # MySQL stuff\n     17: \n     18: default[:hive][:app_name] = \"hive\"\n>>>  19: default[:hive][:db_user] = \"hive\"\n     20: default[:hive][:db_name] = \"metastore\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_backup-attributes-restore.rb", "content": "default[:imos_backup][:restore][:username] = \"restore\"", "line": 10, "detection_span": [6, 14], "with_context": "# File: gwalbran_chef-cookbooks-imos_backup-attributes-restore.rb\n# Target line: 10\n\n      5: default[:imos_backup][:restore][:from_host] = \"s3://imos-backups\"\n      6: \n      7: default[:imos_backup][:restore][:directives] = []\n      8: \n      9: # User to use for restoration coming from remote server\n>>>  10: default[:imos_backup][:restore][:username] = \"restore\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: gwalbran_chef-cookbooks-imos_backup-attributes-restore.rb\n# Target line: 10\n\n      5: default[:imos_backup][:restore][:from_host] = \"s3://imos-backups\"\n      6: \n      7: default[:imos_backup][:restore][:directives] = []\n      8: \n      9: # User to use for restoration coming from remote server\n>>>  10: default[:imos_backup][:restore][:username] = \"restore\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-socketproxy.rb", "content": "default['nginx']['socketproxy']['root'] = '/usr/share/nginx/apps'", "line": 1, "detection_span": [1, 5], "with_context": "# File: havk64_chef-zero-playground-cookbooks-nginx-attributes-socketproxy.rb\n# Target line: 1\n\n>>>   1: default['nginx']['socketproxy']['root'] = '/usr/share/nginx/apps'\n      2: default['nginx']['socketproxy']['app_owner'] = 'root'\n      3: default['nginx']['socketproxy']['logname'] = 'socketproxy'\n      4: default['nginx']['socketproxy']['log_level'] = 'error'\n      5: # default['nginx']['socketproxy']['default_app'] = 'default'\n      6: # default['nginx']['socketproxy']['apps'] = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: havk64_chef-zero-playground-cookbooks-nginx-attributes-socketproxy.rb\n# Target line: 1\n\n>>>   1: default['nginx']['socketproxy']['root'] = '/usr/share/nginx/apps'\n      2: default['nginx']['socketproxy']['app_owner'] = 'root'\n      3: default['nginx']['socketproxy']['logname'] = 'socketproxy'\n      4: default['nginx']['socketproxy']['log_level'] = 'error'\n      5: # default['nginx']['socketproxy']['default_app'] = 'default'\n      6: # default['nginx']['socketproxy']['apps'] = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-civicrm-recipes-default.rb", "content": "database_user \"civicrm\"", "line": 50, "detection_span": [46, 54], "with_context": "# File: openstreetmap_chef-cookbooks-civicrm-recipes-default.rb\n# Target line: 50\n\n     45: end\n     46: \n     47: wordpress_site \"join.osmfoundation.org\" do\n     48:   aliases \"crm.osmfoundation.org\"\n     49:   database_name \"civicrm\"\n>>>  50:   database_user \"civicrm\"\n     51:   database_password database_password\n     52:   fpm_prometheus_port 11301\n     53: end\n     54: \n     55: wordpress_theme \"osmblog-wp-theme\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: openstreetmap_chef-cookbooks-civicrm-recipes-default.rb\n# Target line: 50\n\n     45: end\n     46: \n     47: wordpress_site \"join.osmfoundation.org\" do\n     48:   aliases \"crm.osmfoundation.org\"\n     49:   database_name \"civicrm\"\n>>>  50:   database_user \"civicrm\"\n     51:   database_password database_password\n     52:   fpm_prometheus_port 11301\n     53: end\n     54: \n     55: wordpress_theme \"osmblog-wp-theme\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-civicrm-recipes-default.rb", "content": "user \"wordpress\"", "line": 120, "detection_span": [116, 124], "with_context": "# File: openstreetmap_chef-cookbooks-civicrm-recipes-default.rb\n# Target line: 120\n\n    115: end\n    116: \n    117: execute \"/opt/civicrm-#{civicrm_version}/civicrm\" do\n    118:   action :nothing\n    119:   command \"rsync --archive --delete /opt/civicrm-#{civicrm_version}/civicrm/ #{civicrm_directory}\"\n>>> 120:   user \"wordpress\"\n    121:   group \"wordpress\"\n    122:   subscribes :run, \"archive_file[#{cache_dir}/civicrm-#{civicrm_version}-wordpress.zip]\", :immediately\n    123:   subscribes :run, \"archive_file[#{cache_dir}/civicrm-#{civicrm_version}-l10n.tar.gz]\", :immediately\n    124: end\n    125: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: openstreetmap_chef-cookbooks-civicrm-recipes-default.rb\n# Target line: 120\n\n    115: end\n    116: \n    117: execute \"/opt/civicrm-#{civicrm_version}/civicrm\" do\n    118:   action :nothing\n    119:   command \"rsync --archive --delete /opt/civicrm-#{civicrm_version}/civicrm/ #{civicrm_directory}\"\n>>> 120:   user \"wordpress\"\n    121:   group \"wordpress\"\n    122:   subscribes :run, \"archive_file[#{cache_dir}/civicrm-#{civicrm_version}-wordpress.zip]\", :immediately\n    123:   subscribes :run, \"archive_file[#{cache_dir}/civicrm-#{civicrm_version}-l10n.tar.gz]\", :immediately\n    124: end\n    125: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-civicrm-recipes-default.rb", "content": "user \"www-data\"", "line": 178, "detection_span": [174, 182], "with_context": "# File: openstreetmap_chef-cookbooks-civicrm-recipes-default.rb\n# Target line: 178\n\n    173:   content settings\n    174: end\n    175: \n    176: cron_d \"osmf-crm\" do\n    177:   minute \"*/15\"\n>>> 178:   user \"www-data\"\n    179:   command \"php #{civicrm_directory}/civicrm/bin/cli.php -s join.osmfoundation.org -u batch -p \\\"#{passwords['batch']}\\\" -e Job -a execute 2>&1 | egrep -v '^PHP (Deprecated|Warning):'\"\n    180:   mailto \"admins@openstreetmap.org\"\n    181: end\n    182: \n    183: template \"/etc/cron.daily/osmf-crm-backup\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: openstreetmap_chef-cookbooks-civicrm-recipes-default.rb\n# Target line: 178\n\n    173:   content settings\n    174: end\n    175: \n    176: cron_d \"osmf-crm\" do\n    177:   minute \"*/15\"\n>>> 178:   user \"www-data\"\n    179:   command \"php #{civicrm_directory}/civicrm/bin/cli.php -s join.osmfoundation.org -u batch -p \\\"#{passwords['batch']}\\\" -e Job -a execute 2>&1 | egrep -v '^PHP (Deprecated|Warning):'\"\n    180:   mailto \"admins@openstreetmap.org\"\n    181: end\n    182: \n    183: template \"/etc/cron.daily/osmf-crm-backup\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-slurm-recipes-install_slurm.rb", "content": "# TODO: Fix, so it works for upgrade", "line": 93, "detection_span": [89, 97], "with_context": "# File: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-slurm-recipes-install_slurm.rb\n# Target line: 93\n\n     88:     make -j $CORES\n     89:     make install\n     90:     make install-contrib\n     91:     deactivate\n     92:   SLURM\n>>>  93:   # TODO: Fix, so it works for upgrade\n     94:   creates '/opt/slurm/bin/srun'\n     95: end\n     96: \n     97: # Copy required licensing files\n     98: directory \"#{node['cluster']['license_dir']}/slurm\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-slurm-recipes-install_slurm.rb\n# Target line: 93\n\n     88:     make -j $CORES\n     89:     make install\n     90:     make install-contrib\n     91:     deactivate\n     92:   SLURM\n>>>  93:   # TODO: Fix, so it works for upgrade\n     94:   creates '/opt/slurm/bin/srun'\n     95: end\n     96: \n     97: # Copy required licensing files\n     98: directory \"#{node['cluster']['license_dir']}/slurm\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-nodejs-cookbooks-hbase-recipes-config_files.rb", "content": "# FIXME: this is brittle, but the best I can do. can you do better?", "line": 49, "detection_span": [45, 53], "with_context": "# File: cookbooks_ic-nodejs-cookbooks-hbase-recipes-config_files.rb\n# Target line: 49\n\n     44:     end\n     45:   end\n     46: \n     47: \n     48: \n>>>  49:   # FIXME: this is brittle, but the best I can do. can you do better?\n     50:   Array(node[component][:exported_libs]).flatten.each do |export|\n     51:     pathsegs = export.gsub(%r{\\A.*/native/([\\w\\.\\-]+)/([^/]+)\\z}, '\\1/\\2')\n     52:     Chef::Log.debug( [ 'hbase using hadoop native libs', pathsegs, node[:hadoop][:exported_libs], node[:hbase][:home_dir] ].inspect )\n     53:     link \"#{node[:hbase][:home_dir]}/lib/native/#{pathsegs}\" do\n     54:       to  export", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-nodejs-cookbooks-hbase-recipes-config_files.rb\n# Target line: 49\n\n     44:     end\n     45:   end\n     46: \n     47: \n     48: \n>>>  49:   # FIXME: this is brittle, but the best I can do. can you do better?\n     50:   Array(node[component][:exported_libs]).flatten.each do |export|\n     51:     pathsegs = export.gsub(%r{\\A.*/native/([\\w\\.\\-]+)/([^/]+)\\z}, '\\1/\\2')\n     52:     Chef::Log.debug( [ 'hbase using hadoop native libs', pathsegs, node[:hadoop][:exported_libs], node[:hbase][:home_dir] ].inspect )\n     53:     link \"#{node[:hbase][:home_dir]}/lib/native/#{pathsegs}\" do\n     54:       to  export\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-volumes-cookbooks-strongswan-recipes-routing.rb", "content": "# FIXME: This is actually a whole separate concern from StrongSwan, and", "line": 22, "detection_span": [18, 26], "with_context": "# File: cookbooks_ic-volumes-cookbooks-strongswan-recipes-routing.rb\n# Target line: 22\n\n     17: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     18: # See the License for the specific language governing permissions and\n     19: # limitations under the License.\n     20: #\n     21: \n>>>  22: # FIXME: This is actually a whole separate concern from StrongSwan, and\n     23: #   deserves its own cookbook.\n     24: \n     25: # Set up IPv4 packet forwarding\n     26: execute \"ipv4_forwarding\" do\n     27:   command \"echo 1 > /proc/sys/net/ipv4/ip_forward\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes-cookbooks-strongswan-recipes-routing.rb\n# Target line: 22\n\n     17: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     18: # See the License for the specific language governing permissions and\n     19: # limitations under the License.\n     20: #\n     21: \n>>>  22: # FIXME: This is actually a whole separate concern from StrongSwan, and\n     23: #   deserves its own cookbook.\n     24: \n     25: # Set up IPv4 packet forwarding\n     26: execute \"ipv4_forwarding\" do\n     27:   command \"echo 1 > /proc/sys/net/ipv4/ip_forward\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb", "content": "#       # prometheus_metrics_prefix - required: false  - string", "line": 38, "detection_span": [34, 42], "with_context": "# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 38\n\n     33: #       \"metrics\" => [\n     34: #         \"processor:cpu\",\n     35: #         \"memory:mem\",\n     36: #         \"io\",\n     37: #       ],\n>>>  38: #       # prometheus_metrics_prefix - required: false  - string\n     39: #       \"prometheus_metrics_prefix\" => \"<PREFIX>_\",\n     40: #       # health_service_check - required: false  - boolean\n     41: #       \"health_service_check\" => true,\n     42: #       # label_to_hostname - required: false  - string\n     43: #       \"label_to_hostname\" => \"<LABEL>\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 38\n\n     33: #       \"metrics\" => [\n     34: #         \"processor:cpu\",\n     35: #         \"memory:mem\",\n     36: #         \"io\",\n     37: #       ],\n>>>  38: #       # prometheus_metrics_prefix - required: false  - string\n     39: #       \"prometheus_metrics_prefix\" => \"<PREFIX>_\",\n     40: #       # health_service_check - required: false  - boolean\n     41: #       \"health_service_check\" => true,\n     42: #       # label_to_hostname - required: false  - string\n     43: #       \"label_to_hostname\" => \"<LABEL>\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb", "content": "#       \"prometheus_metrics_prefix\" => \"<PREFIX>_\",", "line": 39, "detection_span": [35, 43], "with_context": "# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 39\n\n     34: #         \"processor:cpu\",\n     35: #         \"memory:mem\",\n     36: #         \"io\",\n     37: #       ],\n     38: #       # prometheus_metrics_prefix - required: false  - string\n>>>  39: #       \"prometheus_metrics_prefix\" => \"<PREFIX>_\",\n     40: #       # health_service_check - required: false  - boolean\n     41: #       \"health_service_check\" => true,\n     42: #       # label_to_hostname - required: false  - string\n     43: #       \"label_to_hostname\" => \"<LABEL>\",\n     44: #       # label_joins - required: false  - object", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 39\n\n     34: #         \"processor:cpu\",\n     35: #         \"memory:mem\",\n     36: #         \"io\",\n     37: #       ],\n     38: #       # prometheus_metrics_prefix - required: false  - string\n>>>  39: #       \"prometheus_metrics_prefix\" => \"<PREFIX>_\",\n     40: #       # health_service_check - required: false  - boolean\n     41: #       \"health_service_check\" => true,\n     42: #       # label_to_hostname - required: false  - string\n     43: #       \"label_to_hostname\" => \"<LABEL>\",\n     44: #       # label_joins - required: false  - object\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb", "content": "#         \"<PREFIX_*>\",", "line": 85, "detection_span": [81, 89], "with_context": "# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 85\n\n     80: #       # bearer_token_path - required: false  - string\n     81: #       \"bearer_token_path\" => \"<TOKEN_PATH>\",\n     82: #       # ignore_metrics - required: false  - array of string\n     83: #       \"ignore_metrics\" => [\n     84: #         \"<IGNORED_METRIC_NAME>\",\n>>>  85: #         \"<PREFIX_*>\",\n     86: #         \"<*_SUFFIX>\",\n     87: #         \"<PREFIX_*_SUFFIX>\",\n     88: #         \"<*_SUBSTRING_*>\",\n     89: #       ],\n     90: #       # proxy - required: false  - object", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 85\n\n     80: #       # bearer_token_path - required: false  - string\n     81: #       \"bearer_token_path\" => \"<TOKEN_PATH>\",\n     82: #       # ignore_metrics - required: false  - array of string\n     83: #       \"ignore_metrics\" => [\n     84: #         \"<IGNORED_METRIC_NAME>\",\n>>>  85: #         \"<PREFIX_*>\",\n     86: #         \"<*_SUFFIX>\",\n     87: #         \"<PREFIX_*_SUFFIX>\",\n     88: #         \"<*_SUBSTRING_*>\",\n     89: #       ],\n     90: #       # proxy - required: false  - object\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb", "content": "#         \"<*_SUFFIX>\",", "line": 86, "detection_span": [82, 90], "with_context": "# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 86\n\n     81: #       \"bearer_token_path\" => \"<TOKEN_PATH>\",\n     82: #       # ignore_metrics - required: false  - array of string\n     83: #       \"ignore_metrics\" => [\n     84: #         \"<IGNORED_METRIC_NAME>\",\n     85: #         \"<PREFIX_*>\",\n>>>  86: #         \"<*_SUFFIX>\",\n     87: #         \"<PREFIX_*_SUFFIX>\",\n     88: #         \"<*_SUBSTRING_*>\",\n     89: #       ],\n     90: #       # proxy - required: false  - object\n     91: #       \"proxy\" => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 86\n\n     81: #       \"bearer_token_path\" => \"<TOKEN_PATH>\",\n     82: #       # ignore_metrics - required: false  - array of string\n     83: #       \"ignore_metrics\" => [\n     84: #         \"<IGNORED_METRIC_NAME>\",\n     85: #         \"<PREFIX_*>\",\n>>>  86: #         \"<*_SUFFIX>\",\n     87: #         \"<PREFIX_*_SUFFIX>\",\n     88: #         \"<*_SUBSTRING_*>\",\n     89: #       ],\n     90: #       # proxy - required: false  - object\n     91: #       \"proxy\" => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb", "content": "#         \"<PREFIX_*_SUFFIX>\",", "line": 87, "detection_span": [83, 91], "with_context": "# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 87\n\n     82: #       # ignore_metrics - required: false  - array of string\n     83: #       \"ignore_metrics\" => [\n     84: #         \"<IGNORED_METRIC_NAME>\",\n     85: #         \"<PREFIX_*>\",\n     86: #         \"<*_SUFFIX>\",\n>>>  87: #         \"<PREFIX_*_SUFFIX>\",\n     88: #         \"<*_SUBSTRING_*>\",\n     89: #       ],\n     90: #       # proxy - required: false  - object\n     91: #       \"proxy\" => {\n     92: #         \"http\" => \"http://<PROXY_SERVER_FOR_HTTP>:<PORT>\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: binary-com_chef-third-party-cookbooks-datadog-recipes-openmetrics.rb\n# Target line: 87\n\n     82: #       # ignore_metrics - required: false  - array of string\n     83: #       \"ignore_metrics\" => [\n     84: #         \"<IGNORED_METRIC_NAME>\",\n     85: #         \"<PREFIX_*>\",\n     86: #         \"<*_SUFFIX>\",\n>>>  87: #         \"<PREFIX_*_SUFFIX>\",\n     88: #         \"<*_SUBSTRING_*>\",\n     89: #       ],\n     90: #       # proxy - required: false  - object\n     91: #       \"proxy\" => {\n     92: #         \"http\" => \"http://<PROXY_SERVER_FOR_HTTP>:<PORT>\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-ganglia-cookbooks-hadoop_cluster-example-clusters-science.rb", "content": "# your cluster and not have to wait later for nodes to decommission. Obviously", "line": 10, "detection_span": [6, 14], "with_context": "# File: cookbooks_ic-ganglia-cookbooks-hadoop_cluster-example-clusters-science.rb\n# Target line: 10\n\n      5: # cluster. Storing the HDFS on persistent (EBS) volumes means we can stop the\n      6: # cluster at the end of the day (leaving the master node running) -- it only\n      7: # takes about ten minutes to bring the cluster back online.\n      8: #\n      9: # Using tasktrackers that are not datanodes means you can blow out the size of\n>>>  10: # your cluster and not have to wait later for nodes to decommission. Obviously\n     11: # their jobs will run slower-than-optimal, but we'd rather have sub-optimal\n     12: # robots than sub-optimal data scientists.\n     13: #\n     14: # You will need the role definitions from\n     15: # [ironfan-homebase](https://github.com/infochimps-labs/ironfan-homebase)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-ganglia-cookbooks-hadoop_cluster-example-clusters-science.rb\n# Target line: 10\n\n      5: # cluster. Storing the HDFS on persistent (EBS) volumes means we can stop the\n      6: # cluster at the end of the day (leaving the master node running) -- it only\n      7: # takes about ten minutes to bring the cluster back online.\n      8: #\n      9: # Using tasktrackers that are not datanodes means you can blow out the size of\n>>>  10: # your cluster and not have to wait later for nodes to decommission. Obviously\n     11: # their jobs will run slower-than-optimal, but we'd rather have sub-optimal\n     12: # robots than sub-optimal data scientists.\n     13: #\n     14: # You will need the role definitions from\n     15: # [ironfan-homebase](https://github.com/infochimps-labs/ironfan-homebase)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "cookbooks_ic-jenkins-cookbooks-zabbix-recipes-database_mysql.rb", "content": "md5        = Digest::MD5.hexdigest(node.zabbix.api.password)", "line": 129, "detection_span": [125, 133], "with_context": "# File: cookbooks_ic-jenkins-cookbooks-zabbix-recipes-database_mysql.rb\n# Target line: 129\n\n    124: ruby_block \"zabbix_ensure_super_admin_user_with_api_access\" do\n    125:   block do\n    126:     username   = node.zabbix.api.username\n    127:     first_name = 'Zabbix'\n    128:     last_name  = 'Administrator'\n>>> 129:     md5        = Digest::MD5.hexdigest(node.zabbix.api.password)\n    130:     rows       = 200\n    131:     type       = 3\n    132:     grp_name   = node.zabbix.api.user_group\n    133:     api_access = 1\n    134: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-jenkins-cookbooks-zabbix-recipes-database_mysql.rb\n# Target line: 129\n\n    124: ruby_block \"zabbix_ensure_super_admin_user_with_api_access\" do\n    125:   block do\n    126:     username   = node.zabbix.api.username\n    127:     first_name = 'Zabbix'\n    128:     last_name  = 'Administrator'\n>>> 129:     md5        = Digest::MD5.hexdigest(node.zabbix.api.password)\n    130:     rows       = 200\n    131:     type       = 3\n    132:     grp_name   = node.zabbix.api.user_group\n    133:     api_access = 1\n    134: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "cookbooks_ic-hadoop_cluster-cookbooks-zabbix-recipes-database_mysql.rb", "content": "block do", "line": 125, "detection_span": [121, 129], "with_context": "# File: cookbooks_ic-hadoop_cluster-cookbooks-zabbix-recipes-database_mysql.rb\n# Target line: 125\n\n    120: # - put the \"Admin\" user in the group\n    121: #\n    122: # The created admin user will be used by other LWRP resources in this\n    123: # cookbook.\n    124: ruby_block \"zabbix_ensure_super_admin_user_with_api_access\" do\n>>> 125:   block do\n    126:     username   = node.zabbix.api.username\n    127:     first_name = 'Zabbix'\n    128:     last_name  = 'Administrator'\n    129:     md5        = Digest::SHA2.new(512).hexdigest(node.zabbix.api.password)\n    130:     rows       = 200", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-hadoop_cluster-cookbooks-zabbix-recipes-database_mysql.rb\n# Target line: 125\n\n    120: # - put the \"Admin\" user in the group\n    121: #\n    122: # The created admin user will be used by other LWRP resources in this\n    123: # cookbook.\n    124: ruby_block \"zabbix_ensure_super_admin_user_with_api_access\" do\n>>> 125:   block do\n    126:     username   = node.zabbix.api.username\n    127:     first_name = 'Zabbix'\n    128:     last_name  = 'Administrator'\n    129:     md5        = Digest::SHA2.new(512).hexdigest(node.zabbix.api.password)\n    130:     rows       = 200\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb", "content": "default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'", "line": 14, "detection_span": [10, 18], "with_context": "# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 14\n\n      9: when 'rhel'\n     10:   case node['platform']\n     11:   when 'amazon'\n     12:     case node['platform_version'].to_i\n     13:     when 2013\n>>>  14:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     15:     when 2014\n     16:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     17:     when 2015\n     18:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     19:     when 2016", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 14\n\n      9: when 'rhel'\n     10:   case node['platform']\n     11:   when 'amazon'\n     12:     case node['platform_version'].to_i\n     13:     when 2013\n>>>  14:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     15:     when 2014\n     16:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     17:     when 2015\n     18:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     19:     when 2016\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb", "content": "default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/5/$basearch/'", "line": 26, "detection_span": [22, 30], "with_context": "# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 26\n\n     21:     end\n     22:   when 'redhat', 'oracle' # ~FC024\n     23:     case node['platform_version'].to_i\n     24:     when 5\n     25:       # Real Redhat identifies $releasever as 5Server and 6Server\n>>>  26:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/5/$basearch/'\n     27:     when 6\n     28:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     29:     when 7\n     30:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'\n     31:     end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 26\n\n     21:     end\n     22:   when 'redhat', 'oracle' # ~FC024\n     23:     case node['platform_version'].to_i\n     24:     when 5\n     25:       # Real Redhat identifies $releasever as 5Server and 6Server\n>>>  26:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/5/$basearch/'\n     27:     when 6\n     28:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     29:     when 7\n     30:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'\n     31:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb", "content": "default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'", "line": 30, "detection_span": [26, 34], "with_context": "# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 30\n\n     25:       # Real Redhat identifies $releasever as 5Server and 6Server\n     26:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/5/$basearch/'\n     27:     when 6\n     28:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     29:     when 7\n>>>  30:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'\n     31:     end\n     32:   else # other rhel\n     33:     default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'\n     34:   end\n     35: when 'fedora'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 30\n\n     25:       # Real Redhat identifies $releasever as 5Server and 6Server\n     26:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/5/$basearch/'\n     27:     when 6\n     28:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     29:     when 7\n>>>  30:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'\n     31:     end\n     32:   else # other rhel\n     33:     default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'\n     34:   end\n     35: when 'fedora'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb", "content": "default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'", "line": 33, "detection_span": [29, 37], "with_context": "# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 33\n\n     28:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     29:     when 7\n     30:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'\n     31:     end\n     32:   else # other rhel\n>>>  33:     default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'\n     34:   end\n     35: when 'fedora'\n     36:   default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/fc/$releasever/$basearch/'\n     37: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 33\n\n     28:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/'\n     29:     when 7\n     30:       default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/'\n     31:     end\n     32:   else # other rhel\n>>>  33:     default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'\n     34:   end\n     35: when 'fedora'\n     36:   default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/fc/$releasever/$basearch/'\n     37: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb", "content": "default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/fc/$releasever/$basearch/'", "line": 36, "detection_span": [32, 40], "with_context": "# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 36\n\n     31:     end\n     32:   else # other rhel\n     33:     default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'\n     34:   end\n     35: when 'fedora'\n>>>  36:   default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/fc/$releasever/$basearch/'\n     37: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql57-community.rb\n# Target line: 36\n\n     31:     end\n     32:   else # other rhel\n     33:     default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/el/$releasever/$basearch/'\n     34:   end\n     35: when 'fedora'\n>>>  36:   default['yum']['mysql57-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.7-community/fc/$releasever/$basearch/'\n     37: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "guymatz_chef-cookbooks-hive-attributes-default.rb", "content": "default[:hive][:url_pre] = \"http://cdn.mysql.com/Downloads/Connector-J/mysql-connector-java-\"", "line": 11, "detection_span": [7, 15], "with_context": "# File: guymatz_chef-cookbooks-hive-attributes-default.rb\n# Target line: 11\n\n      6: when \"debian\"\n      7:   default[:hive][:packages] = %w{ libmysql-java }\n      8: end\n      9: # http://www.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.22.tar.gz/from/http://mysql.he.net/\n     10: default[:hive][:version] = \"5.1.22\"\n>>>  11: default[:hive][:url_pre] = \"http://cdn.mysql.com/Downloads/Connector-J/mysql-connector-java-\"\n     12: \n     13: \n     14: default[:hive][:mysql_migration_script] = \"hive-schema-0.9.0.mysql.sql\"\n     15: \n     16: # MySQL stuff", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: guymatz_chef-cookbooks-hive-attributes-default.rb\n# Target line: 11\n\n      6: when \"debian\"\n      7:   default[:hive][:packages] = %w{ libmysql-java }\n      8: end\n      9: # http://www.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.22.tar.gz/from/http://mysql.he.net/\n     10: default[:hive][:version] = \"5.1.22\"\n>>>  11: default[:hive][:url_pre] = \"http://cdn.mysql.com/Downloads/Connector-J/mysql-connector-java-\"\n     12: \n     13: \n     14: default[:hive][:mysql_migration_script] = \"hive-schema-0.9.0.mysql.sql\"\n     15: \n     16: # MySQL stuff\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "guymatz_chef-cookbooks-mysql-attributes-client.rb", "content": "default['mysql']['client']['url']          = \"http://www.mysql.com/get/Downloads/Connector-C/#{mysql['client']['package_file']}/from/http://mysql.mirrors.pair.com/\"", "line": 41, "detection_span": [37, 45], "with_context": "# File: guymatz_chef-cookbooks-mysql-attributes-client.rb\n# Target line: 41\n\n     36:   default['mysql']['client']['packages'] = %w[mysql55-client]\n     37: when 'windows'\n     38:   default['mysql']['client']['version']      = '6.0.2'\n     39:   default['mysql']['client']['arch']         = 'win32' # force 32 bit to work with mysql gem\n     40:   default['mysql']['client']['package_file'] = \"mysql-connector-c-#{mysql['client']['version']}-#{mysql['client']['arch']}.msi\"\n>>>  41:   default['mysql']['client']['url']          = \"http://www.mysql.com/get/Downloads/Connector-C/#{mysql['client']['package_file']}/from/http://mysql.mirrors.pair.com/\"\n     42:   default['mysql']['client']['packages']     = [\"MySQL Connector C #{mysql['client']['version']}\"]\n     43: \n     44:   default['mysql']['client']['basedir']      = \"#{ENV['SYSTEMDRIVE']}\\\\Program Files (x86)\\\\MySQL\\\\#{mysql['client']['packages'].first}\"\n     45:   default['mysql']['client']['lib_dir']      = \"#{mysql['client']['basedir']}\\\\lib/opt\"\n     46:   default['mysql']['client']['bin_dir']      = \"#{mysql['client']['basedir']}\\\\bin\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: guymatz_chef-cookbooks-mysql-attributes-client.rb\n# Target line: 41\n\n     36:   default['mysql']['client']['packages'] = %w[mysql55-client]\n     37: when 'windows'\n     38:   default['mysql']['client']['version']      = '6.0.2'\n     39:   default['mysql']['client']['arch']         = 'win32' # force 32 bit to work with mysql gem\n     40:   default['mysql']['client']['package_file'] = \"mysql-connector-c-#{mysql['client']['version']}-#{mysql['client']['arch']}.msi\"\n>>>  41:   default['mysql']['client']['url']          = \"http://www.mysql.com/get/Downloads/Connector-C/#{mysql['client']['package_file']}/from/http://mysql.mirrors.pair.com/\"\n     42:   default['mysql']['client']['packages']     = [\"MySQL Connector C #{mysql['client']['version']}\"]\n     43: \n     44:   default['mysql']['client']['basedir']      = \"#{ENV['SYSTEMDRIVE']}\\\\Program Files (x86)\\\\MySQL\\\\#{mysql['client']['packages'].first}\"\n     45:   default['mysql']['client']['lib_dir']      = \"#{mysql['client']['basedir']}\\\\lib/opt\"\n     46:   default['mysql']['client']['bin_dir']      = \"#{mysql['client']['basedir']}\\\\bin\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb", "content": "default[:mongodb][:source]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-#{node[:kernel][:machine]}-#{mongodb[:version]}.tgz\"", "line": 3, "detection_span": [1, 7], "with_context": "# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 3\n\n      1: ### SOURCE PACKAGES\n      2: default[:mongodb][:version]           = \"1.8.0\"\n>>>   3: default[:mongodb][:source]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-#{node[:kernel][:machine]}-#{mongodb[:version]}.tgz\"\n      4: default[:mongodb][:i686][:checksum]   = \"b0b4d98968960cc90d2900ab0135bc24\"\n      5: default[:mongodb][:x86_64][:checksum] = \"d764d869f2a3984251cfea5335cc6c53\"\n      6: \n      7: user = (node.platform == 'centos' ? 'mongod' : 'mongodb')\n      8: default[:mongodb][:user]        = user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: cookbooks_ic-volumes_ebs-cookbooks-mongodb-attributes-mongodb.rb\n# Target line: 3\n\n      1: ### SOURCE PACKAGES\n      2: default[:mongodb][:version]           = \"1.8.0\"\n>>>   3: default[:mongodb][:source]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-#{node[:kernel][:machine]}-#{mongodb[:version]}.tgz\"\n      4: default[:mongodb][:i686][:checksum]   = \"b0b4d98968960cc90d2900ab0135bc24\"\n      5: default[:mongodb][:x86_64][:checksum] = \"d764d869f2a3984251cfea5335cc6c53\"\n      6: \n      7: user = (node.platform == 'centos' ? 'mongod' : 'mongodb')\n      8: default[:mongodb][:user]        = user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "kitchenplan_chef-applications-recipes-omnigraffle.rb", "content": "source \"http://media.konigi.com/tools/og-ux-template/Konigi-UX-Template-2-5-1.gtemplate.zip\"", "line": 16, "detection_span": [12, 20], "with_context": "# File: kitchenplan_chef-applications-recipes-omnigraffle.rb\n# Target line: 16\n\n     11:                 action :create\n     12:                 recursive true\n     13:             end\n     14: \n     15:             remote_file \"#{Chef::Config[:file_cache_path]}/Konigi-UX-Template-2-5-1.gtemplate.zip\" do\n>>>  16:                 source \"http://media.konigi.com/tools/og-ux-template/Konigi-UX-Template-2-5-1.gtemplate.zip\"\n     17:                 owner node['current_user']\n     18:             end\n     19: \n     20:             execute \"unzip Konigi-UX-Template-2-5-1.gtemplate.zip\" do\n     21:                 command \"unzip #{Chef::Config[:file_cache_path]}/Konigi-UX-Template-2-5-1.gtemplate.zip -d #{Chef::Config[:file_cache_path]}/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: kitchenplan_chef-applications-recipes-omnigraffle.rb\n# Target line: 16\n\n     11:                 action :create\n     12:                 recursive true\n     13:             end\n     14: \n     15:             remote_file \"#{Chef::Config[:file_cache_path]}/Konigi-UX-Template-2-5-1.gtemplate.zip\" do\n>>>  16:                 source \"http://media.konigi.com/tools/og-ux-template/Konigi-UX-Template-2-5-1.gtemplate.zip\"\n     17:                 owner node['current_user']\n     18:             end\n     19: \n     20:             execute \"unzip Konigi-UX-Template-2-5-1.gtemplate.zip\" do\n     21:                 command \"unzip #{Chef::Config[:file_cache_path]}/Konigi-UX-Template-2-5-1.gtemplate.zip -d #{Chef::Config[:file_cache_path]}/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "kitchenplan_chef-applications-recipes-omnigraffle.rb", "content": "source \"http://media.konigi.com/tools/og-ux-template/Konigi.gdiagramstyle.zip\"", "line": 41, "detection_span": [37, 45], "with_context": "# File: kitchenplan_chef-applications-recipes-omnigraffle.rb\n# Target line: 41\n\n     36:                 action :create\n     37:                 recursive true\n     38:             end\n     39: \n     40:             remote_file \"#{Chef::Config[:file_cache_path]}/Konigi.gdiagramstyle.zip\" do\n>>>  41:                 source \"http://media.konigi.com/tools/og-ux-template/Konigi.gdiagramstyle.zip\"\n     42:                 owner node['current_user']\n     43:             end\n     44: \n     45:             execute \"unzip Konigi.gdiagramstyle.zip\" do\n     46:                 command \"unzip #{Chef::Config[:file_cache_path]}/Konigi.gdiagramstyle.zip -d #{Chef::Config[:file_cache_path]}/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: kitchenplan_chef-applications-recipes-omnigraffle.rb\n# Target line: 41\n\n     36:                 action :create\n     37:                 recursive true\n     38:             end\n     39: \n     40:             remote_file \"#{Chef::Config[:file_cache_path]}/Konigi.gdiagramstyle.zip\" do\n>>>  41:                 source \"http://media.konigi.com/tools/og-ux-template/Konigi.gdiagramstyle.zip\"\n     42:                 owner node['current_user']\n     43:             end\n     44: \n     45:             execute \"unzip Konigi.gdiagramstyle.zip\" do\n     46:                 command \"unzip #{Chef::Config[:file_cache_path]}/Konigi.gdiagramstyle.zip -d #{Chef::Config[:file_cache_path]}/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "kitchenplan_chef-applications-recipes-omnigraffle.rb", "content": "source \"http://media.konigi.com/tools/og-wireframe-stencil/Konigi-Wireframe-Stencils-v3-02.zip\"", "line": 66, "detection_span": [62, 70], "with_context": "# File: kitchenplan_chef-applications-recipes-omnigraffle.rb\n# Target line: 66\n\n     61:                 action :create\n     62:                 recursive true\n     63:             end\n     64: \n     65:             remote_file \"#{Chef::Config[:file_cache_path]}/Konigi-Wireframe-Stencils-v3-02.zip\" do\n>>>  66:                 source \"http://media.konigi.com/tools/og-wireframe-stencil/Konigi-Wireframe-Stencils-v3-02.zip\"\n     67:                 owner node['current_user']\n     68:             end\n     69: \n     70:             execute \"unzip Konigi-Wireframe-Stencils-v3-02.zip\" do\n     71:                 command \"unzip #{Chef::Config[:file_cache_path]}/Konigi-Wireframe-Stencils-v3-02.zip -d #{Chef::Config[:file_cache_path]}/\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# File: kitchenplan_chef-applications-recipes-omnigraffle.rb\n# Target line: 66\n\n     61:                 action :create\n     62:                 recursive true\n     63:             end\n     64: \n     65:             remote_file \"#{Chef::Config[:file_cache_path]}/Konigi-Wireframe-Stencils-v3-02.zip\" do\n>>>  66:                 source \"http://media.konigi.com/tools/og-wireframe-stencil/Konigi-Wireframe-Stencils-v3-02.zip\"\n     67:                 owner node['current_user']\n     68:             end\n     69: \n     70:             execute \"unzip Konigi-Wireframe-Stencils-v3-02.zip\" do\n     71:                 command \"unzip #{Chef::Config[:file_cache_path]}/Konigi-Wireframe-Stencils-v3-02.zip -d #{Chef::Config[:file_cache_path]}/\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-felisialoukou.pp", "content": "ssh_key  => [", "line": 5, "detection_span": [3, 7], "with_context": "# File: alphagov@govuk-puppet-modules-users-manifests-felisialoukou.pp\n# Target line: 5\n\n      1: # Creates the felisialoukou user\n      2: class users::felisialoukou { govuk_user { 'felisialoukou':\n      3:     fullname => 'Felisia Loukou',\n      4:     email    => 'felisia.loukou@digital.cabinet-office.gov.uk',\n>>>   5:     ssh_key  => [\n      6:         'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlxJNWiWOVbtSwe5DNNzN8csunIvCX6XUIAT141EjGZpOaEjK3yFtvv96OukdWTXPQXnWBDOIWg+fNJWc4LsfqnCV5CrHftykTqHeKakEcVX2aW5UrWvlOWHoTdkbFv+L67MaT2xIT/KWLYPliyZJOmwwF+W1kiFq3xVtI5qgMha7s2I3thuBo8lgLXsmxdVcYoa32MBKabNyknvZaF/l2l/D/wssbC/3N5zeLupJJXDRA4BWw6nqAW97AOceVH04twCG6+B5qL/M56D/YW8kMIx/XSSIAde4+yXCX0gLr5p4L6pNvD2vn/nJSY/rMDtO5rPX+XQjmM7eti50FvkflvGzuaUoSXb1sP+rwOtGMVQBn4pnB1whd8jZSQC+SRsXAgj7TgQfKLux/T00cq+pC09HrBPLag1TUcueJE65FM6mi2uyi+sYYOnVfr4ZhgiEBY+uFoOWl/TwnKuIAXXXD4aL9BXpOTdy3XxxEwHeobfv2AOa8QH8rGQXuXExTjaMXQEbQ6rnhUEmccu1fSTZt4rEUlv2a61Bp2XKcjvKNodNHqQwFXWbX+qmKpGTurPQZG9wqJzejUer1YYSuraxezQtSpM0ZREFhIQMSA5F137bCPVwLanJ3A/XN+1aEwjynrDALOmYOyJw/eblYCUX84At55tbDt+XdmIXiVeg0eQ== felisia.loukou@digital.cabinet-office.gov.uk',\n      7:     ],\n      8:   }\n      9: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-users-manifests-felisialoukou.pp\n# Target line: 5\n\n      1: # Creates the felisialoukou user\n      2: class users::felisialoukou { govuk_user { 'felisialoukou':\n      3:     fullname => 'Felisia Loukou',\n      4:     email    => 'felisia.loukou@digital.cabinet-office.gov.uk',\n>>>   5:     ssh_key  => [\n      6:         'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlxJNWiWOVbtSwe5DNNzN8csunIvCX6XUIAT141EjGZpOaEjK3yFtvv96OukdWTXPQXnWBDOIWg+fNJWc4LsfqnCV5CrHftykTqHeKakEcVX2aW5UrWvlOWHoTdkbFv+L67MaT2xIT/KWLYPliyZJOmwwF+W1kiFq3xVtI5qgMha7s2I3thuBo8lgLXsmxdVcYoa32MBKabNyknvZaF/l2l/D/wssbC/3N5zeLupJJXDRA4BWw6nqAW97AOceVH04twCG6+B5qL/M56D/YW8kMIx/XSSIAde4+yXCX0gLr5p4L6pNvD2vn/nJSY/rMDtO5rPX+XQjmM7eti50FvkflvGzuaUoSXb1sP+rwOtGMVQBn4pnB1whd8jZSQC+SRsXAgj7TgQfKLux/T00cq+pC09HrBPLag1TUcueJE65FM6mi2uyi+sYYOnVfr4ZhgiEBY+uFoOWl/TwnKuIAXXXD4aL9BXpOTdy3XxxEwHeobfv2AOa8QH8rGQXuXExTjaMXQEbQ6rnhUEmccu1fSTZt4rEUlv2a61Bp2XKcjvKNodNHqQwFXWbX+qmKpGTurPQZG9wqJzejUer1YYSuraxezQtSpM0ZREFhIQMSA5F137bCPVwLanJ3A/XN+1aEwjynrDALOmYOyJw/eblYCUX84At55tbDt+XdmIXiVeg0eQ== felisia.loukou@digital.cabinet-office.gov.uk',\n      7:     ],\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp", "content": "root_password => 'strongpassword',", "line": 9, "detection_span": [7, 11], "with_context": "# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 9\n\n      4: \n      5:   include ::java\n      6:   include ::git\n      7: \n      8:   class { '::mysql::server':\n>>>   9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n     14:     password => 'password',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 9\n\n      4: \n      5:   include ::java\n      6:   include ::git\n      7: \n      8:   class { '::mysql::server':\n>>>   9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n     14:     password => 'password',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp", "content": "user     => 'bitbucket',", "line": 13, "detection_span": [11, 15], "with_context": "# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 13\n\n      8:   class { '::mysql::server':\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n>>>  13:     user     => 'bitbucket',\n     14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 13\n\n      8:   class { '::mysql::server':\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n>>>  13:     user     => 'bitbucket',\n     14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp", "content": "password => 'password',", "line": 14, "detection_span": [12, 16], "with_context": "# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 14\n\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n>>>  14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: \n     19:   class { '::bitbucket':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: danofthewired@puppet-bitbucket-examples-bitbucket_mysql_java_install.pp\n# Target line: 14\n\n      9:     root_password => 'strongpassword',\n     10:   } ->\n     11: \n     12:   mysql::db { 'bitbucket':\n     13:     user     => 'bitbucket',\n>>>  14:     password => 'password',\n     15:     host     => 'localhost',\n     16:     grant    => ['ALL'],\n     17:   } ->\n     18: \n     19:   class { '::bitbucket':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "password => 'an_even_bigger_secret',", "line": 11, "detection_span": [9, 13], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 11\n\n      6:   include ::openstack_integration::config\n      7:   include ::openstack_integration::params\n      8:   include ::openstack_integration::bind\n      9: \n     10:   openstack_integration::mq_user { 'designate':\n>>>  11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n     16:     password => 'designate',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 11\n\n      6:   include ::openstack_integration::config\n      7:   include ::openstack_integration::params\n      8:   include ::openstack_integration::bind\n      9: \n     10:   openstack_integration::mq_user { 'designate':\n>>>  11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n     16:     password => 'designate',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "password => 'designate',", "line": 16, "detection_span": [14, 18], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 16\n\n     11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n>>>  16:     password => 'designate',\n     17:   }\n     18:   class { '::designate::logging':\n     19:     debug => true,\n     20:   }\n     21:   class { '::designate':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 16\n\n     11:     password => 'an_even_bigger_secret',\n     12:     before   => Anchor['designate::service::begin'],\n     13:   }\n     14: \n     15:   class { '::designate::db::mysql':\n>>>  16:     password => 'designate',\n     17:   }\n     18:   class { '::designate::logging':\n     19:     debug => true,\n     20:   }\n     21:   class { '::designate':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "password     => 'a_big_secret',", "line": 39, "detection_span": [37, 41], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 39\n\n     34: \n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n>>>  39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 39\n\n     34: \n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n>>>  39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-rabbitmq-examples-permissions-add.pp", "content": "password => 'foo',", "line": 2, "detection_span": [0, 4], "with_context": "# File: voxpupuli@puppet-rabbitmq-examples-permissions-add.pp\n# Target line: 2\n\n      1: rabbitmq_user { 'blah7':\n>>>   2:   password => 'foo',\n      3: }\n      4: rabbitmq_vhost { 'test5': }\n      5: rabbitmq_user_permissions { 'blah7@test5':\n      6:   configure_permission => 'config2',\n      7:   read_permission      => 'ready',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-rabbitmq-examples-permissions-add.pp\n# Target line: 2\n\n      1: rabbitmq_user { 'blah7':\n>>>   2:   password => 'foo',\n      3: }\n      4: rabbitmq_vhost { 'test5': }\n      5: rabbitmq_user_permissions { 'blah7@test5':\n      6:   configure_permission => 'config2',\n      7:   read_permission      => 'ready',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "hard_coded_secret", "file": "Automattic@vip-quickstart-puppet-manifests-sections-mail.pp", "content": "user    => root,", "line": 7, "detection_span": [5, 9], "with_context": "# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 7\n\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',\n>>>   7:     user    => root,\n      8:     notify  => Service['postfix']\n      9: }\n     10: \n     11: # Mailtuils for sending diagnostic reports\n     12: package { 'mailutils': ensure => installed }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 7\n\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',\n>>>   7:     user    => root,\n      8:     notify  => Service['postfix']\n      9: }\n     10: \n     11: # Mailtuils for sending diagnostic reports\n     12: package { 'mailutils': ensure => installed }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp", "content": "key => 'bind',", "line": 166, "detection_span": [164, 168], "with_context": "# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 166\n\n    161:       'DEFAULTS/collectors'         : value => $collector_ip_port_list;\n    162:       'API_SERVER/api_server_list'  : value => $api_server_list;\n    163:     } ->\n    164: \n    165:     contrail::lib::augeas_conf_rm { \"remove_bind\":\n>>> 166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n    171:                 key => 'save',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 166\n\n    161:       'DEFAULTS/collectors'         : value => $collector_ip_port_list;\n    162:       'API_SERVER/api_server_list'  : value => $api_server_list;\n    163:     } ->\n    164: \n    165:     contrail::lib::augeas_conf_rm { \"remove_bind\":\n>>> 166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n    171:                 key => 'save',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp", "content": "key => 'save',", "line": 171, "detection_span": [169, 173], "with_context": "# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 171\n\n    166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n>>> 171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n    176:                 key => 'dbfilename',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 171\n\n    166:                 key => 'bind',\n    167:                 config_file => $redis_config_file,\n    168:                 lens_to_use => $redis_augeas_lens_to_use,\n    169:     } ->\n    170:     contrail::lib::augeas_conf_rm { \"remove_save\":\n>>> 171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n    176:                 key => 'dbfilename',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp", "content": "key => 'dbfilename',", "line": 176, "detection_span": [174, 178], "with_context": "# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 176\n\n    171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n>>> 176:                 key => 'dbfilename',\n    177:                 config_file => $redis_config_file,\n    178:                 lens_to_use => $redis_augeas_lens_to_use,\n    179:     } ->\n    180: \n    181:     file { '/etc/snmp':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-collector-config.pp\n# Target line: 176\n\n    171:                 key => 'save',\n    172:                 config_file => $redis_config_file,\n    173:                 lens_to_use => $redis_augeas_lens_to_use,\n    174:     } ->\n    175:     contrail::lib::augeas_conf_rm { \"remove_dbfilename\":\n>>> 176:                 key => 'dbfilename',\n    177:                 config_file => $redis_config_file,\n    178:                 lens_to_use => $redis_augeas_lens_to_use,\n    179:     } ->\n    180: \n    181:     file { '/etc/snmp':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp", "content": "$backupuser         = '',", "line": 3, "detection_span": [1, 5], "with_context": "# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 3\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n>>>   3:   $backupuser         = '',\n      4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 3\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n>>>   3:   $backupuser         = '',\n      4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp", "content": "$backuppassword     = '',", "line": 4, "detection_span": [2, 6], "with_context": "# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 4\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n      3:   $backupuser         = '',\n>>>   4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',\n      9:   $backupdirgroup     = $mysql::params::root_group,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 4\n\n      1: # See README.me for usage.\n      2: class mysql::backup::xtrabackup (\n      3:   $backupuser         = '',\n>>>   4:   $backuppassword     = '',\n      5:   $backupdir          = '',\n      6:   $backupmethod       = 'mysqldump',\n      7:   $backupdirmode      = '0700',\n      8:   $backupdirowner     = 'root',\n      9:   $backupdirgroup     = $mysql::params::root_group,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp", "content": "user    => 'root',", "line": 32, "detection_span": [30, 34], "with_context": "# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 32\n\n     27:   }\n     28: \n     29:   cron { 'xtrabackup-weekly':\n     30:     ensure  => $ensure,\n     31:     command => \"/usr/local/sbin/xtrabackup.sh ${backupdir}\",\n>>>  32:     user    => 'root',\n     33:     hour    => $time[0],\n     34:     minute  => $time[1],\n     35:     weekday => '0',\n     36:     require => Package['percona-xtrabackup'],\n     37:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-database-mysql-manifests-backup-xtrabackup.pp\n# Target line: 32\n\n     27:   }\n     28: \n     29:   cron { 'xtrabackup-weekly':\n     30:     ensure  => $ensure,\n     31:     command => \"/usr/local/sbin/xtrabackup.sh ${backupdir}\",\n>>>  32:     user    => 'root',\n     33:     hour    => $time[0],\n     34:     minute  => $time[1],\n     35:     weekday => '0',\n     36:     require => Package['percona-xtrabackup'],\n     37:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "/^(6|7)\\..*/: { $seluser = 'unconfined_u' }", "line": 67, "detection_span": [65, 69], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 67\n\n     62:   # Redhat 7 selinux user context for /etc/sysconfig/iptables is set to unconfined_u\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n>>>  67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 67\n\n     62:   # Redhat 7 selinux user context for /etc/sysconfig/iptables is set to unconfined_u\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n>>>  67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "default: { $seluser = 'system_u' }", "line": 68, "detection_span": [66, 70], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 68\n\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n>>>  68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }\n     73:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 68\n\n     63:   case $::selinux {\n     64:     #lint:ignore:quoted_booleans\n     65:     'true',true: {\n     66:       case $::operatingsystemrelease {\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n>>>  68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n     72:     default:     { $seluser = undef }\n     73:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "default:     { $seluser = undef }", "line": 72, "detection_span": [70, 74], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 72\n\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n>>>  72:     default:     { $seluser = undef }\n     73:   }\n     74: \n     75:   file { \"/etc/sysconfig/${service_name}\":\n     76:     ensure  => present,\n     77:     owner   => 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 72\n\n     67:         /^(6|7)\\..*/: { $seluser = 'unconfined_u' }\n     68:         default: { $seluser = 'system_u' }\n     69:       }\n     70:     }\n     71:     #lint:endignore\n>>>  72:     default:     { $seluser = undef }\n     73:   }\n     74: \n     75:   file { \"/etc/sysconfig/${service_name}\":\n     76:     ensure  => present,\n     77:     owner   => 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-apt-manifests-backports.pp", "content": "key_server => 'pgp.mit.edu',", "line": 45, "detection_span": [43, 47], "with_context": "# File: Vizir@carnival-vagrant-modules-apt-manifests-backports.pp\n# Target line: 45\n\n     40:   apt::source { 'backports':\n     41:     location   => $location,\n     42:     release    => \"${release_real}-backports\",\n     43:     repos      => $repos,\n     44:     key        => $key,\n>>>  45:     key_server => 'pgp.mit.edu',\n     46:     pin        => '200',\n     47:   }\n     48: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Vizir@carnival-vagrant-modules-apt-manifests-backports.pp\n# Target line: 45\n\n     40:   apt::source { 'backports':\n     41:     location   => $location,\n     42:     release    => \"${release_real}-backports\",\n     43:     repos      => $repos,\n     44:     key        => $key,\n>>>  45:     key_server => 'pgp.mit.edu',\n     46:     pin        => '200',\n     47:   }\n     48: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_elasticsearch-manifests-dump.pp", "content": "user    => 'elasticsearch',", "line": 31, "detection_span": [29, 33], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_elasticsearch-manifests-dump.pp\n# Target line: 31\n\n     26:     mode   => '0755',\n     27:   }\n     28: \n     29:   cron { 'dump-elasticsearch-indexes':\n     30:     command => '/usr/bin/es_dump http://localhost:9200 /var/es_dump',\n>>>  31:     user    => 'elasticsearch',\n     32:     require => [\n     33:       File['/var/es_dump'],\n     34:       File['/usr/bin/es_dump'],\n     35:     ],\n     36:     hour    => $run_es_dump_hour,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_elasticsearch-manifests-dump.pp\n# Target line: 31\n\n     26:     mode   => '0755',\n     27:   }\n     28: \n     29:   cron { 'dump-elasticsearch-indexes':\n     30:     command => '/usr/bin/es_dump http://localhost:9200 /var/es_dump',\n>>>  31:     user    => 'elasticsearch',\n     32:     require => [\n     33:       File['/var/es_dump'],\n     34:       File['/usr/bin/es_dump'],\n     35:     ],\n     36:     hour    => $run_es_dump_hour,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-scrape_icinga_alerts_for_dashboard_metrics.pp", "content": "$slack_auth_token = undef,", "line": 34, "detection_span": [32, 36], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-scrape_icinga_alerts_for_dashboard_metrics.pp\n# Target line: 34\n\n     29:   $private_key = undef,\n     30:   $client_email = undef,\n     31:   $client_id = undef,\n     32:   $client_x509_cert_url = undef,\n     33:   $enable_slack_notifications = true,\n>>>  34:   $slack_auth_token = undef,\n     35:   $run_monthly = false,\n     36:   $app_domain = hiera('app_domain'),\n     37: ) {\n     38: \n     39:   $slack_team_domain = 'gds'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-scrape_icinga_alerts_for_dashboard_metrics.pp\n# Target line: 34\n\n     29:   $private_key = undef,\n     30:   $client_email = undef,\n     31:   $client_id = undef,\n     32:   $client_x509_cert_url = undef,\n     33:   $enable_slack_notifications = true,\n>>>  34:   $slack_auth_token = undef,\n     35:   $run_monthly = false,\n     36:   $app_domain = hiera('app_domain'),\n     37: ) {\n     38: \n     39:   $slack_team_domain = 'gds'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_mysql-manifests-server.pp", "content": "$root_password=undef,", "line": 48, "detection_span": [46, 50], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_mysql-manifests-server.pp\n# Target line: 48\n\n     43: #\n     44: # [*innodb_buffer_pool_size_proportion*]\n     45: #   The proportion of machine memory used by the innodb buffer.\n     46: #\n     47: class govuk_mysql::server (\n>>>  48:   $root_password=undef,\n     49:   $tmp_table_size='128M',\n     50:   $max_heap_table_size='128M',\n     51:   $innodb_file_per_table=true,\n     52:   $key_buffer_size='16M',\n     53:   $query_cache_limit='1M',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_mysql-manifests-server.pp\n# Target line: 48\n\n     43: #\n     44: # [*innodb_buffer_pool_size_proportion*]\n     45: #   The proportion of machine memory used by the innodb buffer.\n     46: #\n     47: class govuk_mysql::server (\n>>>  48:   $root_password=undef,\n     49:   $tmp_table_size='128M',\n     50:   $max_heap_table_size='128M',\n     51:   $innodb_file_per_table=true,\n     52:   $key_buffer_size='16M',\n     53:   $query_cache_limit='1M',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp", "content": "superuser     => true,", "line": 14, "detection_span": [12, 16], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 14\n\n      9: #\n     10: class govuk_postgresql::env_sync_user (\n     11:   $password\n     12: ) {\n     13:   @postgresql::server::role { 'env-sync':\n>>>  14:     superuser     => true,\n     15:     password_hash => postgresql_password('env-sync', $password),\n     16:     tag           => 'govuk_postgresql::server::not_slave',\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 14\n\n      9: #\n     10: class govuk_postgresql::env_sync_user (\n     11:   $password\n     12: ) {\n     13:   @postgresql::server::role { 'env-sync':\n>>>  14:     superuser     => true,\n     15:     password_hash => postgresql_password('env-sync', $password),\n     16:     tag           => 'govuk_postgresql::server::not_slave',\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp", "content": "user        => 'env-sync',", "line": 22, "detection_span": [20, 24], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 22\n\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n>>>  22:     user        => 'env-sync',\n     23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 22\n\n     17:   }\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n>>>  22:     user        => 'env-sync',\n     23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp", "content": "key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',", "line": 21, "detection_span": [19, 23], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 21\n\n     16: \n     17:   apt::source { 'rbenv-ruby':\n     18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n>>>  21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: \n     24:   $ruby_versions = [\n     25:     '2.4.4',\n     26:     '2.4.5',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 21\n\n     16: \n     17:   apt::source { 'rbenv-ruby':\n     18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n>>>  21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: \n     24:   $ruby_versions = [\n     25:     '2.4.4',\n     26:     '2.4.5',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-mysql-manifests-server-instance.pp", "content": "define mysql::server::instance ($root_password = '', $debian_sys_maint_password = '') {", "line": 1, "detection_span": [-1, 3], "with_context": "# File: cargomedia@puppet-packages-modules-mysql-manifests-server-instance.pp\n# Target line: 1\n\n>>>   1: define mysql::server::instance ($root_password = '', $debian_sys_maint_password = '') {\n      2: \n      3:   class { 'mysql::server':\n      4:     root_password             => $root_password,\n      5:     debian_sys_maint_password => $debian_sys_maint_password,\n      6:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: cargomedia@puppet-packages-modules-mysql-manifests-server-instance.pp\n# Target line: 1\n\n>>>   1: define mysql::server::instance ($root_password = '', $debian_sys_maint_password = '') {\n      2: \n      3:   class { 'mysql::server':\n      4:     root_password             => $root_password,\n      5:     debian_sys_maint_password => $debian_sys_maint_password,\n      6:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$nexus_root                    = '/srv'", "line": 29, "detection_span": [27, 31], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 29\n\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n     28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n>>>  29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n     34:   $nexus_user                    = 'nexus'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 29\n\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n     28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n>>>  29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n     34:   $nexus_user                    = 'nexus'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$nexus_user                    = 'nexus'", "line": 34, "detection_span": [32, 36], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 34\n\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n>>>  34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 34\n\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n>>>  34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$nexus_manage_user             = true", "line": 39, "detection_span": [37, 41], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 39\n\n     34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n>>>  39:   $nexus_manage_user             = true\n     40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 39\n\n     34:   $nexus_user                    = 'nexus'\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n>>>  39:   $nexus_manage_user             = true\n     40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$mysql_root_user     = pick($mysql_hash['root_user'], 'root')", "line": 9, "detection_span": [7, 11], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 9\n\n      4: \n      5:   $ironic_hash    = hiera_hash('ironic', {})\n      6:   $mysql_hash     = hiera_hash('mysql', {})\n      7:   $database_vip   = hiera('database_vip')\n      8: \n>>>   9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 9\n\n      4: \n      5:   $ironic_hash    = hiera_hash('ironic', {})\n      6:   $mysql_hash     = hiera_hash('mysql', {})\n      7:   $database_vip   = hiera('database_vip')\n      8: \n>>>   9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_user     = pick($ironic_hash['db_user'], 'ironic')", "line": 13, "detection_span": [11, 15], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 13\n\n      8: \n      9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n>>>  13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 13\n\n      8: \n      9:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n>>>  13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_password = pick($ironic_hash['db_password'], $mysql_root_password)", "line": 15, "detection_span": [13, 17], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 15\n\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n>>>  15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 15\n\n     10:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     11:   $mysql_root_password = $mysql_hash['root_password']\n     12: \n     13:   $db_user     = pick($ironic_hash['db_user'], 'ironic')\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n>>>  15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)", "line": 19, "detection_span": [17, 21], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 19\n\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n>>>  19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 19\n\n     14:   $db_name     = pick($ironic_hash['db_name'], 'ironic')\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n>>>  19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n     20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp", "content": "$db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)", "line": 20, "detection_span": [18, 22], "with_context": "# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 20\n\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n>>>  20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)\n     25:   validate_string($database_vip)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ironic-db.pp\n# Target line: 20\n\n     15:   $db_password = pick($ironic_hash['db_password'], $mysql_root_password)\n     16: \n     17:   $db_host          = pick($ironic_hash['db_host'], $database_vip)\n     18:   $db_create        = pick($ironic_hash['db_create'], $mysql_db_create)\n     19:   $db_root_user     = pick($ironic_hash['root_user'], $mysql_root_user)\n>>>  20:   $db_root_password = pick($ironic_hash['root_password'], $mysql_root_password)\n     21: \n     22:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     23: \n     24:   validate_string($mysql_root_user)\n     25:   validate_string($database_vip)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp", "content": "$permit_root    = undef,", "line": 40, "detection_span": [38, 42], "with_context": "# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 40\n\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n>>>  40:   $permit_root    = undef,\n     41:   $listen_address = [],\n     42:   $accept_env     = 'LANG LC_*',\n     43: ){\n     44: \n     45:   case $::osfamily {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 40\n\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n>>>  40:   $permit_root    = undef,\n     41:   $listen_address = [],\n     42:   $accept_env     = 'LANG LC_*',\n     43: ){\n     44: \n     45:   case $::osfamily {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-server-placement.pp", "content": "$username            = 'nova',", "line": 71, "detection_span": [69, 73], "with_context": "# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 71\n\n     66: #\n     67: \n     68: class neutron::server::placement (\n     69:   $password,\n     70:   $auth_type           = 'password',\n>>>  71:   $username            = 'nova',\n     72:   $project_domain_id   = 'default',\n     73:   $project_domain_name = 'Default',\n     74:   $project_name        = 'services',\n     75:   $user_domain_id      = 'default',\n     76:   $user_domain_name    = 'Default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 71\n\n     66: #\n     67: \n     68: class neutron::server::placement (\n     69:   $password,\n     70:   $auth_type           = 'password',\n>>>  71:   $username            = 'nova',\n     72:   $project_domain_id   = 'default',\n     73:   $project_domain_name = 'Default',\n     74:   $project_name        = 'services',\n     75:   $user_domain_id      = 'default',\n     76:   $user_domain_name    = 'Default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-server-placement.pp", "content": "'placement/password':            value => $password, secret => true;", "line": 87, "detection_span": [85, 89], "with_context": "# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 87\n\n     82:   include ::neutron::deps\n     83: \n     84:   neutron_config {\n     85:     'placement/auth_url':            value => $auth_url;\n     86:     'placement/username':            value => $username;\n>>>  87:     'placement/password':            value => $password, secret => true;\n     88:     'placement/project_domain_id':   value => $project_domain_id;\n     89:     'placement/project_domain_name': value => $project_domain_name;\n     90:     'placement/project_name':        value => $project_name;\n     91:     'placement/user_domain_id':      value => $user_domain_id;\n     92:     'placement/user_domain_name':    value => $user_domain_name;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-neutron-manifests-server-placement.pp\n# Target line: 87\n\n     82:   include ::neutron::deps\n     83: \n     84:   neutron_config {\n     85:     'placement/auth_url':            value => $auth_url;\n     86:     'placement/username':            value => $username;\n>>>  87:     'placement/password':            value => $password, secret => true;\n     88:     'placement/project_domain_id':   value => $project_domain_id;\n     89:     'placement/project_domain_name': value => $project_domain_name;\n     90:     'placement/project_name':        value => $project_name;\n     91:     'placement/user_domain_id':      value => $user_domain_id;\n     92:     'placement/user_domain_name':    value => $user_domain_name;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "enable_api_admin => true", "line": 58, "detection_span": [56, 60], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 58\n\n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n     55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n>>>  58:     enable_api_admin => true\n     59:   }\n     60: \n     61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 58\n\n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n     55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n>>>  58:     enable_api_admin => true\n     59:   }\n     60: \n     61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "puphpet@puppet-puphpet-manifests-nginx-params.pp", "content": "$webroot_user  = 'www-data'", "line": 5, "detection_span": [3, 7], "with_context": "# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 5\n\n      1: class puphpet::nginx::params\n      2:   inherits ::puphpet::params\n      3: {\n      4: \n>>>   5:   $webroot_user  = 'www-data'\n      6:   $webroot_group = 'www-data'\n      7: \n      8:   $www_location     = '/var/www'\n      9:   $webroot_location = '/var/www/html'\n     10: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 5\n\n      1: class puphpet::nginx::params\n      2:   inherits ::puphpet::params\n      3: {\n      4: \n>>>   5:   $webroot_user  = 'www-data'\n      6:   $webroot_group = 'www-data'\n      7: \n      8:   $www_location     = '/var/www'\n      9:   $webroot_location = '/var/www/html'\n     10: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "$password = '',\t# global vrrp password to use", "line": 26, "detection_span": [24, 28], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 26\n\n     21: \t$replica = 1,\n     22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n>>>  26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',\n     28: \t$repo = true,\n     29: \t$count = 0,\t# 0 means build 1 brick, unless $brick_params exists...\n     30: \t$brick_params = {},\t# this sets the brick count when $count is 0...\n     31: \t$brick_param_defaults = {},\t# these always get used to build bricks", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 26\n\n     21: \t$replica = 1,\n     22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n>>>  26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',\n     28: \t$repo = true,\n     29: \t$count = 0,\t# 0 means build 1 brick, unless $brick_params exists...\n     30: \t$brick_params = {},\t# this sets the brick count when $count is 0...\n     31: \t$brick_param_defaults = {},\t# these always get used to build bricks\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-recovery_message.pp", "content": "user        => root", "line": 22, "detection_span": [20, 24], "with_context": "# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 22\n\n     17:   # Otherwise you will need to touch $kextdir to generate it.\n     18:   exec { 'Refresh system kext cache':\n     19:       command     => \"/usr/bin/touch ${kextdir}\",\n     20:       creates     => $eficachedir,\n     21:       refreshonly => true,\n>>>  22:       user        => root\n     23:   }\n     24: \n     25:   exec { 'Refresh CoreStorage EFI Cache':\n     26:       command     => \"/usr/bin/touch ${eficachedir}\",\n     27:       onlyif      => \"test -d ${eficachedir}\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 22\n\n     17:   # Otherwise you will need to touch $kextdir to generate it.\n     18:   exec { 'Refresh system kext cache':\n     19:       command     => \"/usr/bin/touch ${kextdir}\",\n     20:       creates     => $eficachedir,\n     21:       refreshonly => true,\n>>>  22:       user        => root\n     23:   }\n     24: \n     25:   exec { 'Refresh CoreStorage EFI Cache':\n     26:       command     => \"/usr/bin/touch ${eficachedir}\",\n     27:       onlyif      => \"test -d ${eficachedir}\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-recovery_message.pp", "content": "key    => 'LoginwindowText',", "line": 37, "detection_span": [35, 39], "with_context": "# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 37\n\n     32:   if $ensure == 'present' {\n     33:     if $value != undef {\n     34:       property_list_key { 'Set OS X Recovery Message':\n     35:         ensure => present,\n     36:         path   => '/Library/Preferences/com.apple.loginwindow.plist',\n>>>  37:         key    => 'LoginwindowText',\n     38:         value  => $value,\n     39:         notify => [\n     40:           Exec['Refresh system kext cache'],\n     41:           Exec['Refresh CoreStorage EFI Cache']\n     42:         ]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: quintel@boxen-modules-osx-manifests-recovery_message.pp\n# Target line: 37\n\n     32:   if $ensure == 'present' {\n     33:     if $value != undef {\n     34:       property_list_key { 'Set OS X Recovery Message':\n     35:         ensure => present,\n     36:         path   => '/Library/Preferences/com.apple.loginwindow.plist',\n>>>  37:         key    => 'LoginwindowText',\n     38:         value  => $value,\n     39:         notify => [\n     40:           Exec['Refresh system kext cache'],\n     41:           Exec['Refresh CoreStorage EFI Cache']\n     42:         ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "redhat-openstack@puppet-galera-manifests-server.pp", "content": "$wsrep_sst_username    = 'root',", "line": 98, "detection_span": [96, 100], "with_context": "# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 98\n\n     93:   $wsrep_node_address    = undef,\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n>>>  98:   $wsrep_sst_username    = 'root',\n     99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 98\n\n     93:   $wsrep_node_address    = undef,\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n>>>  98:   $wsrep_sst_username    = 'root',\n     99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "redhat-openstack@puppet-galera-manifests-server.pp", "content": "$wsrep_sst_password    = undef,", "line": 99, "detection_span": [97, 101], "with_context": "# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 99\n\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n     98:   $wsrep_sst_username    = 'root',\n>>>  99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,\n    104:   # DEPRECATED OPTIONS", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: redhat-openstack@puppet-galera-manifests-server.pp\n# Target line: 99\n\n     94:   $wsrep_provider        = '/usr/lib64/galera/libgalera_smm.so',\n     95:   $wsrep_cluster_name    = 'galera_cluster',\n     96:   $wsrep_cluster_members = [ $::ipaddress ],\n     97:   $wsrep_sst_method      = 'rsync',\n     98:   $wsrep_sst_username    = 'root',\n>>>  99:   $wsrep_sst_password    = undef,\n    100:   $wsrep_ssl             = false,\n    101:   $wsrep_ssl_key         = undef,\n    102:   $wsrep_ssl_cert        = undef,\n    103:   $create_mysql_resource = true,\n    104:   # DEPRECATED OPTIONS\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "www_root        => '/var/www/nginx-default',", "line": 5, "detection_span": [3, 7], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 5\n\n      1: include nginx\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n>>>   5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 5\n\n      1: include nginx\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n>>>   5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',", "line": 7, "detection_span": [5, 9], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 7\n\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n>>>   7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 7\n\n      2: \n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n>>>   7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',", "line": 8, "detection_span": [6, 10], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 8\n\n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 8\n\n      3: nginx::resource::server { 'test3.local test3':\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',", "line": 9, "detection_span": [7, 11], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 9\n\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,\n     14:   www_root => '/var/www/nginx-default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 9\n\n      4:   ensure          => present,\n      5:   www_root        => '/var/www/nginx-default',\n      6:   ssl             => true,\n      7:   ssl_cert        => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n      8:   ssl_client_cert => 'puppet:///modules/sslkey/whildcard_mydomain.crt',\n>>>   9:   ssl_key         => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     10: }\n     11: \n     12: nginx::resource::server { 'test2.local test2':\n     13:   ensure   => present,\n     14:   www_root => '/var/www/nginx-default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-nginx-examples-server_ssl.pp", "content": "www_root => '/var/www/bob',", "line": 22, "detection_span": [20, 24], "with_context": "# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 22\n\n     17:   ssl_key  => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     18: }\n     19: \n     20: nginx::resource::location { 'test2.local-bob':\n     21:   ensure   => present,\n>>>  22:   www_root => '/var/www/bob',\n     23:   location => '/bob',\n     24:   server   => 'test2.local test2',\n     25: }\n     26: \n     27: nginx::resource::location { 'test3.local-bob':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-nginx-examples-server_ssl.pp\n# Target line: 22\n\n     17:   ssl_key  => 'puppet:///modules/sslkey/whildcard_mydomain.key',\n     18: }\n     19: \n     20: nginx::resource::location { 'test2.local-bob':\n     21:   ensure   => present,\n>>>  22:   www_root => '/var/www/bob',\n     23:   location => '/bob',\n     24:   server   => 'test2.local test2',\n     25: }\n     26: \n     27: nginx::resource::location { 'test3.local-bob':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-rabbitmq-examples-server.pp", "content": "delete_guest_user => true,", "line": 3, "detection_span": [1, 5], "with_context": "# File: voxpupuli@puppet-rabbitmq-examples-server.pp\n# Target line: 3\n\n      1: class { 'rabbitmq::server':\n      2:   port              => '5672',\n>>>   3:   delete_guest_user => true,\n      4:   version           => 'latest',\n      5: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ (isPassword(x.name) ∨ isSecret(x.name) ∨ isUser(x.name)) ∧ ¬x.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-rabbitmq-examples-server.pp\n# Target line: 3\n\n      1: class { 'rabbitmq::server':\n      2:   port              => '5672',\n>>>   3:   delete_guest_user => true,\n      4:   version           => 'latest',\n      5: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_calculators_frontend.pp", "content": "# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc", "line": 1, "detection_span": [-1, 3], "with_context": "# File: alphagov@govuk-puppet-modules-govuk-manifests-node-s_calculators_frontend.pp\n# Target line: 1\n\n>>>   1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::node::s_calculators_frontend inherits govuk::node::s_base {\n      3:   include govuk::node::s_app_server\n      4: \n      5:   include govuk_aws_xray_daemon\n      6: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk-manifests-node-s_calculators_frontend.pp\n# Target line: 1\n\n>>>   1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::node::s_calculators_frontend inherits govuk::node::s_base {\n      3:   include govuk::node::s_app_server\n      4: \n      5:   include govuk_aws_xray_daemon\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "# TODO: Support SSL", "line": 37, "detection_span": [35, 39], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 37\n\n     32:     database_connection => 'mysql+pymysql://designate:designate@127.0.0.1/designate?charset=utf8'\n     33:   }\n     34: \n     35:   include '::designate::client'\n     36: \n>>>  37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 37\n\n     32:     database_connection => 'mysql+pymysql://designate:designate@127.0.0.1/designate?charset=utf8'\n     33:   }\n     34: \n     35:   include '::designate::client'\n     36: \n>>>  37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "# TODO: Implement pools.yaml management in puppet-designate", "line": 100, "detection_span": [98, 102], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 100\n\n     95:     timeout     => '15',\n     96:     refreshonly => true,\n     97:     subscribe   => Anchor['designate::service::end'],\n     98:   }\n     99: \n>>> 100:   # TODO: Implement pools.yaml management in puppet-designate\n    101:   file { '/etc/designate/pools.yaml':\n    102:     ensure  => present,\n    103:     content => template(\"${module_name}/pools.yaml.erb\"),\n    104:     require => Service['designate-central'],\n    105:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 100\n\n     95:     timeout     => '15',\n     96:     refreshonly => true,\n     97:     subscribe   => Anchor['designate::service::end'],\n     98:   }\n     99: \n>>> 100:   # TODO: Implement pools.yaml management in puppet-designate\n    101:   file { '/etc/designate/pools.yaml':\n    102:     ensure  => present,\n    103:     content => template(\"${module_name}/pools.yaml.erb\"),\n    104:     require => Service['designate-central'],\n    105:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster", "line": 22, "detection_span": [20, 24], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 22\n\n     17: \n     18: class gluster::simple(\n     19: \t$path = '',\n     20: \t$volume = 'puppet',\t# NOTE: this can be a list...\n     21: \t$replica = 1,\n>>>  22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n     26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 22\n\n     17: \n     18: class gluster::simple(\n     19: \t$path = '',\n     20: \t$volume = 'puppet',\t# NOTE: this can be a list...\n     21: \t$replica = 1,\n>>>  22: \t$stripe = 1,\t\t# TODO: not fully implemented in puppet-gluster\n     23: \t$layout = '',\t\t# brick layout to use (default, chained, etc...)\n     24: \t$vip = '',\t\t# strongly recommended\n     25: \t$vrrp = false,\n     26: \t$password = '',\t# global vrrp password to use\n     27: \t$version = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# TODO: check that each element of array is a valid hash!", "line": 81, "detection_span": [79, 83], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 81\n\n     76: \t$valid_brick_param_defaults = merge($areyousure, $againhash, $brick_param_defaults)\n     77: \n     78: \t# if this is an array, then each element is the default for each brick!\n     79: \t# if this is an array, then the number of elements is the brick count!!\n     80: \tvalidate_array($brick_params_defaults)\n>>>  81: \t# TODO: check that each element of array is a valid hash!\n     82: \t$valid_brick_params_defaults = $brick_params_defaults\n     83: \n     84: \tnotify { 'gluster::simple':\n     85: \t\tmessage => 'You are using gluster::simple !',\n     86: \t}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 81\n\n     76: \t$valid_brick_param_defaults = merge($areyousure, $againhash, $brick_param_defaults)\n     77: \n     78: \t# if this is an array, then each element is the default for each brick!\n     79: \t# if this is an array, then the number of elements is the brick count!!\n     80: \tvalidate_array($brick_params_defaults)\n>>>  81: \t# TODO: check that each element of array is a valid hash!\n     82: \t$valid_brick_params_defaults = $brick_params_defaults\n     83: \n     84: \tnotify { 'gluster::simple':\n     85: \t\tmessage => 'You are using gluster::simple !',\n     86: \t}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# TODO: should we use the same pattern for 1 or many ?", "line": 145, "detection_span": [143, 147], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 145\n\n    140: \t\t},\n    141: \t\tdefault => $count,\n    142: \t}\n    143: \n    144: \t$brick_params_names = \"${valid_count}\" ? {\n>>> 145: \t\t# TODO: should we use the same pattern for 1 or many ?\n    146: \t\t'1' => [\"${::fqdn}:${valid_path}\"],\n    147: \t\tdefault => split(inline_template(\"<%= (1..@valid_count.to_i).collect{|i| '${::fqdn}:${valid_path}brick' + i.to_s.rjust(7, '0') + '/' }.join(',') %>\"), ','),\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 145\n\n    140: \t\t},\n    141: \t\tdefault => $count,\n    142: \t}\n    143: \n    144: \t$brick_params_names = \"${valid_count}\" ? {\n>>> 145: \t\t# TODO: should we use the same pattern for 1 or many ?\n    146: \t\t'1' => [\"${::fqdn}:${valid_path}\"],\n    147: \t\tdefault => split(inline_template(\"<%= (1..@valid_count.to_i).collect{|i| '${::fqdn}:${valid_path}brick' + i.to_s.rjust(7, '0') + '/' }.join(',') %>\"), ','),\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "suspicious_comment", "file": "Automattic@vip-quickstart-puppet-manifests-sections-mail.pp", "content": "# Postfix", "line": 1, "detection_span": [-1, 3], "with_context": "# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 1\n\n>>>   1: # Postfix\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: Automattic@vip-quickstart-puppet-manifests-sections-mail.pp\n# Target line: 1\n\n>>>   1: # Postfix\n      2: package { 'postfix': ensure => present }\n      3: service { 'postfix': ensure => running }\n      4: exec { 'configure postfix hostname':\n      5:     command => \"sed -i 's/precise32/${quickstart_domain}/g' /etc/postfix/main.cf\",\n      6:     onlyif  => 'cat /etc/postfix/main.cf | grep \"precise32\"',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp", "content": "# RHEL 7 and later and Fedora 15 and later require the iptables-services", "line": 23, "detection_span": [21, 25], "with_context": "# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 23\n\n     18:   $service_name   = $::firewall::params::service_name,\n     19:   $package_name   = $::firewall::params::package_name,\n     20:   $package_ensure = $::firewall::params::package_ensure,\n     21: ) inherits ::firewall::params {\n     22: \n>>>  23:   # RHEL 7 and later and Fedora 15 and later require the iptables-services\n     24:   # package, which provides the /usr/libexec/iptables/iptables.init used by\n     25:   # lib/puppet/util/firewall.rb.\n     26:   if ($::operatingsystem != 'Amazon')\n     27:   and (($::operatingsystem != 'Fedora' and versioncmp($::operatingsystemrelease, '7.0') >= 0)\n     28:   or  ($::operatingsystem == 'Fedora' and versioncmp($::operatingsystemrelease, '15') >= 0)) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-redhat.pp\n# Target line: 23\n\n     18:   $service_name   = $::firewall::params::service_name,\n     19:   $package_name   = $::firewall::params::package_name,\n     20:   $package_ensure = $::firewall::params::package_ensure,\n     21: ) inherits ::firewall::params {\n     22: \n>>>  23:   # RHEL 7 and later and Fedora 15 and later require the iptables-services\n     24:   # package, which provides the /usr/libexec/iptables/iptables.init used by\n     25:   # lib/puppet/util/firewall.rb.\n     26:   if ($::operatingsystem != 'Amazon')\n     27:   and (($::operatingsystem != 'Fedora' and versioncmp($::operatingsystemrelease, '7.0') >= 0)\n     28:   or  ($::operatingsystem == 'Fedora' and versioncmp($::operatingsystemrelease, '15') >= 0)) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp", "content": "# These aliases resolve .ruby-version 2.x to an installed Ruby version.", "line": 36, "detection_span": [34, 38], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 36\n\n     31: \n     32:   govuk_rbenv::install_ruby_version { $ruby_versions:\n     33:     with_foreman => $with_foreman,\n     34:   }\n     35: \n>>>  36:   # These aliases resolve .ruby-version 2.x to an installed Ruby version.\n     37:   rbenv::alias { '2.4':\n     38:     to_version => '2.4.5',\n     39:   }\n     40:   rbenv::alias { '2.5':\n     41:     to_version => '2.5.3',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 36\n\n     31: \n     32:   govuk_rbenv::install_ruby_version { $ruby_versions:\n     33:     with_foreman => $with_foreman,\n     34:   }\n     35: \n>>>  36:   # These aliases resolve .ruby-version 2.x to an installed Ruby version.\n     37:   rbenv::alias { '2.4':\n     38:     to_version => '2.4.5',\n     39:   }\n     40:   rbenv::alias { '2.5':\n     41:     to_version => '2.5.3',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-python-manifests-pip-couchdb.pp", "content": "# with the service/package couchdb! Hoping that one day we can properly solve", "line": 20, "detection_span": [18, 22], "with_context": "# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 20\n\n     15:     ['^RedHat$','^Debian$'],\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n>>>  20:   # with the service/package couchdb! Hoping that one day we can properly solve\n     21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 20\n\n     15:     ['^RedHat$','^Debian$'],\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n>>>  20:   # with the service/package couchdb! Hoping that one day we can properly solve\n     21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-python-manifests-pip-couchdb.pp", "content": "# this problem using e.g. composite name identifier", "line": 21, "detection_span": [19, 23], "with_context": "# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 21\n\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n     20:   # with the service/package couchdb! Hoping that one day we can properly solve\n>>>  21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }\n     26: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: camptocamp@puppet-python-manifests-pip-couchdb.pp\n# Target line: 21\n\n     16:     \"Unsupported os family ${::osfamily}\"\n     17:   )\n     18: \n     19:   # Workaround: added a SPACE in namevar to avoid duplicate declaration\n     20:   # with the service/package couchdb! Hoping that one day we can properly solve\n>>>  21:   # this problem using e.g. composite name identifier\n     22:   @package {'python-couchdb':\n     23:     provider => 'pip',\n     24:     name     => ' couchdb',\n     25:   }\n     26: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "mattheath@puppet-php-manifests-version.pp", "content": "# Fix permissions for php versions installed prior to 0.3.5 of this module", "line": 122, "detection_span": [120, 124], "with_context": "# File: mattheath@puppet-php-manifests-version.pp\n# Target line: 122\n\n    117:         Package['boxen/brews/autoconf213'],\n    118:       ],\n    119:       notify        => Exec[\"phpenv-rehash-post-install-${version}\"],\n    120:     }\n    121: \n>>> 122:     # Fix permissions for php versions installed prior to 0.3.5 of this module\n    123:     file { $dest:\n    124:       ensure  => directory,\n    125:       owner   => $::boxen_user,\n    126:       group   => 'staff',\n    127:       recurse => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: mattheath@puppet-php-manifests-version.pp\n# Target line: 122\n\n    117:         Package['boxen/brews/autoconf213'],\n    118:       ],\n    119:       notify        => Exec[\"phpenv-rehash-post-install-${version}\"],\n    120:     }\n    121: \n>>> 122:     # Fix permissions for php versions installed prior to 0.3.5 of this module\n    123:     file { $dest:\n    124:       ensure  => directory,\n    125:       owner   => $::boxen_user,\n    126:       group   => 'staff',\n    127:       recurse => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-monasca-manifests-virtualenv-instance.pp", "content": "# and with different $venv_prefix options.  The monasca::agent class will allow", "line": 19, "detection_span": [17, 21], "with_context": "# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 19\n\n     14: #\n     15: # This module explicitly supports provisioning multiple virtualenv based\n     16: # installations in order to make upgrades and rollbacks easier.  To take\n     17: # advantage of this, you can define additional instances of\n     18: # monasca::virtualenv::instance type with the active flag set to false\n>>>  19: # and with different $venv_prefix options.  The monasca::agent class will allow\n     20: # configuring multiple virtualenvs via hiera.\n     21: #\n     22: # If using virtualenv based installations it's *strongly* recommended that\n     23: # virtualenvs be treated as immutable once created.  Behavior with changing\n     24: # requirements.txt or code may not be what you expect, since the existing", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 19\n\n     14: #\n     15: # This module explicitly supports provisioning multiple virtualenv based\n     16: # installations in order to make upgrades and rollbacks easier.  To take\n     17: # advantage of this, you can define additional instances of\n     18: # monasca::virtualenv::instance type with the active flag set to false\n>>>  19: # and with different $venv_prefix options.  The monasca::agent class will allow\n     20: # configuring multiple virtualenvs via hiera.\n     21: #\n     22: # If using virtualenv based installations it's *strongly* recommended that\n     23: # virtualenvs be treated as immutable once created.  Behavior with changing\n     24: # requirements.txt or code may not be what you expect, since the existing\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-monasca-manifests-virtualenv-instance.pp", "content": "# [*venv_prefix*] Prefix to give to virtualenv directories", "line": 42, "detection_span": [40, 44], "with_context": "# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 42\n\n     37: #\n     38: # [*basedir*] (required) Base directory for storing virtualenvs.\n     39: #\n     40: # [*symlink*] (required if venv_active is true) The path to link to the venv_dir\n     41: #\n>>>  42: # [*venv_prefix*] Prefix to give to virtualenv directories\n     43: # This can be specified to provide more meaningful names, or to have multiple\n     44: # virtualenvs installed at the same time. Defaults to $name\n     45: #\n     46: # [*venv_requirements*] (required) Python requirements.txt to pass to pip when\n     47: # populating the virtualenv.  Required if the instance is ensured to be present.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-monasca-manifests-virtualenv-instance.pp\n# Target line: 42\n\n     37: #\n     38: # [*basedir*] (required) Base directory for storing virtualenvs.\n     39: #\n     40: # [*symlink*] (required if venv_active is true) The path to link to the venv_dir\n     41: #\n>>>  42: # [*venv_prefix*] Prefix to give to virtualenv directories\n     43: # This can be specified to provide more meaningful names, or to have multiple\n     44: # virtualenvs installed at the same time. Defaults to $name\n     45: #\n     46: # [*venv_requirements*] (required) Python requirements.txt to pass to pip when\n     47: # populating the virtualenv.  Required if the instance is ensured to be present.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "# IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396", "line": 61, "detection_span": [59, 63], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 61\n\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: \n>>>  61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'\n     64:   }\n     65: \n     66:   class { '::designate::central': }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 61\n\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: \n>>>  61:   # IPv6 doesn't work for mdns ? https://bugs.launchpad.net/designate/+bug/1501396\n     62:   class { '::designate::mdns':\n     63:     listen => '127.0.0.1:5354'\n     64:   }\n     65: \n     66:   class { '::designate::central': }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp", "content": "# [*debug*]", "line": 30, "detection_span": [28, 32], "with_context": "# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 30\n\n     25: #   Docker image name for dibbler.\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n>>>  30: # [*debug*]\n     31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 30\n\n     25: #   Docker image name for dibbler.\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n>>>  30: # [*debug*]\n     31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp", "content": "#   Enable debug messages for the wrapper script.", "line": 31, "detection_span": [29, 33], "with_context": "# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 31\n\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n     30: # [*debug*]\n>>>  31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #\n     36: define tripleo::profile::base::neutron::wrappers::dibbler_client (", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-tripleo-manifests-profile-base-neutron-wrappers-dibbler_client.pp\n# Target line: 31\n\n     26: #\n     27: # [*bind_socket*]\n     28: #   Socket for accessing the docker daemon.\n     29: #\n     30: # [*debug*]\n>>>  31: #   Enable debug messages for the wrapper script.\n     32: #\n     33: # [*container_cli*]\n     34: #   Host containers runtime system to use.\n     35: #\n     36: define tripleo::profile::base::neutron::wrappers::dibbler_client (\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# (at your option) any later version.", "line": 8, "detection_span": [6, 10], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 8\n\n      3: # Written by James Shubin <james@shubin.ca>\n      4: #\n      5: # This program is free software: you can redistribute it and/or modify\n      6: # it under the terms of the GNU Affero General Public License as published by\n      7: # the Free Software Foundation, either version 3 of the License, or\n>>>   8: # (at your option) any later version.\n      9: #\n     10: # This program is distributed in the hope that it will be useful,\n     11: # but WITHOUT ANY WARRANTY; without even the implied warranty of\n     12: # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n     13: # GNU Affero General Public License for more details.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 8\n\n      3: # Written by James Shubin <james@shubin.ca>\n      4: #\n      5: # This program is free software: you can redistribute it and/or modify\n      6: # it under the terms of the GNU Affero General Public License as published by\n      7: # the Free Software Foundation, either version 3 of the License, or\n>>>   8: # (at your option) any later version.\n      9: #\n     10: # This program is distributed in the hope that it will be useful,\n     11: # but WITHOUT ANY WARRANTY; without even the implied warranty of\n     12: # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n     13: # GNU Affero General Public License for more details.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-simple.pp", "content": "# readability. Puppet needs to fix this issue somehow! Creating", "line": 153, "detection_span": [151, 155], "with_context": "# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 153\n\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)\n    151: \n    152: \t# NOTE: I've kept this template split as two comment chunks for\n>>> 153: \t# readability. Puppet needs to fix this issue somehow! Creating\n    154: \t# a separate template removes the logic from the code, but as a\n    155: \t# large inline template it's very hard to read/write the logic!\n    156: \t#DEFAULTS = (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {})\n    157: \t#$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => DEFAULTS.merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")\n    158: \t$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {}).merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) ∧ hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: purpleidea@puppet-gluster-manifests-simple.pp\n# Target line: 153\n\n    148: \t}\n    149: \n    150: \tvalidate_array($brick_params_list)\n    151: \n    152: \t# NOTE: I've kept this template split as two comment chunks for\n>>> 153: \t# readability. Puppet needs to fix this issue somehow! Creating\n    154: \t# a separate template removes the logic from the code, but as a\n    155: \t# large inline template it's very hard to read/write the logic!\n    156: \t#DEFAULTS = (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {})\n    157: \t#$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => DEFAULTS.merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")\n    158: \t$yaml = inline_template(\"<%= (0..@valid_count.to_i-1).inject(Hash.new) { |h,i| {@brick_params_names[i] => (((i < @valid_brick_params_defaults.length) and @valid_brick_params_defaults[i].is_a?(Hash)) ? @valid_brick_params_defaults[i] : {}).merge((i < @brick_params_list.length) ? @brick_params_list[i] : {})}.merge(h) }.to_yaml %>\")\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp", "content": "auth_method => 'md5',", "line": 23, "detection_span": [21, 25], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 23\n\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n     22:     user        => 'env-sync',\n>>>  23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-env_sync_user.pp\n# Target line: 23\n\n     18: \n     19:   postgresql::server::pg_hba_rule { 'local access as env-sync user':\n     20:     type        => 'local',\n     21:     database    => 'all',\n     22:     user        => 'env-sync',\n>>>  23:     auth_method => 'md5',\n     24:     order       => '001', # necessary to ensure this is before the 'local all all ident' rule.\n     25:   }\n     26: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp", "content": "$ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',", "line": 34, "detection_span": [32, 36], "with_context": "# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 34\n\n     29: #\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n>>>  34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 34\n\n     29: #\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n>>>  34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n     35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp", "content": "$macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',", "line": 35, "detection_span": [33, 37], "with_context": "# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 35\n\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n     34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n>>>  35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n     40:   $permit_root    = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ssh.pp\n# Target line: 35\n\n     30: # [*listen_address*]\n     31: #   Array of the local addresses sshd should listen on.\n     32: \n     33: class osnailyfacter::ssh(\n     34:   $ciphers        = 'aes256-ctr,aes192-ctr,aes128-ctr,arcfour256,arcfour128',\n>>>  35:   $macs           = 'hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,hmac-sha1',\n     36:   $protocol_ver   = '2',\n     37:   $ports          = '22',\n     38:   $log_lvl        = 'VERBOSE',\n     39:   $password_auth  = 'no',\n     40:   $permit_root    = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "puphpet@puppet-puphpet-manifests-nginx-params.pp", "content": "$allowed_ciphers = [", "line": 25, "detection_span": [23, 27], "with_context": "# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 25\n\n     20:     'vhost_cfg_append'     => {'sendfile' => 'off'},\n     21:     'index_files'          => ['index.html', 'index.htm',],\n     22:     'locations'            => [ ]\n     23:   }\n     24: \n>>>  25:   $allowed_ciphers = [\n     26:     'ECDHE-RSA-AES256-GCM-SHA384', 'ECDHE-RSA-AES128-GCM-SHA256',\n     27:     'DHE-RSA-AES256-GCM-SHA384', 'DHE-RSA-AES128-GCM-SHA256',\n     28:     'ECDHE-RSA-AES256-SHA384', 'ECDHE-RSA-AES128-SHA256', 'ECDHE-RSA-AES256-SHA',\n     29:     'ECDHE-RSA-AES128-SHA', 'DHE-RSA-AES256-SHA256', 'DHE-RSA-AES128-SHA256',\n     30:     'DHE-RSA-AES256-SHA', 'DHE-RSA-AES128-SHA', 'ECDHE-RSA-DES-CBC3-SHA',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: puphpet@puppet-puphpet-manifests-nginx-params.pp\n# Target line: 25\n\n     20:     'vhost_cfg_append'     => {'sendfile' => 'off'},\n     21:     'index_files'          => ['index.html', 'index.htm',],\n     22:     'locations'            => [ ]\n     23:   }\n     24: \n>>>  25:   $allowed_ciphers = [\n     26:     'ECDHE-RSA-AES256-GCM-SHA384', 'ECDHE-RSA-AES128-GCM-SHA256',\n     27:     'DHE-RSA-AES256-GCM-SHA384', 'DHE-RSA-AES128-GCM-SHA256',\n     28:     'ECDHE-RSA-AES256-SHA384', 'ECDHE-RSA-AES128-SHA256', 'ECDHE-RSA-AES256-SHA',\n     29:     'ECDHE-RSA-AES128-SHA', 'DHE-RSA-AES256-SHA256', 'DHE-RSA-AES128-SHA256',\n     30:     'DHE-RSA-AES256-SHA', 'DHE-RSA-AES128-SHA', 'ECDHE-RSA-DES-CBC3-SHA',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp", "content": "$home_sha = sha1($catalina_home)", "line": 6, "detection_span": [4, 8], "with_context": "# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 6\n\n      1: # private\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n>>>   6:   $home_sha = sha1($catalina_home)\n      7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 6\n\n      1: # private\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n>>>   6:   $home_sha = sha1($catalina_home)\n      7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp", "content": "$base_sha = sha1($catalina_base)", "line": 7, "detection_span": [5, 9], "with_context": "# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 7\n\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n      6:   $home_sha = sha1($catalina_home)\n>>>   7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: \n     12:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance-dependencies.pp\n# Target line: 7\n\n      2: define tomcat::instance::dependencies (\n      3:   $catalina_home,\n      4:   $catalina_base,\n      5: ) {\n      6:   $home_sha = sha1($catalina_home)\n>>>   7:   $base_sha = sha1($catalina_base)\n      8: \n      9:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n     10:   -> Tomcat::Service                   <| tag == $base_sha |>\n     11: \n     12:   Tomcat::Install                      <| tag == $base_sha or tag == $home_sha |>\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_weak_cryptography_algorithms", "file": "puppetlabs@puppetlabs-apache-manifests-mod-ssl.pp", "content": "$ssl_cipher                                               = 'HIGH:MEDIUM:!aNULL:!MD5:!RC4:!3DES',", "line": 9, "detection_span": [7, 11], "with_context": "# File: puppetlabs@puppetlabs-apache-manifests-mod-ssl.pp\n# Target line: 9\n\n      4:   $ssl_options                                              = [ 'StdEnvVars' ],\n      5:   $ssl_openssl_conf_cmd                                     = undef,\n      6:   Optional[String] $ssl_cert                                = undef,\n      7:   Optional[String] $ssl_key                                 = undef,\n      8:   $ssl_ca                                                   = undef,\n>>>   9:   $ssl_cipher                                               = 'HIGH:MEDIUM:!aNULL:!MD5:!RC4:!3DES',\n     10:   Variant[Boolean, Enum['on', 'off']] $ssl_honorcipherorder = true,\n     11:   $ssl_protocol                                             = [ 'all', '-SSLv2', '-SSLv3' ],\n     12:   Array $ssl_proxy_protocol                                 = [],\n     13:   $ssl_pass_phrase_dialog                                   = 'builtin',\n     14:   $ssl_random_seed_bytes                                    = '512',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isWeakCrypt(x.value) ∧ ¬hasWeakCryptWhitelist(x.name) ∧ ¬hasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: puppetlabs@puppetlabs-apache-manifests-mod-ssl.pp\n# Target line: 9\n\n      4:   $ssl_options                                              = [ 'StdEnvVars' ],\n      5:   $ssl_openssl_conf_cmd                                     = undef,\n      6:   Optional[String] $ssl_cert                                = undef,\n      7:   Optional[String] $ssl_key                                 = undef,\n      8:   $ssl_ca                                                   = undef,\n>>>   9:   $ssl_cipher                                               = 'HIGH:MEDIUM:!aNULL:!MD5:!RC4:!3DES',\n     10:   Variant[Boolean, Enum['on', 'off']] $ssl_honorcipherorder = true,\n     11:   $ssl_protocol                                             = [ 'all', '-SSLv2', '-SSLv3' ],\n     12:   Array $ssl_proxy_protocol                                 = [],\n     13:   $ssl_pass_phrase_dialog                                   = 'builtin',\n     14:   $ssl_random_seed_bytes                                    = '512',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "alphagov@govuk-puppet-modules-govuk_beat-manifests-repo.pp", "content": "location     => \"http://${apt_mirror_hostname}/elastic-beats\",", "line": 16, "detection_span": [14, 18], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_beat-manifests-repo.pp\n# Target line: 16\n\n     11: #\n     12: class govuk_beat::repo(\n     13:   $apt_mirror_hostname,\n     14: ) {\n     15:   apt::source { 'elastic-beats':\n>>>  16:     location     => \"http://${apt_mirror_hostname}/elastic-beats\",\n     17:     release      => 'stable',\n     18:     architecture => $::architecture,\n     19:   }\n     20: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_beat-manifests-repo.pp\n# Target line: 16\n\n     11: #\n     12: class govuk_beat::repo(\n     13:   $apt_mirror_hostname,\n     14: ) {\n     15:   apt::source { 'elastic-beats':\n>>>  16:     location     => \"http://${apt_mirror_hostname}/elastic-beats\",\n     17:     release      => 'stable',\n     18:     architecture => $::architecture,\n     19:   }\n     20: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 40, "detection_span": [38, 42], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 40\n\n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n>>>  40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 40\n\n     35:   include '::designate::client'\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n>>>  40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 41, "detection_span": [39, 43], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 41\n\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 41\n\n     36: \n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 42, "detection_span": [40, 44], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 42\n\n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',\n     47:     project_domain_name  => 'Default',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 42\n\n     37:   # TODO: Support SSL\n     38:   class { '::designate::keystone::auth':\n     39:     password     => 'a_big_secret',\n     40:     public_url   => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     41:     internal_url => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n>>>  42:     admin_url    => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     43:   }\n     44:   class { '::designate::keystone::authtoken':\n     45:     password             => 'a_big_secret',\n     46:     user_domain_name     => 'Default',\n     47:     project_domain_name  => 'Default',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "openstack@puppet-openstack-integration-manifests-designate.pp", "content": "api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",", "line": 55, "detection_span": [53, 57], "with_context": "# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 55\n\n     50:     memcached_servers    => $::openstack_integration::config::memcached_servers,\n     51:   }\n     52: \n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n>>>  55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: openstack@puppet-openstack-integration-manifests-designate.pp\n# Target line: 55\n\n     50:     memcached_servers    => $::openstack_integration::config::memcached_servers,\n     51:   }\n     52: \n     53:   class { '::designate::api':\n     54:     listen           => \"${::openstack_integration::config::ip_for_url}:9001\",\n>>>  55:     api_base_uri     => \"http://${::openstack_integration::config::ip_for_url}:9001\",\n     56:     auth_strategy    => 'keystone',\n     57:     enable_api_v2    => true,\n     58:     enable_api_admin => true\n     59:   }\n     60: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "TP"}
{"smell": "use_of_http_without_ssl_tls", "file": "alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp", "content": "location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",", "line": 18, "detection_span": [16, 20], "with_context": "# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 18\n\n     13:   $with_foreman = false,\n     14: ) {\n     15:   include govuk_rbenv\n     16: \n     17:   apt::source { 'rbenv-ruby':\n>>>  18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n     21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: alphagov@govuk-puppet-modules-govuk_rbenv-manifests-all.pp\n# Target line: 18\n\n     13:   $with_foreman = false,\n     14: ) {\n     15:   include govuk_rbenv\n     16: \n     17:   apt::source { 'rbenv-ruby':\n>>>  18:     location     => \"http://${apt_mirror_hostname}/rbenv-ruby\",\n     19:     release      => $::lsbdistcodename,\n     20:     architecture => $::architecture,\n     21:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     22:   }\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp", "content": "mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',", "line": 9, "detection_span": [7, 11], "with_context": "# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::jpackage6 {\n      6: \n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n>>>   9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::jpackage6 {\n      6: \n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n>>>   9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp", "content": "gpgkey         => 'http://www.jpackage.org/jpackage.asc',", "line": 12, "detection_span": [10, 14], "with_context": "# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n      9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n>>>  12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,\n     15:   }\n     16: \n     17: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage6.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'jpackage':\n      8:     descr          => 'JPackage 6 generic',\n      9:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=6.0',\n     10:     failovermethod => 'priority',\n     11:     gpgcheck       => 1,\n>>>  12:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     13:     enabled        => 1,\n     14:     priority       => 1,\n     15:   }\n     16: \n     17: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$download_site                 = 'http://download.sonatype.com/nexus/oss'", "line": 28, "detection_span": [26, 30], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 28\n\n     23:   # See nexus::package on why this won't increment the package version.\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n>>>  28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 28\n\n     23:   # See nexus::package on why this won't increment the package version.\n     24:   $version                       = 'latest'\n     25:   $revision                      = '01'\n     26:   $type                          = 'bundle'\n     27:   $deploy_pro                    = false\n>>>  28:   $download_site                 = 'http://download.sonatype.com/nexus/oss'\n     29:   $nexus_root                    = '/srv'\n     30:   $nexus_home_dir                = 'nexus'\n     31:   $nexus_work_recurse            = true\n     32:   $nexus_work_dir_manage         = true\n     33:   $nexus_selinux_ignore_defaults = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "hubspotdevops@puppet-nexus-manifests-params.pp", "content": "$pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'", "line": 40, "detection_span": [38, 42], "with_context": "# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 40\n\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true\n>>>  40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef\n     45: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: hubspotdevops@puppet-nexus-manifests-params.pp\n# Target line: 40\n\n     35:   $nexus_group                   = 'nexus'\n     36:   $nexus_host                    = '0.0.0.0'\n     37:   $nexus_port                    = '8081'\n     38:   $nexus_context                 = '/nexus'\n     39:   $nexus_manage_user             = true\n>>>  40:   $pro_download_site             = 'http://download.sonatype.com/nexus/professional-bundle'\n     41:   $nexus_data_folder             = undef\n     42:   $download_folder               = '/srv'\n     43:   $manage_config                 = true\n     44:   $md5sum                        = undef\n     45: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
{"smell": "use_of_http_without_ssl_tls", "file": "voxpupuli@puppet-rundeck-manifests-config-global-framework.pp", "content": "$framework_config_url = { 'framework.server.url' => \"http://${rundeck_hostname}:${rundeck_port}\" }", "line": 28, "detection_span": [26, 30], "with_context": "# File: voxpupuli@puppet-rundeck-manifests-config-global-framework.pp\n# Target line: 28\n\n     23:   if $ssl_enabled {\n     24:     $framework_config_port = { 'framework.server.port' => $ssl_port }\n     25:     $framework_config_url = { 'framework.server.url' => \"https://${rundeck_hostname}:${ssl_port}\" }\n     26:   } elsif $rundeck_hostname != $rundeck::params::framework_config['framework.server.hostname'] {\n     27:     $framework_config_port = undef\n>>>  28:     $framework_config_url = { 'framework.server.url' => \"http://${rundeck_hostname}:${rundeck_port}\" }\n     29:   } else {\n     30:     $framework_config_port = undef\n     31:     $framework_config_url = undef\n     32:   }\n     33: ", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) ∨ isVariable(x)) ∧ isURL(x.value) ∧ hasHTTP(x.value) ∧ ¬hasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# File: voxpupuli@puppet-rundeck-manifests-config-global-framework.pp\n# Target line: 28\n\n     23:   if $ssl_enabled {\n     24:     $framework_config_port = { 'framework.server.port' => $ssl_port }\n     25:     $framework_config_url = { 'framework.server.url' => \"https://${rundeck_hostname}:${ssl_port}\" }\n     26:   } elsif $rundeck_hostname != $rundeck::params::framework_config['framework.server.hostname'] {\n     27:     $framework_config_port = undef\n>>>  28:     $framework_config_url = { 'framework.server.url' => \"http://${rundeck_hostname}:${rundeck_port}\" }\n     29:   } else {\n     30:     $framework_config_port = undef\n     31:     $framework_config_url = undef\n     32:   }\n     33: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):", "label": "FP"}
