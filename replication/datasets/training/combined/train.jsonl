{"smell": "weak_cryptography_algorithms", "file": "gwalbran_chef-cookbooks-imos_artifacts-libraries-fetcher_jenkins.rb", "content": "tmpfile = Tempfile.new('jenkins-artifact-md5')", "line": 128, "detection_span": [123, 133], "with_context": "\ndef version(filename)\nVersion.new(filename)\nend\n126:\ndef get_artifact_md5_from_md5_file(artifact_md5_url)\n128:       tmpfile = Tempfile.new('jenkins-artifact-md5')\nif Fetcher.download_file(artifact_md5_url, tmpfile.path, @username, @password)\nremote_checksum = checksum_from_file(tmpfile.path)\nelse\nChef::Log.warn(\"Could not obtain md5 via md5 file at '#{artifact_md5_url}'\")\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_artifacts-libraries-fetcher_jenkins.rb\n# Target line: 128\n\n    123:     def version(filename)\n    124:       Version.new(filename)\n    125:     end\n    126: \n    127:     def get_artifact_md5_from_md5_file(artifact_md5_url)\n>>> 128:       tmpfile = Tempfile.new('jenkins-artifact-md5')\n    129:       if Fetcher.download_file(artifact_md5_url, tmpfile.path, @username, @password)\n    130:         remote_checksum = checksum_from_file(tmpfile.path)\n    131:       else\n    132:         Chef::Log.warn(\"Could not obtain md5 via md5 file at '#{artifact_md5_url}'\")\n    133:       end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "guymatz_chef-cookbooks-gitpaste-recipes-default.rb", "content": "variables(", "line": 56, "detection_span": [51, 61], "with_context": "\nend\n\ntemplate su_fixture do\nsource 'superuser.json.erb'\naction :nothing\n56:   variables(\n:username => node[:gitpaste][:superuser][:username],\n:email => node[:gitpaste][:superuser][:email],\n:password => \"sha1$00000$#{Digest::SHA1.hexdigest(\"00000#{node[:gitpaste][:superuser][:password]}\")}\"\n)\nowner 'nobody'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-gitpaste-recipes-default.rb\n# Target line: 56\n\n     51: end\n     52: \n     53: template su_fixture do\n     54:   source 'superuser.json.erb'\n     55:   action :nothing\n>>>  56:   variables(\n     57:     :username => node[:gitpaste][:superuser][:username],\n     58:     :email => node[:gitpaste][:superuser][:email],\n     59:     :password => \"sha1$00000$#{Digest::SHA1.hexdigest(\"00000#{node[:gitpaste][:superuser][:password]}\")}\"\n     60:   )\n     61:   owner 'nobody'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "AYCHIT_Asf-chef-cookbooks-psf-loadbalancer-recipes-stud.rb", "content": "ciphers 'ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AES:RSA+3DES:!ADH:!AECDH:!MD5'", "line": 25, "detection_span": [20, 30], "with_context": "\nversion '0.3-2-ef1745'\npem_file domains.map{|domain| \"/etc/ssl/private/#{domain}.pem\" }\nfrontend '[*]:443'\ntls false\nssl true\n25:   ciphers 'ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AES:RSA+3DES:!ADH:!AECDH:!MD5'\nprefer_server_ciphers true\nuser 'nobody'\ngroup 'nogroup'\nchroot '/var/lib/stud'\nsyslog true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: AYCHIT_Asf-chef-cookbooks-psf-loadbalancer-recipes-stud.rb\n# Target line: 25\n\n     20:   version '0.3-2-ef1745'\n     21:   pem_file domains.map{|domain| \"/etc/ssl/private/#{domain}.pem\" }\n     22:   frontend '[*]:443'\n     23:   tls false\n     24:   ssl true\n>>>  25:   ciphers 'ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AES:RSA+3DES:!ADH:!AECDH:!MD5'\n     26:   prefer_server_ciphers true\n     27:   user 'nobody'\n     28:   group 'nogroup'\n     29:   chroot '/var/lib/stud'\n     30:   syslog true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "guymatz_chef-cookbooks-chef-server-recipes-apache-proxy.rb", "content": "code <<-EOH", "line": 49, "detection_span": [44, 54], "with_context": "\nmode 00700\nend\n\nbash \"Create SSL Certificates\" do\ncwd \"/etc/chef/certificates\"\n49:   code <<-EOH\numask 077\nopenssl genrsa 2048 > chef-server-proxy.key\nopenssl req -subj \"#{node['chef_server']['ssl_req']}\" -new -x509 -nodes -sha1 -days 3650 -key chef-server-proxy.key > chef-server-proxy.crt\ncat chef-server-proxy.key chef-server-proxy.crt > chef-server-proxy.pem\nEOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-chef-server-recipes-apache-proxy.rb\n# Target line: 49\n\n     44:   mode 00700\n     45: end\n     46: \n     47: bash \"Create SSL Certificates\" do\n     48:   cwd \"/etc/chef/certificates\"\n>>>  49:   code <<-EOH\n     50:   umask 077\n     51:   openssl genrsa 2048 > chef-server-proxy.key\n     52:   openssl req -subj \"#{node['chef_server']['ssl_req']}\" -new -x509 -nodes -sha1 -days 3650 -key chef-server-proxy.key > chef-server-proxy.crt\n     53:   cat chef-server-proxy.key chef-server-proxy.crt > chef-server-proxy.pem\n     54:   EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb", "content": "uri \"http://www.rabbitmq.com/debian/\"", "line": 46, "detection_span": [41, 51], "with_context": "\ncase node[:platform]\nwhen \"debian\", \"ubuntu\"\n# use the RabbitMQ repository instead of Ubuntu or Debian's\n# because there are very useful features in the newer versions\napt_repository \"rabbitmq\" do\n46:     uri \"http://www.rabbitmq.com/debian/\"\ndistribution \"testing\"\ncomponents [\"main\"]\nkey \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\naction :add\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb\n# Target line: 46\n\n     41: case node[:platform]\n     42: when \"debian\", \"ubuntu\"\n     43:   # use the RabbitMQ repository instead of Ubuntu or Debian's\n     44:   # because there are very useful features in the newer versions\n     45:   apt_repository \"rabbitmq\" do\n>>>  46:     uri \"http://www.rabbitmq.com/debian/\"\n     47:     distribution \"testing\"\n     48:     components [\"main\"]\n     49:     key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\n     50:     action :add\n     51:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-source.rb", "content": "default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'", "line": 9, "detection_span": [4, 14], "with_context": "\nif platform?('amazon')\nif node['platform_version'].to_i > 2010\ndefault['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\ndefault['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\n9:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\ndefault['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nelse\ndefault['yum']['epel-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-#{node['platform_version'].to_i}&arch=$basearch\"\ndefault['yum']['epel-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-source.rb\n# Target line: 9\n\n      4: if platform?('amazon')\n      5:   if node['platform_version'].to_i > 2010\n      6:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\n      7:     default['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      8:   else\n>>>   9:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\n     10:     default['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     11:   end\n     12: else\n     13:   default['yum']['epel-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-#{node['platform_version'].to_i}&arch=$basearch\"\n     14:   default['yum']['epel-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kitchenware_master-chef-cookbooks-nginx-recipes-default.rb", "content": "url \"http://nginx.org/packages/debian/\"", "line": 14, "detection_span": [9, 19], "with_context": "\nend\n\nif node.lsb.codename == \"squeeze\"  && node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"nginx\" do\n14:     url \"http://nginx.org/packages/debian/\"\ncomponents [\"nginx\"]\nkey \"7BD9BF62\"\nkey_server \"keyserver.ubuntu.com\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-nginx-recipes-default.rb\n# Target line: 14\n\n      9: end\n     10: \n     11: if node.lsb.codename == \"squeeze\"  && node.apt.master_chef_add_apt_repo\n     12: \n     13:   add_apt_repository \"nginx\" do\n>>>  14:     url \"http://nginx.org/packages/debian/\"\n     15:     components [\"nginx\"]\n     16:     key \"7BD9BF62\"\n     17:     key_server \"keyserver.ubuntu.com\"\n     18:   end\n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:agent][:prebuild_url]           = \"http://www.zabbix.com/downloads/:version:/zabbix_agents_:version:.:kernel:.:arch:.tar.gz\"", "line": 78, "detection_span": [73, 83], "with_context": "\ndefault[:zabbix][:agent][:log_dir]                = '/var/log/zabbix_agent'\ndefault[:zabbix][:agent][:create_host]            = true\ndefault[:zabbix][:agent][:unmonitor_on_shutdown]  = false\ndefault[:zabbix][:agent][:unsafe_user_parameters] = true\ndefault[:zabbix][:agent][:enable_remote_commands] = true\n78: default[:zabbix][:agent][:prebuild_url]           = \"http://www.zabbix.com/downloads/:version:/zabbix_agents_:version:.:kernel:.:arch:.tar.gz\"\ndefault[:zabbix][:agent][:prebuild_kernel]        = \"linux2_6\"\n\n# Web frontend\ncase platform\nwhen \"redhat\", \"centos\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-zabbix-attributes-default.rb\n# Target line: 78\n\n     73: default[:zabbix][:agent][:log_dir]                = '/var/log/zabbix_agent'\n     74: default[:zabbix][:agent][:create_host]            = true\n     75: default[:zabbix][:agent][:unmonitor_on_shutdown]  = false\n     76: default[:zabbix][:agent][:unsafe_user_parameters] = true\n     77: default[:zabbix][:agent][:enable_remote_commands] = true\n>>>  78: default[:zabbix][:agent][:prebuild_url]           = \"http://www.zabbix.com/downloads/:version:/zabbix_agents_:version:.:kernel:.:arch:.tar.gz\"\n     79: default[:zabbix][:agent][:prebuild_kernel]        = \"linux2_6\"\n     80: \n     81: # Web frontend\n     82: case platform\n     83: when \"redhat\", \"centos\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_oc-chef-client-attributes-default.rb", "content": "default[\"chef_client\"][\"winsw_url\"]   = \"http://repo1.maven.org/maven2/com/sun/winsw/winsw/1.9/winsw-1.9-bin.exe\"", "line": 90, "detection_span": [85, 95], "with_context": "\ndefault[\"chef_client\"][\"backup_path\"] = \"#{node[\"chef_client\"][\"conf_dir\"]}/backup\"\ndefault[\"chef_client\"][\"log_dir\"]     = \"#{node[\"chef_client\"][\"conf_dir\"]}/log\"\ndefault[\"chef_client\"][\"bin\"]         = \"C:/opscode/chef/bin/chef-client\"\n#Required for minsw wrapper\ndefault[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n90:   default[\"chef_client\"][\"winsw_url\"]   = \"http://repo1.maven.org/maven2/com/sun/winsw/winsw/1.9/winsw-1.9-bin.exe\"\ndefault[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\ndefault[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\nelse\ndefault[\"chef_client\"][\"init_style\"]  = \"none\"\ndefault[\"chef_client\"][\"run_path\"]    = \"/var/run\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_oc-chef-client-attributes-default.rb\n# Target line: 90\n\n     85:   default[\"chef_client\"][\"backup_path\"] = \"#{node[\"chef_client\"][\"conf_dir\"]}/backup\"\n     86:   default[\"chef_client\"][\"log_dir\"]     = \"#{node[\"chef_client\"][\"conf_dir\"]}/log\"\n     87:   default[\"chef_client\"][\"bin\"]         = \"C:/opscode/chef/bin/chef-client\"\n     88:   #Required for minsw wrapper\n     89:   default[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n>>>  90:   default[\"chef_client\"][\"winsw_url\"]   = \"http://repo1.maven.org/maven2/com/sun/winsw/winsw/1.9/winsw-1.9-bin.exe\"\n     91:   default[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\n     92:   default[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\n     93: else\n     94:   default[\"chef_client\"][\"init_style\"]  = \"none\"\n     95:   default[\"chef_client\"][\"run_path\"]    = \"/var/run\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aws_opsworks-cookbooks-opsworks_rubygems-recipes-default.rb", "content": "source \"http://rubygems.org/rubygems/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\"", "line": 2, "detection_span": [1, 7], "with_context": "\nrubygems_download = remote_file \"/tmp/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\" do\n2:   source \"http://rubygems.org/rubygems/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\"\nnot_if do\n::File.exists?('/usr/local/bin/gem') && `/usr/local/bin/gem -v`.strip == node[:opsworks_rubygems][:version]\nend\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-opsworks_rubygems-recipes-default.rb\n# Target line: 2\n\n      1: rubygems_download = remote_file \"/tmp/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\" do\n>>>   2:   source \"http://rubygems.org/rubygems/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\"\n      3:   not_if do\n      4:     ::File.exists?('/usr/local/bin/gem') && `/usr/local/bin/gem -v`.strip == node[:opsworks_rubygems][:version]\n      5:   end\n      6: end\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_hw-java-attributes-default.rb", "content": "default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-i586.tar.gz'", "line": 59, "detection_span": [54, 64], "with_context": "\n# x86_64\ndefault['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-x64.tar.gz'\ndefault['java']['jdk']['7']['x86_64']['checksum'] = 'aaf0296f08007cb178ff45dea61125aedb8af0450f82e0f2fd51df5391c9e837'\n\n# i586\n59: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-i586.tar.gz'\ndefault['java']['jdk']['7']['i586']['checksum'] = '422dfe67a4885d47c0053b97f4a56fb4dced60799a1bb82f8266b0745a7149f7'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_hw-java-attributes-default.rb\n# Target line: 59\n\n     54: # x86_64\n     55: default['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-x64.tar.gz'\n     56: default['java']['jdk']['7']['x86_64']['checksum'] = 'aaf0296f08007cb178ff45dea61125aedb8af0450f82e0f2fd51df5391c9e837'\n     57: \n     58: # i586\n>>>  59: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-i586.tar.gz'\n     60: default['java']['jdk']['7']['i586']['checksum'] = '422dfe67a4885d47c0053b97f4a56fb4dced60799a1bb82f8266b0745a7149f7'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "enterstudio_ey-cloud-recipes-cookbooks-sunspot-recipes-default.rb", "content": "source \"http://gemcutter.org\"", "line": 64, "detection_span": [59, 69], "with_context": "\nsource \"http://gemcutter.org\"\naction :install\nend\n\ngem_package \"nokogiri\" do\n64:     source \"http://gemcutter.org\"\naction :install\nend\n\nexecute \"install-sunspot-solr\" do\nuser node[:owner_name]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: enterstudio_ey-cloud-recipes-cookbooks-sunspot-recipes-default.rb\n# Target line: 64\n\n     59:     source \"http://gemcutter.org\"\n     60:     action :install\n     61:   end\n     62:   \n     63:   gem_package \"nokogiri\" do\n>>>  64:     source \"http://gemcutter.org\"\n     65:     action :install\n     66:   end\n     67:  \n     68:   execute \"install-sunspot-solr\" do\n     69:     user node[:owner_name]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aligent_chef-aligent-magento-dev-recipes-yum-nexcess.rb", "content": "baseurl \"http://rpms.nexcess.net/el/$releasever/scl/$basearch/\"", "line": 40, "detection_span": [35, 45], "with_context": "\nexclude \"mysql* varnish*\"\nend\n\nyum_repository \"nexcess_scl\" do\ndescription \"Nexcess Repo SCL\"\n40:     baseurl \"http://rpms.nexcess.net/el/$releasever/scl/$basearch/\"\ngpgcheck true\ngpgkey \"http://rpms.nexcess.net/RPM-GPG-KEY-NEXCESS\"\nenabled true\nexclude \"mysql* varnish*\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aligent_chef-aligent-magento-dev-recipes-yum-nexcess.rb\n# Target line: 40\n\n     35:     exclude \"mysql* varnish*\"\n     36: end\n     37: \n     38: yum_repository \"nexcess_scl\" do\n     39:     description \"Nexcess Repo SCL\"\n>>>  40:     baseurl \"http://rpms.nexcess.net/el/$releasever/scl/$basearch/\"\n     41:     gpgcheck true\n     42:     gpgkey \"http://rpms.nexcess.net/RPM-GPG-KEY-NEXCESS\"\n     43:     enabled true\n     44:     exclude \"mysql* varnish*\"\n     45: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb", "content": "baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"", "line": 31, "detection_span": [26, 36], "with_context": "\n#\n\n# Configure the Nexcess yum repo so we can match their php versions\nyum_repository \"iworx\" do\ndescription \"Interworx Repo\"\n31:     baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\ngpgcheck true\ngpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\nenabled true\nincludepkgs \"mod_fastcgi*\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb\n# Target line: 31\n\n     26: #\n     27: \n     28: # Configure the Nexcess yum repo so we can match their php versions\n     29: yum_repository \"iworx\" do\n     30:     description \"Interworx Repo\"\n>>>  31:     baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\n     32:     gpgcheck true\n     33:     gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\n     34:     enabled true\n     35:     includepkgs \"mod_fastcgi*\"\n     36: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-yum-attributes-remi.rb", "content": "default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"", "line": 24, "detection_span": [19, 29], "with_context": "\n\ncase node['platform']\nwhen \"fedora\"\ndefault['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\nelse\n24:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\nend\n\ndefault['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"\ndefault['yum']['remi']['key_url'] = \"http://rpms.famillecollet.com/#{node['yum']['remi']['key']}\"\ndefault['yum']['remi']['includepkgs'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-yum-attributes-remi.rb\n# Target line: 24\n\n     19: \n     20: case node['platform']\n     21: when \"fedora\"\n     22:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\n     23: else\n>>>  24:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\n     25: end\n     26: \n     27: default['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"\n     28: default['yum']['remi']['key_url'] = \"http://rpms.famillecollet.com/#{node['yum']['remi']['key']}\"\n     29: default['yum']['remi']['includepkgs'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-yum-epel-attributes-epel-testing-source.rb", "content": "default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault['yum']['epel-testing-source']['repositoryid'] = 'epel-testing-source'\ndefault['yum']['epel-testing-source']['description'] = \"Extra Packages for #{node['platform_version'].to_i} - $basearch - Testing Source\"\ncase node['platform']\nwhen 'amazon'\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\n6:   default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\ndefault['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\ndefault['yum']['epel-testing-source']['gpgkey'] = \"https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\nend\ndefault['yum']['epel-testing-source']['failovermethod'] = 'priority'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-yum-epel-attributes-epel-testing-source.rb\n# Target line: 6\n\n      1: default['yum']['epel-testing-source']['repositoryid'] = 'epel-testing-source'\n      2: default['yum']['epel-testing-source']['description'] = \"Extra Packages for #{node['platform_version'].to_i} - $basearch - Testing Source\"\n      3: case node['platform']\n      4: when 'amazon'\n      5:   default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\n>>>   6:   default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      7: else\n      8:   default['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\n      9:   default['yum']['epel-testing-source']['gpgkey'] = \"https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\n     10: end\n     11: default['yum']['epel-testing-source']['failovermethod'] = 'priority'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-phpapp-definitions-wordpress_site.rb", "content": "source 'http://wordpress.org/latest.tar.gz'", "line": 5, "detection_span": [1, 10], "with_context": "\ndefine :wordpress_site, :path => \"/var/www/phpapp\",:database => \"phpapp\", :db_username => \"phpapp\",:db_password => \"phpapp\", :db_host => \"localhost\",  :template => \"site.conf.erb\" do\nwordpress_latest = Chef::Config[:file_cache_path] + '/wordpress-latest.tar.gz'\n\nremote_file wordpress_latest do\n5:     source 'http://wordpress.org/latest.tar.gz'\nmode 0644\nend\n\ndirectory params[:path] do\nowner 'root'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-phpapp-definitions-wordpress_site.rb\n# Target line: 5\n\n      1: define :wordpress_site, :path => \"/var/www/phpapp\",:database => \"phpapp\", :db_username => \"phpapp\",:db_password => \"phpapp\", :db_host => \"localhost\",  :template => \"site.conf.erb\" do\n      2:   wordpress_latest = Chef::Config[:file_cache_path] + '/wordpress-latest.tar.gz'\n      3: \n      4:   remote_file wordpress_latest do\n>>>   5:     source 'http://wordpress.org/latest.tar.gz'\n      6:     mode 0644\n      7:   end\n      8: \n      9:   directory params[:path] do\n     10:     owner 'root'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-redis-cookbooks-snappy-attributes-default.rb", "content": "default[:snappy][:release_url]       = \"http://snappy.googlecode.com/files/snappy-:version:.tar.gz\"", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault[:snappy][:home_dir]          = '/usr/local/share/snappy'\n\ndefault[:snappy][:version]           = \"1.0.4\"\n4: default[:snappy][:release_url]       = \"http://snappy.googlecode.com/files/snappy-:version:.tar.gz\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-snappy-attributes-default.rb\n# Target line: 4\n\n      1: default[:snappy][:home_dir]          = '/usr/local/share/snappy'\n      2: \n      3: default[:snappy][:version]           = \"1.0.4\"\n>>>   4: default[:snappy][:release_url]       = \"http://snappy.googlecode.com/files/snappy-:version:.tar.gz\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Soluciones_ey-cloud-recipes-cookbooks-php55-providers-default.rb", "content": "source \"http://download.newrelic.com/php_agent/archive/#{node[:newrelic][:php_rpm_version]}/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\"", "line": 29, "detection_span": [24, 34], "with_context": "\naction :create\nrecursive true\nend\n\nremote_file \"/opt/php_rpm/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\" do\n29:     source \"http://download.newrelic.com/php_agent/archive/#{node[:newrelic][:php_rpm_version]}/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\"\naction :create_if_missing\nend\n\n# Install newrelic PHP as 'root' user using silent install\nbash \"install_newrelic_php\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-php55-providers-default.rb\n# Target line: 29\n\n     24:     action :create\n     25:     recursive true\n     26:   end\n     27: \n     28:   remote_file \"/opt/php_rpm/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\" do\n>>>  29:     source \"http://download.newrelic.com/php_agent/archive/#{node[:newrelic][:php_rpm_version]}/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\"\n     30:     action :create_if_missing\n     31:   end\n     32: \n     33:   # Install newrelic PHP as 'root' user using silent install\n     34:   bash \"install_newrelic_php\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redu_ey-cloud-recipes-cookbooks-riak-recipes-install_riak.rb", "content": "source \"http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/CURRENT/riak-#{node[:riak][:version]}.tar.gz\"", "line": 10, "detection_span": [5, 15], "with_context": "\nversion '1.7.0'\naction :install\nend\n\nremote_file \"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\" do\n10:   source \"http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/CURRENT/riak-#{node[:riak][:version]}.tar.gz\"\nbackup 0\nnot_if { FileTest.exists?(\"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\") }\nend\n\nexecute \"untar riak\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: redu_ey-cloud-recipes-cookbooks-riak-recipes-install_riak.rb\n# Target line: 10\n\n      5:   version '1.7.0'\n      6:   action :install\n      7: end\n      8: \n      9: remote_file \"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\" do\n>>>  10:   source \"http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/CURRENT/riak-#{node[:riak][:version]}.tar.gz\"\n     11:   backup 0\n     12:   not_if { FileTest.exists?(\"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\") }\n     13: end\n     14: \n     15: execute \"untar riak\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-mongodb-attributes-default.rb", "content": "default[:mongodb][:x86_64][:release_url]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.2.1.tgz\"", "line": 36, "detection_span": [31, 41], "with_context": "\n\ndefault[:mongodb][:version]                         = \"2.2.1\"\ndefault[:mongodb][:i686][:release_file_md5]         = \"21153b201cad912c273d754b02eba19b\"\ndefault[:mongodb][:i686][:release_url]              = \"http://fastdl.mongodb.org/linux/mongodb-linux-i686-2.2.1.tgz\"\ndefault[:mongodb][:x86_64][:release_file_md5]       = \"6b2cce94194113ebfe2a14bdb84ccd7e\"\n36: default[:mongodb][:x86_64][:release_url]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.2.1.tgz\"\n\n#\n# Services\n#\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-mongodb-attributes-default.rb\n# Target line: 36\n\n     31: \n     32: default[:mongodb][:version]                         = \"2.2.1\"\n     33: default[:mongodb][:i686][:release_file_md5]         = \"21153b201cad912c273d754b02eba19b\"\n     34: default[:mongodb][:i686][:release_url]              = \"http://fastdl.mongodb.org/linux/mongodb-linux-i686-2.2.1.tgz\"\n     35: default[:mongodb][:x86_64][:release_file_md5]       = \"6b2cce94194113ebfe2a14bdb84ccd7e\"\n>>>  36: default[:mongodb][:x86_64][:release_url]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.2.1.tgz\"\n     37: \n     38: #\n     39: # Services\n     40: #\n     41: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-yum-epel-attributes-epel-testing-source.rb", "content": "default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel5&arch=$basearch'", "line": 12, "detection_span": [7, 17], "with_context": "\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\ncase node['platform_version'].to_i\nwhen 5\ndefault['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 5 - Testing - $basearch Source'\n12:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel5&arch=$basearch'\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\nwhen 6\ndefault['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 6 - Testing - $basearch Source'\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'https://mirrors.fedoraproject.org/metalink?repo=testing-source-epel6&arch=$basearch'\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-yum-epel-attributes-epel-testing-source.rb\n# Target line: 12\n\n      7:   default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      8: else\n      9:   case node['platform_version'].to_i\n     10:   when 5\n     11:     default['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 5 - Testing - $basearch Source'\n>>>  12:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel5&arch=$basearch'\n     13:     default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\n     14:   when 6\n     15:     default['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 6 - Testing - $basearch Source'\n     16:     default['yum']['epel-testing-source']['mirrorlist'] = 'https://mirrors.fedoraproject.org/metalink?repo=testing-source-epel6&arch=$basearch'\n     17:     default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "DrRayWang_Chef-Base-cookbooks-bach_spark-attributes-default.rb", "content": "default[:spark][:download][:url] = \"http://d3kbcqa49mib13.cloudfront.net\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:spark][:download][:url] = \"http://d3kbcqa49mib13.cloudfront.net\"\ndefault[:spark][:download][:file][:name] = \"spark-1.4.0-bin-hadoop2.6\"\ndefault[:spark][:download][:file][:type] = \"tgz\"\ndefault[:spark][:download][:dir] = \"/home/vagrant/chef-bcpc/bins\"\ndefault[:spark][:package][:base] = \"/usr/spark\"\ndefault[:spark][:package][:prefix] = \"spark\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bach_spark-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:spark][:download][:url] = \"http://d3kbcqa49mib13.cloudfront.net\"\n      2: default[:spark][:download][:file][:name] = \"spark-1.4.0-bin-hadoop2.6\"\n      3: default[:spark][:download][:file][:type] = \"tgz\"\n      4: default[:spark][:download][:dir] = \"/home/vagrant/chef-bcpc/bins\"\n      5: default[:spark][:package][:base] = \"/usr/spark\"\n      6: default[:spark][:package][:prefix] = \"spark\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_nd-sensu-community-plugins-plugins-newrelic-newrelic-metrics.rb", "content": "rpm = \"http://rpm.newrelic.com\"", "line": 43, "detection_span": [38, 48], "with_context": "\n:short => \"-s SCHEME\",\n:long => \"--scheme SCHEME\",\n:default => \"#{Socket.gethostname}.newrelic\"\n\ndef run\n43:     rpm = \"http://rpm.newrelic.com\"\n\nurl = URI.parse(rpm)\n\nres = Net::HTTP.start(url.host, url.port) do |http|\nreq = Net::HTTP::Get.new(\"/accounts.xml?include=application_health\")", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_nd-sensu-community-plugins-plugins-newrelic-newrelic-metrics.rb\n# Target line: 43\n\n     38:     :short => \"-s SCHEME\",\n     39:     :long => \"--scheme SCHEME\",\n     40:     :default => \"#{Socket.gethostname}.newrelic\"\n     41: \n     42:   def run\n>>>  43:     rpm = \"http://rpm.newrelic.com\"\n     44: \n     45:     url = URI.parse(rpm)\n     46: \n     47:     res = Net::HTTP.start(url.host, url.port) do |http|\n     48:       req = Net::HTTP::Get.new(\"/accounts.xml?include=application_health\")\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-nagios-attributes-server.rb", "content": "default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'", "line": 34, "detection_span": [29, 39], "with_context": "\nwhen /^hls/\ndefault['nagios']['pagerduty_key'] = String.new\ndefault['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\nwhen /^staging-hls/\ndefault['nagios']['pagerduty_key'] = String.new\n34:   default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\nwhen /^stage/\ndefault['nagios']['pagerduty_key'] = String.new\ndefault['nagios']['server']['url'] = 'http://yum.ihr/files'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nagios-attributes-server.rb\n# Target line: 34\n\n     29: when /^hls/\n     30:   default['nagios']['pagerduty_key'] = String.new\n     31:   default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n     32: when /^staging-hls/\n     33:   default['nagios']['pagerduty_key'] = String.new\n>>>  34:   default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n     35: when /^stage/\n     36:   default['nagios']['pagerduty_key'] = String.new\n     37:   default['nagios']['server']['url'] = 'http://yum.ihr/files'\n     38: end\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "shortdudey123_chef-gluster-recipes-repository.rb", "content": "repo_url = \"http://#{subdomain}.centos.org/centos/$releasever/storage/$basearch/gluster-#{node['gluster']['version']}/\"", "line": 58, "detection_span": [53, 63], "with_context": "\nelse\nsubdomain = 'mirror'\ngpg_url = 'https://raw.githubusercontent.com/CentOS-Storage-SIG/centos-release-storage-common/master/RPM-GPG-KEY-CentOS-SIG-Storage'\nend\n\n58:     repo_url = \"http://#{subdomain}.centos.org/centos/$releasever/storage/$basearch/gluster-#{node['gluster']['version']}/\"\nelse\nurl = \"https://download.gluster.org/pub/gluster/glusterfs/#{node['gluster']['version']}/LATEST/EPEL.repo\"\nrepo_url = \"#{url}/epel-$releasever/$basearch/\"\ngpg_url = \"#{url}/dsa.pub\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: shortdudey123_chef-gluster-recipes-repository.rb\n# Target line: 58\n\n     53:     else\n     54:       subdomain = 'mirror'\n     55:       gpg_url = 'https://raw.githubusercontent.com/CentOS-Storage-SIG/centos-release-storage-common/master/RPM-GPG-KEY-CentOS-SIG-Storage'\n     56:     end\n     57: \n>>>  58:     repo_url = \"http://#{subdomain}.centos.org/centos/$releasever/storage/$basearch/gluster-#{node['gluster']['version']}/\"\n     59:   else\n     60:     url = \"https://download.gluster.org/pub/gluster/glusterfs/#{node['gluster']['version']}/LATEST/EPEL.repo\"\n     61:     repo_url = \"#{url}/epel-$releasever/$basearch/\"\n     62:     gpg_url = \"#{url}/dsa.pub\"\n     63:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb", "content": "default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'", "line": 20, "detection_span": [15, 25], "with_context": "\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nend\n\ndefault['yum']['epel']['failovermethod'] = 'priority'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb\n# Target line: 20\n\n     15:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n     16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n     17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n>>>  20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\n     21:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     22:   end\n     23: end\n     24: \n     25: default['yum']['epel']['failovermethod'] = 'priority'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Soluciones_ey-cloud-recipes-cookbooks-jenkins-recipes-jetty_install.rb", "content": "source \"http://download.eclipse.org/jetty/8.1.17.v20150415/dist/jetty-distribution-8.1.17.v20150415.tar.gz\"", "line": 2, "detection_span": [1, 7], "with_context": "\nremote_file \"/tmp/jetty.tar.gz\" do\n2:   source \"http://download.eclipse.org/jetty/8.1.17.v20150415/dist/jetty-distribution-8.1.17.v20150415.tar.gz\"\naction :create_if_missing\nmode 0644\nend\n\nremote_file \"/etc/monit.d/jetty.monitrc\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-jenkins-recipes-jetty_install.rb\n# Target line: 2\n\n      1: remote_file \"/tmp/jetty.tar.gz\" do\n>>>   2:   source \"http://download.eclipse.org/jetty/8.1.17.v20150415/dist/jetty-distribution-8.1.17.v20150415.tar.gz\"\n      3:   action :create_if_missing\n      4:   mode 0644\n      5: end\n      6: \n      7: remote_file \"/etc/monit.d/jetty.monitrc\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-attivio-recipes-backups.rb", "content": "source \"http://yum.ihr/files/nagios/check_attivio_backup_freshness.sh\"", "line": 68, "detection_span": [63, 73], "with_context": "\ngroup \"root\"\nmode \"0755\"\nend\n\nremote_file \"/root/scripts/check_attivio_backup_freshness.sh\" do\n68:   source \"http://yum.ihr/files/nagios/check_attivio_backup_freshness.sh\"\naction :create_if_missing\nowner \"root\"\ngroup \"root\"\nmode \"0755\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-attivio-recipes-backups.rb\n# Target line: 68\n\n     63:   group \"root\"\n     64:   mode \"0755\"\n     65: end\n     66: \n     67: remote_file \"/root/scripts/check_attivio_backup_freshness.sh\" do\n>>>  68:   source \"http://yum.ihr/files/nagios/check_attivio_backup_freshness.sh\"\n     69:   action :create_if_missing\n     70:   owner \"root\"\n     71:   group \"root\"\n     72:   mode \"0755\"\n     73: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_oc-mysql-attributes-server.rb", "content": "default['mysql']['url']                     = \"http://www.mysql.com/get/Downloads/MySQL-5.5/#{mysql['package_file']}/from/http://mysql.mirrors.pair.com/\"", "line": 61, "detection_span": [56, 66], "with_context": "\nwhen \"windows\"\ndefault['mysql']['server']['packages']      = [\"MySQL Server 5.5\"]\ndefault['mysql']['version']                 = '5.5.21'\ndefault['mysql']['arch']                    = 'win32'\ndefault['mysql']['package_file']            = \"mysql-#{mysql['version']}-#{mysql['arch']}.msi\"\n61:   default['mysql']['url']                     = \"http://www.mysql.com/get/Downloads/MySQL-5.5/#{mysql['package_file']}/from/http://mysql.mirrors.pair.com/\"\n\ndefault['mysql']['service_name']            = \"mysql\"\ndefault['mysql']['basedir']                 = \"#{ENV['SYSTEMDRIVE']}\\\\Program Files (x86)\\\\MySQL\\\\#{mysql['server']['packages'].first}\"\ndefault['mysql']['data_dir']                = \"#{mysql['basedir']}\\\\Data\"\ndefault['mysql']['bin_dir']                 = \"#{mysql['basedir']}\\\\bin\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_oc-mysql-attributes-server.rb\n# Target line: 61\n\n     56: when \"windows\"\n     57:   default['mysql']['server']['packages']      = [\"MySQL Server 5.5\"]\n     58:   default['mysql']['version']                 = '5.5.21'\n     59:   default['mysql']['arch']                    = 'win32'\n     60:   default['mysql']['package_file']            = \"mysql-#{mysql['version']}-#{mysql['arch']}.msi\"\n>>>  61:   default['mysql']['url']                     = \"http://www.mysql.com/get/Downloads/MySQL-5.5/#{mysql['package_file']}/from/http://mysql.mirrors.pair.com/\"\n     62: \n     63:   default['mysql']['service_name']            = \"mysql\"\n     64:   default['mysql']['basedir']                 = \"#{ENV['SYSTEMDRIVE']}\\\\Program Files (x86)\\\\MySQL\\\\#{mysql['server']['packages'].first}\"\n     65:   default['mysql']['data_dir']                = \"#{mysql['basedir']}\\\\Data\"\n     66:   default['mysql']['bin_dir']                 = \"#{mysql['basedir']}\\\\bin\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-ntp-attributes-default.rb", "content": "default['ntp']['vs_runtime_url'] = 'http://download.microsoft.com/download/1/1/1/1116b75a-9ec3-481a-a3c8-1777b5381140/vcredist_x86.exe'", "line": 62, "detection_span": [57, 67], "with_context": "\ndefault['ntp']['driftfile'] = 'C:\\\\NTP\\\\ntp.drift'\ndefault['ntp']['conffile'] = 'C:\\\\NTP\\\\etc\\\\ntp.conf'\ndefault['ntp']['conf_owner'] = 'Administrators'\ndefault['ntp']['conf_group'] = 'Administrators'\ndefault['ntp']['package_url'] = 'http://www.meinbergglobal.com/download/ntp/windows/ntp-4.2.6p5@london-o-lpv-win32-setup.exe'\n62:   default['ntp']['vs_runtime_url'] = 'http://download.microsoft.com/download/1/1/1/1116b75a-9ec3-481a-a3c8-1777b5381140/vcredist_x86.exe'\ndefault['ntp']['vs_runtime_productname'] = 'Microsoft Visual C++ 2008 Redistributable - x86 9.0.21022'\nwhen 'freebsd'\ndefault['ntp']['packages'] = %w(ntp)\ndefault['ntp']['varlibdir'] = '/var/db'\ndefault['ntp']['driftfile'] = \"#{node['ntp']['varlibdir']}/ntpd.drift\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-ntp-attributes-default.rb\n# Target line: 62\n\n     57:   default['ntp']['driftfile'] = 'C:\\\\NTP\\\\ntp.drift'\n     58:   default['ntp']['conffile'] = 'C:\\\\NTP\\\\etc\\\\ntp.conf'\n     59:   default['ntp']['conf_owner'] = 'Administrators'\n     60:   default['ntp']['conf_group'] = 'Administrators'\n     61:   default['ntp']['package_url'] = 'http://www.meinbergglobal.com/download/ntp/windows/ntp-4.2.6p5@london-o-lpv-win32-setup.exe'\n>>>  62:   default['ntp']['vs_runtime_url'] = 'http://download.microsoft.com/download/1/1/1/1116b75a-9ec3-481a-a3c8-1777b5381140/vcredist_x86.exe'\n     63:   default['ntp']['vs_runtime_productname'] = 'Microsoft Visual C++ 2008 Redistributable - x86 9.0.21022'\n     64: when 'freebsd'\n     65:   default['ntp']['packages'] = %w(ntp)\n     66:   default['ntp']['varlibdir'] = '/var/db'\n     67:   default['ntp']['driftfile'] = \"#{node['ntp']['varlibdir']}/ntpd.drift\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "thomasmeeus_chef-apache2-recipes-mod_auth_openid.rb", "content": "source   'http://kin.klever.net/dist/libopkele-2.0.4.tar.gz'", "line": 50, "detection_span": [45, 55], "with_context": "\nend\n\ncase node['platform_family']\nwhen 'rhel', 'fedora'\nremote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n50:     source   'http://kin.klever.net/dist/libopkele-2.0.4.tar.gz'\nmode     '0644'\nchecksum '57a5bc753b7e80c5ece1e5968b2051b0ce7ed9ce4329d17122c61575a9ea7648'\nend\n\nbash 'install libopkele' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: thomasmeeus_chef-apache2-recipes-mod_auth_openid.rb\n# Target line: 50\n\n     45: end\n     46: \n     47: case node['platform_family']\n     48: when 'rhel', 'fedora'\n     49:   remote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n>>>  50:     source   'http://kin.klever.net/dist/libopkele-2.0.4.tar.gz'\n     51:     mode     '0644'\n     52:     checksum '57a5bc753b7e80c5ece1e5968b2051b0ce7ed9ce4329d17122c61575a9ea7648'\n     53:   end\n     54: \n     55:   bash 'install libopkele' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_nd-chef-sensu-recipes-rabbitmq.rb", "content": "key \"http://binaries.erlang-solutions.com/debian/erlang_solutions.asc\"", "line": 53, "detection_span": [48, 58], "with_context": "\n\napt_repository \"esl\" do\nuri \"http://binaries.erlang-solutions.com/debian\"\ndistribution node.lsb.codename\ncomponents [\"contrib\"]\n53:     key \"http://binaries.erlang-solutions.com/debian/erlang_solutions.asc\"\naction :add\nend\n\npackage \"esl-erlang\"\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_nd-chef-sensu-recipes-rabbitmq.rb\n# Target line: 53\n\n     48: \n     49:   apt_repository \"esl\" do\n     50:     uri \"http://binaries.erlang-solutions.com/debian\"\n     51:     distribution node.lsb.codename\n     52:     components [\"contrib\"]\n>>>  53:     key \"http://binaries.erlang-solutions.com/debian/erlang_solutions.asc\"\n     54:     action :add\n     55:   end\n     56: \n     57:   package \"esl-erlang\"\n     58: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-basejump-attributes-default.rb", "content": "default[:basejump][:kickstarter][:syslinux_url] = \"http://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-5.01.tar.gz\"", "line": 21, "detection_span": [16, 26], "with_context": "\ndefault['basejump']['packages'] = %w[ python-mysqldb libmysqlclient-dev xinetd tftpd syslinux ]\nwhen \"redhat\",\"centos\",\"scientific\",\"amazon\"\ndefault['basejump']['packages'] = %w[ MySQL-python mysql-devel syslinux ]\nend\n\n21: default[:basejump][:kickstarter][:syslinux_url] = \"http://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-5.01.tar.gz\"\ndefault[:basejump][:kickstarter][:syslinux_links] = ({\n\"ldlinux.c32\" => \"syslinux-5.01/com32/elflink/ldlinux/ldlinux.c32\",\n\"libutil.c32\" => \"syslinux-5.01/com32/libutil/libutil.c32\",\n\"modules/reboot.c32\" => \"syslinux-5.01/com32/modules/reboot.c32\",\n\"libcom32.c32\" => \"syslinux-5.01/com32/lib/libcom32.c32\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-basejump-attributes-default.rb\n# Target line: 21\n\n     16:   default['basejump']['packages'] = %w[ python-mysqldb libmysqlclient-dev xinetd tftpd syslinux ]\n     17: when \"redhat\",\"centos\",\"scientific\",\"amazon\"\n     18:   default['basejump']['packages'] = %w[ MySQL-python mysql-devel syslinux ]\n     19: end\n     20: \n>>>  21: default[:basejump][:kickstarter][:syslinux_url] = \"http://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-5.01.tar.gz\"\n     22: default[:basejump][:kickstarter][:syslinux_links] = ({\n     23:                                                        \"ldlinux.c32\" => \"syslinux-5.01/com32/elflink/ldlinux/ldlinux.c32\",\n     24:                                                        \"libutil.c32\" => \"syslinux-5.01/com32/libutil/libutil.c32\",\n     25:                                                        \"modules/reboot.c32\" => \"syslinux-5.01/com32/modules/reboot.c32\",\n     26:                                                        \"libcom32.c32\" => \"syslinux-5.01/com32/lib/libcom32.c32\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mackerelio_cookbook-mackerel-agent-recipes-default.rb", "content": "uri 'http://apt.mackerel.io/v2/'", "line": 65, "detection_span": [60, 70], "with_context": "\npackage_options = '--yes -o Dpkg::Options::=\"--force-confdef\" -o Dpkg::Options::=\"--force-confold\"'\ninclude_recipe 'apt'\n\nif supports_v2_repository\napt_repository \"mackerel\" do\n65:       uri 'http://apt.mackerel.io/v2/'\nkey gpgkey_url_v2\ndistribution 'mackerel'\ncomponents ['contrib']\narch 'amd64,arm64'\naction :add", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mackerelio_cookbook-mackerel-agent-recipes-default.rb\n# Target line: 65\n\n     60:   package_options = '--yes -o Dpkg::Options::=\"--force-confdef\" -o Dpkg::Options::=\"--force-confold\"'\n     61:   include_recipe 'apt'\n     62: \n     63:   if supports_v2_repository\n     64:     apt_repository \"mackerel\" do\n>>>  65:       uri 'http://apt.mackerel.io/v2/'\n     66:       key gpgkey_url_v2\n     67:       distribution 'mackerel'\n     68:       components ['contrib']\n     69:       arch 'amd64,arm64'\n     70:       action :add\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "EEDARIT_opsworks-cookbooks-ms_dotnet45-attributes-default.rb", "content": "default['ms_dotnet45']['http_url'] = 'http://download.microsoft.com/download/E/2/1/E21644B5-2DF2-47C2-91BD-63C560427900/NDP452-KB2901907-x86-x64-AllOS-ENU.exe'", "line": 21, "detection_span": [16, 26], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n21: default['ms_dotnet45']['http_url'] = 'http://download.microsoft.com/download/E/2/1/E21644B5-2DF2-47C2-91BD-63C560427900/NDP452-KB2901907-x86-x64-AllOS-ENU.exe'\ndefault['ms_dotnet45']['timeout'] = 600", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: EEDARIT_opsworks-cookbooks-ms_dotnet45-attributes-default.rb\n# Target line: 21\n\n     16: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     17: # See the License for the specific language governing permissions and\n     18: # limitations under the License.\n     19: #\n     20: \n>>>  21: default['ms_dotnet45']['http_url'] = 'http://download.microsoft.com/download/E/2/1/E21644B5-2DF2-47C2-91BD-63C560427900/NDP452-KB2901907-x86-x64-AllOS-ENU.exe'\n     22: default['ms_dotnet45']['timeout'] = 600\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_nd-chef-client-attributes-default.rb", "content": "default[\"chef_client\"][\"winsw_url\"]   = \"http://maven.dyndns.org/2/com/sun/winsw/winsw/1.8/winsw-1.8-bin.exe\"", "line": 62, "detection_span": [57, 67], "with_context": "\ndefault[\"chef_client\"][\"backup_path\"] = \"C:/var/chef/backup\"\ndefault[\"chef_client\"][\"conf_dir\"]    = \"C:/chef\"\ndefault[\"chef_client\"][\"bin\"]         = File.join(Gem.bindir, \"chef-client\")\n#Required for minsw wrapper\ndefault[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n62:   default[\"chef_client\"][\"winsw_url\"]   = \"http://maven.dyndns.org/2/com/sun/winsw/winsw/1.8/winsw-1.8-bin.exe\"\ndefault[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\ndefault[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\nelse\ndefault[\"chef_client\"][\"init_style\"]  = \"none\"\ndefault[\"chef_client\"][\"run_path\"]    = \"/var/run\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_nd-chef-client-attributes-default.rb\n# Target line: 62\n\n     57:   default[\"chef_client\"][\"backup_path\"] = \"C:/var/chef/backup\"\n     58:   default[\"chef_client\"][\"conf_dir\"]    = \"C:/chef\"\n     59:   default[\"chef_client\"][\"bin\"]         = File.join(Gem.bindir, \"chef-client\")\n     60:   #Required for minsw wrapper\n     61:   default[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n>>>  62:   default[\"chef_client\"][\"winsw_url\"]   = \"http://maven.dyndns.org/2/com/sun/winsw/winsw/1.8/winsw-1.8-bin.exe\"\n     63:   default[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\n     64:   default[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\n     65: else\n     66:   default[\"chef_client\"][\"init_style\"]  = \"none\"\n     67:   default[\"chef_client\"][\"run_path\"]    = \"/var/run\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_hw-nginx-attributes-geoip.rb", "content": "default['nginx']['geoip']['lib_url']              = \"http://geolite.maxmind.com/download/geoip/api/c/GeoIP-#{node['nginx']['geoip']['lib_version']}.tar.gz\"", "line": 29, "detection_span": [24, 34], "with_context": "\ndefault['nginx']['geoip']['country_dat_url']      = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz\"\ndefault['nginx']['geoip']['country_dat_checksum'] = \"bbd5ea2bf1de800237a56ea0600f3d8ede2e2956937a8e632118f397af75adfa\",\ndefault['nginx']['geoip']['city_dat_url']         = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz\"\ndefault['nginx']['geoip']['city_dat_checksum']    = \"097f74d8295f82ca256d522497c3a105aaa6a353260c5d2c084156b29a54d431\"\ndefault['nginx']['geoip']['lib_version']          = \"1.4.8\"\n29: default['nginx']['geoip']['lib_url']              = \"http://geolite.maxmind.com/download/geoip/api/c/GeoIP-#{node['nginx']['geoip']['lib_version']}.tar.gz\"\ndefault['nginx']['geoip']['lib_checksum']         = \"cf0f6b2bac1153e34d6ef55ee3851479b347d2b5c191fda8ff6a51fab5291ff4\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_hw-nginx-attributes-geoip.rb\n# Target line: 29\n\n     24: default['nginx']['geoip']['country_dat_url']      = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz\"\n     25: default['nginx']['geoip']['country_dat_checksum'] = \"bbd5ea2bf1de800237a56ea0600f3d8ede2e2956937a8e632118f397af75adfa\",\n     26: default['nginx']['geoip']['city_dat_url']         = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz\"\n     27: default['nginx']['geoip']['city_dat_checksum']    = \"097f74d8295f82ca256d522497c3a105aaa6a353260c5d2c084156b29a54d431\"\n     28: default['nginx']['geoip']['lib_version']          = \"1.4.8\"\n>>>  29: default['nginx']['geoip']['lib_url']              = \"http://geolite.maxmind.com/download/geoip/api/c/GeoIP-#{node['nginx']['geoip']['lib_version']}.tar.gz\"\n     30: default['nginx']['geoip']['lib_checksum']         = \"cf0f6b2bac1153e34d6ef55ee3851479b347d2b5c191fda8ff6a51fab5291ff4\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-java-attributes-default.rb", "content": "default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-i586.tar.gz'", "line": 76, "detection_span": [71, 81], "with_context": "\n# x86_64\ndefault['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-x64.tar.gz'\ndefault['java']['jdk']['7']['x86_64']['checksum'] = '8611ce31e0b7ecb99d34703ad89b29a545a3fb30356553be3674366cbe722782'\n\n# i586\n76: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-i586.tar.gz'\ndefault['java']['jdk']['7']['i586']['checksum'] = '4046e941e05717538dd4deb1b1f55cb8bb6bd38793c7317034d1f5019086d956'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-java-attributes-default.rb\n# Target line: 76\n\n     71: # x86_64\n     72: default['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-x64.tar.gz'\n     73: default['java']['jdk']['7']['x86_64']['checksum'] = '8611ce31e0b7ecb99d34703ad89b29a545a3fb30356553be3674366cbe722782'\n     74: \n     75: # i586\n>>>  76: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-i586.tar.gz'\n     77: default['java']['jdk']['7']['i586']['checksum'] = '4046e941e05717538dd4deb1b1f55cb8bb6bd38793c7317034d1f5019086d956'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "AYCHIT_Asf-chef-cookbooks-psf-pypi-recipes-warehouse.rb", "content": "uri \"http://ppa.launchpad.net/pypy/ppa/ubuntu\"", "line": 22, "detection_span": [17, 27], "with_context": "\n\"WAREHOUSE_CONF\" => \"/opt/warehouse/etc/config.yml\",\n\"SENTRY_DSN\" => secrets[\"sentry\"][\"dsn\"],\n}\n\napt_repository \"pypy\" do\n22:     uri \"http://ppa.launchpad.net/pypy/ppa/ubuntu\"\ndistribution node['lsb']['codename']\ncomponents [\"main\"]\nkeyserver \"keyserver.ubuntu.com\"\nkey \"2862D0785AFACD8C65B23DB0251104D968854915\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: AYCHIT_Asf-chef-cookbooks-psf-pypi-recipes-warehouse.rb\n# Target line: 22\n\n     17:   \"WAREHOUSE_CONF\" => \"/opt/warehouse/etc/config.yml\",\n     18:   \"SENTRY_DSN\" => secrets[\"sentry\"][\"dsn\"],\n     19: }\n     20: \n     21: apt_repository \"pypy\" do\n>>>  22:     uri \"http://ppa.launchpad.net/pypy/ppa/ubuntu\"\n     23:     distribution node['lsb']['codename']\n     24:     components [\"main\"]\n     25:     keyserver \"keyserver.ubuntu.com\"\n     26:     key \"2862D0785AFACD8C65B23DB0251104D968854915\"\n     27: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-attributes-default.rb", "content": "default['bcpc']['repos']['ceph'] = \"http://www.ceph.com/debian-dumpling\"", "line": 102, "detection_span": [97, 107], "with_context": "\n###########################################\n#\n#  Repos for things we rely on\n100: #\n101: ###########################################\n102: default['bcpc']['repos']['ceph'] = \"http://www.ceph.com/debian-dumpling\"\n103: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n104: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n105: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n106: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n107: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-attributes-default.rb\n# Target line: 102\n\n     97: ###########################################\n     98: #\n     99: #  Repos for things we rely on\n    100: #\n    101: ###########################################\n>>> 102: default['bcpc']['repos']['ceph'] = \"http://www.ceph.com/debian-dumpling\"\n    103: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n    104: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n    105: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n    106: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n    107: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-hadoop_cluster-cookbooks-jruby-attributes-default.rb", "content": "default[:jruby][:release_url]       = \"http://jruby.org.s3.amazonaws.com/downloads/:version:/jruby-bin-:version:.tar.gz\"", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault[:jruby][:home_dir]          = '/usr/local/share/jruby'\n\ndefault[:jruby][:version]           = \"1.6.7.2\"\n4: default[:jruby][:release_url]       = \"http://jruby.org.s3.amazonaws.com/downloads/:version:/jruby-bin-:version:.tar.gz\"\n\n# what version of ruby to behave like\ndefault[:jruby][:ruby_version]      = \"1.9\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-hadoop_cluster-cookbooks-jruby-attributes-default.rb\n# Target line: 4\n\n      1: default[:jruby][:home_dir]          = '/usr/local/share/jruby'\n      2: \n      3: default[:jruby][:version]           = \"1.6.7.2\"\n>>>   4: default[:jruby][:release_url]       = \"http://jruby.org.s3.amazonaws.com/downloads/:version:/jruby-bin-:version:.tar.gz\"\n      5: \n      6: # what version of ruby to behave like\n      7: default[:jruby][:ruby_version]      = \"1.9\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-mysql-attributes-server_windows.rb", "content": "default['mysql']['windows']['url']                = \"http://dev.mysql.com/get/Downloads/MySQL-5.5/#{node['mysql']['windows']['package_file']}\"", "line": 7, "detection_span": [2, 12], "with_context": "\nwhen 'windows'\ndefault['mysql']['windows']['version']            = '5.5.34'\ndefault['mysql']['windows']['arch']               = node['kernel']['machine'] == 'x86_64' ? 'winx64' : 'win32'\ndefault['mysql']['windows']['package_file']       = \"mysql-#{node['mysql']['windows']['version']}-#{node['mysql']['windows']['arch']}.msi\"\ndefault['mysql']['windows']['packages']           = ['MySQL Server 5.5']\n7:   default['mysql']['windows']['url']                = \"http://dev.mysql.com/get/Downloads/MySQL-5.5/#{node['mysql']['windows']['package_file']}\"\n\ndefault['mysql']['windows']['programdir']         = node['kernel']['machine'] == 'x86_64' ? 'Program Files' : 'Program Files (x86)'\ndefault['mysql']['windows']['basedir']            = \"#{ENV['SYSTEMDRIVE']}\\\\#{node['mysql']['windows']['programdir']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\"\ndefault['mysql']['windows']['data_dir']           = \"#{ENV['ProgramData']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\\\\Data\"\ndefault['mysql']['windows']['bin_dir']            = \"#{node['mysql']['windows']['basedir']}\\\\bin\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-mysql-attributes-server_windows.rb\n# Target line: 7\n\n      2: when 'windows'\n      3:   default['mysql']['windows']['version']            = '5.5.34'\n      4:   default['mysql']['windows']['arch']               = node['kernel']['machine'] == 'x86_64' ? 'winx64' : 'win32'\n      5:   default['mysql']['windows']['package_file']       = \"mysql-#{node['mysql']['windows']['version']}-#{node['mysql']['windows']['arch']}.msi\"\n      6:   default['mysql']['windows']['packages']           = ['MySQL Server 5.5']\n>>>   7:   default['mysql']['windows']['url']                = \"http://dev.mysql.com/get/Downloads/MySQL-5.5/#{node['mysql']['windows']['package_file']}\"\n      8: \n      9:   default['mysql']['windows']['programdir']         = node['kernel']['machine'] == 'x86_64' ? 'Program Files' : 'Program Files (x86)'\n     10:   default['mysql']['windows']['basedir']            = \"#{ENV['SYSTEMDRIVE']}\\\\#{node['mysql']['windows']['programdir']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\"\n     11:   default['mysql']['windows']['data_dir']           = \"#{ENV['ProgramData']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\\\\Data\"\n     12:   default['mysql']['windows']['bin_dir']            = \"#{node['mysql']['windows']['basedir']}\\\\bin\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-apache2-recipes-mod_auth_openid.rb", "content": "source \"http://kin.klever.net/dist/libopkele-2.0.4.tar.gz\"", "line": 52, "detection_span": [47, 57], "with_context": "\nend\n\ncase node['platform_family']\nwhen \"rhel\", \"fedora\"\nremote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n52:     source \"http://kin.klever.net/dist/libopkele-2.0.4.tar.gz\"\nmode 00644\nend\n\nbash \"install libopkele\" do\ncwd Chef::Config['file_cache_path']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-apache2-recipes-mod_auth_openid.rb\n# Target line: 52\n\n     47: end\n     48: \n     49: case node['platform_family']\n     50: when \"rhel\", \"fedora\"\n     51:   remote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n>>>  52:     source \"http://kin.klever.net/dist/libopkele-2.0.4.tar.gz\"\n     53:     mode 00644\n     54:   end\n     55: \n     56:   bash \"install libopkele\" do\n     57:     cwd Chef::Config['file_cache_path']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kitchenware_master-chef-cookbooks-redis-recipes-default.rb", "content": "url \"http://backports.debian.org/debian-backports\"", "line": 13, "detection_span": [8, 18], "with_context": "\nredis_config_file = \"redis.conf.erb\"\n\nif node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"squeeze-backports\" do\n13:     url \"http://backports.debian.org/debian-backports\"\ndistrib \"squeeze-backports\"\nend\n\nnode.set[:redis][:redis_version] = \"2:2.4.15-1~bpo60+2\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-redis-recipes-default.rb\n# Target line: 13\n\n      8: redis_config_file = \"redis.conf.erb\"\n      9: \n     10: if node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo\n     11: \n     12:   add_apt_repository \"squeeze-backports\" do\n>>>  13:     url \"http://backports.debian.org/debian-backports\"\n     14:     distrib \"squeeze-backports\"\n     15:   end\n     16: \n     17:   node.set[:redis][:redis_version] = \"2:2.4.15-1~bpo60+2\"\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-geoip.rb", "content": "default['nginx']['geoip']['country_dat_url']      = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz'", "line": 24, "detection_span": [19, 29], "with_context": "\n# limitations under the License.\n#\n\ndefault['nginx']['geoip']['path']                 = '/srv/geoip'\ndefault['nginx']['geoip']['enable_city']          = true\n24: default['nginx']['geoip']['country_dat_url']      = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz'\ndefault['nginx']['geoip']['country_dat_checksum'] = '79ff1099e96c2dc1c2539c9a18aaa13a9afd085cae477df60d95f1644d42bc07'\ndefault['nginx']['geoip']['city_dat_url']         = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz'\ndefault['nginx']['geoip']['city_dat_checksum']    = '8a6467033a528f68b1a97de24d9d0ce86c8e8e83683820e16e433ddbd3f712f7'\ndefault['nginx']['geoip']['lib_version']          = '1.6.3'\nlib_version = node['nginx']['geoip']['lib_version'] # convenience variable for line length", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-attributes-geoip.rb\n# Target line: 24\n\n     19: # limitations under the License.\n     20: #\n     21: \n     22: default['nginx']['geoip']['path']                 = '/srv/geoip'\n     23: default['nginx']['geoip']['enable_city']          = true\n>>>  24: default['nginx']['geoip']['country_dat_url']      = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz'\n     25: default['nginx']['geoip']['country_dat_checksum'] = '79ff1099e96c2dc1c2539c9a18aaa13a9afd085cae477df60d95f1644d42bc07'\n     26: default['nginx']['geoip']['city_dat_url']         = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz'\n     27: default['nginx']['geoip']['city_dat_checksum']    = '8a6467033a528f68b1a97de24d9d0ce86c8e8e83683820e16e433ddbd3f712f7'\n     28: default['nginx']['geoip']['lib_version']          = '1.6.3'\n     29: lib_version = node['nginx']['geoip']['lib_version'] # convenience variable for line length\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "caiush_bos-cookbooks-bcpc-attributes-default.rb", "content": "default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"", "line": 134, "detection_span": [129, 139], "with_context": "\n129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"\n135: default['bcpc']['repos']['gridcentric'] = \"http://downloads.gridcentric.com/packages/%s/%s/ubuntu\"\n136:\n137: ###########################################\n138: #\n139: # [Optional] If using apt-mirror to pull down repos, we use these settings.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: caiush_bos-cookbooks-bcpc-attributes-default.rb\n# Target line: 134\n\n    129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n    130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n    131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n    132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n    133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n>>> 134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"\n    135: default['bcpc']['repos']['gridcentric'] = \"http://downloads.gridcentric.com/packages/%s/%s/ubuntu\"\n    136: \n    137: ###########################################\n    138: #\n    139: # [Optional] If using apt-mirror to pull down repos, we use these settings.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql55-community.rb", "content": "default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/$releasever/$basearch/'", "line": 33, "detection_span": [28, 38], "with_context": "\ndefault['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/6/$basearch/'\nwhen 7\ndefault['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/7/$basearch/'\nend\nelse # other rhel. only 6 and 7 for now\n33:     default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/$releasever/$basearch/'\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql55-community.rb\n# Target line: 33\n\n     28:       default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/6/$basearch/'\n     29:     when 7\n     30:       default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/7/$basearch/'\n     31:     end\n     32:   else # other rhel. only 6 and 7 for now\n>>>  33:     default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/$releasever/$basearch/'\n     34:   end\n     35: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "rackspace-cookbooks_nodestack-recipes-mysql_holland.rb", "content": "gpgkey 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/repodata/repomd.xml.key'", "line": 36, "detection_span": [31, 41], "with_context": "\nwhen 'centos'\ninclude_recipe 'yum'\nyum_repository 'Holland' do\ndescription 'Holland backup repo'\nbaseurl 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/'\n36:     gpgkey 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/repodata/repomd.xml.key'\naction :create\nend\nend\n\n# install needed packages", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-recipes-mysql_holland.rb\n# Target line: 36\n\n     31: when 'centos'\n     32:   include_recipe 'yum'\n     33:   yum_repository 'Holland' do\n     34:     description 'Holland backup repo'\n     35:     baseurl 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/'\n>>>  36:     gpgkey 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/repodata/repomd.xml.key'\n     37:     action :create\n     38:   end\n     39: end\n     40: \n     41: # install needed packages\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb", "content": "default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-i586.bin'", "line": 106, "detection_span": [101, 111], "with_context": "\n101: # x86_64\n102: default['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-x64.bin'\n103: default['java']['jdk']['6']['x86_64']['checksum'] = '6b493aeab16c940cae9e3d07ad2a5c5684fb49cf06c5d44c400c7993db0d12e8'\n104:\n105: # i586\n106: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-i586.bin'\n107: default['java']['jdk']['6']['i586']['checksum'] = 'd53b5a2518d80e1d95565f0adda54eee229dc5f4a1d1a3c2f7bf5045b168a357'\n108:\n109: # jdk7 attributes\n110:\n111: default['java']['jdk']['7']['bin_cmds'] = %w(appletviewer apt ControlPanel extcheck idlj jar jarsigner java javac", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb\n# Target line: 106\n\n    101: # x86_64\n    102: default['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-x64.bin'\n    103: default['java']['jdk']['6']['x86_64']['checksum'] = '6b493aeab16c940cae9e3d07ad2a5c5684fb49cf06c5d44c400c7993db0d12e8'\n    104: \n    105: # i586\n>>> 106: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-i586.bin'\n    107: default['java']['jdk']['6']['i586']['checksum'] = 'd53b5a2518d80e1d95565f0adda54eee229dc5f4a1d1a3c2f7bf5045b168a357'\n    108: \n    109: # jdk7 attributes\n    110: \n    111: default['java']['jdk']['7']['bin_cmds'] = %w(appletviewer apt ControlPanel extcheck idlj jar jarsigner java javac\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "TaxiOS_zabbix-recipes-agent_registration.rb", "content": ":url => \"http://#{zabbix_server['zabbix']['web']['fqdn']}/api_jsonrpc.php\",", "line": 21, "detection_span": [16, 26], "with_context": "\nreturn\nend\nend\n\nconnection_info = {\n21:   :url => \"http://#{zabbix_server['zabbix']['web']['fqdn']}/api_jsonrpc.php\",\n:user => zabbix_server['zabbix']['web']['login'],\n:password => zabbix_server['zabbix']['web']['password']\n}\n\ninterface_definitions = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: TaxiOS_zabbix-recipes-agent_registration.rb\n# Target line: 21\n\n     16:     return\n     17:   end\n     18: end\n     19: \n     20: connection_info = {\n>>>  21:   :url => \"http://#{zabbix_server['zabbix']['web']['fqdn']}/api_jsonrpc.php\",\n     22:   :user => zabbix_server['zabbix']['web']['login'],\n     23:   :password => zabbix_server['zabbix']['web']['password']\n     24: }\n     25: \n     26: interface_definitions = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mackerelio_cookbook-mackerel-agent-recipes-default.rb", "content": "repo_url = \"http://yum.mackerel.io/v2/$basearch\"", "line": 46, "detection_span": [41, 51], "with_context": "\n\nif supports_v2_repository\nif platform?('amazon')\nrepo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\nelse\n46:       repo_url = \"http://yum.mackerel.io/v2/$basearch\"\nend\ngpgkey_url = gpgkey_url_v2\nyum_key_name = 'RPM-GPG-KEY-mackerel-v2'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mackerelio_cookbook-mackerel-agent-recipes-default.rb\n# Target line: 46\n\n     41: \n     42:   if supports_v2_repository\n     43:     if platform?('amazon')\n     44:       repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\n     45:     else\n>>>  46:       repo_url = \"http://yum.mackerel.io/v2/$basearch\"\n     47:     end\n     48:     gpgkey_url = gpgkey_url_v2\n     49:     yum_key_name = 'RPM-GPG-KEY-mackerel-v2'\n     50:   end\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-yum-attributes-elrepo.rb", "content": "default['yum']['elrepo']['key_url'] = \"http://elrepo.org/#{node['yum']['elrepo']['key']}\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n#\n\ndefault['yum']['elrepo']['url'] = \"http://elrepo.org/mirrors-elrepo.el#{node['platform_version'].to_i}\"\ndefault['yum']['elrepo']['key'] = \"RPM-GPG-KEY-elrepo.org\"\n22: default['yum']['elrepo']['key_url'] = \"http://elrepo.org/#{node['yum']['elrepo']['key']}\"\ndefault['yum']['elrepo']['includepkgs'] = nil\ndefault['yum']['elrepo']['exclude'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-yum-attributes-elrepo.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: #\n     19: \n     20: default['yum']['elrepo']['url'] = \"http://elrepo.org/mirrors-elrepo.el#{node['platform_version'].to_i}\"\n     21: default['yum']['elrepo']['key'] = \"RPM-GPG-KEY-elrepo.org\"\n>>>  22: default['yum']['elrepo']['key_url'] = \"http://elrepo.org/#{node['yum']['elrepo']['key']}\"\n     23: default['yum']['elrepo']['includepkgs'] = nil\n     24: default['yum']['elrepo']['exclude'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-memcached-recipes-src-memcached-install.rb", "content": "source \"http://yum.ihr/files/libmemcached-0.51.tar.gz\"", "line": 11, "detection_span": [6, 16], "with_context": "\ngroup \"root\"\naction :create\nend\n\nremote_file \"/root/build/libmemcached-0.51.tar.gz\" do\n11:   source \"http://yum.ihr/files/libmemcached-0.51.tar.gz\"\nnotifies :run, \"bash[install_libmemcached]\", :immediately\nend\n\nbash \"install_libmemcached\" do\nuser \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-memcached-recipes-src-memcached-install.rb\n# Target line: 11\n\n      6:   group \"root\"\n      7:   action :create\n      8: end\n      9: \n     10: remote_file \"/root/build/libmemcached-0.51.tar.gz\" do\n>>>  11:   source \"http://yum.ihr/files/libmemcached-0.51.tar.gz\"\n     12:   notifies :run, \"bash[install_libmemcached]\", :immediately\n     13: end\n     14: \n     15: bash \"install_libmemcached\" do\n     16:   user \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql56-community.rb", "content": "default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'", "line": 18, "detection_span": [13, 23], "with_context": "\nwhen 2013\ndefault['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nwhen 2014\ndefault['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nwhen 2015\n18:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nwhen 2016\ndefault['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nend\nwhen 'redhat', 'oracle' # ~FC024\ncase node['platform_version'].to_i", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql56-community.rb\n# Target line: 18\n\n     13:     when 2013\n     14:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     15:     when 2014\n     16:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     17:     when 2015\n>>>  18:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     19:     when 2016\n     20:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     21:     end\n     22:   when 'redhat', 'oracle' # ~FC024\n     23:     case node['platform_version'].to_i\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb", "content": "default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'", "line": 17, "detection_span": [12, 22], "with_context": "\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\nwhen 6\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb\n# Target line: 17\n\n     12:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\n     13:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\n     14:   when 6\n     15:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n     16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n>>>  17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n     20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\n     21:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     22:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb", "content": "default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'", "line": 16, "detection_span": [11, 21], "with_context": "\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 5 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\nwhen 6\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb\n# Target line: 16\n\n     11:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 5 - $basearch'\n     12:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\n     13:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\n     14:   when 6\n     15:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n>>>  16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n     17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n     20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\n     21:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb", "content": "gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"", "line": 33, "detection_span": [28, 38], "with_context": "\n# Configure the Nexcess yum repo so we can match their php versions\nyum_repository \"iworx\" do\ndescription \"Interworx Repo\"\nbaseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\ngpgcheck true\n33:     gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\nenabled true\nincludepkgs \"mod_fastcgi*\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb\n# Target line: 33\n\n     28: # Configure the Nexcess yum repo so we can match their php versions\n     29: yum_repository \"iworx\" do\n     30:     description \"Interworx Repo\"\n     31:     baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\n     32:     gpgcheck true\n>>>  33:     gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\n     34:     enabled true\n     35:     includepkgs \"mod_fastcgi*\"\n     36: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-zabbix-cookbooks-hadoop_cluster-recipes-add_cloudera_repo.rb", "content": "source \"http://archive.cloudera.com/redhat/6/x86_64/cdh/cloudera-cdh3.repo\"", "line": 29, "detection_span": [24, 34], "with_context": "\nexecute \"yum clean all\" do\naction :nothing\nend\n\nremote_file \"/etc/yum.repos.d/cloudera-cdh3.repo\" do\n29:     source \"http://archive.cloudera.com/redhat/6/x86_64/cdh/cloudera-cdh3.repo\"\nmode \"0644\"\nnotifies :run, resources(:execute => \"yum clean all\"), :immediately\nend\n\nwhen 'ubuntu'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-zabbix-cookbooks-hadoop_cluster-recipes-add_cloudera_repo.rb\n# Target line: 29\n\n     24:   execute \"yum clean all\" do\n     25:     action :nothing\n     26:   end\n     27: \n     28:   remote_file \"/etc/yum.repos.d/cloudera-cdh3.repo\" do\n>>>  29:     source \"http://archive.cloudera.com/redhat/6/x86_64/cdh/cloudera-cdh3.repo\"\n     30:     mode \"0644\"\n     31:     notifies :run, resources(:execute => \"yum clean all\"), :immediately\n     32:   end\n     33: \n     34: when 'ubuntu'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_oc-java-attributes-default.rb", "content": "default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin'", "line": 50, "detection_span": [45, 55], "with_context": "\n# x86_64\ndefault['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-x64.bin'\ndefault['java']['jdk']['6']['x86_64']['checksum'] = '51d594cec29948bdf58918ba802a872826bc7caae3f0aada42b65eacdc14a7f4'\n\n# i586\n50: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin'\ndefault['java']['jdk']['6']['i586']['checksum'] = '44cc51ed452a08a3e0b4e397922832607161642e5a6e206f256af86f8fbaae90'\n\n# jdk7 attributes\n# x86_64\ndefault['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u9-b05/jdk-7u9-linux-x64.tar.gz'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_oc-java-attributes-default.rb\n# Target line: 50\n\n     45: # x86_64\n     46: default['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-x64.bin'\n     47: default['java']['jdk']['6']['x86_64']['checksum'] = '51d594cec29948bdf58918ba802a872826bc7caae3f0aada42b65eacdc14a7f4'\n     48: \n     49: # i586\n>>>  50: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin'\n     51: default['java']['jdk']['6']['i586']['checksum'] = '44cc51ed452a08a3e0b4e397922832607161642e5a6e206f256af86f8fbaae90'\n     52: \n     53: # jdk7 attributes\n     54: # x86_64\n     55: default['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u9-b05/jdk-7u9-linux-x64.tar.gz'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-couchbase-attributes-moxi.rb", "content": "default['couchbase']['moxi']['package_base_url'] = \"http://packages.couchbase.com/releases/#{node['couchbase']['moxi']['version']}\"", "line": 35, "detection_span": [30, 40], "with_context": "\ndefault['couchbase']['moxi']['package_file'] = \"moxi-server_#{package_machine}_#{node['couchbase']['moxi']['version']}.rpm\"\nelse\nChef::Log.error(\"Moxi Server is not supported on #{platform}\")\nend\n\n35: default['couchbase']['moxi']['package_base_url'] = \"http://packages.couchbase.com/releases/#{node['couchbase']['moxi']['version']}\"\ndefault['couchbase']['moxi']['package_full_url'] = \"#{node['couchbase']['moxi']['package_base_url']}/#{node['couchbase']['moxi']['package_file']}\"\n\ndefault['couchbase']['moxi']['cluster_server'] = 'couchbase01'\ndefault['couchbase']['moxi']['cluster_rest_url'] = \"http://#{node['couchbase']['moxi']['cluster_server']}:8091/pools/default/bucketsStreaming/default\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-couchbase-attributes-moxi.rb\n# Target line: 35\n\n     30:   default['couchbase']['moxi']['package_file'] = \"moxi-server_#{package_machine}_#{node['couchbase']['moxi']['version']}.rpm\"\n     31: else\n     32:   Chef::Log.error(\"Moxi Server is not supported on #{platform}\")\n     33: end\n     34: \n>>>  35: default['couchbase']['moxi']['package_base_url'] = \"http://packages.couchbase.com/releases/#{node['couchbase']['moxi']['version']}\"\n     36: default['couchbase']['moxi']['package_full_url'] = \"#{node['couchbase']['moxi']['package_base_url']}/#{node['couchbase']['moxi']['package_file']}\"\n     37: \n     38: default['couchbase']['moxi']['cluster_server'] = 'couchbase01'\n     39: default['couchbase']['moxi']['cluster_rest_url'] = \"http://#{node['couchbase']['moxi']['cluster_server']}:8091/pools/default/bucketsStreaming/default\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mackerelio_cookbook-mackerel-agent-recipes-default.rb", "content": "repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"", "line": 44, "detection_span": [39, 49], "with_context": "\nrepo_url = \"http://yum.mackerel.io/amznlinux/$releasever/$basearch\"\nend\n\nif supports_v2_repository\nif platform?('amazon')\n44:       repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\nelse\nrepo_url = \"http://yum.mackerel.io/v2/$basearch\"\nend\ngpgkey_url = gpgkey_url_v2\nyum_key_name = 'RPM-GPG-KEY-mackerel-v2'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mackerelio_cookbook-mackerel-agent-recipes-default.rb\n# Target line: 44\n\n     39:     repo_url = \"http://yum.mackerel.io/amznlinux/$releasever/$basearch\"\n     40:   end\n     41: \n     42:   if supports_v2_repository\n     43:     if platform?('amazon')\n>>>  44:       repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\n     45:     else\n     46:       repo_url = \"http://yum.mackerel.io/v2/$basearch\"\n     47:     end\n     48:     gpgkey_url = gpgkey_url_v2\n     49:     yum_key_name = 'RPM-GPG-KEY-mackerel-v2'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb", "content": "default['java']['oracle']['jce']['7']['url'] = 'http://download.oracle.com/otn-pub/java/jce/7/UnlimitedJCEPolicyJDK7.zip'", "line": 151, "detection_span": [146, 156], "with_context": "\n146: default['java']['jdk']['8']['i586']['checksum'] = '2012d1c82f74bf830a80dfb5462f555b22271f74e4fc4a5779c7f459dcd0cabf'\n147:\n148: default['java']['oracle']['jce']['enabled'] = false\n149: default['java']['oracle']['jce']['8']['url'] = 'http://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip'\n150: default['java']['oracle']['jce']['8']['checksum'] = 'f3020a3922efd6626c2fff45695d527f34a8020e938a49292561f18ad1320b59'\n151: default['java']['oracle']['jce']['7']['url'] = 'http://download.oracle.com/otn-pub/java/jce/7/UnlimitedJCEPolicyJDK7.zip'\n152: default['java']['oracle']['jce']['7']['checksum'] = '7a8d790e7bd9c2f82a83baddfae765797a4a56ea603c9150c87b7cdb7800194d'\n153: default['java']['oracle']['jce']['6']['url'] = 'http://download.oracle.com/otn-pub/java/jce_policy/6/jce_policy-6.zip'\n154: default['java']['oracle']['jce']['6']['checksum'] = 'd0c2258c3364120b4dbf7dd1655c967eee7057ac6ae6334b5ea8ceb8bafb9262'\n155: default['java']['oracle']['jce']['home'] = '/opt/java_jce'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb\n# Target line: 151\n\n    146: default['java']['jdk']['8']['i586']['checksum'] = '2012d1c82f74bf830a80dfb5462f555b22271f74e4fc4a5779c7f459dcd0cabf'\n    147: \n    148: default['java']['oracle']['jce']['enabled'] = false\n    149: default['java']['oracle']['jce']['8']['url'] = 'http://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip'\n    150: default['java']['oracle']['jce']['8']['checksum'] = 'f3020a3922efd6626c2fff45695d527f34a8020e938a49292561f18ad1320b59'\n>>> 151: default['java']['oracle']['jce']['7']['url'] = 'http://download.oracle.com/otn-pub/java/jce/7/UnlimitedJCEPolicyJDK7.zip'\n    152: default['java']['oracle']['jce']['7']['checksum'] = '7a8d790e7bd9c2f82a83baddfae765797a4a56ea603c9150c87b7cdb7800194d'\n    153: default['java']['oracle']['jce']['6']['url'] = 'http://download.oracle.com/otn-pub/java/jce_policy/6/jce_policy-6.zip'\n    154: default['java']['oracle']['jce']['6']['checksum'] = 'd0c2258c3364120b4dbf7dd1655c967eee7057ac6ae6334b5ea8ceb8bafb9262'\n    155: default['java']['oracle']['jce']['home'] = '/opt/java_jce'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kitchenplan_chef-applications-recipes-hhvm.rb", "content": "uri          'http://dl.hhvm.com/ubuntu'", "line": 9, "detection_span": [4, 14], "with_context": "\nhomebrew_tap \"homebrew/dupes\"\nhomebrew_tap \"homebrew/versions\"\nhomebrew_tap \"mcuadros/homebrew-hhvm\"\nwhen 'debian'\napt_repository 'hhvm' do\n9:           uri          'http://dl.hhvm.com/ubuntu'\ndistribution node['lsb']['codename']\ncomponents   ['main']\nkey          'http://dl.hhvm.com/conf/hhvm.gpg.key'\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-applications-recipes-hhvm.rb\n# Target line: 9\n\n      4:         homebrew_tap \"homebrew/dupes\"\n      5:         homebrew_tap \"homebrew/versions\"\n      6:         homebrew_tap \"mcuadros/homebrew-hhvm\"\n      7:     when 'debian'\n      8:         apt_repository 'hhvm' do\n>>>   9:           uri          'http://dl.hhvm.com/ubuntu'\n     10:           distribution node['lsb']['codename']\n     11:           components   ['main']\n     12:           key          'http://dl.hhvm.com/conf/hhvm.gpg.key'\n     13:         end\n     14: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-nagios-attributes-client.rb", "content": "default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'", "line": 68, "detection_span": [63, 73], "with_context": "\n]\n\n# for nsca from source installation\ncase chef_environment\nwhen /^hls/\n68:   default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\ndefault['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\ndefault['nagios']['plugins']['url'] = 'https://www.nagios-plugins.org/download'\nwhen /^staging-hls/\ndefault['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\ndefault['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nagios-attributes-client.rb\n# Target line: 68\n\n     63:                                             ]\n     64: \n     65: # for nsca from source installation\n     66: case chef_environment\n     67: when /^hls/\n>>>  68:   default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios' \n     69:   default['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n     70:   default['nagios']['plugins']['url'] = 'https://www.nagios-plugins.org/download'\n     71: when /^staging-hls/\n     72:   default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios' \n     73:   default['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "SpanningCloudApps_cassandra-chef-cookbook-recipes-tarball.rb", "content": "node.default['cassandra']['tarball']['url'] = \"http://archive.apache.org/dist/cassandra/#{node['cassandra']['version']}/apache-cassandra-#{node['cassandra']['version']}-bin.tar.gz\"", "line": 51, "detection_span": [46, 56], "with_context": "\ntarball_dir = ::File.join(td, \"apache-cassandra-#{node['cassandra']['version']}\")\n\n# if tarball url set to 'auto' use default url\n# according to node cassandra version\nif node['cassandra']['tarball']['url'] == 'auto'\n51:   node.default['cassandra']['tarball']['url'] = \"http://archive.apache.org/dist/cassandra/#{node['cassandra']['version']}/apache-cassandra-#{node['cassandra']['version']}-bin.tar.gz\"\nend\n\n# stop C* service during upgrades\nservice 'cassandra' do\nservice_name node['cassandra']['service_name']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: SpanningCloudApps_cassandra-chef-cookbook-recipes-tarball.rb\n# Target line: 51\n\n     46: tarball_dir = ::File.join(td, \"apache-cassandra-#{node['cassandra']['version']}\")\n     47: \n     48: # if tarball url set to 'auto' use default url\n     49: # according to node cassandra version\n     50: if node['cassandra']['tarball']['url'] == 'auto'\n>>>  51:   node.default['cassandra']['tarball']['url'] = \"http://archive.apache.org/dist/cassandra/#{node['cassandra']['version']}/apache-cassandra-#{node['cassandra']['version']}-bin.tar.gz\"\n     52: end\n     53: \n     54: # stop C* service during upgrades\n     55: service 'cassandra' do\n     56:   service_name node['cassandra']['service_name']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "rcbops-cookbooks_swift-recipes-management-server.rb", "content": "keystone_auth_url = \"http://#{ks_admin_endpoint[\"host\"]}:#{ks_service_endpoint[\"port\"]}/v2.0/\"", "line": 42, "detection_span": [37, 47], "with_context": "\nend\n\nks_admin_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\", \"admin-api\")\nks_service_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\",\"service-api\")\nkeystone = get_settings_by_role(\"keystone-setup\", \"keystone\")\n42: keystone_auth_url = \"http://#{ks_admin_endpoint[\"host\"]}:#{ks_service_endpoint[\"port\"]}/v2.0/\"\n\n# Register Service Tenant\nkeystone_tenant \"Create Service Tenant\" do\nauth_host ks_admin_endpoint[\"host\"]\nauth_port ks_admin_endpoint[\"port\"]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-recipes-management-server.rb\n# Target line: 42\n\n     37: end\n     38: \n     39: ks_admin_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\", \"admin-api\")\n     40: ks_service_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\",\"service-api\")\n     41: keystone = get_settings_by_role(\"keystone-setup\", \"keystone\")\n>>>  42: keystone_auth_url = \"http://#{ks_admin_endpoint[\"host\"]}:#{ks_service_endpoint[\"port\"]}/v2.0/\"\n     43: \n     44: # Register Service Tenant\n     45: keystone_tenant \"Create Service Tenant\" do\n     46:   auth_host ks_admin_endpoint[\"host\"]\n     47:   auth_port ks_admin_endpoint[\"port\"]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel-source.rb", "content": "default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'", "line": 21, "detection_span": [16, 26], "with_context": "\ndefault['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\ndefault['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel-source']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch - Source'\ndefault['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\n21:     default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nend\n\ndefault['yum']['epel-source']['failovermethod'] = 'priority'\ndefault['yum']['epel-source']['gpgcheck'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel-source.rb\n# Target line: 21\n\n     16:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\n     17:     default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel-source']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch - Source'\n     20:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\n>>>  21:     default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     22:   end\n     23: end\n     24: \n     25: default['yum']['epel-source']['failovermethod'] = 'priority'\n     26: default['yum']['epel-source']['gpgcheck'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "caiush_bos-cookbooks-bcpc-attributes-default.rb", "content": "default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"", "line": 129, "detection_span": [124, 134], "with_context": "\n124: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n125: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n126: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n127: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n128: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"\n129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: caiush_bos-cookbooks-bcpc-attributes-default.rb\n# Target line: 129\n\n    124: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n    125: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n    126: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n    127: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n    128: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"\n>>> 129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n    130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n    131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n    132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n    133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n    134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-yum-attributes-remi.rb", "content": "default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n#\n\ncase node['platform']\nwhen \"fedora\"\n22:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\nelse\ndefault['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\nend\n\ndefault['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-yum-attributes-remi.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: #\n     19: \n     20: case node['platform']\n     21: when \"fedora\"\n>>>  22:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\n     23: else\n     24:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\n     25: end\n     26: \n     27: default['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-bind-chroot-recipes-zones-openldap.rb", "content": "source \"http://bind9-ldap.bayour.com/zone2ldif.pl\"", "line": 42, "detection_span": [37, 47], "with_context": "\nend\nend\n\n# Download zone2ldif.pl to /usr/local/bin\nremote_file \"/usr/local/bin/zone2ldif.pl\" do\n42:   source \"http://bind9-ldap.bayour.com/zone2ldif.pl\"\nmode \"0744\"\nowner \"root\"\ngroup \"root\"\nchecksum \"b1f6fed631ba22ebeef390a691cbaf3d\"\nnot_if \"test -f /usr/local/bin/zone2ldif.pl\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-bind-chroot-recipes-zones-openldap.rb\n# Target line: 42\n\n     37:   end\n     38: end\n     39: \n     40: # Download zone2ldif.pl to /usr/local/bin\n     41: remote_file \"/usr/local/bin/zone2ldif.pl\" do\n>>>  42:   source \"http://bind9-ldap.bayour.com/zone2ldif.pl\"\n     43:   mode \"0744\"\n     44:   owner \"root\"\n     45:   group \"root\"\n     46:   checksum \"b1f6fed631ba22ebeef390a691cbaf3d\"\n     47:   not_if \"test -f /usr/local/bin/zone2ldif.pl\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-resources-release.rb", "content": "# Prefix directory -- other _dir attributes hang off this by default", "line": 47, "detection_span": [42, 52], "with_context": "\n#   :version:       -- value of resource's version\n#   :apache_mirror: -- node[:install_from][:apache_mirror]\n#\nattribute :release_url,   :kind_of => String, :required => true\n\n47: # Prefix directory -- other _dir attributes hang off this by default\nattribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n\n# version slug, appended to the name to get the install_dir\nattribute :version,       :kind_of => String, :required => true\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-resources-release.rb\n# Target line: 47\n\n     42: #   :version:       -- value of resource's version\n     43: #   :apache_mirror: -- node[:install_from][:apache_mirror]\n     44: #\n     45: attribute :release_url,   :kind_of => String, :required => true\n     46: \n>>>  47: # Prefix directory -- other _dir attributes hang off this by default\n     48: attribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n     49: \n     50: # version slug, appended to the name to get the install_dir\n     51: attribute :version,       :kind_of => String, :required => true\n     52: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Soluciones_ey-cloud-recipes-cookbooks-php55-recipes-install.rb", "content": "# Fix for Archive_Tar bug in PHP 5.5.8", "line": 99, "detection_span": [94, 104], "with_context": "\nexecute \"install-php55\" do\ncwd \"/root\"\ncommand \"emerge -g -n --color n --nospinner =dev-lang/php-#{node[:php][:version]}\"\nend\n\n99: # Fix for Archive_Tar bug in PHP 5.5.8\n100: remote_file '/usr/share/php/Archive/Tar.php' do\n101:   source \"Archive_Tar.php\"\n102:   backup 0\n103:   owner \"root\"\n104:   group \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-php55-recipes-install.rb\n# Target line: 99\n\n     94: execute \"install-php55\" do\n     95:   cwd \"/root\"\n     96:   command \"emerge -g -n --color n --nospinner =dev-lang/php-#{node[:php][:version]}\"\n     97: end\n     98: \n>>>  99: # Fix for Archive_Tar bug in PHP 5.5.8\n    100: remote_file '/usr/share/php/Archive/Tar.php' do\n    101:   source \"Archive_Tar.php\"\n    102:   backup 0\n    103:   owner \"root\"\n    104:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb", "content": "# Determines if a tag matches a given wildcard expression or prefix.", "line": 14, "detection_span": [9, 19], "with_context": "\nmodule Utils\nmodule Helper\nNAMESPACE_REGEX = '[a-z](?:[a-z0-9_]*)'\nPREDICATE_REGEX = '[a-zA-Z0-9%_\\+\\.-](?:[a-zA-Z0-9%_\\+\\.-]*)'\n\n14:       # Determines if a tag matches a given wildcard expression or prefix.\n#\n# @param [String] wildcard expression or prefix\n# @param [String] tag\n#\n# @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb\n# Target line: 14\n\n      9:   module Utils\n     10:     module Helper\n     11:       NAMESPACE_REGEX = '[a-z](?:[a-z0-9_]*)'\n     12:       PREDICATE_REGEX = '[a-zA-Z0-9%_\\+\\.-](?:[a-zA-Z0-9%_\\+\\.-]*)'\n     13: \n>>>  14:       # Determines if a tag matches a given wildcard expression or prefix.\n     15:       #\n     16:       # @param [String] wildcard expression or prefix\n     17:       # @param [String] tag\n     18:       #\n     19:       # @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_qa-chef-server-cluster-recipes-frontend.rb", "content": "# ruby_block 'ensure node can resolve API FQDN' do", "line": 45, "detection_span": [40, 50], "with_context": "\nexecute 'add hosts entry' do\ncommand \"echo '#{node['ipaddress']} #{node['fqdn']} #{node['qa-chef-server-cluster']['chef-server']['api_fqdn']}' >> /etc/hosts\"\nend\n\n# TODO: check this out from chef-server cookbook\n45: # ruby_block 'ensure node can resolve API FQDN' do\n#   extend ChefServerCoobook::Helpers\n#   block { repair_api_fqdn }\n#   only_if { api_fqdn_node_attr }\n#   not_if { api_fqdn_resolves }\n# end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_qa-chef-server-cluster-recipes-frontend.rb\n# Target line: 45\n\n     40: execute 'add hosts entry' do\n     41:   command \"echo '#{node['ipaddress']} #{node['fqdn']} #{node['qa-chef-server-cluster']['chef-server']['api_fqdn']}' >> /etc/hosts\"\n     42: end\n     43: \n     44: # TODO: check this out from chef-server cookbook\n>>>  45: # ruby_block 'ensure node can resolve API FQDN' do\n     46: #   extend ChefServerCoobook::Helpers\n     47: #   block { repair_api_fqdn }\n     48: #   only_if { api_fqdn_node_attr }\n     49: #   not_if { api_fqdn_resolves }\n     50: # end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-nodejs-recipes-nodejs_from_binary.rb", "content": "# FIXME: This should really check the version of node we're looking for", "line": 24, "detection_span": [19, 29], "with_context": "\nChef::Recipe.send(:include, NodeJs::Helper)\n\n# Shamelessly borrowed from http://docs.chef.io/dsl_recipe_method_platform.html\n# Surely there's a more canonical way to get arch?\narch = if node['kernel']['machine'] =~ /armv6l/\n24:          # FIXME: This should really check the version of node we're looking for\n# as it seems that they haven't build an `arm-pi` version in a while...\n# if it's old, return this, otherwise just return `node['kernel']['machine']`\n'arm-pi' # assume a raspberry pi\nelsif node['kernel']['machine'] =~ /aarch64/\n'arm64'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-nodejs-recipes-nodejs_from_binary.rb\n# Target line: 24\n\n     19: Chef::Recipe.send(:include, NodeJs::Helper)\n     20: \n     21: # Shamelessly borrowed from http://docs.chef.io/dsl_recipe_method_platform.html\n     22: # Surely there's a more canonical way to get arch?\n     23: arch = if node['kernel']['machine'] =~ /armv6l/\n>>>  24:          # FIXME: This should really check the version of node we're looking for\n     25:          # as it seems that they haven't build an `arm-pi` version in a while...\n     26:          # if it's old, return this, otherwise just return `node['kernel']['machine']`\n     27:          'arm-pi' # assume a raspberry pi\n     28:        elsif node['kernel']['machine'] =~ /aarch64/\n     29:          'arm64'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-provider.rb", "content": "# fix the use_inline_resources LWRPBase wrapper that creates a sub-resource collection with the ugpraded code", "line": 47, "detection_span": [42, 52], "with_context": "\nclass Provider\nclass LWRPBase < Provider\nif defined?(InlineResources)\nmodule InlineResources\n# since we upgrade the Chef::Runner and Chef::RunContext globally to >= 12.14 style classes, we need to also\n47:           # fix the use_inline_resources LWRPBase wrapper that creates a sub-resource collection with the ugpraded code\n# from the Chef::Provider subclasses that do similar things in post-12.5 chef.\ndef recipe_eval_with_update_check(&block)\nold_run_context = run_context\n@run_context = run_context.create_child\nreturn_value = instance_eval(&block)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-provider.rb\n# Target line: 47\n\n     42:   class Provider\n     43:     class LWRPBase < Provider\n     44:       if defined?(InlineResources)\n     45:         module InlineResources\n     46:           # since we upgrade the Chef::Runner and Chef::RunContext globally to >= 12.14 style classes, we need to also\n>>>  47:           # fix the use_inline_resources LWRPBase wrapper that creates a sub-resource collection with the ugpraded code\n     48:           # from the Chef::Provider subclasses that do similar things in post-12.5 chef.\n     49:           def recipe_eval_with_update_check(&block)\n     50:             old_run_context = run_context\n     51:             @run_context = run_context.create_child\n     52:             return_value = instance_eval(&block)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "laradji_zabbix-recipes-agent_source.rb", "content": "# --prefix is controlled by install_dir", "line": 29, "detection_span": [24, 34], "with_context": "\naction :install\nend\nend\nend\n\n29: # --prefix is controlled by install_dir\nconfigure_options = node['zabbix']['agent']['configure_options'].dup\nconfigure_options = (configure_options || Array.new).delete_if do |option|\noption.match(/\\s*--prefix(\\s|=).+/)\nend\nnode.normal['zabbix']['agent']['configure_options'] = configure_options", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: laradji_zabbix-recipes-agent_source.rb\n# Target line: 29\n\n     24:       action :install\n     25:     end\n     26:   end\n     27: end\n     28: \n>>>  29: # --prefix is controlled by install_dir\n     30: configure_options = node['zabbix']['agent']['configure_options'].dup\n     31: configure_options = (configure_options || Array.new).delete_if do |option|\n     32:   option.match(/\\s*--prefix(\\s|=).+/)\n     33: end\n     34: node.normal['zabbix']['agent']['configure_options'] = configure_options\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "amitjain1975_custom-rightscale-cookbooks-db_postgres-definitions-db_postgres_restore.rb", "content": "repo_params = params # see http://tickets.opscode.com/browse/CHEF-422", "line": 10, "detection_span": [5, 15], "with_context": "\n# RightScale Terms of Service available at http://www.rightscale.com/terms.php and,\n# if applicable, other agreements such as a RightScale Master Subscription Agreement.\n\ndefine :db_postgres_restore,  :url => nil, :branch => 'master', :user => nil, :credentials => nil, :file_path => nil, :schema_name => nil, :tmp_dir => '/tmp' do\n\n10:   repo_params = params # see http://tickets.opscode.com/browse/CHEF-422\n\ndir = \"#{params[:tmp_dir]}/db_postgres_restore\"\ndumpfile = \"#{dir}/#{params[:file_path]}\"\nschema_name = params[:schema_name]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-db_postgres-definitions-db_postgres_restore.rb\n# Target line: 10\n\n      5: # RightScale Terms of Service available at http://www.rightscale.com/terms.php and,\n      6: # if applicable, other agreements such as a RightScale Master Subscription Agreement.\n      7: \n      8: define :db_postgres_restore,  :url => nil, :branch => 'master', :user => nil, :credentials => nil, :file_path => nil, :schema_name => nil, :tmp_dir => '/tmp' do\n      9: \n>>>  10:   repo_params = params # see http://tickets.opscode.com/browse/CHEF-422\n     11: \n     12:   dir = \"#{params[:tmp_dir]}/db_postgres_restore\"\n     13:   dumpfile = \"#{dir}/#{params[:file_path]}\"\n     14:   schema_name = params[:schema_name]\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-sudo-resources-default.rb", "content": "# `Cmnd_Alias`. This should help people more easily catch issues", "line": 86, "detection_span": [81, 91], "with_context": "\nend\n\n# Validates if each element in an array starts with `/` or is in\n# ALL_CAPS. This is helpful for ensuring that the commands\n# passing into the sudoers resource as they need a full path or a\n86: # `Cmnd_Alias`. This should help people more easily catch issues\n# where the user requested `tail SOME_ARGS SOME_FILE` where they\n# need to use `/usr/bin/tail SOME_ARGS SOME_FILE`.\n# return [TrueClass, FalseClass]\ndef validate_commands_path(commands)\ncommands.each do |command|", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-sudo-resources-default.rb\n# Target line: 86\n\n     81: end\n     82: \n     83: # Validates if each element in an array starts with `/` or is in\n     84: # ALL_CAPS. This is helpful for ensuring that the commands\n     85: # passing into the sudoers resource as they need a full path or a\n>>>  86: # `Cmnd_Alias`. This should help people more easily catch issues\n     87: # where the user requested `tail SOME_ARGS SOME_FILE` where they\n     88: # need to use `/usr/bin/tail SOME_ARGS SOME_FILE`.\n     89: # return [TrueClass, FalseClass]\n     90: def validate_commands_path(commands)\n     91:   commands.each do |command|\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-go_expvar.rb", "content": "#     'expvar_url' => 'http://localhost:8080/debug/vars',", "line": 6, "detection_span": [1, 11], "with_context": "\ninclude_recipe '::dd-agent'\n\n# Monitor Go metrics exported via expvar\n#  node['datadog']['go_expvar']['instances'] = [\n#   {\n6: #     'expvar_url' => 'http://localhost:8080/debug/vars',\n#     'tags' => [\n#        'application:my_go_app'\n#      ],\n#     'metrics' => [\n#       {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-recipes-go_expvar.rb\n# Target line: 6\n\n      1: include_recipe '::dd-agent'\n      2: \n      3: # Monitor Go metrics exported via expvar\n      4: #  node['datadog']['go_expvar']['instances'] = [\n      5: #   {\n>>>   6: #     'expvar_url' => 'http://localhost:8080/debug/vars',\n      7: #     'tags' => [\n      8: #        'application:my_go_app'\n      9: #      ],\n     10: #     'metrics' => [\n     11: #       {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redu_ey-cloud-recipes-cookbooks-varnish_frontend-recipes-default.rb", "content": "# Install MOTD to ensure support is aware of iptables hackery.", "line": 95, "detection_span": [90, 100], "with_context": "\n:cache => CACHE,\n:varnish_port => 882\n})\nend\n\n95:   # Install MOTD to ensure support is aware of iptables hackery.\ntemplate '/etc/motd' do\nmode 655\nsource 'motd.erb'\nvariables({ :interface => INTERFACE })\n100:   end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: redu_ey-cloud-recipes-cookbooks-varnish_frontend-recipes-default.rb\n# Target line: 95\n\n     90:       :cache => CACHE,\n     91:       :varnish_port => 882\n     92:     })\n     93:   end\n     94: \n>>>  95:   # Install MOTD to ensure support is aware of iptables hackery.\n     96:   template '/etc/motd' do\n     97:     mode 655\n     98:     source 'motd.erb'\n     99:     variables({ :interface => INTERFACE })\n    100:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-snappy-cookbooks-rvm-recipes-system.rb", "content": "# collision with later processes which may set a guid explicitly", "line": 64, "detection_span": [59, 69], "with_context": "\nend\np.run_action(:install) if gem_package_included\nend\n\n# Build the rvm group ahead of time, if it is set. This allows avoiding\n64: # collision with later processes which may set a guid explicitly\nrvm_group_id = (node['rvm']['group_id'] == 'default') ? nil : node['rvm']['group_id']\ng = group 'rvm' do\ngroup_name 'rvm'\ngid        rvm_group_id\naction     :nothing", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-snappy-cookbooks-rvm-recipes-system.rb\n# Target line: 64\n\n     59:   end\n     60:   p.run_action(:install) if gem_package_included\n     61: end\n     62: \n     63: # Build the rvm group ahead of time, if it is set. This allows avoiding\n>>>  64: # collision with later processes which may set a guid explicitly\n     65: rvm_group_id = (node['rvm']['group_id'] == 'default') ? nil : node['rvm']['group_id']\n     66: g = group 'rvm' do\n     67:   group_name 'rvm'\n     68:   gid        rvm_group_id\n     69:   action     :nothing\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-work.rb", "content": "# https://bugs.launchpad.net/neutron/+bug/1915480", "line": 54, "detection_span": [49, 59], "with_context": "\naction %i(disable stop)\nend\nend\n\n# install patched dhcp.py for calico-dhcp-agent\n54: # https://bugs.launchpad.net/neutron/+bug/1915480\ncookbook_file '/usr/lib/python3/dist-packages/neutron/agent/linux/dhcp.py' do\nsource 'neutron/dhcp.py'\nnotifies :restart, 'service[calico-dhcp-agent]', :delayed\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-work.rb\n# Target line: 54\n\n     49:     action %i(disable stop)\n     50:   end\n     51: end\n     52: \n     53: # install patched dhcp.py for calico-dhcp-agent\n>>>  54: # https://bugs.launchpad.net/neutron/+bug/1915480\n     55: cookbook_file '/usr/lib/python3/dist-packages/neutron/agent/linux/dhcp.py' do\n     56:   source 'neutron/dhcp.py'\n     57:   notifies :restart, 'service[calico-dhcp-agent]', :delayed\n     58: end\n     59: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-helper.rb", "content": "# @todo: Is there a more robust way to determine this, i.e., based", "line": 95, "detection_span": [90, 100], "with_context": "\nend\n\n# Use the presence of a sentinel file as an indicator for whether\n# the server has already had initial bootstrapping performed.\n#\n95:   # @todo: Is there a more robust way to determine this, i.e., based\n#   on some functional aspect of the system?\ndef self.has_been_bootstrapped?\nFile.exists?(bootstrap_sentinel_file)\nend\n100:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-helper.rb\n# Target line: 95\n\n     90:   end\n     91: \n     92:   # Use the presence of a sentinel file as an indicator for whether\n     93:   # the server has already had initial bootstrapping performed.\n     94:   #\n>>>  95:   # @todo: Is there a more robust way to determine this, i.e., based\n     96:   #   on some functional aspect of the system?\n     97:   def self.has_been_bootstrapped?\n     98:     File.exists?(bootstrap_sentinel_file)\n     99:   end\n    100: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_nova-recipes-nova-scheduler-patch.rb", "content": "# lp:bug https://bugs.launchpad.net/nova/+bug/1007573", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n#\n\ninclude_recipe \"osops-utils\"\n\n22: # lp:bug https://bugs.launchpad.net/nova/+bug/1007573\n# affinity filters don't work if scheduler_hints is None\ntemplate \"/usr/share/pyshared/nova/scheduler/filters/affinity_filter.py\" do\nsource \"patches/affinity_filter.py.2012.1+stable~20120612-3ee026e-0ubuntu1.2.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-scheduler-patch.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: #\n     19: \n     20: include_recipe \"osops-utils\"\n     21: \n>>>  22: # lp:bug https://bugs.launchpad.net/nova/+bug/1007573\n     23: # affinity filters don't work if scheduler_hints is None\n     24: template \"/usr/share/pyshared/nova/scheduler/filters/affinity_filter.py\" do\n     25:   source \"patches/affinity_filter.py.2012.1+stable~20120612-3ee026e-0ubuntu1.2.erb\"\n     26:   owner \"root\"\n     27:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_delivery-truck-recipes-lint.rb", "content": "# workaround for https://github.com/bbatsov/rubocop/issues/2407", "line": 31, "detection_span": [26, 36], "with_context": "\n# modified cookbooks, if the cookbook contains a .rubocop.yml file\nif cookstyle_enabled?\nexecute \"lint_cookstyle_#{cookbook.name}\" do\ncommand \"cookstyle #{cookbook.path}\"\nenvironment(\n31:         # workaround for https://github.com/bbatsov/rubocop/issues/2407\n'USER' => (ENV['USER'] || 'dbuild')\n)\nlive_stream true\nonly_if 'cookstyle -v'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_delivery-truck-recipes-lint.rb\n# Target line: 31\n\n     26:   # modified cookbooks, if the cookbook contains a .rubocop.yml file\n     27:   if cookstyle_enabled?\n     28:     execute \"lint_cookstyle_#{cookbook.name}\" do\n     29:       command \"cookstyle #{cookbook.path}\"\n     30:       environment(\n>>>  31:         # workaround for https://github.com/bbatsov/rubocop/issues/2407\n     32:         'USER' => (ENV['USER'] || 'dbuild')\n     33:       )\n     34:       live_stream true\n     35:       only_if 'cookstyle -v'\n     36:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb", "content": "# Install service in debug mode", "line": 40, "detection_span": [35, 45], "with_context": "\n# documentation purpose only):\n#\n# Additional ssh key that should be added to deployment service user\n# default['cloudify']['properties']['ssh_key'] = ''\n#\n40: # Install service in debug mode\n# default['cloudify']['properties']['debug_mode'] = true\n#\n# Source tarball for service files\n# default['cloudify']['properties']['sources'] =\n#   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb\n# Target line: 40\n\n     35: # documentation purpose only):\n     36: #\n     37: # Additional ssh key that should be added to deployment service user\n     38: # default['cloudify']['properties']['ssh_key'] = ''\n     39: #\n>>>  40: # Install service in debug mode\n     41: # default['cloudify']['properties']['debug_mode'] = true\n     42: #\n     43: # Source tarball for service files\n     44: # default['cloudify']['properties']['sources'] =\n     45: #   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-snappy-cookbooks-statsd-recipes-server.rb", "content": "# FIXME: this interface could use some help", "line": 48, "detection_span": [43, 53], "with_context": "\nend\n\nannounce(:statsd, :server,\n:port => node[:statsd][:port])\n\n48: # FIXME: this interface could use some help\nbegin\ngraphite_carbon = discover(:graphite, :carbon).info[:info]\nrescue StandardError => err\ngraphite_carbon = { :port => '2003', :addr => '127.0.0.1' }\nLog.error(\"\\n  !!!!\\n  Could not find graphite carbon server. If it's on this machine, make sure its role preceded the statds server role.\\n #{err}\\n  !!!!\")", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-snappy-cookbooks-statsd-recipes-server.rb\n# Target line: 48\n\n     43: end\n     44: \n     45: announce(:statsd, :server,\n     46:   :port => node[:statsd][:port])\n     47: \n>>>  48: # FIXME: this interface could use some help\n     49: begin\n     50:   graphite_carbon = discover(:graphite, :carbon).info[:info]\n     51: rescue StandardError => err\n     52:   graphite_carbon = { :port => '2003', :addr => '127.0.0.1' }\n     53:   Log.error(\"\\n  !!!!\\n  Could not find graphite carbon server. If it's on this machine, make sure its role preceded the statds server role.\\n #{err}\\n  !!!!\")\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "hw-cookbooks_lxc-recipes-rhel_bridge.rb", "content": "# @todo this is temp! don't leave this mess", "line": 36, "detection_span": [31, 41], "with_context": "\nexecute 'enable lxcbr0' do\ncommand 'ifup lxcbr0'\naction :nothing\nend\n\n36: # @todo this is temp! don't leave this mess\n\nfile '/etc/sysconfig/iptables' do\ncontent [\n'# Chef managed to enable LXC',\n'*filter',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: hw-cookbooks_lxc-recipes-rhel_bridge.rb\n# Target line: 36\n\n     31: execute 'enable lxcbr0' do\n     32:   command 'ifup lxcbr0'\n     33:   action :nothing\n     34: end\n     35: \n>>>  36: # @todo this is temp! don't leave this mess\n     37: \n     38: file '/etc/sysconfig/iptables' do\n     39:   content [\n     40:     '# Chef managed to enable LXC',\n     41:     '*filter',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-rundeck-recipes-client.rb", "content": "# FIXME: perms must be set right on /var/lib/rundeck and .ssh", "line": 2, "detection_span": [1, 7], "with_context": "\n# FIXME: home should be /var/lib/rundeck not :home_dir\n2: # FIXME: perms must be set right on /var/lib/rundeck and .ssh\n\nunless system \"id -u rundeck\" #if the rundeck user has running processes, daemon_user will fail\ndaemon_user :rundeck do\nhome         node[:rundeck][:home_dir]\nmanage_home  true             # rundeck owns this so it can manage its own SSH credentials", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-rundeck-recipes-client.rb\n# Target line: 2\n\n      1: # FIXME: home should be /var/lib/rundeck not :home_dir\n>>>   2: # FIXME: perms must be set right on /var/lib/rundeck and .ssh\n      3: \n      4: unless system \"id -u rundeck\" #if the rundeck user has running processes, daemon_user will fail\n      5:   daemon_user :rundeck do\n      6:     home         node[:rundeck][:home_dir]\n      7:     manage_home  true             # rundeck owns this so it can manage its own SSH credentials\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "xdv-staging_chef-os-hardening-recipes-apt.rb", "content": "# TODO: could check apt.conf to make sure this hasn't been disabled.", "line": 24, "detection_span": [19, 29], "with_context": "\n#\n\ninclude_recipe 'apt'\n\n# apt-get and aptitude check package signatures by default.\n24: # TODO: could check apt.conf to make sure this hasn't been disabled.\n\nif node['security']['packages']['clean']\n\n# remove packages and handle virtual packages correctly.\n# this is the same package list as used for the redhat distro family", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: xdv-staging_chef-os-hardening-recipes-apt.rb\n# Target line: 24\n\n     19: #\n     20: \n     21: include_recipe 'apt'\n     22: \n     23: # apt-get and aptitude check package signatures by default.\n>>>  24: # TODO: could check apt.conf to make sure this hasn't been disabled.\n     25: \n     26: if node['security']['packages']['clean']\n     27: \n     28:   # remove packages and handle virtual packages correctly.\n     29:   # this is the same package list as used for the redhat distro family\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb", "content": "# @see #debug?", "line": 57, "detection_span": [52, 62], "with_context": "\n)\nend\n\n# Log a message only if Poise's extra debugging output is enabled.\n#\n57:   # @see #debug?\n# @param msg [String] Log message.\n# @return [void]\ndef self.debug(msg)\nChef::Log.debug(msg) if debug?\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb\n# Target line: 57\n\n     52:     )\n     53:   end\n     54: \n     55:   # Log a message only if Poise's extra debugging output is enabled.\n     56:   #\n>>>  57:   # @see #debug?\n     58:   # @param msg [String] Log message.\n     59:   # @return [void]\n     60:   def self.debug(msg)\n     61:     Chef::Log.debug(msg) if debug?\n     62:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-logrotate-attributes-default.rb", "content": "# TODO: remove provider option in next major release", "line": 26, "detection_span": [21, 31], "with_context": "\n\ndefault['logrotate']['package'] = {\n'name' => 'logrotate',\n'source' => nil,\n'version' => nil,\n26:   # TODO: remove provider option in next major release\n'provider' => nil,\n'action' => :upgrade,\n}\n\ndefault['logrotate']['directory'] = '/etc/logrotate.d'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-logrotate-attributes-default.rb\n# Target line: 26\n\n     21: \n     22: default['logrotate']['package'] = {\n     23:   'name' => 'logrotate',\n     24:   'source' => nil,\n     25:   'version' => nil,\n>>>  26:   # TODO: remove provider option in next major release\n     27:   'provider' => nil,\n     28:   'action' => :upgrade,\n     29: }\n     30: \n     31: default['logrotate']['directory'] = '/etc/logrotate.d'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-hivemq.rb", "content": "#     # service_check_prefix - required: false  - string", "line": 15, "detection_span": [10, 20], "with_context": "\n#     \"is_jmx\" => true,\n#     # collect_default_metrics - required: true  - boolean\n#     \"collect_default_metrics\" => true,\n#     # new_gc_metrics - required: false  - boolean\n#     \"new_gc_metrics\" => false,\n15: #     # service_check_prefix - required: false  - string\n#     \"service_check_prefix\" => nil,\n#     # conf - required: false  - array of object\n#     \"conf\" => [\n#       {\n#         \"include\" => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-recipes-hivemq.rb\n# Target line: 15\n\n     10: #     \"is_jmx\" => true,\n     11: #     # collect_default_metrics - required: true  - boolean\n     12: #     \"collect_default_metrics\" => true,\n     13: #     # new_gc_metrics - required: false  - boolean\n     14: #     \"new_gc_metrics\" => false,\n>>>  15: #     # service_check_prefix - required: false  - string\n     16: #     \"service_check_prefix\" => nil,\n     17: #     # conf - required: false  - array of object\n     18: #     \"conf\" => [\n     19: #       {\n     20: #         \"include\" => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-resources-release.rb", "content": "# Chef::Log.info( [environment, install_dir, home_dir, release_file, release_basename, release_ext, release_url, prefix_root ].inspect )", "line": 109, "detection_span": [104, 114], "with_context": "\nwhen 'tar.bz2' then untar_cmd('xjf', release_file, install_dir)\nwhen 'zip'     then \"unzip -q -u -o '#{release_file}'\"\nelse raise \"Don't know how to expand #{release_url} which has extension '#{release_ext}'\"\nend\n108:\n109:   # Chef::Log.info( [environment, install_dir, home_dir, release_file, release_basename, release_ext, release_url, prefix_root ].inspect )\n110: end\n111:\n112: def untar_cmd(sub_cmd, release_file, install_dir)\n113:   %Q{mkdir -p '#{install_dir}' ; tar #{sub_cmd} '#{release_file}' --strip-components=1 -C '#{install_dir}'}\n114: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-resources-release.rb\n# Target line: 109\n\n    104:     when 'tar.bz2' then untar_cmd('xjf', release_file, install_dir)\n    105:     when 'zip'     then \"unzip -q -u -o '#{release_file}'\"\n    106:     else raise \"Don't know how to expand #{release_url} which has extension '#{release_ext}'\"\n    107:     end\n    108: \n>>> 109:   # Chef::Log.info( [environment, install_dir, home_dir, release_file, release_basename, release_ext, release_url, prefix_root ].inspect )\n    110: end\n    111: \n    112: def untar_cmd(sub_cmd, release_file, install_dir)\n    113:   %Q{mkdir -p '#{install_dir}' ; tar #{sub_cmd} '#{release_file}' --strip-components=1 -C '#{install_dir}'}\n    114: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danielladd_Chef-Testing-cookbooks-php-resources-pear_channel.rb", "content": "# TODO: add authenticated channel support!", "line": 27, "detection_span": [22, 32], "with_context": "\nactions :discover, :add, :update, :remove\n\nattribute :channel_name, :kind_of => String, :name_attribute => true\nattribute :channel_xml, :kind_of => String\n\n27: # TODO: add authenticated channel support!\n# attribute :username, :kind_of => String\n# attribute :password, :kind_of => String", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-php-resources-pear_channel.rb\n# Target line: 27\n\n     22: actions :discover, :add, :update, :remove\n     23: \n     24: attribute :channel_name, :kind_of => String, :name_attribute => true\n     25: attribute :channel_xml, :kind_of => String\n     26: \n>>>  27: # TODO: add authenticated channel support!\n     28: # attribute :username, :kind_of => String\n     29: # attribute :password, :kind_of => String\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb", "content": "# Check if Poise's extra debugging output is enabled. This produces a *lot*", "line": 34, "detection_span": [29, 39], "with_context": "\nautoload :Resource, 'poise/resource'\nautoload :Subcontext, 'poise/subcontext'\nautoload :Utils, 'poise/utils'\nautoload :VERSION, 'poise/version'\n\n34:   # Check if Poise's extra debugging output is enabled. This produces a *lot*\n# of logging.\n#\n# @param node [Chef::Node, Chef::RunContext] Optional node to check for\n#   attributes. If not given, Chef.node is used instead.\n# @return [Boolean]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb\n# Target line: 34\n\n     29:   autoload :Resource, 'poise/resource'\n     30:   autoload :Subcontext, 'poise/subcontext'\n     31:   autoload :Utils, 'poise/utils'\n     32:   autoload :VERSION, 'poise/version'\n     33: \n>>>  34:   # Check if Poise's extra debugging output is enabled. This produces a *lot*\n     35:   # of logging.\n     36:   #\n     37:   # @param node [Chef::Node, Chef::RunContext] Optional node to check for\n     38:   #   attributes. If not given, Chef.node is used instead.\n     39:   # @return [Boolean]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice-h2020-recipes-conf-optim.rb", "content": "# TODO temporary step before the utilities are packaged in the release", "line": 95, "detection_span": [90, 100], "with_context": "\ncp bin/ubuntu64/run_main.sh #{co_install_path}\nEOH\naction :run\nend\n\n95: # TODO temporary step before the utilities are packaged in the release\nbash 'install-co-ext' do\ncwd \"/tmp\"\ncode <<-EOH\n[[ -d co-src ]] && rm -rf co-src\n100: \t\tmkdir -p co-src", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice-h2020-recipes-conf-optim.rb\n# Target line: 95\n\n     90: \t\tcp bin/ubuntu64/run_main.sh #{co_install_path}\n     91: \t\tEOH\n     92: \taction :run\n     93: end\n     94: \n>>>  95: # TODO temporary step before the utilities are packaged in the release\n     96: bash 'install-co-ext' do\n     97: \tcwd \"/tmp\"\n     98: \tcode <<-EOH\n     99: \t\t[[ -d co-src ]] && rm -rf co-src\n    100: \t\tmkdir -p co-src\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-snmp.rb", "content": "# TODO: for now the defaultMonitors are turned off, they produce bogus error", "line": 121, "detection_span": [116, 126], "with_context": "\n:sys_location  => node['sys']['snmp']['sys_location']\n117:   )\n118: end\n119:\n120:\n121: # TODO: for now the defaultMonitors are turned off, they produce bogus error\n#       messages  service startup  MIBs are available\n#       (package 'snmp-mibs-downloader')\n#       and configured in /etc/default/snmpd ('export MIBS=/usr/share/mibs')\n125:\n126: service 'snmpd' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-snmp.rb\n# Target line: 121\n\n    116:     :sys_location  => node['sys']['snmp']['sys_location']\n    117:   )\n    118: end\n    119: \n    120: \n>>> 121: # TODO: for now the defaultMonitors are turned off, they produce bogus error\n    122: #       messages  service startup  MIBs are available\n    123: #       (package 'snmp-mibs-downloader')\n    124: #       and configured in /etc/default/snmpd ('export MIBS=/usr/share/mibs')\n    125: \n    126: service 'snmpd' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-radioedit-providers-node.rb", "content": "# TODO", "line": 30, "detection_span": [25, 35], "with_context": "\n\n\n\n\n# Create service init script for application.\n30: # TODO\n\naction :init do\n\nnew_resource = @new_resource\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-radioedit-providers-node.rb\n# Target line: 30\n\n     25: \n     26: \n     27: \n     28: \n     29: # Create service init script for application.\n>>>  30: # TODO\n     31: \n     32: action :init do \n     33: \n     34:   new_resource = @new_resource\n     35: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-recipes-default.rb", "content": "# FIXME -- these need to be done immediately", "line": 22, "detection_span": [17, 27], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n22: # FIXME -- these need to be done immediately\n\npackage \"unzip\"\n\npackage \"tar\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-recipes-default.rb\n# Target line: 22\n\n     17: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     18: # See the License for the specific language governing permissions and\n     19: # limitations under the License.\n     20: #\n     21: \n>>>  22: # FIXME -- these need to be done immediately\n     23: \n     24: package \"unzip\"\n     25: \n     26: package \"tar\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-openstack-network-recipes-dhcp_agent.rb", "content": "# TODO: (jklare) this should be refactored and probably pull in the some dnsmasq", "line": 51, "detection_span": [46, 56], "with_context": "\nvariables(\nservice_config: service_config\n)\nend\n\n51: # TODO: (jklare) this should be refactored and probably pull in the some dnsmasq\n# cookbook to do the proper configuration\npackage 'dnsmasq' do\naction :upgrade\nend if platform_family?('rhel')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-network-recipes-dhcp_agent.rb\n# Target line: 51\n\n     46:   variables(\n     47:     service_config: service_config\n     48:   )\n     49: end\n     50: \n>>>  51: # TODO: (jklare) this should be refactored and probably pull in the some dnsmasq\n     52: # cookbook to do the proper configuration\n     53: package 'dnsmasq' do\n     54:   action :upgrade\n     55: end if platform_family?('rhel')\n     56: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "circlebuilder_CircleBuilder-Chef-cookbooks-mysql_replication_check-recipes-default.rb", "content": "# the number of seconds delay at which a warning alert is issued; default 30 minutes (1800 seconds)", "line": 15, "detection_span": [10, 20], "with_context": "\n# installation path for monitoring tool\ninstall_path = '/data/monitoring'\n\n# configuration of replication check script\ncheck_vars = {\n15:   # the number of seconds delay at which a warning alert is issued; default 30 minutes (1800 seconds)\n:warn_level => 1800,\n# the number of seconds delay at which a critical alert is issued; default 2 hours (7200 seconds)\n:crit_level => 7200,\n# valid email address to receive alerts\n:mail_recipient => '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: circlebuilder_CircleBuilder-Chef-cookbooks-mysql_replication_check-recipes-default.rb\n# Target line: 15\n\n     10: # installation path for monitoring tool\n     11: install_path = '/data/monitoring'\n     12: \n     13: # configuration of replication check script\n     14: check_vars = {\n>>>  15:   # the number of seconds delay at which a warning alert is issued; default 30 minutes (1800 seconds)\n     16:   :warn_level => 1800,\n     17:   # the number of seconds delay at which a critical alert is issued; default 2 hours (7200 seconds)\n     18:   :crit_level => 7200,\n     19:   # valid email address to receive alerts\n     20:   :mail_recipient => '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "brijeshakbari_chefrepo-recipes-install.rb", "content": "# necessary until upstream fixes ENABLE_MONGOD/DB flag", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\ncase node['platform_family']\nwhen 'debian'\n# this options lets us bypass complaint of pre-existing init file\n66:   # necessary until upstream fixes ENABLE_MONGOD/DB flag\npackager_opts = '-o Dpkg::Options::=\"--force-confold\" --force-yes'\nwhen 'rhel'\n# Add --nogpgcheck option when package is signed\n# see: https://jira.mongodb.org/browse/SERVER-8770\npackager_opts = '--nogpgcheck'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: brijeshakbari_chefrepo-recipes-install.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: case node['platform_family']\n     64: when 'debian'\n     65:   # this options lets us bypass complaint of pre-existing init file\n>>>  66:   # necessary until upstream fixes ENABLE_MONGOD/DB flag\n     67:   packager_opts = '-o Dpkg::Options::=\"--force-confold\" --force-yes'\n     68: when 'rhel'\n     69:   # Add --nogpgcheck option when package is signed\n     70:   # see: https://jira.mongodb.org/browse/SERVER-8770\n     71:   packager_opts = '--nogpgcheck'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb", "content": "# restart service for solaris on chef-client has a bug", "line": 133, "detection_span": [128, 138], "with_context": "\n128:   template \"#{node['postfix']['conf_dir']}/#{cfg}.cf\" do\nsource \"#{cfg}.cf.erb\"\nowner 'root'\ngroup node['root_group']\nmode '0644'\n133:     # restart service for solaris on chef-client has a bug\n# unless condition can be removed after\n# https://github.com/chef/chef/pull/6596 merge/release\nnotifies :restart, 'service[postfix]' unless platform_family?('solaris2')\nvariables(\nlazy { { settings: node['postfix'][cfg] } }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb\n# Target line: 133\n\n    128:   template \"#{node['postfix']['conf_dir']}/#{cfg}.cf\" do\n    129:     source \"#{cfg}.cf.erb\"\n    130:     owner 'root'\n    131:     group node['root_group']\n    132:     mode '0644'\n>>> 133:     # restart service for solaris on chef-client has a bug\n    134:     # unless condition can be removed after\n    135:     # https://github.com/chef/chef/pull/6596 merge/release\n    136:     notifies :restart, 'service[postfix]' unless platform_family?('solaris2')\n    137:     variables(\n    138:       lazy { { settings: node['postfix'][cfg] } }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb", "content": "default[:elasticsearch][:index_cache_field_type]  = 'resident'   # Another option is soft, which will increase cache performance but be wary because this will make it crash if the \"wrong\" query is issued. The field cache can OOM your machine in a moment when too large, but when you have the RAM field values are one of the most important things to cache. Consider setting this to a very high value to be safe; certainly, set it on indexes that are very large.", "line": 73, "detection_span": [68, 78], "with_context": "\ndefault[:elasticsearch][:flush_threshold_ops]     = 5000\ndefault[:elasticsearch][:flush_threshold_size]    = \"200mb\"\ndefault[:elasticsearch][:flush_threshold_period]  = \"60s\"\ndefault[:elasticsearch][:cache_filter_size]       = \"20%\"  # can be a percent (\"10%\") or a number (\"128m\")\ndefault[:elasticsearch][:index_buffer_size]       = \"10%\"  # can be a percent (\"10%\") or a number (\"128m\") (changed 2012-10 to default 10%, same as es default)\n73: default[:elasticsearch][:index_cache_field_type]  = 'resident'   # Another option is soft, which will increase cache performance but be wary because this will make it crash if the \"wrong\" query is issued. The field cache can OOM your machine in a moment when too large, but when you have the RAM field values are one of the most important things to cache. Consider setting this to a very high value to be safe; certainly, set it on indexes that are very large.\ndefault[:elasticsearch][:merge_factor]            = 10\ndefault[:elasticsearch][:floor_segment]           = \"2.7mb\"\n\ndefault[:elasticsearch][:max_thread_count]        = nil    # Maximum value given that max_thread_count must be < max_merge_count (changed 2012-10 to default nil)\ndefault[:elasticsearch][:term_index_interval]     = 1024", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb\n# Target line: 73\n\n     68: default[:elasticsearch][:flush_threshold_ops]     = 5000\n     69: default[:elasticsearch][:flush_threshold_size]    = \"200mb\"\n     70: default[:elasticsearch][:flush_threshold_period]  = \"60s\"\n     71: default[:elasticsearch][:cache_filter_size]       = \"20%\"  # can be a percent (\"10%\") or a number (\"128m\")\n     72: default[:elasticsearch][:index_buffer_size]       = \"10%\"  # can be a percent (\"10%\") or a number (\"128m\") (changed 2012-10 to default 10%, same as es default)\n>>>  73: default[:elasticsearch][:index_cache_field_type]  = 'resident'   # Another option is soft, which will increase cache performance but be wary because this will make it crash if the \"wrong\" query is issued. The field cache can OOM your machine in a moment when too large, but when you have the RAM field values are one of the most important things to cache. Consider setting this to a very high value to be safe; certainly, set it on indexes that are very large.\n     74: default[:elasticsearch][:merge_factor]            = 10\n     75: default[:elasticsearch][:floor_segment]           = \"2.7mb\"\n     76: \n     77: default[:elasticsearch][:max_thread_count]        = nil    # Maximum value given that max_thread_count must be < max_merge_count (changed 2012-10 to default nil)\n     78: default[:elasticsearch][:term_index_interval]     = 1024\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-poise-files-halite_gem-poise.rb", "content": "# Display a message if poise_debug is enabled. Off in ChefSpec so I don't get", "line": 106, "detection_span": [101, 111], "with_context": "\n101:   end\n102:\n103:   mod\n104: end\n105:\n106: # Display a message if poise_debug is enabled. Off in ChefSpec so I don't get\n107: # extra logging stuff that I don't care about.\n108: Poise.debug('[Poise] Extra verbose logging enabled') unless defined?(ChefSpec)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-poise-files-halite_gem-poise.rb\n# Target line: 106\n\n    101:   end\n    102: \n    103:   mod\n    104: end\n    105: \n>>> 106: # Display a message if poise_debug is enabled. Off in ChefSpec so I don't get\n    107: # extra logging stuff that I don't care about.\n    108: Poise.debug('[Poise] Extra verbose logging enabled') unless defined?(ChefSpec)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-apt-recipes-cacher-ng.rb", "content": "# Reopen resource w/ start in case config issue causes startup to fail", "line": 38, "detection_span": [33, 43], "with_context": "\ngroup \"root\"\nmode 00644\nnotifies :restart, \"service[apt-cacher-ng]\"\nend\n\n38:   # Reopen resource w/ start in case config issue causes startup to fail\nservice \"apt-cacher-ng\" do\naction :start\nend\n\n#this will help seed the proxy", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-apt-recipes-cacher-ng.rb\n# Target line: 38\n\n     33:     group \"root\"\n     34:     mode 00644\n     35:     notifies :restart, \"service[apt-cacher-ng]\"\n     36:   end\n     37:   \n>>>  38:   # Reopen resource w/ start in case config issue causes startup to fail\n     39:   service \"apt-cacher-ng\" do\n     40:     action :start\n     41:   end\n     42:   \n     43:   #this will help seed the proxy\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-radioedit-providers-node.rb", "content": "## TODO: TREY:  need the following packages added to package.json", "line": 14, "detection_span": [9, 19], "with_context": "\n## jderagon\n##\n## major refactor for han releaseo\n\n\n14: ## TODO: TREY:  need the following packages added to package.json\n## 'jsdom'\n## 'jquery'\n## 'xmlhttprequest'\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-radioedit-providers-node.rb\n# Target line: 14\n\n      9: ## jderagon\n     10: ##\n     11: ## major refactor for han releaseo\n     12: \n     13: \n>>>  14: ## TODO: TREY:  need the following packages added to package.json\n     15: ## 'jsdom'\n     16: ## 'jquery'\n     17: ## 'xmlhttprequest'\n     18: \n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-mailman-recipes-default.rb", "content": "#TODO: set preseed for language options", "line": 55, "detection_span": [50, 60], "with_context": "\n# enable false\n#end\n\n######## Mailman configuration\n\n55: #TODO: set preseed for language options\npackage \"mailman\"\n\nservice \"mailman\" do\naction [:enable, :start]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-mailman-recipes-default.rb\n# Target line: 55\n\n     50: # enable false\n     51: #end\n     52: \n     53: ######## Mailman configuration\n     54: \n>>>  55: #TODO: set preseed for language options\n     56: package \"mailman\"\n     57: \n     58: service \"mailman\" do\n     59:   action [:enable, :start]\n     60: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "aws_opsworks-cookbooks-php-attributes-default.rb", "content": "# would completely override this file and might cause upgrade issues.", "line": 12, "detection_span": [7, 17], "with_context": "\n# However, you should not edit customize.rb directly. Instead, create\n# \"php/attributes/customize.rb\" in your cookbook repository and\n# put the overrides in YOUR customize.rb file.\n#\n# Do NOT create an 'php/attributes/default.rb' in your cookbooks. Doing so\n12: # would completely override this file and might cause upgrade issues.\n#\n# See also: http://docs.aws.amazon.com/opsworks/latest/userguide/customizing.html\n###\n\ninclude_attribute 'deploy'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-php-attributes-default.rb\n# Target line: 12\n\n      7: # However, you should not edit customize.rb directly. Instead, create\n      8: # \"php/attributes/customize.rb\" in your cookbook repository and\n      9: # put the overrides in YOUR customize.rb file.\n     10: #\n     11: # Do NOT create an 'php/attributes/default.rb' in your cookbooks. Doing so\n>>>  12: # would completely override this file and might cause upgrade issues.\n     13: #\n     14: # See also: http://docs.aws.amazon.com/opsworks/latest/userguide/customizing.html\n     15: ###\n     16: \n     17: include_attribute 'deploy'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fzylogic_nova-recipes-libvirt.rb", "content": "# TODO(breu): this section needs to be rewritten to support key privisioning", "line": 46, "detection_span": [41, 51], "with_context": "\nsupports :status => true, :restart => true\naction :enable\nend\n\n#\n46: # TODO(breu): this section needs to be rewritten to support key privisioning\n#\ntemplate \"/etc/libvirt/libvirtd.conf\" do\nsource \"libvirtd.conf.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fzylogic_nova-recipes-libvirt.rb\n# Target line: 46\n\n     41:   supports :status => true, :restart => true\n     42:   action :enable\n     43: end\n     44: \n     45: #\n>>>  46: # TODO(breu): this section needs to be rewritten to support key privisioning\n     47: #\n     48: template \"/etc/libvirt/libvirtd.conf\" do\n     49:   source \"libvirtd.conf.erb\"\n     50:   owner \"root\"\n     51:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-kafka-recipes-server.rb", "content": "# TODO symlink /var/log/kafka/kafka.log or whatever (CLEANUP)", "line": 12, "detection_span": [7, 17], "with_context": "\n\n# create the runit service\nrunit_service \"kafka\" do\nrun_state node[:kafka][:server][:run_state]\noptions({\n12:     # TODO symlink /var/log/kafka/kafka.log or whatever (CLEANUP)\n:log_dir => node[:kafka][:log_dir],\n:home_dir => node[:kafka][:home_dir],\n:journal_dir => node[:kafka][:journal_dir],\n:install_dir => node[:kafka][:install_dir],\n:java_home => node[:java][:java_home],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-kafka-recipes-server.rb\n# Target line: 12\n\n      7: \n      8: # create the runit service\n      9: runit_service \"kafka\" do\n     10:   run_state node[:kafka][:server][:run_state]\n     11:   options({\n>>>  12:     # TODO symlink /var/log/kafka/kafka.log or whatever (CLEANUP)\n     13:     :log_dir => node[:kafka][:log_dir],\n     14:     :home_dir => node[:kafka][:home_dir],\n     15:     :journal_dir => node[:kafka][:journal_dir],\n     16:     :install_dir => node[:kafka][:install_dir],\n     17:     :java_home => node[:java][:java_home],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb", "content": "# network_id=\"some_suffix\" chef-client -z --runlist \\", "line": 70, "detection_span": [65, 75], "with_context": "\n\n# The environment variable 'network_id' defines a suffix for a network name when\n# using this example. If running from the command line, you can pass this suffix\n# in via the command line:\n#\n70: # network_id=\"some_suffix\" chef-client -z --runlist \\\n#   \"recipe[gcompute::examples~network~auto]\"\nputs 'Converting network to Custom'\ngcompute_network \"chef-e2e-mynetwork-#{ENV['network_id']}\" do\naction :create\nauto_create_subnetworks false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb\n# Target line: 70\n\n     65: \n     66: # The environment variable 'network_id' defines a suffix for a network name when\n     67: # using this example. If running from the command line, you can pass this suffix\n     68: # in via the command line:\n     69: #\n>>>  70: # network_id=\"some_suffix\" chef-client -z --runlist \\\n     71: #   \"recipe[gcompute::examples~network~auto]\"\n     72: puts 'Converting network to Custom'\n     73: gcompute_network \"chef-e2e-mynetwork-#{ENV['network_id']}\" do\n     74:   action :create\n     75:   auto_create_subnetworks false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "davestarling_chef-features-data-cookbooks-delayed_notifications-recipes-forward_references.rb", "content": "# expected behavior is for the reference to be resolved later", "line": 3, "detection_span": [1, 8], "with_context": "\nexecute(\"echo foo\") do\n# refers to the resource below, which isn't defined yet.\n3:   # expected behavior is for the reference to be resolved later\n# and the notification to work correctly\nnotifies(:create, \"file[#{node[:tmpdir]}/notified_file.txt]\")\nend\n\nfile \"#{node[:tmpdir]}/notified_file.txt\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: davestarling_chef-features-data-cookbooks-delayed_notifications-recipes-forward_references.rb\n# Target line: 3\n\n      1: execute(\"echo foo\") do\n      2:   # refers to the resource below, which isn't defined yet.\n>>>   3:   # expected behavior is for the reference to be resolved later\n      4:   # and the notification to work correctly\n      5:   notifies(:create, \"file[#{node[:tmpdir]}/notified_file.txt]\")\n      6: end\n      7: \n      8: file \"#{node[:tmpdir]}/notified_file.txt\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-ark-libraries-default.rb", "content": "# TODO: what happens when the path is already set --", "line": 54, "detection_span": [49, 59], "with_context": "\nnew_resource.prefix_root = defaults.prefix_root\nnew_resource.home_dir = defaults.home_dir\nnew_resource.version = defaults.version\nnew_resource.owner = defaults.owner\n\n54:       # TODO: what happens when the path is already set --\n#   with the current logic we overwrite it\n#   if you are in windows we overwrite it\n#   otherwise we overwrite it with the root/name-version\nnew_resource.path = defaults.path\nnew_resource.release_file = defaults.release_file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-ark-libraries-default.rb\n# Target line: 54\n\n     49:       new_resource.prefix_root = defaults.prefix_root\n     50:       new_resource.home_dir = defaults.home_dir\n     51:       new_resource.version = defaults.version\n     52:       new_resource.owner = defaults.owner\n     53: \n>>>  54:       # TODO: what happens when the path is already set --\n     55:       #   with the current logic we overwrite it\n     56:       #   if you are in windows we overwrite it\n     57:       #   otherwise we overwrite it with the root/name-version\n     58:       new_resource.path = defaults.path\n     59:       new_resource.release_file = defaults.release_file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_glance-recipes-replicator.rb", "content": "# TODO(breu): remove this stanza sometime in the future", "line": 39, "detection_span": [34, 44], "with_context": "\npackage \"glance-image-sync\" do\naction node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\noptions platform_options[\"package_options\"]\nend\n\n39:   # TODO(breu): remove this stanza sometime in the future\nfile \"/var/lib/glance/glance-image-sync.py\" do\naction :delete\nonly_if { ::File.exists?(\"/var/lib/glance/glance-image-sync.py\") }\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_glance-recipes-replicator.rb\n# Target line: 39\n\n     34:   package \"glance-image-sync\" do\n     35:     action node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\n     36:     options platform_options[\"package_options\"]\n     37:   end\n     38: \n>>>  39:   # TODO(breu): remove this stanza sometime in the future\n     40:   file \"/var/lib/glance/glance-image-sync.py\" do\n     41:     action :delete\n     42:     only_if { ::File.exists?(\"/var/lib/glance/glance-image-sync.py\") }\n     43:   end\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-hue.rb", "content": "privs = \"ALL\" # todo node[:bcpc][:hadoop][:hue_db_privs].join(\",\")", "line": 8, "detection_span": [3, 13], "with_context": "\n\nmake_config('mysql-hue-password', secure_password)\nmake_config('hue-session-key', secure_password)\n\nbash \"hue-database-creation\" do\n8:   privs = \"ALL\" # todo node[:bcpc][:hadoop][:hue_db_privs].join(\",\")\ncode <<-EOH\nmysql -u root -p#{get_config('mysql-root-password')} -e \"CREATE DATABASE desktop;\nGRANT #{privs} ON desktop.* TO 'hue'@'%' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\nGRANT #{privs} ON desktop.* TO 'hue'@'localhost' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\nFLUSH PRIVILEGES;\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-hue.rb\n# Target line: 8\n\n      3: \n      4: make_config('mysql-hue-password', secure_password)\n      5: make_config('hue-session-key', secure_password)\n      6: \n      7: bash \"hue-database-creation\" do\n>>>   8:   privs = \"ALL\" # todo node[:bcpc][:hadoop][:hue_db_privs].join(\",\")\n      9:   code <<-EOH\n     10:     mysql -u root -p#{get_config('mysql-root-password')} -e \"CREATE DATABASE desktop;\n     11:                                                              GRANT #{privs} ON desktop.* TO 'hue'@'%' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\n     12:                                                              GRANT #{privs} ON desktop.* TO 'hue'@'localhost' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\n     13:                                                              FLUSH PRIVILEGES;\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-php-resources-pear_channel.rb", "content": "# TODO add authenticated channel support!", "line": 26, "detection_span": [21, 31], "with_context": "\nactions :discover, :add, :update, :remove\n\nattribute :channel_name, :kind_of => String, :name_attribute => true\nattribute :channel_xml, :kind_of => String\n\n26: # TODO add authenticated channel support!\n# attribute :username, :kind_of => String\n# attribute :password, :kind_of => String", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-php-resources-pear_channel.rb\n# Target line: 26\n\n     21: actions :discover, :add, :update, :remove\n     22: \n     23: attribute :channel_name, :kind_of => String, :name_attribute => true\n     24: attribute :channel_xml, :kind_of => String\n     25: \n>>>  26: # TODO add authenticated channel support!\n     27: # attribute :username, :kind_of => String\n     28: # attribute :password, :kind_of => String\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "FriendsOfCake_vagrant-chef-cookbooks-system-libraries-sane_logger.rb", "content": "# Previous|Cloning|Current... messages should go in the debug level", "line": 16, "detection_span": [11, 21], "with_context": "\nelse\nsuper\nend\nend\n\n16:     # Previous|Cloning|Current... messages should go in the debug level\ndef self.warn(msg=nil, &block)\nif msg =~ /^(Previous|Cloning|Current)/\ndebug(msg, &block)\nelse\nsuper", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: FriendsOfCake_vagrant-chef-cookbooks-system-libraries-sane_logger.rb\n# Target line: 16\n\n     11:       else\n     12:         super\n     13:       end\n     14:     end\n     15: \n>>>  16:     # Previous|Cloning|Current... messages should go in the debug level\n     17:     def self.warn(msg=nil, &block)\n     18:       if msg =~ /^(Previous|Cloning|Current)/\n     19:         debug(msg, &block)\n     20:       else\n     21:         super\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "gwalbran_chef-cookbooks-imos_jenkins-recipes-managed_master.rb", "content": "# Give jenkins permission to run sudo commands - TODO: remove the need for sudo in jobs", "line": 26, "detection_span": [21, 31], "with_context": "\nnode.set['jenkins']['master']['jvm_options'] = node['imos_jenkins']['master']['jvm_options']\n\ninclude_recipe 'jenkins::master'\ninclude_recipe 'imos_jenkins::keys'\n\n26: # Give jenkins permission to run sudo commands - TODO: remove the need for sudo in jobs\nsudo 'jenkins' do\ngroup 'jenkins'\nrunas    'ALL'\ncommands ['ALL']\nhost     'ALL'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_jenkins-recipes-managed_master.rb\n# Target line: 26\n\n     21: node.set['jenkins']['master']['jvm_options'] = node['imos_jenkins']['master']['jvm_options']\n     22: \n     23: include_recipe 'jenkins::master'\n     24: include_recipe 'imos_jenkins::keys'\n     25: \n>>>  26: # Give jenkins permission to run sudo commands - TODO: remove the need for sudo in jobs\n     27: sudo 'jenkins' do\n     28:   group 'jenkins'\n     29:   runas    'ALL'\n     30:   commands ['ALL']\n     31:   host     'ALL'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "logicalclocks_hops-hadoop-chef-recipes-format.rb", "content": "# it is ok if all namenodes format the fs. Unless you add a new one later..", "line": 4, "detection_span": [1, 9], "with_context": "\ninclude_recipe \"hops::default\"\nexec=node['ndb']['scripts_dir'] + \"/mysql-client.sh\"\n\n4: # it is ok if all namenodes format the fs. Unless you add a new one later..\n# if the nn has already been formatted, re-formatting it returns error\n# TODO: test if the NameNode is running\nif \"#{node['hops']['format']}\" === \"true\"\nif ::File.exist?(\"#{node['hops']['base_dir']}/.nn_formatted\") === false || \"#{node['hops']['reformat']}\" === \"true\"\nhops_ndb \"format-nn\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: logicalclocks_hops-hadoop-chef-recipes-format.rb\n# Target line: 4\n\n      1: include_recipe \"hops::default\"\n      2: exec=node['ndb']['scripts_dir'] + \"/mysql-client.sh\"\n      3: \n>>>   4: # it is ok if all namenodes format the fs. Unless you add a new one later..\n      5: # if the nn has already been formatted, re-formatting it returns error\n      6: # TODO: test if the NameNode is running\n      7: if \"#{node['hops']['format']}\" === \"true\"\n      8:   if ::File.exist?(\"#{node['hops']['base_dir']}/.nn_formatted\") === false || \"#{node['hops']['reformat']}\" === \"true\"\n      9:     hops_ndb \"format-nn\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb", "content": "# The environment variable 'network_id' defines a suffix for a network name when", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\nraise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\nunless ENV.key?('network_id')\n\n66: # The environment variable 'network_id' defines a suffix for a network name when\n# using this example. If running from the command line, you can pass this suffix\n# in via the command line:\n#\n# network_id=\"some_suffix\" chef-client -z --runlist \\\n#   \"recipe[gcompute::examples~network~auto]\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: raise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\n     64:   unless ENV.key?('network_id')\n     65: \n>>>  66: # The environment variable 'network_id' defines a suffix for a network name when\n     67: # using this example. If running from the command line, you can pass this suffix\n     68: # in via the command line:\n     69: #\n     70: # network_id=\"some_suffix\" chef-client -z --runlist \\\n     71: #   \"recipe[gcompute::examples~network~auto]\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-default.rb", "content": "# and a hack to use rubygems to find the current Ruby binary;", "line": 36, "detection_span": [31, 41], "with_context": "\n'docopy' => false\n}\n\n# ensure the Zookeeper Gem is available for use in later recipes\n# it seems chef_gem fails to use the embedded gem(1) binary so use gem_package\n36: # and a hack to use rubygems to find the current Ruby binary;\n# assume gem is in the same dir (valid for Chef 10, Chef 11 dpkg and Chef 11 Omnibus)\nrequire 'pathname'\nrequire 'rubygems'\ngem_path = Pathname.new(Gem.ruby).dirname.join(\"gem\").to_s\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-default.rb\n# Target line: 36\n\n     31:     'docopy' => false\n     32: }\n     33: \n     34: # ensure the Zookeeper Gem is available for use in later recipes\n     35: # it seems chef_gem fails to use the embedded gem(1) binary so use gem_package\n>>>  36: # and a hack to use rubygems to find the current Ruby binary;\n     37: # assume gem is in the same dir (valid for Chef 10, Chef 11 dpkg and Chef 11 Omnibus)\n     38: require 'pathname'\n     39: require 'rubygems'\n     40: gem_path = Pathname.new(Gem.ruby).dirname.join(\"gem\").to_s\n     41: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb", "content": "# Later roles can use the \"!merge:\" feature to knock it out", "line": 49, "detection_span": [44, 54], "with_context": "\n#       :package_set => {\n#         :install => %w[ base dev sysadmin ],\n#       }\n#     })\n#\n49: # Later roles can use the \"!merge:\" feature to knock it out\n#\ndefault[:package_set][:install]          = %w[ ]\n\n# --------------------------------------------------------------------------\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb\n# Target line: 49\n\n     44: #       :package_set => {\n     45: #         :install => %w[ base dev sysadmin ],\n     46: #       }\n     47: #     })\n     48: #\n>>>  49: # Later roles can use the \"!merge:\" feature to knock it out\n     50: #\n     51: default[:package_set][:install]          = %w[ ]\n     52: \n     53: # --------------------------------------------------------------------------\n     54: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-papertrail-cookbooks-mongodb-recipes-mongos.rb", "content": "# FIXME: Don't depend on EC2 (GH-10)", "line": 46, "detection_span": [41, 51], "with_context": "\nmode 0644\nbackup false\nend\n\nconfigdb_servers = search(:node, 'recipes:mongodb\\:\\:config_server')\n46: # FIXME: Don't depend on EC2 (GH-10)\nconfigdb_server_list = configdb_servers.collect { |x| x.ec2.local_hostname }.join(',')\n\ncase init_system\nwhen \"upstart\"\ntemplate \"/etc/init/mongos.conf\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-papertrail-cookbooks-mongodb-recipes-mongos.rb\n# Target line: 46\n\n     41:   mode 0644\n     42:   backup false\n     43: end\n     44: \n     45: configdb_servers = search(:node, 'recipes:mongodb\\:\\:config_server')\n>>>  46: # FIXME: Don't depend on EC2 (GH-10)\n     47: configdb_server_list = configdb_servers.collect { |x| x.ec2.local_hostname }.join(',')\n     48: \n     49: case init_system\n     50: when \"upstart\"\n     51:   template \"/etc/init/mongos.conf\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sensu_sensu-chef-recipes-_linux.rb", "content": "# As of 0.27 we need to suffix the version string with the platform major", "line": 56, "detection_span": [51, 61], "with_context": "\nuri \"#{node['sensu']['yum_repo_url']}/#{repo}/7/x86_64/\"\ngpgkey node['sensu']['yum_key_url']\nend\nrepo.gpgcheck(true) if repo.respond_to?(:gpgcheck)\n\n56:   # As of 0.27 we need to suffix the version string with the platform major\n# version, e.g. \".el7\". Override default via node[\"sensu\"][\"version_suffix\"]\n# attribute.\nzypper_package \"sensu\" do\nversion lazy { \"1:\" + Sensu::Helpers.redhat_version_string(\nnode[\"sensu\"][\"version\"],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sensu_sensu-chef-recipes-_linux.rb\n# Target line: 56\n\n     51:     uri \"#{node['sensu']['yum_repo_url']}/#{repo}/7/x86_64/\"\n     52:     gpgkey node['sensu']['yum_key_url']\n     53:   end\n     54:   repo.gpgcheck(true) if repo.respond_to?(:gpgcheck)\n     55: \n>>>  56:   # As of 0.27 we need to suffix the version string with the platform major\n     57:   # version, e.g. \".el7\". Override default via node[\"sensu\"][\"version_suffix\"]\n     58:   # attribute.\n     59:   zypper_package \"sensu\" do\n     60:     version lazy { \"1:\" + Sensu::Helpers.redhat_version_string(\n     61:       node[\"sensu\"][\"version\"],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_swap-recipes-before_fb_fstab.rb", "content": "# T39598868 Disabled until workaround or bug fix", "line": 100, "detection_span": [95, 105], "with_context": "\n'PartOf' => manage_unit,\n},\n# Stopping swap is pathologically slow on Linux today. The general\n# default for stopping units in systemd is 90s. Here we'll use\n# 100s per GiB as a heuristic on top of the default.\n100:               # T39598868 Disabled until workaround or bug fix\n# 'Service' => {\n#   'TimeoutStopSec' => 90 + 100 *\n#   (node['fb_swap']['_calculated'][\"#{@type}_size_bytes\"]\n#    / 2 ** 30),\n# }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_swap-recipes-before_fb_fstab.rb\n# Target line: 100\n\n     95:                 'PartOf' => manage_unit,\n     96:               },\n     97:               # Stopping swap is pathologically slow on Linux today. The general\n     98:               # default for stopping units in systemd is 90s. Here we'll use\n     99:               # 100s per GiB as a heuristic on top of the default.\n>>> 100:               # T39598868 Disabled until workaround or bug fix\n    101:               # 'Service' => {\n    102:               #   'TimeoutStopSec' => 90 + 100 *\n    103:               #   (node['fb_swap']['_calculated'][\"#{@type}_size_bytes\"]\n    104:               #    / 2 ** 30),\n    105:               # }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-cookbooks_aix-files-default-vendor-gems-aix-wpar-0.2.0-lib-wpars-network.rb", "content": "# <WPAR::Network name=\"kitchenwpar\", interface=\"en0\", address=\"10.10.10.100\", mask_prefix=\"255.255.255.0\", broadcast=\"10.10.10.255\">", "line": 4, "detection_span": [1, 9], "with_context": "\nrequire 'ostruct'\n\n#example of a WPAR network object\n4: # <WPAR::Network name=\"kitchenwpar\", interface=\"en0\", address=\"10.10.10.100\", mask_prefix=\"255.255.255.0\", broadcast=\"10.10.10.255\">\nmodule WPAR\nclass Network\nattr_reader :name\nattr_accessor :interface, :address, :mask_prefix, :broadcast\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_aix-files-default-vendor-gems-aix-wpar-0.2.0-lib-wpars-network.rb\n# Target line: 4\n\n      1: require 'ostruct'\n      2: \n      3: #example of a WPAR network object\n>>>   4: # <WPAR::Network name=\"kitchenwpar\", interface=\"en0\", address=\"10.10.10.100\", mask_prefix=\"255.255.255.0\", broadcast=\"10.10.10.255\">\n      5: module WPAR\n      6:   class Network\n      7:     attr_reader :name\n      8:     attr_accessor :interface, :address, :mask_prefix, :broadcast\n      9: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rackspace-cookbooks_phpstack-recipes-application_php.rb", "content": "# openssl devel packages are required for the mongo pecl module, issue #299", "line": 23, "detection_span": [18, 28], "with_context": "\n# limitations under the License.\n#\n\nstackname = 'phpstack'\n\n23: # openssl devel packages are required for the mongo pecl module, issue #299\n# plugin depends\nif platform_family?('rhel')\ninclude_recipe 'yum'\ninclude_recipe 'yum-epel'\ninclude_recipe 'yum-ius'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_phpstack-recipes-application_php.rb\n# Target line: 23\n\n     18: # limitations under the License.\n     19: #\n     20: \n     21: stackname = 'phpstack'\n     22: \n>>>  23: # openssl devel packages are required for the mongo pecl module, issue #299\n     24: # plugin depends\n     25: if platform_family?('rhel')\n     26:   include_recipe 'yum'\n     27:   include_recipe 'yum-epel'\n     28:   include_recipe 'yum-ius'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-openstack-common-libraries-cli.rb", "content": "# TODO: update openstack-identity register provider to use these functions.", "line": 109, "detection_span": [104, 114], "with_context": "\n104:   # @param [Hash] environment to use.\n105:   # @param [Hash] optional command argument/values pairs\n106:   # @param [String] optional uuid field to match\n107:   # @return [String] uuid or nil\n108:   #\n109:   # TODO: update openstack-identity register provider to use these functions.\n110:   #\n111:   def identity_uuid(*args)\nget_uuid('openstack', *args)\n113:   end\n114:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-common-libraries-cli.rb\n# Target line: 109\n\n    104:   # @param [Hash] environment to use.\n    105:   # @param [Hash] optional command argument/values pairs\n    106:   # @param [String] optional uuid field to match\n    107:   # @return [String] uuid or nil\n    108:   #\n>>> 109:   # TODO: update openstack-identity register provider to use these functions.\n    110:   #\n    111:   def identity_uuid(*args)\n    112:     get_uuid('openstack', *args)\n    113:   end\n    114: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb", "content": "# stub resolver. According to upstream this should replace the glibc \"dns\"", "line": 34, "detection_span": [29, 39], "with_context": "\n)\nnotifies :restart, 'service[systemd-resolved]'\nend\n\n# nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n34: # stub resolver. According to upstream this should replace the glibc \"dns\"\n# resolver and is required for systemd-resolved to work. This block attempts\n# to place the resolver between mymachines and myhostname as recommended by\n# upstream.\nruby_block 'enable nss-resolve' do\nonly_if { node['fb_systemd']['resolved']['enable'] }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb\n# Target line: 34\n\n     29:   )\n     30:   notifies :restart, 'service[systemd-resolved]'\n     31: end\n     32: \n     33: # nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n>>>  34: # stub resolver. According to upstream this should replace the glibc \"dns\"\n     35: # resolver and is required for systemd-resolved to work. This block attempts\n     36: # to place the resolver between mymachines and myhostname as recommended by\n     37: # upstream.\n     38: ruby_block 'enable nss-resolve' do\n     39:   only_if { node['fb_systemd']['resolved']['enable'] }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb", "content": "# - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as", "line": 84, "detection_span": [79, 89], "with_context": "\nexecute 'install rally in virtualenv' do\nenvironment env\nretries 3\nuser 'rally'\n# Installation notes:\n84:   # - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n#     part of `pycryptodome` etc.\n# - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n# - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n#     templates containing macros. This change breaks rally tasks used\n#     internally by Bloomberg, which likely need to be fixed.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb\n# Target line: 84\n\n     79: execute 'install rally in virtualenv' do\n     80:   environment env\n     81:   retries 3\n     82:   user 'rally'\n     83:   # Installation notes:\n>>>  84:   # - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n     85:   #     part of `pycryptodome` etc.\n     86:   # - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n     87:   # - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n     88:   #     templates containing macros. This change breaks rally tasks used\n     89:   #     internally by Bloomberg, which likely need to be fixed.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb", "content": "# @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise", "line": 19, "detection_span": [14, 24], "with_context": "\n# Determines if a tag matches a given wildcard expression or prefix.\n#\n# @param [String] wildcard expression or prefix\n# @param [String] tag\n#\n19:       # @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise\ndef self.matches_tag_wildcard?(wildcard, tag)\nif wildcard =~ /^(#{NAMESPACE_REGEX}):$/\nwildcard = \"#{$1}:*\"\nelsif wildcard =~ /^(#{NAMESPACE_REGEX}):(#{PREDICATE_REGEX})=?$/\nwildcard = \"#{$1}:#{$2}=*\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb\n# Target line: 19\n\n     14:       # Determines if a tag matches a given wildcard expression or prefix.\n     15:       #\n     16:       # @param [String] wildcard expression or prefix\n     17:       # @param [String] tag\n     18:       #\n>>>  19:       # @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise\n     20:       def self.matches_tag_wildcard?(wildcard, tag)\n     21:         if wildcard =~ /^(#{NAMESPACE_REGEX}):$/\n     22:           wildcard = \"#{$1}:*\"\n     23:         elsif wildcard =~ /^(#{NAMESPACE_REGEX}):(#{PREDICATE_REGEX})=?$/\n     24:           wildcard = \"#{$1}:#{$2}=*\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cdapio_hadoop_cookbook-recipes-spark2.rb", "content": "# TODO: /etc/spark2/conf.dist/fairscheduler.xml.template", "line": 60, "detection_span": [55, 65], "with_context": "\nmode '0755'\nrecursive true\naction :create\nend\n\n60: # TODO: /etc/spark2/conf.dist/fairscheduler.xml.template\n\nspark2_log_dir =\nif node['spark2'].key?('spark_env') && node['spark2']['spark_env'].key?('spark_log_dir')\nnode['spark2']['spark_env']['spark_log_dir']\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cdapio_hadoop_cookbook-recipes-spark2.rb\n# Target line: 60\n\n     55:   mode '0755'\n     56:   recursive true\n     57:   action :create\n     58: end\n     59: \n>>>  60: # TODO: /etc/spark2/conf.dist/fairscheduler.xml.template\n     61: \n     62: spark2_log_dir =\n     63:   if node['spark2'].key?('spark_env') && node['spark2']['spark_env'].key?('spark_log_dir')\n     64:     node['spark2']['spark_env']['spark_log_dir']\n     65:   else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb", "content": "# postdrop group and adds postfix user to it.", "line": 52, "detection_span": [47, 57], "with_context": "\nwhen 'omnios'\nmanifest_path = ::File.join(Chef::Config[:file_cache_path], 'manifest-postfix.xml')\n\n# we need to manage the postfix group and user\n# and then subscribe to the package install because it creates a\n52:   # postdrop group and adds postfix user to it.\ngroup 'postfix' do\nappend true\nend\n\nuser 'postfix' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb\n# Target line: 52\n\n     47: when 'omnios'\n     48:   manifest_path = ::File.join(Chef::Config[:file_cache_path], 'manifest-postfix.xml')\n     49: \n     50:   # we need to manage the postfix group and user\n     51:   # and then subscribe to the package install because it creates a\n>>>  52:   # postdrop group and adds postfix user to it.\n     53:   group 'postfix' do\n     54:     append true\n     55:   end\n     56: \n     57:   user 'postfix' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-accounts.rb", "content": "# TODO: we might want to create groups only implictly defined", "line": 39, "detection_span": [34, 44], "with_context": "\nnode['chef_packages']['chef']['chef_root'] ==\n'/usr/lib/ruby/vendor_ruby'\nend\nend\n\n39:   # TODO: we might want to create groups only implictly defined\n#       from accounts...gid attributes but described in a databag\nbag = data_bag('localgroups') unless Chef::Config[:solo]\nnode['sys']['groups'].each do |name, grp|\nunless Chef::Config[:solo]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-accounts.rb\n# Target line: 39\n\n     34:       node['chef_packages']['chef']['chef_root'] ==\n     35:         '/usr/lib/ruby/vendor_ruby'\n     36:     end\n     37:   end\n     38: \n>>>  39:   # TODO: we might want to create groups only implictly defined\n     40:   #       from accounts...gid attributes but described in a databag\n     41:   bag = data_bag('localgroups') unless Chef::Config[:solo]\n     42:   node['sys']['groups'].each do |name, grp|\n     43:     unless Chef::Config[:solo]\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_swift-recipes-rsync.rb", "content": "# FIXME: chicken and egg", "line": 49, "detection_span": [44, 54], "with_context": "\nsource \"rsync.init\"\naction :create\nonly_if { platform?(%w{centos redhat scientific}) }\nend\n\n49: # FIXME: chicken and egg\ncase node[\"platform\"]\nwhen \"centos\",\"redhat\",\"fedora\"\n# enable rsyncd\nrsync_servicename = \"rsyncd\"\nservice \"rsyncd\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-recipes-rsync.rb\n# Target line: 49\n\n     44:   source \"rsync.init\"\n     45:   action :create\n     46:   only_if { platform?(%w{centos redhat scientific}) }\n     47: end\n     48: \n>>>  49: # FIXME: chicken and egg\n     50: case node[\"platform\"]\n     51: when \"centos\",\"redhat\",\"fedora\"\n     52:   # enable rsyncd\n     53:   rsync_servicename = \"rsyncd\"\n     54:   service \"rsyncd\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dedeepyaboyapati_chef-cookbooks-cookbooks-fb_swap-recipes-default.rb", "content": "# TODO(yangxia): Fix this (t20145202).", "line": 27, "detection_span": [22, 32], "with_context": "\nChef::Log.debug(\"fb_swap: Found swap device: #{base_swap_device}\")\n\nfstab_swap_uuid = FB::FbSwap.get_swap_uuid_from_fstab(node)\n\nif fstab_swap_uuid.nil? && node['fb_swap']['enable_encryption']\n27:   # TODO(yangxia): Fix this (t20145202).\nChef::Log.warn(\n'fb_swap: Encryption cannot be enabled for machines where /etc/fstab ' +\n'does not specify the UUID of the swap device. Proceeding without ' +\n'encrypting swap.',\n)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dedeepyaboyapati_chef-cookbooks-cookbooks-fb_swap-recipes-default.rb\n# Target line: 27\n\n     22: Chef::Log.debug(\"fb_swap: Found swap device: #{base_swap_device}\")\n     23: \n     24: fstab_swap_uuid = FB::FbSwap.get_swap_uuid_from_fstab(node)\n     25: \n     26: if fstab_swap_uuid.nil? && node['fb_swap']['enable_encryption']\n>>>  27:   # TODO(yangxia): Fix this (t20145202).\n     28:   Chef::Log.warn(\n     29:     'fb_swap: Encryption cannot be enabled for machines where /etc/fstab ' +\n     30:     'does not specify the UUID of the swap device. Proceeding without ' +\n     31:     'encrypting swap.',\n     32:   )\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_omnibus-recipes-_libffi.rb", "content": "# be required. https://github.com/ffi/ffi/pull/424#issuecomment-83935000", "line": 24, "detection_span": [19, 29], "with_context": "\n\n# We need libffi 3.2.1 on ppc64/ppc64le systems in order\n# for ruby ffi gem to get installed. Someday when ruby ffi\n# updates embedded libffi 3.2.1 and fixes its extension\n# build process to consume embedded libffi properly this wont\n24: # be required. https://github.com/ffi/ffi/pull/424#issuecomment-83935000\n\n# Include the common recipe\ninclude_recipe 'omnibus::_common'\n\nreturn unless ppc64? || ppc64le?", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_omnibus-recipes-_libffi.rb\n# Target line: 24\n\n     19: \n     20: # We need libffi 3.2.1 on ppc64/ppc64le systems in order\n     21: # for ruby ffi gem to get installed. Someday when ruby ffi\n     22: # updates embedded libffi 3.2.1 and fixes its extension\n     23: # build process to consume embedded libffi properly this wont\n>>>  24: # be required. https://github.com/ffi/ffi/pull/424#issuecomment-83935000\n     25: \n     26: # Include the common recipe\n     27: include_recipe 'omnibus::_common'\n     28: \n     29: return unless ppc64? || ppc64le?\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-nfs-cookbooks-elasticsearch-recipes-server.rb", "content": "## FIXME: Cannot use this syntax currently, see http://tickets.opscode.com/browse/CHEF-1994", "line": 58, "detection_span": [53, 63], "with_context": "\nrun_restart   false   # don't automatically start or restart daemons\nrun_state     node[:elasticsearch][:server][:run_state]\noptions       node[:elasticsearch]\nend\n\n58: ## FIXME: Cannot use this syntax currently, see http://tickets.opscode.com/browse/CHEF-1994\n# service \"elasticsearch\" do\n#   subscribes    \"template[/etc/elasticsearch/elasticsearch.yml]\"\n# end\n\n# TODO: split httpnode and datanode into separate components", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-nfs-cookbooks-elasticsearch-recipes-server.rb\n# Target line: 58\n\n     53:   run_restart   false   # don't automatically start or restart daemons\n     54:   run_state     node[:elasticsearch][:server][:run_state]\n     55:   options       node[:elasticsearch]\n     56: end\n     57: \n>>>  58: ## FIXME: Cannot use this syntax currently, see http://tickets.opscode.com/browse/CHEF-1994\n     59: # service \"elasticsearch\" do\n     60: #   subscribes    \"template[/etc/elasticsearch/elasticsearch.yml]\"\n     61: # end\n     62: \n     63: # TODO: split httpnode and datanode into separate components\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb", "content": "default[:elasticsearch][:java_heap_newgen]        = nil  # JVM MaxNewSize (expert-level) a NUMBER -- will be suffixed with 'm'", "line": 63, "detection_span": [58, 68], "with_context": "\n# Tunables\n#\n\ndefault[:elasticsearch][:java_home]               = \"/usr/lib/jvm/java-6-sun/jre\"     # sun java works way better for ES\ndefault[:elasticsearch][:java_heap_size_max]      = 1000 # a NUMBER -- will be suffixed with 'm'\n63: default[:elasticsearch][:java_heap_newgen]        = nil  # JVM MaxNewSize (expert-level) a NUMBER -- will be suffixed with 'm'\ndefault[:elasticsearch][:ulimit_mlock]            = nil  # locked memory limit -- set to unlimited to lock heap into memory on linux machines\n\ndefault[:elasticsearch][:default_replicas]        = 1    # replicas are in addition to the original, so 1 replica means 2 copies of each shard\ndefault[:elasticsearch][:default_shards]          = 12   # 12 shards per index * 2 replicas distributes evenly across 2, 3, 4, 6, 8, 12 or 24 nodes\ndefault[:elasticsearch][:flush_threshold_ops]     = 5000", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb\n# Target line: 63\n\n     58: # Tunables\n     59: #\n     60: \n     61: default[:elasticsearch][:java_home]               = \"/usr/lib/jvm/java-6-sun/jre\"     # sun java works way better for ES\n     62: default[:elasticsearch][:java_heap_size_max]      = 1000 # a NUMBER -- will be suffixed with 'm'\n>>>  63: default[:elasticsearch][:java_heap_newgen]        = nil  # JVM MaxNewSize (expert-level) a NUMBER -- will be suffixed with 'm'\n     64: default[:elasticsearch][:ulimit_mlock]            = nil  # locked memory limit -- set to unlimited to lock heap into memory on linux machines\n     65: \n     66: default[:elasticsearch][:default_replicas]        = 1    # replicas are in addition to the original, so 1 replica means 2 copies of each shard\n     67: default[:elasticsearch][:default_shards]          = 12   # 12 shards per index * 2 replicas distributes evenly across 2, 3, 4, 6, 8, 12 or 24 nodes\n     68: default[:elasticsearch][:flush_threshold_ops]     = 5000\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_delivery-truck-recipes-provision.rb", "content": "# TODO: This is a temporary workaround; ultimately, this should be", "line": 18, "detection_span": [13, 23], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n18: # TODO: This is a temporary workaround; ultimately, this should be\n# handled either by delivery_build or (preferably) the server itself.\nruby_block 'copy env from prior to current' do\nblock do\nwith_server_config do\nstage_name = node['delivery']['change']['stage']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_delivery-truck-recipes-provision.rb\n# Target line: 18\n\n     13: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     14: # See the License for the specific language governing permissions and\n     15: # limitations under the License.\n     16: #\n     17: \n>>>  18: # TODO: This is a temporary workaround; ultimately, this should be\n     19: # handled either by delivery_build or (preferably) the server itself.\n     20: ruby_block 'copy env from prior to current' do\n     21:   block do\n     22:     with_server_config do\n     23:       stage_name = node['delivery']['change']['stage']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb", "content": "# default['cloudify']['properties']['debug_mode'] = true", "line": 41, "detection_span": [36, 46], "with_context": "\n#\n# Additional ssh key that should be added to deployment service user\n# default['cloudify']['properties']['ssh_key'] = ''\n#\n# Install service in debug mode\n41: # default['cloudify']['properties']['debug_mode'] = true\n#\n# Source tarball for service files\n# default['cloudify']['properties']['sources'] =\n#   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb\n# Target line: 41\n\n     36: #\n     37: # Additional ssh key that should be added to deployment service user\n     38: # default['cloudify']['properties']['ssh_key'] = ''\n     39: #\n     40: # Install service in debug mode\n>>>  41: # default['cloudify']['properties']['debug_mode'] = true\n     42: #\n     43: # Source tarball for service files\n     44: # default['cloudify']['properties']['sources'] =\n     45: #   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'\n     46: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Nikhil424_chef-repo-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-resource.rb", "content": "# if !Chef::ResourceResolver.includes_handler?(name, self)", "line": 141, "detection_span": [136, 146], "with_context": "\nif name\nname = name.to_sym\n# If our class is not already providing this name, provide it.\n# Commented out: use of resource_name and provides will need to be\n# mutually exclusive in this world, generally.\n141:             # if !Chef::ResourceResolver.includes_handler?(name, self)\nprovides name#, canonical: true\n# end\n@resource_name = name\nelse\n@resource_name = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-resource.rb\n# Target line: 141\n\n    136:           if name\n    137:             name = name.to_sym\n    138:             # If our class is not already providing this name, provide it.\n    139:             # Commented out: use of resource_name and provides will need to be\n    140:             # mutually exclusive in this world, generally.\n>>> 141:             # if !Chef::ResourceResolver.includes_handler?(name, self)\n    142:               provides name#, canonical: true\n    143:             # end\n    144:             @resource_name = name\n    145:           else\n    146:             @resource_name = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_nova-recipes-nova-volume-multipath-patches.rb", "content": "# lp: https://bugs.launchpad.net/nova/+bug/1180497", "line": 32, "detection_span": [27, 37], "with_context": "\ngroup \"root\"\nmode \"0644\"\nnotifies :restart, \"service[nova-compute]\", :delayed\nend\n\n32: # lp: https://bugs.launchpad.net/nova/+bug/1180497\n# FC attach code doesn't discover multipath service\ntemplate \"/usr/share/pyshared/nova/storage/linuxscsi.py\" do\nsource \"patches/linuxscsi.py.multipath_missing_device_name.4933c15575589ea5877694b6fd874c9893f54d75.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-volume-multipath-patches.rb\n# Target line: 32\n\n     27:   group \"root\"\n     28:   mode \"0644\"\n     29:   notifies :restart, \"service[nova-compute]\", :delayed\n     30: end\n     31: \n>>>  32: # lp: https://bugs.launchpad.net/nova/+bug/1180497\n     33: # FC attach code doesn't discover multipath service\n     34: template \"/usr/share/pyshared/nova/storage/linuxscsi.py\" do\n     35:   source \"patches/linuxscsi.py.multipath_missing_device_name.4933c15575589ea5877694b6fd874c9893f54d75.erb\"\n     36:   owner \"root\"\n     37:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb", "content": "#     part of `pycryptodome` etc.", "line": 85, "detection_span": [80, 90], "with_context": "\nenvironment env\nretries 3\nuser 'rally'\n# Installation notes:\n# - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n85:   #     part of `pycryptodome` etc.\n# - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n# - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n#     templates containing macros. This change breaks rally tasks used\n#     internally by Bloomberg, which likely need to be fixed.\ncommand <<-EOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb\n# Target line: 85\n\n     80:   environment env\n     81:   retries 3\n     82:   user 'rally'\n     83:   # Installation notes:\n     84:   # - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n>>>  85:   #     part of `pycryptodome` etc.\n     86:   # - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n     87:   # - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n     88:   #     templates containing macros. This change breaks rally tasks used\n     89:   #     internally by Bloomberg, which likely need to be fixed.\n     90:   command <<-EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-dds.rb", "content": "# Ugly fix for npm stupidity (https://github.com/npm/npm/issues/20191)", "line": 50, "detection_span": [45, 55], "with_context": "\nlink '/usr/bin/node' do\nto '/usr/bin/nodejs'\nnot_if { ::File.file?('/usr/bin/node') }\nend\n\n50: # Ugly fix for npm stupidity (https://github.com/npm/npm/issues/20191)\nexecute 'Disable strict ssl checking in npm' do\ncommand 'npm config set strict-ssl false'\nend\n\n# Install dice deployment service files", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-dds.rb\n# Target line: 50\n\n     45: link '/usr/bin/node' do\n     46:   to '/usr/bin/nodejs'\n     47:   not_if { ::File.file?('/usr/bin/node') }\n     48: end\n     49: \n>>>  50: # Ugly fix for npm stupidity (https://github.com/npm/npm/issues/20191)\n     51: execute 'Disable strict ssl checking in npm' do\n     52:   command 'npm config set strict-ssl false'\n     53: end\n     54: \n     55: # Install dice deployment service files\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-archive-files-halite_gem-poise_archive-archive_providers-base.rb", "content": "# TODO handle cookbook:// for cookbook_file \"downloads\".", "line": 83, "detection_span": [78, 88], "with_context": "\n# @return [Chef::Resource]\ndef download_file\n# resource_state used for closure breaking on the notifying block.\nresource_state = []\nnotifying_block do\n83:           # TODO handle cookbook:// for cookbook_file \"downloads\".\nresource_state << remote_file(new_resource.absolute_path) do\nsource new_resource.path\nretries 5 # As a default, could be overridden by source_properties.\nnew_resource.merged_source_properties.each do |key, value|\nsend(key, value)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-archive-files-halite_gem-poise_archive-archive_providers-base.rb\n# Target line: 83\n\n     78:       # @return [Chef::Resource]\n     79:       def download_file\n     80:         # resource_state used for closure breaking on the notifying block.\n     81:         resource_state = []\n     82:         notifying_block do\n>>>  83:           # TODO handle cookbook:// for cookbook_file \"downloads\".\n     84:           resource_state << remote_file(new_resource.absolute_path) do\n     85:             source new_resource.path\n     86:             retries 5 # As a default, could be overridden by source_properties.\n     87:             new_resource.merged_source_properties.each do |key, value|\n     88:               send(key, value)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-ingestion-ng-recipes-default.rb", "content": "# FIXME brittle and inelegant check for web.db", "line": 122, "detection_span": [117, 127], "with_context": "\nend\nexecute \"setup-web-db\" do\nuser node[:ingestion_ng][:user]\ngroup node[:ingestion_ng][:group]\ncwd \"#{node[:ingestion_ng][:deploy_path]}/current/#{node[:ingestion_ng][:apps]}\"\n122:           # FIXME brittle and inelegant check for web.db\ncommand <<-EOH\n. #{venv_activate}\nexport INGESTION_PROJECT_ROOT=#{ingestion_root} && export CELERY_CONFIG=#{celery_config}\n[ -s #{node[:ingestion_ng][:var]}/web.db ] || init_web_db\nEOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-ingestion-ng-recipes-default.rb\n# Target line: 122\n\n    117:         end\n    118:         execute \"setup-web-db\" do\n    119:           user node[:ingestion_ng][:user]\n    120:           group node[:ingestion_ng][:group]\n    121:           cwd \"#{node[:ingestion_ng][:deploy_path]}/current/#{node[:ingestion_ng][:apps]}\"\n>>> 122:           # FIXME brittle and inelegant check for web.db\n    123:           command <<-EOH\n    124:           . #{venv_activate}\n    125:           export INGESTION_PROJECT_ROOT=#{ingestion_root} && export CELERY_CONFIG=#{celery_config}\n    126:           [ -s #{node[:ingestion_ng][:var]}/web.db ] || init_web_db\n    127:           EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danielladd_Chef-Testing-cookbooks-php-recipes-package.rb", "content": "# http://pear.php.net/bugs/bug.php?id=16644", "line": 39, "detection_span": [34, 44], "with_context": "\nADDLOCAL=#{node['php']['packages'].join(',')}\n].join(' ')\nend\n\n# WARNING: This is not the out-of-the-box go-pear.phar. It's been modified to patch this bug:\n39:   # http://pear.php.net/bugs/bug.php?id=16644\ncookbook_file \"#{node['php']['conf_dir']}/PEAR/go-pear.phar\" do\nsource 'go-pear.phar'\nend\n\ntemplate \"#{node['php']['conf_dir']}/pear-options\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-php-recipes-package.rb\n# Target line: 39\n\n     34:           ADDLOCAL=#{node['php']['packages'].join(',')}\n     35:     ].join(' ')\n     36:   end\n     37: \n     38:   # WARNING: This is not the out-of-the-box go-pear.phar. It's been modified to patch this bug:\n>>>  39:   # http://pear.php.net/bugs/bug.php?id=16644\n     40:   cookbook_file \"#{node['php']['conf_dir']}/PEAR/go-pear.phar\" do\n     41:     source 'go-pear.phar'\n     42:   end\n     43: \n     44:   template \"#{node['php']['conf_dir']}/pear-options\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "xdv-staging_chef-os-hardening-recipes-sysctl.rb", "content": "# TODO: This is deprecated. Remove after sysctl >= 0.6.0", "line": 94, "detection_span": [89, 99], "with_context": "\nend\nend\nend\n\n# Conditional handling of procps reload\n94: # TODO: This is deprecated. Remove after sysctl >= 0.6.0\n# ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\nif cookbook_version('sysctl', '< 0.6.0') # ~FC023\ncase node['platform_family']\nwhen 'debian'\nservice_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: xdv-staging_chef-os-hardening-recipes-sysctl.rb\n# Target line: 94\n\n     89:     end\n     90:   end\n     91: end\n     92: \n     93: # Conditional handling of procps reload\n>>>  94: # TODO: This is deprecated. Remove after sysctl >= 0.6.0\n     95: # ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\n     96: if cookbook_version('sysctl', '< 0.6.0') # ~FC023\n     97:   case node['platform_family']\n     98:   when 'debian'\n     99:     service_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-default.rb", "content": "# debugging process crashes", "line": 32, "detection_span": [27, 37], "with_context": "\n\n###############################################################################\n# misc settings\n###############################################################################\n\n32: # debugging process crashes\ndefault['bcpc']['apport']['enabled'] = true\n\n# enable/disable trusted platform module\ndefault['bcpc']['tpm']['enabled'] = true\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-default.rb\n# Target line: 32\n\n     27: \n     28: ###############################################################################\n     29: # misc settings\n     30: ###############################################################################\n     31: \n>>>  32: # debugging process crashes\n     33: default['bcpc']['apport']['enabled'] = true\n     34: \n     35: # enable/disable trusted platform module\n     36: default['bcpc']['tpm']['enabled'] = true\n     37: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['rpmverbosity'] = nil # %w{ info critical# emergency error warn debug }", "line": 88, "detection_span": [83, 93], "with_context": "\ndefault['yum']['main']['password'] = nil #  /.*/\ndefault['yum']['main']['recent'] = nil # /^\\d+$/\ndefault['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['reposdir'] = nil #  /.*/\ndefault['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]\n88: default['yum']['main']['rpmverbosity'] = nil # %w{ info critical# emergency error warn debug }\ndefault['yum']['main']['showdupesfromrepos'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['skip_broken'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['ssl_check_cert_permissions'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['sslcacert'] = nil # /.*/\ndefault['yum']['main']['sslclientcert'] = nil # /.*/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb\n# Target line: 88\n\n     83: default['yum']['main']['password'] = nil #  /.*/\n     84: default['yum']['main']['recent'] = nil # /^\\d+$/\n     85: default['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\n     86: default['yum']['main']['reposdir'] = nil #  /.*/\n     87: default['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]\n>>>  88: default['yum']['main']['rpmverbosity'] = nil # %w{ info critical# emergency error warn debug }\n     89: default['yum']['main']['showdupesfromrepos'] = nil # [TrueClass, FalseClass]\n     90: default['yum']['main']['skip_broken'] = nil # [TrueClass, FalseClass]\n     91: default['yum']['main']['ssl_check_cert_permissions'] = nil # [TrueClass, FalseClass]\n     92: default['yum']['main']['sslcacert'] = nil # /.*/\n     93: default['yum']['main']['sslclientcert'] = nil # /.*/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dedeepyaboyapati_chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb", "content": "# nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching", "line": 27, "detection_span": [22, 32], "with_context": "\n:section => 'Resolve',\n)\nnotifies :restart, 'service[systemd-resolved]'\nend\n\n27: # nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n# stub resolver. According to upstream this should replace the glibc \"dns\"\n# resolver and is required for systemd-resolved to work. This block attempts\n# to place the resolver between mymachines and myhostname as recommended by\n# upstream.\nruby_block 'enable nss-resolve' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dedeepyaboyapati_chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb\n# Target line: 27\n\n     22:     :section => 'Resolve',\n     23:   )\n     24:   notifies :restart, 'service[systemd-resolved]'\n     25: end\n     26: \n>>>  27: # nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n     28: # stub resolver. According to upstream this should replace the glibc \"dns\"\n     29: # resolver and is required for systemd-resolved to work. This block attempts\n     30: # to place the resolver between mymachines and myhostname as recommended by\n     31: # upstream.\n     32: ruby_block 'enable nss-resolve' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-resources-release.rb", "content": "# Directory for the unreleased contents,   eg /usr/local/share/pig-0.8.0. default: {prefix_root}/share/{name}-#{version}", "line": 53, "detection_span": [48, 58], "with_context": "\nattribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n\n# version slug, appended to the name to get the install_dir\nattribute :version,       :kind_of => String, :required => true\n\n53: # Directory for the unreleased contents,   eg /usr/local/share/pig-0.8.0. default: {prefix_root}/share/{name}-#{version}\nattribute :install_dir,   :kind_of => String\n\n# Directory as the project is referred to, eg /usr/local/share/pig. default: {prefix_root}/share/{name}\nattribute :home_dir,      :kind_of => String\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-resources-release.rb\n# Target line: 53\n\n     48: attribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n     49: \n     50: # version slug, appended to the name to get the install_dir\n     51: attribute :version,       :kind_of => String, :required => true\n     52: \n>>>  53: # Directory for the unreleased contents,   eg /usr/local/share/pig-0.8.0. default: {prefix_root}/share/{name}-#{version}\n     54: attribute :install_dir,   :kind_of => String\n     55: \n     56: # Directory as the project is referred to, eg /usr/local/share/pig. default: {prefix_root}/share/{name}\n     57: attribute :home_dir,      :kind_of => String\n     58: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_omnibus-recipes-_git.rb", "content": "# ca bundle that ships in the package. This can most likely be fixed by", "line": 58, "detection_span": [53, 63], "with_context": "\n\n# Provided by the omnibus-toolchain package\nunless windows?\n\n# We need to configure the omnibus-toolchain's embedded git to use\n58:   # ca bundle that ships in the package. This can most likely be fixed by\n# a well placed `./configure` option when compiling git.\n#\nexecute \"/opt/#{node['omnibus']['toolchain_name']}/bin/git config --global http.sslCAinfo /opt/#{node['omnibus']['toolchain_name']}/embedded/ssl/certs/cacert.pem\" do\nenvironment(\n'HOME' => build_user_home", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_omnibus-recipes-_git.rb\n# Target line: 58\n\n     53: \n     54: # Provided by the omnibus-toolchain package\n     55: unless windows?\n     56: \n     57:   # We need to configure the omnibus-toolchain's embedded git to use\n>>>  58:   # ca bundle that ships in the package. This can most likely be fixed by\n     59:   # a well placed `./configure` option when compiling git.\n     60:   #\n     61:   execute \"/opt/#{node['omnibus']['toolchain_name']}/bin/git config --global http.sslCAinfo /opt/#{node['omnibus']['toolchain_name']}/embedded/ssl/certs/cacert.pem\" do\n     62:     environment(\n     63:       'HOME' => build_user_home\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sabarisankar27_chef-acceptance-top-cookbooks-.acceptance-acceptance-cookbook-libraries-cookbook_kitchen.rb", "content": "# TODO Grab the source URL from supermarket", "line": 34, "detection_span": [29, 39], "with_context": "\ndirectory ::File.expand_path(\"..\", repository_root) do\nrecursive true\nend\n\n# Grab the cookbook\n34:     # TODO Grab the source URL from supermarket\n# TODO get git to include its kitchen tests in the cookbook.\ngit repository_root do\nrepository new_resource.repository\nbranch new_resource.branch\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sabarisankar27_chef-acceptance-top-cookbooks-.acceptance-acceptance-cookbook-libraries-cookbook_kitchen.rb\n# Target line: 34\n\n     29:     directory ::File.expand_path(\"..\", repository_root) do\n     30:       recursive true\n     31:     end\n     32: \n     33:     # Grab the cookbook\n>>>  34:     # TODO Grab the source URL from supermarket\n     35:     # TODO get git to include its kitchen tests in the cookbook.\n     36:     git repository_root do\n     37:       repository new_resource.repository\n     38:       branch new_resource.branch\n     39:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sous-chefs_postfix-recipes-default.rb", "content": "# Cookbook:: postfix", "line": 2, "detection_span": [1, 7], "with_context": "\n# Author:: Joshua Timberman(<joshua@chef.io>)\n2: # Cookbook:: postfix\n# Recipe:: default\n#\n# Copyright:: 2009-2019, Chef Software, Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sous-chefs_postfix-recipes-default.rb\n# Target line: 2\n\n      1: # Author:: Joshua Timberman(<joshua@chef.io>)\n>>>   2: # Cookbook:: postfix\n      3: # Recipe:: default\n      4: #\n      5: # Copyright:: 2009-2019, Chef Software, Inc.\n      6: #\n      7: # Licensed under the Apache License, Version 2.0 (the \"License\");\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "eaton_vagrant-chef-dlamp-cookbooks-drupal-cookbooks-drupal-recipes-example.rb", "content": "# TODO: Break this out into a vagrant only cookbook? (name: \"drupal-vagrant\")", "line": 16, "detection_span": [11, 21], "with_context": "\n\"GRANT ALL PRIVILEGES ON *.* TO 'myadmin'@'%' IDENTIFIED BY 'myadmin' WITH GRANT OPTION;\\\" \" +\n\"mysql\"\naction :run\nend\n\n16: # TODO: Break this out into a vagrant only cookbook? (name: \"drupal-vagrant\")\n# create a drupal db\nexecute \"add-drupal-db\" do\ncommand \"/usr/bin/mysql -u root -p#{node[:mysql][:server_root_password]} -e \\\"\" +\n\"CREATE DATABASE drupal;\\\"\"\naction :run", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: eaton_vagrant-chef-dlamp-cookbooks-drupal-cookbooks-drupal-recipes-example.rb\n# Target line: 16\n\n     11:       \"GRANT ALL PRIVILEGES ON *.* TO 'myadmin'@'%' IDENTIFIED BY 'myadmin' WITH GRANT OPTION;\\\" \" +\n     12:       \"mysql\"\n     13:   action :run\n     14: end\n     15: \n>>>  16: # TODO: Break this out into a vagrant only cookbook? (name: \"drupal-vagrant\")\n     17: # create a drupal db\n     18: execute \"add-drupal-db\" do\n     19:   command \"/usr/bin/mysql -u root -p#{node[:mysql][:server_root_password]} -e \\\"\" +\n     20:       \"CREATE DATABASE drupal;\\\"\"\n     21:   action :run\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-cookbooks_chef-ingredient-resources-automatev2.rb", "content": "## TODO: add dependancy on sysctl cookbook unless chef-client v14.0+", "line": 35, "detection_span": [30, 40], "with_context": "\ncwd '/usr/local/bin'\ncreates '/usr/local/bin/chef-automate'\nnot_if { FileTest.file?('/usr/bin/chef-automate') }\nend\n\n35:   ## TODO: add dependancy on sysctl cookbook unless chef-client v14.0+\nsysctl 'vm.max_map_count' do\nvalue 262144\nend\n\nsysctl 'vm.dirty_expire_centisecs' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_chef-ingredient-resources-automatev2.rb\n# Target line: 35\n\n     30:     cwd '/usr/local/bin'\n     31:     creates '/usr/local/bin/chef-automate'\n     32:     not_if { FileTest.file?('/usr/bin/chef-automate') }\n     33:   end\n     34: \n>>>  35:   ## TODO: add dependancy on sysctl cookbook unless chef-client v14.0+\n     36:   sysctl 'vm.max_map_count' do\n     37:     value 262144\n     38:   end\n     39: \n     40:   sysctl 'vm.dirty_expire_centisecs' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "xdv-staging_chef-os-hardening-recipes-sysctl.rb", "content": "# ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151", "line": 95, "detection_span": [90, 100], "with_context": "\nend\nend\n\n# Conditional handling of procps reload\n# TODO: This is deprecated. Remove after sysctl >= 0.6.0\n95: # ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\nif cookbook_version('sysctl', '< 0.6.0') # ~FC023\ncase node['platform_family']\nwhen 'debian'\nservice_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil\nservice 'procps' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: xdv-staging_chef-os-hardening-recipes-sysctl.rb\n# Target line: 95\n\n     90:   end\n     91: end\n     92: \n     93: # Conditional handling of procps reload\n     94: # TODO: This is deprecated. Remove after sysctl >= 0.6.0\n>>>  95: # ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\n     96: if cookbook_version('sysctl', '< 0.6.0') # ~FC023\n     97:   case node['platform_family']\n     98:   when 'debian'\n     99:     service_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil\n    100:     service 'procps' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_windows.rb", "content": "# TODO: make install location configurable", "line": 16, "detection_span": [11, 21], "with_context": "\n# and on OS X did 'shasum -a 256 newrelic-infra.msi' YMMV on other\n# platforms. It'd be *really* cool if NewRelic could provide an API\n# that you could ask for checksum values, or have checksums published\n# and available in some other way.\n#\n16: # TODO: make install location configurable\n\nwindows_package 'newrelic-infra' do\naction :install\nchecksum node['newrelic-infra']['windows_checksum']\ninstaller_type :msi", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_windows.rb\n# Target line: 16\n\n     11: # and on OS X did 'shasum -a 256 newrelic-infra.msi' YMMV on other\n     12: # platforms. It'd be *really* cool if NewRelic could provide an API\n     13: # that you could ask for checksum values, or have checksums published\n     14: # and available in some other way.\n     15: #\n>>>  16: # TODO: make install location configurable\n     17: \n     18: windows_package 'newrelic-infra' do\n     19:   action :install\n     20:   checksum node['newrelic-infra']['windows_checksum']\n     21:   installer_type :msi\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fzylogic_nova-recipes-nova-common.rb", "content": "# TODO: need to re-evaluate this for accuracy", "line": 69, "detection_span": [64, 74], "with_context": "\nChef::Log.debug(\"nova::nova-common:novnc_proxy_endpoint|#{novnc_proxy_endpoint}\")\nChef::Log.debug(\"nova::nova-common:glance_endpoint|#{glance_endpoint}\")\nChef::Log.debug(\"nova::nova-common:nova_api_endpoint|#{nova_api_endpoint}\")\nChef::Log.debug(\"nova::nova-common:ec2_public_endpoint|#{ec2_public_endpoint}\")\n\n69: # TODO: need to re-evaluate this for accuracy\ntemplate \"/etc/nova/nova.conf\" do\nsource \"nova.conf.erb\"\nowner \"root\"\ngroup \"root\"\nmode \"0644\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fzylogic_nova-recipes-nova-common.rb\n# Target line: 69\n\n     64: Chef::Log.debug(\"nova::nova-common:novnc_proxy_endpoint|#{novnc_proxy_endpoint}\")\n     65: Chef::Log.debug(\"nova::nova-common:glance_endpoint|#{glance_endpoint}\")\n     66: Chef::Log.debug(\"nova::nova-common:nova_api_endpoint|#{nova_api_endpoint}\")\n     67: Chef::Log.debug(\"nova::nova-common:ec2_public_endpoint|#{ec2_public_endpoint}\")\n     68: \n>>>  69: # TODO: need to re-evaluate this for accuracy\n     70: template \"/etc/nova/nova.conf\" do\n     71:   source \"nova.conf.erb\"\n     72:   owner \"root\"\n     73:   group \"root\"\n     74:   mode \"0644\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-recipe.rb", "content": "# TODO: Duplicates functionality of RunListItem", "line": 52, "detection_span": [47, 57], "with_context": "\n# For example:\n#   \"aws::elastic_ip\" returns [:aws, \"elastic_ip\"]\n#   \"aws\" returns [:aws, \"default\"]\n#   \"::elastic_ip\" returns [ current_cookbook, \"elastic_ip\" ]\n#--\n52:     # TODO: Duplicates functionality of RunListItem\ndef self.parse_recipe_name(recipe_name, current_cookbook: nil)\ncase recipe_name\nwhen /(.+?)::(.+)/\n[ $1.to_sym, $2 ]\nwhen /^::(.+)/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-recipe.rb\n# Target line: 52\n\n     47:     # For example:\n     48:     #   \"aws::elastic_ip\" returns [:aws, \"elastic_ip\"]\n     49:     #   \"aws\" returns [:aws, \"default\"]\n     50:     #   \"::elastic_ip\" returns [ current_cookbook, \"elastic_ip\" ]\n     51:     #--\n>>>  52:     # TODO: Duplicates functionality of RunListItem\n     53:     def self.parse_recipe_name(recipe_name, current_cookbook: nil)\n     54:       case recipe_name\n     55:       when /(.+?)::(.+)/\n     56:         [ $1.to_sym, $2 ]\n     57:       when /^::(.+)/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "krishnajadhav_chef-apache2-recipes-mod_log_debug.rb", "content": "# Recipe:: mod_log_debug", "line": 3, "detection_span": [1, 8], "with_context": "\n#\n# Cookbook:: apache2\n3: # Recipe:: mod_log_debug\n#\n# Copyright:: 2013, OneHealth Solutions, Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: krishnajadhav_chef-apache2-recipes-mod_log_debug.rb\n# Target line: 3\n\n      1: #\n      2: # Cookbook:: apache2\n>>>   3: # Recipe:: mod_log_debug\n      4: #\n      5: # Copyright:: 2013, OneHealth Solutions, Inc.\n      6: #\n      7: # Licensed under the Apache License, Version 2.0 (the \"License\");\n      8: # you may not use this file except in compliance with the License.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Nikhil424_chef-repo-cookbooks-compat_resource-libraries-autoload.rb", "content": "# on any chef client later than the one we were based off of we just turn into a no-op", "line": 16, "detection_span": [11, 21], "with_context": "\nend\n\n# we want to not pollute the libpath with our files until after we've done the version check\nrequire_relative '../files/lib/chef_upstream_version'\n\n16: # on any chef client later than the one we were based off of we just turn into a no-op\nif Gem::Requirement.new(\"< #{ChefCompat::CHEF_UPSTREAM_VERSION}\").satisfied_by?(Gem::Version.new(Chef::VERSION))\nChef::Log.debug \"loading compat_resource based on chef-version #{ChefCompat::CHEF_UPSTREAM_VERSION} over chef version #{Gem::Version.new(Chef::VERSION)}\"\n$LOAD_PATH.unshift(File.expand_path(\"../files/lib\", File.dirname(__FILE__)))\nrequire 'compat_resource'\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-compat_resource-libraries-autoload.rb\n# Target line: 16\n\n     11: end\n     12: \n     13: # we want to not pollute the libpath with our files until after we've done the version check\n     14: require_relative '../files/lib/chef_upstream_version'\n     15: \n>>>  16: # on any chef client later than the one we were based off of we just turn into a no-op\n     17: if Gem::Requirement.new(\"< #{ChefCompat::CHEF_UPSTREAM_VERSION}\").satisfied_by?(Gem::Version.new(Chef::VERSION))\n     18:   Chef::Log.debug \"loading compat_resource based on chef-version #{ChefCompat::CHEF_UPSTREAM_VERSION} over chef version #{Gem::Version.new(Chef::VERSION)}\"\n     19:   $LOAD_PATH.unshift(File.expand_path(\"../files/lib\", File.dirname(__FILE__)))\n     20:   require 'compat_resource'\n     21: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-chef-server-2.0-recipes-default.rb", "content": "not_if { Resolv.getaddress(node['chef-server']['api_fqdn']) rescue false } # host resolves", "line": 96, "detection_span": [91, 101], "with_context": "\nfe = Chef::Util::FileEdit.new(\"/etc/hosts\")\nfe.insert_line_if_no_match(/#{node['chef-server']['api_fqdn']}/,\n\"127.0.0.1 #{node['chef-server']['api_fqdn']}\")\nfe.write_file\nend\n96:   not_if { Resolv.getaddress(node['chef-server']['api_fqdn']) rescue false } # host resolves\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-chef-server-2.0-recipes-default.rb\n# Target line: 96\n\n     91:     fe = Chef::Util::FileEdit.new(\"/etc/hosts\")\n     92:     fe.insert_line_if_no_match(/#{node['chef-server']['api_fqdn']}/,\n     93:                                \"127.0.0.1 #{node['chef-server']['api_fqdn']}\")\n     94:     fe.write_file\n     95:   end\n>>>  96:   not_if { Resolv.getaddress(node['chef-server']['api_fqdn']) rescue false } # host resolves\n     97: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-config.rb", "content": "# TODO: Provide an API for getting this information", "line": 36, "detection_span": [31, 41], "with_context": "\n# ['previous_run']['foo']['bar'].\n#\n# Take care to check that ['previous_run'] exists, though, otherwise\n# you'll run into trouble doing the initial Chef run.\n#\n36:   # TODO: Provide an API for getting this information\nnode.consume_attributes({\"previous_run\" => old_config['private_chef']})\nend\n\nif File.exists?(\"/etc/opscode/chef-server.json\") &&\n!(File.exist?(\"/etc/opscode/private-chef.rb\") || File.exist?(\"/etc/opscode/chef-server.rb\"))", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-config.rb\n# Target line: 36\n\n     31:   # ['previous_run']['foo']['bar'].\n     32:   #\n     33:   # Take care to check that ['previous_run'] exists, though, otherwise\n     34:   # you'll run into trouble doing the initial Chef run.\n     35:   #\n>>>  36:   # TODO: Provide an API for getting this information\n     37:   node.consume_attributes({\"previous_run\" => old_config['private_chef']})\n     38: end\n     39: \n     40: if File.exists?(\"/etc/opscode/chef-server.json\") &&\n     41:     !(File.exist?(\"/etc/opscode/private-chef.rb\") || File.exist?(\"/etc/opscode/chef-server.rb\"))\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-resolver-recipes-default.rb", "content": "# This syntax makes the resolver sub-keys available directly", "line": 32, "detection_span": [27, 37], "with_context": "\ntemplate \"/etc/resolv.conf\" do\nsource \"resolv.conf.erb\"\nowner \"root\"\ngroup \"root\"\nmode 0644\n32:     # This syntax makes the resolver sub-keys available directly\nvariables node['resolver']\nend\nend\n\ncase node.chef_environment", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-resolver-recipes-default.rb\n# Target line: 32\n\n     27:   template \"/etc/resolv.conf\" do\n     28:     source \"resolv.conf.erb\"\n     29:     owner \"root\"\n     30:     group \"root\"\n     31:     mode 0644\n>>>  32:     # This syntax makes the resolver sub-keys available directly\n     33:     variables node['resolver']\n     34:   end\n     35: end\n     36: \n     37: case node.chef_environment\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-dhcprelay.rb", "content": "#  FIXME: not really suitable for sys - should go to a separate dhcp recipe", "line": 21, "detection_span": [16, 26], "with_context": "\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n# recipe for DHCP relay setup\n21: #  FIXME: not really suitable for sys - should go to a separate dhcp recipe\n\nif node['sys']['dhcprelay']\n\n# 'dhcp-helper' is a valid alternative here\npkg = node['sys']['dhcprelay']['package'] || 'isc-dhcp-relay'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-dhcprelay.rb\n# Target line: 21\n\n     16: # See the License for the specific language governing permissions and\n     17: # limitations under the License.\n     18: #\n     19: \n     20: # recipe for DHCP relay setup\n>>>  21: #  FIXME: not really suitable for sys - should go to a separate dhcp recipe\n     22: \n     23: if node['sys']['dhcprelay']\n     24: \n     25:   # 'dhcp-helper' is a valid alternative here\n     26:   pkg = node['sys']['dhcprelay']['package'] || 'isc-dhcp-relay'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-hadoop_cluster-cookbooks-elasticsearch-recipes-basic_auth.rb", "content": "# FIXME: nginx should be run after this recipe, but we need to ensure", "line": 35, "detection_span": [30, 40], "with_context": "\nend\n$passwords.flush\nend\nend\n\n35: # FIXME: nginx should be run after this recipe, but we need to ensure\n# that the nginx directory exists in order to place a template\n# there.\ndirectory node[:nginx][:dir] do\nmode 0755\naction :create", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-hadoop_cluster-cookbooks-elasticsearch-recipes-basic_auth.rb\n# Target line: 35\n\n     30:     end\n     31:     $passwords.flush\n     32:   end\n     33: end\n     34: \n>>>  35: # FIXME: nginx should be run after this recipe, but we need to ensure\n     36: # that the nginx directory exists in order to place a template\n     37: # there.\n     38: directory node[:nginx][:dir] do\n     39:   mode 0755\n     40:   action :create\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-rabbitmq-recipes-default.rb", "content": "## is because there is a problem with the stock init script in the RabbitMQ", "line": 125, "detection_span": [120, 130], "with_context": "\nhostname node['rabbitmq']['vip']\n121:   end\n122: end\n123:\n124: ## You'll see setsid used in all the init statements in this cookbook. This\n125: ## is because there is a problem with the stock init script in the RabbitMQ\n126: ## debian package (at least in 2.8.2) that makes it not daemonize properly\n127: ## when called from chef. The setsid command forces the subprocess into a state\n128: ## where it can daemonize properly. -Kevin (thanks to Daniel DeLeo for the help)\n129:\n130: service \"rabbitmq-server\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-rabbitmq-recipes-default.rb\n# Target line: 125\n\n    120:     hostname node['rabbitmq']['vip']\n    121:   end\n    122: end\n    123: \n    124: ## You'll see setsid used in all the init statements in this cookbook. This\n>>> 125: ## is because there is a problem with the stock init script in the RabbitMQ\n    126: ## debian package (at least in 2.8.2) that makes it not daemonize properly\n    127: ## when called from chef. The setsid command forces the subprocess into a state\n    128: ## where it can daemonize properly. -Kevin (thanks to Daniel DeLeo for the help)\n    129: \n    130: service \"rabbitmq-server\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-ceph.rb", "content": "# https://tracker.ceph.com/issues/50778", "line": 113, "detection_span": [108, 118], "with_context": "\n108: default['bcpc']['ceph']['mon']['enabled'] = true\n109: default['bcpc']['ceph']['osd']['enabled'] = true\n110:\n111: # ceph mgr module configuration\n112:\n113: # https://tracker.ceph.com/issues/50778\n114: # Mons may become unstable when the progress module is enabled.\n115: default['bcpc']['ceph']['module']['progress']['enabled'] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-ceph.rb\n# Target line: 113\n\n    108: default['bcpc']['ceph']['mon']['enabled'] = true\n    109: default['bcpc']['ceph']['osd']['enabled'] = true\n    110: \n    111: # ceph mgr module configuration\n    112: \n>>> 113: # https://tracker.ceph.com/issues/50778\n    114: # Mons may become unstable when the progress module is enabled.\n    115: default['bcpc']['ceph']['module']['progress']['enabled'] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-service-files-halite_gem-poise_service-service_mixin.rb", "content": "# @todo Add reload once poise-service supports it.", "line": 138, "detection_span": [133, 143], "with_context": "\nnotify_if_service do\nservice_resource.run_action(:reload)\nend\nend\n137:\n138:       # @todo Add reload once poise-service supports it.\n139:\nprivate\n141:\n# Set the current resource as notified if the provided block updates the\n# service resource.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-service-files-halite_gem-poise_service-service_mixin.rb\n# Target line: 138\n\n    133:         notify_if_service do\n    134:           service_resource.run_action(:reload)\n    135:         end\n    136:       end\n    137: \n>>> 138:       # @todo Add reload once poise-service supports it.\n    139: \n    140:       private\n    141: \n    142:       # Set the current resource as notified if the provided block updates the\n    143:       # service resource.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_opscode-omnibus-files-private-chef-cookbooks-private-chef-recipes-postgresql.rb", "content": "# TODO: Currently this is set up to be a parent directory of", "line": 33, "detection_span": [28, 38], "with_context": "\nsystem true\nshell node['private_chef']['postgresql']['shell']\nhome node['private_chef']['postgresql']['home']\nend\n\n33: # TODO: Currently this is set up to be a parent directory of\n# node['private_chef']['postgresql']['dir'].  Is it necessary that\n# this is exposed as a settable attribute, or can we make some\n# simplifying assumptions about our directory structure?\ndirectory node['private_chef']['postgresql']['home'] do\nowner node['private_chef']['postgresql']['username']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_opscode-omnibus-files-private-chef-cookbooks-private-chef-recipes-postgresql.rb\n# Target line: 33\n\n     28:   system true\n     29:   shell node['private_chef']['postgresql']['shell']\n     30:   home node['private_chef']['postgresql']['home']\n     31: end\n     32: \n>>>  33: # TODO: Currently this is set up to be a parent directory of\n     34: # node['private_chef']['postgresql']['dir'].  Is it necessary that\n     35: # this is exposed as a settable attribute, or can we make some\n     36: # simplifying assumptions about our directory structure?\n     37: directory node['private_chef']['postgresql']['home'] do\n     38:   owner node['private_chef']['postgresql']['username']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_fstab-attributes-default.rb", "content": "'tracefs', # kernel debugging", "line": 63, "detection_span": [58, 68], "with_context": "\n'hugetlbfs', # hugepages\n'mqueue', # POSIX queues\n'proc',\n'swap',\n'sysfs',\n63:       'tracefs', # kernel debugging\n'usbfs',\n],\n'mount_points' => [\n# Core OS stuff to never umount...\n'/dev/shm',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_fstab-attributes-default.rb\n# Target line: 63\n\n     58:       'hugetlbfs', # hugepages\n     59:       'mqueue', # POSIX queues\n     60:       'proc',\n     61:       'swap',\n     62:       'sysfs',\n>>>  63:       'tracefs', # kernel debugging\n     64:       'usbfs',\n     65:     ],\n     66:     'mount_points' => [\n     67:       # Core OS stuff to never umount...\n     68:       '/dev/shm',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-windows-resources-path.rb", "content": "# This is a temporary fix for that.", "line": 38, "detection_span": [33, 43], "with_context": "\nnotifies :run, \"ruby_block[fix ruby ENV['PATH']]\", :immediately\nend\n\n# The windows Env provider does not correctly expand variables in\n# the PATH environment variable. Ruby expects these to be expanded.\n38:   # This is a temporary fix for that.\n#\n# Follow at https://github.com/chef/chef/pull/1876\n#\nruby_block \"fix ruby ENV['PATH']\" do\nblock do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-windows-resources-path.rb\n# Target line: 38\n\n     33:     notifies :run, \"ruby_block[fix ruby ENV['PATH']]\", :immediately\n     34:   end\n     35: \n     36:   # The windows Env provider does not correctly expand variables in\n     37:   # the PATH environment variable. Ruby expects these to be expanded.\n>>>  38:   # This is a temporary fix for that.\n     39:   #\n     40:   # Follow at https://github.com/chef/chef/pull/1876\n     41:   #\n     42:   ruby_block \"fix ruby ENV['PATH']\" do\n     43:     block do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-mongodb-cookbooks-redis-attributes-default.rb", "content": "# TODO: replace with discovery", "line": 43, "detection_span": [38, 48], "with_context": "\n\ndefault[:redis][:saves]             = [[\"900\", \"1\"], [\"300\", \"10\"], [\"60\", \"10000\"]]\n\ndefault[:redis][:slave]             = \"no\"\nif (node[:redis][:slave] == \"yes\")\n43:   # TODO: replace with discovery\ndefault[:redis][:master_server]   = \"redis-master.\" + domain\ndefault[:redis][:master_port]     = \"6379\"\nend\n\ndefault[:redis][:shareobjects]      = \"no\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-mongodb-cookbooks-redis-attributes-default.rb\n# Target line: 43\n\n     38: \n     39: default[:redis][:saves]             = [[\"900\", \"1\"], [\"300\", \"10\"], [\"60\", \"10000\"]]\n     40: \n     41: default[:redis][:slave]             = \"no\"\n     42: if (node[:redis][:slave] == \"yes\")\n>>>  43:   # TODO: replace with discovery\n     44:   default[:redis][:master_server]   = \"redis-master.\" + domain\n     45:   default[:redis][:master_port]     = \"6379\"\n     46: end\n     47: \n     48: default[:redis][:shareobjects]      = \"no\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_nova-recipes-nova-osapi-patch.rb", "content": "# lp:bug https://bugs.launchpad.net/ubuntu/+bug/1235220", "line": 24, "detection_span": [19, 29], "with_context": "\n\ninclude_recipe \"osops-utils\"\n\nnova_api_endpoint = get_bind_endpoint(\"nova\", \"api\")\n\n24: # lp:bug https://bugs.launchpad.net/ubuntu/+bug/1235220\n# incorrect headers delivered by nova osapi\ntemplate \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\" do\nsource \"patches/servers.py.2013.1.3-0ubuntu1~cloud0.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-osapi-patch.rb\n# Target line: 24\n\n     19: \n     20: include_recipe \"osops-utils\"\n     21: \n     22: nova_api_endpoint = get_bind_endpoint(\"nova\", \"api\")\n     23: \n>>>  24: # lp:bug https://bugs.launchpad.net/ubuntu/+bug/1235220\n     25: # incorrect headers delivered by nova osapi\n     26: template \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\" do\n     27:   source \"patches/servers.py.2013.1.3-0ubuntu1~cloud0.erb\"\n     28:   owner \"root\"\n     29:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-motd-example_clusters-hb.rb", "content": "# #   to overcome https://issues.apache.org/jira/browse/HBASE-4684 in HBase 0.90.4", "line": 84, "detection_span": [79, 89], "with_context": "\n# #   large heaps.\n# cluster_overrides[:hbase][:memstore] ||= {}\n# cluster_overrides[:hbase][:memstore][:mslab_enabled]          = true\n#\n# # Setting this to 0 entirely removes the limit on concurrent connections. This is necessary\n84:   # #   to overcome https://issues.apache.org/jira/browse/HBASE-4684 in HBase 0.90.4\n# cluster_overrides[:zookeeper][:max_client_connections]        = 0\n\nrole                  :systemwide\ncloud(:ec2).security_group :systemwide\nrole                  :chef_client", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-motd-example_clusters-hb.rb\n# Target line: 84\n\n     79:   # #   large heaps.\n     80:   # cluster_overrides[:hbase][:memstore] ||= {}\n     81:   # cluster_overrides[:hbase][:memstore][:mslab_enabled]          = true\n     82:   #\n     83:   # # Setting this to 0 entirely removes the limit on concurrent connections. This is necessary\n>>>  84:   # #   to overcome https://issues.apache.org/jira/browse/HBASE-4684 in HBase 0.90.4\n     85:   # cluster_overrides[:zookeeper][:max_client_connections]        = 0\n     86: \n     87:   role                  :systemwide\n     88:   cloud(:ec2).security_group :systemwide\n     89:   role                  :chef_client\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "enterstudio_ey-cloud-recipes-cookbooks-main-recipes-default.rb", "content": "#uncomment to use the ntp recipes for fixing clock issues", "line": 46, "detection_span": [41, 51], "with_context": "\n#require_recipe \"exim::auth\"\n\n#uncomment to run the resque recipe\n#require_recipe \"resque\"\n\n46: #uncomment to use the ntp recipes for fixing clock issues\n#require_recipe \"ntp\"\n#\n#require_recipe \"logrotate\"\n#\n#uncomment to use the solr recipe", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: enterstudio_ey-cloud-recipes-cookbooks-main-recipes-default.rb\n# Target line: 46\n\n     41: #require_recipe \"exim::auth\"\n     42: \n     43: #uncomment to run the resque recipe\n     44: #require_recipe \"resque\"\n     45: \n>>>  46: #uncomment to use the ntp recipes for fixing clock issues\n     47: #require_recipe \"ntp\"\n     48: #\n     49: #require_recipe \"logrotate\"\n     50: #\n     51: #uncomment to use the solr recipe\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-elasticsearch.rb", "content": "# 'elasticsearch.primary' prefix. It is particularly useful if you want to", "line": 25, "detection_span": [20, 30], "with_context": "\n#\n# Additional flags:\n#\n# If you enable the \"pshard_stats\" flag, statistics over primary shards\n# will be collected by the check and sent to the backend with the\n25: # 'elasticsearch.primary' prefix. It is particularly useful if you want to\n# get certain metrics without taking replicas into account. For instance,\n# 'elasticsearch.primaries.docs.count` will give you the total number of\n# documents in your indexes WITHOUT counting duplicates due to the existence\n# of replica shards in your ES cluster\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-recipes-elasticsearch.rb\n# Target line: 25\n\n     20: #\n     21: # Additional flags:\n     22: #\n     23: # If you enable the \"pshard_stats\" flag, statistics over primary shards\n     24: # will be collected by the check and sent to the backend with the\n>>>  25: # 'elasticsearch.primary' prefix. It is particularly useful if you want to\n     26: # get certain metrics without taking replicas into account. For instance,\n     27: # 'elasticsearch.primaries.docs.count` will give you the total number of\n     28: # documents in your indexes WITHOUT counting duplicates due to the existence\n     29: # of replica shards in your ES cluster\n     30: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-vayacondios-recipes-install_from_git.rb", "content": "#   https://github.com/carlhuda/bundler/issues/1570", "line": 20, "detection_span": [15, 25], "with_context": "\n# gemspecs (lookin' at you devise) have UTF chars in them\n# even though the OS thinks they are ASCII.  Ruby trusts the\n# OS unless you let it know via this variable to trust you\n# instead.  See\n#\n20:   #   https://github.com/carlhuda/bundler/issues/1570\n#\n\"LANG\" => \"en_US.UTF-8\",\n\"LC_ALL\" => \"en_US.UTF-8\"\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-vayacondios-recipes-install_from_git.rb\n# Target line: 20\n\n     15:   # gemspecs (lookin' at you devise) have UTF chars in them\n     16:   # even though the OS thinks they are ASCII.  Ruby trusts the\n     17:   # OS unless you let it know via this variable to trust you\n     18:   # instead.  See\n     19:   #\n>>>  20:   #   https://github.com/carlhuda/bundler/issues/1570\n     21:   #\n     22:   \"LANG\" => \"en_US.UTF-8\",\n     23:   \"LC_ALL\" => \"en_US.UTF-8\"\n     24: }\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack_cookbook-openstack-block-storage-recipes-volume_driver_lvm.rb", "content": "# TODO: (jklare) this whole section should be refactored and probably include an", "line": 26, "detection_span": [21, 31], "with_context": "\npackage platform_options['cinder_lvm_packages'] do\noptions platform_options['package_overrides']\naction :upgrade\nend\n\n26: # TODO: (jklare) this whole section should be refactored and probably include an\n# external cookbook for managing lvm stuff\n\nvg_name = node['openstack']['block-storage']['conf']['DEFAULT']['volume_group']\ncase node['openstack']['block-storage']['volume']['create_volume_group_type']\nwhen 'file'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-block-storage-recipes-volume_driver_lvm.rb\n# Target line: 26\n\n     21: package platform_options['cinder_lvm_packages'] do\n     22:   options platform_options['package_overrides']\n     23:   action :upgrade\n     24: end\n     25: \n>>>  26: # TODO: (jklare) this whole section should be refactored and probably include an\n     27: # external cookbook for managing lvm stuff\n     28: \n     29: vg_name = node['openstack']['block-storage']['conf']['DEFAULT']['volume_group']\n     30: case node['openstack']['block-storage']['volume']['create_volume_group_type']\n     31: when 'file'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-keys.rb", "content": "# @options [Fixnum] :timeout specify http timeout", "line": 71, "detection_span": [66, 76], "with_context": "\n#\n# This method takes the following parameters as arguments\n# @ key   - key to be watched\n# @options [Hash] additional options for watching a key\n# @options [Fixnum] :index watch the specified key from given index\n71:     # @options [Fixnum] :timeout specify http timeout\ndef watch(key, opts = {})\nparams = { wait: true }\nfail ArgumentError, 'Second argument must be a hash' unless opts.is_a?(Hash)\ntimeout = opts[:timeout] || @read_timeout\nindex = opts[:waitIndex] || opts[:index]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-keys.rb\n# Target line: 71\n\n     66:     #\n     67:     # This method takes the following parameters as arguments\n     68:     # @ key   - key to be watched\n     69:     # @options [Hash] additional options for watching a key\n     70:     # @options [Fixnum] :index watch the specified key from given index\n>>>  71:     # @options [Fixnum] :timeout specify http timeout\n     72:     def watch(key, opts = {})\n     73:       params = { wait: true }\n     74:       fail ArgumentError, 'Second argument must be a hash' unless opts.is_a?(Hash)\n     75:       timeout = opts[:timeout] || @read_timeout\n     76:       index = opts[:waitIndex] || opts[:index]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_delivery_build-recipes-chefdk.rb", "content": "# Needed by the delivery-cli to resolve build-cookbooks from", "line": 62, "detection_span": [57, 67], "with_context": "\n\"/opt/chefdk/bin:/opt/chefdk/embedded/bin:#{ENV['PATH']}\"\nend\n\n# Install knife-supermarket Gem\n#\n62: # Needed by the delivery-cli to resolve build-cookbooks from\n# both public/private Supermarket\ngem_package 'knife-supermarket' do\nversion '0.2.2'\ngem_binary windows? ? 'C:\\opscode\\chefdk\\embedded\\bin\\gem' : '/opt/chefdk/embedded/bin/gem'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_delivery_build-recipes-chefdk.rb\n# Target line: 62\n\n     57:                 \"/opt/chefdk/bin:/opt/chefdk/embedded/bin:#{ENV['PATH']}\"\n     58:               end\n     59: \n     60: # Install knife-supermarket Gem\n     61: #\n>>>  62: # Needed by the delivery-cli to resolve build-cookbooks from\n     63: # both public/private Supermarket\n     64: gem_package 'knife-supermarket' do\n     65:   version '0.2.2'\n     66:   gem_binary windows? ? 'C:\\opscode\\chefdk\\embedded\\bin\\gem' : '/opt/chefdk/embedded/bin/gem'\n     67: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-rightscale-libraries-helper.rb", "content": "# Get the value portion of a tag with a given prefix from a list of tags.", "line": 63, "detection_span": [58, 68], "with_context": "\n# @return [Hash] A filtered server collection\ndef self.filter_tags!(collection, name, tags)\ncollection[name] = filter_tags(collection, name, tags)\nend\n\n63:       # Get the value portion of a tag with a given prefix from a list of tags.\n#\n# @param [String] prefix the prefix of tag to retrieve\n# @param [Array] tags list of tags to search\n# @param [String] capture optional Regexp portion to validate the value\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-rightscale-libraries-helper.rb\n# Target line: 63\n\n     58:       # @return [Hash] A filtered server collection\n     59:       def self.filter_tags!(collection, name, tags)\n     60:         collection[name] = filter_tags(collection, name, tags)\n     61:       end\n     62: \n>>>  63:       # Get the value portion of a tag with a given prefix from a list of tags.\n     64:       #\n     65:       # @param [String] prefix the prefix of tag to retrieve\n     66:       # @param [Array] tags list of tags to search\n     67:       # @param [String] capture optional Regexp portion to validate the value\n     68:       #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "paulmccallick_chef-logstash-recipes-source.rb", "content": "# command \"make clean && make VERSION=#{logstash_version} --debug > /tmp/make.log 2>&1\"", "line": 33, "detection_span": [28, 38], "with_context": "\nenvironment(\nJAVA_HOME: node['logstash']['source']['java_home']\n)\nuser 'root'\n# This variant is useful for troubleshooting stupid environment problems\n33:   # command \"make clean && make VERSION=#{logstash_version} --debug > /tmp/make.log 2>&1\"\ncommand \"make clean && make VERSION=#{logstash_version} jar\"\naction :run\ncreates \"#{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\nnot_if \"test -f #{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: paulmccallick_chef-logstash-recipes-source.rb\n# Target line: 33\n\n     28:   environment(\n     29:     JAVA_HOME: node['logstash']['source']['java_home']\n     30:   )\n     31:   user 'root'\n     32:   # This variant is useful for troubleshooting stupid environment problems\n>>>  33:   # command \"make clean && make VERSION=#{logstash_version} --debug > /tmp/make.log 2>&1\"\n     34:   command \"make clean && make VERSION=#{logstash_version} jar\"\n     35:   action :run\n     36:   creates \"#{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\n     37:   not_if \"test -f #{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\n     38: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Soluciones_ey-cloud-recipes-cookbooks-env_motd-recipes-motd.rb", "content": "# IP address will be resolved internally from Amazon, which", "line": 16, "detection_span": [11, 21], "with_context": "\npublic_hostname = ''\npublic_ip = ''\n\n# Grab the public hostname for this instance. This recipe\n# will be run *from* the instance, which means that the following\n16: # IP address will be resolved internally from Amazon, which\n# is good because it's an Amazon-specific, internal IP\n# that they use for instance metadata.\n# ########\n# This two lines can take some time, so sometimes it's better to comment it!\n# ########", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-env_motd-recipes-motd.rb\n# Target line: 16\n\n     11: public_hostname = ''\n     12: public_ip = ''\n     13: \n     14: # Grab the public hostname for this instance. This recipe\n     15: # will be run *from* the instance, which means that the following\n>>>  16: # IP address will be resolved internally from Amazon, which\n     17: # is good because it's an Amazon-specific, internal IP\n     18: # that they use for instance metadata.\n     19: # ########\n     20: # This two lines can take some time, so sometimes it's better to comment it!\n     21: # ########\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~backend_bucket.rb", "content": "# TODO(nelsonjr): http://b/63088154 Google Cloud Platform API is returning", "line": 64, "detection_span": [59, 69], "with_context": "\n'https://www.googleapis.com/auth/cloud-platform'\n]\nend\n\n# *** WARNING ***\n64: # TODO(nelsonjr): http://b/63088154 Google Cloud Platform API is returning\n# access denied if we use a more restricted scope such as\n# https://www.googleapis.com/auth/compute. For the time being use an all mighty\n# scope instead: https://www.googleapis.com/auth/cloud-platform.\n\ngcompute_backend_bucket 'chef-e2e-be-bucket-connection' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~backend_bucket.rb\n# Target line: 64\n\n     59:     'https://www.googleapis.com/auth/cloud-platform'\n     60:   ]\n     61: end\n     62: \n     63: # *** WARNING ***\n>>>  64: # TODO(nelsonjr): http://b/63088154 Google Cloud Platform API is returning\n     65: # access denied if we use a more restricted scope such as\n     66: # https://www.googleapis.com/auth/compute. For the time being use an all mighty\n     67: # scope instead: https://www.googleapis.com/auth/cloud-platform.\n     68: \n     69: gcompute_backend_bucket 'chef-e2e-be-bucket-connection' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-docker-libraries-docker_service_manager_execute.rb", "content": "# https://github.com/docker/docker/issues/2758", "line": 24, "detection_span": [19, 29], "with_context": "\naction :run\nend\n\n# Go doesn't support detaching processes natively, so we have\n# to manually fork it from the shell with &\n24:       # https://github.com/docker/docker/issues/2758\nbash \"start docker #{name}\" do\ncode \"#{docker_daemon_cmd} >> #{logfile} 2>&1 &\"\nenvironment 'HTTP_PROXY' => http_proxy,\n'HTTPS_PROXY' => https_proxy,\n'NO_PROXY' => no_proxy,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-docker-libraries-docker_service_manager_execute.rb\n# Target line: 24\n\n     19:         action :run\n     20:       end\n     21: \n     22:       # Go doesn't support detaching processes natively, so we have\n     23:       # to manually fork it from the shell with &\n>>>  24:       # https://github.com/docker/docker/issues/2758\n     25:       bash \"start docker #{name}\" do\n     26:         code \"#{docker_daemon_cmd} >> #{logfile} 2>&1 &\"\n     27:         environment 'HTTP_PROXY' => http_proxy,\n     28:                     'HTTPS_PROXY' => https_proxy,\n     29:                     'NO_PROXY' => no_proxy,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-docker-recipes-default.rb", "content": "# file. This hack replaces official service file with the one that comes with", "line": 37, "detection_span": [32, 42], "with_context": "\nversion node['docker']['apt']['version']\nend\n\n# Ugly hack for Ubuntu 16.04 docker service. By default, service does not\n# allow us to override hosts setting, because it is hardcoded in the service\n37: # file. This hack replaces official service file with the one that comes with\n# Fedora packages and has no hardcoded hosts.\n#\n# Just for reference, this is the error that we get in system logs:\n#   unable to configure the Docker daemon with file /etc/docker/daemon.json:\n#   the following directives are specified both as a flag and in the", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-docker-recipes-default.rb\n# Target line: 37\n\n     32:   version node['docker']['apt']['version']\n     33: end\n     34: \n     35: # Ugly hack for Ubuntu 16.04 docker service. By default, service does not\n     36: # allow us to override hosts setting, because it is hardcoded in the service\n>>>  37: # file. This hack replaces official service file with the one that comes with\n     38: # Fedora packages and has no hardcoded hosts.\n     39: #\n     40: # Just for reference, this is the error that we get in system logs:\n     41: #   unable to configure the Docker daemon with file /etc/docker/daemon.json:\n     42: #   the following directives are specified both as a flag and in the\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "criteo-cookbooks_nexus3-libraries-api.rb", "content": "# Little hack with custom client to get read of the API prefix.", "line": 99, "detection_span": [94, 104], "with_context": "\nend\nend\n\n# exists? check if asset at the given path exists\ndef exists?(repo, path)\n99:       # Little hack with custom client to get read of the API prefix.\n# TODO: Provide more data to the Api init / pass the api prefix in each method\nu = URI.parse(@endpoint)\nu.path = ::File.join('/repository', repo, path) # Replace api prefix by the path to the asset\nres = ::HTTPClient.new.head(u)\nres.ok?", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_nexus3-libraries-api.rb\n# Target line: 99\n\n     94:       end\n     95:     end\n     96: \n     97:     # exists? check if asset at the given path exists\n     98:     def exists?(repo, path)\n>>>  99:       # Little hack with custom client to get read of the API prefix.\n    100:       # TODO: Provide more data to the Api init / pass the api prefix in each method\n    101:       u = URI.parse(@endpoint)\n    102:       u.path = ::File.join('/repository', repo, path) # Replace api prefix by the path to the asset\n    103:       res = ::HTTPClient.new.head(u)\n    104:       res.ok?\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_django-attributes-default.rb", "content": "# Django application debug mode - https://docs.djangoproject.com/en/dev/ref/settings/#debug", "line": 12, "detection_span": [7, 17], "with_context": "\n\n\n# Setting Django version\nset[:app_django][:version] = \"1.4\"\n\n12: # Django application debug mode - https://docs.djangoproject.com/en/dev/ref/settings/#debug\nset_unless[:app_django][:app][:debug_mode] = \"False\"\n\n# By default apache will serve any existing local files directly (except actionable ones)\nset_unless[:app_django][:apache][:serve_local_files] = \"true\"\n# List of required apache modules", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_django-attributes-default.rb\n# Target line: 12\n\n      7: \n      8: \n      9: # Setting Django version\n     10: set[:app_django][:version] = \"1.4\"\n     11: \n>>>  12: # Django application debug mode - https://docs.djangoproject.com/en/dev/ref/settings/#debug\n     13: set_unless[:app_django][:app][:debug_mode] = \"False\"\n     14: \n     15: # By default apache will serve any existing local files directly (except actionable ones)\n     16: set_unless[:app_django][:apache][:serve_local_files] = \"true\"\n     17: # List of required apache modules\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-mail.rb", "content": "# check if /etc/postfix/<map>.db exists and", "line": 76, "detection_span": [71, 81], "with_context": "\nend\n\nexecute \"update-#{map}\" do\naction :run\ncommand \"postmap /etc/postfix/#{map}\"\n76:     # check if /etc/postfix/<map>.db exists and\n#  run if it doesn't or is outdated:\nnot_if \"/usr/bin/test /etc/postfix/#{map}.db -nt /etc/postfix/#{map}\"\nnotifies :reload, 'service[postfix]'\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-mail.rb\n# Target line: 76\n\n     71:   end\n     72: \n     73:   execute \"update-#{map}\" do\n     74:     action :run\n     75:     command \"postmap /etc/postfix/#{map}\"\n>>>  76:     # check if /etc/postfix/<map>.db exists and\n     77:     #  run if it doesn't or is outdated:\n     78:     not_if \"/usr/bin/test /etc/postfix/#{map}.db -nt /etc/postfix/#{map}\"\n     79:     notifies :reload, 'service[postfix]'\n     80:   end\n     81: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-redis-recipes-default.rb", "content": "key \"5862E31D\"", "line": 27, "detection_span": [22, 32], "with_context": "\n\nif node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"ppa_redis\" do\nurl \"http://ppa.launchpad.net/rwky/redis/ubuntu\"\n27:       key \"5862E31D\"\nkey_server \"keyserver.ubuntu.com\"\nend\n\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-redis-recipes-default.rb\n# Target line: 27\n\n     22: \n     23:   if node.apt.master_chef_add_apt_repo\n     24: \n     25:     add_apt_repository \"ppa_redis\" do\n     26:       url \"http://ppa.launchpad.net/rwky/redis/ubuntu\"\n>>>  27:       key \"5862E31D\"\n     28:       key_server \"keyserver.ubuntu.com\"\n     29:     end\n     30: \n     31:   end\n     32: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_source_scm_base.rb", "content": "scm_key = :repository if scm_key == :url", "line": 11, "detection_span": [6, 16], "with_context": "\nclass Base < Drivers::Source::Base\ndef fetch(deploy_context)\ndeploy_context.scm_provider(adapter.constantize)\n\nout.each do |scm_key, scm_value|\n11:             scm_key = :repository if scm_key == :url\ndeploy_context.send(scm_key, scm_value) if deploy_context.respond_to?(scm_key)\nend\nend\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_source_scm_base.rb\n# Target line: 11\n\n      6:       class Base < Drivers::Source::Base\n      7:         def fetch(deploy_context)\n      8:           deploy_context.scm_provider(adapter.constantize)\n      9: \n     10:           out.each do |scm_key, scm_value|\n>>>  11:             scm_key = :repository if scm_key == :url\n     12:             deploy_context.send(scm_key, scm_value) if deploy_context.respond_to?(scm_key)\n     13:           end\n     14:         end\n     15:       end\n     16:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-nova-setup.rb", "content": "user \"nova\"", "line": 56, "detection_span": [51, 61], "with_context": "\nnode[\"nova\"][\"db\"][\"username\"],\nnode[\"nova\"][\"db\"][\"password\"])\n\nexecute \"nova-manage db sync\" do\ncommand \"nova-manage db sync\"\n56:   user \"nova\"\ngroup \"nova\"\naction :run\n#  not_if \"nova-manage db version && test $(nova-manage db version) -gt 0\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-setup.rb\n# Target line: 56\n\n     51:   node[\"nova\"][\"db\"][\"username\"],\n     52:   node[\"nova\"][\"db\"][\"password\"])\n     53: \n     54: execute \"nova-manage db sync\" do\n     55:   command \"nova-manage db sync\"\n>>>  56:   user \"nova\"\n     57:   group \"nova\"\n     58:   action :run\n     59:   #  not_if \"nova-manage db version && test $(nova-manage db version) -gt 0\"\n     60: end\n     61: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-postgres.rb", "content": "user 'postgres'", "line": 28, "detection_span": [23, 33], "with_context": "\npackage %w(libpq-dev postgresql postgresql-contrib)\n\n# Next few lines are ugly as hell, but Chef and PostgreSQL is not the best\n# match ever to exist.\nbash 'Prepare database' do\n28:   user 'postgres'\ncode <<-EOC\npsql -c \"CREATE DATABASE #{db_name};\"\npsql -c \"CREATE USER #{dice_user};\"\npsql -c \"ALTER ROLE #{dice_user} SET client_encoding TO 'utf8';\"\npsql -c \"ALTER ROLE #{dice_user} SET default_transaction_isolation TO 'read committed';\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-postgres.rb\n# Target line: 28\n\n     23: package %w(libpq-dev postgresql postgresql-contrib)\n     24: \n     25: # Next few lines are ugly as hell, but Chef and PostgreSQL is not the best\n     26: # match ever to exist.\n     27: bash 'Prepare database' do\n>>>  28:   user 'postgres'\n     29:   code <<-EOC\n     30:     psql -c \"CREATE DATABASE #{db_name};\"\n     31:     psql -c \"CREATE USER #{dice_user};\"\n     32:     psql -c \"ALTER ROLE #{dice_user} SET client_encoding TO 'utf8';\"\n     33:     psql -c \"ALTER ROLE #{dice_user} SET default_transaction_isolation TO 'read committed';\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_osl-openstack-recipes-upgrade.rb", "content": "nova_api_pass = get_password 'db', 'nova_api'", "line": 39, "detection_span": [34, 44], "with_context": "\nend\n\n### Stein Upgrade\n# TODO: Remove after Stein\n\n39: nova_api_pass = get_password 'db', 'nova_api'\nplacement_user = node['openstack']['db']['placement']['username']\nplacement_pass = get_password 'db', 'placement'\nplacement_db_uri = db_uri('placement', placement_user, placement_pass)\n\ntemplate '/root/migrate-db.rc' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_osl-openstack-recipes-upgrade.rb\n# Target line: 39\n\n     34: end\n     35: \n     36: ### Stein Upgrade\n     37: # TODO: Remove after Stein\n     38: \n>>>  39: nova_api_pass = get_password 'db', 'nova_api'\n     40: placement_user = node['openstack']['db']['placement']['username']\n     41: placement_pass = get_password 'db', 'placement'\n     42: placement_db_uri = db_uri('placement', placement_user, placement_pass)\n     43: \n     44: template '/root/migrate-db.rc' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-partners_omnibus-marketplace-files-chef-marketplace-cookbooks-chef-marketplace-attributes-default.rb", "content": "m[\"runit\"][\"user\"][\"username\"] = \"opscode\"", "line": 35, "detection_span": [30, 40], "with_context": "\nm[\"manage\"][\"ssl_port\"] = 443\nm[\"manage\"][\"sign_up\"][\"enabled\"] = true\nm[\"manage\"][\"org_creation\"][\"enabled\"] = true\nm[\"manage\"][\"marketplace\"][\"sign_up\"][\"enabled\"] = true\nm[\"manage\"][\"marketplace\"][\"sign_up\"][\"timeout\"] = 3600\n35:   m[\"runit\"][\"user\"][\"username\"] = \"opscode\"\nm[\"runit\"][\"user\"][\"shell\"] = \"/bin/sh\"\nm[\"runit\"][\"user\"][\"home\"] = \"/opt/opscode/embedded\"\n# These are used by the enterprise-chef-common cookbook\nm[\"sysvinit_id\"] = \"MP\"\nm[\"install_path\"] = \"/opt/chef-marketplace\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-partners_omnibus-marketplace-files-chef-marketplace-cookbooks-chef-marketplace-attributes-default.rb\n# Target line: 35\n\n     30:   m[\"manage\"][\"ssl_port\"] = 443\n     31:   m[\"manage\"][\"sign_up\"][\"enabled\"] = true\n     32:   m[\"manage\"][\"org_creation\"][\"enabled\"] = true\n     33:   m[\"manage\"][\"marketplace\"][\"sign_up\"][\"enabled\"] = true\n     34:   m[\"manage\"][\"marketplace\"][\"sign_up\"][\"timeout\"] = 3600\n>>>  35:   m[\"runit\"][\"user\"][\"username\"] = \"opscode\"\n     36:   m[\"runit\"][\"user\"][\"shell\"] = \"/bin/sh\"\n     37:   m[\"runit\"][\"user\"][\"home\"] = \"/opt/opscode/embedded\"\n     38:   # These are used by the enterprise-chef-common cookbook\n     39:   m[\"sysvinit_id\"] = \"MP\"\n     40:   m[\"install_path\"] = \"/opt/chef-marketplace\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-keystone.rb", "content": "default['bcpc']['ldap']['admin_pass'] = nil", "line": 64, "detection_span": [59, 69], "with_context": "\n\ndefault['bcpc']['keystone']['default_domain'] = 'default'\n\n# LDAP credentials used by Keystone\ndefault['bcpc']['ldap']['admin_user'] = nil\n64: default['bcpc']['ldap']['admin_pass'] = nil\ndefault['bcpc']['ldap']['admin_user_domain'] = nil\ndefault['bcpc']['ldap']['admin_project_domain'] = nil\ndefault['bcpc']['ldap']['admin_project_name'] = nil\ndefault['bcpc']['ldap']['config'] = {}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-keystone.rb\n# Target line: 64\n\n     59: \n     60: default['bcpc']['keystone']['default_domain'] = 'default'\n     61: \n     62: # LDAP credentials used by Keystone\n     63: default['bcpc']['ldap']['admin_user'] = nil\n>>>  64: default['bcpc']['ldap']['admin_pass'] = nil\n     65: default['bcpc']['ldap']['admin_user_domain'] = nil\n     66: default['bcpc']['ldap']['admin_project_domain'] = nil\n     67: default['bcpc']['ldap']['admin_project_name'] = nil\n     68: default['bcpc']['ldap']['config'] = {}\n     69: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-recipes-ceph-apt.rb", "content": "key \"ceph-autobuild.key\"", "line": 38, "detection_span": [33, 43], "with_context": "\n\napt_repository \"ceph-fcgi\" do\nuri node['bcpc']['repos']['ceph-fcgi']\ndistribution node['lsb']['codename']\ncomponents [\"main\"]\n38:     key \"ceph-autobuild.key\"\nend\n\napt_repository \"ceph-apache\" do\nuri node['bcpc']['repos']['ceph-apache']\ndistribution node['lsb']['codename']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-ceph-apt.rb\n# Target line: 38\n\n     33: \n     34: apt_repository \"ceph-fcgi\" do\n     35:     uri node['bcpc']['repos']['ceph-fcgi']\n     36:     distribution node['lsb']['codename']\n     37:     components [\"main\"]\n>>>  38:     key \"ceph-autobuild.key\"\n     39: end\n     40: \n     41: apt_repository \"ceph-apache\" do\n     42:     uri node['bcpc']['repos']['ceph-apache']\n     43:     distribution node['lsb']['codename']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "amitjain1975_custom-rightscale-cookbooks-repo-recipes-default.rb", "content": "svn_username = entry[:svn_username] || \"\"", "line": 16, "detection_span": [11, 21], "with_context": "\nlog \"  Setup all resources that have attributes in the node\"\nnode[:repo].each do |resource_name, entry|\n\nurl = entry[:repository] || \"\"\nbranch = entry[:revision] || \"\"\n16:   svn_username = entry[:svn_username] || \"\"\nsvn_password = entry[:svn_password] || \"\"\nkey = entry[:git_ssh_key] || \"\"\nstorage_account_provider = entry[:storage_account_provider] || \"\"\nstorage_account_id = entry[:storage_account_id] || \"\"\nstorage_account_secret = entry[:storage_account_secret] || \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-repo-recipes-default.rb\n# Target line: 16\n\n     11: log \"  Setup all resources that have attributes in the node\"\n     12: node[:repo].each do |resource_name, entry|\n     13: \n     14:   url = entry[:repository] || \"\"\n     15:   branch = entry[:revision] || \"\"\n>>>  16:   svn_username = entry[:svn_username] || \"\"\n     17:   svn_password = entry[:svn_password] || \"\"\n     18:   key = entry[:git_ssh_key] || \"\"\n     19:   storage_account_provider = entry[:storage_account_provider] || \"\"\n     20:   storage_account_id = entry[:storage_account_id] || \"\"\n     21:   storage_account_secret = entry[:storage_account_secret] || \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"https://download.docker.com/linux/ubuntu/gpg\"", "line": 159, "detection_span": [154, 164], "with_context": "\n154: apt_repository \"docker\" do\n155:   action repository_actions[\"docker\"]\n156:   uri \"https://download.docker.com/linux/ubuntu\"\n157:   arch \"amd64\"\n158:   components [\"stable\"]\n159:   key \"https://download.docker.com/linux/ubuntu/gpg\"\n160: end\n161:\n162: apt_repository \"grafana\" do\n163:   action repository_actions[\"grafana\"]\n164:   uri \"https://packages.grafana.com/enterprise/deb\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 159\n\n    154: apt_repository \"docker\" do\n    155:   action repository_actions[\"docker\"]\n    156:   uri \"https://download.docker.com/linux/ubuntu\"\n    157:   arch \"amd64\"\n    158:   components [\"stable\"]\n>>> 159:   key \"https://download.docker.com/linux/ubuntu/gpg\"\n    160: end\n    161: \n    162: apt_repository \"grafana\" do\n    163:   action repository_actions[\"grafana\"]\n    164:   uri \"https://packages.grafana.com/enterprise/deb\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-journalnode.rb", "content": "user 0644", "line": 17, "detection_span": [12, 22], "with_context": "\n\nif get_config(\"namenode_txn_fmt\") then\nfile \"#{Chef::Config[:file_cache_path]}/nn_fmt.tgz\" do\nuser \"hdfs\"\ngroup \"hdfs\"\n17:     user 0644\ncontent Base64.decode64(get_config(\"namenode_txn_fmt\"))\nnot_if { node[:bcpc][:hadoop][:mounts].all? { |d| File.exists?(\"/disk/#{d}/dfs/jn/#{node.chef_environment}/current/VERSION\") } }\nend\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-journalnode.rb\n# Target line: 17\n\n     12: \n     13: if get_config(\"namenode_txn_fmt\") then\n     14:   file \"#{Chef::Config[:file_cache_path]}/nn_fmt.tgz\" do\n     15:     user \"hdfs\"\n     16:     group \"hdfs\"\n>>>  17:     user 0644\n     18:     content Base64.decode64(get_config(\"namenode_txn_fmt\"))\n     19:     not_if { node[:bcpc][:hadoop][:mounts].all? { |d| File.exists?(\"/disk/#{d}/dfs/jn/#{node.chef_environment}/current/VERSION\") } }\n     20:   end\n     21: end\n     22: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"ABF5BD827BD9BF62\"", "line": 112, "detection_span": [107, 117], "with_context": "\n107: apt_repository \"nginx\" do\n108:   action repository_actions[\"nginx\"]\n109:   arch \"amd64\"\n110:   uri \"https://nginx.org/packages/ubuntu\"\n111:   components [\"nginx\"]\n112:   key \"ABF5BD827BD9BF62\"\n113: end\n114:\n115: apt_repository \"elasticsearch5.x\" do\n116:   action repository_actions[\"elasticsearch5.x\"]\n117:   uri \"https://artifacts.elastic.co/packages/5.x/apt\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 112\n\n    107: apt_repository \"nginx\" do\n    108:   action repository_actions[\"nginx\"]\n    109:   arch \"amd64\"\n    110:   uri \"https://nginx.org/packages/ubuntu\"\n    111:   components [\"nginx\"]\n>>> 112:   key \"ABF5BD827BD9BF62\"\n    113: end\n    114: \n    115: apt_repository \"elasticsearch5.x\" do\n    116:   action repository_actions[\"elasticsearch5.x\"]\n    117:   uri \"https://artifacts.elastic.co/packages/5.x/apt\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_core-recipes-cronjob.rb", "content": "user    job['user']    || \"root\"", "line": 22, "detection_span": [17, 27], "with_context": "\nhour    job['hour']    || \"*\"\nday     job['day']     || \"*\"\nmonth   job['month']   || \"*\"\nweekday job['weekday'] || \"*\"\ncommand job['command']\n22:     user    job['user']    || \"root\"\nmailto  job['mailto']  || node[:imos_core][:cronjob][:email_address]\npath    job['path']\nhome    job['home']\nshell   job['shell']\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_core-recipes-cronjob.rb\n# Target line: 22\n\n     17:     hour    job['hour']    || \"*\"\n     18:     day     job['day']     || \"*\"\n     19:     month   job['month']   || \"*\"\n     20:     weekday job['weekday'] || \"*\"\n     21:     command job['command']\n>>>  22:     user    job['user']    || \"root\"\n     23:     mailto  job['mailto']  || node[:imos_core][:cronjob][:email_address]\n     24:     path    job['path']\n     25:     home    job['home']\n     26:     shell   job['shell']\n     27:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']        = 'nginx'", "line": 47, "detection_span": [42, 52], "with_context": "\ndefault['nginx']['init_style'] = 'runit'\nif platform == 'ubuntu' && platform_version == '14.04'\ndefault['nginx']['pid'] = '/run/nginx.pid'\nend\nwhen 'rhel', 'fedora'\n47:   default['nginx']['user']        = 'nginx'\ndefault['nginx']['init_style']  = 'init'\ndefault['nginx']['repo_source'] = 'epel'\nwhen 'gentoo'\ndefault['nginx']['user']       = 'nginx'\ndefault['nginx']['init_style'] = 'init'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb\n# Target line: 47\n\n     42:   default['nginx']['init_style'] = 'runit'\n     43:   if platform == 'ubuntu' && platform_version == '14.04'\n     44:     default['nginx']['pid'] = '/run/nginx.pid'\n     45:   end\n     46: when 'rhel', 'fedora'\n>>>  47:   default['nginx']['user']        = 'nginx'\n     48:   default['nginx']['init_style']  = 'init'\n     49:   default['nginx']['repo_source'] = 'epel'\n     50: when 'gentoo'\n     51:   default['nginx']['user']       = 'nginx'\n     52:   default['nginx']['init_style'] = 'init'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-check_for_software_updates_daily.rb", "content": "key 'ScheduleFrequency'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Check for software updates daily, not just once per week\" do\ndomain 'com.apple.SoftwareUpdate'\n3:   key 'ScheduleFrequency'\ninteger 1\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-check_for_software_updates_daily.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Check for software updates daily, not just once per week\" do\n      2:   domain 'com.apple.SoftwareUpdate'\n>>>   3:   key 'ScheduleFrequency'\n      4:   integer 1\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "johnfitzpatrick_apache2-chefconf-recipes-mod_cloudflare.rb", "content": "key          'http://pkg.cloudflare.com/pubkey.gpg'", "line": 24, "detection_span": [19, 29], "with_context": "\n\napt_repository 'cloudflare' do\nuri          'http://pkg.cloudflare.com'\ndistribution node['lsb']['codename']\ncomponents   ['main']\n24:   key          'http://pkg.cloudflare.com/pubkey.gpg'\naction       :add\nend\n\npackage 'libapache2-mod-cloudflare' do\nnotifies :restart, 'service[apache2]'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: johnfitzpatrick_apache2-chefconf-recipes-mod_cloudflare.rb\n# Target line: 24\n\n     19: \n     20: apt_repository 'cloudflare' do\n     21:   uri          'http://pkg.cloudflare.com'\n     22:   distribution node['lsb']['codename']\n     23:   components   ['main']\n>>>  24:   key          'http://pkg.cloudflare.com/pubkey.gpg'\n     25:   action       :add\n     26: end\n     27: \n     28: package 'libapache2-mod-cloudflare' do\n     29:   notifies :restart, 'service[apache2]'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_hcatalog.rb", "content": "user \"hive\"", "line": 106, "detection_span": [101, 111], "with_context": "\n101: end\n102:\n103: directory \"/var/log/hive/gc\" do\n104:   action :create\n105:   mode 0755\n106:   user \"hive\"\n107: end\n108:\n109: service \"hive-metastore\" do\n110:   action [:enable, :start]\n111:   subscribes :restart, \"template[/etc/hive/conf/hive-site.xml]\", :delayed", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_hcatalog.rb\n# Target line: 106\n\n    101: end\n    102: \n    103: directory \"/var/log/hive/gc\" do\n    104:   action :create\n    105:   mode 0755\n>>> 106:   user \"hive\"\n    107: end\n    108: \n    109: service \"hive-metastore\" do\n    110:   action [:enable, :start]\n    111:   subscribes :restart, \"template[/etc/hive/conf/hive-site.xml]\", :delayed\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_glance-recipes-replicator.rb", "content": "admin_user \"glance\"", "line": 31, "detection_span": [26, 36], "with_context": "\ncommand \"usermod -s /bin/sh glance\"\nend\n\ndsh_group \"glance\" do\nuser \"glance\"\n31:     admin_user \"glance\"\nend\n\npackage \"glance-image-sync\" do\naction node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\noptions platform_options[\"package_options\"]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_glance-recipes-replicator.rb\n# Target line: 31\n\n     26:     command \"usermod -s /bin/sh glance\"\n     27:   end\n     28:  \n     29:   dsh_group \"glance\" do\n     30:     user \"glance\"\n>>>  31:     admin_user \"glance\"\n     32:   end\n     33: \n     34:   package \"glance-image-sync\" do\n     35:     action node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\n     36:     options platform_options[\"package_options\"]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_allow_text_selection_in_quick_look.rb", "content": "key 'QLEnableTextSelection'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Finder: allow text selection in Quick Look\" do\ndomain 'com.apple.finder'\n3:   key 'QLEnableTextSelection'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_allow_text_selection_in_quick_look.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Finder: allow text selection in Quick Look\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'QLEnableTextSelection'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"D27D666CD88E42B4\"", "line": 128, "detection_span": [123, 133], "with_context": "\n123: apt_repository \"elasticsearch6.x\" do\n124:   action repository_actions[\"elasticsearch6.x\"]\n125:   uri \"https://artifacts.elastic.co/packages/6.x/apt\"\n126:   distribution \"stable\"\n127:   components [\"main\"]\n128:   key \"D27D666CD88E42B4\"\n129: end\n130:\n131: apt_repository \"passenger\" do\n132:   action repository_actions[\"passenger\"]\n133:   uri \"https://oss-binaries.phusionpassenger.com/apt/passenger\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 128\n\n    123: apt_repository \"elasticsearch6.x\" do\n    124:   action repository_actions[\"elasticsearch6.x\"]\n    125:   uri \"https://artifacts.elastic.co/packages/6.x/apt\"\n    126:   distribution \"stable\"\n    127:   components [\"main\"]\n>>> 128:   key \"D27D666CD88E42B4\"\n    129: end\n    130: \n    131: apt_repository \"passenger\" do\n    132:   action repository_actions[\"passenger\"]\n    133:   uri \"https://oss-binaries.phusionpassenger.com/apt/passenger\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "criteo-cookbooks_nexus3-attributes-api.rb", "content": "default['nexus3']['api']['username'] = 'admin'", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault['nexus3']['api']['script_cookbook'] = 'nexus3'\ndefault['nexus3']['api']['type'] = 'groovy'\ndefault['nexus3']['api']['endpoint'] = 'http://localhost:8081/service/rest/v1/script/'\n4: default['nexus3']['api']['username'] = 'admin'\ndefault['nexus3']['api']['password'] = 'admin123'\ndefault['nexus3']['api']['ignore_failure'] = true\ndefault['nexus3']['api']['live_stream'] = false\ndefault['nexus3']['api']['wait'] = 600 # 10 minutes\ndefault['nexus3']['api']['sensitive'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_nexus3-attributes-api.rb\n# Target line: 4\n\n      1: default['nexus3']['api']['script_cookbook'] = 'nexus3'\n      2: default['nexus3']['api']['type'] = 'groovy'\n      3: default['nexus3']['api']['endpoint'] = 'http://localhost:8081/service/rest/v1/script/'\n>>>   4: default['nexus3']['api']['username'] = 'admin'\n      5: default['nexus3']['api']['password'] = 'admin123'\n      6: default['nexus3']['api']['ignore_failure'] = true\n      7: default['nexus3']['api']['live_stream'] = false\n      8: default['nexus3']['api']['wait'] = 600 # 10 minutes\n      9: default['nexus3']['api']['sensitive'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-nginx-attributes-default.rb", "content": "set[:nginx][:user]    = \"vagrant\"", "line": 12, "detection_span": [7, 17], "with_context": "\nset[:nginx][:user]    = \"vagrant\"\nset[:nginx][:binary]  = \"/usr/sbin/nginx\"\nelse\nset[:nginx][:dir]     = \"/etc/nginx\"\nset[:nginx][:log_dir] = \"/var/log/nginx\"\n12:   set[:nginx][:user]    = \"vagrant\"\nset[:nginx][:binary]  = \"/usr/sbin/nginx\"\nend\n\ndefault[:nginx][:gzip] = \"on\"\ndefault[:nginx][:gzip_http_version] = \"1.0\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-nginx-attributes-default.rb\n# Target line: 12\n\n      7:   set[:nginx][:user]    = \"vagrant\"\n      8:   set[:nginx][:binary]  = \"/usr/sbin/nginx\"\n      9: else\n     10:   set[:nginx][:dir]     = \"/etc/nginx\"\n     11:   set[:nginx][:log_dir] = \"/var/log/nginx\"\n>>>  12:   set[:nginx][:user]    = \"vagrant\"\n     13:   set[:nginx][:binary]  = \"/usr/sbin/nginx\"\n     14: end\n     15: \n     16: default[:nginx][:gzip] = \"on\"\n     17: default[:nginx][:gzip_http_version] = \"1.0\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-repo-attributes-default.rb", "content": "default[:repo][:root]      = \"/var/packages\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:repo][:root]      = \"/var/packages\"\n\n#\n# Keys\n#\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-repo-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:repo][:root]      = \"/var/packages\"\n      2: \n      3: #\n      4: # Keys\n      5: #\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-default.rb", "content": "default['openstack']['orchestration']['user'] = 'heat'", "line": 76, "detection_span": [71, 81], "with_context": "\n'heat_engine_service' => 'openstack-heat-engine',\n'heat_api_process_name' => 'heat-api',\n'package_overrides' => '',\n}\nwhen 'debian'\n76:   default['openstack']['orchestration']['user'] = 'heat'\ndefault['openstack']['orchestration']['group'] = 'heat'\ndefault['openstack']['orchestration']['platform'] = {\n'heat_common_packages' => %w(heat-common python3-heat),\n'heat_api_packages' => %w(heat-api),\n'heat_dashboard_packages' => %w(python3-heat-dashboard),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-default.rb\n# Target line: 76\n\n     71:     'heat_engine_service' => 'openstack-heat-engine',\n     72:     'heat_api_process_name' => 'heat-api',\n     73:     'package_overrides' => '',\n     74:   }\n     75: when 'debian'\n>>>  76:   default['openstack']['orchestration']['user'] = 'heat'\n     77:   default['openstack']['orchestration']['group'] = 'heat'\n     78:   default['openstack']['orchestration']['platform'] = {\n     79:     'heat_common_packages' => %w(heat-common python3-heat),\n     80:     'heat_api_packages' => %w(heat-api),\n     81:     'heat_dashboard_packages' => %w(python3-heat-dashboard),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef_supermarket-omnibus-cookbooks-omnibus-supermarket-recipes-ssl.rb", "content": "key_length 2048", "line": 39, "detection_span": [34, 44], "with_context": "\nsupermarket_ca_dir = File.join(node['supermarket']['ssl']['directory'], 'ca')\nssl_dhparam = File.join(supermarket_ca_dir, 'dhparams.pem')\n\n# Generate dhparams.pem for perfect forward secrecy\nopenssl_dhparam ssl_dhparam do\n39:     key_length 2048\ngenerator 2\nowner 'root'\ngroup 'root'\nmode '0644'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef_supermarket-omnibus-cookbooks-omnibus-supermarket-recipes-ssl.rb\n# Target line: 39\n\n     34:   supermarket_ca_dir = File.join(node['supermarket']['ssl']['directory'], 'ca')\n     35:   ssl_dhparam = File.join(supermarket_ca_dir, 'dhparams.pem')\n     36: \n     37:   # Generate dhparams.pem for perfect forward secrecy\n     38:   openssl_dhparam ssl_dhparam do\n>>>  39:     key_length 2048\n     40:     generator 2\n     41:     owner 'root'\n     42:     group 'root'\n     43:     mode '0644'\n     44:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-nova-common.rb", "content": "admin_user \"nova\"", "line": 103, "detection_span": [98, 108], "with_context": "\nnot_if 'test $(getent passwd nova |cut -f7 -d:) = /bin/sh'\nend\n100:\n101: dsh_group \"nova\" do\n102:   user \"nova\"\n103:   admin_user \"nova\"\n104:   group \"nova\"\n105: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-common.rb\n# Target line: 103\n\n     98:   not_if 'test $(getent passwd nova |cut -f7 -d:) = /bin/sh'\n     99: end\n    100: \n    101: dsh_group \"nova\" do\n    102:   user \"nova\"\n>>> 103:   admin_user \"nova\"\n    104:   group \"nova\"\n    105: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb", "content": "recaptcha_public_key \"6LflIQATAAAAAMXyDWpba-FgipVzE-aGF4HIR59N\"", "line": 44, "detection_span": [39, 49], "with_context": "\nlogo \"/w/skins/OSMFoundation/img/logo.png\"\nemail_contact \"webmaster@openstreetmap.org\"\nemail_sender \"webmaster@openstreetmap.org\"\nemail_sender_name \"OSMF Wiki\"\nprivate_accounts true\n44:   recaptcha_public_key \"6LflIQATAAAAAMXyDWpba-FgipVzE-aGF4HIR59N\"\nrecaptcha_private_key passwords[\"wiki\"][\"recaptcha\"]\nextra_file_extensions [\"mp3\"]\nversion \"1.37\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb\n# Target line: 44\n\n     39:   logo \"/w/skins/OSMFoundation/img/logo.png\"\n     40:   email_contact \"webmaster@openstreetmap.org\"\n     41:   email_sender \"webmaster@openstreetmap.org\"\n     42:   email_sender_name \"OSMF Wiki\"\n     43:   private_accounts true\n>>>  44:   recaptcha_public_key \"6LflIQATAAAAAMXyDWpba-FgipVzE-aGF4HIR59N\"\n     45:   recaptcha_private_key passwords[\"wiki\"][\"recaptcha\"]\n     46:   extra_file_extensions [\"mp3\"]\n     47:   version \"1.37\"\n     48: end\n     49: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_tomcat-recipes-setup_server_6.rb", "content": "node[:app][:user] = \"tomcat6\"", "line": 19, "detection_span": [14, 24], "with_context": "\nlog \"  Setting tomcat version to #{version}\"\n\n# Defining appplication user and group attributes depending on platform\ncase node[:platform]\nwhen \"ubuntu\"\n19:   node[:app][:user] = \"tomcat6\"\nnode[:app][:group] = \"tomcat6\"\nnode[:app_tomcat][:configuration_file_path] = \"/etc/default/tomcat#{version}\"\nif node[:platform_version] == \"10.04\"\nnode[:app_tomcat][:jkworkersfile] = \"/etc/tomcat#{version}/workers.properties\"\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_tomcat-recipes-setup_server_6.rb\n# Target line: 19\n\n     14: log \"  Setting tomcat version to #{version}\"\n     15: \n     16: # Defining appplication user and group attributes depending on platform\n     17: case node[:platform]\n     18: when \"ubuntu\"\n>>>  19:   node[:app][:user] = \"tomcat6\"\n     20:   node[:app][:group] = \"tomcat6\"\n     21:   node[:app_tomcat][:configuration_file_path] = \"/etc/default/tomcat#{version}\"\n     22:   if node[:platform_version] == \"10.04\"\n     23:     node[:app_tomcat][:jkworkersfile] = \"/etc/tomcat#{version}/workers.properties\"\n     24:   else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-diamond-attributes-default.rb", "content": "default['diamond']['mysqlhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 3306, \"username\" => nil, \"password\" => nil, \"database\" => \"diamond\", \"table\" => \"metrics\", \"col_time\" => \"timestamp\", \"col_metric\" => \"metric\", \"col_value\" => \"value\" }", "line": 28, "detection_span": [23, 33], "with_context": "\ndefault['diamond']['graphite_handler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2003, \"batch\" => 256, \"timeout\" => 15 }\ndefault['diamond']['graphite_picklehandler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2004, \"batch\" => 256, \"timeout\" => 15 }\ndefault['diamond']['statsdhandler'][0] = { \"host\" => \"iad-statsd101.ihr\", \"port\" => 8125 }\ndefault['diamond']['statsdhandler'][1] = { \"host\" => \"iad-statsd102.ihr\", \"port\" => 8125 }\ndefault['diamond']['tsdbhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 4242, \"timeout\" => 15 }\n28: default['diamond']['mysqlhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 3306, \"username\" => nil, \"password\" => nil, \"database\" => \"diamond\", \"table\" => \"metrics\", \"col_time\" => \"timestamp\", \"col_metric\" => \"metric\", \"col_value\" => \"value\" }\ndefault['diamond']['collectors'] = { \"hostname_method\" => \"smart\", \"hostname\" => nil, \"path_prefix\" => nil, \"path_suffix\" => nil, \"interval\" => 60 }\n\ndefault['diamond']['force_install'] = false\ndefault['diamond']['add_collectors'] = ['cpu', 'diskspace', 'diskusage', 'loadavg', 'memory', 'sockstat', 'vmstat', 'network']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-diamond-attributes-default.rb\n# Target line: 28\n\n     23: default['diamond']['graphite_handler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2003, \"batch\" => 256, \"timeout\" => 15 }\n     24: default['diamond']['graphite_picklehandler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2004, \"batch\" => 256, \"timeout\" => 15 }\n     25: default['diamond']['statsdhandler'][0] = { \"host\" => \"iad-statsd101.ihr\", \"port\" => 8125 }\n     26: default['diamond']['statsdhandler'][1] = { \"host\" => \"iad-statsd102.ihr\", \"port\" => 8125 }\n     27: default['diamond']['tsdbhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 4242, \"timeout\" => 15 }\n>>>  28: default['diamond']['mysqlhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 3306, \"username\" => nil, \"password\" => nil, \"database\" => \"diamond\", \"table\" => \"metrics\", \"col_time\" => \"timestamp\", \"col_metric\" => \"metric\", \"col_value\" => \"value\" }\n     29: default['diamond']['collectors'] = { \"hostname_method\" => \"smart\", \"hostname\" => nil, \"path_prefix\" => nil, \"path_suffix\" => nil, \"interval\" => 60 }\n     30: \n     31: default['diamond']['force_install'] = false\n     32: default['diamond']['add_collectors'] = ['cpu', 'diskspace', 'diskusage', 'loadavg', 'memory', 'sockstat', 'vmstat', 'network']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~delete_target_ssl_proxy.rb", "content": "certificate '-----BEGIN CERTIFICATE-----", "line": 106, "detection_span": [101, 111], "with_context": "\n101: gcompute_ssl_certificate 'chef-e2e-sample-certificate' do\n102:   action :create\n103:   description 'A certificate for test purposes only.'\n104:   project ENV['PROJECT'] # ex: 'my-test-project'\n105:   credential 'mycred'\n106:   certificate '-----BEGIN CERTIFICATE-----\n107: MIICqjCCAk+gAwIBAgIJAIuJ+0352Kq4MAoGCCqGSM49BAMCMIGwMQswCQYDVQQG\n108: EwJVUzETMBEGA1UECAwKV2FzaGluZ3RvbjERMA8GA1UEBwwIS2lya2xhbmQxFTAT\n109: BgNVBAoMDEdvb2dsZSwgSW5jLjEeMBwGA1UECwwVR29vZ2xlIENsb3VkIFBsYXRm\n110: b3JtMR8wHQYDVQQDDBZ3d3cubXktc2VjdXJlLXNpdGUuY29tMSEwHwYJKoZIhvcN\n111: AQkBFhJuZWxzb25hQGdvb2dsZS5jb20wHhcNMTcwNjI4MDQ1NjI2WhcNMjcwNjI2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~delete_target_ssl_proxy.rb\n# Target line: 106\n\n    101: gcompute_ssl_certificate 'chef-e2e-sample-certificate' do\n    102:   action :create\n    103:   description 'A certificate for test purposes only.'\n    104:   project ENV['PROJECT'] # ex: 'my-test-project'\n    105:   credential 'mycred'\n>>> 106:   certificate '-----BEGIN CERTIFICATE-----\n    107: MIICqjCCAk+gAwIBAgIJAIuJ+0352Kq4MAoGCCqGSM49BAMCMIGwMQswCQYDVQQG\n    108: EwJVUzETMBEGA1UECAwKV2FzaGluZ3RvbjERMA8GA1UEBwwIS2lya2xhbmQxFTAT\n    109: BgNVBAoMDEdvb2dsZSwgSW5jLjEeMBwGA1UECwwVR29vZ2xlIENsb3VkIFBsYXRm\n    110: b3JtMR8wHQYDVQQDDBZ3d3cubXktc2VjdXJlLXNpdGUuY29tMSEwHwYJKoZIhvcN\n    111: AQkBFhJuZWxzb25hQGdvb2dsZS5jb20wHhcNMTcwNjI4MDQ1NjI2WhcNMjcwNjI2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-postgresql-resources-user.rb", "content": "password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"", "line": 35, "detection_span": [30, 40], "with_context": "\nproperty :createdb, :kind_of => [TrueClass, FalseClass], :default => false\nproperty :createrole, :kind_of => [TrueClass, FalseClass], :default => false\nproperty :replication, :kind_of => [TrueClass, FalseClass], :default => false\n\naction :create do\n35:   password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\nsuperuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\ncreatedb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\ncreaterole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\nreplication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-postgresql-resources-user.rb\n# Target line: 35\n\n     30: property :createdb, :kind_of => [TrueClass, FalseClass], :default => false\n     31: property :createrole, :kind_of => [TrueClass, FalseClass], :default => false\n     32: property :replication, :kind_of => [TrueClass, FalseClass], :default => false\n     33: \n     34: action :create do\n>>>  35:   password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\n     36:   superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\n     37:   createdb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\n     38:   createrole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\n     39:   replication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sensu_sensu-chef-recipes-_windows.rb", "content": "password Sensu::Helpers.random_password(20, true, true, true, true)", "line": 41, "detection_span": [36, 46], "with_context": "\nelsif node['platform_version'].to_f == 10.0\nversion = '2016'\nend\n\nuser node[\"sensu\"][\"user\"] do\n41:   password Sensu::Helpers.random_password(20, true, true, true, true)\nnot_if { Sensu::Helpers.windows_user_exists?(node[\"sensu\"][\"user\"]) }\nend\n\ngroup node[\"sensu\"][\"group\"] do\nmembers node[\"sensu\"][\"user\"]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sensu_sensu-chef-recipes-_windows.rb\n# Target line: 41\n\n     36: elsif node['platform_version'].to_f == 10.0\n     37:   version = '2016'\n     38: end\n     39: \n     40: user node[\"sensu\"][\"user\"] do\n>>>  41:   password Sensu::Helpers.random_password(20, true, true, true, true)\n     42:   not_if { Sensu::Helpers.windows_user_exists?(node[\"sensu\"][\"user\"]) }\n     43: end\n     44: \n     45: group node[\"sensu\"][\"group\"] do\n     46:   members node[\"sensu\"][\"user\"]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-base-recipes-ssh_keys.rb", "content": "node.set[:resolved_ssh_keys][user] = [] unless node.resolved_ssh_keys[user]", "line": 22, "detection_span": [17, 27], "with_context": "\nconfig[\"optional_users\"].each do |user|\nusers << user if get_home(user, true) && !users.include?(user)\nend\nend\nusers.each do |user|\n22:           node.set[:resolved_ssh_keys][user] = [] unless node.resolved_ssh_keys[user]\nnode.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + config[\"keys\"] if config[\"keys\"]\nif config[\"ref\"]\nconfig[\"ref\"].each do |k|\nnode.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + node.ssh_keys[k][\"keys\"]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-base-recipes-ssh_keys.rb\n# Target line: 22\n\n     17:           config[\"optional_users\"].each do |user|\n     18:             users << user if get_home(user, true) && !users.include?(user)\n     19:           end\n     20:         end\n     21:         users.each do |user|\n>>>  22:           node.set[:resolved_ssh_keys][user] = [] unless node.resolved_ssh_keys[user]\n     23:           node.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + config[\"keys\"] if config[\"keys\"]\n     24:           if config[\"ref\"]\n     25:             config[\"ref\"].each do |k|\n     26:               node.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + node.ssh_keys[k][\"keys\"]\n     27:             end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_rsync-attributes-default.rb", "content": "default['imos_rsync']['user'] = 'rsync'", "line": 13, "detection_span": [8, 18], "with_context": "\n# Logging directory\ndefault['imos_rsync']['log_dir']      = \"/var/log/rsyncd\"\ndefault['imos_rsync']['incoming_dir'] = \"/var/lib/incoming\"\n\n# User for chroot rsync uploads\n13: default['imos_rsync']['user'] = 'rsync'\n# Be part of 'users' group so you rsync_chroot can share directories with FTP\ndefault['imos_rsync']['group'] = 'users'\n\n# Create or not destination directories for imos_rsync::chroot. Usually\n# ftp_dir_tree will create them", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_rsync-attributes-default.rb\n# Target line: 13\n\n      8: # Logging directory\n      9: default['imos_rsync']['log_dir']      = \"/var/log/rsyncd\"\n     10: default['imos_rsync']['incoming_dir'] = \"/var/lib/incoming\"\n     11: \n     12: # User for chroot rsync uploads\n>>>  13: default['imos_rsync']['user'] = 'rsync'\n     14: # Be part of 'users' group so you rsync_chroot can share directories with FTP\n     15: default['imos_rsync']['group'] = 'users'\n     16: \n     17: # Create or not destination directories for imos_rsync::chroot. Usually\n     18: # ftp_dir_tree will create them\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb", "content": "params[:svn_password] = nil", "line": 61, "detection_span": [56, 66], "with_context": "\nenable_submodules = false\nelse\nscm_prov = Chef::Provider::Git\nsvn_args = nil\nparams[:svn_username] = nil\n61:     params[:svn_password] = nil\nenable_submodules = true\nend\n\nlog \"  Capistrano deployment will use #{scm_prov} for initialization\"\n# Creating capistrano deployment", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb\n# Target line: 61\n\n     56:     enable_submodules = false\n     57:   else\n     58:     scm_prov = Chef::Provider::Git\n     59:     svn_args = nil\n     60:     params[:svn_username] = nil\n>>>  61:     params[:svn_password] = nil\n     62:     enable_submodules = true\n     63:   end\n     64: \n     65:   log \"  Capistrano deployment will use #{scm_prov} for initialization\"\n     66:   # Creating capistrano deployment\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_keystone-providers-service.rb", "content": "service_key = \"type\"", "line": 102, "detection_span": [97, 107], "with_context": "\n# Construct the extension path\npath = \"/#{api_ver}/OS-KSADM/services\"\n\n100:   # lookup service_uuid\n101:   service_container = \"OS-KSADM:services\"\n102:   service_key = \"type\"\n103:   service_path = \"/#{api_ver}/OS-KSADM/services\"\n104:   service_uuid, service_error = find_value(http, service_path, headers, service_container, service_key, svc_type, 'id')\n105:   Chef::Log.error(\"There was an error looking up Service '#{svc_type}'\") if service_error\n106:\n107:   # See if the service exists yet", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_keystone-providers-service.rb\n# Target line: 102\n\n     97:   # Construct the extension path\n     98:   path = \"/#{api_ver}/OS-KSADM/services\"\n     99: \n    100:   # lookup service_uuid\n    101:   service_container = \"OS-KSADM:services\"\n>>> 102:   service_key = \"type\"\n    103:   service_path = \"/#{api_ver}/OS-KSADM/services\"\n    104:   service_uuid, service_error = find_value(http, service_path, headers, service_container, service_key, svc_type, 'id')\n    105:   Chef::Log.error(\"There was an error looking up Service '#{svc_type}'\") if service_error\n    106: \n    107:   # See if the service exists yet\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-resource_manager.rb", "content": "user \"mapred\"", "line": 85, "detection_span": [80, 90], "with_context": "\nsubscribes :restart, \"template[/etc/hadoop/conf/yarn-site.xml]\", :delayed\nend\n\nbash \"reload mapreduce nodes\" do\ncode \"yarn rmadmin -refreshNodes\"\n85:   user \"mapred\"\naction :nothing\nsubscribes :run, \"template[/etc/hadoop/conf/yarn.exclude]\", :delayed\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-resource_manager.rb\n# Target line: 85\n\n     80:   subscribes :restart, \"template[/etc/hadoop/conf/yarn-site.xml]\", :delayed\n     81: end\n     82: \n     83: bash \"reload mapreduce nodes\" do\n     84:   code \"yarn rmadmin -refreshNodes\"\n>>>  85:   user \"mapred\"\n     86:   action :nothing\n     87:   subscribes :run, \"template[/etc/hadoop/conf/yarn.exclude]\", :delayed\n     88: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-recipes-undeploy.rb", "content": "user node['deployer']['user'] || 'root'", "line": 21, "detection_span": [16, 26], "with_context": "\n\nfire_hook(:before_undeploy, items: databases + [source, framework, appserver, worker, webserver])\n\ndeploy application['shortname'] do\ndeploy_to deploy_dir(application)\n21:     user node['deployer']['user'] || 'root'\ngroup www_group\n\n[appserver, webserver].each do |server|\nserver.notifies[:undeploy].each do |config|\nnotifies config[:action],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-recipes-undeploy.rb\n# Target line: 21\n\n     16: \n     17:   fire_hook(:before_undeploy, items: databases + [source, framework, appserver, worker, webserver])\n     18: \n     19:   deploy application['shortname'] do\n     20:     deploy_to deploy_dir(application)\n>>>  21:     user node['deployer']['user'] || 'root'\n     22:     group www_group\n     23: \n     24:     [appserver, webserver].each do |server|\n     25:       server.notifies[:undeploy].each do |config|\n     26:         notifies config[:action],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-recipes-bootstrap.rb", "content": "user  'vagrant'", "line": 61, "detection_span": [56, 66], "with_context": "\nbash 'Update chef-bcpc-repo rights' do\ncode 'setfacl -R -m g:vagrant:rwX /home/vagrant/chef-bcpc-repo; find /home/vagrant/chef-bcpc-repo -type d | xargs setfacl -R -m d:g:vagrant:rwX'\nend\n\ncron 'synchronize chef' do\n61:   user  'vagrant'\nhome '/home/vagrant'\ncommand \"cd ~/chef-bcpc; git pull local master; knife role from file roles/*.json; knife cookbook upload -a; knife environment from file environments/#{node.chef_environment}.json\"\nend\n\npackage 'sshpass'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-recipes-bootstrap.rb\n# Target line: 61\n\n     56: bash 'Update chef-bcpc-repo rights' do\n     57:   code 'setfacl -R -m g:vagrant:rwX /home/vagrant/chef-bcpc-repo; find /home/vagrant/chef-bcpc-repo -type d | xargs setfacl -R -m d:g:vagrant:rwX'\n     58: end\n     59: \n     60: cron 'synchronize chef' do\n>>>  61:   user  'vagrant'\n     62:   home '/home/vagrant'\n     63:   command \"cd ~/chef-bcpc; git pull local master; knife role from file roles/*.json; knife cookbook upload -a; knife environment from file environments/#{node.chef_environment}.json\"\n     64: end\n     65: \n     66: package 'sshpass'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-flume-attributes-default.rb", "content": "default[:flume][:user]                = 'flume'", "line": 27, "detection_span": [22, 32], "with_context": "\ndefault[:flume][:agent ][:file_limit] = 65536\ndefault[:flume][:master][:file_limit] = 65536\n\ndefault[:flume][:zk]                  = Mash.new\ndefault[:flume][:collector]           = Mash.new\n27: default[:flume][:user]                = 'flume'\n\ndefault[:users ]['flume'][:uid]       = 325\ndefault[:groups]['flume'][:gid]       = 325\n\n# these are set by the recipes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-pig-cookbooks-flume-attributes-default.rb\n# Target line: 27\n\n     22: default[:flume][:agent ][:file_limit] = 65536\n     23: default[:flume][:master][:file_limit] = 65536\n     24: \n     25: default[:flume][:zk]                  = Mash.new\n     26: default[:flume][:collector]           = Mash.new\n>>>  27: default[:flume][:user]                = 'flume'\n     28: \n     29: default[:users ]['flume'][:uid]       = 325\n     30: default[:groups]['flume'][:gid]       = 325\n     31: \n     32: # these are set by the recipes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-users.rb", "content": "password '$1$gkl9sSWg$U9aIhckrcXwr08PLbx7NG1'", "line": 27, "detection_span": [22, 32], "with_context": "\ncomment 'osm data'\nuid '1201'\ngid 'osmdata'\nshell '/bin/bash'\nhome '/home/osmdata'\n27:   password '$1$gkl9sSWg$U9aIhckrcXwr08PLbx7NG1'\nsystem false\naction :create\nnot_if \"getent passwd osmdata\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-users.rb\n# Target line: 27\n\n     22:   comment 'osm data'\n     23:   uid '1201'\n     24:   gid 'osmdata'\n     25:   shell '/bin/bash'\n     26:   home '/home/osmdata'\n>>>  27:   password '$1$gkl9sSWg$U9aIhckrcXwr08PLbx7NG1'\n     28:   system false\n     29:   action :create\n     30:   not_if \"getent passwd osmdata\"\n     31: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-bootstrap.rb", "content": "pivotal_key_path = \"/etc/opscode/pivotal.pem\"", "line": 26, "detection_span": [21, 31], "with_context": "\nnode['private_chef']['topology'] == \"standalone\" &&\nnode['private_chef']['addons']['install'])\ninclude_recipe \"private-chef::add_ons_wrapper\"\nend\n\n26: pivotal_key_path = \"/etc/opscode/pivotal.pem\"\nif File.exists?(pivotal_key_path)\npivotal_key = OpenSSL::PKey::RSA.new(File.read(pivotal_key_path))\nelse\npivotal_key = OpenSSL::PKey::RSA.generate(2048)\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-bootstrap.rb\n# Target line: 26\n\n     21:     node['private_chef']['topology'] == \"standalone\" &&\n     22:     node['private_chef']['addons']['install'])\n     23:   include_recipe \"private-chef::add_ons_wrapper\"\n     24: end\n     25: \n>>>  26: pivotal_key_path = \"/etc/opscode/pivotal.pem\"\n     27: if File.exists?(pivotal_key_path)\n     28:   pivotal_key = OpenSSL::PKey::RSA.new(File.read(pivotal_key_path))\n     29: else\n     30:   pivotal_key = OpenSSL::PKey::RSA.generate(2048)\n     31: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-elasticsearchnew-attributes-default.rb", "content": "default[:elasticsearchnew][:user] = \"elasticsearch\"", "line": 18, "detection_span": [13, 23], "with_context": "\ndefault[:elasticsearchnew][:deploy_path] = \"/data/apps/elasticsearch\"\ndefault[:elasticsearchnew][:ihrsearch_path] = \"/data/apps/ihr-search\"\ndefault[:elasticsearchnew][:input_path] = \"/data/apps/ihr-search/input\"\ndefault[:elasticsearchnew][:config_path] = \"/data/apps/ihr-search/configs\"\ndefault[:elasticsearchnew][:ihrsearch][:files] = \"configs.tar.gz\"\n18: default[:elasticsearchnew][:user] = \"elasticsearch\"\ndefault[:elasticsearchnew][:group] = \"elasticsearch\"\n# For NFS server\ndefault[:elasticsearchnew][:backup_server] = \"iad-nfs101.ihr\"\ndefault[:elasticsearchnew][:backup_target] = \"/data/backups/elasticsearch\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-elasticsearchnew-attributes-default.rb\n# Target line: 18\n\n     13: default[:elasticsearchnew][:deploy_path] = \"/data/apps/elasticsearch\"\n     14: default[:elasticsearchnew][:ihrsearch_path] = \"/data/apps/ihr-search\"\n     15: default[:elasticsearchnew][:input_path] = \"/data/apps/ihr-search/input\"\n     16: default[:elasticsearchnew][:config_path] = \"/data/apps/ihr-search/configs\"\n     17: default[:elasticsearchnew][:ihrsearch][:files] = \"configs.tar.gz\"\n>>>  18: default[:elasticsearchnew][:user] = \"elasticsearch\"\n     19: default[:elasticsearchnew][:group] = \"elasticsearch\"\n     20: # For NFS server\n     21: default[:elasticsearchnew][:backup_server] = \"iad-nfs101.ihr\"\n     22: default[:elasticsearchnew][:backup_target] = \"/data/backups/elasticsearch\"\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jboss-attributes-default.rb", "content": "default['jboss']['jdbc']['user'] = 'sa'", "line": 22, "detection_span": [17, 27], "with_context": "\ndefault['jboss']['application'] = 'jboss'\ndefault['jboss']['config'] = 'standalone'\ndefault['jboss']['script'] = 'standalone.sh'\ndefault['jboss']['manage_config_file'] = true\n\n22: default['jboss']['jdbc']['user'] = 'sa'\ndefault['jboss']['jdbc']['passwd'] = ''\ndefault['jboss']['jdbc']['schema'] = ''\ndefault['jboss']['jdbc']['host'] = 'localhost'\ndefault['jboss']['jdbc']['transaction_isolation'] = nil\ndefault['jboss']['jdbc']['driver']['name'] = 'h2'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jboss-attributes-default.rb\n# Target line: 22\n\n     17: default['jboss']['application'] = 'jboss'\n     18: default['jboss']['config'] = 'standalone'\n     19: default['jboss']['script'] = 'standalone.sh'\n     20: default['jboss']['manage_config_file'] = true\n     21: \n>>>  22: default['jboss']['jdbc']['user'] = 'sa'\n     23: default['jboss']['jdbc']['passwd'] = ''\n     24: default['jboss']['jdbc']['schema'] = ''\n     25: default['jboss']['jdbc']['host'] = 'localhost'\n     26: default['jboss']['jdbc']['transaction_isolation'] = nil\n     27: default['jboss']['jdbc']['driver']['name'] = 'h2'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jenkins-attributes-node.rb", "content": "default['jenkins']['node']['user'] = \"jenkins-node\"", "line": 37, "detection_span": [32, 42], "with_context": "\nelse\ndefault['jenkins']['node']['home'] = \"/data/jenkins\"\ndefault['jenkins']['node']['log_dir']  = \"/var/log/jenkins\"\nend\n\n37: default['jenkins']['node']['user'] = \"jenkins-node\"\ndefault['jenkins']['node']['group'] = \"jenkins-node\"\ndefault['jenkins']['node']['name'] = node['fqdn']\ndefault['jenkins']['node']['description'] =\n\"#{node['platform']} #{node['platform_version']} \" <<\n\"[#{node['kernel']['os']} #{node['kernel']['release']} #{node['kernel']['machine']}] \" <<", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-attributes-node.rb\n# Target line: 37\n\n     32: else\n     33:   default['jenkins']['node']['home'] = \"/data/jenkins\"\n     34:   default['jenkins']['node']['log_dir']  = \"/var/log/jenkins\"\n     35: end\n     36: \n>>>  37: default['jenkins']['node']['user'] = \"jenkins-node\"\n     38: default['jenkins']['node']['group'] = \"jenkins-node\"\n     39: default['jenkins']['node']['name'] = node['fqdn']\n     40: default['jenkins']['node']['description'] =\n     41:   \"#{node['platform']} #{node['platform_version']} \" <<\n     42:   \"[#{node['kernel']['os']} #{node['kernel']['release']} #{node['kernel']['machine']}] \" <<\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb", "content": "key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"", "line": 49, "detection_span": [44, 54], "with_context": "\n# because there are very useful features in the newer versions\napt_repository \"rabbitmq\" do\nuri \"http://www.rabbitmq.com/debian/\"\ndistribution \"testing\"\ncomponents [\"main\"]\n49:     key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\naction :add\nend\npackage \"rabbitmq-server\"\nwhen \"redhat\", \"centos\", \"scientific\"\nremote_file \"/tmp/rabbitmq-server-2.6.1-1.noarch.rpm\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb\n# Target line: 49\n\n     44:   # because there are very useful features in the newer versions\n     45:   apt_repository \"rabbitmq\" do\n     46:     uri \"http://www.rabbitmq.com/debian/\"\n     47:     distribution \"testing\"\n     48:     components [\"main\"]\n>>>  49:     key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\n     50:     action :add\n     51:   end\n     52:   package \"rabbitmq-server\"\n     53: when \"redhat\", \"centos\", \"scientific\"\n     54:   remote_file \"/tmp/rabbitmq-server-2.6.1-1.noarch.rpm\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jahumes_RailsChef-vendor-cookbooks-backups-recipes-default.rb", "content": "deploy_user = backup_node[:deploy_user] || \"deploy\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n\nbackup_node = node[:backups]\n\nif backup_node\n22:   deploy_user = backup_node[:deploy_user] || \"deploy\"\n\npackage \"ruby1.9.1-dev\"\npackage \"libxml2-dev\"\npackage \"libxslt-dev\"\ngem_package \"backup\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jahumes_RailsChef-vendor-cookbooks-backups-recipes-default.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: \n     19: backup_node = node[:backups]\n     20: \n     21: if backup_node\n>>>  22:   deploy_user = backup_node[:deploy_user] || \"deploy\"\n     23: \n     24:   package \"ruby1.9.1-dev\"\n     25:   package \"libxml2-dev\"\n     26:   package \"libxslt-dev\"\n     27:   gem_package \"backup\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_webserver_base.rb", "content": "extensions = { private_key: 'key', certificate: 'crt', chain: 'ca' }", "line": 54, "detection_span": [49, 59], "with_context": "\n\ndef add_ssl_item(name)\nkey_data = app[:ssl_configuration].try(:[], name)\nreturn if key_data.blank?\n\n54:         extensions = { private_key: 'key', certificate: 'crt', chain: 'ca' }\n\nnotifying_template \"#{ssl_cert_dir}/#{app[:domains].first}.#{extensions[name]}\" do\nowner 'root'\ngroup 'root'\nmode name == :private_key ? '0600' : '0644'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_webserver_base.rb\n# Target line: 54\n\n     49: \n     50:       def add_ssl_item(name)\n     51:         key_data = app[:ssl_configuration].try(:[], name)\n     52:         return if key_data.blank?\n     53: \n>>>  54:         extensions = { private_key: 'key', certificate: 'crt', chain: 'ca' }\n     55: \n     56:         notifying_template \"#{ssl_cert_dir}/#{app[:domains].first}.#{extensions[name]}\" do\n     57:           owner 'root'\n     58:           group 'root'\n     59:           mode name == :private_key ? '0600' : '0644'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_set_preferred_view_style.rb", "content": "key 'FXPreferredViewStyle'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Update Finder windows to use by default\" do\ndomain 'com.apple.finder'\n3:   key 'FXPreferredViewStyle'\nstring node['osxdefaults']['finder']['preferred_view_style']\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_set_preferred_view_style.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Update Finder windows to use by default\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'FXPreferredViewStyle'\n      4:   string node['osxdefaults']['finder']['preferred_view_style']\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-supervisor-attributes-default.rb", "content": "default['supervisor']['inet_username'] = nil", "line": 23, "detection_span": [18, 28], "with_context": "\n#\n\ndefault['supervisor']['unix_http_server']['chmod'] = '700'\ndefault['supervisor']['unix_http_server']['chown'] = 'root:root'\ndefault['supervisor']['inet_port'] = nil\n23: default['supervisor']['inet_username'] = nil\ndefault['supervisor']['inet_password'] = nil\ncase node['platform_family']\nwhen 'smartos'\ndefault['supervisor']['dir'] = '/opt/local/etc/supervisor.d'\ndefault['supervisor']['conffile'] = '/opt/local/etc/supervisord.conf'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-supervisor-attributes-default.rb\n# Target line: 23\n\n     18: #\n     19: \n     20: default['supervisor']['unix_http_server']['chmod'] = '700'\n     21: default['supervisor']['unix_http_server']['chown'] = 'root:root'\n     22: default['supervisor']['inet_port'] = nil\n>>>  23: default['supervisor']['inet_username'] = nil\n     24: default['supervisor']['inet_password'] = nil\n     25: case node['platform_family']\n     26: when 'smartos'\n     27:   default['supervisor']['dir'] = '/opt/local/etc/supervisor.d'\n     28:   default['supervisor']['conffile'] = '/opt/local/etc/supervisord.conf'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-chef-server-attributes-default.rb", "content": "default['chef_server']['amqp_pass']       = 'testing'", "line": 80, "detection_span": [75, 85], "with_context": "\ndefault['chef_server']['webui_port']      = \"4040\"\ndefault['chef_server']['webui_enabled']   = false\ndefault['chef_server']['solr_heap_size']  = \"256M\"\ndefault['chef_server']['validation_client_name'] = \"chef-validator\"\ndefault['chef_server']['expander_nodes']  = 1\n80: default['chef_server']['amqp_pass']       = 'testing'\ndefault['chef_server']['user']            = 'chef'\ndefault['chef_server']['user_manage_action'] = 'create'\ndefault['chef_server']['user_shell']      = '/bin/sh'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-chef-server-attributes-default.rb\n# Target line: 80\n\n     75: default['chef_server']['webui_port']      = \"4040\"\n     76: default['chef_server']['webui_enabled']   = false\n     77: default['chef_server']['solr_heap_size']  = \"256M\"\n     78: default['chef_server']['validation_client_name'] = \"chef-validator\"\n     79: default['chef_server']['expander_nodes']  = 1\n>>>  80: default['chef_server']['amqp_pass']       = 'testing'\n     81: default['chef_server']['user']            = 'chef'\n     82: default['chef_server']['user_manage_action'] = 'create'\n     83: default['chef_server']['user_shell']      = '/bin/sh'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-etl_jobs-attributes-default.rb", "content": "default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"", "line": 36, "detection_span": [31, 41], "with_context": "\ndefault[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\ndefault[:etl][:event_job][:log_directory] = \"/data/log/event\"\nelse\ndefault[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://iad-dwh.prod.ihr:1433;databaseName=IHRDWH\"\ndefault[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\n36:   default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\ndefault[:etl][:event_job][:archive_directory] = \"/isilon/event/processed\"\ndefault[:etl][:event_job][:source_directory] = \"/isilon/event/\"\ndefault[:etl][:event_job][:log_directory] = \"/isilon/event/\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-etl_jobs-attributes-default.rb\n# Target line: 36\n\n     31:   default[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\n     32:   default[:etl][:event_job][:log_directory] = \"/data/log/event\"\n     33: else\n     34:   default[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://iad-dwh.prod.ihr:1433;databaseName=IHRDWH\"\n     35:   default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\n>>>  36:   default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\n     37:   default[:etl][:event_job][:archive_directory] = \"/isilon/event/processed\"\n     38:   default[:etl][:event_job][:source_directory] = \"/isilon/event/\"\n     39:   default[:etl][:event_job][:log_directory] = \"/isilon/event/\"\n     40: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-zookeeper-attributes-default.rb", "content": "default['zookeeper']['user'] = 'zookeeper'", "line": 25, "detection_span": [20, 30], "with_context": "\n# General settings\ndefault['zookeeper']['install_dir'] = '/usr/share/zookeeper'\ndefault['zookeeper']['conf_dir'] = '/etc/zookeeper'\ndefault['zookeeper']['data_dir'] = '/var/lib/zookeeper'\ndefault['zookeeper']['log_dir'] = '/var/log/zookeeper'\n25: default['zookeeper']['user'] = 'zookeeper'\ndefault['zookeeper']['tarball'] =\n'http://www.apache.si/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz'\ndefault['zookeeper']['checksum'] =\n'7f7f5414e044ac11fee2a1e0bc225469f51fb0cdf821e67df762a43098223f27'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-zookeeper-attributes-default.rb\n# Target line: 25\n\n     20: # General settings\n     21: default['zookeeper']['install_dir'] = '/usr/share/zookeeper'\n     22: default['zookeeper']['conf_dir'] = '/etc/zookeeper'\n     23: default['zookeeper']['data_dir'] = '/var/lib/zookeeper'\n     24: default['zookeeper']['log_dir'] = '/var/log/zookeeper'\n>>>  25: default['zookeeper']['user'] = 'zookeeper'\n     26: default['zookeeper']['tarball'] =\n     27:   'http://www.apache.si/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz'\n     28: default['zookeeper']['checksum'] =\n     29:   '7f7f5414e044ac11fee2a1e0bc225469f51fb0cdf821e67df762a43098223f27'\n     30: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-lb-recipes-do_attach_all.rb", "content": "node[:lb][:threshold][pool_name][uuid] = nil # Sets to nil since chef does not delete the key so we can only alter it.", "line": 84, "detection_span": [79, 89], "with_context": "\n# See cookbooks/lb_<provider>/providers/default.rb for the \"detach\" action.\nlb pool_name do\nbackend_id uuid\naction :detach\nend\n84:       node[:lb][:threshold][pool_name][uuid] = nil # Sets to nil since chef does not delete the key so we can only alter it.\napp_servers_detached += 1\nelse\nlog \"  Threshold not reached for #{uuid} : #{node[:lb][:threshold][pool_name][uuid]}\"\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-lb-recipes-do_attach_all.rb\n# Target line: 84\n\n     79:       # See cookbooks/lb_<provider>/providers/default.rb for the \"detach\" action.\n     80:       lb pool_name do\n     81:         backend_id uuid\n     82:         action :detach\n     83:       end\n>>>  84:       node[:lb][:threshold][pool_name][uuid] = nil # Sets to nil since chef does not delete the key so we can only alter it.\n     85:       app_servers_detached += 1\n     86:     else\n     87:       log \"  Threshold not reached for #{uuid} : #{node[:lb][:threshold][pool_name][uuid]}\"\n     88:     end\n     89:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['proxy_password'] = nil", "line": 75, "detection_span": [70, 80], "with_context": "\ndefault['yum']['main']['pluginpath'] = nil\ndefault['yum']['main']['plugins'] = nil # [true, false]\ndefault['yum']['main']['protected_multilib'] = nil\ndefault['yum']['main']['protected_packages'] = nil\ndefault['yum']['main']['proxy'] = nil\n75: default['yum']['main']['proxy_password'] = nil\ndefault['yum']['main']['proxy_username'] = nil\ndefault['yum']['main']['password'] = nil\ndefault['yum']['main']['recent'] = nil # /^\\d+$/\ndefault['yum']['main']['repo_gpgcheck'] = nil # [true, false]\ndefault['yum']['main']['reposdir'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-yum-attributes-main.rb\n# Target line: 75\n\n     70: default['yum']['main']['pluginpath'] = nil\n     71: default['yum']['main']['plugins'] = nil # [true, false]\n     72: default['yum']['main']['protected_multilib'] = nil\n     73: default['yum']['main']['protected_packages'] = nil\n     74: default['yum']['main']['proxy'] = nil\n>>>  75: default['yum']['main']['proxy_password'] = nil\n     76: default['yum']['main']['proxy_username'] = nil\n     77: default['yum']['main']['password'] = nil\n     78: default['yum']['main']['recent'] = nil # /^\\d+$/\n     79: default['yum']['main']['repo_gpgcheck'] = nil # [true, false]\n     80: default['yum']['main']['reposdir'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga_chef-icinga2-examples-icinga2_server-recipes-client.rb", "content": "cert_path \"\\\"#{client_crt}\\\"\"", "line": 83, "detection_span": [78, 88], "with_context": "\nendpoints [node.fqdn]\nparent 'master'\nend\n\nicinga2_apilistener node.fqdn do\n83:   cert_path \"\\\"#{client_crt}\\\"\"\nkey_path \"\\\"#{client_key}\\\"\"\nca_path \"\\\"#{master_ca}\\\"\"\nbind_port 5665\naccept_commands true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Icinga_chef-icinga2-examples-icinga2_server-recipes-client.rb\n# Target line: 83\n\n     78:   endpoints [node.fqdn]\n     79:   parent 'master'\n     80: end\n     81: \n     82: icinga2_apilistener node.fqdn do\n>>>  83:   cert_path \"\\\"#{client_crt}\\\"\"\n     84:   key_path \"\\\"#{client_key}\\\"\"\n     85:   ca_path \"\\\"#{master_ca}\\\"\"\n     86:   bind_port 5665\n     87:   accept_commands true\n     88: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "TaxiOS_zabbix-recipes-database.rb", "content": "root_username       = \"postgres\"", "line": 37, "detection_span": [32, 42], "with_context": "\nprovider = Chef::Provider::ZabbixDatabaseMySql\nwhen 'postgres'\nunless node['postgresql']['password']['postgres']\nnode.normal['postgresql']['password']['postgres'] = secure_password\nend\n37:   root_username       = \"postgres\"\nroot_password       = node['postgresql']['password']['postgres']\nprovider = Chef::Provider::ZabbixDatabasePostgres\nend\n\nzabbix_database node['zabbix']['database']['dbname'] do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: TaxiOS_zabbix-recipes-database.rb\n# Target line: 37\n\n     32:   provider = Chef::Provider::ZabbixDatabaseMySql\n     33: when 'postgres'\n     34:   unless node['postgresql']['password']['postgres']\n     35:     node.normal['postgresql']['password']['postgres'] = secure_password\n     36:   end\n>>>  37:   root_username       = \"postgres\"\n     38:   root_password       = node['postgresql']['password']['postgres'] \n     39:   provider = Chef::Provider::ZabbixDatabasePostgres\n     40: end\n     41: \n     42: zabbix_database node['zabbix']['database']['dbname'] do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-cookbooks_chef-ingredient-resources-chef_user.rb", "content": "password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))", "line": 48, "detection_span": [43, 53], "with_context": "\nmode '0700'\nrecursive true\nend\n\nkey = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\n48:   password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n\nexecute \"create-user-#{new_resource.username}\" do\nsensitive true\nretries 3\ncommand \"chef-server-ctl user-create #{new_resource.username} #{new_resource.first_name} #{new_resource.last_name} #{new_resource.email} #{password} -f #{key}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_chef-ingredient-resources-chef_user.rb\n# Target line: 48\n\n     43:     mode '0700'\n     44:     recursive true\n     45:   end\n     46: \n     47:   key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\n>>>  48:   password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n     49: \n     50:   execute \"create-user-#{new_resource.username}\" do\n     51:     sensitive true\n     52:     retries 3\n     53:     command \"chef-server-ctl user-create #{new_resource.username} #{new_resource.first_name} #{new_resource.last_name} #{new_resource.email} #{password} -f #{key}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "amitjain1975_custom-rightscale-cookbooks-app_php-attributes-default.rb", "content": "set[:app_php][:user] = \"www-data\"", "line": 23, "detection_span": [18, 28], "with_context": "\n# Calculated attributes\n# Defining apache user, module dependencies, and database adapter parameters depending on platform.\ncase platform\nwhen \"ubuntu\"\nset[:app_php][:module_dependencies] = [ \"proxy_http\", \"php5\" ]\n23:   set[:app_php][:user] = \"www-data\"\nset[:app_php][:group] = \"www-data\"\nif app_php[:db_adapter] == \"mysql\"\nset[:db][:socket] = \"/var/run/mysqld/mysqld.sock\"\nelsif app_php[:db_adapter] == \"postgresql\"\nset[:db][:socket] = \"/var/run/postgresql\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-app_php-attributes-default.rb\n# Target line: 23\n\n     18: # Calculated attributes\n     19: # Defining apache user, module dependencies, and database adapter parameters depending on platform.\n     20: case platform\n     21: when \"ubuntu\"\n     22:   set[:app_php][:module_dependencies] = [ \"proxy_http\", \"php5\" ]\n>>>  23:   set[:app_php][:user] = \"www-data\"\n     24:   set[:app_php][:group] = \"www-data\"\n     25:   if app_php[:db_adapter] == \"mysql\"\n     26:     set[:db][:socket] = \"/var/run/mysqld/mysqld.sock\"\n     27:   elsif app_php[:db_adapter] == \"postgresql\"\n     28:     set[:db][:socket] = \"/var/run/postgresql\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_cookbook-openstack-compute-recipes-placement_api.rb", "content": "db_pass = get_password 'db', 'placement'", "line": 44, "detection_span": [39, 49], "with_context": "\nsupports status: true, restart: true\naction [:disable, :stop]\nend\n\ndb_user = node['openstack']['db']['placement']['username']\n44: db_pass = get_password 'db', 'placement'\nidentity_endpoint = internal_endpoint 'identity'\nauth_url = identity_endpoint.to_s\n\nnode.default['openstack']['placement']['conf_secrets']\n.[]('placement_database')['connection'] =", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-compute-recipes-placement_api.rb\n# Target line: 44\n\n     39:   supports status: true, restart: true\n     40:   action [:disable, :stop]\n     41: end\n     42: \n     43: db_user = node['openstack']['db']['placement']['username']\n>>>  44: db_pass = get_password 'db', 'placement'\n     45: identity_endpoint = internal_endpoint 'identity'\n     46: auth_url = identity_endpoint.to_s\n     47: \n     48: node.default['openstack']['placement']['conf_secrets']\n     49:   .[]('placement_database')['connection'] =\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-heat_conf.rb", "content": "default['openstack']['orchestration']['conf']['keystone_authtoken']['username'] = 'heat'", "line": 27, "detection_span": [22, 32], "with_context": "\ndefault['openstack']['orchestration']['conf']['DEFAULT']['stack_domain_admin'] = 'heat_domain_admin'\ndefault['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name'] = 'heat'\ndefault['openstack']['orchestration']['conf']['oslo_messaging_notifications']['driver'] =\n'heat.openstack.common.notifier.rpc_notifier'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['auth_type'] = 'v3password'\n27: default['openstack']['orchestration']['conf']['keystone_authtoken']['username'] = 'heat'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['project_name'] = 'service'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['project_domain_name'] = 'Default'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name'] = 'Default'\ndefault['openstack']['orchestration']['conf']['trustee']['auth_type'] = 'v3password'\ndefault['openstack']['orchestration']['conf']['trustee']['username'] = 'heat'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-heat_conf.rb\n# Target line: 27\n\n     22: default['openstack']['orchestration']['conf']['DEFAULT']['stack_domain_admin'] = 'heat_domain_admin'\n     23: default['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name'] = 'heat'\n     24: default['openstack']['orchestration']['conf']['oslo_messaging_notifications']['driver'] =\n     25:   'heat.openstack.common.notifier.rpc_notifier'\n     26: default['openstack']['orchestration']['conf']['keystone_authtoken']['auth_type'] = 'v3password'\n>>>  27: default['openstack']['orchestration']['conf']['keystone_authtoken']['username'] = 'heat'\n     28: default['openstack']['orchestration']['conf']['keystone_authtoken']['project_name'] = 'service'\n     29: default['openstack']['orchestration']['conf']['keystone_authtoken']['project_domain_name'] = 'Default'\n     30: default['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name'] = 'Default'\n     31: default['openstack']['orchestration']['conf']['trustee']['auth_type'] = 'v3password'\n     32: default['openstack']['orchestration']['conf']['trustee']['username'] = 'heat'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-lb-recipes-do_attach_all.rb", "content": "node[:lb][:threshold][vhost_name][uuid] = nil", "line": 62, "detection_span": [57, 67], "with_context": "\n\n# Set threshold counters to nil to those not incremented, thus assuming app server now accessable.\n# Set to nil since chef does not delete the key, can only alter it.\n(Set.new(node[:lb][:threshold][vhost_name].keys) - servers_missing).each do |uuid|\nif node[:lb][:threshold][vhost_name][uuid]\n62:       node[:lb][:threshold][vhost_name][uuid] = nil\nlog \"  Resetting threshold for #{uuid}\"\nend\nend\n\n# Delete servers that hit threshold.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-lb-recipes-do_attach_all.rb\n# Target line: 62\n\n     57: \n     58:   # Set threshold counters to nil to those not incremented, thus assuming app server now accessable.\n     59:   # Set to nil since chef does not delete the key, can only alter it.\n     60:   (Set.new(node[:lb][:threshold][vhost_name].keys) - servers_missing).each do |uuid|\n     61:     if node[:lb][:threshold][vhost_name][uuid]\n>>>  62:       node[:lb][:threshold][vhost_name][uuid] = nil\n     63:       log \"  Resetting threshold for #{uuid}\"\n     64:     end\n     65:   end\n     66: \n     67:   # Delete servers that hit threshold.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-diamond-attributes-mysql.rb", "content": "default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"", "line": 5, "detection_span": [1, 10], "with_context": "\ndefault['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\ndefault['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\ndefault['diamond']['collectors']['MySQLCollector']['port'] = 3306\ndefault['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\n5: default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\ndefault['diamond']['collectors']['MySQLCollector']['password'] = \"password\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-diamond-attributes-mysql.rb\n# Target line: 5\n\n      1: default['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\n      2: default['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\n      3: default['diamond']['collectors']['MySQLCollector']['port'] = 3306\n      4: default['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\n>>>   5: default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\n      6: default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-mailman-recipes-default.rb", "content": "user \"list\"", "line": 76, "detection_span": [71, 81], "with_context": "\nmode \"755\"\nend\n\nprometheus_exporter \"mailman\" do\nport 8083\n76:   user \"list\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-mailman-recipes-default.rb\n# Target line: 76\n\n     71:   mode \"755\"\n     72: end\n     73: \n     74: prometheus_exporter \"mailman\" do\n     75:   port 8083\n>>>  76:   user \"list\"\n     77: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb", "content": "ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"", "line": 119, "detection_span": [114, 124], "with_context": "\n114:   end\n115:\n116:   pam_services = %w(sudo su sshd)\n117:   pam_config_dir = \"/etc/pam.d\"\n118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\n119:   ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\ntemplate generate_ssh_key_path do\nsource 'directory_service/generate_ssh_key.sh.erb'\nowner 'root'\ngroup 'root'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb\n# Target line: 119\n\n    114:   end\n    115: \n    116:   pam_services = %w(sudo su sshd)\n    117:   pam_config_dir = \"/etc/pam.d\"\n    118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\n>>> 119:   ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n    120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\n    121:     template generate_ssh_key_path do\n    122:       source 'directory_service/generate_ssh_key.sh.erb'\n    123:       owner 'root'\n    124:       group 'root'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb", "content": "'key_path' => '/etc/opscode/webui_priv.pem'", "line": 31, "detection_span": [26, 36], "with_context": "\n\napp_settings = {\n'chef' => {\n'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n'superuser' => 'pivotal',\n31:     'key_path' => '/etc/opscode/webui_priv.pem'\n},\n'doorkeeper' => {\n'administrators' => node['private_chef']['oc_id']['administrators'] || []\n},\n'sentry_dsn' => node['private_chef']['oc_id']['sentry_dsn'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb\n# Target line: 31\n\n     26: \n     27: app_settings = {\n     28:   'chef' => {\n     29:     'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n     30:     'superuser' => 'pivotal',\n>>>  31:     'key_path' => '/etc/opscode/webui_priv.pem'\n     32:   },\n     33:   'doorkeeper' => {\n     34:     'administrators' => node['private_chef']['oc_id']['administrators'] || []\n     35:   },\n     36:   'sentry_dsn' => node['private_chef']['oc_id']['sentry_dsn'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "amitjain1975_custom-rightscale-cookbooks-db-definitions-db_do_backup.rb", "content": "secondary_user get_device_or_default(node, :device1, :backup, :secondary, :cred, :user)", "line": 81, "detection_span": [76, 86], "with_context": "\n\n# Secondary arguments\nsecondary_cloud get_device_or_default(node, :device1, :backup, :secondary, :cloud)\nsecondary_endpoint get_device_or_default(node, :device1, :backup, :secondary, :endpoint) || \"\"\nsecondary_container get_device_or_default(node, :device1, :backup, :secondary, :container)\n81:     secondary_user get_device_or_default(node, :device1, :backup, :secondary, :cred, :user)\nsecondary_secret get_device_or_default(node, :device1, :backup, :secondary, :cred, :secret)\n\naction do_backup_type == 'primary' ? :primary_backup : :secondary_backup\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-db-definitions-db_do_backup.rb\n# Target line: 81\n\n     76: \n     77:     # Secondary arguments\n     78:     secondary_cloud get_device_or_default(node, :device1, :backup, :secondary, :cloud)\n     79:     secondary_endpoint get_device_or_default(node, :device1, :backup, :secondary, :endpoint) || \"\"\n     80:     secondary_container get_device_or_default(node, :device1, :backup, :secondary, :container)\n>>>  81:     secondary_user get_device_or_default(node, :device1, :backup, :secondary, :cred, :user)\n     82:     secondary_secret get_device_or_default(node, :device1, :backup, :secondary, :cred, :secret)\n     83: \n     84:     action do_backup_type == 'primary' ? :primary_backup : :secondary_backup\n     85:   end\n     86: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Nikhil424_chef-repo-cookbooks-solr_6-attributes-install.rb", "content": "default['solr']['solr_ssl_client_key_store_password'] = ''", "line": 46, "detection_span": [41, 51], "with_context": "\ndefault['solr']['solr_ssl_trust_store_password'] = ''\ndefault['solr']['solr_ssl_need_client_auth'] = ''\ndefault['solr']['solr_ssl_want_client_auth'] = ''\n\ndefault['solr']['solr_ssl_client_key_store'] = ''\n46: default['solr']['solr_ssl_client_key_store_password'] = ''\ndefault['solr']['solr_ssl_client_trust_store'] = ''\ndefault['solr']['solr_ssl_client_trust_store_password'] = ''\n\ndefault['solr']['gc_log_opts'] = \"-verbose:gc \\\n-XX:+PrintHeapAtGC \\", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-solr_6-attributes-install.rb\n# Target line: 46\n\n     41: default['solr']['solr_ssl_trust_store_password'] = ''\n     42: default['solr']['solr_ssl_need_client_auth'] = ''\n     43: default['solr']['solr_ssl_want_client_auth'] = ''\n     44: \n     45: default['solr']['solr_ssl_client_key_store'] = ''\n>>>  46: default['solr']['solr_ssl_client_key_store_password'] = ''\n     47: default['solr']['solr_ssl_client_trust_store'] = ''\n     48: default['solr']['solr_ssl_client_trust_store_password'] = ''\n     49: \n     50: default['solr']['gc_log_opts'] = \"-verbose:gc \\\n     51: -XX:+PrintHeapAtGC \\\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-lvm-libraries-provider_lvm_volume_group.rb", "content": "pv_vg_uuid = pv.nil? ? nil : pv.vg_uuid", "line": 85, "detection_span": [80, 90], "with_context": "\npv = lvm.physical_volumes[pv_name]\n\n# get the uuid of the VG the PV belongs to if it exists\n# if we get \"nil\" then the PV does not belong to a VG\n# per the vgextend man page the pv will be initalized if it isn't already pv\n85:           pv_vg_uuid = pv.nil? ? nil : pv.vg_uuid\nif pv_vg_uuid.nil?\npvs_to_add.push pv_name\nelse\n# raise an error if we attempt to add a PV that is already a member of a VG\nraise(\"PV #{pv} is already a member of another volume group. Cannot add to #{name}\") unless pv_vg_uuid == vg_uuid", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-lvm-libraries-provider_lvm_volume_group.rb\n# Target line: 85\n\n     80:           pv = lvm.physical_volumes[pv_name]\n     81: \n     82:           # get the uuid of the VG the PV belongs to if it exists\n     83:           # if we get \"nil\" then the PV does not belong to a VG\n     84:           # per the vgextend man page the pv will be initalized if it isn't already pv\n>>>  85:           pv_vg_uuid = pv.nil? ? nil : pv.vg_uuid\n     86:           if pv_vg_uuid.nil?\n     87:             pvs_to_add.push pv_name\n     88:           else\n     89:             # raise an error if we attempt to add a PV that is already a member of a VG\n     90:             raise(\"PV #{pv} is already a member of another volume group. Cannot add to #{name}\") unless pv_vg_uuid == vg_uuid\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_platformstack-recipes-iptables.rb", "content": "user 'rackconnect'", "line": 26, "detection_span": [21, 31], "with_context": "\ninclude_recipe 'chef-sugar'\n\nunless lxc?\nif node['platformstack']['rackconnect'] == true\nsudo 'rackconnect' do\n26:       user 'rackconnect'\nnopasswd true\nend\nnode.default['openssh']['server']['password_authentication'] = 'yes'\nelse\ninclude_recipe 'rackspace_iptables::default'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_platformstack-recipes-iptables.rb\n# Target line: 26\n\n     21: include_recipe 'chef-sugar'\n     22: \n     23: unless lxc?\n     24:   if node['platformstack']['rackconnect'] == true\n     25:     sudo 'rackconnect' do\n>>>  26:       user 'rackconnect'\n     27:       nopasswd true\n     28:     end\n     29:     node.default['openssh']['server']['password_authentication'] = 'yes'\n     30:   else\n     31:     include_recipe 'rackspace_iptables::default'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-opsworks_ganglia-attributes-default.rb", "content": "default[:ganglia][:user] = 'ganglia'", "line": 28, "detection_span": [23, 33], "with_context": "\ndefault[:ganglia][:original_datadir] = '/var/lib/ganglia'\ndefault[:ganglia][:conf_dir] = \"#{node[:ganglia][:original_datadir]}/conf\"\ndefault[:ganglia][:events_dir] = \"#{node[:ganglia][:original_datadir]}/conf/events.json.d/\"\ndefault[:ganglia][:tcp_client_port] = 8649\ndefault[:ganglia][:udp_client_port] = 8666\n28: default[:ganglia][:user] = 'ganglia'\ndefault[:ganglia][:rrds_user] = 'nobody'\n\nif infrastructure_class?('ec2')\ndefault[:ganglia][:autofs_options] = \"-fstype=none,bind,rw\"\ndefault[:ganglia][:autofs_entry] = \"#{node[:ganglia][:original_datadir]} #{node[:ganglia][:autofs_options]} :#{node[:ganglia][:datadir]}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-opsworks_ganglia-attributes-default.rb\n# Target line: 28\n\n     23: default[:ganglia][:original_datadir] = '/var/lib/ganglia'\n     24: default[:ganglia][:conf_dir] = \"#{node[:ganglia][:original_datadir]}/conf\"\n     25: default[:ganglia][:events_dir] = \"#{node[:ganglia][:original_datadir]}/conf/events.json.d/\"\n     26: default[:ganglia][:tcp_client_port] = 8649\n     27: default[:ganglia][:udp_client_port] = 8666\n>>>  28: default[:ganglia][:user] = 'ganglia'\n     29: default[:ganglia][:rrds_user] = 'nobody'\n     30: \n     31: if infrastructure_class?('ec2')\n     32:   default[:ganglia][:autofs_options] = \"-fstype=none,bind,rw\"\n     33:   default[:ganglia][:autofs_entry] = \"#{node[:ganglia][:original_datadir]} #{node[:ganglia][:autofs_options]} :#{node[:ganglia][:datadir]}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-nginx-attributes-nginx.rb", "content": "default[:nginx][:user]       = \"nginx\"", "line": 31, "detection_span": [26, 36], "with_context": "\ndefault[:nginx][:pid_file] = \"/var/run/nginx.pid\"\nend\nwhen \"rhel\"\ndefault[:nginx][:dir]        = \"/etc/nginx\"\ndefault[:nginx][:log_dir]    = \"/var/log/nginx\"\n31:   default[:nginx][:user]       = \"nginx\"\ndefault[:nginx][:binary]     = \"/usr/sbin/nginx\"\ndefault[:nginx][:pid_file]   = \"/var/run/nginx.pid\"\nelse\nChef::Log.error \"Cannot configure nginx, platform unknown\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-nginx-attributes-nginx.rb\n# Target line: 31\n\n     26:     default[:nginx][:pid_file] = \"/var/run/nginx.pid\"\n     27:   end\n     28: when \"rhel\"\n     29:   default[:nginx][:dir]        = \"/etc/nginx\"\n     30:   default[:nginx][:log_dir]    = \"/var/log/nginx\"\n>>>  31:   default[:nginx][:user]       = \"nginx\"\n     32:   default[:nginx][:binary]     = \"/usr/sbin/nginx\"\n     33:   default[:nginx][:pid_file]   = \"/var/run/nginx.pid\"\n     34: else\n     35:   Chef::Log.error \"Cannot configure nginx, platform unknown\"\n     36: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-otrs-attributes-default.rb", "content": "default[:otrs][:database_user] = \"otrs\"", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault[:otrs][:version] = \"6.0.30\"\ndefault[:otrs][:user] = \"otrs\"\ndefault[:otrs][:group] = nil\ndefault[:otrs][:database_cluster] = \"13/main\"\ndefault[:otrs][:database_name] = \"otrs\"\n6: default[:otrs][:database_user] = \"otrs\"\ndefault[:otrs][:database_password] = \"otrs\"\ndefault[:otrs][:site] = \"otrs\"\n\ndefault[:postgresql][:versions] |= [\"13\"]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-otrs-attributes-default.rb\n# Target line: 6\n\n      1: default[:otrs][:version] = \"6.0.30\"\n      2: default[:otrs][:user] = \"otrs\"\n      3: default[:otrs][:group] = nil\n      4: default[:otrs][:database_cluster] = \"13/main\"\n      5: default[:otrs][:database_name] = \"otrs\"\n>>>   6: default[:otrs][:database_user] = \"otrs\"\n      7: default[:otrs][:database_password] = \"otrs\"\n      8: default[:otrs][:site] = \"otrs\"\n      9: \n     10: default[:postgresql][:versions] |= [\"13\"]\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb", "content": "'admin' => 'v3/%(project_id)s',", "line": 67, "detection_span": [62, 72], "with_context": "\n'admin' => 8776,\n'internal' => 8776,\n'public' => 8776,\n},\n'uris' => {\n67:       'admin' => 'v3/%(project_id)s',\n'internal' => 'v3/%(project_id)s',\n'public' => 'v3/%(project_id)s',\n},\n},\n'image' => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb\n# Target line: 67\n\n     62:       'admin' => 8776,\n     63:       'internal' => 8776,\n     64:       'public' => 8776,\n     65:     },\n     66:     'uris' => {\n>>>  67:       'admin' => 'v3/%(project_id)s',\n     68:       'internal' => 'v3/%(project_id)s',\n     69:       'public' => 'v3/%(project_id)s',\n     70:     },\n     71:   },\n     72:   'image' => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-attributes-default.rb", "content": "set_unless[:repo][:default][:git_ssh_key] = \"\"", "line": 13, "detection_span": [8, 18], "with_context": "\nset_unless[:repo][:default][:repository] = \"\"\nset_unless[:repo][:default][:revision] = \"HEAD\"\nset_unless[:repo][:default][:provider] = \"repo_git\"\nset_unless[:repo][:default][:svn_username] = \"\"\nset_unless[:repo][:default][:svn_password] = \"\"\n13: set_unless[:repo][:default][:git_ssh_key] = \"\"\nset_unless[:repo][:default][:storage_account_provider] = \"S3\"\nset_unless[:repo][:default][:storage_account_id] = \"\"\nset_unless[:repo][:default][:storage_account_secret] = \"\"\nset_unless[:repo][:default][:container] = \"\"\nset_unless[:repo][:default][:prefix] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-attributes-default.rb\n# Target line: 13\n\n      8: set_unless[:repo][:default][:repository] = \"\"\n      9: set_unless[:repo][:default][:revision] = \"HEAD\"\n     10: set_unless[:repo][:default][:provider] = \"repo_git\"\n     11: set_unless[:repo][:default][:svn_username] = \"\"\n     12: set_unless[:repo][:default][:svn_password] = \"\"\n>>>  13: set_unless[:repo][:default][:git_ssh_key] = \"\"\n     14: set_unless[:repo][:default][:storage_account_provider] = \"S3\"\n     15: set_unless[:repo][:default][:storage_account_id] = \"\"\n     16: set_unless[:repo][:default][:storage_account_secret] = \"\"\n     17: set_unless[:repo][:default][:container] = \"\"\n     18: set_unless[:repo][:default][:prefix] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-nova-setup.rb", "content": "node.set_unless[\"nova\"][\"db\"][\"password\"] = \"nova\"", "line": 24, "detection_span": [19, 29], "with_context": "\n\n::Chef::Recipe.send(:include, Opscode::OpenSSL::Password)\n\n# Allow for using a well known db password\nif node[\"developer_mode\"] == true\n24:   node.set_unless[\"nova\"][\"db\"][\"password\"] = \"nova\"\nnode.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = \"nova\"\nelse\nnode.set_unless[\"nova\"][\"db\"][\"password\"] = secure_password\nnode.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = secure_password\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-setup.rb\n# Target line: 24\n\n     19: \n     20: ::Chef::Recipe.send(:include, Opscode::OpenSSL::Password)\n     21: \n     22: # Allow for using a well known db password\n     23: if node[\"developer_mode\"] == true\n>>>  24:   node.set_unless[\"nova\"][\"db\"][\"password\"] = \"nova\"\n     25:   node.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = \"nova\"\n     26: else\n     27:   node.set_unless[\"nova\"][\"db\"][\"password\"] = secure_password\n     28:   node.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = secure_password\n     29: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cdapio_hadoop_cookbook-recipes-spark_historyserver.rb", "content": "user 'hdfs'", "line": 42, "detection_span": [37, 47], "with_context": "\n'hdfs:///user/spark/applicationHistory'\nend\n\nexecute 'hdfs-spark-eventlog-dir' do\ncommand \"hdfs dfs -mkdir -p #{eventlog_dir} && hdfs dfs -chown -R spark:spark #{eventlog_dir} && hdfs dfs -chmod 1777 #{eventlog_dir}\"\n42:   user 'hdfs'\ngroup 'hdfs'\ntimeout 300\naction :nothing\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cdapio_hadoop_cookbook-recipes-spark_historyserver.rb\n# Target line: 42\n\n     37:     'hdfs:///user/spark/applicationHistory'\n     38:   end\n     39: \n     40: execute 'hdfs-spark-eventlog-dir' do\n     41:   command \"hdfs dfs -mkdir -p #{eventlog_dir} && hdfs dfs -chown -R spark:spark #{eventlog_dir} && hdfs dfs -chmod 1777 #{eventlog_dir}\"\n>>>  42:   user 'hdfs'\n     43:   group 'hdfs'\n     44:   timeout 300\n     45:   action :nothing\n     46: end\n     47: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-php-attributes-default.rb", "content": "default['php']['fpm_user']      = 'www-data'", "line": 41, "detection_span": [36, 46], "with_context": "\ndefault['php']['fpm_user']      = 'www-data'\ndefault['php']['fpm_group']     = 'www-data'\nelse\ndefault['php']['conf_dir']      = '/etc/php5/cli'\ndefault['php']['ext_conf_dir']  = '/etc/php5/conf.d'\n41:   default['php']['fpm_user']      = 'www-data'\ndefault['php']['fpm_group']     = 'www-data'\nend\n\n\ndefault['php']['url'] = 'http://us.php.net/distributions'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-php-attributes-default.rb\n# Target line: 41\n\n     36:   default['php']['fpm_user']      = 'www-data'\n     37:   default['php']['fpm_group']     = 'www-data'\n     38: else\n     39:   default['php']['conf_dir']      = '/etc/php5/cli'\n     40:   default['php']['ext_conf_dir']  = '/etc/php5/conf.d'\n>>>  41:   default['php']['fpm_user']      = 'www-data'\n     42:   default['php']['fpm_group']     = 'www-data'\n     43: end\n     44: \n     45: \n     46: default['php']['url'] = 'http://us.php.net/distributions'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "msquitieri_craigslistpoetry-api-chef-vendor-cookbooks-the_bard-recipes-backup.rb", "content": "user 'deploy'", "line": 39, "detection_span": [34, 44], "with_context": "\naction :create\nminute '0'\n# 2AM EST\nhour '6'\nweekday '*'\n39:     user 'deploy'\ncommand '/home/deploy/scripts/backup_database.sh >> /home/deploy/scripts/backup.log 2>&1'\nend\n\nlogrotate_app \"craigslistpoetry-backups\" do\ncookbook \"logrotate\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: msquitieri_craigslistpoetry-api-chef-vendor-cookbooks-the_bard-recipes-backup.rb\n# Target line: 39\n\n     34:     action :create\n     35:     minute '0'\n     36:     # 2AM EST\n     37:     hour '6'\n     38:     weekday '*'\n>>>  39:     user 'deploy'\n     40:     command '/home/deploy/scripts/backup_database.sh >> /home/deploy/scripts/backup.log 2>&1'\n     41:   end\n     42: \n     43:   logrotate_app \"craigslistpoetry-backups\" do\n     44:     cookbook \"logrotate\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-cookbooks_chef-ingredient-resources-chef_user.rb", "content": "key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")", "line": 47, "detection_span": [42, 52], "with_context": "\ngroup 'root'\nmode '0700'\nrecursive true\nend\n\n47:   key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\npassword = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n\nexecute \"create-user-#{new_resource.username}\" do\nsensitive true\nretries 3", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_chef-ingredient-resources-chef_user.rb\n# Target line: 47\n\n     42:     group 'root'\n     43:     mode '0700'\n     44:     recursive true\n     45:   end\n     46: \n>>>  47:   key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\n     48:   password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n     49: \n     50:   execute \"create-user-#{new_resource.username}\" do\n     51:     sensitive true\n     52:     retries 3\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-openstack.rb", "content": "default['bcpc']['openstack']['admin']['username'] = 'admin'", "line": 12, "detection_span": [7, 17], "with_context": "\n\ndefault['bcpc']['openstack']['repo']['release'] = 'ussuri'\ndefault['bcpc']['openstack']['repo']['branch'] = 'updates'\ndefault['bcpc']['openstack']['repo']['key'] = 'openstack/release.key'\n\n12: default['bcpc']['openstack']['admin']['username'] = 'admin'\ndefault['bcpc']['openstack']['admin']['project'] = 'admin'\n\ndefault['bcpc']['openstack']['services']['workers'] = 1\n\n###############################################################################", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-openstack.rb\n# Target line: 12\n\n      7: \n      8: default['bcpc']['openstack']['repo']['release'] = 'ussuri'\n      9: default['bcpc']['openstack']['repo']['branch'] = 'updates'\n     10: default['bcpc']['openstack']['repo']['key'] = 'openstack/release.key'\n     11: \n>>>  12: default['bcpc']['openstack']['admin']['username'] = 'admin'\n     13: default['bcpc']['openstack']['admin']['project'] = 'admin'\n     14: \n     15: default['bcpc']['openstack']['services']['workers'] = 1\n     16: \n     17: ###############################################################################\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-elasticsearch-cookbooks-zabbix-providers-user.rb", "content": "self.zabbix_user           = (Rubix::User.find(:username => new_resource.name) || Rubix::User.new(:username => new_resource.name))", "line": 16, "detection_span": [11, 21], "with_context": "\nattr_accessor :zabbix_user\n\ndef load_current_resource\nreturn unless connect_to_zabbix_server(new_resource.server)\nbegin\n16:     self.zabbix_user           = (Rubix::User.find(:username => new_resource.name) || Rubix::User.new(:username => new_resource.name))\nself.zabbix_user.first_name         = new_resource.first_name\nself.zabbix_user.last_name          = new_resource.last_name\nself.zabbix_user.url                = new_resource.url\nself.zabbix_user.auto_login         = new_resource.auto_login\nself.zabbix_user.type               = new_resource.type", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-elasticsearch-cookbooks-zabbix-providers-user.rb\n# Target line: 16\n\n     11: attr_accessor :zabbix_user\n     12: \n     13: def load_current_resource\n     14:   return unless connect_to_zabbix_server(new_resource.server)\n     15:   begin\n>>>  16:     self.zabbix_user           = (Rubix::User.find(:username => new_resource.name) || Rubix::User.new(:username => new_resource.name))\n     17:     self.zabbix_user.first_name         = new_resource.first_name\n     18:     self.zabbix_user.last_name          = new_resource.last_name\n     19:     self.zabbix_user.url                = new_resource.url\n     20:     self.zabbix_user.auto_login         = new_resource.auto_login\n     21:     self.zabbix_user.type               = new_resource.type\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sous-chefs_php-recipes-community_package.rb", "content": "key 'https://packages.sury.org/php/apt.gpg'", "line": 29, "detection_span": [24, 34], "with_context": "\ninclude_recipe 'ondrej_ppa_ubuntu'\nelsif platform?('debian')\n# use sury repo for debian (https://deb.sury.org/)\napt_repository 'sury-php' do\nuri 'https://packages.sury.org/php/'\n29:     key 'https://packages.sury.org/php/apt.gpg'\ncomponents %w(main)\nend\nend\n\ninclude_recipe 'php::package'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sous-chefs_php-recipes-community_package.rb\n# Target line: 29\n\n     24:   include_recipe 'ondrej_ppa_ubuntu'\n     25: elsif platform?('debian')\n     26:   # use sury repo for debian (https://deb.sury.org/)\n     27:   apt_repository 'sury-php' do\n     28:     uri 'https://packages.sury.org/php/'\n>>>  29:     key 'https://packages.sury.org/php/apt.gpg'\n     30:     components %w(main)\n     31:   end\n     32: end\n     33: \n     34: include_recipe 'php::package'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-nova.rb", "content": "default['bcpc']['nova']['ceph']['user'] = 'nova'", "line": 14, "detection_span": [9, 19], "with_context": "\n\n# Nova debug toggle\ndefault['bcpc']['nova']['debug'] = false\n\n# ceph (rbd)\n14: default['bcpc']['nova']['ceph']['user'] = 'nova'\ndefault['bcpc']['nova']['ceph']['pool']['name'] = 'vms'\ndefault['bcpc']['nova']['ceph']['pool']['size'] = 1\n\n# Allow destination machine to match source for resize\ndefault['bcpc']['nova']['allow_resize_to_same_host'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-nova.rb\n# Target line: 14\n\n      9: \n     10: # Nova debug toggle\n     11: default['bcpc']['nova']['debug'] = false\n     12: \n     13: # ceph (rbd)\n>>>  14: default['bcpc']['nova']['ceph']['user'] = 'nova'\n     15: default['bcpc']['nova']['ceph']['pool']['name'] = 'vms'\n     16: default['bcpc']['nova']['ceph']['pool']['size'] = 1\n     17: \n     18: # Allow destination machine to match source for resize\n     19: default['bcpc']['nova']['allow_resize_to_same_host'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-dock_automatically_hide_and_show_the_dock.rb", "content": "key 'autohide'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Automatically hide and show the dock\" do\ndomain 'com.apple.dock'\n3:   key 'autohide'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-dock_automatically_hide_and_show_the_dock.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Automatically hide and show the dock\" do\n      2:   domain 'com.apple.dock'\n>>>   3:   key 'autohide'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-recipes-repo_passenger.rb", "content": "key '561F9B9CAC40B2F7'", "line": 35, "detection_span": [30, 40], "with_context": "\nuri 'https://oss-binaries.phusionpassenger.com/apt/passenger'\ndistribution node['lsb']['codename']\ncomponents %w(main)\ndeb_src true\nkeyserver 'keyserver.ubuntu.com'\n35:     key '561F9B9CAC40B2F7'\nend\n\ninclude_recipe 'nginx::passenger'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-recipes-repo_passenger.rb\n# Target line: 35\n\n     30:     uri 'https://oss-binaries.phusionpassenger.com/apt/passenger'\n     31:     distribution node['lsb']['codename']\n     32:     components %w(main)\n     33:     deb_src true\n     34:     keyserver 'keyserver.ubuntu.com'\n>>>  35:     key '561F9B9CAC40B2F7'\n     36:   end\n     37: \n     38:   include_recipe 'nginx::passenger'\n     39: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-chef-recipes-repository.rb", "content": "user \"chefrepo\"", "line": 42, "detection_span": [37, 47], "with_context": "\n\ngit \"/var/lib/chef/#{repository}\" do\naction :checkout\nrepository repository_directory\nrevision \"master\"\n42:     user \"chefrepo\"\ngroup \"chefrepo\"\nend\n\ndirectory \"/var/lib/chef/#{repository}/.chef\" do\nowner \"chefrepo\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-chef-recipes-repository.rb\n# Target line: 42\n\n     37: \n     38:   git \"/var/lib/chef/#{repository}\" do\n     39:     action :checkout\n     40:     repository repository_directory\n     41:     revision \"master\"\n>>>  42:     user \"chefrepo\"\n     43:     group \"chefrepo\"\n     44:   end\n     45: \n     46:   directory \"/var/lib/chef/#{repository}/.chef\" do\n     47:     owner \"chefrepo\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Nikhil424_chef-repo-cookbooks-chef-client-attributes-default.rb", "content": "default['chef_client']['task']['password'] = '' # SYSTEM user does not need a password, but windows_task LWRP wants one", "line": 64, "detection_span": [59, 69], "with_context": "\n\n# Configuration for Windows scheduled task\ndefault['chef_client']['task']['frequency'] = 'minute'\ndefault['chef_client']['task']['frequency_modifier'] = node['chef_client']['interval'].to_i / 60\ndefault['chef_client']['task']['user'] = 'SYSTEM'\n64: default['chef_client']['task']['password'] = '' # SYSTEM user does not need a password, but windows_task LWRP wants one\n\ndefault['chef_client']['load_gems'] = {}\n\n# If set to false, changes in the `client.rb` template won't trigger a reload\n# of those configs in the current Chef run.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-chef-client-attributes-default.rb\n# Target line: 64\n\n     59: \n     60: # Configuration for Windows scheduled task\n     61: default['chef_client']['task']['frequency'] = 'minute'\n     62: default['chef_client']['task']['frequency_modifier'] = node['chef_client']['interval'].to_i / 60\n     63: default['chef_client']['task']['user'] = 'SYSTEM'\n>>>  64: default['chef_client']['task']['password'] = '' # SYSTEM user does not need a password, but windows_task LWRP wants one\n     65: \n     66: default['chef_client']['load_gems'] = {}\n     67: \n     68: # If set to false, changes in the `client.rb` template won't trigger a reload\n     69: # of those configs in the current Chef run.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_cookbook-openstack-identity-recipes-cloud_config.rb", "content": "ksadmin_pass = get_password 'user', ksadmin_user", "line": 31, "detection_span": [26, 36], "with_context": "\nksadmin_project = node['openstack']['identity']['admin_project']\nproject_domain_name = node['openstack']['identity']['admin_project_domain']\nksadmin_user = node['openstack']['identity']['admin_user']\nadmin_domain_name = node['openstack']['identity']['admin_domain_name']\n\n31: ksadmin_pass = get_password 'user', ksadmin_user\n\nidentity_endpoint = public_endpoint 'identity'\nauth_url = identity_endpoint.to_s\n\ncloud_config = node['openstack']['identity']['cloud_config']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-identity-recipes-cloud_config.rb\n# Target line: 31\n\n     26: ksadmin_project = node['openstack']['identity']['admin_project']\n     27: project_domain_name = node['openstack']['identity']['admin_project_domain']\n     28: ksadmin_user = node['openstack']['identity']['admin_user']\n     29: admin_domain_name = node['openstack']['identity']['admin_domain_name']\n     30: \n>>>  31: ksadmin_pass = get_password 'user', ksadmin_user\n     32: \n     33: identity_endpoint = public_endpoint 'identity'\n     34: auth_url = identity_endpoint.to_s\n     35: \n     36: cloud_config = node['openstack']['identity']['cloud_config']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-examples~snapshot.rb", "content": "disk_encryption_key(", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\ngcompute_disk 'data-disk-1' do\naction :create\nsize_gb 50\n66:   disk_encryption_key(\nraw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n)\nzone 'us-central1-a'\nproject ENV['PROJECT'] # ex: 'my-test-project'\ncredential 'mycred'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-examples~snapshot.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: gcompute_disk 'data-disk-1' do\n     64:   action :create\n     65:   size_gb 50\n>>>  66:   disk_encryption_key(\n     67:     raw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n     68:   )\n     69:   zone 'us-central1-a'\n     70:   project ENV['PROJECT'] # ex: 'my-test-project'\n     71:   credential 'mycred'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-basejump-attributes-default.rb", "content": "default[:basejump][:user] = \"ihr-deployer\"", "line": 36, "detection_span": [31, 41], "with_context": "\n})\ndefault[:basejump][:kickstarter][:mirrors] = ({\n\"centos\" => \"http://mirror.stanford.edu/yum/pub/\"\n})\n\n36: default[:basejump][:user] = \"ihr-deployer\"\ncase node['platform']\nwhen \"debian\"\ndefault[:basejump][:group] = \"ihr-deployer\"\nwhen \"centos\"\ndefault[:basejump][:group] = \"ihr-deployer\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-basejump-attributes-default.rb\n# Target line: 36\n\n     31:                                               })\n     32: default[:basejump][:kickstarter][:mirrors] = ({\n     33:                                                 \"centos\" => \"http://mirror.stanford.edu/yum/pub/\"\n     34:                                               })\n     35: \n>>>  36: default[:basejump][:user] = \"ihr-deployer\"\n     37: case node['platform']\n     38: when \"debian\"\n     39:   default[:basejump][:group] = \"ihr-deployer\"\n     40: when \"centos\"\n     41:   default[:basejump][:group] = \"ihr-deployer\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-block_device-attributes-default.rb", "content": "set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:user] = \"\"", "line": 19, "detection_span": [14, 24], "with_context": "\nset_unless[:block_device][:devices][:default][:backup][:primary][:cloud] = 'cloudfiles' if cloud[:provider] == 'rackspace'\n\nset_unless[:block_device][:devices][:default][:backup][:primary][:cred][:user] = \"\"\nset_unless[:block_device][:devices][:default][:backup][:primary][:cred][:secret] = \"\"\n\n19: set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:user] = \"\"\nset_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:secret] = \"\"\n\nset_unless[:block_device][:devices_to_use] = 'device1'\n\n# Defining initial backup parameters for all block devices", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-block_device-attributes-default.rb\n# Target line: 19\n\n     14: set_unless[:block_device][:devices][:default][:backup][:primary][:cloud] = 'cloudfiles' if cloud[:provider] == 'rackspace'\n     15: \n     16: set_unless[:block_device][:devices][:default][:backup][:primary][:cred][:user] = \"\"\n     17: set_unless[:block_device][:devices][:default][:backup][:primary][:cred][:secret] = \"\"\n     18: \n>>>  19: set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:user] = \"\"\n     20: set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:secret] = \"\"\n     21: \n     22: set_unless[:block_device][:devices_to_use] = 'device1'\n     23: \n     24: # Defining initial backup parameters for all block devices\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-varnish-recipes-apt_repo.rb", "content": "key \"http://repo.varnish-cache.org/#{node['platform']}/GPG-key.txt\"", "line": 22, "detection_span": [17, 27], "with_context": "\n\napt_repository \"varnish-cache\" do\nuri \"http://repo.varnish-cache.org/#{node['platform']}\"\ndistribution node['lsb']['codename']\ncomponents [\"varnish-#{node['varnish']['version']}\"]\n22:   key \"http://repo.varnish-cache.org/#{node['platform']}/GPG-key.txt\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-varnish-recipes-apt_repo.rb\n# Target line: 22\n\n     17: \n     18: apt_repository \"varnish-cache\" do\n     19:   uri \"http://repo.varnish-cache.org/#{node['platform']}\"\n     20:   distribution node['lsb']['codename']\n     21:   components [\"varnish-#{node['varnish']['version']}\"]\n>>>  22:   key \"http://repo.varnish-cache.org/#{node['platform']}/GPG-key.txt\"\n     23: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-partners.iheart.com-attributes-default.rb", "content": "default[:partners][:user] = 'partners'", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault[:partners][:repo] = 'git@github.com:iheartradio/partners.iheart.com.git'\ndefault[:partners][:rev] = 'release'\ndefault[:partners][:deploy_path] = '/data/apps/partners'\n4: default[:partners][:user] = 'partners'\ndefault[:partners][:group] = 'partners'\ndefault[:partners][:deployer] = 'ihr-deployer'\ndefault[:partners][:nginx_port] = \"8080\"\ndefault[:partners][:gunicorn_port] = \"8000\"\ndefault[:partners][:sqlite_path] = \"/var/partners\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-partners.iheart.com-attributes-default.rb\n# Target line: 4\n\n      1: default[:partners][:repo] = 'git@github.com:iheartradio/partners.iheart.com.git'\n      2: default[:partners][:rev] = 'release'\n      3: default[:partners][:deploy_path] = '/data/apps/partners'\n>>>   4: default[:partners][:user] = 'partners'\n      5: default[:partners][:group] = 'partners'\n      6: default[:partners][:deployer] = 'ihr-deployer'\n      7: default[:partners][:nginx_port] = \"8080\"\n      8: default[:partners][:gunicorn_port] = \"8000\"\n      9: default[:partners][:sqlite_path] = \"/var/partners\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "caiush_bos-cookbooks-bcpc-recipes-ceph-apt.rb", "content": "key \"ceph-release.key\"", "line": 31, "detection_span": [26, 36], "with_context": "\n\napt_repository \"ceph-extras\" do\nuri node['bcpc']['repos']['ceph-extras']\ndistribution node['lsb']['codename']\ncomponents [\"main\"]\n31:     key \"ceph-release.key\"\nend\n\napt_repository \"ceph-fcgi\" do\nuri node['bcpc']['repos']['ceph-fcgi']\ndistribution node['lsb']['codename']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: caiush_bos-cookbooks-bcpc-recipes-ceph-apt.rb\n# Target line: 31\n\n     26: \n     27: apt_repository \"ceph-extras\" do\n     28:     uri node['bcpc']['repos']['ceph-extras']\n     29:     distribution node['lsb']['codename']\n     30:     components [\"main\"]\n>>>  31:     key \"ceph-release.key\"\n     32: end\n     33: \n     34: apt_repository \"ceph-fcgi\" do\n     35:     uri node['bcpc']['repos']['ceph-fcgi']\n     36:     distribution node['lsb']['codename']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_osl-openstack-attributes-default.rb", "content": "default['osl-openstack']['image']['rbd_store_user'] = 'glance'", "line": 40, "detection_span": [35, 45], "with_context": "\ndefault['osl-openstack']['block']['rbd_store_user'] = 'cinder'\ndefault['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\ndefault['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\ndefault['osl-openstack']['image']['glance_vol'] = nil\ndefault['osl-openstack']['image']['rbd_store_pool'] = 'images'\n40: default['osl-openstack']['image']['rbd_store_user'] = 'glance'\ndefault['osl-openstack']['endpoint_hostname'] = nil\ndefault['osl-openstack']['network_hostname'] = nil\ndefault['osl-openstack']['db_hostname'] = nil\ndefault['osl-openstack']['bind_service'] = node['ipaddress']\ndefault['osl-openstack']['seperate_network_node'] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_osl-openstack-attributes-default.rb\n# Target line: 40\n\n     35: default['osl-openstack']['block']['rbd_store_user'] = 'cinder'\n     36: default['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\n     37: default['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\n     38: default['osl-openstack']['image']['glance_vol'] = nil\n     39: default['osl-openstack']['image']['rbd_store_pool'] = 'images'\n>>>  40: default['osl-openstack']['image']['rbd_store_user'] = 'glance'\n     41: default['osl-openstack']['endpoint_hostname'] = nil\n     42: default['osl-openstack']['network_hostname'] = nil\n     43: default['osl-openstack']['db_hostname'] = nil\n     44: default['osl-openstack']['bind_service'] = node['ipaddress']\n     45: default['osl-openstack']['seperate_network_node'] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-mongodb-recipes-server.rb", "content": "key \"7F0CEB10\"", "line": 7, "detection_span": [2, 12], "with_context": "\n\nadd_apt_repository \"ubuntu_10gen\" do\nurl \"http://downloads-distro.mongodb.org/repo/ubuntu-upstart\"\ndistrib \"dist\"\ncomponents ['10gen']\n7: \t\tkey \"7F0CEB10\"\nkey_server \"keyserver.ubuntu.com\"\nrun_apt_get_update true\nend\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-mongodb-recipes-server.rb\n# Target line: 7\n\n      2: \n      3: \tadd_apt_repository \"ubuntu_10gen\" do\n      4: \t\turl \"http://downloads-distro.mongodb.org/repo/ubuntu-upstart\"\n      5: \t\tdistrib \"dist\"\n      6: \t\tcomponents ['10gen']\n>>>   7: \t\tkey \"7F0CEB10\"\n      8: \t\tkey_server \"keyserver.ubuntu.com\"\n      9: \t\trun_apt_get_update true\n     10: \tend\n     11: end\n     12: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "polew_chef-logstash-recipes-zero_mq_repo.rb", "content": "key 'C7917B12'", "line": 33, "detection_span": [28, 38], "with_context": "\napt_repository 'libpgm-ppa' do\nuri 'http://ppa.launchpad.net/chris-lea/libpgm/ubuntu'\ndistribution  node['lsb']['codename']\ncomponents ['main']\nkeyserver 'keyserver.ubuntu.com'\n33:     key 'C7917B12'\naction :add\nnotifies :run, 'execute[apt-get update]', :immediately\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: polew_chef-logstash-recipes-zero_mq_repo.rb\n# Target line: 33\n\n     28:   apt_repository 'libpgm-ppa' do\n     29:     uri 'http://ppa.launchpad.net/chris-lea/libpgm/ubuntu'\n     30:     distribution  node['lsb']['codename']\n     31:     components ['main']\n     32:     keyserver 'keyserver.ubuntu.com'\n>>>  33:     key 'C7917B12'\n     34:     action :add\n     35:     notifies :run, 'execute[apt-get update]', :immediately\n     36:   end\n     37: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-recipes-common.rb", "content": "conf_secrets['service_credentials']['password'] =", "line": 56, "detection_span": [51, 61], "with_context": "\n\n# define secrets that are needed in the ceilometer.conf\nnode.default['openstack']['telemetry']['conf_secrets'].tap do |conf_secrets|\nconf_secrets['database']['connection'] =\ndb_uri('telemetry', db_user, db_pass)\n56:   conf_secrets['service_credentials']['password'] =\nget_password 'service', 'openstack-telemetry'\nconf_secrets['keystone_authtoken']['password'] =\nget_password 'service', 'openstack-telemetry'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-recipes-common.rb\n# Target line: 56\n\n     51: \n     52: # define secrets that are needed in the ceilometer.conf\n     53: node.default['openstack']['telemetry']['conf_secrets'].tap do |conf_secrets|\n     54:   conf_secrets['database']['connection'] =\n     55:     db_uri('telemetry', db_user, db_pass)\n>>>  56:   conf_secrets['service_credentials']['password'] =\n     57:     get_password 'service', 'openstack-telemetry'\n     58:   conf_secrets['keystone_authtoken']['password'] =\n     59:     get_password 'service', 'openstack-telemetry'\n     60: end\n     61: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-datadog-resources-integration.rb", "content": "user      'dd-agent' unless platform_family?('windows')", "line": 50, "detection_span": [45, 55], "with_context": "\n\nChef::Log.debug(\"Removing integration #{new_resource.property_name}\")\n\nexecute 'integration remove' do\ncommand   \"\\\"#{agent_exe_filepath}\\\" integration remove #{new_resource.property_name}\"\n50:     user      'dd-agent' unless platform_family?('windows')\n\nnot_if {\noutput = shell_out(\"#{agent_exe_filepath} integration show -q #{new_resource.property_name}\").stdout\noutput.strip.empty?\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-resources-integration.rb\n# Target line: 50\n\n     45: \n     46:   Chef::Log.debug(\"Removing integration #{new_resource.property_name}\")\n     47: \n     48:   execute 'integration remove' do\n     49:     command   \"\\\"#{agent_exe_filepath}\\\" integration remove #{new_resource.property_name}\"\n>>>  50:     user      'dd-agent' unless platform_family?('windows')\n     51: \n     52:     not_if {\n     53:       output = shell_out(\"#{agent_exe_filepath} integration show -q #{new_resource.property_name}\").stdout\n     54:       output.strip.empty?\n     55:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_nodestack-attributes-mysql.rb", "content": "default['mysql-multi']['slave_user'] = 'replicant'", "line": 4, "detection_span": [1, 9], "with_context": "\n# Encoding: utf-8\ndefault['mysql-multi']['master'] = ''\ndefault['mysql-multi']['slaves'] = []\n4: default['mysql-multi']['slave_user'] = 'replicant'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-attributes-mysql.rb\n# Target line: 4\n\n      1: # Encoding: utf-8\n      2: default['mysql-multi']['master'] = ''\n      3: default['mysql-multi']['slaves'] = []\n>>>   4: default['mysql-multi']['slave_user'] = 'replicant'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-identity_registration.rb", "content": "admin_pass = get_password 'user', node['openstack']['identity']['admin_user']", "line": 43, "detection_span": [38, 48], "with_context": "\nservice_type = 'orchestration'\nservice_name = 'heat'\nservice_domain_name = node['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name']\nheat_domain_name = node['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name']\nadmin_user = node['openstack']['identity']['admin_user']\n43: admin_pass = get_password 'user', node['openstack']['identity']['admin_user']\nadmin_project = node['openstack']['identity']['admin_project']\nadmin_domain = node['openstack']['identity']['admin_domain_name']\nregion = node['openstack']['region']\n\nconnection_params = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-identity_registration.rb\n# Target line: 43\n\n     38: service_type = 'orchestration'\n     39: service_name = 'heat'\n     40: service_domain_name = node['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name']\n     41: heat_domain_name = node['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name']\n     42: admin_user = node['openstack']['identity']['admin_user']\n>>>  43: admin_pass = get_password 'user', node['openstack']['identity']['admin_user']\n     44: admin_project = node['openstack']['identity']['admin_project']\n     45: admin_domain = node['openstack']['identity']['admin_domain_name']\n     46: region = node['openstack']['region']\n     47: \n     48: connection_params = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-save_screenshots_in_png_format.rb", "content": "key 'type'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Save screenshots in PNG format\" do\ndomain 'com.apple.screencapture'\n3:   key 'type'\nstring 'png'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-save_screenshots_in_png_format.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Save screenshots in PNG format\" do\n      2:   domain 'com.apple.screencapture'\n>>>   3:   key 'type'\n      4:   string 'png'\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-menu_show_clock_with_date.rb", "content": "key 'DateFormat'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Add date in menubar clock\" do\ndomain 'com.apple.menuextra.clock'\n3:   key 'DateFormat'\nstring \"\\\"EEE MMM d  HH:mm\\\"\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-menu_show_clock_with_date.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Add date in menubar clock\" do\n      2:   domain 'com.apple.menuextra.clock'\n>>>   3:   key 'DateFormat'\n      4:   string \"\\\"EEE MMM d  HH:mm\\\"\"\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_cookbook-openstack-network-recipes-identity_registration.rb", "content": "service_pass = get_password 'service', 'openstack-network'", "line": 35, "detection_span": [30, 40], "with_context": "\ninterfaces = {\npublic: { url: public_endpoint('network') },\ninternal: { url: internal_endpoint('network') },\n}\n\n35: service_pass = get_password 'service', 'openstack-network'\nservice_tenant_name = node['openstack']['network']['conf']['keystone_authtoken']['project_name']\n\nservice_user = node['openstack']['network']['conf']['keystone_authtoken']['username']\nservice_role = node['openstack']['network']['service_role']\nservice_domain_name = node['openstack']['network']['conf']['keystone_authtoken']['user_domain_name']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-network-recipes-identity_registration.rb\n# Target line: 35\n\n     30: interfaces = {\n     31:   public: { url: public_endpoint('network') },\n     32:   internal: { url: internal_endpoint('network') },\n     33: }\n     34: \n>>>  35: service_pass = get_password 'service', 'openstack-network'\n     36: service_tenant_name = node['openstack']['network']['conf']['keystone_authtoken']['project_name']\n     37: \n     38: service_user = node['openstack']['network']['conf']['keystone_authtoken']['username']\n     39: service_role = node['openstack']['network']['service_role']\n     40: service_domain_name = node['openstack']['network']['conf']['keystone_authtoken']['user_domain_name']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb", "content": "server_username = \"_jenkins\"", "line": 47, "detection_span": [42, 52], "with_context": "\nwhen /mac_os_x/\ndefault[:jenkins][:server][:home_dir] = \"/Users/Shared/Jenkins\"\ndefault[:jenkins][:worker][:home_dir] = \"/Users/Shared/Jenkins\"\ndefault[:jenkins][:install_dir]       = \"/usr/local/lib\"\n\n47:   server_username = \"_jenkins\"\nworker_username = \"_jenkins\"\ngroup_name      = \"_jenkins\"\n\ndefault[:rbenv][:default_ruby]        = '1.9.3-p0'\ndefault[:rbenv][:rubies]['1.9.3-p0']  = ''", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb\n# Target line: 47\n\n     42: when /mac_os_x/\n     43:   default[:jenkins][:server][:home_dir] = \"/Users/Shared/Jenkins\"\n     44:   default[:jenkins][:worker][:home_dir] = \"/Users/Shared/Jenkins\"\n     45:   default[:jenkins][:install_dir]       = \"/usr/local/lib\"\n     46: \n>>>  47:   server_username = \"_jenkins\"\n     48:   worker_username = \"_jenkins\"\n     49:   group_name      = \"_jenkins\"\n     50: \n     51:   default[:rbenv][:default_ruby]        = '1.9.3-p0'\n     52:   default[:rbenv][:rubies]['1.9.3-p0']  = ''\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb", "content": "'admin' => 9696,", "line": 118, "detection_span": [113, 123], "with_context": "\n113:   },\n114:   'network' => {\n'name' => 'neutron',\n'description' => 'OpenStack Networking',\n'ports' => {\n118:       'admin' => 9696,\n'internal' => 9696,\n'public' => 9696,\n},\n'uris' => {\n'admin' => '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb\n# Target line: 118\n\n    113:   },\n    114:   'network' => {\n    115:     'name' => 'neutron',\n    116:     'description' => 'OpenStack Networking',\n    117:     'ports' => {\n>>> 118:       'admin' => 9696,\n    119:       'internal' => 9696,\n    120:       'public' => 9696,\n    121:     },\n    122:     'uris' => {\n    123:       'admin' => '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sous-chefs_sc-mongodb-recipes-mongodb_org_repo.rb", "content": "key \"https://www.mongodb.org/static/pgp/server-#{package_version_major}.asc\"", "line": 47, "detection_span": [42, 52], "with_context": "\n# Debian: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-debian/\napt_repository 'mongodb' do\nuri node['mongodb']['repo']\ndistribution \"#{node['lsb']['codename']}/mongodb-org/#{package_version_major}\"\ncomponents platform?('ubuntu') ? ['multiverse'] : ['main']\n47:     key \"https://www.mongodb.org/static/pgp/server-#{package_version_major}.asc\"\nend\nwhen 'amazon', 'fedora', 'rhel'\n# RHEL: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\n# Amazon: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-amazon/\nyum_repository 'mongodb' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sous-chefs_sc-mongodb-recipes-mongodb_org_repo.rb\n# Target line: 47\n\n     42:   # Debian: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-debian/\n     43:   apt_repository 'mongodb' do\n     44:     uri node['mongodb']['repo']\n     45:     distribution \"#{node['lsb']['codename']}/mongodb-org/#{package_version_major}\"\n     46:     components platform?('ubuntu') ? ['multiverse'] : ['main']\n>>>  47:     key \"https://www.mongodb.org/static/pgp/server-#{package_version_major}.asc\"\n     48:   end\n     49: when 'amazon', 'fedora', 'rhel'\n     50:   # RHEL: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\n     51:   # Amazon: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-amazon/\n     52:   yum_repository 'mongodb' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Soluciones_ey-cloud-recipes-cookbooks-eybackup_slave-recipes-default.rb", "content": "key = `gpg --list-keys --with-colon | awk -F: '$1==\"pub\"{print $5}'`", "line": 52, "detection_span": [47, 57], "with_context": "\n\n# import key\nexecute \"gpg --import /root/backup_pgp_key\" if node[:public_key]\n\n# add the -k flag to the command\n52:       key = `gpg --list-keys --with-colon | awk -F: '$1==\"pub\"{print $5}'`\nbackup_command << \" -k #{key}\".rstrip unless key.empty?\nend\n\nbackup_command << \" >> /var/log/eybackup.log\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-eybackup_slave-recipes-default.rb\n# Target line: 52\n\n     47:     \n     48:       # import key\n     49:       execute \"gpg --import /root/backup_pgp_key\" if node[:public_key]\n     50:     \n     51:       # add the -k flag to the command\n>>>  52:       key = `gpg --list-keys --with-colon | awk -F: '$1==\"pub\"{print $5}'`\n     53:       backup_command << \" -k #{key}\".rstrip unless key.empty?\n     54:     end\n     55: \n     56:     backup_command << \" >> /var/log/eybackup.log\"\n     57: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guntukukamal_chef-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']       = 'www-data'", "line": 60, "detection_span": [55, 65], "with_context": "\ndefault['nginx']['default_root'] = '/usr/local/www/nginx-dist'\nwhen 'suse'\ndefault['nginx']['user']       = 'wwwrun'\ndefault['nginx']['group']      = 'www'\nelse # debian probably\n60:   default['nginx']['user']       = 'www-data'\nend\n\ndefault['nginx']['upstart']['runlevels']     = '2345'\ndefault['nginx']['upstart']['respawn_limit'] = nil\ndefault['nginx']['upstart']['foreground']    = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guntukukamal_chef-cookbooks-nginx-attributes-default.rb\n# Target line: 60\n\n     55:   default['nginx']['default_root'] = '/usr/local/www/nginx-dist'\n     56: when 'suse'\n     57:   default['nginx']['user']       = 'wwwrun'\n     58:   default['nginx']['group']      = 'www'\n     59: else # debian probably\n>>>  60:   default['nginx']['user']       = 'www-data'\n     61: end\n     62: \n     63: default['nginx']['upstart']['runlevels']     = '2345'\n     64: default['nginx']['upstart']['respawn_limit'] = nil\n     65: default['nginx']['upstart']['foreground']    = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-etl_jobs-attributes-default.rb", "content": "default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"", "line": 28, "detection_span": [23, 33], "with_context": "\ndefault[:etl][:event_job][:log_directory] = \"/isilon/event/\"\nwhen /^stage/\ndefault[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://10.5.50.101;databaseName=IHRDWH\"\ndefault[:etl][:data_warehouse][:host] = \"iad-dwh.prod.ihr\"\ndefault[:etl][:data_warehouse][:port] = \"1433\"\n28:   default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\ndefault[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\ndefault[:etl][:event_job][:archive_directory] = \"/data/log/event/processed\"\ndefault[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\ndefault[:etl][:event_job][:log_directory] = \"/data/log/event\"\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-etl_jobs-attributes-default.rb\n# Target line: 28\n\n     23:   default[:etl][:event_job][:log_directory] = \"/isilon/event/\"\n     24: when /^stage/\n     25:   default[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://10.5.50.101;databaseName=IHRDWH\"\n     26:   default[:etl][:data_warehouse][:host] = \"iad-dwh.prod.ihr\"\n     27:   default[:etl][:data_warehouse][:port] = \"1433\"\n>>>  28:   default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\n     29:   default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\n     30:   default[:etl][:event_job][:archive_directory] = \"/data/log/event/processed\"\n     31:   default[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\n     32:   default[:etl][:event_job][:log_directory] = \"/data/log/event\"\n     33: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-compute-attributes-nova_conf.rb", "content": "conf['keystone_authtoken']['username'] = 'nova'", "line": 18, "detection_span": [13, 23], "with_context": "\nend\n\n# [keystone_authtoken]\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']\n18:   conf['keystone_authtoken']['username'] = 'nova'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_name'] = 'service'\nconf['keystone_authtoken']['auth_version'] = 'v3'\nconf['keystone_authtoken']['service_token_roles_required'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-compute-attributes-nova_conf.rb\n# Target line: 18\n\n     13:   end\n     14: \n     15:   # [keystone_authtoken]\n     16:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n     17:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n>>>  18:   conf['keystone_authtoken']['username'] = 'nova'\n     19:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n     20:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     21:   conf['keystone_authtoken']['project_name'] = 'service'\n     22:   conf['keystone_authtoken']['auth_version'] = 'v3'\n     23:   conf['keystone_authtoken']['service_token_roles_required'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-ops-database-recipes-mariadb-server.rb", "content": "username ''", "line": 77, "detection_span": [72, 82], "with_context": "\nnotifies :restart, 'service[mysql]', :immediately\nend\n\n# Remove anonymous localhost user\nmariadb_user 'anonymous' do\n77:   username ''\nhost 'localhost'\nctrl_password super_password\naction :drop\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-ops-database-recipes-mariadb-server.rb\n# Target line: 77\n\n     72:   notifies :restart, 'service[mysql]', :immediately\n     73: end\n     74: \n     75: # Remove anonymous localhost user\n     76: mariadb_user 'anonymous' do\n>>>  77:   username ''\n     78:   host 'localhost'\n     79:   ctrl_password super_password\n     80:   action :drop\n     81: end\n     82: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sharmamukesh76_chef-kibana-recipes-examples.rb", "content": "user 'kibana'", "line": 37, "detection_span": [32, 42], "with_context": "\ninstall_type 'file'\nend\n\nkibana_install 'git' do\nname 'kibana-git'\n37:   user 'kibana'\ngroup 'kibana'\ninstall_dir '/opt/kibana-git'\ninstall_type 'git'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sharmamukesh76_chef-kibana-recipes-examples.rb\n# Target line: 37\n\n     32:   install_type 'file'\n     33: end\n     34: \n     35: kibana_install 'git' do\n     36:   name 'kibana-git'\n>>>  37:   user 'kibana'\n     38:   group 'kibana'\n     39:   install_dir '/opt/kibana-git'\n     40:   install_type 'git'\n     41: end\n     42: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb", "content": "default[\"bcpc\"][\"hadoop\"][\"restart_lock\"][\"root\"] = \"/\"", "line": 52, "detection_span": [47, 57], "with_context": "\n#\n# Number of tries to acquire the lock required to restart the process\ndefault[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"max_tries\"] = 5\n# The path in ZK where the restart locks (znodes)  need to be created\n# The path should exist in ZooKeeper e.g. \"/lock\" and the default is \"/\"\n52: default[\"bcpc\"][\"hadoop\"][\"restart_lock\"][\"root\"] = \"/\"\n# Sleep time in seconds between tries to acquire the lock for restart\ndefault[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"sleep_time\"] = 2\n# Flag to set whether the restart process was successful or not\ndefault[\"bcpc\"][\"hadoop\"][\"datanode\"][\"restart_failed\"] = false\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb\n# Target line: 52\n\n     47: #\n     48: # Number of tries to acquire the lock required to restart the process\n     49: default[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"max_tries\"] = 5\n     50: # The path in ZK where the restart locks (znodes)  need to be created\n     51: # The path should exist in ZooKeeper e.g. \"/lock\" and the default is \"/\"\n>>>  52: default[\"bcpc\"][\"hadoop\"][\"restart_lock\"][\"root\"] = \"/\"\n     53: # Sleep time in seconds between tries to acquire the lock for restart\n     54: default[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"sleep_time\"] = 2\n     55: # Flag to set whether the restart process was successful or not\n     56: default[\"bcpc\"][\"hadoop\"][\"datanode\"][\"restart_failed\"] = false\n     57: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb", "content": "default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN", "line": 123, "detection_span": [118, 128], "with_context": "\n118: default[:bcpc][:hadoop][:os][:group][:hadoop][:members]=[\"hdfs\",\"yarn\"]\n119: default[:bcpc][:hadoop][:os][:group][:hdfs][:members]=[\"hdfs\"]\n120: default[:bcpc][:hadoop][:os][:group][:mapred][:members]=[\"yarn\"]\n121:\n122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb\n# Target line: 123\n\n    118: default[:bcpc][:hadoop][:os][:group][:hadoop][:members]=[\"hdfs\",\"yarn\"]\n    119: default[:bcpc][:hadoop][:os][:group][:hdfs][:members]=[\"hdfs\"]\n    120: default[:bcpc][:hadoop][:os][:group][:mapred][:members]=[\"yarn\"]\n    121: \n    122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n>>> 123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n    124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n    125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n    126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n    127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n    128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb", "content": "'admin' => 'v2/%(project_id)s',", "line": 53, "detection_span": [48, 58], "with_context": "\n'admin' => 8776,\n'internal' => 8776,\n'public' => 8776,\n},\n'uris' => {\n53:       'admin' => 'v2/%(project_id)s',\n'internal' => 'v2/%(project_id)s',\n'public' => 'v2/%(project_id)s',\n},\n},\n'volumev3' => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb\n# Target line: 53\n\n     48:       'admin' => 8776,\n     49:       'internal' => 8776,\n     50:       'public' => 8776,\n     51:     },\n     52:     'uris' => {\n>>>  53:       'admin' => 'v2/%(project_id)s',\n     54:       'internal' => 'v2/%(project_id)s',\n     55:       'public' => 'v2/%(project_id)s',\n     56:     },\n     57:   },\n     58:   'volumev3' => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-trackpad_double_tap_to_drag_with_drag_lock.rb", "content": "key 'Dragging'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Double-tap to drag with drag lock 1/2\" do\ndomain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'\n3:   key 'Dragging'\nboolean true\nend\n\nosxdefaults_defaults \"Double-tap to drag with drag lock 2/2\" do\ndomain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-trackpad_double_tap_to_drag_with_drag_lock.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Double-tap to drag with drag lock 1/2\" do\n      2:   domain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'\n>>>   3:   key 'Dragging'\n      4:   boolean true\n      5: end\n      6: \n      7: osxdefaults_defaults \"Double-tap to drag with drag lock 2/2\" do\n      8:   domain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Nikhil424_chef-repo-cookbooks-mysql-attributes-default.rb", "content": "default['mysql']['server_debian_password'] = nil", "line": 6, "detection_span": [1, 11], "with_context": "\n#\ndefault['mysql']['service_name'] = 'default'\n\n# passwords\ndefault['mysql']['server_root_password'] = 'ilikerandompasswords'\n6: default['mysql']['server_debian_password'] = nil\ndefault['mysql']['server_repl_password'] = nil\n\n# used in grants.sql\ndefault['mysql']['allow_remote_root'] = false\ndefault['mysql']['remove_anonymous_users'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-mysql-attributes-default.rb\n# Target line: 6\n\n      1: #\n      2: default['mysql']['service_name'] = 'default'\n      3: \n      4: # passwords\n      5: default['mysql']['server_root_password'] = 'ilikerandompasswords'\n>>>   6: default['mysql']['server_debian_password'] = nil\n      7: default['mysql']['server_repl_password'] = nil\n      8: \n      9: # used in grants.sql\n     10: default['mysql']['allow_remote_root'] = false\n     11: default['mysql']['remove_anonymous_users'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-rsyslog-attributes-default.rb", "content": "default[\"rsyslog\"][\"user\"] = \"syslog\"", "line": 42, "detection_span": [37, 47], "with_context": "\nif  node['platform_version'].to_f >= 10.10 then\ndefault[\"rsyslog\"][\"user\"] = \"root\"\ndefault[\"rsyslog\"][\"group\"] = \"adm\"\ndefault[\"rsyslog\"][\"priv_seperation\"] = false\nelse\n42:     default[\"rsyslog\"][\"user\"] = \"syslog\"\ndefault[\"rsyslog\"][\"group\"] = \"adm\"\ndefault[\"rsyslog\"][\"priv_seperation\"] = true\nend\nelse\n#values for fedora at least", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-rsyslog-attributes-default.rb\n# Target line: 42\n\n     37:   if  node['platform_version'].to_f >= 10.10 then\n     38:     default[\"rsyslog\"][\"user\"] = \"root\"\n     39:     default[\"rsyslog\"][\"group\"] = \"adm\"\n     40:     default[\"rsyslog\"][\"priv_seperation\"] = false\n     41:   else\n>>>  42:     default[\"rsyslog\"][\"user\"] = \"syslog\"\n     43:     default[\"rsyslog\"][\"group\"] = \"adm\"\n     44:     default[\"rsyslog\"][\"priv_seperation\"] = true\n     45:   end\n     46: else\n     47:   #values for fedora at least\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-nagios-attributes-server.rb", "content": "default['nagios']['ssl_cert_key']    = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"", "line": 57, "detection_span": [52, 62], "with_context": "\ndefault['nagios']['docroot']    = '/usr/share/nagios3/htdocs'\ndefault['nagios']['enable_ssl'] = false\ndefault['nagios']['http_port']  = node['nagios']['enable_ssl'] ? '443' : '80'\ndefault['nagios']['server_name'] = node.has_key?(:domain) ? \"nagios.#{domain}\" : 'nagios'\ndefault['nagios']['ssl_cert_file']   = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\n57: default['nagios']['ssl_cert_key']    = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\ndefault['nagios']['ssl_cert_chain']  = \"\"\ndefault['nagios']['ssl_req'] = '/C=US/ST=Several/L=Locality/O=Example/OU=Operations/' +\n\"CN=#{node['nagios']['server_name']}/emailAddress=ops@#{node['nagios']['server_name']}\"\n\n# for server from source installation", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-nagios-attributes-server.rb\n# Target line: 57\n\n     52: default['nagios']['docroot']    = '/usr/share/nagios3/htdocs'\n     53: default['nagios']['enable_ssl'] = false\n     54: default['nagios']['http_port']  = node['nagios']['enable_ssl'] ? '443' : '80'\n     55: default['nagios']['server_name'] = node.has_key?(:domain) ? \"nagios.#{domain}\" : 'nagios'\n     56: default['nagios']['ssl_cert_file']   = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\n>>>  57: default['nagios']['ssl_cert_key']    = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\n     58: default['nagios']['ssl_cert_chain']  = \"\"\n     59: default['nagios']['ssl_req'] = '/C=US/ST=Several/L=Locality/O=Example/OU=Operations/' +\n     60:   \"CN=#{node['nagios']['server_name']}/emailAddress=ops@#{node['nagios']['server_name']}\"\n     61: \n     62: # for server from source installation\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wazuh_wazuh-chef-cookbooks-filebeat-oss-recipes-repository.rb", "content": "key 'https://packages.wazuh.com/key/GPG-KEY-WAZUH'", "line": 15, "detection_span": [10, 20], "with_context": "\nplugin 'lsb'\nsubscribes :reload, 'package[lsb-release]', :immediately\nend\n\napt_repository 'wazuh' do\n15:     key 'https://packages.wazuh.com/key/GPG-KEY-WAZUH'\nuri \"https://packages.wazuh.com/#{node['wazuh']['major_version']}/apt/\"\ncomponents ['main']\ndistribution 'stable'\naction :add\nnot_if {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: wazuh_wazuh-chef-cookbooks-filebeat-oss-recipes-repository.rb\n# Target line: 15\n\n     10:     plugin 'lsb'\n     11:     subscribes :reload, 'package[lsb-release]', :immediately\n     12:   end\n     13: \n     14:   apt_repository 'wazuh' do\n>>>  15:     key 'https://packages.wazuh.com/key/GPG-KEY-WAZUH'\n     16:     uri \"https://packages.wazuh.com/#{node['wazuh']['major_version']}/apt/\"\n     17:     components ['main']\n     18:     distribution 'stable'\n     19:     action :add\n     20:     not_if {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-attributes-default.rb", "content": "set_unless[:repo][:default][:svn_username] = \"\"", "line": 11, "detection_span": [6, 16], "with_context": "\n# if applicable, other agreements such as a RightScale Master Subscription Agreement.\n\nset_unless[:repo][:default][:repository] = \"\"\nset_unless[:repo][:default][:revision] = \"HEAD\"\nset_unless[:repo][:default][:provider] = \"repo_git\"\n11: set_unless[:repo][:default][:svn_username] = \"\"\nset_unless[:repo][:default][:svn_password] = \"\"\nset_unless[:repo][:default][:git_ssh_key] = \"\"\nset_unless[:repo][:default][:storage_account_provider] = \"S3\"\nset_unless[:repo][:default][:storage_account_id] = \"\"\nset_unless[:repo][:default][:storage_account_secret] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-attributes-default.rb\n# Target line: 11\n\n      6: # if applicable, other agreements such as a RightScale Master Subscription Agreement.\n      7: \n      8: set_unless[:repo][:default][:repository] = \"\"\n      9: set_unless[:repo][:default][:revision] = \"HEAD\"\n     10: set_unless[:repo][:default][:provider] = \"repo_git\"\n>>>  11: set_unless[:repo][:default][:svn_username] = \"\"\n     12: set_unless[:repo][:default][:svn_password] = \"\"\n     13: set_unless[:repo][:default][:git_ssh_key] = \"\"\n     14: set_unless[:repo][:default][:storage_account_provider] = \"S3\"\n     15: set_unless[:repo][:default][:storage_account_id] = \"\"\n     16: set_unless[:repo][:default][:storage_account_secret] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-db-attributes-default.rb", "content": "set_unless[:db][:current_master_uuid] = nil", "line": 42, "detection_span": [37, 47], "with_context": "\n\n# Default value for DB master/slave check\nset_unless[:db][:this_is_master] = false\n\n# Instance UUID and ip default values\n42: set_unless[:db][:current_master_uuid] = nil\nset_unless[:db][:current_master_ip] = nil\n\n\n# Calculate recommended backup times for master/slave\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-db-attributes-default.rb\n# Target line: 42\n\n     37: \n     38: # Default value for DB master/slave check\n     39: set_unless[:db][:this_is_master] = false\n     40: \n     41: # Instance UUID and ip default values\n>>>  42: set_unless[:db][:current_master_uuid] = nil\n     43: set_unless[:db][:current_master_ip] = nil\n     44: \n     45: \n     46: # Calculate recommended backup times for master/slave\n     47: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-mariadb-resources-server_install.rb", "content": "mariadb_root_password = (new_resource.password == 'generate' || new_resource.password.nil?) ? secure_random : new_resource.password", "line": 65, "detection_span": [60, 70], "with_context": "\nend\n\n# here we want to generate a new password if: 1- the user passed 'generate' to the password argument\n#                                             2- the user did not pass anything to the password argument OR\n#                                                the user did not define node['mariadb']['server_root_password'] attribute\n65:   mariadb_root_password = (new_resource.password == 'generate' || new_resource.password.nil?) ? secure_random : new_resource.password\n\n# Here we make sure to escape all \\ ' and \" characters so that they will be preserved in the final password\nmariadb_root_password = mariadb_root_password.gsub('\\\\', '\\\\\\\\\\\\').gsub('\\'', '\\\\\\\\\\'').gsub('\"', '\\\\\\\\\"')\n\n# Store the password in the run state for any other resources that may need it.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-mariadb-resources-server_install.rb\n# Target line: 65\n\n     60:   end\n     61: \n     62:   # here we want to generate a new password if: 1- the user passed 'generate' to the password argument\n     63:   #                                             2- the user did not pass anything to the password argument OR\n     64:   #                                                the user did not define node['mariadb']['server_root_password'] attribute\n>>>  65:   mariadb_root_password = (new_resource.password == 'generate' || new_resource.password.nil?) ? secure_random : new_resource.password\n     66: \n     67:   # Here we make sure to escape all \\ ' and \" characters so that they will be preserved in the final password\n     68:   mariadb_root_password = mariadb_root_password.gsub('\\\\', '\\\\\\\\\\\\').gsub('\\'', '\\\\\\\\\\'').gsub('\"', '\\\\\\\\\"')\n     69: \n     70:   # Store the password in the run state for any other resources that may need it.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_devel-attributes-talend.rb", "content": "default['imos_devel']['talend']['user'] = \"root\"", "line": 4, "detection_span": [1, 9], "with_context": "\n# Target installation directory for talend\ndefault['imos_devel']['talend']['install_dir'] = \"/var/lib/talend\"\n# Chown talend installation to this user\n4: default['imos_devel']['talend']['user'] = \"root\"\n\ndefault['imos_devel']['talend']['packages'] = [\n{\n\"source_url\" => \"https://s3-ap-southeast-2.amazonaws.com/imos-binary/static/talend/TOS_DI-r96646-V5.1.3.zip\",\n\"unzip_filter\" => \"TOS_DI-r96646-V5.1.3/*\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_devel-attributes-talend.rb\n# Target line: 4\n\n      1: # Target installation directory for talend\n      2: default['imos_devel']['talend']['install_dir'] = \"/var/lib/talend\"\n      3: # Chown talend installation to this user\n>>>   4: default['imos_devel']['talend']['user'] = \"root\"\n      5: \n      6: default['imos_devel']['talend']['packages'] = [\n      7:     {\n      8:         \"source_url\" => \"https://s3-ap-southeast-2.amazonaws.com/imos-binary/static/talend/TOS_DI-r96646-V5.1.3.zip\",\n      9:         \"unzip_filter\" => \"TOS_DI-r96646-V5.1.3/*\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-postgresql-libraries-postgresql.rb", "content": "config[:password] = postgresql_password config[:username] unless config[:password]", "line": 9, "detection_span": [4, 14], "with_context": "\nlocal_storage_read \"postgresql_password:#{user}\"\nend\n\ndef postgresql_config key\nconfig = extract_config key\n9:     config[:password] = postgresql_password config[:username] unless config[:password]\nconfig\nend\n\ndef postgresql_compute_host key\nconfig = extract_config key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-postgresql-libraries-postgresql.rb\n# Target line: 9\n\n      4:     local_storage_read \"postgresql_password:#{user}\"\n      5:   end\n      6: \n      7:   def postgresql_config key\n      8:     config = extract_config key\n>>>   9:     config[:password] = postgresql_password config[:username] unless config[:password]\n     10:     config\n     11:   end\n     12: \n     13:   def postgresql_compute_host key\n     14:     config = extract_config key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb", "content": "generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"", "line": 118, "detection_span": [113, 123], "with_context": "\nsensitive true\n114:   end\n115:\n116:   pam_services = %w(sudo su sshd)\n117:   pam_config_dir = \"/etc/pam.d\"\n118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\nssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\ntemplate generate_ssh_key_path do\nsource 'directory_service/generate_ssh_key.sh.erb'\nowner 'root'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb\n# Target line: 118\n\n    113:     sensitive true\n    114:   end\n    115: \n    116:   pam_services = %w(sudo su sshd)\n    117:   pam_config_dir = \"/etc/pam.d\"\n>>> 118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\n    119:   ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n    120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\n    121:     template generate_ssh_key_path do\n    122:       source 'directory_service/generate_ssh_key.sh.erb'\n    123:       owner 'root'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-ceilometer_conf.rb", "content": "conf['service_credentials']['username'] = 'ceilometer'", "line": 12, "detection_span": [7, 17], "with_context": "\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']\n# [service_credentials] section\n12:   conf['service_credentials']['username'] = 'ceilometer'\nconf['service_credentials']['project_name'] = 'service'\nconf['service_credentials']['user_domain_name'] = 'Default'\nconf['service_credentials']['project_domain_name'] = 'Default'\nconf['service_credentials']['auth_type'] = 'v3password'\nconf['service_credentials']['interface'] = 'internal'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-ceilometer_conf.rb\n# Target line: 12\n\n      7:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n      8:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n      9:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     10:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n     11:   # [service_credentials] section\n>>>  12:   conf['service_credentials']['username'] = 'ceilometer'\n     13:   conf['service_credentials']['project_name'] = 'service'\n     14:   conf['service_credentials']['user_domain_name'] = 'Default'\n     15:   conf['service_credentials']['project_domain_name'] = 'Default'\n     16:   conf['service_credentials']['auth_type'] = 'v3password'\n     17:   conf['service_credentials']['interface'] = 'internal'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb", "content": "default[:hadoop][:namenode    ][:user]  = 'hdfs'", "line": 96, "detection_span": [91, 101], "with_context": "\n\ndefault[:users ]['mapred'     ][:uid]   = 303\ndefault[:groups]['mapred'     ][:gid]   = 303\n\ndefault[:hadoop][:user]                 = 'hdfs'\n96: default[:hadoop][:namenode    ][:user]  = 'hdfs'\ndefault[:hadoop][:secondarynn ][:user]  = 'hdfs'\ndefault[:hadoop][:jobtracker  ][:user]  = 'mapred'\ndefault[:hadoop][:datanode    ][:user]  = 'hdfs'\n100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n101:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb\n# Target line: 96\n\n     91: \n     92: default[:users ]['mapred'     ][:uid]   = 303\n     93: default[:groups]['mapred'     ][:gid]   = 303\n     94: \n     95: default[:hadoop][:user]                 = 'hdfs'\n>>>  96: default[:hadoop][:namenode    ][:user]  = 'hdfs'\n     97: default[:hadoop][:secondarynn ][:user]  = 'hdfs'\n     98: default[:hadoop][:jobtracker  ][:user]  = 'mapred'\n     99: default[:hadoop][:datanode    ][:user]  = 'hdfs'\n    100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n    101: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb", "content": "server_username = \"jenkins\"", "line": 61, "detection_span": [56, 66], "with_context": "\ndefault[:jenkins][:server][:home_dir] = \"/var/lib/jenkins\"\ndefault[:jenkins][:worker][:home_dir] = \"/var/lib/jenkins_worker\"\ndefault[:jenkins][:install_dir]       = \"/usr/share/jenkins\"\ndefault[:jenkins][:worker][:shell]    = \"/bin/bash\"\n\n61:   server_username = \"jenkins\"\nworker_username = \"jenkins_worker\"\ngroup_name      = \"jenkins\"\nend\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb\n# Target line: 61\n\n     56:   default[:jenkins][:server][:home_dir] = \"/var/lib/jenkins\"\n     57:   default[:jenkins][:worker][:home_dir] = \"/var/lib/jenkins_worker\"\n     58:   default[:jenkins][:install_dir]       = \"/usr/share/jenkins\"\n     59:   default[:jenkins][:worker][:shell]    = \"/bin/bash\"\n     60: \n>>>  61:   server_username = \"jenkins\"\n     62:   worker_username = \"jenkins_worker\"\n     63:   group_name      = \"jenkins\"\n     64: end\n     65: \n     66: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_swift-attributes-default.rb", "content": "default[\"swift\"][\"service_user\"] = \"swift\"                                  # node_attribute", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault[\"swift\"][\"disk_enum_expr\"] = \"node[:block_device]\"                  # cluster_attribute\ndefault[\"swift\"][\"auto_rebuild_rings\"] = false                              # cluster_attribute\ndefault[\"swift\"][\"autozone\"] = false                                        # cluster_attribute\n\ndefault[\"swift\"][\"service_tenant_name\"] = \"service\"                         # node_attribute\n11: default[\"swift\"][\"service_user\"] = \"swift\"                                  # node_attribute\ndefault[\"swift\"][\"dispersion_service_user\"] = \"dispersion\"                  # node_attribute\n# Replacing with OpenSSL::Password in recipes/proxy-server.rb\n#default[\"swift\"][\"service_pass\"] = \"tYPvpd5F\"\ndefault[\"swift\"][\"service_role\"] = \"admin\"                                  # node_attribute\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-attributes-default.rb\n# Target line: 11\n\n      6: default[\"swift\"][\"disk_enum_expr\"] = \"node[:block_device]\"                  # cluster_attribute\n      7: default[\"swift\"][\"auto_rebuild_rings\"] = false                              # cluster_attribute\n      8: default[\"swift\"][\"autozone\"] = false                                        # cluster_attribute\n      9: \n     10: default[\"swift\"][\"service_tenant_name\"] = \"service\"                         # node_attribute\n>>>  11: default[\"swift\"][\"service_user\"] = \"swift\"                                  # node_attribute\n     12: default[\"swift\"][\"dispersion_service_user\"] = \"dispersion\"                  # node_attribute\n     13: # Replacing with OpenSSL::Password in recipes/proxy-server.rb\n     14: #default[\"swift\"][\"service_pass\"] = \"tYPvpd5F\"\n     15: default[\"swift\"][\"service_role\"] = \"admin\"                                  # node_attribute\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-postgresql-definitions-postgresql_database.rb", "content": "config[:password] = local_storage_read(\"postgresql_password:#{config[:username]}\") do", "line": 11, "detection_span": [6, 16], "with_context": "\nconfig = extract_config postgresql_database_params[:name]\n\nif config[:host] == \"localhost\"\n\nunless config[:password]\n11:       config[:password] = local_storage_read(\"postgresql_password:#{config[:username]}\") do\nPasswordGenerator.generate 32\nend\nend\n\nexecute \"create user #{config[:username]}\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-postgresql-definitions-postgresql_database.rb\n# Target line: 11\n\n      6:   config = extract_config postgresql_database_params[:name]\n      7: \n      8:   if config[:host] == \"localhost\"\n      9: \n     10:     unless config[:password]\n>>>  11:       config[:password] = local_storage_read(\"postgresql_password:#{config[:username]}\") do\n     12:         PasswordGenerator.generate 32\n     13:       end\n     14:     end\n     15: \n     16:     execute \"create user #{config[:username]}\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['username'] = nil", "line": 97, "detection_span": [92, 102], "with_context": "\ndefault['yum']['main']['syslog_ident'] = nil\ndefault['yum']['main']['throttle'] = nil # [/\\d+k/, /\\d+M/, /\\d+G/]\ndefault['yum']['main']['timeout'] = nil # /\\d+/\ndefault['yum']['main']['tolerant'] = false\ndefault['yum']['main']['tsflags'] = nil\n97: default['yum']['main']['username'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-yum-attributes-main.rb\n# Target line: 97\n\n     92: default['yum']['main']['syslog_ident'] = nil\n     93: default['yum']['main']['throttle'] = nil # [/\\d+k/, /\\d+M/, /\\d+G/]\n     94: default['yum']['main']['timeout'] = nil # /\\d+/\n     95: default['yum']['main']['tolerant'] = false\n     96: default['yum']['main']['tsflags'] = nil\n>>>  97: default['yum']['main']['username'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb", "content": "default[:package_set][:pkgs][:sysadmin] = %w[ tree chkconfig dstat sysstat nmap ]", "line": 89, "detection_span": [84, 94], "with_context": "\n\ncase node.platform\nwhen 'centos', 'redhat'\ndefault[:package_set][:pkgs][:base]     = %w[ tree git zip openssl wget curl runit libxslt-devel ]\ndefault[:package_set][:pkgs][:dev]      = %w[ elinks w3m ctags-etags emacs-nox zsh thrift nc ]\n89:   default[:package_set][:pkgs][:sysadmin] = %w[ tree chkconfig dstat sysstat nmap ]\ndefault[:package_set][:pkgs][:text]     = %w[ libidn-devel libxml2-devel libxslt-devel tidy ]\ndefault[:package_set][:pkgs][:python]   = %w[ python-devel python-setuptools python-simplejson ]\ndefault[:package_set][:pkgs][:emacs]    = %w[ emacs-nox emacs-el ctags-etags ]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb\n# Target line: 89\n\n     84: \n     85: case node.platform\n     86: when 'centos', 'redhat'\n     87:   default[:package_set][:pkgs][:base]     = %w[ tree git zip openssl wget curl runit libxslt-devel ]\n     88:   default[:package_set][:pkgs][:dev]      = %w[ elinks w3m ctags-etags emacs-nox zsh thrift nc ]\n>>>  89:   default[:package_set][:pkgs][:sysadmin] = %w[ tree chkconfig dstat sysstat nmap ]\n     90:   default[:package_set][:pkgs][:text]     = %w[ libidn-devel libxml2-devel libxslt-devel tidy ]\n     91:   default[:package_set][:pkgs][:python]   = %w[ python-devel python-setuptools python-simplejson ]\n     92:   default[:package_set][:pkgs][:emacs]    = %w[ emacs-nox emacs-el ctags-etags ]\n     93: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_magentostack-attributes-magento.rb", "content": "normal['magentostack']['mysql']['databases']['magento_database']['mysql_user'] = 'magento_user'", "line": 47, "detection_span": [42, 52], "with_context": "\ndefault['magentostack']['git_deploykey'] = nil\ndefault['magentostack']['git_submodules'] = false\ndefault['magentostack']['git_ssh_args'] = ['StrictHostKeyChecking=no']\n\n# Database creation by the mysql cookbook\n47: normal['magentostack']['mysql']['databases']['magento_database']['mysql_user'] = 'magento_user'\nnormal['magentostack']['mysql']['databases']['magento_database']['mysql_password'] = 'magento_password'\nnormal['magentostack']['mysql']['databases']['magento_database']['privileges'] = ['all']\nnormal['magentostack']['mysql']['databases']['magento_database']['global_privileges'] = [:usage, :select, :'lock tables', :'show view', :reload, :super]\n\n# Magento configuration", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_magentostack-attributes-magento.rb\n# Target line: 47\n\n     42: default['magentostack']['git_deploykey'] = nil\n     43: default['magentostack']['git_submodules'] = false\n     44: default['magentostack']['git_ssh_args'] = ['StrictHostKeyChecking=no']\n     45: \n     46: # Database creation by the mysql cookbook\n>>>  47: normal['magentostack']['mysql']['databases']['magento_database']['mysql_user'] = 'magento_user'\n     48: normal['magentostack']['mysql']['databases']['magento_database']['mysql_password'] = 'magento_password'\n     49: normal['magentostack']['mysql']['databases']['magento_database']['privileges'] = ['all']\n     50: normal['magentostack']['mysql']['databases']['magento_database']['global_privileges'] = [:usage, :select, :'lock tables', :'show view', :reload, :super]\n     51: \n     52: # Magento configuration\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-felix.rb", "content": "cert_type = headnode? ? 'client-rw' : 'client-ro'", "line": 31, "detection_span": [26, 36], "with_context": "\nfile '/etc/calico/felix.cfg.example' do\naction :delete\nend\n\n# determine cert type\n31: cert_type = headnode? ? 'client-rw' : 'client-ro'\n\ntemplate '/etc/calico/calicoctl.cfg' do\nsource 'calico/calicoctl.cfg.erb'\nvariables(\ncert_type: cert_type", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-felix.rb\n# Target line: 31\n\n     26: file '/etc/calico/felix.cfg.example' do\n     27:   action :delete\n     28: end\n     29: \n     30: # determine cert type\n>>>  31: cert_type = headnode? ? 'client-rw' : 'client-ro'\n     32: \n     33: template '/etc/calico/calicoctl.cfg' do\n     34:   source 'calico/calicoctl.cfg.erb'\n     35:   variables(\n     36:     cert_type: cert_type\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-db_create.rb", "content": "user \"postgres\"", "line": 14, "detection_span": [9, 19], "with_context": "\ncommand \"psql -c \\\"create database #{node['db_name']} owner #{node['db_admin_name']};\\\"\"\nnot_if { `sudo -u postgres psql -tAc \\\"SELECT * FROM pg_database WHERE datname='#{node['db_name']}';\\\" | wc -l`.chomp == \"1\" }\nend\n\nexecute \"create adminpack extension\" do\n14:    user \"postgres\"\ncommand \"psql -d #{node['db_name']} -c \\\"create extension adminpack;\\\"\"\nnot_if { `sudo -u postgres psql -d '#{node['db_name']}' -tAc \\\"SELECT * FROM pg_extension where extname = 'adminpack';\\\" | wc -l`.chomp == \"1\" }\nend\n\nexecute \"create hstore extension\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-db_create.rb\n# Target line: 14\n\n      9:    command \"psql -c \\\"create database #{node['db_name']} owner #{node['db_admin_name']};\\\"\"\n     10:    not_if { `sudo -u postgres psql -tAc \\\"SELECT * FROM pg_database WHERE datname='#{node['db_name']}';\\\" | wc -l`.chomp == \"1\" }\n     11: end\n     12: \n     13: execute \"create adminpack extension\" do\n>>>  14:    user \"postgres\"\n     15:    command \"psql -d #{node['db_name']} -c \\\"create extension adminpack;\\\"\"\n     16:    not_if { `sudo -u postgres psql -d '#{node['db_name']}' -tAc \\\"SELECT * FROM pg_extension where extname = 'adminpack';\\\" | wc -l`.chomp == \"1\" }\n     17: end\n     18: \n     19: execute \"create hstore extension\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-web_apache-attributes-default.rb", "content": "set[:web_apache][:docroot] = \"/home/webapp/#{web_apache[:application_name]}\"", "line": 48, "detection_span": [43, 53], "with_context": "\nset_unless[:web_apache][:ssl_certificate_chain] = nil\nset_unless[:web_apache][:ssl_key] = nil\nset_unless[:web_apache][:ssl_passphrase] = nil\n\n# Apache document root\n48: set[:web_apache][:docroot] = \"/home/webapp/#{web_apache[:application_name]}\"\n\n# Default servername for web_apache vhost file\nset[:web_apache][:server_name] = \"localhost\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-web_apache-attributes-default.rb\n# Target line: 48\n\n     43: set_unless[:web_apache][:ssl_certificate_chain] = nil\n     44: set_unless[:web_apache][:ssl_key] = nil\n     45: set_unless[:web_apache][:ssl_passphrase] = nil\n     46: \n     47: # Apache document root\n>>>  48: set[:web_apache][:docroot] = \"/home/webapp/#{web_apache[:application_name]}\"\n     49: \n     50: # Default servername for web_apache vhost file\n     51: set[:web_apache][:server_name] = \"localhost\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb", "content": "default[:hadoop][:tasktracker ][:user]  = 'mapred'", "line": 100, "detection_span": [95, 105], "with_context": "\ndefault[:hadoop][:user]                 = 'hdfs'\ndefault[:hadoop][:namenode    ][:user]  = 'hdfs'\ndefault[:hadoop][:secondarynn ][:user]  = 'hdfs'\ndefault[:hadoop][:jobtracker  ][:user]  = 'mapred'\ndefault[:hadoop][:datanode    ][:user]  = 'hdfs'\n100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n101:\n102: #\n103: # Install\n104: #\n105:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb\n# Target line: 100\n\n     95: default[:hadoop][:user]                 = 'hdfs'\n     96: default[:hadoop][:namenode    ][:user]  = 'hdfs'\n     97: default[:hadoop][:secondarynn ][:user]  = 'hdfs'\n     98: default[:hadoop][:jobtracker  ][:user]  = 'mapred'\n     99: default[:hadoop][:datanode    ][:user]  = 'hdfs'\n>>> 100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n    101: \n    102: #\n    103: # Install\n    104: #\n    105: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb", "content": "default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"", "line": 127, "detection_span": [122, 132], "with_context": "\n122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"\n129:\n130: default[\"bcpc\"][\"hadoop\"][\"java\"] = \"/usr/lib/jvm/java-7-oracle-amd64\"\n131:\n132: default['java']['install_flavor'] = \"oracle\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb\n# Target line: 127\n\n    122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n    123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n    124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n    125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n    126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n>>> 127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n    128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"\n    129: \n    130: default[\"bcpc\"][\"hadoop\"][\"java\"] = \"/usr/lib/jvm/java-7-oracle-amd64\"\n    131: \n    132: default['java']['install_flavor'] = \"oracle\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-master_chef-libraries-local_storage.rb", "content": "result[key] = symbolize_keys v", "line": 68, "detection_span": [63, 73], "with_context": "\nreturn nil unless hash\nreturn hash unless hash.is_a? Hash\nresult = {}\nhash.each do |k, v|\nkey = k.is_a?(String) ? k.to_sym : k\n68:         result[key] = symbolize_keys v\nend\nresult\nend\n\ndef read_file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-master_chef-libraries-local_storage.rb\n# Target line: 68\n\n     63:       return nil unless hash\n     64:       return hash unless hash.is_a? Hash\n     65:       result = {}\n     66:       hash.each do |k, v|\n     67:         key = k.is_a?(String) ? k.to_sym : k\n>>>  68:         result[key] = symbolize_keys v\n     69:       end\n     70:       result\n     71:     end\n     72: \n     73:     def read_file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']       = \"www-data\"", "line": 40, "detection_span": [35, 45], "with_context": "\ndefault['nginx']['init_style'] = \"runit\"\nwhen \"redhat\",\"centos\",\"scientific\",\"amazon\",\"oracle\",\"fedora\"\ndefault['nginx']['user']       = \"nginx\"\ndefault['nginx']['init_style'] = \"init\"\nelse\n40:   default['nginx']['user']       = \"www-data\"\ndefault['nginx']['init_style'] = \"init\"\nend\n\ndefault['nginx']['group'] = node['nginx']['user']\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nginx-attributes-default.rb\n# Target line: 40\n\n     35:   default['nginx']['init_style'] = \"runit\"\n     36: when \"redhat\",\"centos\",\"scientific\",\"amazon\",\"oracle\",\"fedora\"\n     37:   default['nginx']['user']       = \"nginx\"\n     38:   default['nginx']['init_style'] = \"init\"\n     39: else\n>>>  40:   default['nginx']['user']       = \"www-data\"\n     41:   default['nginx']['init_style'] = \"init\"\n     42: end\n     43: \n     44: default['nginx']['group'] = node['nginx']['user']\n     45: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "criteo-cookbooks_nexus3-api_examples-admin.rb", "content": "password 'admin456'", "line": 17, "detection_span": [12, 22], "with_context": "\n# Update admin's email address using the new admin password\nnexus3_api 'admin_update_email' do\ncontent \"def user = security.securitySystem.getUser('admin');\" \\\n\"user.setEmailAddress('admin@mycompany.com');\" \\\n'security.securitySystem.updateUser(user);'\n17:   password 'admin456'\naction :run\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_nexus3-api_examples-admin.rb\n# Target line: 17\n\n     12: # Update admin's email address using the new admin password\n     13: nexus3_api 'admin_update_email' do\n     14:   content \"def user = security.securitySystem.getUser('admin');\" \\\n     15:     \"user.setEmailAddress('admin@mycompany.com');\" \\\n     16:     'security.securitySystem.updateUser(user);'\n>>>  17:   password 'admin456'\n     18:   action :run\n     19: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-git-attributes-default.rb", "content": "default[:git][:user]        = 'root'", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:git][:user]        = 'root'\ndefault[:git][:deploy_root] = '/etc/deploy'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-git-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:git][:user]        = 'root'\n      2: default[:git][:deploy_root] = '/etc/deploy'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-block-storage-attributes-cinder_conf.rb", "content": "conf['nova']['username'] = 'nova'", "line": 20, "detection_span": [15, 25], "with_context": "\nconf['keystone_authtoken']['project_name'] = 'service'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['nova']['auth_type'] = 'password'\nconf['nova']['region_name'] = node['openstack']['region']\n20:   conf['nova']['username'] = 'nova'\nconf['nova']['project_name'] = 'service'\nconf['nova']['user_domain_name'] = 'Default'\nconf['nova']['project_domain_name'] = 'Default'\n\nconf['oslo_concurrency']['lock_path'] = '/var/lib/cinder/tmp'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-block-storage-attributes-cinder_conf.rb\n# Target line: 20\n\n     15:   conf['keystone_authtoken']['project_name'] = 'service'\n     16:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n     17:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     18:   conf['nova']['auth_type'] = 'password'\n     19:   conf['nova']['region_name'] = node['openstack']['region']\n>>>  20:   conf['nova']['username'] = 'nova'\n     21:   conf['nova']['project_name'] = 'service'\n     22:   conf['nova']['user_domain_name'] = 'Default'\n     23:   conf['nova']['project_domain_name'] = 'Default'\n     24: \n     25:   conf['oslo_concurrency']['lock_path'] = '/var/lib/cinder/tmp'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "thomas-stern_rsed-chef-training-cookbooks-db-attributes-default.rb", "content": "set_unless[:db][:replication][:user] = nil", "line": 23, "detection_span": [18, 28], "with_context": "\n# Default settings for database administrator user and password\nset_unless[:db][:admin][:user] = \"root\"\nset_unless[:db][:admin][:password] = \"\"\n\n# Default settings for database replication user and password\n23: set_unless[:db][:replication][:user] = nil\nset_unless[:db][:replication][:password] = nil\n\n# Default settings for backup lineage\nset_unless[:db][:backup][:lineage] = \"\"\nset_unless[:db][:backup][:lineage_override] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: thomas-stern_rsed-chef-training-cookbooks-db-attributes-default.rb\n# Target line: 23\n\n     18: # Default settings for database administrator user and password\n     19: set_unless[:db][:admin][:user] = \"root\"\n     20: set_unless[:db][:admin][:password] = \"\"\n     21: \n     22: # Default settings for database replication user and password\n>>>  23: set_unless[:db][:replication][:user] = nil\n     24: set_unless[:db][:replication][:password] = nil\n     25: \n     26: # Default settings for backup lineage\n     27: set_unless[:db][:backup][:lineage] = \"\"\n     28: set_unless[:db][:backup][:lineage_override] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb", "content": "key 'NewWindowTargetPath'", "line": 9, "detection_span": [4, 14], "with_context": "\nstring \"PfHm\"\nend\n\nosxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\ndomain 'com.apple.finder'\n9:   key 'NewWindowTargetPath'\nstring \"file://localhost/Users/#{node['current_user']}/\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb\n# Target line: 9\n\n      4:   string \"PfHm\"\n      5: end\n      6: \n      7: osxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\n      8:   domain 'com.apple.finder'\n>>>   9:   key 'NewWindowTargetPath'\n     10:   string \"file://localhost/Users/#{node['current_user']}/\"\n     11: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "logicalclocks_hopsmonitor-chef-recipes-prometheus.rb", "content": "key = \"#{crypto_dir}/#{x509_helper.get_private_key_pkcs8_name(node['hopsmonitor']['user'])}\"", "line": 79, "detection_span": [74, 84], "with_context": "\nto node['prometheus']['home']\nend\n\ncrypto_dir = x509_helper.get_crypto_dir(node['hopsmonitor']['user'])\ncertificate = \"#{crypto_dir}/#{x509_helper.get_certificate_bundle_name(node['hopsmonitor']['user'])}\"\n79: key = \"#{crypto_dir}/#{x509_helper.get_private_key_pkcs8_name(node['hopsmonitor']['user'])}\"\nhops_ca = \"#{crypto_dir}/#{x509_helper.get_hops_ca_bundle_name()}\"\n#check if installation for managed cloud, aka: enterprise installation and installing the cloud recipe\nmanaged_cloud = (node['install']['enterprise']['install'].casecmp? \"true\" and exists_local(\"cloud\", \"default\"))\ntemplate \"#{node['prometheus']['base_dir']}/prometheus.yml\" do\nsource \"prometheus.yml.erb\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: logicalclocks_hopsmonitor-chef-recipes-prometheus.rb\n# Target line: 79\n\n     74:   to node['prometheus']['home']\n     75: end\n     76: \n     77: crypto_dir = x509_helper.get_crypto_dir(node['hopsmonitor']['user'])\n     78: certificate = \"#{crypto_dir}/#{x509_helper.get_certificate_bundle_name(node['hopsmonitor']['user'])}\"\n>>>  79: key = \"#{crypto_dir}/#{x509_helper.get_private_key_pkcs8_name(node['hopsmonitor']['user'])}\"\n     80: hops_ca = \"#{crypto_dir}/#{x509_helper.get_hops_ca_bundle_name()}\"\n     81: #check if installation for managed cloud, aka: enterprise installation and installing the cloud recipe \n     82: managed_cloud = (node['install']['enterprise']['install'].casecmp? \"true\" and exists_local(\"cloud\", \"default\"))\n     83: template \"#{node['prometheus']['base_dir']}/prometheus.yml\" do\n     84:   source \"prometheus.yml.erb\" \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb", "content": "default['hadoop']['yarn_user'] = 'yarn'", "line": 34, "detection_span": [29, 39], "with_context": "\ndefault['hadoop']['data_dir'] = '/var/lib/hadoop'\ndefault['hadoop']['log_dir'] = '/var/log/hadoop'\ndefault['hadoop']['pid_dir'] = '/var/run/hadoop'\ndefault['hadoop']['group'] = 'hadoop'\ndefault['hadoop']['hdfs_user'] = 'hdfs'\n34: default['hadoop']['yarn_user'] = 'yarn'\n\n# Per service settings\ndefault['hadoop']['hdfs-site']\\\n['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'\ndefault['hadoop']['hdfs-site']['dfs.namenode.name.dir'] =", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb\n# Target line: 34\n\n     29: default['hadoop']['data_dir'] = '/var/lib/hadoop'\n     30: default['hadoop']['log_dir'] = '/var/log/hadoop'\n     31: default['hadoop']['pid_dir'] = '/var/run/hadoop'\n     32: default['hadoop']['group'] = 'hadoop'\n     33: default['hadoop']['hdfs_user'] = 'hdfs'\n>>>  34: default['hadoop']['yarn_user'] = 'yarn'\n     35: \n     36: # Per service settings\n     37: default['hadoop']['hdfs-site']\\\n     38:        ['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'\n     39: default['hadoop']['hdfs-site']['dfs.namenode.name.dir'] =\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-diamond-attributes-mysql.rb", "content": "default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\ndefault['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\ndefault['diamond']['collectors']['MySQLCollector']['port'] = 3306\ndefault['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\ndefault['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\n6: default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-diamond-attributes-mysql.rb\n# Target line: 6\n\n      1: default['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\n      2: default['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\n      3: default['diamond']['collectors']['MySQLCollector']['port'] = 3306\n      4: default['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\n      5: default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\n>>>   6: default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_osl-openstack-attributes-default.rb", "content": "default['osl-openstack']['block']['rbd_store_user'] = 'cinder'", "line": 35, "detection_span": [30, 40], "with_context": "\ndefault['osl-openstack']['database_suffix'] = nil\ndefault['osl-openstack']['databag_prefix'] = nil\ndefault['osl-openstack']['compute']['rbd_store_pool'] = 'vms'\ndefault['osl-openstack']['block']['rbd_store_pool'] = 'volumes'\ndefault['osl-openstack']['block']['rbd_ssd_pool'] = 'volumes_ssd'\n35: default['osl-openstack']['block']['rbd_store_user'] = 'cinder'\ndefault['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\ndefault['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\ndefault['osl-openstack']['image']['glance_vol'] = nil\ndefault['osl-openstack']['image']['rbd_store_pool'] = 'images'\ndefault['osl-openstack']['image']['rbd_store_user'] = 'glance'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_osl-openstack-attributes-default.rb\n# Target line: 35\n\n     30: default['osl-openstack']['database_suffix'] = nil\n     31: default['osl-openstack']['databag_prefix'] = nil\n     32: default['osl-openstack']['compute']['rbd_store_pool'] = 'vms'\n     33: default['osl-openstack']['block']['rbd_store_pool'] = 'volumes'\n     34: default['osl-openstack']['block']['rbd_ssd_pool'] = 'volumes_ssd'\n>>>  35: default['osl-openstack']['block']['rbd_store_user'] = 'cinder'\n     36: default['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\n     37: default['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\n     38: default['osl-openstack']['image']['glance_vol'] = nil\n     39: default['osl-openstack']['image']['rbd_store_pool'] = 'images'\n     40: default['osl-openstack']['image']['rbd_store_user'] = 'glance'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jonmthomson_cookbooks-windows-providers-certificate.rb", "content": "password = \", \\\"#{@new_resource.pfx_password}\\\"\" if file.downcase.end_with?('pfx')", "line": 67, "detection_span": [62, 72], "with_context": "\nhash = nil\n\nif ::File.exists?(@new_resource.source)\n# source is a file so get hash from that\nfile = win_friendly_path(@new_resource.source)\n67:     password = \", \\\"#{@new_resource.pfx_password}\\\"\" if file.downcase.end_with?('pfx')\nhash = \"(New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \\\"#{file}\\\"#{password}).GetCertHashString()\"\nelse\n# make sure we have no spaces in the hash string\nhash = \"\\\"#{@new_resource.source.gsub(/\\s/, '')}\\\"\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jonmthomson_cookbooks-windows-providers-certificate.rb\n# Target line: 67\n\n     62:   hash = nil\n     63: \n     64:   if ::File.exists?(@new_resource.source)\n     65:     # source is a file so get hash from that\n     66:     file = win_friendly_path(@new_resource.source)\n>>>  67:     password = \", \\\"#{@new_resource.pfx_password}\\\"\" if file.downcase.end_with?('pfx')\n     68:     hash = \"(New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \\\"#{file}\\\"#{password}).GetCertHashString()\"\n     69:   else\n     70:     # make sure we have no spaces in the hash string\n     71:     hash = \"\\\"#{@new_resource.source.gsub(/\\s/, '')}\\\"\"\n     72:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb", "content": "public_key_format :openssh", "line": 7, "detection_span": [2, 12], "with_context": "\n\n# Create a key that we'll use for org, admin user, and client.\nprivate_key '/shared/keys/test.pem' do\ncipher            'DES-EDE3-CBC'\nformat            :pem\n7:   public_key_format :openssh\npublic_key_path   '/shared/keys/test.pub'\nsize              2048\ntype              :rsa\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb\n# Target line: 7\n\n      2: \n      3: # Create a key that we'll use for org, admin user, and client.\n      4: private_key '/shared/keys/test.pem' do\n      5:   cipher            'DES-EDE3-CBC'\n      6:   format            :pem\n>>>   7:   public_key_format :openssh\n      8:   public_key_path   '/shared/keys/test.pub'\n      9:   size              2048\n     10:   type              :rsa\n     11: end\n     12: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-osm_renderd.rb", "content": "user 'osmdata'", "line": 2, "detection_span": [1, 7], "with_context": "\nbash 'install_mod_tile' do\n2:    user 'osmdata'\ncwd '/home/osmdata/src'\ncode <<-EOH\ncd /home/osmdata/src\ngit clone git://github.com/openstreetmap/mod_tile.git\ncd /home/osmdata/src/mod_tile", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-osm_renderd.rb\n# Target line: 2\n\n      1: bash 'install_mod_tile' do\n>>>   2:    user 'osmdata'\n      3:    cwd '/home/osmdata/src'\n      4:    code <<-EOH\n      5: \tcd /home/osmdata/src\n      6: \tgit clone git://github.com/openstreetmap/mod_tile.git\n      7: \tcd /home/osmdata/src/mod_tile\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-snappy-cookbooks-hbase-attributes-default.rb", "content": "node[:hbase][:user] = 'hbase'", "line": 48, "detection_span": [43, 53], "with_context": "\n#\n# Users\n#\n\n# hbase user\n48: node[:hbase][:user] = 'hbase'\ndefault[:users ]['hbase'     ][:uid]    = 304\ndefault[:groups]['hbase'     ][:gid]    = 304\n\n#\n# Run state of daemons", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-snappy-cookbooks-hbase-attributes-default.rb\n# Target line: 48\n\n     43: #\n     44: # Users\n     45: #\n     46: \n     47: # hbase user\n>>>  48: node[:hbase][:user] = 'hbase'\n     49: default[:users ]['hbase'     ][:uid]    = 304\n     50: default[:groups]['hbase'     ][:gid]    = 304\n     51: \n     52: #\n     53: # Run state of daemons\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-ruby-ng-recipes-default.rb", "content": "key 'C3173AA6'", "line": 10, "detection_span": [5, 15], "with_context": "\napt_repository \"brightbox-#{name}\" do\nuri \"http://ppa.launchpad.net/brightbox/#{name}/ubuntu\"\ndistribution node['lsb']['codename']\ncomponents [ 'main' ]\nkeyserver 'keyserver.ubuntu.com'\n10:   key 'C3173AA6'\nend\n\napt_preference 'ruby-ng-01-disable_by_default' do\nglob '*'\npin \"release o=LP-PPA-brightbox-#{name}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-ruby-ng-recipes-default.rb\n# Target line: 10\n\n      5: apt_repository \"brightbox-#{name}\" do\n      6:   uri \"http://ppa.launchpad.net/brightbox/#{name}/ubuntu\"\n      7:   distribution node['lsb']['codename']\n      8:   components [ 'main' ]\n      9:   keyserver 'keyserver.ubuntu.com'\n>>>  10:   key 'C3173AA6'\n     11: end\n     12: \n     13: apt_preference 'ruby-ng-01-disable_by_default' do\n     14:   glob '*'\n     15:   pin \"release o=LP-PPA-brightbox-#{name}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-storm-attributes-default.rb", "content": "default[:storm][:user]                     = 'storm'", "line": 12, "detection_span": [7, 17], "with_context": "\ndefault[:storm][:jzmq][:release_url]       = 'https://github.com/zeromq/jzmq/archive/v2.1.0.tar.gz'\n\n#\n# Users\n#\n12: default[:storm][:user]                     = 'storm'\ndefault[:users ]['storm'][:uid]            = 370\ndefault[:groups]['storm'][:gid]            = 370\n\n#\n# Directories", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-storm-attributes-default.rb\n# Target line: 12\n\n      7: default[:storm][:jzmq][:release_url]       = 'https://github.com/zeromq/jzmq/archive/v2.1.0.tar.gz'\n      8: \n      9: #\n     10: # Users\n     11: #\n>>>  12: default[:storm][:user]                     = 'storm'\n     13: default[:users ]['storm'][:uid]            = 370\n     14: default[:groups]['storm'][:gid]            = 370\n     15: \n     16: #\n     17: # Directories\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-rvm-cookbooks-zookeeper-attributes-default.rb", "content": "default[:zookeeper][:user]                   = 'zookeeper'", "line": 25, "detection_span": [20, 30], "with_context": "\n\n#\n# User\n#\n\n25: default[:zookeeper][:user]                   = 'zookeeper'\ndefault[:users ]['zookeeper' ][:uid]         = 305\ndefault[:groups]['zookeeper' ][:gid]         = 305\n\n#\n# Install", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-rvm-cookbooks-zookeeper-attributes-default.rb\n# Target line: 25\n\n     20: \n     21: #\n     22: # User\n     23: #\n     24: \n>>>  25: default[:zookeeper][:user]                   = 'zookeeper'\n     26: default[:users ]['zookeeper' ][:uid]         = 305\n     27: default[:groups]['zookeeper' ][:gid]         = 305\n     28: \n     29: #\n     30: # Install\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jenkins-attributes-server.rb", "content": "default['jenkins']['http_proxy']['ssl']['key_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.key\"", "line": 66, "detection_span": [61, 71], "with_context": "\ndefault['jenkins']['http_proxy']['ssl']['enabled'] = false\ndefault['jenkins']['http_proxy']['ssl']['redirect_http'] = false\ndefault['jenkins']['http_proxy']['ssl']['ssl_listen_ports'] = [ 443 ]\ndefault['jenkins']['http_proxy']['ssl']['dir'] = \"#{default['jenkins']['server']['home']}/ssl\"\ndefault['jenkins']['http_proxy']['ssl']['cert_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.cert\"\n66: default['jenkins']['http_proxy']['ssl']['key_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.key\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-attributes-server.rb\n# Target line: 66\n\n     61: default['jenkins']['http_proxy']['ssl']['enabled'] = false\n     62: default['jenkins']['http_proxy']['ssl']['redirect_http'] = false\n     63: default['jenkins']['http_proxy']['ssl']['ssl_listen_ports'] = [ 443 ]\n     64: default['jenkins']['http_proxy']['ssl']['dir'] = \"#{default['jenkins']['server']['home']}/ssl\"\n     65: default['jenkins']['http_proxy']['ssl']['cert_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.cert\"\n>>>  66: default['jenkins']['http_proxy']['ssl']['key_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.key\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-dock_position_the_dock_on_the_right_side.rb", "content": "key 'orientation'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Move the Dock to the right side of the screen\" do\ndomain 'com.apple.dock'\n3:   key 'orientation'\nstring 'right'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-dock_position_the_dock_on_the_right_side.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Move the Dock to the right side of the screen\" do\n      2:   domain 'com.apple.dock'\n>>>   3:   key 'orientation'\n      4:   string 'right'\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-wiki-recipes-default.rb", "content": "database_user \"wiki-user\"", "line": 43, "detection_span": [38, 48], "with_context": "\nfpm_min_spare_servers 10\nfpm_max_spare_servers 20\nfpm_prometheus_port 9253\n\ndatabase_name \"wiki\"\n43:   database_user \"wiki-user\"\ndatabase_password passwords[\"database\"]\n\nadmin_password passwords[\"admin\"]\n\nlogo \"/osm_logo_wiki.png\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-wiki-recipes-default.rb\n# Target line: 43\n\n     38:   fpm_min_spare_servers 10\n     39:   fpm_max_spare_servers 20\n     40:   fpm_prometheus_port 9253\n     41: \n     42:   database_name \"wiki\"\n>>>  43:   database_user \"wiki-user\"\n     44:   database_password passwords[\"database\"]\n     45: \n     46:   admin_password passwords[\"admin\"]\n     47: \n     48:   logo \"/osm_logo_wiki.png\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"6005210E23B3D3B4\"", "line": 104, "detection_span": [99, 109], "with_context": "\napt_repository \"hwraid\" do\n100:   action repository_actions[\"hwraid\"]\n101:   uri \"https://hwraid.le-vert.net/ubuntu\"\n102:   distribution \"precise\"\n103:   components [\"main\"]\n104:   key \"6005210E23B3D3B4\"\n105: end\n106:\n107: apt_repository \"nginx\" do\n108:   action repository_actions[\"nginx\"]\n109:   arch \"amd64\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 104\n\n     99: apt_repository \"hwraid\" do\n    100:   action repository_actions[\"hwraid\"]\n    101:   uri \"https://hwraid.le-vert.net/ubuntu\"\n    102:   distribution \"precise\"\n    103:   components [\"main\"]\n>>> 104:   key \"6005210E23B3D3B4\"\n    105: end\n    106: \n    107: apt_repository \"nginx\" do\n    108:   action repository_actions[\"nginx\"]\n    109:   arch \"amd64\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-warp-attributes-default.rb", "content": "default[:warp][:user] = \"vagrant\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:warp][:user] = \"vagrant\"\ndefault[:warp][:group] = \"vagrant\"\ndefault[:warp][:pid_file] = \"/home/vagrant/twistd.pid\"\ndefault[:warp][:log_file] = \"/home/vagrant/twistd.log\"\ndefault[:warp][:version] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-warp-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:warp][:user] = \"vagrant\"\n      2: default[:warp][:group] = \"vagrant\"\n      3: default[:warp][:pid_file] = \"/home/vagrant/twistd.pid\"\n      4: default[:warp][:log_file] = \"/home/vagrant/twistd.log\"\n      5: default[:warp][:version] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-nodejs-cookbooks-package_set-attributes-default.rb", "content": "default[:package_set][:pkgs][:sysadmin]  = \\", "line": 84, "detection_span": [79, 89], "with_context": "\n] + [\n{ :name => 'activesupport', :version => '3.1.0', },\n{ :name => 'activemodel',   :version => '3.1.0', },\n]\n\n84: default[:package_set][:pkgs][:sysadmin]  = \\\ncase node.platform\nwhen 'centos'\n%w[ dstat tree chkconfig sysstat nmap ]\nelse\n%w[ ifstat htop tree chkconfig sysstat nmap python-software-properties ]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-nodejs-cookbooks-package_set-attributes-default.rb\n# Target line: 84\n\n     79:   ] + [\n     80:     { :name => 'activesupport', :version => '3.1.0', },\n     81:     { :name => 'activemodel',   :version => '3.1.0', },\n     82:   ]\n     83: \n>>>  84: default[:package_set][:pkgs][:sysadmin]  = \\\n     85:     case node.platform\n     86:       when 'centos'\n     87:         %w[ dstat tree chkconfig sysstat nmap ]\n     88:       else\n     89:         %w[ ifstat htop tree chkconfig sysstat nmap python-software-properties ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-database-libraries-provider_database_postgresql.rb", "content": "user = @new_resource.connection[:username] || 'postgres'", "line": 111, "detection_span": [106, 116], "with_context": "\ndef db(dbname = nil)\nclose if @db\ndbname = @new_resource.connection[:database] if @new_resource.connection[:database]\nhost = @new_resource.connection[:host]\nport = @new_resource.connection[:port] || 5432\n111:           user = @new_resource.connection[:username] || 'postgres'\nChef::Log.debug(\"#{@new_resource}: connecting to database #{dbname} on #{host}:#{port} as #{user}\")\npassword = @new_resource.connection[:password] || node[:postgresql][:password][:postgres]\n@db = ::PGconn.new(\n:host => host,\n:port => port,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-database-libraries-provider_database_postgresql.rb\n# Target line: 111\n\n    106:         def db(dbname = nil)\n    107:           close if @db\n    108:           dbname = @new_resource.connection[:database] if @new_resource.connection[:database]\n    109:           host = @new_resource.connection[:host]\n    110:           port = @new_resource.connection[:port] || 5432\n>>> 111:           user = @new_resource.connection[:username] || 'postgres'\n    112:           Chef::Log.debug(\"#{@new_resource}: connecting to database #{dbname} on #{host}:#{port} as #{user}\")\n    113:           password = @new_resource.connection[:password] || node[:postgresql][:password][:postgres]\n    114:           @db = ::PGconn.new(\n    115:             :host => host,\n    116:             :port => port,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mindis_Keenginx-Cookbook-recipes-repo.rb", "content": "key    'RPM-GPG-KEY-Nginx'", "line": 27, "detection_span": [22, 32], "with_context": "\nwhen 'rhel', 'fedora'\ninclude_recipe 'yum::default'\n\nyum_key 'nginx' do\nurl    'http://nginx.org/keys/nginx_signing.key'\n27:     key    'RPM-GPG-KEY-Nginx'\naction :add\nend\n\nyum_repository 'nginx' do\ndescription 'Nginx.org Repository'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mindis_Keenginx-Cookbook-recipes-repo.rb\n# Target line: 27\n\n     22: when 'rhel', 'fedora'\n     23:   include_recipe 'yum::default'\n     24: \n     25:   yum_key 'nginx' do\n     26:     url    'http://nginx.org/keys/nginx_signing.key'\n>>>  27:     key    'RPM-GPG-KEY-Nginx'\n     28:     action :add\n     29:   end\n     30: \n     31:   yum_repository 'nginx' do\n     32:     description 'Nginx.org Repository'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_hw-nginx-recipes-passenger.rb", "content": "node.default[\"nginx\"][\"passenger\"][\"root\"] = \"/usr/lib/ruby/gems/1.8/gems/passenger-3.0.12\"", "line": 29, "detection_span": [24, 34], "with_context": "\naction :install\nversion node[\"nginx\"][\"passenger\"][\"version\"]\nend\n\nnode.default[\"nginx\"][\"passenger\"][\"version\"] = \"3.0.12\"\n29: node.default[\"nginx\"][\"passenger\"][\"root\"] = \"/usr/lib/ruby/gems/1.8/gems/passenger-3.0.12\"\nnode.default[\"nginx\"][\"passenger\"][\"ruby\"] = %x{which ruby}.chomp\nnode.default[\"nginx\"][\"passenger\"][\"max_pool_size\"] = 10\n\nservice \"nginx\" do\nsupports :status => true, :restart => true, :reload => true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_hw-nginx-recipes-passenger.rb\n# Target line: 29\n\n     24:   action :install\n     25:   version node[\"nginx\"][\"passenger\"][\"version\"]\n     26: end\n     27: \n     28: node.default[\"nginx\"][\"passenger\"][\"version\"] = \"3.0.12\"\n>>>  29: node.default[\"nginx\"][\"passenger\"][\"root\"] = \"/usr/lib/ruby/gems/1.8/gems/passenger-3.0.12\"\n     30: node.default[\"nginx\"][\"passenger\"][\"ruby\"] = %x{which ruby}.chomp\n     31: node.default[\"nginx\"][\"passenger\"][\"max_pool_size\"] = 10\n     32: \n     33: service \"nginx\" do\n     34:   supports :status => true, :restart => true, :reload => true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jahumes_RailsChef-vendor-cookbooks-rails-attributes-default.rb", "content": "default[\"rails\"][\"applications_root\"] = \"/home/vagrant/Code\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[\"rails\"][\"applications_root\"] = \"/home/vagrant/Code\"\ndefault[\"rbenv\"][\"binaries_url\"] = \"https://intercityup.com/binaries/ruby/ubuntu\"\ndefault[\"rbenv\"][\"available_binaries\"] = %w(2.0.0-p481)\n\ncase node[\"platform_family\"]\nwhen \"debian\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jahumes_RailsChef-vendor-cookbooks-rails-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[\"rails\"][\"applications_root\"] = \"/home/vagrant/Code\"\n      2: default[\"rbenv\"][\"binaries_url\"] = \"https://intercityup.com/binaries/ruby/ubuntu\"\n      3: default[\"rbenv\"][\"available_binaries\"] = %w(2.0.0-p481)\n      4: \n      5: case node[\"platform_family\"]\n      6: when \"debian\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-postgresql-recipes-apt_pgdg_postgresql.rb", "content": "key 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc'", "line": 16, "detection_span": [11, 21], "with_context": "\n\napt_repository 'apt.postgresql.org' do\nuri 'http://apt.postgresql.org/pub/repos/apt'\ndistribution \"#{node['postgresql']['pgdg']['release_apt_codename']}-pgdg\"\ncomponents ['main', node['postgresql']['version']]\n16:   key 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc'\naction :add\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-postgresql-recipes-apt_pgdg_postgresql.rb\n# Target line: 16\n\n     11: \n     12: apt_repository 'apt.postgresql.org' do\n     13:   uri 'http://apt.postgresql.org/pub/repos/apt'\n     14:   distribution \"#{node['postgresql']['pgdg']['release_apt_codename']}-pgdg\"\n     15:   components ['main', node['postgresql']['version']]\n>>>  16:   key 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc'\n     17:   action :add\n     18: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb", "content": "default['hadoop']['hdfs_user'] = 'hdfs'", "line": 33, "detection_span": [28, 38], "with_context": "\ndefault['hadoop']['conf_dir'] = '/etc/hadoop'\ndefault['hadoop']['data_dir'] = '/var/lib/hadoop'\ndefault['hadoop']['log_dir'] = '/var/log/hadoop'\ndefault['hadoop']['pid_dir'] = '/var/run/hadoop'\ndefault['hadoop']['group'] = 'hadoop'\n33: default['hadoop']['hdfs_user'] = 'hdfs'\ndefault['hadoop']['yarn_user'] = 'yarn'\n\n# Per service settings\ndefault['hadoop']['hdfs-site']\\\n['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb\n# Target line: 33\n\n     28: default['hadoop']['conf_dir'] = '/etc/hadoop'\n     29: default['hadoop']['data_dir'] = '/var/lib/hadoop'\n     30: default['hadoop']['log_dir'] = '/var/log/hadoop'\n     31: default['hadoop']['pid_dir'] = '/var/run/hadoop'\n     32: default['hadoop']['group'] = 'hadoop'\n>>>  33: default['hadoop']['hdfs_user'] = 'hdfs'\n     34: default['hadoop']['yarn_user'] = 'yarn'\n     35: \n     36: # Per service settings\n     37: default['hadoop']['hdfs-site']\\\n     38:        ['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-client.rb", "content": "@config.ssl_key = opts.key?(:ssl_key) ? opts[:ssl_key] : nil", "line": 65, "detection_span": [60, 70], "with_context": "\n@config.password = opts[:password] || nil\n@config.ca_file = opts.key?(:ca_file) ? opts[:ca_file] : nil\n# Provide a OpenSSL X509 cert here and not the path. See README\n@config.ssl_cert = opts.key?(:ssl_cert) ? opts[:ssl_cert] : nil\n# Provide the key (content) and not just the filename here.\n65:       @config.ssl_key = opts.key?(:ssl_key) ? opts[:ssl_key] : nil\nyield @config if block_given?\nend\n# rubocop:enable CyclomaticComplexity\n\n# Returns the etcd api version that will be used for across API methods", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-client.rb\n# Target line: 65\n\n     60:       @config.password = opts[:password] || nil\n     61:       @config.ca_file = opts.key?(:ca_file) ? opts[:ca_file] : nil\n     62:       # Provide a OpenSSL X509 cert here and not the path. See README\n     63:       @config.ssl_cert = opts.key?(:ssl_cert) ? opts[:ssl_cert] : nil\n     64:       # Provide the key (content) and not just the filename here.\n>>>  65:       @config.ssl_key = opts.key?(:ssl_key) ? opts[:ssl_key] : nil\n     66:       yield @config if block_given?\n     67:     end\n     68:     # rubocop:enable CyclomaticComplexity\n     69: \n     70:     # Returns the etcd api version that will be used for across API methods\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_config.rb", "content": "hive_site_vars[:stats_sql_password] = \\", "line": 73, "detection_span": [68, 78], "with_context": "\nhive_password\nelse\n\"\"\nend\n\n73: hive_site_vars[:stats_sql_password] = \\\nif node.run_list.expand(node.chef_environment).recipes.include?(\"bcpc-hadoop::hive_hcatalog\") then\nstats_password\nelse\n\"\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_config.rb\n# Target line: 73\n\n     68:   hive_password\n     69: else\n     70:   \"\"\n     71: end\n     72: \n>>>  73: hive_site_vars[:stats_sql_password] = \\\n     74: if node.run_list.expand(node.chef_environment).recipes.include?(\"bcpc-hadoop::hive_hcatalog\") then\n     75:   stats_password\n     76: else\n     77:   \"\"\n     78: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-hbase_master.rb", "content": "user \"hbase\"", "line": 82, "detection_span": [77, 87], "with_context": "\n\nbash \"create_phoenix_trace_table\" do\ncode <<-EOH\nHBASE_CONF_PATH=/etc/hadoop/conf:/etc/hbase/conf /usr/hdp/current/phoenix-client/bin/sqlline.py \"#{node[:bcpc][:hadoop][:zookeeper][:servers].map{ |s| float_host(s[:hostname])}.join(\",\")}:#{node[:bcpc][:hadoop][:zookeeper][:port]}:/hbase\" /tmp/trace_table.sql\nEOH\n82:     user \"hbase\"\nend\n\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-hbase_master.rb\n# Target line: 82\n\n     77: \n     78:   bash \"create_phoenix_trace_table\" do\n     79:     code <<-EOH\n     80:     HBASE_CONF_PATH=/etc/hadoop/conf:/etc/hbase/conf /usr/hdp/current/phoenix-client/bin/sqlline.py \"#{node[:bcpc][:hadoop][:zookeeper][:servers].map{ |s| float_host(s[:hostname])}.join(\",\")}:#{node[:bcpc][:hadoop][:zookeeper][:port]}:/hbase\" /tmp/trace_table.sql\n     81:     EOH\n>>>  82:     user \"hbase\"\n     83:   end\n     84: \n     85: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-ark-recipes-test.rb", "content": "prefix_root '/usr/local'", "line": 24, "detection_span": [19, 29], "with_context": "\n\nark 'foo' do\nurl 'https://github.com/opscode-cookbooks/ark/raw/master/files/default/foo.tar.gz'\nchecksum '5996e676f17457c823d86f1605eaa44ca8a81e70d6a0e5f8e45b51e62e0c52e8'\nversion '2'\n24:   prefix_root '/usr/local'\nowner 'foobarbaz'\ngroup 'foobarbaz'\nhas_binaries ['bin/do_foo', 'bin/do_more_foo']\naction :install\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-ark-recipes-test.rb\n# Target line: 24\n\n     19: \n     20: ark 'foo' do\n     21:   url 'https://github.com/opscode-cookbooks/ark/raw/master/files/default/foo.tar.gz'\n     22:   checksum '5996e676f17457c823d86f1605eaa44ca8a81e70d6a0e5f8e45b51e62e0c52e8'\n     23:   version '2'\n>>>  24:   prefix_root '/usr/local'\n     25:   owner 'foobarbaz'\n     26:   group 'foobarbaz'\n     27:   has_binaries ['bin/do_foo', 'bin/do_more_foo']\n     28:   action :install\n     29: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_rdiff-backup-attributes-client.rb", "content": "node.default['rdiff-backup']['client']['user'] = 'rdiff-backup-client'", "line": 4, "detection_span": [1, 9], "with_context": "\n# Default attributes.\nnode.default['rdiff-backup']['client']['ssh-port'] = '22'\nnode.default['rdiff-backup']['client']['ssh_keys'] = []\n4: node.default['rdiff-backup']['client']['user'] = 'rdiff-backup-client'\nnode.default['rdiff-backup']['client']['sudo'] = true\nnode.default['rdiff-backup']['client']['jobs'] = {}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_rdiff-backup-attributes-client.rb\n# Target line: 4\n\n      1: # Default attributes.\n      2: node.default['rdiff-backup']['client']['ssh-port'] = '22'\n      3: node.default['rdiff-backup']['client']['ssh_keys'] = []\n>>>   4: node.default['rdiff-backup']['client']['user'] = 'rdiff-backup-client'\n      5: node.default['rdiff-backup']['client']['sudo'] = true\n      6: node.default['rdiff-backup']['client']['jobs'] = {}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-preflight_checks.rb", "content": "user = 'chef_server_conn_test'", "line": 78, "detection_span": [73, 83], "with_context": "\noptions.merge! opts\n\nport = cs_pg_attr.has_key?('port') ? cs_pg_attr['port'] : node_pg_attr['port']\nhost = cs_pg_attr['vip']\nif type == :invalid_user\n78:       user = 'chef_server_conn_test'\npassword = 'invalid'\nelse\nuser = cs_pg_attr['db_superuser']\npassword = cs_pg_attr['db_superuser_password']\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-preflight_checks.rb\n# Target line: 78\n\n     73:     options.merge! opts\n     74: \n     75:     port = cs_pg_attr.has_key?('port') ? cs_pg_attr['port'] : node_pg_attr['port']\n     76:     host = cs_pg_attr['vip']\n     77:     if type == :invalid_user\n>>>  78:       user = 'chef_server_conn_test'\n     79:       password = 'invalid'\n     80:     else\n     81:       user = cs_pg_attr['db_superuser']\n     82:       password = cs_pg_attr['db_superuser_password']\n     83:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~target_ssl_proxy.rb", "content": "private_key '-----BEGIN EC PRIVATE KEY-----", "line": 123, "detection_span": [118, 128], "with_context": "\n118: BBYEFKIQC3A2SDpxcdfn0YLKineDNq/BMB8GA1UdIwQYMBaAFKIQC3A2SDpxcdfn\n119: 0YLKineDNq/BMAwGA1UdEwQFMAMBAf8wCgYIKoZIzj0EAwIDSQAwRgIhALs4vy+O\n120: M3jcqgA4fSW/oKw6UJxp+M6a+nGMX+UJR3YgAiEAvvl39QRVAiv84hdoCuyON0lJ\n121: zqGNhIPGq2ULqXKK8BY=\n122: -----END CERTIFICATE-----'\n123:   private_key '-----BEGIN EC PRIVATE KEY-----\n124: MHcCAQEEIObtRo8tkUqoMjeHhsOh2ouPpXCgBcP+EDxZCB/tws15oAoGCCqGSM49\n125: AwEHoUQDQgAEHGzpcRJ4XzfBJCCPMQeXQpTXwlblimODQCuQ4mzkzTv0dXyB750f\n126: OGN02HtkpBOZzzvUARTR10JQoSe2/5PIwQ==\n127: -----END EC PRIVATE KEY-----'\n128: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~target_ssl_proxy.rb\n# Target line: 123\n\n    118: BBYEFKIQC3A2SDpxcdfn0YLKineDNq/BMB8GA1UdIwQYMBaAFKIQC3A2SDpxcdfn\n    119: 0YLKineDNq/BMAwGA1UdEwQFMAMBAf8wCgYIKoZIzj0EAwIDSQAwRgIhALs4vy+O\n    120: M3jcqgA4fSW/oKw6UJxp+M6a+nGMX+UJR3YgAiEAvvl39QRVAiv84hdoCuyON0lJ\n    121: zqGNhIPGq2ULqXKK8BY=\n    122: -----END CERTIFICATE-----'\n>>> 123:   private_key '-----BEGIN EC PRIVATE KEY-----\n    124: MHcCAQEEIObtRo8tkUqoMjeHhsOh2ouPpXCgBcP+EDxZCB/tws15oAoGCCqGSM49\n    125: AwEHoUQDQgAEHGzpcRJ4XzfBJCCPMQeXQpTXwlblimODQCuQ4mzkzTv0dXyB750f\n    126: OGN02HtkpBOZzzvUARTR10JQoSe2/5PIwQ==\n    127: -----END EC PRIVATE KEY-----'\n    128: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-webplayer-attributes-default.rb", "content": "default[:webplayer][:user] = \"root\"", "line": 12, "detection_span": [7, 17], "with_context": "\n# Number of days before pulling a new copy from files.ihrdev.com\ndefault[:webplayer][:geo_freshness] = 60\n\ndefault[:webplayer][:packages] = %w{ libxslt-devel python27-debuginfo python27-libs python27-tools python27-devel python27 python27-test }\n\n12: default[:webplayer][:user] = \"root\"\ncase node[:platform]\nwhen \"debian\"\ndefault[:webplayer][:group] = \"nogroup\"\nwhen \"centos\"\ndefault[:webplayer][:group] = \"nobody\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-webplayer-attributes-default.rb\n# Target line: 12\n\n      7: # Number of days before pulling a new copy from files.ihrdev.com\n      8: default[:webplayer][:geo_freshness] = 60\n      9: \n     10: default[:webplayer][:packages] = %w{ libxslt-devel python27-debuginfo python27-libs python27-tools python27-devel python27 python27-test }\n     11: \n>>>  12: default[:webplayer][:user] = \"root\"\n     13: case node[:platform]\n     14: when \"debian\"\n     15:   default[:webplayer][:group] = \"nogroup\"\n     16: when \"centos\"\n     17:   default[:webplayer][:group] = \"nobody\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-nagios-api-attributes-default.rb", "content": "default[:nagiosapi][:user] = \"nobody\"", "line": 8, "detection_span": [3, 13], "with_context": "\ndefault[:nagiosapi][:repo] = \"git@github.com:xb95/nagios-api.git\"\ndefault[:nagiosapi][:rev] = \"HEAD\"\n\ndefault[:nagiosapi][:path] = \"/data/www/nagios-api\"\n\n8: default[:nagiosapi][:user] = \"nobody\"\ncase node[:platform_family]\nwhen \"rhel\"\ndefault[:nagiosapi][:group] = \"nobody\"\nwhen \"debian\"\ndefault[:nagiosapi][:group] = \"nogroup\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nagios-api-attributes-default.rb\n# Target line: 8\n\n      3: default[:nagiosapi][:repo] = \"git@github.com:xb95/nagios-api.git\"\n      4: default[:nagiosapi][:rev] = \"HEAD\"\n      5: \n      6: default[:nagiosapi][:path] = \"/data/www/nagios-api\"\n      7: \n>>>   8: default[:nagiosapi][:user] = \"nobody\"\n      9: case node[:platform_family]\n     10: when \"rhel\"\n     11:   default[:nagiosapi][:group] = \"nobody\"\n     12: when \"debian\"\n     13:   default[:nagiosapi][:group] = \"nogroup\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "FriendsOfCake_vagrant-chef-cookbooks-php-recipes-apt_repository.rb", "content": "key \"E5267A6C\"", "line": 2, "detection_span": [1, 7], "with_context": "\napt_repository \"php\" do\n2:   key \"E5267A6C\"\nuri \"ppa:ondrej/php\"\ndistribution node[\"lsb\"][\"codename\"]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: FriendsOfCake_vagrant-chef-cookbooks-php-recipes-apt_repository.rb\n# Target line: 2\n\n      1: apt_repository \"php\" do\n>>>   2:   key \"E5267A6C\"\n      3:   uri \"ppa:ondrej/php\"\n      4:   distribution node[\"lsb\"][\"codename\"]\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "laradji_zabbix-recipes-database.rb", "content": "root_username       = 'postgres'", "line": 37, "detection_span": [32, 42], "with_context": "\nprovider = Chef::Provider::ZabbixDatabaseMySql\nwhen 'postgres'\nunless node['postgresql']['password']['postgres']\nnode.normal['postgresql']['password']['postgres'] = secure_password\nend\n37:   root_username       = 'postgres'\nroot_password       = node['postgresql']['password']['postgres']\nprovider = Chef::Provider::ZabbixDatabasePostgres\nwhen 'oracle'\n# No oracle database installation or configuration currently done\n# This recipe expects a fully configured Oracle DB with a Zabbix", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: laradji_zabbix-recipes-database.rb\n# Target line: 37\n\n     32:   provider = Chef::Provider::ZabbixDatabaseMySql\n     33: when 'postgres'\n     34:   unless node['postgresql']['password']['postgres']\n     35:     node.normal['postgresql']['password']['postgres'] = secure_password\n     36:   end\n>>>  37:   root_username       = 'postgres'\n     38:   root_password       = node['postgresql']['password']['postgres']\n     39:   provider = Chef::Provider::ZabbixDatabasePostgres\n     40: when 'oracle'\n     41:   # No oracle database installation or configuration currently done\n     42:   # This recipe expects a fully configured Oracle DB with a Zabbix\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-enable_full_keyboard_access_for_all_controls.rb", "content": "key 'AppleKeyboardUIMode'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Enable full keyboard access for all controls\" do\ndomain 'NSGlobalDomain'\n3:   key 'AppleKeyboardUIMode'\ninteger 3\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-enable_full_keyboard_access_for_all_controls.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Enable full keyboard access for all controls\" do\n      2:   domain 'NSGlobalDomain'\n>>>   3:   key 'AppleKeyboardUIMode'\n      4:   integer 3\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb", "content": "'superuser' => 'pivotal',", "line": 30, "detection_span": [25, 35], "with_context": "\nend\n\napp_settings = {\n'chef' => {\n'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n30:     'superuser' => 'pivotal',\n'key_path' => '/etc/opscode/webui_priv.pem'\n},\n'doorkeeper' => {\n'administrators' => node['private_chef']['oc_id']['administrators'] || []\n},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb\n# Target line: 30\n\n     25: end\n     26: \n     27: app_settings = {\n     28:   'chef' => {\n     29:     'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n>>>  30:     'superuser' => 'pivotal',\n     31:     'key_path' => '/etc/opscode/webui_priv.pem'\n     32:   },\n     33:   'doorkeeper' => {\n     34:     'administrators' => node['private_chef']['oc_id']['administrators'] || []\n     35:   },\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "AYCHIT_Asf-chef-cookbooks-user-attributes-default.rb", "content": "default['user']['home_root']      = \"/home\"", "line": 24, "detection_span": [19, 29], "with_context": "\n# limitations under the License.\n#\n\ncase platform\nwhen 'debian','ubuntu','redhat','centos','amazon','scientific','fedora','freebsd','suse'\n24:   default['user']['home_root']      = \"/home\"\ndefault['user']['default_shell']  = \"/bin/bash\"\nwhen 'openbsd'\ndefault['user']['home_root']      = \"/home\"\ndefault['user']['default_shell']  = \"/bin/ksh\"\nwhen 'mac_os_x', 'mac_os_x_server'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: AYCHIT_Asf-chef-cookbooks-user-attributes-default.rb\n# Target line: 24\n\n     19: # limitations under the License.\n     20: #\n     21: \n     22: case platform\n     23: when 'debian','ubuntu','redhat','centos','amazon','scientific','fedora','freebsd','suse'\n>>>  24:   default['user']['home_root']      = \"/home\"\n     25:   default['user']['default_shell']  = \"/bin/bash\"\n     26: when 'openbsd'\n     27:   default['user']['home_root']      = \"/home\"\n     28:   default['user']['default_shell']  = \"/bin/ksh\"\n     29: when 'mac_os_x', 'mac_os_x_server'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_glance-recipes-replicator.rb", "content": "user \"glance\"", "line": 30, "detection_span": [25, 35], "with_context": "\nexecute \"enable glance login\" do\ncommand \"usermod -s /bin/sh glance\"\nend\n\ndsh_group \"glance\" do\n30:     user \"glance\"\nadmin_user \"glance\"\nend\n\npackage \"glance-image-sync\" do\naction node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_glance-recipes-replicator.rb\n# Target line: 30\n\n     25:   execute \"enable glance login\" do\n     26:     command \"usermod -s /bin/sh glance\"\n     27:   end\n     28:  \n     29:   dsh_group \"glance\" do\n>>>  30:     user \"glance\"\n     31:     admin_user \"glance\"\n     32:   end\n     33: \n     34:   package \"glance-image-sync\" do\n     35:     action node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Soluciones_ey-cloud-recipes-cookbooks-collectd-libraries-collectd.rb", "content": "arg[key] = case value", "line": 76, "detection_span": [71, 81], "with_context": "\nif arg.is_a?(Hash)\nraise ArgumentError unless arg.key?(:warning) && arg.key?(:failure)\n\narg.each_pair do |key, value|\nif value.is_a?(String)\n76:               arg[key] = case value\nwhen /^([\\d\\.]+)kb/i; $1.to_f * 1024\nwhen /^([\\d\\.]+)mb/i; $1.to_f * 1048576\nwhen /^([\\d\\.]+)gb/i; $1.to_f * 1073741824\nelse value\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-collectd-libraries-collectd.rb\n# Target line: 76\n\n     71:         if arg.is_a?(Hash)\n     72:           raise ArgumentError unless arg.key?(:warning) && arg.key?(:failure)\n     73:           \n     74:           arg.each_pair do |key, value|\n     75:             if value.is_a?(String)\n>>>  76:               arg[key] = case value\n     77:                 when /^([\\d\\.]+)kb/i; $1.to_f * 1024\n     78:                 when /^([\\d\\.]+)mb/i; $1.to_f * 1048576\n     79:                 when /^([\\d\\.]+)gb/i; $1.to_f * 1073741824 \n     80:                 else value\n     81:               end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-rabbitmq-attributes-default.rb", "content": "default['rabbitmq']['default_user'] = 'guest'", "line": 38, "detection_span": [33, 43], "with_context": "\ndefault['rabbitmq']['config'] = \"/etc/rabbitmq/rabbitmq\"\ndefault['rabbitmq']['erlang_cookie_path'] = '/var/lib/rabbitmq/.erlang.cookie'\ndefault['rabbitmq']['dir'] = '/etc/rabbitmq'\n\n# rabbitmq.config defaults\n38: default['rabbitmq']['default_user'] = 'guest'\ndefault['rabbitmq']['default_pass'] = 'guest'\n\n#clustering\ndefault['rabbitmq']['cluster'] = false\ndefault['rabbitmq']['cluster_disk_nodes'] = []", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-rabbitmq-attributes-default.rb\n# Target line: 38\n\n     33: default['rabbitmq']['config'] = \"/etc/rabbitmq/rabbitmq\"\n     34: default['rabbitmq']['erlang_cookie_path'] = '/var/lib/rabbitmq/.erlang.cookie'\n     35: default['rabbitmq']['dir'] = '/etc/rabbitmq'\n     36: \n     37: # rabbitmq.config defaults\n>>>  38: default['rabbitmq']['default_user'] = 'guest'\n     39: default['rabbitmq']['default_pass'] = 'guest'\n     40: \n     41: #clustering\n     42: default['rabbitmq']['cluster'] = false\n     43: default['rabbitmq']['cluster_disk_nodes'] = []\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-splunk_handler-attributes-default.rb", "content": "default['chef_client']['handler']['splunk']['password'] = nil", "line": 13, "detection_span": [8, 18], "with_context": "\n# License:: Apache License 2.0\n#\n\n\ndefault['chef_client']['handler']['splunk']['username'] = nil\n13: default['chef_client']['handler']['splunk']['password'] = nil\ndefault['chef_client']['handler']['splunk']['host'] = nil\ndefault['chef_client']['handler']['splunk']['port'] = '8089'\ndefault['chef_client']['handler']['splunk']['index'] = 'main'\ndefault['chef_client']['handler']['splunk']['scheme'] = 'https'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-splunk_handler-attributes-default.rb\n# Target line: 13\n\n      8: # License:: Apache License 2.0\n      9: #\n     10: \n     11: \n     12: default['chef_client']['handler']['splunk']['username'] = nil\n>>>  13: default['chef_client']['handler']['splunk']['password'] = nil\n     14: default['chef_client']['handler']['splunk']['host'] = nil\n     15: default['chef_client']['handler']['splunk']['port'] = '8089'\n     16: default['chef_client']['handler']['splunk']['index'] = 'main'\n     17: default['chef_client']['handler']['splunk']['scheme'] = 'https'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_magentostack-recipes-magento_install.rb", "content": "svn_username MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_username')", "line": 150, "detection_span": [145, 155], "with_context": "\n145:   # Run the checkout into /var/www/html/magento\n146:   magento_dir = \"#{node['apache']['docroot_dir']}/magento\"\n147:   subversion magento_dir do\nrepository MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_repository')\nrevision MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_revision')\n150:     svn_username MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_username')\nsvn_password MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_password')\nsvn_arguments MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_arguments')\nsvn_info_args MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_info_args')\ntimeout MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_timeout')\naction :sync", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_magentostack-recipes-magento_install.rb\n# Target line: 150\n\n    145:   # Run the checkout into /var/www/html/magento\n    146:   magento_dir = \"#{node['apache']['docroot_dir']}/magento\"\n    147:   subversion magento_dir do\n    148:     repository MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_repository')\n    149:     revision MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_revision')\n>>> 150:     svn_username MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_username')\n    151:     svn_password MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_password')\n    152:     svn_arguments MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_arguments')\n    153:     svn_info_args MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_info_args')\n    154:     timeout MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_timeout')\n    155:     action :sync\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-recipes-cobalt.rb", "content": "key \"gridcentric.key\"", "line": 42, "detection_span": [37, 47], "with_context": "\n\napt_repository \"vms\" do\nuri node['bcpc']['repos']['gridcentric'] % [node['bcpc']['vms_key'], 'vms']\ndistribution \"gridcentric\"\ncomponents [\"multiverse\"]\n42:         key \"gridcentric.key\"\nend\n\npackage \"cobalt-novaclient\" do\naction :upgrade\noptions \"-o APT::Install-Recommends=0 -o Dpkg::Options::='--force-confnew'\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-cobalt.rb\n# Target line: 42\n\n     37: \n     38:     apt_repository \"vms\" do\n     39:         uri node['bcpc']['repos']['gridcentric'] % [node['bcpc']['vms_key'], 'vms']\n     40:         distribution \"gridcentric\"\n     41:         components [\"multiverse\"]\n>>>  42:         key \"gridcentric.key\"\n     43:     end\n     44: \n     45:     package \"cobalt-novaclient\" do\n     46:         action :upgrade\n     47:         options \"-o APT::Install-Recommends=0 -o Dpkg::Options::='--force-confnew'\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_devel-attributes-default.rb", "content": "default['imos_devel']['user']                          = \"vagrant\"", "line": 18, "detection_span": [13, 23], "with_context": "\n\n# Base directory for sources\ndefault['imos_devel']['src']                           = \"/vagrant/src\"\n\n# User and home directory to use for development\n18: default['imos_devel']['user']                          = \"vagrant\"\ndefault['imos_devel']['homedir']                       = \"/home/vagrant\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_devel-attributes-default.rb\n# Target line: 18\n\n     13: \n     14: # Base directory for sources\n     15: default['imos_devel']['src']                           = \"/vagrant/src\"\n     16: \n     17: # User and home directory to use for development\n>>>  18: default['imos_devel']['user']                          = \"vagrant\"\n     19: default['imos_devel']['homedir']                       = \"/home/vagrant\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['password'] = nil #  /.*/", "line": 65, "detection_span": [60, 70], "with_context": "\ndefault['yum']['main']['metadata_expire'] = nil # /^\\d+$/\ndefault['yum']['main']['mirrorlist_expire'] = nil # /^\\d+$/\ndefault['yum']['main']['multilib_policy'] = nil # %w{ all best }\ndefault['yum']['main']['obsoletes'] = nil  # [TrueClass, FalseClass]\ndefault['yum']['main']['overwrite_groups'] = nil # [TrueClass, FalseClass]\n65: default['yum']['main']['password'] = nil #  /.*/\ndefault['yum']['main']['path'] = '/etc/yum.conf' #  /.*/\ndefault['yum']['main']['persistdir'] = nil # /.*/\ndefault['yum']['main']['pluginconfpath'] = nil #  /.*/\ndefault['yum']['main']['pluginpath'] = nil #  /.*/\ndefault['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-yum-attributes-main.rb\n# Target line: 65\n\n     60: default['yum']['main']['metadata_expire'] = nil # /^\\d+$/\n     61: default['yum']['main']['mirrorlist_expire'] = nil # /^\\d+$/\n     62: default['yum']['main']['multilib_policy'] = nil # %w{ all best }\n     63: default['yum']['main']['obsoletes'] = nil  # [TrueClass, FalseClass]\n     64: default['yum']['main']['overwrite_groups'] = nil # [TrueClass, FalseClass]\n>>>  65: default['yum']['main']['password'] = nil #  /.*/\n     66: default['yum']['main']['path'] = '/etc/yum.conf' #  /.*/\n     67: default['yum']['main']['persistdir'] = nil # /.*/\n     68: default['yum']['main']['pluginconfpath'] = nil #  /.*/\n     69: default['yum']['main']['pluginpath'] = nil #  /.*/\n     70: default['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-etl_jobs-attributes-default.rb", "content": "default[:enrichment][:log][:sudo_user] = \"amqp-consumer\"", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault[:enrichment][:appdir] = \"/data/apps/enrichment\"\ndefault[:enrichment][:log][:source] = \"/data/log/enrichment-consumer/\"\ndefault[:enrichment][:log][:dest] = \"iad-ss-nfs101-v600.ihr:/data/exports/files.ihrdev.com/Enrichment\"\ndefault[:enrichment][:log][:retention] = \"14\" # days\ndefault[:enrichment][:log][:user] = \"ihr-deployer\"\n6: default[:enrichment][:log][:sudo_user] = \"amqp-consumer\"\ndefault[:playlog][:deploy_path] = \"/data/jobs/playlog\"\ndefault[:playlog][:repo] = \"git@github.com:iheartradio/playlog.git\"\ndefault[:playlog][:reference] = \"0246f36d0c9c2a47d4fdd97942b0c4ebbb24b21d\"\ndefault[:db_sync_tools][:deploy_path] = \"/data/jobs/db-sync-tools\"\ndefault[:db_sync_tools][:repo] = \"git@github.com:iheartradio/amp-tools\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-etl_jobs-attributes-default.rb\n# Target line: 6\n\n      1: default[:enrichment][:appdir] = \"/data/apps/enrichment\"\n      2: default[:enrichment][:log][:source] = \"/data/log/enrichment-consumer/\"\n      3: default[:enrichment][:log][:dest] = \"iad-ss-nfs101-v600.ihr:/data/exports/files.ihrdev.com/Enrichment\"\n      4: default[:enrichment][:log][:retention] = \"14\" # days\n      5: default[:enrichment][:log][:user] = \"ihr-deployer\"\n>>>   6: default[:enrichment][:log][:sudo_user] = \"amqp-consumer\"\n      7: default[:playlog][:deploy_path] = \"/data/jobs/playlog\"\n      8: default[:playlog][:repo] = \"git@github.com:iheartradio/playlog.git\"\n      9: default[:playlog][:reference] = \"0246f36d0c9c2a47d4fdd97942b0c4ebbb24b21d\"\n     10: default[:db_sync_tools][:deploy_path] = \"/data/jobs/db-sync-tools\"\n     11: default[:db_sync_tools][:repo] = \"git@github.com:iheartradio/amp-tools\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-mysql-attributes-server.rb", "content": "default['mysql']['tunable']['key_buffer']           = \"256M\"", "line": 41, "detection_span": [36, 46], "with_context": "\ndefault['mysql']['ebs_vol_dev'] = \"/dev/sdi\"\ndefault['mysql']['ebs_vol_size'] = 50\nend\n\ndefault['mysql']['tunable']['back_log']             = \"128\"\n41: default['mysql']['tunable']['key_buffer']           = \"256M\"\ndefault['mysql']['tunable']['max_allowed_packet']   = \"16M\"\ndefault['mysql']['tunable']['max_connections']      = \"800\"\ndefault['mysql']['tunable']['max_heap_table_size']  = \"32M\"\ndefault['mysql']['tunable']['myisam_recover']       = \"BACKUP\"\ndefault['mysql']['tunable']['net_read_timeout']     = \"30\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-mysql-attributes-server.rb\n# Target line: 41\n\n     36:   default['mysql']['ebs_vol_dev'] = \"/dev/sdi\"\n     37:   default['mysql']['ebs_vol_size'] = 50\n     38: end\n     39: \n     40: default['mysql']['tunable']['back_log']             = \"128\"\n>>>  41: default['mysql']['tunable']['key_buffer']           = \"256M\"\n     42: default['mysql']['tunable']['max_allowed_packet']   = \"16M\"\n     43: default['mysql']['tunable']['max_connections']      = \"800\"\n     44: default['mysql']['tunable']['max_heap_table_size']  = \"32M\"\n     45: default['mysql']['tunable']['myisam_recover']       = \"BACKUP\"\n     46: default['mysql']['tunable']['net_read_timeout']     = \"30\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_swift-recipes-storage-common.rb", "content": "user \"swift\"", "line": 44, "detection_span": [39, 49], "with_context": "\naction :create\nmode \"0700\"\nend\n\ndsh_group \"swift-storage\" do\n44:   user \"swift\"\nnetwork \"swift\"\nnotifies :create, \"template[/etc/sudoers.d/swift]\", :immediately\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-recipes-storage-common.rb\n# Target line: 44\n\n     39:   action :create\n     40:   mode \"0700\"\n     41: end\n     42: \n     43: dsh_group \"swift-storage\" do\n>>>  44:   user \"swift\"\n     45:   network \"swift\"\n     46:   notifies :create, \"template[/etc/sudoers.d/swift]\", :immediately\n     47: end\n     48: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-hbase-cookbooks-statsd-attributes-default.rb", "content": "default[:statsd][:user]            = \"statsd\"", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault[:statsd][:home_dir]          = \"/usr/local/share/statsd\"\ndefault[:statsd][:conf_dir]          = \"/etc/statsd\"\ndefault[:statsd][:log_dir]           = \"/var/log/statsd\"\ndefault[:statsd][:pid_dir]           = \"/var/run/statsd\"\n\n11: default[:statsd][:user]            = \"statsd\"\ndefault[:users ]['statsd' ][:uid]  = 310\ndefault[:groups]['statsd' ][:gid]  = 310\n\ndefault[:statsd][:run_state]   = :start\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-hbase-cookbooks-statsd-attributes-default.rb\n# Target line: 11\n\n      6: default[:statsd][:home_dir]          = \"/usr/local/share/statsd\"\n      7: default[:statsd][:conf_dir]          = \"/etc/statsd\"\n      8: default[:statsd][:log_dir]           = \"/var/log/statsd\"\n      9: default[:statsd][:pid_dir]           = \"/var/run/statsd\"\n     10: \n>>>  11: default[:statsd][:user]            = \"statsd\"\n     12: default[:users ]['statsd' ][:uid]  = 310\n     13: default[:groups]['statsd' ][:gid]  = 310\n     14: \n     15: default[:statsd][:run_state]   = :start\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb", "content": "user 'dd-agent'", "line": 37, "detection_span": [32, 42], "with_context": "\n\"/usr/bin/find #{instance['directory']}/#{queue} -type f\"\nend\nend\n\nsudo 'dd-agent-find-postfix' do\n37:   user 'dd-agent'\nnopasswd true\ncommands postfix_commands.flatten.uniq\nonly_if { postfix_instances.any? }\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb\n# Target line: 37\n\n     32:     \"/usr/bin/find #{instance['directory']}/#{queue} -type f\"\n     33:   end\n     34: end\n     35: \n     36: sudo 'dd-agent-find-postfix' do\n>>>  37:   user 'dd-agent'\n     38:   nopasswd true\n     39:   commands postfix_commands.flatten.uniq\n     40:   only_if { postfix_instances.any? }\n     41: end\n     42: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-postgresql-resources-user.rb", "content": "superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"", "line": 36, "detection_span": [31, 41], "with_context": "\nproperty :createrole, :kind_of => [TrueClass, FalseClass], :default => false\nproperty :replication, :kind_of => [TrueClass, FalseClass], :default => false\n\naction :create do\npassword = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\n36:   superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\ncreatedb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\ncreaterole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\nreplication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n\nif !cluster.users.include?(new_resource.user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-postgresql-resources-user.rb\n# Target line: 36\n\n     31: property :createrole, :kind_of => [TrueClass, FalseClass], :default => false\n     32: property :replication, :kind_of => [TrueClass, FalseClass], :default => false\n     33: \n     34: action :create do\n     35:   password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\n>>>  36:   superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\n     37:   createdb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\n     38:   createrole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\n     39:   replication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n     40: \n     41:   if !cluster.users.include?(new_resource.user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-mysql-recipes-default.rb", "content": "key \"CD2EFD2A\"", "line": 6, "detection_span": [1, 11], "with_context": "\n\nif (node.mysql.use_percona || node.mysql.add_percona_repo) && node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"percona_repo\" do\nurl \"http://repo.percona.com/apt\"\n6:     key \"CD2EFD2A\"\nkey_server \"keys.gnupg.net\"\nend\n\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-mysql-recipes-default.rb\n# Target line: 6\n\n      1: \n      2: if (node.mysql.use_percona || node.mysql.add_percona_repo) && node.apt.master_chef_add_apt_repo\n      3: \n      4:   add_apt_repository \"percona_repo\" do\n      5:     url \"http://repo.percona.com/apt\"\n>>>   6:     key \"CD2EFD2A\"\n      7:     key_server \"keys.gnupg.net\"\n      8:   end\n      9: \n     10: end\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb", "content": "user_name 'test-admin'", "line": 21, "detection_span": [16, 26], "with_context": "\nwith_chef_server 'https://127.0.0.1:8443',\nclient_name: 'pivotal',\nsigning_key_filename: '/etc/opscode/pivotal.pem' do\n\nchef_user 'test-admin' do\n21:     user_name 'test-admin'\ndisplay_name 'test-admin'\nadmin true\nemail 'test-admin@chef.io'\npassword 'password123!'\nsource_key_path '/shared/keys/test.pem'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb\n# Target line: 21\n\n     16: with_chef_server 'https://127.0.0.1:8443',\n     17:   client_name: 'pivotal',\n     18:   signing_key_filename: '/etc/opscode/pivotal.pem' do\n     19: \n     20:   chef_user 'test-admin' do\n>>>  21:     user_name 'test-admin'\n     22:     display_name 'test-admin'\n     23:     admin true\n     24:     email 'test-admin@chef.io'\n     25:     password 'password123!'\n     26:     source_key_path '/shared/keys/test.pem'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-add_a_context_menu_item_for_showing_the_web_inspector_in_web_views.rb", "content": "key 'WebKitDeveloperExtras'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Add a context menu item for showing the Web Inspector in web views\" do\ndomain 'NSGlobalDomain'\n3:   key 'WebKitDeveloperExtras'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-add_a_context_menu_item_for_showing_the_web_inspector_in_web_views.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Add a context menu item for showing the Web Inspector in web views\" do\n      2:   domain 'NSGlobalDomain'\n>>>   3:   key 'WebKitDeveloperExtras'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-apt-attributes-default.rb", "content": "default['apt']['cache_bypass'] = {}", "line": 29, "detection_span": [24, 34], "with_context": "\ndefault['apt']['cacher_ssl_support'] = false\ndefault['apt']['caching_server'] = false\ndefault['apt']['compiletime'] = false\ndefault['apt']['compile_time_update'] = false\ndefault['apt']['key_proxy'] = ''\n29: default['apt']['cache_bypass'] = {}\ndefault['apt']['periodic_update_min_delay'] = 86_400\ndefault['apt']['launchpad_api_version'] = '1.0'\ndefault['apt']['unattended_upgrades']['enable'] = false\ndefault['apt']['unattended_upgrades']['update_package_lists'] = true\n# this needs a good default", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-apt-attributes-default.rb\n# Target line: 29\n\n     24: default['apt']['cacher_ssl_support'] = false\n     25: default['apt']['caching_server'] = false\n     26: default['apt']['compiletime'] = false\n     27: default['apt']['compile_time_update'] = false\n     28: default['apt']['key_proxy'] = ''\n>>>  29: default['apt']['cache_bypass'] = {}\n     30: default['apt']['periodic_update_min_delay'] = 86_400\n     31: default['apt']['launchpad_api_version'] = '1.0'\n     32: default['apt']['unattended_upgrades']['enable'] = false\n     33: default['apt']['unattended_upgrades']['update_package_lists'] = true\n     34: # this needs a good default\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb", "content": "key 'NewWindowTarget'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\ndomain 'com.apple.finder'\n3:   key 'NewWindowTarget'\nstring \"PfHm\"\nend\n\nosxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\ndomain 'com.apple.finder'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'NewWindowTarget'\n      4:   string \"PfHm\"\n      5: end\n      6: \n      7: osxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\n      8:   domain 'com.apple.finder'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "pinterest_it-cpe-cookbooks-cpe_smartcard-attributes-default.rb", "content": "'oneCardPerUser' => nil,", "line": 17, "detection_span": [12, 22], "with_context": "\n#\n\ndefault['cpe_smartcard'] = {\n'allowSmartCard' => nil,\n'checkCertificateTrust' => nil,\n17:   'oneCardPerUser' => nil,\n'UserPairing' => nil,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pinterest_it-cpe-cookbooks-cpe_smartcard-attributes-default.rb\n# Target line: 17\n\n     12: #\n     13: \n     14: default['cpe_smartcard'] = {\n     15:   'allowSmartCard' => nil,\n     16:   'checkCertificateTrust' => nil,\n>>>  17:   'oneCardPerUser' => nil,\n     18:   'UserPairing' => nil,\n     19: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "jonmthomson_cookbooks-windows-providers-certificate.rb", "content": "password = \", \\\"#{@new_resource.pfx_password}\\\"\" if isPfx", "line": 37, "detection_span": [32, 42], "with_context": "\n\naction :create do\n# We can do everything in a powershell script resource\nfile = win_friendly_path(@new_resource.source)\nisPfx = file.downcase.end_with?('pfx')\n37:   password = \", \\\"#{@new_resource.pfx_password}\\\"\" if isPfx\npersistKeySet = ', ([System.Security.Cryptography.X509Certificates.X509KeyStorageFlags]::PersistKeySet)' if isPfx\n\ncodeScript = <<-EOH\n$store = New-Object System.Security.Cryptography.X509Certificates.X509Store \"#{@new_resource.store_name}\", ([System.Security.Cryptography.X509Certificates.StoreLocation]::#{@location})\n$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \"#{file}\"#{password}#{persistKeySet}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jonmthomson_cookbooks-windows-providers-certificate.rb\n# Target line: 37\n\n     32: \n     33: action :create do\n     34:   # We can do everything in a powershell script resource\n     35:   file = win_friendly_path(@new_resource.source)\n     36:   isPfx = file.downcase.end_with?('pfx')\n>>>  37:   password = \", \\\"#{@new_resource.pfx_password}\\\"\" if isPfx\n     38:   persistKeySet = ', ([System.Security.Cryptography.X509Certificates.X509KeyStorageFlags]::PersistKeySet)' if isPfx\n     39: \n     40:   codeScript = <<-EOH\n     41:     $store = New-Object System.Security.Cryptography.X509Certificates.X509Store \"#{@new_resource.store_name}\", ([System.Security.Cryptography.X509Certificates.StoreLocation]::#{@location})\n     42:     $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \"#{file}\"#{password}#{persistKeySet}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_pythonstack-recipes-default_unless.rb", "content": "node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_admin'] = 'demo@demo.com'", "line": 47, "detection_span": [42, 52], "with_context": "\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['docroot'] = \"/var/www/#{site_name}/#{port}\"\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['monitoring_hostname'] = site_name\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['customlog'] =\n\"#{node[node[stackname]['webserver']]['log_dir']}/#{site_name}-#{port}-access.log combined\"\nif node[stackname]['webserver'] == 'apache'\n47:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_admin'] = 'demo@demo.com'\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['template'] = 'apache2/sites/example.com.erb'\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_name'] = site_name\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['allow_override'] = ['All']\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['loglevel'] = 'warn'\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['script_name'] = 'wsgi.py'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_pythonstack-recipes-default_unless.rb\n# Target line: 47\n\n     42:     node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['docroot'] = \"/var/www/#{site_name}/#{port}\"\n     43:     node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['monitoring_hostname'] = site_name\n     44:     node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['customlog'] =\n     45:       \"#{node[node[stackname]['webserver']]['log_dir']}/#{site_name}-#{port}-access.log combined\"\n     46:     if node[stackname]['webserver'] == 'apache'\n>>>  47:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_admin'] = 'demo@demo.com'\n     48:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['template'] = 'apache2/sites/example.com.erb'\n     49:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_name'] = site_name\n     50:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['allow_override'] = ['All']\n     51:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['loglevel'] = 'warn'\n     52:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['script_name'] = 'wsgi.py'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_keystone-providers-credentials.rb", "content": "tenant_key = \"name\"", "line": 39, "detection_span": [34, 44], "with_context": "\nheaders = build_headers(new_resource.auth_token)\n\n# lookup tenant_uuid\nChef::Log.debug(\"Looking up Tenant_UUID for Tenant_Name: #{new_resource.tenant_name}\")\ntenant_container = \"tenants\"\n39:   tenant_key = \"name\"\ntenant_path = \"/#{new_resource.api_ver}/tenants\"\ntenant_uuid, tenant_error = find_value(http, tenant_path, headers, tenant_container, tenant_key, new_resource.tenant_name, 'id')\nChef::Log.error(\"There was an error looking up Tenant '#{new_resource.tenant_name}'\") if tenant_error\n\n# lookup user_uuid", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_keystone-providers-credentials.rb\n# Target line: 39\n\n     34:   headers = build_headers(new_resource.auth_token)\n     35: \n     36:   # lookup tenant_uuid\n     37:   Chef::Log.debug(\"Looking up Tenant_UUID for Tenant_Name: #{new_resource.tenant_name}\")\n     38:   tenant_container = \"tenants\"\n>>>  39:   tenant_key = \"name\"\n     40:   tenant_path = \"/#{new_resource.api_ver}/tenants\"\n     41:   tenant_uuid, tenant_error = find_value(http, tenant_path, headers, tenant_container, tenant_key, new_resource.tenant_name, 'id')\n     42:   Chef::Log.error(\"There was an error looking up Tenant '#{new_resource.tenant_name}'\") if tenant_error\n     43: \n     44:   # lookup user_uuid\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "pinterest_it-cpe-cookbooks-cpe_screensaver-attributes-default.rb", "content": "'askForPassword' => nil,", "line": 15, "detection_span": [10, 20], "with_context": "\n# This source code is licensed under the Apache 2.0 license found in the\n# LICENSE file in the root directory of this source tree.\n#\n\ndefault['cpe_screensaver'] = {\n15:   'askForPassword' => nil,\n'askForPasswordDelay' => nil,\n'idleTime' => nil,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pinterest_it-cpe-cookbooks-cpe_screensaver-attributes-default.rb\n# Target line: 15\n\n     10: # This source code is licensed under the Apache 2.0 license found in the\n     11: # LICENSE file in the root directory of this source tree.\n     12: #\n     13: \n     14: default['cpe_screensaver'] = {\n>>>  15:   'askForPassword' => nil,\n     16:   'askForPasswordDelay' => nil,\n     17:   'idleTime' => nil,\n     18: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guntukukamal_chef-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']       = 'wwwrun'", "line": 57, "detection_span": [52, 62], "with_context": "\ndefault['nginx']['dir']          = '/usr/local/etc/nginx'\ndefault['nginx']['script_dir']   = '/usr/local/sbin'\ndefault['nginx']['binary']       = '/usr/local/sbin/nginx'\ndefault['nginx']['default_root'] = '/usr/local/www/nginx-dist'\nwhen 'suse'\n57:   default['nginx']['user']       = 'wwwrun'\ndefault['nginx']['group']      = 'www'\nelse # debian probably\ndefault['nginx']['user']       = 'www-data'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guntukukamal_chef-cookbooks-nginx-attributes-default.rb\n# Target line: 57\n\n     52:   default['nginx']['dir']          = '/usr/local/etc/nginx'\n     53:   default['nginx']['script_dir']   = '/usr/local/sbin'\n     54:   default['nginx']['binary']       = '/usr/local/sbin/nginx'\n     55:   default['nginx']['default_root'] = '/usr/local/www/nginx-dist'\n     56: when 'suse'\n>>>  57:   default['nginx']['user']       = 'wwwrun'\n     58:   default['nginx']['group']      = 'www'\n     59: else # debian probably\n     60:   default['nginx']['user']       = 'www-data'\n     61: end\n     62: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-gnocchi_conf.rb", "content": "conf['keystone_authtoken']['username'] = 'gnocchi'", "line": 5, "detection_span": [1, 10], "with_context": "\ndefault['openstack']['telemetry_metric']['conf_secrets'] = {}\n\ndefault['openstack']['telemetry_metric']['conf'].tap do |conf|\n# [keystone_authtoken] section\n5:   conf['keystone_authtoken']['username'] = 'gnocchi'\nconf['keystone_authtoken']['project_name'] = 'service'\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-gnocchi_conf.rb\n# Target line: 5\n\n      1: default['openstack']['telemetry_metric']['conf_secrets'] = {}\n      2: \n      3: default['openstack']['telemetry_metric']['conf'].tap do |conf|\n      4:   # [keystone_authtoken] section\n>>>   5:   conf['keystone_authtoken']['username'] = 'gnocchi'\n      6:   conf['keystone_authtoken']['project_name'] = 'service'\n      7:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n      8:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n      9:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     10:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb", "content": "default[:kafka][:ftp_loader][:user] = 'root'", "line": 88, "detection_span": [83, 93], "with_context": "\n\ndefault[:kafka][:ftp_loader][:code_dir] = '/usr/local/share/kafka-contrib/current/'\ndefault[:kafka][:ftp_loader][:conf_dir] = '/usr/local/share/kafka-contrib/shared/config/'\ndefault[:kafka][:ftp_loader][:scripts_directory] = '/usr/local/share/kafka-contrib/current/scripts'\ndefault[:kafka][:ftp_loader][:command] = \"bundle exec ruby #{default[:kafka][:ftp_loader][:scripts_directory]}/ftp2s3.rb\"\n88: default[:kafka][:ftp_loader][:user] = 'root'\n\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb\n# Target line: 88\n\n     83: \n     84: default[:kafka][:ftp_loader][:code_dir] = '/usr/local/share/kafka-contrib/current/'\n     85: default[:kafka][:ftp_loader][:conf_dir] = '/usr/local/share/kafka-contrib/shared/config/'\n     86: default[:kafka][:ftp_loader][:scripts_directory] = '/usr/local/share/kafka-contrib/current/scripts'\n     87: default[:kafka][:ftp_loader][:command] = \"bundle exec ruby #{default[:kafka][:ftp_loader][:scripts_directory]}/ftp2s3.rb\"\n>>>  88: default[:kafka][:ftp_loader][:user] = 'root'\n     89: \n     90: \n     91: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb", "content": "conf_secrets['DEFAULT']['stack_domain_admin_password'] =", "line": 91, "detection_span": [86, 96], "with_context": "\ndb_uri('orchestration', db_user, db_pass)\nconf_secrets['keystone_authtoken']['password'] =\nget_password 'service', 'openstack-orchestration'\nconf_secrets['trustee']['password'] =\nget_password 'service', 'openstack-orchestration'\n91:   conf_secrets['DEFAULT']['stack_domain_admin_password'] =\nget_password 'user', stack_domain_admin\nend\n\n# merge all config options and secrets to be used in the heat.conf\nheat_conf_options = merge_config_options 'orchestration'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb\n# Target line: 91\n\n     86:     db_uri('orchestration', db_user, db_pass)\n     87:   conf_secrets['keystone_authtoken']['password'] =\n     88:     get_password 'service', 'openstack-orchestration'\n     89:   conf_secrets['trustee']['password'] =\n     90:     get_password 'service', 'openstack-orchestration'\n>>>  91:   conf_secrets['DEFAULT']['stack_domain_admin_password'] =\n     92:     get_password 'user', stack_domain_admin\n     93: end\n     94: \n     95: # merge all config options and secrets to be used in the heat.conf\n     96: heat_conf_options = merge_config_options 'orchestration'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-php-attributes-default.rb", "content": "default['php']['fpm_user']      = 'nobody'", "line": 29, "detection_span": [24, 34], "with_context": "\n\ncase node[\"platform\"]\nwhen \"centos\", \"redhat\", \"fedora\"\ndefault['php']['conf_dir']      = '/etc'\ndefault['php']['ext_conf_dir']  = '/etc/php.d'\n29:   default['php']['fpm_user']      = 'nobody'\ndefault['php']['fpm_group']     = 'nobody'\ndefault['php']['ext_dir']       = \"/usr/#{lib_dir}/php/modules\"\nwhen \"debian\", \"ubuntu\"\ndefault['php']['conf_dir']      = '/etc/php5/cli'\ndefault['php']['ext_conf_dir']  = '/etc/php5/conf.d'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-php-attributes-default.rb\n# Target line: 29\n\n     24: \n     25: case node[\"platform\"]\n     26: when \"centos\", \"redhat\", \"fedora\"\n     27:   default['php']['conf_dir']      = '/etc'\n     28:   default['php']['ext_conf_dir']  = '/etc/php.d'\n>>>  29:   default['php']['fpm_user']      = 'nobody'\n     30:   default['php']['fpm_group']     = 'nobody'\n     31:   default['php']['ext_dir']       = \"/usr/#{lib_dir}/php/modules\"\n     32: when \"debian\", \"ubuntu\"\n     33:   default['php']['conf_dir']      = '/etc/php5/cli'\n     34:   default['php']['ext_conf_dir']  = '/etc/php5/conf.d'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "FriendsOfCake_vagrant-chef-cookbooks-percona-attributes-default.rb", "content": "default['mysql']['key_buffer']              = \"1G\"", "line": 7, "detection_span": [2, 12], "with_context": "\ndefault['mysql']['server_root_password']    = 'password'\ndefault['mysql']['server_repl_password']    = 'password'\ndefault['mysql']['bind_address']            = '0.0.0.0'\ndefault['mysql']['datadir']                 = \"/var/lib/mysql\"\n\n7: default['mysql']['key_buffer']              = \"1G\"\ndefault['mysql']['max_connections']         = \"450\"\ndefault['mysql']['tmpdir']                  = \"/tmp\"\ndefault['mysql']['query_cache_limit']       = \"20M\"\ndefault['mysql']['query_cache_size']        = \"512M\"\ndefault['mysql']['server_id']               = 1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: FriendsOfCake_vagrant-chef-cookbooks-percona-attributes-default.rb\n# Target line: 7\n\n      2: default['mysql']['server_root_password']    = 'password'\n      3: default['mysql']['server_repl_password']    = 'password'\n      4: default['mysql']['bind_address']            = '0.0.0.0'\n      5: default['mysql']['datadir']                 = \"/var/lib/mysql\"\n      6: \n>>>   7: default['mysql']['key_buffer']              = \"1G\"\n      8: default['mysql']['max_connections']         = \"450\"\n      9: default['mysql']['tmpdir']                  = \"/tmp\"\n     10: default['mysql']['query_cache_limit']       = \"20M\"\n     11: default['mysql']['query_cache_size']        = \"512M\"\n     12: default['mysql']['server_id']               = 1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-attributes-default.rb", "content": "default[:jenkins_integration][:smtp][:password] = ''", "line": 84, "detection_span": [79, 89], "with_context": "\n#\ndefault[:jenkins_integration][:smtp][:from]     = 'Mr. Jenkins <jenkins@example.com>'\ndefault[:jenkins_integration][:smtp][:server]   = 'smtp.example.com'\ndefault[:jenkins_integration][:smtp][:port]     = '25'\ndefault[:jenkins_integration][:smtp][:username] = ''\n84: default[:jenkins_integration][:smtp][:password] = ''\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-attributes-default.rb\n# Target line: 84\n\n     79: # \n     80: default[:jenkins_integration][:smtp][:from]     = 'Mr. Jenkins <jenkins@example.com>'\n     81: default[:jenkins_integration][:smtp][:server]   = 'smtp.example.com'\n     82: default[:jenkins_integration][:smtp][:port]     = '25'\n     83: default[:jenkins_integration][:smtp][:username] = ''\n>>>  84: default[:jenkins_integration][:smtp][:password] = ''\n     85: \n     86: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb", "content": "params[:svn_username] = nil", "line": 60, "detection_span": [55, 65], "with_context": "\nsvn_args = \"--no-auth-cache --non-interactive\"\nenable_submodules = false\nelse\nscm_prov = Chef::Provider::Git\nsvn_args = nil\n60:     params[:svn_username] = nil\nparams[:svn_password] = nil\nenable_submodules = true\nend\n\nlog \"  Capistrano deployment will use #{scm_prov} for initialization\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb\n# Target line: 60\n\n     55:     svn_args = \"--no-auth-cache --non-interactive\"\n     56:     enable_submodules = false\n     57:   else\n     58:     scm_prov = Chef::Provider::Git\n     59:     svn_args = nil\n>>>  60:     params[:svn_username] = nil\n     61:     params[:svn_password] = nil\n     62:     enable_submodules = true\n     63:   end\n     64: \n     65:   log \"  Capistrano deployment will use #{scm_prov} for initialization\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-attributes-default.rb", "content": "set_unless[:repo][:default][:storage_account_secret] = \"\"", "line": 16, "detection_span": [11, 21], "with_context": "\nset_unless[:repo][:default][:svn_username] = \"\"\nset_unless[:repo][:default][:svn_password] = \"\"\nset_unless[:repo][:default][:git_ssh_key] = \"\"\nset_unless[:repo][:default][:storage_account_provider] = \"S3\"\nset_unless[:repo][:default][:storage_account_id] = \"\"\n16: set_unless[:repo][:default][:storage_account_secret] = \"\"\nset_unless[:repo][:default][:container] = \"\"\nset_unless[:repo][:default][:prefix] = \"\"\nset_unless[:repo][:default][:environment]= {}\nset_unless[:repo][:default][:symlinks]= {}\nset_unless[:repo][:default][:purge_before_symlink] = %w{}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-attributes-default.rb\n# Target line: 16\n\n     11: set_unless[:repo][:default][:svn_username] = \"\"\n     12: set_unless[:repo][:default][:svn_password] = \"\"\n     13: set_unless[:repo][:default][:git_ssh_key] = \"\"\n     14: set_unless[:repo][:default][:storage_account_provider] = \"S3\"\n     15: set_unless[:repo][:default][:storage_account_id] = \"\"\n>>>  16: set_unless[:repo][:default][:storage_account_secret] = \"\"\n     17: set_unless[:repo][:default][:container] = \"\"\n     18: set_unless[:repo][:default][:prefix] = \"\"\n     19: set_unless[:repo][:default][:environment]= {}\n     20: set_unless[:repo][:default][:symlinks]= {}\n     21: set_unless[:repo][:default][:purge_before_symlink] = %w{}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-redis-cookbooks-elasticsearch-attributes-default.rb", "content": "default[:elasticsearch ][:user]                   = 'elasticsearch'", "line": 20, "detection_span": [15, 25], "with_context": "\n\n#\n# User\n#\n\n20: default[:elasticsearch ][:user]                   = 'elasticsearch'\ndefault[:users ]['elasticsearch'][:uid]           = 61021\ndefault[:groups]['elasticsearch'][:gid]           = 61021\n\n#\n# Install", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-elasticsearch-attributes-default.rb\n# Target line: 20\n\n     15: \n     16: #\n     17: # User\n     18: #\n     19: \n>>>  20: default[:elasticsearch ][:user]                   = 'elasticsearch'\n     21: default[:users ]['elasticsearch'][:uid]           = 61021\n     22: default[:groups]['elasticsearch'][:gid]           = 61021\n     23: \n     24: #\n     25: # Install\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "danielladd_Chef-Testing-cookbooks-database-libraries-provider_database_mysql_user.rb", "content": "password = filtered = \"PASSWORD '#{$1}'\"", "line": 62, "detection_span": [57, 67], "with_context": "\ndef action_grant\nbegin\n# does password look like MySQL hex digest?\n# (begins with *, followed by 40 hexadecimal characters)\nif (/(\\A\\*[0-9A-F]{40}\\z)/i).match(@new_resource.password) then\n62:               password = filtered = \"PASSWORD '#{$1}'\"\nelse\npassword = \"'#{@new_resource.password}'\"\nfiltered = '[FILTERED]'\nend\ngrant_statement = \"GRANT #{@new_resource.privileges.join(', ')} ON #{@new_resource.database_name && @new_resource.database_name != '*' ? \"`#{@new_resource.database_name}`\" : '*'}.#{@new_resource.table && @new_resource.table != '*' ? \"`#{@new_resource.table}`\" : '*'} TO `#{@new_resource.username}`@`#{@new_resource.host}` IDENTIFIED BY \"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-database-libraries-provider_database_mysql_user.rb\n# Target line: 62\n\n     57:         def action_grant\n     58:           begin\n     59:             # does password look like MySQL hex digest?\n     60:             # (begins with *, followed by 40 hexadecimal characters)\n     61:             if (/(\\A\\*[0-9A-F]{40}\\z)/i).match(@new_resource.password) then\n>>>  62:               password = filtered = \"PASSWORD '#{$1}'\"\n     63:             else\n     64:               password = \"'#{@new_resource.password}'\"\n     65:               filtered = '[FILTERED]'\n     66:             end\n     67:             grant_statement = \"GRANT #{@new_resource.privileges.join(', ')} ON #{@new_resource.database_name && @new_resource.database_name != '*' ? \"`#{@new_resource.database_name}`\" : '*'}.#{@new_resource.table && @new_resource.table != '*' ? \"`#{@new_resource.table}`\" : '*'} TO `#{@new_resource.username}`@`#{@new_resource.host}` IDENTIFIED BY \"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cookbooks_ss-chef-rvm-attributes-default.rb", "content": "default['rvm']['user_home_root']  = '/Users'", "line": 74, "detection_span": [69, 79], "with_context": "\nwhen \"debian\",\"ubuntu\",\"suse\"\nnode.set['rvm']['install_pkgs']   = %w{sed grep tar gzip bzip2 bash curl git-core}\ndefault['rvm']['user_home_root']  = '/home'\nwhen \"mac_os_x\", \"mac_os_x_server\"\nnode.set['rvm']['install_pkgs']   = %w{git}\n74:   default['rvm']['user_home_root']  = '/Users'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ss-chef-rvm-attributes-default.rb\n# Target line: 74\n\n     69: when \"debian\",\"ubuntu\",\"suse\"\n     70:   node.set['rvm']['install_pkgs']   = %w{sed grep tar gzip bzip2 bash curl git-core}\n     71:   default['rvm']['user_home_root']  = '/home'\n     72: when \"mac_os_x\", \"mac_os_x_server\"\n     73:   node.set['rvm']['install_pkgs']   = %w{git}\n>>>  74:   default['rvm']['user_home_root']  = '/Users'\n     75: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']         = 'www'", "line": 55, "detection_span": [50, 60], "with_context": "\nwhen 'gentoo'\ndefault['nginx']['user']       = 'nginx'\ndefault['nginx']['init_style'] = 'init'\nwhen 'freebsd'\ndefault['nginx']['package_name'] = 'www/nginx'\n55:   default['nginx']['user']         = 'www'\ndefault['nginx']['dir']          = '/usr/local/etc/nginx'\ndefault['nginx']['script_dir']   = '/usr/local/sbin'\ndefault['nginx']['binary']       = '/usr/local/sbin/nginx'\ndefault['nginx']['default_root'] = '/usr/local/www/nginx-dist'\nwhen 'suse'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb\n# Target line: 55\n\n     50: when 'gentoo'\n     51:   default['nginx']['user']       = 'nginx'\n     52:   default['nginx']['init_style'] = 'init'\n     53: when 'freebsd'\n     54:   default['nginx']['package_name'] = 'www/nginx'\n>>>  55:   default['nginx']['user']         = 'www'\n     56:   default['nginx']['dir']          = '/usr/local/etc/nginx'\n     57:   default['nginx']['script_dir']   = '/usr/local/sbin'\n     58:   default['nginx']['binary']       = '/usr/local/sbin/nginx'\n     59:   default['nginx']['default_root'] = '/usr/local/www/nginx-dist'\n     60: when 'suse'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_nodestack-recipes-demo.rb", "content": "proxy_pass: 'http://127.0.0.1:8000',", "line": 56, "detection_span": [51, 61], "with_context": "\nnode.set['nodestack']['nginx']['sites'][port][site]['cookbook']     = 'nodestack'\nnode.set['nodestack']['nginx']['sites'][port][site]['template']     = 'nginx/nodestack-demo.conf.erb'\nnode.set['nodestack']['nginx']['sites'][port][site]['variables'] = {\nserver_name: 'nodestack-demo.com',\nserver_aliases: [''],\n56:   proxy_pass: 'http://127.0.0.1:8000',\nerrorlog: \"#{node['nginx']['log_dir']}/#{site}-error.log debug\",\naccesslog: \"#{node['nginx']['log_dir']}/#{site}-access.log combined\"\n}\n\n# monitoring. nodestack::nginx also add's monitoring for the nginx site.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-recipes-demo.rb\n# Target line: 56\n\n     51: node.set['nodestack']['nginx']['sites'][port][site]['cookbook']     = 'nodestack'\n     52: node.set['nodestack']['nginx']['sites'][port][site]['template']     = 'nginx/nodestack-demo.conf.erb'\n     53: node.set['nodestack']['nginx']['sites'][port][site]['variables'] = {\n     54:   server_name: 'nodestack-demo.com',\n     55:   server_aliases: [''],\n>>>  56:   proxy_pass: 'http://127.0.0.1:8000',\n     57:   errorlog: \"#{node['nginx']['log_dir']}/#{site}-error.log debug\",\n     58:   accesslog: \"#{node['nginx']['log_dir']}/#{site}-access.log combined\"\n     59: }\n     60: \n     61: # monitoring. nodestack::nginx also add's monitoring for the nginx site.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-opsworks_initial_setup-attributes-default.rb", "content": "default[:opsworks_agent][:user] = 'aws'", "line": 24, "detection_span": [19, 29], "with_context": "\n# this values must match the ones respective ones in the agent configuration\ndefault[:opsworks_agent][:base_dir] = '/opt/aws/opsworks'\ndefault[:opsworks_agent][:current_dir] = \"#{node[:opsworks_agent][:base_dir]}/current\"\ndefault[:opsworks_agent][:shared_dir] = '/var/lib/aws/opsworks'\ndefault[:opsworks_agent][:log_dir] = '/var/log/aws/opsworks'\n24: default[:opsworks_agent][:user] = 'aws'\ndefault[:opsworks_agent][:group] = 'aws'\n\ndefault[:opsworks][:ruby_stack] = 'ruby'\ndefault[:opsworks][:ruby_version] = '1.9.3'\ndefault[:opsworks][:run_cookbook_tests] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-opsworks_initial_setup-attributes-default.rb\n# Target line: 24\n\n     19: # this values must match the ones respective ones in the agent configuration\n     20: default[:opsworks_agent][:base_dir] = '/opt/aws/opsworks'\n     21: default[:opsworks_agent][:current_dir] = \"#{node[:opsworks_agent][:base_dir]}/current\"\n     22: default[:opsworks_agent][:shared_dir] = '/var/lib/aws/opsworks'\n     23: default[:opsworks_agent][:log_dir] = '/var/log/aws/opsworks'\n>>>  24: default[:opsworks_agent][:user] = 'aws'\n     25: default[:opsworks_agent][:group] = 'aws'\n     26: \n     27: default[:opsworks][:ruby_stack] = 'ruby'\n     28: default[:opsworks][:ruby_version] = '1.9.3'\n     29: default[:opsworks][:run_cookbook_tests] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Soluciones_ey-cloud-recipes-cookbooks-datadog-recipes-default.rb", "content": "user \"deploy\"", "line": 13, "detection_span": [8, 18], "with_context": "\n\n# stop the agent before the install if it is already on there\n\n\nexecute \"monit-stop-dd\" do\n13:  user \"deploy\"\ncwd \"/\"\ncommand \"monit stop datadog_wrapper; sleep 30\"\nonly_if \" pgrep 'datadog_wrapper' > /dev/null\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-datadog-recipes-default.rb\n# Target line: 13\n\n      8: \n      9: # stop the agent before the install if it is already on there\n     10: \n     11: \n     12: execute \"monit-stop-dd\" do\n>>>  13:  user \"deploy\"\n     14:  cwd \"/\"\n     15:  command \"monit stop datadog_wrapper; sleep 30\"\n     16:  only_if \" pgrep 'datadog_wrapper' > /dev/null\"\n     17: end\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-talend-attributes-job.rb", "content": "\"Metadata_Username\" => \"admin\",", "line": 24, "detection_span": [19, 29], "with_context": "\ndefault['talend']['working']     = \"#{node['talend']['base_dir']}/data\"\ndefault['talend']['rubbish_dir'] = \"#{node['talend']['base_dir']}/rubbish\"\n\ndefault['talend']['mocked_config_regexps'] = {\n\".*_Server$\"        => \"localhost\",\n24:   \"Metadata_Username\" => \"admin\",\n\"Metadata_Password\" => \"admin\",\n\"Metadata_URL\"      => \"http://localhost:8080/geonetwork\"\n}\n\ndefault['talend']['max_parallel_jobs'] = node['cpu']['total'] ? node['cpu']['total'].to_i : 2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-talend-attributes-job.rb\n# Target line: 24\n\n     19: default['talend']['working']     = \"#{node['talend']['base_dir']}/data\"\n     20: default['talend']['rubbish_dir'] = \"#{node['talend']['base_dir']}/rubbish\"\n     21: \n     22: default['talend']['mocked_config_regexps'] = {\n     23:   \".*_Server$\"        => \"localhost\",\n>>>  24:   \"Metadata_Username\" => \"admin\",\n     25:   \"Metadata_Password\" => \"admin\",\n     26:   \"Metadata_URL\"      => \"http://localhost:8080/geonetwork\"\n     27: }\n     28: \n     29: default['talend']['max_parallel_jobs'] = node['cpu']['total'] ? node['cpu']['total'].to_i : 2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-windows-resources-certificate.rb", "content": "cert_script = '$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2'", "line": 109, "detection_span": [104, 114], "with_context": "\n104:   def cert_location\n@location ||= new_resource.user_store ? 'CurrentUser' : 'LocalMachine'\n106:   end\n107:\n108:   def cert_script(persist)\n109:     cert_script = '$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2'\nfile = win_friendly_path(new_resource.source)\ncert_script << \" \\\"#{file}\\\"\"\nif ::File.extname(file.downcase) == '.pfx'\ncert_script << \", \\\"#{new_resource.pfx_password}\\\"\"\nif persist && new_resource.user_store", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-windows-resources-certificate.rb\n# Target line: 109\n\n    104:   def cert_location\n    105:     @location ||= new_resource.user_store ? 'CurrentUser' : 'LocalMachine'\n    106:   end\n    107: \n    108:   def cert_script(persist)\n>>> 109:     cert_script = '$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2'\n    110:     file = win_friendly_path(new_resource.source)\n    111:     cert_script << \" \\\"#{file}\\\"\"\n    112:     if ::File.extname(file.downcase) == '.pfx'\n    113:       cert_script << \", \\\"#{new_resource.pfx_password}\\\"\"\n    114:       if persist && new_resource.user_store\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Bhanuprakash-ch_platform-ansible-defaults-hgm.yml", "content": "hgm_zookeeper_pass: hgm_masterpw", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: Bhanuprakash-ch_platform-ansible-defaults-hgm.yml\n\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\nhgm_zookeeper_user: hgm_user\n17: hgm_zookeeper_pass: hgm_masterpw\nhgm_basic_user: hgm_basic_user\nhgm_basic_pass: hgm_basic_pass", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Bhanuprakash-ch_platform-ansible-defaults-hgm.yml\n# Target line: 17\n\n     12: # See the License for the specific language governing permissions and\n     13: # limitations under the License.\n     14: #\n     15: \n     16: hgm_zookeeper_user: hgm_user\n>>>  17: hgm_zookeeper_pass: hgm_masterpw\n     18: hgm_basic_user: hgm_basic_user\n     19: hgm_basic_pass: hgm_basic_pass\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml", "content": "become_user: sysadmin", "line": 176, "detection_span": [171, 181], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n\n--values /tmp/armada-overrides.yaml\n--wait\n--debug\nwhen: mode == \"upgrade_k8s_armada_helm\"\n175:\n176:   become_user: sysadmin\n177:   environment:\nKUBECONFIG: /etc/kubernetes/admin.conf\nHOME: /home/sysadmin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n# Target line: 176\n\n    171:       --values /tmp/armada-overrides.yaml\n    172:       --wait\n    173:       --debug\n    174:     when: mode == \"upgrade_k8s_armada_helm\"\n    175: \n>>> 176:   become_user: sysadmin\n    177:   environment:\n    178:     KUBECONFIG: /etc/kubernetes/admin.conf\n    179:     HOME: /home/sysadmin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CentOS-PaaS-SIG_linchpin-docs-source-examples-workspace-PinFile.libvirt.yml", "content": "ssh_key: libvirt", "line": 29, "detection_span": [24, 34], "with_context": "# Ansible file: CentOS-PaaS-SIG_linchpin-docs-source-examples-workspace-PinFile.libvirt.yml\n\nmemory: 1024\nvcpus: 1\narch: x86_64\nnetworks:\n- name: default\n29:             ssh_key: libvirt\nadditional_storage: 10G\ncloud_config:\nvirt_type: virt-customize\nroot_password: \"testrootpwd\" # insecure plaintext password\nusers:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: CentOS-PaaS-SIG_linchpin-docs-source-examples-workspace-PinFile.libvirt.yml\n# Target line: 29\n\n     24:             memory: 1024\n     25:             vcpus: 1\n     26:             arch: x86_64\n     27:             networks:\n     28:               - name: default\n>>>  29:             ssh_key: libvirt\n     30:             additional_storage: 10G\n     31:             cloud_config:\n     32:               virt_type: virt-customize\n     33:               root_password: \"testrootpwd\" # insecure plaintext password\n     34:               users:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "imusyed_Ansible-language_features-ansible_pull.yml", "content": "cron_user: root", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: imusyed_Ansible-language_features-ansible_pull.yml\n\n\n# schedule is fed directly to cron\nschedule: '*/15 * * * *'\n\n# User to run ansible-pull as from cron\n27:     cron_user: root\n\n# File that ansible will use for logs\nlogfile: /var/log/ansible-pull.log\n\n# Directory to where repository will be cloned", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: imusyed_Ansible-language_features-ansible_pull.yml\n# Target line: 27\n\n     22: \n     23:     # schedule is fed directly to cron\n     24:     schedule: '*/15 * * * *'\n     25: \n     26:     # User to run ansible-pull as from cron\n>>>  27:     cron_user: root\n     28: \n     29:     # File that ansible will use for logs\n     30:     logfile: /var/log/ansible-pull.log\n     31: \n     32:     # Directory to where repository will be cloned\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "folio-org_folio-ansible-roles-post-config-entries-tasks-main.yml", "content": "Authtoken-Refresh-Cache: \"true\"", "line": 66, "detection_span": [61, 71], "with_context": "# Ansible file: folio-org_folio-ansible-roles-post-config-entries-tasks-main.yml\n\nuri:\nurl: \"{{ okapi_url }}/configurations/entries\"\nmethod: POST\nbody_format: json\nheaders:\n66:           Authtoken-Refresh-Cache: \"true\"\nX-Okapi-Tenant: \"{{ tenant }}\"\nAccept: application/json\nX-Okapi-Token: \"{{ tenant_token | default('') }}\"\nbody: \"{{ lookup('template', 'suppress_edit.json.j2') }}\"\nstatus_code: 201, 422", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: folio-org_folio-ansible-roles-post-config-entries-tasks-main.yml\n# Target line: 66\n\n     61:       uri: \n     62:         url: \"{{ okapi_url }}/configurations/entries\"\n     63:         method: POST\n     64:         body_format: json\n     65:         headers: \n>>>  66:           Authtoken-Refresh-Cache: \"true\"\n     67:           X-Okapi-Tenant: \"{{ tenant }}\"\n     68:           Accept: application/json\n     69:           X-Okapi-Token: \"{{ tenant_token | default('') }}\"\n     70:         body: \"{{ lookup('template', 'suppress_edit.json.j2') }}\"\n     71:         status_code: 201, 422\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "geerlingguy_ansible-role-apache-molecule-default-converge.yml", "content": "documentroot: \"/var/www/vhosts/example_com\"", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: geerlingguy_ansible-role-apache-molecule-default-converge.yml\n\napache_listen_port_ssl: 443\napache_create_vhosts: true\napache_vhosts_filename: \"vhosts.conf\"\napache_vhosts:\n- servername: \"example.com\"\n12:         documentroot: \"/var/www/vhosts/example_com\"\n\npre_tasks:\n- name: Update apt cache.\napt: update_cache=yes cache_valid_time=600\nwhen: ansible_os_family == 'Debian'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_ansible-role-apache-molecule-default-converge.yml\n# Target line: 12\n\n      7:     apache_listen_port_ssl: 443\n      8:     apache_create_vhosts: true\n      9:     apache_vhosts_filename: \"vhosts.conf\"\n     10:     apache_vhosts:\n     11:       - servername: \"example.com\"\n>>>  12:         documentroot: \"/var/www/vhosts/example_com\"\n     13: \n     14:   pre_tasks:\n     15:     - name: Update apt cache.\n     16:       apt: update_cache=yes cache_valid_time=600\n     17:       when: ansible_os_family == 'Debian'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml", "content": "cert: this-file-does-not-exist-and-must-be-overridden", "line": 1, "detection_span": [1, 6], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n\n1: cert: this-file-does-not-exist-and-must-be-overridden\nkey: this-file-does-not-exist-and-must-be-overridden", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n# Target line: 1\n\n>>>   1: cert: this-file-does-not-exist-and-must-be-overridden\n      2: key: this-file-does-not-exist-and-must-be-overridden\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-main.yml", "content": "login_user: root", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-main.yml\n\n- name: Ensure  that the db is present\nmysql_db:\nname: fgapiserver\n#login_host: \"{{ db_config.ansible_facts.ansible_docker_container.NetworkSettings.IPAddress }}\"\nlogin_host: \"{{ hostvars['db']['ansible_default_ipv4']['address'] }}\"\n34:         login_user: root\nlogin_password: \"{{ db_root_password }}\"\nstate: import\ntarget: \"{{ lookup('env','PWD')}}/roles/fgapi-db/files/fgapiserver_db.sql\"\nretries: 3\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-main.yml\n# Target line: 34\n\n     29:     - name: Ensure  that the db is present\n     30:       mysql_db:\n     31:         name: fgapiserver\n     32:         #login_host: \"{{ db_config.ansible_facts.ansible_docker_container.NetworkSettings.IPAddress }}\"\n     33:         login_host: \"{{ hostvars['db']['ansible_default_ipv4']['address'] }}\"\n>>>  34:         login_user: root\n     35:         login_password: \"{{ db_root_password }}\"\n     36:         state: import\n     37:         target: \"{{ lookup('env','PWD')}}/roles/fgapi-db/files/fgapiserver_db.sql\"\n     38:       retries: 3\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulp_pulp-operator-playbooks-pulp.yml", "content": "redis_password: \"\"", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: pulp_pulp-operator-playbooks-pulp.yml\n\nCONN_MAX_AGE: 0\nOPTIONS:\nsslmode: '{{ postgres_sslmode }}'\nredis_host: \"{{ ansible_operator_meta.name }}-redis-svc\"\nredis_port: 6379\n26:       redis_password: \"\"\ndeployment_state: present\n_image: quay.io/pulp/pulp\n_image_version: stable\n_image_web: quay.io/pulp/pulp-web\n_image_web_version: stable", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulp_pulp-operator-playbooks-pulp.yml\n# Target line: 26\n\n     21:           CONN_MAX_AGE: 0\n     22:           OPTIONS:\n     23:             sslmode: '{{ postgres_sslmode }}'\n     24:       redis_host: \"{{ ansible_operator_meta.name }}-redis-svc\"\n     25:       redis_port: 6379\n>>>  26:       redis_password: \"\"\n     27:     deployment_state: present\n     28:     _image: quay.io/pulp/pulp\n     29:     _image_version: stable\n     30:     _image_web: quay.io/pulp/pulp-web\n     31:     _image_web_version: stable\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "enthought_edx_ansible-playbooks-roles-antivirus-defaults-main.yml", "content": "ANTIVIRUS_AWS_SECRET: \"\"", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-antivirus-defaults-main.yml\n\n\nANTIVIRUS_BUCKETS: !!null\nANTIVIRUS_MAILTO: \"{{ EDXAPP_TECH_SUPPORT_EMAIL  }}\"\nANTIVIRUS_MAILFROM: \"{{ EDXAPP_DEFAULT_FROM_EMAIL }}\"\nANTIVIRUS_AWS_KEY: \"\"\n34: ANTIVIRUS_AWS_SECRET: \"\"\nANTIVIRUS_S3_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\nANTIVIRUS_SES_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\nANTIVIRUS_S3_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"\nANTIVIRUS_SES_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-antivirus-defaults-main.yml\n# Target line: 34\n\n     29: \n     30: ANTIVIRUS_BUCKETS: !!null\n     31: ANTIVIRUS_MAILTO: \"{{ EDXAPP_TECH_SUPPORT_EMAIL  }}\"\n     32: ANTIVIRUS_MAILFROM: \"{{ EDXAPP_DEFAULT_FROM_EMAIL }}\"\n     33: ANTIVIRUS_AWS_KEY: \"\"\n>>>  34: ANTIVIRUS_AWS_SECRET: \"\"\n     35: ANTIVIRUS_S3_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\n     36: ANTIVIRUS_SES_AWS_KEY: \"{{ ANTIVIRUS_AWS_KEY }}\"\n     37: ANTIVIRUS_S3_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"\n     38: ANTIVIRUS_SES_AWS_SECRET: \"{{ ANTIVIRUS_AWS_SECRET}}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dimagi_commcare-cloud-commcare-cloud-bootstrap-environment-public.yml", "content": "commcare_cloud_strict_host_key_checking: no", "line": 77, "detection_span": [72, 82], "with_context": "# Ansible file: dimagi_commcare-cloud-commcare-cloud-bootstrap-environment-public.yml\n\nSTATIC_CDN: \"\"\n\nroot_email: /dev/null\n\ncommcare_cloud_root_user: ubuntu\n77: commcare_cloud_strict_host_key_checking: no\ncommcare_cloud_use_vault: no", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dimagi_commcare-cloud-commcare-cloud-bootstrap-environment-public.yml\n# Target line: 77\n\n     72:   STATIC_CDN: \"\"\n     73: \n     74: root_email: /dev/null\n     75: \n     76: commcare_cloud_root_user: ubuntu\n>>>  77: commcare_cloud_strict_host_key_checking: no\n     78: commcare_cloud_use_vault: no\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "hussainaphroj_ansible_examples-lamp_haproxy-site.yml", "content": "remote_user: root", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: hussainaphroj_ansible_examples-lamp_haproxy-site.yml\n\nroles:\n- common\n\n# Configure and deploy database servers.\n- hosts: dbservers\n12:   remote_user: root\nroles:\n- db\n\n# Configure and deploy the web servers. Note that we include two roles here,\n# the 'base-apache' role which simply sets up Apache, and 'web' which includes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: hussainaphroj_ansible_examples-lamp_haproxy-site.yml\n# Target line: 12\n\n      7:   roles:\n      8:   - common\n      9: \n     10: # Configure and deploy database servers.\n     11: - hosts: dbservers\n>>>  12:   remote_user: root\n     13:   roles:\n     14:   - db\n     15: \n     16: # Configure and deploy the web servers. Note that we include two roles here, \n     17: # the 'base-apache' role which simply sets up Apache, and 'web' which includes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml", "content": "key: key", "line": 94, "detection_span": [89, 99], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n\nkey: ca\n- name: EC_KEY\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\n94:                 key: key\n- name: JAVA_OPTS\nvalue:\n-Xmx1G\n-Dcommons.db.connection.host=$MARIADB_101_RHEL7_PORT_3306_TCP_ADDR\n-Dcommons.db.connection.port=$MARIADB_101_RHEL7_PORT_3306_TCP_PORT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n# Target line: 94\n\n     89:                 key: ca\n     90:           - name: EC_KEY\n     91:             valueFrom:\n     92:               secretKeyRef:\n     93:                 name: \"${EC_SECRET_CRT}\"\n>>>  94:                 key: key\n     95:           - name: JAVA_OPTS\n     96:             value:\n     97:               -Xmx1G\n     98:               -Dcommons.db.connection.host=$MARIADB_101_RHEL7_PORT_3306_TCP_ADDR\n     99:               -Dcommons.db.connection.port=$MARIADB_101_RHEL7_PORT_3306_TCP_PORT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "w3f_polkadot-validator-setup-ansible-roles-nginx-auth-defaults-main.yml", "content": "nginx_password: nginx_password", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: w3f_polkadot-validator-setup-ansible-roles-nginx-auth-defaults-main.yml\n\nnginx_user: prometheus\n2: nginx_password: nginx_password", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: w3f_polkadot-validator-setup-ansible-roles-nginx-auth-defaults-main.yml\n# Target line: 2\n\n      1: nginx_user: prometheus\n>>>   2: nginx_password: nginx_password\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cjeanner_tripleo-lab-roles-undercloud-tasks-install-built-rpms.yaml", "content": "become_user: root", "line": 11, "detection_span": [6, 16], "with_context": "# Ansible file: cjeanner_tripleo-lab-roles-undercloud-tasks-install-built-rpms.yaml\n\nrecurse: false\nregister: rpm_to_install\n\n- name: install custom RPMs\nbecome: true\n11:   become_user: root\nwhen: rpm_to_install['files'] !=  []\ncommand: \"yum install -y {{ rpm_to_install['files'] |map(attribute='path') | join(' ') }}\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cjeanner_tripleo-lab-roles-undercloud-tasks-install-built-rpms.yaml\n# Target line: 11\n\n      6:     recurse: false\n      7:   register: rpm_to_install\n      8: \n      9: - name: install custom RPMs\n     10:   become: true\n>>>  11:   become_user: root\n     12:   when: rpm_to_install['files'] !=  []\n     13:   command: \"yum install -y {{ rpm_to_install['files'] |map(attribute='path') | join(' ') }}\"\n     14: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-playbooks-installer-rdo-manager-cleanup_virthost.yml", "content": "- ansible_ssh_user: root", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-cleanup_virthost.yml\n\n---\n- include: \"{{base_dir}}/khaleesi/playbooks/provisioner/manual/main.yml\"\n- name: clean up rdo-manager virthost\nhosts: virthost\nvars:\n6:       - ansible_ssh_user: root\nroles:\n- { role: cleanup_nodes/rdo-manager,\nwhen: (installer.type == \"rdo-manager\" and provisioner.type == \"manual\")\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-cleanup_virthost.yml\n# Target line: 6\n\n      1: ---\n      2: - include: \"{{base_dir}}/khaleesi/playbooks/provisioner/manual/main.yml\"\n      3: - name: clean up rdo-manager virthost\n      4:   hosts: virthost\n      5:   vars:\n>>>   6:       - ansible_ssh_user: root\n      7:   roles:\n      8:       - { role: cleanup_nodes/rdo-manager,\n      9:           when: (installer.type == \"rdo-manager\" and provisioner.type == \"manual\")\n     10:         }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nnova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\nnova_service_password: 054e7b1078a9f2cd\nnova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\nrabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\nrabbitmq_password: b763ef86fce7338e145c9c8c\nswift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\nswift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\nswift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 36\n\n     31: nova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n     34: nova_service_password: 054e7b1078a9f2cd\n     35: nova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n>>>  36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n     37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\n     38: rabbitmq_password: b763ef86fce7338e145c9c8c\n     39: swift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\n     40: swift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\n     41: swift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-arkcase-ldap-config-tasks-main.yml", "content": "become_user: arkcase", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-arkcase-ldap-config-tasks-main.yml\n\n- set_fact:\nldap_server_configuration: \"{{ lookup('template', 'templates/ldap.yaml') }}\"\n\n- name: Server ldap configuration {{ ldap_user_domain_bean_name }}\nbecome: yes\n64:   become_user: arkcase\nblockinfile:\npath: /home/arkcase/.arkcase/acm/acm-config-server-repo/ldap/ldap-server.yaml\nblock: \"{{ ldap_server_configuration }}\"\nmarker: \"# {mark} ANSIBLE MANAGED BLOCK {{ ldap_user_domain_bean_name }}\"\nwhen: arkcase_version == \"\" or arkcase_version is version('3.3.7', '>=')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-arkcase-ldap-config-tasks-main.yml\n# Target line: 64\n\n     59: - set_fact:\n     60:     ldap_server_configuration: \"{{ lookup('template', 'templates/ldap.yaml') }}\"\n     61: \n     62: - name: Server ldap configuration {{ ldap_user_domain_bean_name }}\n     63:   become: yes\n>>>  64:   become_user: arkcase\n     65:   blockinfile:\n     66:     path: /home/arkcase/.arkcase/acm/acm-config-server-repo/ldap/ldap-server.yaml\n     67:     block: \"{{ ldap_server_configuration }}\"\n     68:     marker: \"# {mark} ANSIBLE MANAGED BLOCK {{ ldap_user_domain_bean_name }}\"\n     69:   when: arkcase_version == \"\" or arkcase_version is version('3.3.7', '>=')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcalvaga_examples-ansible-language_features-rabbitmq.yml", "content": "apt_key: url=https://www.rabbitmq.com/rabbitmq-signing-key-public.asc state=present", "line": 16, "detection_span": [11, 21], "with_context": "# Ansible file: rcalvaga_examples-ansible-language_features-rabbitmq.yml\n\n\n- name: add rabbitmq official apt repository\napt_repository: repo='deb http://www.rabbitmq.com/debian/ testing main' state=present\n\n- name: add trusted key\n16:     apt_key: url=https://www.rabbitmq.com/rabbitmq-signing-key-public.asc state=present\n\n- name: install package\napt: name={{ item }} update_cache=yes state=installed\nwith_items:\n- rabbitmq-server", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: rcalvaga_examples-ansible-language_features-rabbitmq.yml\n# Target line: 16\n\n     11: \n     12:   - name: add rabbitmq official apt repository\n     13:     apt_repository: repo='deb http://www.rabbitmq.com/debian/ testing main' state=present\n     14: \n     15:   - name: add trusted key\n>>>  16:     apt_key: url=https://www.rabbitmq.com/rabbitmq-signing-key-public.asc state=present\n     17: \n     18:   - name: install package\n     19:     apt: name={{ item }} update_cache=yes state=installed\n     20:     with_items:\n     21:       - rabbitmq-server\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-agile-integration-enterprise-files-postgresql-seed.yaml", "content": "key: database-name", "line": 102, "detection_span": [97, 107], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-agile-integration-enterprise-files-postgresql-seed.yaml\n\nkey: database-password\nname: ${DATABASE_SERVICE_NAME}\n- name: POSTGRESQL_DATABASE\nvalueFrom:\nsecretKeyRef:\n102:                   key: database-name\nname: ${DATABASE_SERVICE_NAME}\n- name: POSTGRESQL_SERVICE\nvalue: ${DATABASE_SERVICE_NAME}\nvolumeMounts:\n- name: seed-volume", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-agile-integration-enterprise-files-postgresql-seed.yaml\n# Target line: 102\n\n     97:                   key: database-password\n     98:                   name: ${DATABASE_SERVICE_NAME}\n     99:             - name: POSTGRESQL_DATABASE\n    100:               valueFrom:\n    101:                 secretKeyRef:\n>>> 102:                   key: database-name\n    103:                   name: ${DATABASE_SERVICE_NAME}\n    104:             - name: POSTGRESQL_SERVICE\n    105:               value: ${DATABASE_SERVICE_NAME}\n    106:           volumeMounts:\n    107:             - name: seed-volume\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml", "content": "- user: devops", "line": 111, "detection_span": [106, 116], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n\n106: tower_version: 3.7.3-1\n107: tower_hostname: \"tower.{{ guid }}.{{ osp_cluster_dns_zone }}\"\n108:\n109: # Tower Configuration Dictionaries, correspond with configure_tower.yml\n110: tower_user_accounts:\n111:   - user: devops\npassword: \"{{ devops_password_tower }}\"\nemail: devops@example.com\nfirstname: Devon\nlastname: Operations\nsuperuser: yes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n# Target line: 111\n\n    106: tower_version: 3.7.3-1\n    107: tower_hostname: \"tower.{{ guid }}.{{ osp_cluster_dns_zone }}\"\n    108: \n    109: # Tower Configuration Dictionaries, correspond with configure_tower.yml\n    110: tower_user_accounts: \n>>> 111:   - user: devops\n    112:     password: \"{{ devops_password_tower }}\"\n    113:     email: devops@example.com\n    114:     firstname: Devon\n    115:     lastname: Operations\n    116:     superuser: yes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cchheda1_https-github.com-PaloAltoNetworks-ansible-pan-ansible-playbooks-terraform_integration-vars-sample.yml", "content": "admin_username: \"admin\"", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: cchheda1_https-github.com-PaloAltoNetworks-ansible-pan-ansible-playbooks-terraform_integration-vars-sample.yml\n\n# vars.yml\n2: admin_username: \"admin\"\nadmin_password: \"admin\"\nmgmt_ip: \"127.0.0.1\"\nkey_name: \"/home/creds/my-key.pem\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cchheda1_https-github.com-PaloAltoNetworks-ansible-pan-ansible-playbooks-terraform_integration-vars-sample.yml\n# Target line: 2\n\n      1: # vars.yml\n>>>   2: admin_username: \"admin\"\n      3: admin_password: \"admin\"\n      4: mgmt_ip: \"127.0.0.1\"\n      5: key_name: \"/home/creds/my-key.pem\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "manala_ansible-roles-molecule-mysql.galera.4.10.mysql_wsrep.8.0.26-converge.yml", "content": "password: foo", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: manala_ansible-roles-molecule-mysql.galera.4.10.mysql_wsrep.8.0.26-converge.yml\n\n- galera-arbitrator-4\n- mysql-wsrep-server\n- mysql-wsrep-client\nmanala_mysql_users:\n- name: foo\n25:                 password: foo\nhost: localhost\npriv: \"*.*:ALL,GRANT\"\n- name: bar\nstate: ignore\n# Flatten", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: manala_ansible-roles-molecule-mysql.galera.4.10.mysql_wsrep.8.0.26-converge.yml\n# Target line: 25\n\n     20:               - galera-arbitrator-4\n     21:               - mysql-wsrep-server\n     22:               - mysql-wsrep-client\n     23:             manala_mysql_users:\n     24:               - name: foo\n>>>  25:                 password: foo\n     26:                 host: localhost\n     27:                 priv: \"*.*:ALL,GRANT\"\n     28:               - name: bar\n     29:                 state: ignore\n     30:               # Flatten\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml", "content": "key_usage_critical: yes", "line": 90, "detection_span": [85, 95], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n\nopenssl_csr:\nbasic_constraints_critical: yes\nbasic_constraints:\n- CA:TRUE\n- pathlen:0\n90:     key_usage_critical: yes\nkey_usage:\n- Digital Signature\n- Certificate Sign\n- CRL Sign\ndigest: sha256", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n# Target line: 90\n\n     85:   openssl_csr:\n     86:     basic_constraints_critical: yes\n     87:     basic_constraints:\n     88:       - CA:TRUE\n     89:       - pathlen:0\n>>>  90:     key_usage_critical: yes\n     91:     key_usage:\n     92:       - Digital Signature\n     93:       - Certificate Sign\n     94:       - CRL Sign\n     95:     digest: sha256\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml", "content": "become_user: barman", "line": 56, "detection_span": [51, 61], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n\nchanged_when: no\ntags: keys\n\n- name: ensure we have postgres key in known hosts file for barman\nlineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ postgres_host }}\\s+ssh-rsa\\s+.*\" line=\"{{ postgres_rsa_key.stdout }}\"\n56:   become_user: barman\ntags: keys\n\n- name: ensure we have barman key in known hosts file for postgres\nlineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ barman_ip }}\\s+ssh-rsa\\s+.*\" line=\"{{ barman_rsa_key.stdout }}\"\nbecome_user: postgres", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n# Target line: 56\n\n     51:   changed_when: no\n     52:   tags: keys\n     53: \n     54: - name: ensure we have postgres key in known hosts file for barman\n     55:   lineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ postgres_host }}\\s+ssh-rsa\\s+.*\" line=\"{{ postgres_rsa_key.stdout }}\"\n>>>  56:   become_user: barman\n     57:   tags: keys\n     58: \n     59: - name: ensure we have barman key in known hosts file for postgres\n     60:   lineinfile: dest=~/.ssh/known_hosts regexp=\"^{{ barman_ip }}\\s+ssh-rsa\\s+.*\" line=\"{{ barman_rsa_key.stdout }}\"\n     61:   become_user: postgres\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml", "content": "user: name=barman generate_ssh_key=yes", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n\n- name: generate ssh key for user barman\n2:   user: name=barman generate_ssh_key=yes\n\n- name: generate ssh key for user postgres\nuser: name=postgres generate_ssh_key=yes\ndelegate_to: \"{{ postgres_host }}\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-postgresql-tasks-users.yml\n# Target line: 2\n\n      1: - name: generate ssh key for user barman\n>>>   2:   user: name=barman generate_ssh_key=yes\n      3: \n      4: - name: generate ssh key for user postgres\n      5:   user: name=postgres generate_ssh_key=yes\n      6:   delegate_to: \"{{ postgres_host }}\"\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ansible-tower-implementation-default_vars_ec2.yml", "content": "- key: \"AnsibleGroup\"", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-tower-implementation-default_vars_ec2.yml\n\nfloating_ip: true\nimage: \"{{ bastion_instance_image | default(__image) }}\"\nflavor:\nec2: \"{{ bastion_instance_type | default(__instance_type) }}\"\ntags:\n64:       - key: \"AnsibleGroup\"\nvalue: \"bastions\"\n- key: \"ostype\"\nvalue: \"linux\"\n- key: \"instance_filter\"\nvalue: \"{{ env_type }}-{{ email }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-tower-implementation-default_vars_ec2.yml\n# Target line: 64\n\n     59:     floating_ip: true\n     60:     image: \"{{ bastion_instance_image | default(__image) }}\"\n     61:     flavor:\n     62:       ec2: \"{{ bastion_instance_type | default(__instance_type) }}\"\n     63:     tags:\n>>>  64:       - key: \"AnsibleGroup\"\n     65:         value: \"bastions\"\n     66:       - key: \"ostype\"\n     67:         value: \"linux\"\n     68:       - key: \"instance_filter\"\n     69:         value: \"{{ env_type }}-{{ email }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloudera_cloudera-playbook-group_vars-db_server.yml", "content": "user: 'scm'", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n\ndatabase_type: mysql\n\ndatabases:\nscm:\nname: 'scm'\n20:     user: 'scm'\npass: 'scm_password'\ntype: '{{ database_type }}'\namon:\nname: 'amon'\nuser: 'amon'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n# Target line: 20\n\n     15: database_type: mysql\n     16: \n     17: databases:\n     18:   scm:\n     19:     name: 'scm'\n>>>  20:     user: 'scm'\n     21:     pass: 'scm_password'\n     22:     type: '{{ database_type }}'\n     23:   amon:\n     24:     name: 'amon'\n     25:     user: 'amon'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ansible_workshops-roles-f5_setup-tasks-main.yml", "content": "key: provision.extramb", "line": 45, "detection_span": [40, 50], "with_context": "# Ansible file: ansible_workshops-roles-f5_setup-tasks-main.yml\n\n- name: install AS3 RPM\ninclude_tasks: install_as3.yml\n\n- name: Set db provision.extramb\nf5networks.f5_modules.bigip_sys_db:\n45:     key: provision.extramb\nvalue: \"1024\"\nprovider: \"{{ provider }}\"\n\n- name: Set db restjavad.useextramb\nf5networks.f5_modules.bigip_sys_db:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ansible_workshops-roles-f5_setup-tasks-main.yml\n# Target line: 45\n\n     40: - name: install AS3 RPM\n     41:   include_tasks: install_as3.yml\n     42: \n     43: - name: Set db provision.extramb\n     44:   f5networks.f5_modules.bigip_sys_db:\n>>>  45:     key: provision.extramb\n     46:     value: \"1024\"\n     47:     provider: \"{{ provider }}\"\n     48: \n     49: - name: Set db restjavad.useextramb\n     50:   f5networks.f5_modules.bigip_sys_db:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml", "content": "- doc_root: '/var/local/firestone-renovations'", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n\nsite_name: \"milberg-staging\"\ndoc_root: \"/var/local/milberg\"\ngit_repo: 'https://github.com/pulibrary/milberg-wp.git'\nversion: 'main'\nsites:\n13:     - doc_root: '/var/local/firestone-renovations'\ngit_repo: 'https://github.com/pulibrary/firestone_renovations_archive.git'\nalias: 'renovations'\nversion: 'main'\n- doc_root: '/var/local/republic'\ngit_repo: 'https://github.com/pulibrary/republic_exhibit_archive.git'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n# Target line: 13\n\n      8:       site_name: \"milberg-staging\"\n      9:       doc_root: \"/var/local/milberg\"\n     10:       git_repo: 'https://github.com/pulibrary/milberg-wp.git'\n     11:       version: 'main'\n     12: sites:\n>>>  13:     - doc_root: '/var/local/firestone-renovations'\n     14:       git_repo: 'https://github.com/pulibrary/firestone_renovations_archive.git'\n     15:       alias: 'renovations'\n     16:       version: 'main'\n     17:     - doc_root: '/var/local/republic'\n     18:       git_repo: 'https://github.com/pulibrary/republic_exhibit_archive.git'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_casl-ansible-roles-openshift-login-tasks-main.yml", "content": "openshift_password: ''", "line": 24, "detection_span": [19, 29], "with_context": "# Ansible file: redhat-cop_casl-ansible-roles-openshift-login-tasks-main.yml\n\nopenshift_user: ''\nwhen: openshift_user is not defined\n\n- name: \"Set variable openshift_password when not set\"\nset_fact:\n24:     openshift_password: ''\nwhen: openshift_password is not defined\n\n- name: \"Set variable openshift_token when not set\"\nset_fact:\nopenshift_token: ''", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_casl-ansible-roles-openshift-login-tasks-main.yml\n# Target line: 24\n\n     19:     openshift_user: ''\n     20:   when: openshift_user is not defined\n     21: \n     22: - name: \"Set variable openshift_password when not set\"\n     23:   set_fact:\n>>>  24:     openshift_password: ''\n     25:   when: openshift_password is not defined\n     26: \n     27: - name: \"Set variable openshift_token when not set\"\n     28:   set_fact:\n     29:     openshift_token: ''\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-user-rhos-dev-ci.yml", "content": "key_name: rhos-jenkins", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-user-rhos-dev-ci.yml\n\n\nprovisioner:\nusername: rhos-dev-ci\npassword: !lookup private.provisioner.qeos7.rhos-dev-ci.password\nkey_file: !join [ !env HOME , /.ssh/rhos-jenkins/id_rsa ]\n7:     key_name: rhos-jenkins", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-user-rhos-dev-ci.yml\n# Target line: 7\n\n      2: \n      3: provisioner:\n      4:     username: rhos-dev-ci\n      5:     password: !lookup private.provisioner.qeos7.rhos-dev-ci.password\n      6:     key_file: !join [ !env HOME , /.ssh/rhos-jenkins/id_rsa ]\n>>>   7:     key_name: rhos-jenkins\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml", "content": "smtp_passwd: changeme", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n\n# smtp\nsmtp_host: \"smtp.sendgrid.net\"\nsmtp_port: 587\nsmtp_authentication: plain\nsmtp_userid: changeme\n26: smtp_passwd: changeme\nsmtp_domain: \"redhat.com\"\n\n# CMS\nuse_rwo_for_cms: false\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n# Target line: 26\n\n     21: # smtp\n     22: smtp_host: \"smtp.sendgrid.net\"\n     23: smtp_port: 587\n     24: smtp_authentication: plain\n     25: smtp_userid: changeme\n>>>  26: smtp_passwd: changeme\n     27: smtp_domain: \"redhat.com\"\n     28: \n     29: # CMS\n     30: use_rwo_for_cms: false\n     31: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_ansible-nfv-roles-post_install-dynamic_host_inventory-vars-main.yml", "content": "private_key_fetch_location: /tmp", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: redhat-openstack_ansible-nfv-roles-post_install-dynamic_host_inventory-vars-main.yml\n\n# Refer to docs/tripleo/post_install/dynamic_host_inventory.md to see the full list of capabilities\ndiscover_instance_external_ip: True # Whether to attempt to discover external IP\n3: private_key_fetch_location: /tmp", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_ansible-nfv-roles-post_install-dynamic_host_inventory-vars-main.yml\n# Target line: 3\n\n      1: # Refer to docs/tripleo/post_install/dynamic_host_inventory.md to see the full list of capabilities\n      2: discover_instance_external_ip: True # Whether to attempt to discover external IP\n>>>   3: private_key_fetch_location: /tmp\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "manage_dashboard_secret: secret", "line": 96, "detection_span": [91, 101], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmonitoring_tests_oidcng_client_secret: secret\nmonitoring_tests_oidcng_resource_server_secret: secret\n\nmanage_internal_api_password: secret\nmanage_backdoor_api_password: secret\n96: manage_dashboard_secret: secret\nmanage_myconext_secret: secret\nmanage_pdp_secret: secret\nmanage_sp_dashboard_secret: secret\n100: manage_sysadmin_secret: secret\n101:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 96\n\n     91: monitoring_tests_oidcng_client_secret: secret\n     92: monitoring_tests_oidcng_resource_server_secret: secret\n     93: \n     94: manage_internal_api_password: secret\n     95: manage_backdoor_api_password: secret\n>>>  96: manage_dashboard_secret: secret\n     97: manage_myconext_secret: secret\n     98: manage_pdp_secret: secret\n     99: manage_sp_dashboard_secret: secret\n    100: manage_sysadmin_secret: secret\n    101: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-roles-abrt-faf-tasks-cron.yml", "content": "user: faf", "line": 30, "detection_span": [25, 35], "with_context": "# Ansible file: tmzullinger_fedora-ansible-roles-abrt-faf-tasks-cron.yml\n\n- \"ruby\"\n\n- name: cron create-problems\ncron:\nname: \"faf create-problems with type {{ item}}\"\n30:     user: faf\njob: \"faf create-problems -p {{ item }} >> /var/log/faf/create-problems.log 2>&1\"\nday: \"15\"\nminute: 30\nhour: \"14\"\nstate: present", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-roles-abrt-faf-tasks-cron.yml\n# Target line: 30\n\n     25:     - \"ruby\"\n     26: \n     27: - name: cron create-problems\n     28:   cron:\n     29:     name: \"faf create-problems with type {{ item}}\"\n>>>  30:     user: faf\n     31:     job: \"faf create-problems -p {{ item }} >> /var/log/faf/create-problems.log 2>&1\"\n     32:     day: \"15\"\n     33:     minute: 30\n     34:     hour: \"14\"\n     35:     state: present\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "hussainaphroj_ansible_examples-language_features-rabbitmq.yml", "content": "rabbitmq_user: user=guest state=absent", "line": 29, "detection_span": [24, 34], "with_context": "# Ansible file: hussainaphroj_ansible_examples-language_features-rabbitmq.yml\n\nwith_items:\n- user1\n- user2\n\n- name: remove default guest user\n29:     rabbitmq_user: user=guest state=absent\n\n- name: ensure vhost /test is present\nrabbitmq_vhost: name=/test state=present\n\n- name: set federation local-username", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: hussainaphroj_ansible_examples-language_features-rabbitmq.yml\n# Target line: 29\n\n     24:     with_items:\n     25:     - user1\n     26:     - user2\n     27: \n     28:   - name: remove default guest user\n>>>  29:     rabbitmq_user: user=guest state=absent\n     30: \n     31:   - name: ensure vhost /test is present\n     32:     rabbitmq_vhost: name=/test state=present\n     33: \n     34:   - name: set federation local-username\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml", "content": "aws_access_key_id: FROM_SECRET", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n\n# -------------------------------------------------------------------\n# AWS specific settings (from secrets usually)\n# -------------------------------------------------------------------\n\n# AWS Credentials\n64: aws_access_key_id: FROM_SECRET\naws_secret_access_key: FROM_SECRET\n\n# HostedZoneId must match subdomain_base_suffix\n#HostedZoneId: FROM_SECRET\nsubdomain_base_suffix: .example.com", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n# Target line: 64\n\n     59: # -------------------------------------------------------------------\n     60: # AWS specific settings (from secrets usually)\n     61: # -------------------------------------------------------------------\n     62: \n     63: # AWS Credentials\n>>>  64: aws_access_key_id: FROM_SECRET\n     65: aws_secret_access_key: FROM_SECRET\n     66: \n     67: # HostedZoneId must match subdomain_base_suffix\n     68: #HostedZoneId: FROM_SECRET\n     69: subdomain_base_suffix: .example.com\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "mongo_admin_password: secret", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmongo_passwords:\nmanage: secret\noidcng: secret\nmyconext: secret\n\n23: mongo_admin_password: secret\n\nengine_api_metadata_push_password: secret\noidcng_api_metadata_push_password: secret\noidcng_api_tokens_profile_password: secret\noidcng_api_tokens_eduid_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 23\n\n     18: mongo_passwords:\n     19:    manage: secret\n     20:    oidcng: secret\n     21:    myconext: secret\n     22: \n>>>  23: mongo_admin_password: secret\n     24: \n     25: engine_api_metadata_push_password: secret\n     26: oidcng_api_metadata_push_password: secret\n     27: oidcng_api_tokens_profile_password: secret\n     28: oidcng_api_tokens_eduid_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml", "content": "- { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }", "line": 77, "detection_span": [72, 82], "with_context": "# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n\n- { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n- { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n- { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n77:     - { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'authgateway/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hgm/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hive', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n- { name: 'cf', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }\n- { name: 'vcap', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n# Target line: 77\n\n     72:     - { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n     73:     - { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n     74:     - { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n     75:     - { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n     76:     - { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n>>>  77:     - { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }\n     78:     - { name: 'authgateway/sys', pass: '', params: '-randkey -requires_preauth' }\n     79:     - { name: 'hgm/sys', pass: '', params: '-randkey -requires_preauth' }\n     80:     - { name: 'hive', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n     81:     - { name: 'cf', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }\n     82:     - { name: 'vcap', pass: '{{ cf_kerberos_password }}', params: '-requires_preauth' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml", "content": "api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n\n# root password of the db - put this in your group_vars and then in a vault in production\ndb_root_password: \"changeme\"\n# API Server db config\n# API Server user name and password - should be kept in group_vars\napi_db_username: \"fgapiserver\"\n15: api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\napi_db_name: fgapiserver\n# where will we store the SQL data ?\nsql_data_dir: /tmp/fgapi-server-db-data/\n# Repos\nrepos:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n# Target line: 15\n\n     10: # root password of the db - put this in your group_vars and then in a vault in production\n     11: db_root_password: \"changeme\"\n     12: # API Server db config\n     13: # API Server user name and password - should be kept in group_vars\n     14: api_db_username: \"fgapiserver\"\n>>>  15: api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\n     16: api_db_name: fgapiserver\n     17: # where will we store the SQL data ?\n     18: sql_data_dir: /tmp/fgapi-server-db-data/\n     19: # Repos\n     20: repos:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml", "content": "lab_user:                     devops                        # Ansible Service Account", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n\n\ncloud_provider:               osp\n\nkey_name:                     ocpkey\nstudent_name:                 student                       # Default ssh account\n19: lab_user:                     devops                        # Ansible Service Account\n\nstudent_password: r3dh4t1!\ndevops_password_tower: r3dh4t1!\n\n###### VARIABLES YOU SHOULD CONFIGURE FOR YOUR DEPLOYEMNT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ansible-platform-foundations-default_vars.yml\n# Target line: 19\n\n     14: \n     15: cloud_provider:               osp\n     16: \n     17: key_name:                     ocpkey\n     18: student_name:                 student                       # Default ssh account\n>>>  19: lab_user:                     devops                        # Ansible Service Account\n     20: \n     21: student_password: r3dh4t1!\n     22: devops_password_tower: r3dh4t1!\n     23: \n     24: ###### VARIABLES YOU SHOULD CONFIGURE FOR YOUR DEPLOYEMNT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "os-cloud_openstack-ansible-lxc_hosts-tasks-main.yml", "content": "path: /root/.ssh/id_rsa.pub", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: os-cloud_openstack-ansible-lxc_hosts-tasks-main.yml\n\n# limitations under the License.\n\n- name: Check for the presence of a public key file on the deployment host\nlocal_action:\nmodule: stat\n19:     path: /root/.ssh/id_rsa.pub\nregister: _ssh_key\nwhen: lxc_container_ssh_key is undefined\ntags:\n- always\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: os-cloud_openstack-ansible-lxc_hosts-tasks-main.yml\n# Target line: 19\n\n     14: # limitations under the License.\n     15: \n     16: - name: Check for the presence of a public key file on the deployment host\n     17:   local_action:\n     18:     module: stat\n>>>  19:     path: /root/.ssh/id_rsa.pub\n     20:   register: _ssh_key\n     21:   when: lxc_container_ssh_key is undefined\n     22:   tags:\n     23:     - always\n     24: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-taxon-overflow-tasks-main.yml", "content": "become_user: postgres", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-taxon-overflow-tasks-main.yml\n\ntags:\n- taxonoverflow\n\n- name: create DB\npostgresql_db: name={{taxonoverflow_db_name | default('taxonoverflow') }} state=present\n7:   become_user: postgres\nbecome: yes\ntags:\n- db\n- taxonoverflow\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-taxon-overflow-tasks-main.yml\n# Target line: 7\n\n      2:   tags:\n      3:     - taxonoverflow\n      4: \n      5: - name: create DB\n      6:   postgresql_db: name={{taxonoverflow_db_name | default('taxonoverflow') }} state=present\n>>>   7:   become_user: postgres\n      8:   become: yes\n      9:   tags:\n     10:     - db\n     11:     - taxonoverflow\n     12: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-eu_infrastructure-playbook-galaxy-test.yml", "content": "galaxy_create_user: true", "line": 112, "detection_span": [107, 117], "with_context": "# Ansible file: usegalaxy-eu_infrastructure-playbook-galaxy-test.yml\n\n- usegalaxy-eu.google-verification\n- usegalaxy-eu.nginx\n# The REAL galaxy role\n- role: galaxyproject.galaxy\nvars:\n112:         galaxy_create_user: true\ngalaxy_manage_clone: true\ngalaxy_manage_static_setup: true\ngalaxy_manage_mutable_setup: true\ngalaxy_manage_database: true\ngalaxy_fetch_dependencies: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-eu_infrastructure-playbook-galaxy-test.yml\n# Target line: 112\n\n    107:     - usegalaxy-eu.google-verification\n    108:     - usegalaxy-eu.nginx\n    109:     # The REAL galaxy role\n    110:     - role: galaxyproject.galaxy\n    111:       vars:\n>>> 112:         galaxy_create_user: true\n    113:         galaxy_manage_clone: true\n    114:         galaxy_manage_static_setup: true\n    115:         galaxy_manage_mutable_setup: true\n    116:         galaxy_manage_database: true\n    117:         galaxy_fetch_dependencies: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "IBM_z_ansible_collections_samples-zos_subsystems-db2-db2_schema_provisioning-roles-db2_delete_app_instance-defaults-main.yml", "content": "password: valid_password", "line": 18, "detection_span": [13, 23], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-db2-db2_schema_provisioning-roles-db2_delete_app_instance-defaults-main.yml\n\n\n# Username used to access the DOE REST API\nusername: valid_username\n\n# Password used to access the DOE REST API\n18: password: valid_password", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-db2-db2_schema_provisioning-roles-db2_delete_app_instance-defaults-main.yml\n# Target line: 18\n\n     13: \n     14: # Username used to access the DOE REST API\n     15: username: valid_username\n     16: \n     17: # Password used to access the DOE REST API\n>>>  18: password: valid_password\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "epiphany-platform_epiphany-schema-common-defaults-configuration-kafka.yml", "content": "cert_validity: 365", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: epiphany-platform_epiphany-schema-common-defaults-configuration-kafka.yml\n\nport: 9093\nserver:\nlocal_cert_download_path: kafka-certs\nkeystore_location: /var/private/ssl/kafka.server.keystore.jks\ntruststore_location: /var/private/ssl/kafka.server.truststore.jks\n17:         cert_validity: 365\npasswords:\nkeystore: PasswordToChange\ntruststore: PasswordToChange\nkey: PasswordToChange\nendpoint_identification_algorithm: HTTPS", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: epiphany-platform_epiphany-schema-common-defaults-configuration-kafka.yml\n# Target line: 17\n\n     12:       port: 9093\n     13:       server:\n     14:         local_cert_download_path: kafka-certs\n     15:         keystore_location: /var/private/ssl/kafka.server.keystore.jks\n     16:         truststore_location: /var/private/ssl/kafka.server.truststore.jks\n>>>  17:         cert_validity: 365\n     18:         passwords:\n     19:           keystore: PasswordToChange\n     20:           truststore: PasswordToChange\n     21:           key: PasswordToChange\n     22:       endpoint_identification_algorithm: HTTPS\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_cephadm-defaults-main.yml", "content": "tripleo_cephadm_registry_username: ''", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_cephadm-defaults-main.yml\n\ntripleo_cephadm_container_image: \"ceph\"\ntripleo_cephadm_container_tag: \"v16\"\ntripleo_cephadm_container_cli: \"podman\"\ntripleo_cephadm_container_options: \"--net=host --ipc=host\"\ntripleo_cephadm_registry_password: ''\n15: tripleo_cephadm_registry_username: ''\ntripleo_cephadm_registry_url: ''\ntripleo_cephadm_keyring_prefix: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.client\"\ntripleo_cephadm_admin_keyring: \"{{ tripleo_cephadm_keyring_prefix }}.admin.keyring\"\ntripleo_cephadm_conf: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.conf\"\ntripleo_cephadm_assimilate_conf: \"/home/{{ tripleo_cephadm_ssh_user }}/assimilate_{{ tripleo_cephadm_cluster }}.conf\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_cephadm-defaults-main.yml\n# Target line: 15\n\n     10: tripleo_cephadm_container_image: \"ceph\"\n     11: tripleo_cephadm_container_tag: \"v16\"\n     12: tripleo_cephadm_container_cli: \"podman\"\n     13: tripleo_cephadm_container_options: \"--net=host --ipc=host\"\n     14: tripleo_cephadm_registry_password: ''\n>>>  15: tripleo_cephadm_registry_username: ''\n     16: tripleo_cephadm_registry_url: ''\n     17: tripleo_cephadm_keyring_prefix: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.client\"\n     18: tripleo_cephadm_admin_keyring: \"{{ tripleo_cephadm_keyring_prefix }}.admin.keyring\"\n     19: tripleo_cephadm_conf: \"{{ tripleo_cephadm_config_home }}/{{ tripleo_cephadm_cluster }}.conf\"\n     20: tripleo_cephadm_assimilate_conf: \"/home/{{ tripleo_cephadm_ssh_user }}/assimilate_{{ tripleo_cephadm_cluster }}.conf\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-tenant-common-image.yml", "content": "remote_user: cloud-user", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-tenant-common-image.yml\n\nremote_user: fedora\nrhel:\n'6.6':\nid: faae17d6-371f-4911-a8ea-ed04578b49d1\nname: rhel-guest-image-6.6-20150127.0\n25:                 remote_user: cloud-user\n'6.7':\nid: 183d828c-8801-444f-b834-feebd9f6510f\nname: rhel-guest-image-6.7-20150702.0\nremote_user: cloud-user\n'6.8':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-settings-provisioner-openstack-site-qeos7-tenant-common-image.yml\n# Target line: 25\n\n     20:                 remote_user: fedora\n     21:         rhel:\n     22:             '6.6':\n     23:                 id: faae17d6-371f-4911-a8ea-ed04578b49d1\n     24:                 name: rhel-guest-image-6.6-20150127.0\n>>>  25:                 remote_user: cloud-user\n     26:             '6.7':\n     27:                 id: 183d828c-8801-444f-b834-feebd9f6510f\n     28:                 name: rhel-guest-image-6.7-20150702.0\n     29:                 remote_user: cloud-user\n     30:             '6.8':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.fits-defaults-main.yml", "content": "fits_install_root: /opt", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.fits-defaults-main.yml\n\n---\nfits_download_dir: /usr/local/src\nfits_version: 1.4.1\nfits_ws_version: 1.2.0\n5: fits_install_root: /opt\nfits_install_symlink: /opt/fits\nfits_user: tomcat\nfits_group: tomcat\nfits_ws: yes\ncrayfits_home: /var/www/html", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.fits-defaults-main.yml\n# Target line: 5\n\n      1: ---\n      2: fits_download_dir: /usr/local/src\n      3: fits_version: 1.4.1\n      4: fits_ws_version: 1.2.0\n>>>   5: fits_install_root: /opt\n      6: fits_install_symlink: /opt/fits\n      7: fits_user: tomcat\n      8: fits_group: tomcat\n      9: fits_ws: yes\n     10: crayfits_home: /var/www/html\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-sample_vars_ec2.yml", "content": "consumer_key:  \"cuBfSo9NhB338aSwvRC5VKgZt5Sqhez5\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-sample_vars_ec2.yml\n\n\nsatellite_public_fqdn: satellite1.cap01.example.opentlc.com\ncapsule_activationkey: capsule_key\ncapsule_org: gpte\n\n20: consumer_key:  \"cuBfSo9NhB338aSwvRC5VKgZt5Sqhez5\"\nconsumer_secret: \"mpYncnDHkRq9XrHDoereQ3Hwejyyed6c\"\n\ncapsule_cert_path:  /tmp/capsule-cert.tar", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-sample_vars_ec2.yml\n# Target line: 20\n\n     15: \n     16: satellite_public_fqdn: satellite1.cap01.example.opentlc.com\n     17: capsule_activationkey: capsule_key\n     18: capsule_org: gpte\n     19: \n>>>  20: consumer_key:  \"cuBfSo9NhB338aSwvRC5VKgZt5Sqhez5\"\n     21: consumer_secret: \"mpYncnDHkRq9XrHDoereQ3Hwejyyed6c\"\n     22: \n     23: capsule_cert_path:  /tmp/capsule-cert.tar \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "georgegoh_openshift-ansible-playbooks-common-openshift-cluster-redeploy-certificates-etcd.yml", "content": "etcd_cert_prefix: \"master.etcd-\"", "line": 63, "detection_span": [58, 68], "with_context": "# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-redeploy-certificates-etcd.yml\n\n- role: openshift_etcd_client_certificates\netcd_certificates_redeploy: true\netcd_ca_host: \"{{ groups.oo_etcd_to_config.0 }}\"\netcd_cert_subdir: \"openshift-master-{{ openshift.common.hostname }}\"\netcd_cert_config_dir: \"{{ openshift.common.config_base }}/master\"\n63:       etcd_cert_prefix: \"master.etcd-\"\nopenshift_ca_host: \"{{ groups.oo_first_master.0 }}\"\nopenshift_master_count: \"{{ openshift.master.master_count | default(groups.oo_masters | length) }}\"\nwhen: groups.oo_etcd_to_config is defined and groups.oo_etcd_to_config", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-redeploy-certificates-etcd.yml\n# Target line: 63\n\n     58:     - role: openshift_etcd_client_certificates\n     59:       etcd_certificates_redeploy: true\n     60:       etcd_ca_host: \"{{ groups.oo_etcd_to_config.0 }}\"\n     61:       etcd_cert_subdir: \"openshift-master-{{ openshift.common.hostname }}\"\n     62:       etcd_cert_config_dir: \"{{ openshift.common.config_base }}/master\"\n>>>  63:       etcd_cert_prefix: \"master.etcd-\"\n     64:       openshift_ca_host: \"{{ groups.oo_first_master.0 }}\"\n     65:       openshift_master_count: \"{{ openshift.master.master_count | default(groups.oo_masters | length) }}\"\n     66:       when: groups.oo_etcd_to_config is defined and groups.oo_etcd_to_config\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_kolla-ansible-roles-cephadm-defaults-main.yml", "content": "cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n- shortname: \"ceph-noarch\"\nname: \"Ceph noarch repository\"\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n\n13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n\ncephadm_ceph_osd_devices:\n- primary:/dev/cephvg/cephlv\n- secondary1:/dev/cephvg/cephlv\n- secondary2:/dev/cephvg/cephlv", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n# Target line: 13\n\n      8:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n      9:   - shortname: \"ceph-noarch\"\n     10:     name: \"Ceph noarch repository\"\n     11:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n     12: \n>>>  13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n     14: \n     15: cephadm_ceph_osd_devices:\n     16:   - primary:/dev/cephvg/cephlv\n     17:   - secondary1:/dev/cephvg/cephlv\n     18:   - secondary2:/dev/cephvg/cephlv\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml", "content": "REGISTRY_HTTP_TLS_CERTIFICATE: /etc/secrets/registry.crt", "line": 98, "detection_span": [93, 103], "with_context": "# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n\n- name: registry-certificates\npath: /etc/secrets\ntype: secret\nsecret_name: registry-certificates\nregistry_secure_env_vars:\n98:       REGISTRY_HTTP_TLS_CERTIFICATE: /etc/secrets/registry.crt\nREGISTRY_HTTP_TLS_KEY: /etc/secrets/registry.key\nregistry_secure_edits:\n- key: spec.template.spec.containers[0].livenessProbe.httpGet.scheme\nvalue: HTTPS\naction: put", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n# Target line: 98\n\n     93:     - name: registry-certificates\n     94:       path: /etc/secrets\n     95:       type: secret\n     96:       secret_name: registry-certificates\n     97:     registry_secure_env_vars:\n>>>  98:       REGISTRY_HTTP_TLS_CERTIFICATE: /etc/secrets/registry.crt\n     99:       REGISTRY_HTTP_TLS_KEY: /etc/secrets/registry.key\n    100:     registry_secure_edits:\n    101:     - key: spec.template.spec.containers[0].livenessProbe.httpGet.scheme\n    102:       value: HTTPS\n    103:       action: put\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "geerlingguy_drupal-vm-provisioning-roles-geerlingguy.apache-vars-Debian.yml", "content": "apache_server_root: /etc/apache2", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.apache-vars-Debian.yml\n\n---\napache_service: apache2\napache_daemon: apache2\napache_daemon_path: /usr/sbin/\n5: apache_server_root: /etc/apache2\napache_conf_path: /etc/apache2\n\n__apache_packages:\n- apache2\n- apache2-utils", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.apache-vars-Debian.yml\n# Target line: 5\n\n      1: ---\n      2: apache_service: apache2\n      3: apache_daemon: apache2\n      4: apache_daemon_path: /usr/sbin/\n>>>   5: apache_server_root: /etc/apache2\n      6: apache_conf_path: /etc/apache2\n      7: \n      8: __apache_packages:\n      9:   - apache2\n     10:   - apache2-utils\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ceph_ceph-ansible-roles-ceph-mds-tasks-non_containerized.yml", "content": "import_key: false", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: ceph_ceph-ansible-roles-ceph-mds-tasks-non_containerized.yml\n\ncaps:\nmon: \"allow profile mds\"\nmds: \"allow\"\nosd: \"allow rwx\"\ndest: \"/var/lib/ceph/mds/{{ cluster }}-{{ ansible_facts['hostname'] }}/keyring\"\n34:     import_key: false\nowner: ceph\ngroup: ceph\nmode: \"{{ ceph_keyring_permissions }}\"\nno_log: \"{{ no_log_on_ceph_key_tasks }}\"\nwhen: cephx | bool", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ceph_ceph-ansible-roles-ceph-mds-tasks-non_containerized.yml\n# Target line: 34\n\n     29:     caps:\n     30:       mon: \"allow profile mds\"\n     31:       mds: \"allow\"\n     32:       osd: \"allow rwx\"\n     33:     dest: \"/var/lib/ceph/mds/{{ cluster }}-{{ ansible_facts['hostname'] }}/keyring\"\n>>>  34:     import_key: false\n     35:     owner: ceph\n     36:     group: ceph\n     37:     mode: \"{{ ceph_keyring_permissions }}\"\n     38:   no_log: \"{{ no_log_on_ceph_key_tasks }}\"\n     39:   when: cephx | bool\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-rabbitservers.yml", "content": "nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-nginx.pem", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-rabbitservers.yml\n\nnginx_remove_default_vhost: true\n\n# NGINX Letsencrypt bindings\nnginx_ssl_role: usegalaxy_eu.certbot\nnginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n36: nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-nginx.pem\n\n#telegraf extra stuff\n#telegraf_plugins_extra:\n#    rabbitmq:\n#    plugin: rabbitmq", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-rabbitservers.yml\n# Target line: 36\n\n     31: nginx_remove_default_vhost: true\n     32: \n     33: # NGINX Letsencrypt bindings\n     34: nginx_ssl_role: usegalaxy_eu.certbot\n     35: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n>>>  36: nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-nginx.pem\n     37: \n     38: #telegraf extra stuff\n     39: #telegraf_plugins_extra:\n     40: #    rabbitmq:\n     41: #    plugin: rabbitmq\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloudera_cloudera-playbook-group_vars-db_server.yml", "content": "user: 'oozie'", "line": 60, "detection_span": [55, 65], "with_context": "# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n\nuser: 'hue'\npass: 'hue_password'\ntype: '{{ database_type }}'\noozie:\nname: 'oozie'\n60:     user: 'oozie'\npass: 'oozie_password'\ntype: '{{ database_type }}'\ndas:\nname: 'das'\nuser: 'das'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n# Target line: 60\n\n     55:     user: 'hue'\n     56:     pass: 'hue_password'\n     57:     type: '{{ database_type }}'\n     58:   oozie:\n     59:     name: 'oozie'\n>>>  60:     user: 'oozie'\n     61:     pass: 'oozie_password'\n     62:     type: '{{ database_type }}'\n     63:   das:\n     64:     name: 'das'\n     65:     user: 'das'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-validations-roles-tls_everywhere-tasks-overcloud-post-deployment.yaml", "content": "cert_status_recommendations:", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: openstack_tripleo-validations-roles-tls_everywhere-tasks-overcloud-post-deployment.yaml\n\n\n- name: Set facts for certificates in failed status\nset_fact:\ncert_status_status: \"{{ helper_status_error }}\"\ncert_status_reason: 'The following certificates are not in a healthy status: {{ failed_certs | join(\", \") }}'\n34:     cert_status_recommendations:\n- \"Log into this host and do 'getcert list -i <cert name>' to verify the failure reason\"\n- \"Verify that the service principal of the certificate is present in IdM/FreeIPA for this host\"\nwhen: failed_certs\n\n- name: Set facts for all certificates in monitoring status", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-validations-roles-tls_everywhere-tasks-overcloud-post-deployment.yaml\n# Target line: 34\n\n     29: \n     30: - name: Set facts for certificates in failed status\n     31:   set_fact:\n     32:     cert_status_status: \"{{ helper_status_error }}\"\n     33:     cert_status_reason: 'The following certificates are not in a healthy status: {{ failed_certs | join(\", \") }}'\n>>>  34:     cert_status_recommendations:\n     35:       - \"Log into this host and do 'getcert list -i <cert name>' to verify the failure reason\"\n     36:       - \"Verify that the service principal of the certificate is present in IdM/FreeIPA for this host\"\n     37:   when: failed_certs\n     38: \n     39: - name: Set facts for all certificates in monitoring status\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "opensrp_playbooks-reveal-web.yml", "content": "become_user: \"root\"", "line": 79, "detection_span": [74, 84], "with_context": "# Ansible file: opensrp_playbooks-reveal-web.yml\n\n- express\n\n- name: \"Setup nginx\"\nrole: nginx\nbecome: true\n79:       become_user: \"root\"\nvars:\nnginx_sites: \"{{ reveal_nginx_sites }}\"\nnginx_ssl_dir: \"{{ reveal_nginx_ssl_dir }}\"\nnginx_access_logs: \"{{ reveal_nginx_access_logs }}\"\nnginx_install_method: \"package\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: opensrp_playbooks-reveal-web.yml\n# Target line: 79\n\n     74:         - express\n     75: \n     76:     - name: \"Setup nginx\"\n     77:       role: nginx\n     78:       become: true\n>>>  79:       become_user: \"root\"\n     80:       vars:\n     81:         nginx_sites: \"{{ reveal_nginx_sites }}\"\n     82:         nginx_ssl_dir: \"{{ reveal_nginx_ssl_dir }}\"\n     83:         nginx_access_logs: \"{{ reveal_nginx_access_logs }}\"\n     84:         nginx_install_method: \"package\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml", "content": "key: fedmsg-librariesio2fedmsg.key", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n\nappowners:\n- jcline\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-key\n20:     key: fedmsg-librariesio2fedmsg.key\nprivatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\nwhen: env != \"staging\"\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-crt", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n# Target line: 20\n\n     15:     appowners:\n     16:     - jcline\n     17:   - role: openshift/secret-file\n     18:     app: librariesio2fedmsg\n     19:     secret_name: librariesio2fedmsg-fedmsg-key\n>>>  20:     key: fedmsg-librariesio2fedmsg.key\n     21:     privatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\n     22:     when: env != \"staging\"\n     23:   - role: openshift/secret-file\n     24:     app: librariesio2fedmsg\n     25:     secret_name: librariesio2fedmsg-fedmsg-crt\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "roots_trellis-roles-common-tasks-main.yml", "content": "generate_ssh_key: yes", "line": 172, "detection_span": [167, 177], "with_context": "# Ansible file: roots_trellis-roles-common-tasks-main.yml\n\nstate: present\n168:\n169: - name: Generate SSH key for vagrant user\n170:   user:\nname: vagrant\n172:     generate_ssh_key: yes\n173:   when: env == 'development'\n174:\n175: - block:\n- name: Retrieve SSH client IP\nipify_facts:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: roots_trellis-roles-common-tasks-main.yml\n# Target line: 172\n\n    167:     state: present\n    168: \n    169: - name: Generate SSH key for vagrant user\n    170:   user:\n    171:     name: vagrant\n>>> 172:     generate_ssh_key: yes\n    173:   when: env == 'development'\n    174: \n    175: - block:\n    176:     - name: Retrieve SSH client IP\n    177:       ipify_facts:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "vijaykakkar_ansible-automation-provisioner-roles-manage_ec2_instances-defaults-main.yml", "content": "username: ec2-user", "line": 135, "detection_span": [130, 140], "with_context": "# Ansible file: vijaykakkar_ansible-automation-provisioner-roles-manage_ec2_instances-defaults-main.yml\n\nsize: t2.xlarge\nusername: ec2-user\n132:   skylight_rhel7_docs:\nfilter: 'RHEL-7.6_HVM_GA*x86_64*'\nsize: t2.xlarge\n135:     username: ec2-user\n136:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: vijaykakkar_ansible-automation-provisioner-roles-manage_ec2_instances-defaults-main.yml\n# Target line: 135\n\n    130:     size: t2.xlarge\n    131:     username: ec2-user\n    132:   skylight_rhel7_docs:\n    133:     filter: 'RHEL-7.6_HVM_GA*x86_64*'\n    134:     size: t2.xlarge\n>>> 135:     username: ec2-user\n    136: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_infrared-plugins-tripleo-overcloud-tasks-add_overcloud_host.yml", "content": "ansible_ssh_pass: \"\"", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-tripleo-overcloud-tasks-add_overcloud_host.yml\n\nadd_host:\nname: \"{{ node_info.name|lower }}\"\n# only add groups for new nodes. don't touch existing nodes' groups\ngroups: \"{{ node_groups }}\"\nansible_user: \"{{ user }}\"\n46:       ansible_ssh_pass: \"\"\nansible_host: \"{{ node_info.addresses.ctlplane[0].addr }}\"\nansible_ssh_private_key_file: \"{{ overcloud_pkey }}\"\n\n- name: add original name\nadd_host:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-tripleo-overcloud-tasks-add_overcloud_host.yml\n# Target line: 46\n\n     41:   add_host:\n     42:       name: \"{{ node_info.name|lower }}\"\n     43:       # only add groups for new nodes. don't touch existing nodes' groups\n     44:       groups: \"{{ node_groups }}\"\n     45:       ansible_user: \"{{ user }}\"\n>>>  46:       ansible_ssh_pass: \"\"\n     47:       ansible_host: \"{{ node_info.addresses.ctlplane[0].addr }}\"\n     48:       ansible_ssh_private_key_file: \"{{ overcloud_pkey }}\"\n     49: \n     50: - name: add original name\n     51:   add_host:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "keystone_auth_admin_password: secrete", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nheat_profiler_hmac_key: 4d34d11770c7e19f0259b044\nheat_service_password: 80091d299c632b6ba5a3b5\nheat_stack_domain_admin_password: 144b8c18f1963eca53e3c1571a603eed314db987a2155d\nhorizon_container_mysql_password: 063fbd22d770f4b14965b7b263be95b3963\nhorizon_secret_key: 50b00fa40b7b3e6d0547f369a0e59fa1\n23: keystone_auth_admin_password: secrete\nkeystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\nkeystone_container_mysql_password: a94e95b30824305cda80caba7cac67\nkeystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\nmemcached_encryption_key: 78a191237b291b66e23a49c3\nneutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 23\n\n     18: heat_profiler_hmac_key: 4d34d11770c7e19f0259b044\n     19: heat_service_password: 80091d299c632b6ba5a3b5\n     20: heat_stack_domain_admin_password: 144b8c18f1963eca53e3c1571a603eed314db987a2155d\n     21: horizon_container_mysql_password: 063fbd22d770f4b14965b7b263be95b3963\n     22: horizon_secret_key: 50b00fa40b7b3e6d0547f369a0e59fa1\n>>>  23: keystone_auth_admin_password: secrete\n     24: keystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\n     25: keystone_container_mysql_password: a94e95b30824305cda80caba7cac67\n     26: keystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\n     27: memcached_encryption_key: 78a191237b291b66e23a49c3\n     28: neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Grindizer_ansible-example-openshift-language_features-intermediate_example.yml", "content": "user: mdehaan", "line": 70, "detection_span": [65, 75], "with_context": "# Ansible file: Grindizer_ansible-example-openshift-language_features-intermediate_example.yml\n\n\n# any play in a playbook can be executed by a user other than root\n# if you want.  sudo support is coming too.\n\n- hosts: webservers\n70:   user: mdehaan\n\n# vars must be specified again for the next play in the playbook\n# but can be reused by including from vars_files if you want\n# you can use vars, vars_files, or both.  vars_files overrides\n# those set in vars.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Grindizer_ansible-example-openshift-language_features-intermediate_example.yml\n# Target line: 70\n\n     65: \n     66: # any play in a playbook can be executed by a user other than root\n     67: # if you want.  sudo support is coming too.\n     68: \n     69: - hosts: webservers\n>>>  70:   user: mdehaan\n     71: \n     72:   # vars must be specified again for the next play in the playbook\n     73:   # but can be reused by including from vars_files if you want\n     74:   # you can use vars, vars_files, or both.  vars_files overrides\n     75:   # those set in vars.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-training-files-2Users-SSH.yml", "content": "set_env_authorized_key: true", "line": 33, "detection_span": [28, 38], "with_context": "# Ansible file: redhat-cop_agnosticd-training-files-2Users-SSH.yml\n\nstudent_name: \"{{ guid }}-user\"          # This will be used to create a student login ID\nstudent_password: \"r3dh4t1!\"             # Customize the student password here. Keep in mind these systems may be public facing.\n\n# Environment Variables for SSH key generation and assignment\n# # set_env_authorized_key role\n33: set_env_authorized_key: true\nenv_authorized_key: \"{{guid}}key\"\n\n# bastion-lite role\ninstall_bastion_lite: true\n# Allow the use of an admin backdoor key for this machine", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-training-files-2Users-SSH.yml\n# Target line: 33\n\n     28: student_name: \"{{ guid }}-user\"          # This will be used to create a student login ID\n     29: student_password: \"r3dh4t1!\"             # Customize the student password here. Keep in mind these systems may be public facing.\n     30: \n     31: # Environment Variables for SSH key generation and assignment\n     32: # # set_env_authorized_key role\n>>>  33: set_env_authorized_key: true\n     34: env_authorized_key: \"{{guid}}key\"\n     35: \n     36: # bastion-lite role\n     37: install_bastion_lite: true\n     38: # Allow the use of an admin backdoor key for this machine\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\nnova_service_password: 054e7b1078a9f2cd\nnova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\nnova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\nrabbitmq_password: b763ef86fce7338e145c9c8c\nswift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\nswift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\nswift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41\nswift_hash_path_suffix: 27ac2b51358886b471e81cde", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 37\n\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n     34: nova_service_password: 054e7b1078a9f2cd\n     35: nova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n     36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n>>>  37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\n     38: rabbitmq_password: b763ef86fce7338e145c9c8c\n     39: swift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\n     40: swift_dispersion_password: 58133ef4353374ea550199797216bb1c8009ab40f06abea2\n     41: swift_hash_path_prefix: 5e51146f201f955ec9a537e1f85bef41\n     42: swift_hash_path_suffix: 27ac2b51358886b471e81cde\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_lpe_3scale-defaults-main.yml", "content": "ocp4_workload_lpe_3scale_smtp_userid: <changeme>", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_lpe_3scale-defaults-main.yml\n\n# smtp\nocp4_workload_lpe_3scale_smtp_host: <changeme>\nocp4_workload_lpe_3scale_smtp_port: 587\nocp4_workload_lpe_3scale_smtp_authentication: plain\nocp4_workload_lpe_3scale_smtp_domain: <changeme>\n37: ocp4_workload_lpe_3scale_smtp_userid: <changeme>\nocp4_workload_lpe_3scale_smtp_passwd: <changeme>\nocp4_workload_lpe_3scale_admin_email_user: \"3scaleadmin\"    # i.e. string before @ in your email address\nocp4_workload_lpe_3scale_admin_email_domain: \"redhat.com\"\n\nocp4_workload_lpe_3scale_apicast_services:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_lpe_3scale-defaults-main.yml\n# Target line: 37\n\n     32: # smtp\n     33: ocp4_workload_lpe_3scale_smtp_host: <changeme>\n     34: ocp4_workload_lpe_3scale_smtp_port: 587\n     35: ocp4_workload_lpe_3scale_smtp_authentication: plain\n     36: ocp4_workload_lpe_3scale_smtp_domain: <changeme>\n>>>  37: ocp4_workload_lpe_3scale_smtp_userid: <changeme>\n     38: ocp4_workload_lpe_3scale_smtp_passwd: <changeme>\n     39: ocp4_workload_lpe_3scale_admin_email_user: \"3scaleadmin\"    # i.e. string before @ in your email address\n     40: ocp4_workload_lpe_3scale_admin_email_domain: \"redhat.com\"\n     41: \n     42: ocp4_workload_lpe_3scale_apicast_services:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml", "content": "heat_rabbitmq_telemetry_userid: heat", "line": 87, "detection_span": [82, 92], "with_context": "# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n\nnova_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\nnova_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\nnova_rabbitmq_telemetry_vhost: \"/nova\"\n\nheat_rabbitmq_telemetry_host_group: \"{{ rabbitmq_host_group }}\"\n87: heat_rabbitmq_telemetry_userid: heat\nheat_rabbitmq_telemetry_password: \"{{ heat_rabbitmq_password }}\"\nheat_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\nheat_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\nheat_rabbitmq_telemetry_vhost: \"/heat\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n# Target line: 87\n\n     82: nova_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\n     83: nova_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n     84: nova_rabbitmq_telemetry_vhost: \"/nova\"\n     85: \n     86: heat_rabbitmq_telemetry_host_group: \"{{ rabbitmq_host_group }}\"\n>>>  87: heat_rabbitmq_telemetry_userid: heat\n     88: heat_rabbitmq_telemetry_password: \"{{ heat_rabbitmq_password }}\"\n     89: heat_rabbitmq_telemetry_port: \"{{ rabbitmq_port }}\"\n     90: heat_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n     91: heat_rabbitmq_telemetry_vhost: \"/heat\"\n     92: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-docker-build-ecommerce-ecommerce.yml", "content": "transaction_key: SET-ME-PLEASE", "line": 105, "detection_span": [100, 110], "with_context": "# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n\nsoap_api_url: https://ics2wstest.ic3.com/commerce/1.x/transactionProcessor/CyberSourceTransaction_1.140.wsdl\nsop_access_key: SET-ME-PLEASE\nsop_payment_page_url: https://testsecureacceptance.cybersource.com/silent/pay\nsop_profile_id: SET-ME-PLEASE\nsop_secret_key: SET-ME-PLEASE\n105:             transaction_key: SET-ME-PLEASE\npaypal:\ncancel_url: /checkout/cancel-checkout/\nclient_id: SET-ME-PLEASE\nclient_secret: SET-ME-PLEASE\nerror_url: /checkout/error/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n# Target line: 105\n\n    100:             soap_api_url: https://ics2wstest.ic3.com/commerce/1.x/transactionProcessor/CyberSourceTransaction_1.140.wsdl\n    101:             sop_access_key: SET-ME-PLEASE\n    102:             sop_payment_page_url: https://testsecureacceptance.cybersource.com/silent/pay\n    103:             sop_profile_id: SET-ME-PLEASE\n    104:             sop_secret_key: SET-ME-PLEASE\n>>> 105:             transaction_key: SET-ME-PLEASE\n    106:         paypal:\n    107:             cancel_url: /checkout/cancel-checkout/\n    108:             client_id: SET-ME-PLEASE\n    109:             client_secret: SET-ME-PLEASE\n    110:             error_url: /checkout/error/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "monitoring_oidc_client_secret: secret", "line": 90, "detection_span": [85, 95], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmujina_idp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\nmujina_sp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\n\nmonitoring_tests_person_id: urn:collab:person:schachome:uuid\nmonitoring_tests_password: secret\n90: monitoring_oidc_client_secret: secret\nmonitoring_tests_oidcng_client_secret: secret\nmonitoring_tests_oidcng_resource_server_secret: secret\n\nmanage_internal_api_password: secret\nmanage_backdoor_api_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 90\n\n     85: mujina_idp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\n     86: mujina_sp_private_key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDQRsCf6qU0DYkoFIJUhNlMxJFKMPsEvK+u3rcaBIZcyWX4Cv5OU3xtcCAg6mqRwMRFYFDNdGgR0XLTaHAOcJpR7cXYnYc0Wa6Kh8KSstgZrCl+WdqCtuUS6bMrrAdSq6HpoAPwo1JyOqyC9ccRZ9ysjhYdWQS1ELSjUHjEuxxRoEgwKfrF7kxbo89dixQ7oF9E9CgeWtftJfMtDxGtMhmtaIurHjjcfOPWR8TND0b1Lp1pLkzPn6GdI2aRWqV3tNsljKoXP9omDInhP9xrzoLiXISbekfnLrfFQW+rmylCBiu6ZqKv0weg1V6b7B6rAyV3nIcXInLuKXSlQx0nnPOdAgMBAAECggEAOrAlKSqyYIeL5XpZ+zzwCly9X/2LThtpGcpyJ+esgMrTa+CVJjcKMcBNnVjQrL93zuDEBBDQHm05gO7F3JvIMFviyxYgehTnROvaXQH+OMW1b4AcPYcR55Foxl6UNaxdVHqdgZpT6hI0eDaPYI02tnzXKG/kDq1laTuMvErJQQp6Cd611yyAhBvpX1ibpAYvex10sfTkj0GRKmOrGqwVXibN29szaRei7Xeg/RStdVBgrYJoR5/4++dkGapa27oRdOh4VJUChRfXuJtH6pyxC7uay1fMRcmo2u6NcWAT6qMOvxLcuesnNFrbSlPoZaxWNiZRX/SVqeieyRAA0WS7IQKBgQDoywh4DkdL+SPrkA/sB0rOQF3kJjlzWibk9OM17In1P+obQk37kSRYKfBvsk48VWdG1fN33Up05Pxe+f36F//AZ8mp7uTmBtd6CAoR/005WxwkCSihF6LaDiB3VtxlpcfRA/TUZ10PMud43w0AeG30AG0KpCokfIiY87OpyTjJWQKBgQDlCgsgZ9rL3Wm7FbEDZ4f2uTB5rlT0Vz80paV0OOJdUQECrZW1PjemQpqIJocr8yoNupkrZKPSi4mbNoMFF1wXIydOjLq6iQ6KWIKRdsvmeXL++tWg6TiD8nDpBxuKzjRhwMcQN2lakb/SusoXnmG8qq12PCFUvpbhoZRqRPWv5QKBgQC8jUasxxPka0U21RawXC+w4t2pn3RFBC4goGEwGgibxkr+DTRQoHzJlB6Uud04bQwbicuLuIdIKvhmjSGzYaDa3LWwmDh6P+xjgQN3FEweOreOUITCBfz3lR2iy430HtS7bPLu31G2r8pgUnmbee/FBFtNlS41I1EYYbuRt9Pw8QKBgD6aPSpRWKtqTHD3X9e3X6FfQtGvhcb3Ze5E7HFU7wJklqsduRK9+8X05HocVcv8fd0cyKrkqiZtP2JuRueIWAJ2+FJvAsbjmVbVFHMgDmFjhrwM4YFG3cyq4pO+/pc0/3pMj9xt2N0Jg23c4koMX1iLKjhr/QxFv8XSPVfCm4jFAoGALfejdx4PpFgTWpbm5ZWRxukhZRhmfCIAWifYeJbsGTB5y7bheVxKmTpP9mKEqGL+gh3cLVPcZ557HWpc4d6NetdyrHffEhWULh4NWYDKC5BRCr9HjLKydBUQUMCFeJs3XZQTtN+CZORcuaI2ISH2QvfYki9ns4ujeH8OjzfHpvI=\n     87: \n     88: monitoring_tests_person_id: urn:collab:person:schachome:uuid\n     89: monitoring_tests_password: secret\n>>>  90: monitoring_oidc_client_secret: secret\n     91: monitoring_tests_oidcng_client_secret: secret\n     92: monitoring_tests_oidcng_resource_server_secret: secret\n     93: \n     94: manage_internal_api_password: secret\n     95: manage_backdoor_api_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "crv4all_openshift-ansible-images-installer-root-etc-inventory-generator-config.yaml", "content": "ansible_ssh_user: ec2-user", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: crv4all_openshift-ansible-images-installer-root-etc-inventory-generator-config.yaml\n\n# meta config\nmaster_config_path: \"/opt/app-root/src/master-config.yaml\"\nadmin_kubeconfig_path: \"/opt/app-root/src/.kube/config\"\n\n# default user configuration\n7: ansible_ssh_user: ec2-user\nansible_become: \"yes\"\nansible_become_user: \"root\"\n\n# openshift-ansible inventory vars\nopenshift_uninstall_images: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-images-installer-root-etc-inventory-generator-config.yaml\n# Target line: 7\n\n      2: # meta config\n      3: master_config_path: \"/opt/app-root/src/master-config.yaml\"\n      4: admin_kubeconfig_path: \"/opt/app-root/src/.kube/config\"\n      5: \n      6: # default user configuration\n>>>   7: ansible_ssh_user: ec2-user\n      8: ansible_become: \"yes\"\n      9: ansible_become_user: \"root\"\n     10: \n     11: # openshift-ansible inventory vars\n     12: openshift_uninstall_images: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml", "content": "extended_key_usage:", "line": 162, "detection_span": [157, 167], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n\nkey_usage_critical: yes\nkey_usage:\n- Digital Signature\n- keyEncipherment\nextended_key_usage_critical: no\n162:     extended_key_usage:\n- serverAuth\ndigest: sha256\npath: \"/etc/tls/csr/arkcase-server.csr\"\nprivatekey_path: \"{{ ssl_key }}\"\ncountry_name: US", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-pki-tasks-main.yml\n# Target line: 162\n\n    157:     key_usage_critical: yes\n    158:     key_usage:\n    159:       - Digital Signature\n    160:       - keyEncipherment\n    161:     extended_key_usage_critical: no\n>>> 162:     extended_key_usage:\n    163:       - serverAuth\n    164:     digest: sha256\n    165:     path: \"/etc/tls/csr/arkcase-server.csr\"\n    166:     privatekey_path: \"{{ ssl_key }}\"\n    167:     country_name: US\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "d34dh0r53_os-ansible-deployment-playbooks-roles-os_horizon-defaults-main.yml", "content": "horizon_ssl_cert_path: /etc/ssl/certs", "line": 66, "detection_span": [61, 71], "with_context": "# Ansible file: d34dh0r53_os-ansible-deployment-playbooks-roles-os_horizon-defaults-main.yml\n\n## Horizon SSL\n### Set the cacert pem if you'd like horizon to verify it.\n# horizon_cacert_pem: /path/to/cacert.pem\nhorizon_ssl_cert: /etc/ssl/certs/apache.cert\nhorizon_ssl_key: /etc/ssl/private/apache.key\n66: horizon_ssl_cert_path: /etc/ssl/certs\nhorizon_ssl_protocol: \"{{ ssl_protocol }}\"\nhorizon_ssl_cipher_suite: \"{{ ssl_cipher_suite }}\"\n\n# For multiple regions uncomment this configuration, and\n# add the extra endpoints below the first list item.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: d34dh0r53_os-ansible-deployment-playbooks-roles-os_horizon-defaults-main.yml\n# Target line: 66\n\n     61: ## Horizon SSL\n     62: ### Set the cacert pem if you'd like horizon to verify it.\n     63: # horizon_cacert_pem: /path/to/cacert.pem\n     64: horizon_ssl_cert: /etc/ssl/certs/apache.cert\n     65: horizon_ssl_key: /etc/ssl/private/apache.key\n>>>  66: horizon_ssl_cert_path: /etc/ssl/certs\n     67: horizon_ssl_protocol: \"{{ ssl_protocol }}\"\n     68: horizon_ssl_cipher_suite: \"{{ ssl_cipher_suite }}\"\n     69: \n     70: # For multiple regions uncomment this configuration, and\n     71: # add the extra endpoints below the first list item.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_casl-ansible-roles-cfme-ocp-provider-defaults-main.yml", "content": "hawkular_token:", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: redhat-cop_casl-ansible-roles-cfme-ocp-provider-defaults-main.yml\n\ncfme_username:\ncfme_password:\nocp_master_host: kubernetes.default.svc.cluster.local\nocp_master_port: 443\nocp_token:\n9: hawkular_token:\nhawkular_host: hawkular-metrics.openshift-infra.svc.cluster.local\nhawkular_port: 443\nocp_container_provier_name: OCP\ndefault_token_sa_namespace: management-infra\ndefault_token_sa_name: management-admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_casl-ansible-roles-cfme-ocp-provider-defaults-main.yml\n# Target line: 9\n\n      4: cfme_username:\n      5: cfme_password:\n      6: ocp_master_host: kubernetes.default.svc.cluster.local\n      7: ocp_master_port: 443\n      8: ocp_token:\n>>>   9: hawkular_token:\n     10: hawkular_host: hawkular-metrics.openshift-infra.svc.cluster.local\n     11: hawkular_port: 443\n     12: ocp_container_provier_name: OCP\n     13: default_token_sa_namespace: management-infra\n     14: default_token_sa_name: management-admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "shadow-robot_aurora-buildspec_teleop.yml", "content": "AWS_ACCESS_KEY : CODE_BUILD_EC2_ACCESS_KEY", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: shadow-robot_aurora-buildspec_teleop.yml\n\nversion: 0.2\n\nenv:\nparameter-store:\n5:      AWS_ACCESS_KEY : CODE_BUILD_EC2_ACCESS_KEY\nAWS_SECRET_KEY : CODE_BUILD_EC2_SECRET_KEY\nphases:\npre_build:\ncommands:\n- aws configure set aws_access_key_id $AWS_ACCESS_KEY", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: shadow-robot_aurora-buildspec_teleop.yml\n# Target line: 5\n\n      1: version: 0.2\n      2: \n      3: env:\n      4:   parameter-store:\n>>>   5:      AWS_ACCESS_KEY : CODE_BUILD_EC2_ACCESS_KEY\n      6:      AWS_SECRET_KEY : CODE_BUILD_EC2_SECRET_KEY\n      7: phases:\n      8:   pre_build:\n      9:     commands:\n     10:       - aws configure set aws_access_key_id $AWS_ACCESS_KEY\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wunderio_WunderTools-drupal-.lando.yml", "content": "webroot: web", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: wunderio_WunderTools-drupal-.lando.yml\n\nname: wunderlando\nrecipe: drupal8\n\nconfig:\n5:   webroot: web\nvia: nginx\nphp: '7.2'\ndatabase: mariadb:10.2\n\ntooling:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: wunderio_WunderTools-drupal-.lando.yml\n# Target line: 5\n\n      1: name: wunderlando\n      2: recipe: drupal8\n      3: \n      4: config:\n>>>   5:   webroot: web\n      6:   via: nginx\n      7:   php: '7.2'\n      8:   database: mariadb:10.2\n      9: \n     10: tooling:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml", "content": "key: fedmsg-librariesio2fedmsg.crt", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n\nprivatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\nwhen: env != \"staging\"\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-crt\n26:     key: fedmsg-librariesio2fedmsg.crt\nprivatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.crt\nwhen: env != \"staging\"\n- role: openshift/secret-file\napp: librariesio2fedmsg\nsecret_name: librariesio2fedmsg-fedmsg-key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: FrostyX_fedora-infra-ansible-playbooks-openshift-apps-librariesio2fedmsg.yml\n# Target line: 26\n\n     21:     privatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.key\n     22:     when: env != \"staging\"\n     23:   - role: openshift/secret-file\n     24:     app: librariesio2fedmsg\n     25:     secret_name: librariesio2fedmsg-fedmsg-crt\n>>>  26:     key: fedmsg-librariesio2fedmsg.crt\n     27:     privatefile: fedmsg-certs/keys/librariesio2fedmsg-librariesio2fedmsg.app.os.fedoraproject.org.crt\n     28:     when: env != \"staging\"\n     29:   - role: openshift/secret-file\n     30:     app: librariesio2fedmsg\n     31:     secret_name: librariesio2fedmsg-fedmsg-key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ashwineagle_ansible-oracle-roles-oradb-datapatch-defaults-main.yml", "content": "db_user: sys", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: ashwineagle_ansible-oracle-roles-oradb-datapatch-defaults-main.yml\n\nhostgroup: \"{{ group_names[0] }}\"\noracle_user: oracle\n\n4: db_user: sys\ndb_password: \"{% if dbpasswords is defined and dbpasswords[item.oracle_db_name] is defined and dbpasswords[item.oracle_db_name][db_user] is defined%}{{dbpasswords[item.oracle_db_name][db_user]}}{% else %}{{ default_dbpass}}{% endif%}\"\n\ndb_service_name: \"{%- if item.oracle_db_unique_name is defined -%}\n{{ item.oracle_db_unique_name }}\n{%- else -%}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ashwineagle_ansible-oracle-roles-oradb-datapatch-defaults-main.yml\n# Target line: 4\n\n      1: hostgroup: \"{{ group_names[0] }}\"\n      2: oracle_user: oracle\n      3: \n>>>   4: db_user: sys\n      5: db_password: \"{% if dbpasswords is defined and dbpasswords[item.oracle_db_name] is defined and dbpasswords[item.oracle_db_name][db_user] is defined%}{{dbpasswords[item.oracle_db_name][db_user]}}{% else %}{{ default_dbpass}}{% endif%}\"\n      6: \n      7: db_service_name: \"{%- if item.oracle_db_unique_name is defined -%}\n      8:                        {{ item.oracle_db_unique_name }}\n      9:                   {%- else -%}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wazuh_wazuh-ansible-roles-elastic-stack-ansible-kibana-tasks-main.yml", "content": "become_user: kibana", "line": 139, "detection_span": [134, 144], "with_context": "# Ansible file: wazuh_wazuh-ansible-roles-elastic-stack-ansible-kibana-tasks-main.yml\n\n134:   shell: /usr/share/kibana/node/bin/node {{ node_options }} /usr/share/kibana/src/cli/cli.js --optimize -c {{ kibana_conf_path }}/kibana.yml\n135:   args:\nexecutable: /bin/bash\ncreates: /usr/share/kibana/data/wazuh/\n138:   become: yes\n139:   become_user: kibana\n140:   tags:\n- skip_ansible_lint\n142:\n143: - name: Wait for Elasticsearch port\n144:   wait_for: host={{ elasticsearch_network_host }} port={{ elasticsearch_http_port }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: wazuh_wazuh-ansible-roles-elastic-stack-ansible-kibana-tasks-main.yml\n# Target line: 139\n\n    134:   shell: /usr/share/kibana/node/bin/node {{ node_options }} /usr/share/kibana/src/cli/cli.js --optimize -c {{ kibana_conf_path }}/kibana.yml\n    135:   args:\n    136:     executable: /bin/bash\n    137:     creates: /usr/share/kibana/data/wazuh/\n    138:   become: yes\n>>> 139:   become_user: kibana\n    140:   tags:\n    141:     - skip_ansible_lint\n    142: \n    143: - name: Wait for Elasticsearch port\n    144:   wait_for: host={{ elasticsearch_network_host }} port={{ elasticsearch_http_port }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-upgrade_v2.x_to_v3.0_eos_designs-twodc-5stage-clos-intended-structured_configs-DC1-POD2-SPINE2.yml", "content": "sha512_password: $6$eJ5TvI8oru5i9e8G$R1X/SbtGTk9xoEHEBQASc7SC2nHYmi.crVgp2pXuCXwxsXEA81e4E0cXgQ6kX08fIeQzauqhv2kS.RGJFCon5/", "line": 85, "detection_span": [80, 90], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-upgrade_v2.x_to_v3.0_eos_designs-twodc-5stage-clos-intended-structured_configs-DC1-POD2-SPINE2.yml\n\nmode: none\nlocal_users:\nadmin:\nprivilege: 15\nrole: network-admin\n85:     sha512_password: $6$eJ5TvI8oru5i9e8G$R1X/SbtGTk9xoEHEBQASc7SC2nHYmi.crVgp2pXuCXwxsXEA81e4E0cXgQ6kX08fIeQzauqhv2kS.RGJFCon5/\nvrfs:\nMGMT:\nip_routing: false\nmanagement_interfaces:\nManagement1:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-upgrade_v2.x_to_v3.0_eos_designs-twodc-5stage-clos-intended-structured_configs-DC1-POD2-SPINE2.yml\n# Target line: 85\n\n     80:   mode: none\n     81: local_users:\n     82:   admin:\n     83:     privilege: 15\n     84:     role: network-admin\n>>>  85:     sha512_password: $6$eJ5TvI8oru5i9e8G$R1X/SbtGTk9xoEHEBQASc7SC2nHYmi.crVgp2pXuCXwxsXEA81e4E0cXgQ6kX08fIeQzauqhv2kS.RGJFCon5/\n     86: vrfs:\n     87:   MGMT:\n     88:     ip_routing: false\n     89: management_interfaces:\n     90:   Management1:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_infra-ansible-roles-osp-packstack-install-tasks-sync-keys.yml", "content": "dest: \"/tmp/id_rsa\"", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: redhat-cop_infra-ansible-roles-osp-packstack-install-tasks-sync-keys.yml\n\n---\n\n- name: 'Fetch the private SSH key from the first host'\nfetch:\nsrc: \"~/.ssh/id_rsa\"\n6:     dest: \"/tmp/id_rsa\"\nflat: yes\nrun_once: true\ndelegate_to: \"{{ ansible_play_hosts | first }}\"\n\n- name: 'Fetch the public SSH key from the first host'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_infra-ansible-roles-osp-packstack-install-tasks-sync-keys.yml\n# Target line: 6\n\n      1: ---\n      2: \n      3: - name: 'Fetch the private SSH key from the first host'\n      4:   fetch:\n      5:     src: \"~/.ssh/id_rsa\"\n>>>   6:     dest: \"/tmp/id_rsa\"\n      7:     flat: yes\n      8:   run_once: true\n      9:   delegate_to: \"{{ ansible_play_hosts | first }}\"\n     10: \n     11: - name: 'Fetch the public SSH key from the first host'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ynya_ansible-language_features-netscaler.yml", "content": "nsc_pass: nimda", "line": 11, "detection_span": [6, 16], "with_context": "# Ansible file: ynya_ansible-language_features-netscaler.yml\n\n- hosts: web-pool\nserial: 3\nvars:\nnsc_host: nsc.example.com\nnsc_user: admin\n11:     nsc_pass: nimda\n# type of the netscaler object you want to manipulate\ntype: service\n# netscaler object name\nname: \"{{facter_fqdn}}:8080\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ynya_ansible-language_features-netscaler.yml\n# Target line: 11\n\n      6: - hosts: web-pool\n      7:   serial: 3\n      8:   vars:\n      9:     nsc_host: nsc.example.com\n     10:     nsc_user: admin\n>>>  11:     nsc_pass: nimda\n     12:     # type of the netscaler object you want to manipulate\n     13:     type: service\n     14:     # netscaler object name\n     15:     name: \"{{facter_fqdn}}:8080\"\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sivabayya_ansible-provisioner-roles-geerlingguy.gitlab-defaults-main.yml", "content": "gitlab_smtp_user_name: \"smtp user\"", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: sivabayya_ansible-provisioner-roles-geerlingguy.gitlab-defaults-main.yml\n\n\n# SMTP Configuration\ngitlab_smtp_enable: \"false\"\ngitlab_smtp_address: \"smtp.server\"\ngitlab_smtp_port: \"465\"\n34: gitlab_smtp_user_name: \"smtp user\"\ngitlab_smtp_password: \"smtp password\"\ngitlab_smtp_domain: \"example.com\"\ngitlab_smtp_authentication: \"login\"\ngitlab_smtp_enable_starttls_auto: \"true\"\ngitlab_smtp_tls: \"false\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sivabayya_ansible-provisioner-roles-geerlingguy.gitlab-defaults-main.yml\n# Target line: 34\n\n     29: \n     30: # SMTP Configuration\n     31: gitlab_smtp_enable: \"false\"\n     32: gitlab_smtp_address: \"smtp.server\"\n     33: gitlab_smtp_port: \"465\"\n>>>  34: gitlab_smtp_user_name: \"smtp user\"\n     35: gitlab_smtp_password: \"smtp password\"\n     36: gitlab_smtp_domain: \"example.com\"\n     37: gitlab_smtp_authentication: \"login\"\n     38: gitlab_smtp_enable_starttls_auto: \"true\"\n     39: gitlab_smtp_tls: \"false\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml", "content": "- doc_root: \"/var/local/versailles\"", "line": 47, "detection_span": [42, 52], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n\n- doc_root: \"/var/local/njmaps\"\ngit_repo: 'https://github.com/pulibrary/njmaps_exhibit_archive.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'njmaps'\n47:     - doc_root: \"/var/local/versailles\"\ngit_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'versailles'\n- doc_root: \"/var/local/visual_materials\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n# Target line: 47\n\n     42:     - doc_root: \"/var/local/njmaps\"\n     43:       git_repo: 'https://github.com/pulibrary/njmaps_exhibit_archive.git'\n     44:       options: 'Indexes FollowSymLinks MultiViews'\n     45:       version: 'main'\n     46:       alias: 'njmaps'\n>>>  47:     - doc_root: \"/var/local/versailles\"\n     48:       git_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\n     49:       options: 'Indexes FollowSymLinks MultiViews'\n     50:       version: 'main'\n     51:       alias: 'versailles'\n     52:     - doc_root: \"/var/local/visual_materials\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ARTbio_GalaxyKickStart-.github-workflows-ci.yaml", "content": "BIOBLEND_GALAXY_API_KEY: \"artbio2020\"", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: ARTbio_GalaxyKickStart-.github-workflows-ci.yaml\n\n- readthedocs\n- master\nenv:\nGALAXY_USER: admin@galaxy.org\nGALAXY_USER_PASSWD: artbio2020\n10:   BIOBLEND_GALAXY_API_KEY: \"artbio2020\"\nBIOBLEND_GALAXY_URL: \"http://127.0.0.1:80\"\n\n\njobs:\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ARTbio_GalaxyKickStart-.github-workflows-ci.yaml\n# Target line: 10\n\n      5:       - readthedocs\n      6:       - master\n      7: env:\n      8:   GALAXY_USER: admin@galaxy.org\n      9:   GALAXY_USER_PASSWD: artbio2020\n>>>  10:   BIOBLEND_GALAXY_API_KEY: \"artbio2020\"\n     11:   BIOBLEND_GALAXY_URL: \"http://127.0.0.1:80\"\n     12: \n     13: \n     14: jobs:\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "trilioData_triliovault-cfg-scripts-redhat-director-scripts-rhosp16-environments-trilio_env.yaml", "content": "TrilioDatamoverPassword: \"test1234\"", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: trilioData_triliovault-cfg-scripts-redhat-director-scripts-rhosp16-environments-trilio_env.yaml\n\n## Define network map for trilio datamover api service\nServiceNetMap:\nTrilioDatamoverApiNetwork: internal_api\n\n## TrilioVault Datamover Password for keystone and database\n19:    TrilioDatamoverPassword: \"test1234\"\n\n## TrilioVault container pull urls\nDockerTrilioDatamoverImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover:4.0.41-rhosp16\nDockerTrilioDmApiImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover-api:4.0.41-rhosp16\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trilioData_triliovault-cfg-scripts-redhat-director-scripts-rhosp16-environments-trilio_env.yaml\n# Target line: 19\n\n     14:    ## Define network map for trilio datamover api service\n     15:    ServiceNetMap:\n     16:        TrilioDatamoverApiNetwork: internal_api\n     17: \n     18:    ## TrilioVault Datamover Password for keystone and database\n>>>  19:    TrilioDatamoverPassword: \"test1234\"\n     20: \n     21:    ## TrilioVault container pull urls\n     22:    DockerTrilioDatamoverImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover:4.0.41-rhosp16\n     23:    DockerTrilioDmApiImage: devundercloud.ctlplane.localdomain:8787/trilio/trilio-datamover-api:4.0.41-rhosp16\n     24: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml", "content": "matrix_mx_puppet_twitter_login_shared_secret: ''", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n\n\nmatrix_mx_puppet_twitter_appservice_token: ''\nmatrix_mx_puppet_twitter_homeserver_token: ''\n\n# Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\n64: matrix_mx_puppet_twitter_login_shared_secret: ''\n\n# Database configuration\nmatrix_mx_puppet_twitter_database_engine: sqlite\n\nmatrix_mx_puppet_twitter_sqlite_database_path_local: \"{{ matrix_mx_puppet_twitter_data_path }}/database.db\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n# Target line: 64\n\n     59: \n     60: matrix_mx_puppet_twitter_appservice_token: ''\n     61: matrix_mx_puppet_twitter_homeserver_token: ''\n     62: \n     63: # Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\n>>>  64: matrix_mx_puppet_twitter_login_shared_secret: ''\n     65: \n     66: # Database configuration\n     67: matrix_mx_puppet_twitter_database_engine: sqlite\n     68: \n     69: matrix_mx_puppet_twitter_sqlite_database_path_local: \"{{ matrix_mx_puppet_twitter_data_path }}/database.db\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Alfresco_alfresco-ansible-deployment-roles-nginx-vars-ssl.yml", "content": "root: \"/usr/share/nginx/html\"", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: Alfresco_alfresco-ansible-deployment-roles-nginx-vars-ssl.yml\n\nserver_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\ntemplate: \"alfresco_redirect.conf.j2\"\nfilename: \"alfresco.conf\"\n- listen: \"443\"\nserver_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\n8:     root: \"/usr/share/nginx/html\"\nindex: \"index.html index.htm\"\nfilename: \"ssl.{{ fqdn_alfresco }}.conf\"\ncert_crt: \"{{ fqdn_alfresco }}.crt\"\ncert_key: \"{{ fqdn_alfresco }}.key\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Alfresco_alfresco-ansible-deployment-roles-nginx-vars-ssl.yml\n# Target line: 8\n\n      3:     server_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\n      4:     template: \"alfresco_redirect.conf.j2\"\n      5:     filename: \"alfresco.conf\"\n      6:   - listen: \"443\"\n      7:     server_name: \"{{ fqdn_alfresco }}\" # this should be an input from the client\n>>>   8:     root: \"/usr/share/nginx/html\"\n      9:     index: \"index.html index.htm\"\n     10:     filename: \"ssl.{{ fqdn_alfresco }}.conf\"\n     11:     cert_crt: \"{{ fqdn_alfresco }}.crt\"\n     12:     cert_key: \"{{ fqdn_alfresco }}.key\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "IBM_community-automation-ansible-request-rhel-jmeter-fyre-play-jmeter-play.yml", "content": "- ansible_user: root", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: IBM_community-automation-ansible-request-rhel-jmeter-fyre-play-jmeter-play.yml\n\n---\n\n- hosts: all\nvars:\n5:   - ansible_user: root\nroles:\n- role: podman\n\n- hosts: all\nvars:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_community-automation-ansible-request-rhel-jmeter-fyre-play-jmeter-play.yml\n# Target line: 5\n\n      1: ---\n      2: \n      3: - hosts: all\n      4:   vars:\n>>>   5:   - ansible_user: root\n      6:   roles:\n      7:   - role: podman\n      8: \n      9: - hosts: all\n     10:   vars:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml", "content": "key: crt", "line": 84, "detection_span": [79, 89], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n\nkey: password\n- name: EC_CRT\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\n84:                 key: crt\n- name: EC_CA\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\nkey: ca", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n# Target line: 84\n\n     79:                 key: password\n     80:           - name: EC_CRT\n     81:             valueFrom:\n     82:               secretKeyRef:\n     83:                 name: \"${EC_SECRET_CRT}\"\n>>>  84:                 key: crt\n     85:           - name: EC_CA\n     86:             valueFrom:\n     87:               secretKeyRef:\n     88:                 name: \"${EC_SECRET_CRT}\"\n     89:                 key: ca\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "lumir-sliva_ceph-ansible-infrastructure-playbooks-rgw-add-users-buckets.yml", "content": "user: 'test2'", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: lumir-sliva_ceph-ansible-infrastructure-playbooks-rgw-add-users-buckets.yml\n\n- bucket: 'bucket6'\nuser: 'test2'\n- bucket: 'bucket7'\nuser: 'test2'\n- bucket: 'bucket8'\n61:           user: 'test2'\n- bucket: 'bucket9'\nuser: 'test2'\n- bucket: 'bucket10'\nuser: 'test2'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: lumir-sliva_ceph-ansible-infrastructure-playbooks-rgw-add-users-buckets.yml\n# Target line: 61\n\n     56:         - bucket: 'bucket6'\n     57:           user: 'test2'\n     58:         - bucket: 'bucket7'\n     59:           user: 'test2'\n     60:         - bucket: 'bucket8'\n>>>  61:           user: 'test2'\n     62:         - bucket: 'bucket9'\n     63:           user: 'test2'\n     64:         - bucket: 'bucket10'\n     65:           user: 'test2'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CentOS-PaaS-SIG_linchpin-linchpin-provision-roles-aws-tasks-provision_aws_ec2_vpc_routetable.yml", "content": "- {key: 'Name', value: \"{{ res_def['name'] }}\"}", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: CentOS-PaaS-SIG_linchpin-linchpin-provision-roles-aws-tasks-provision_aws_ec2_vpc_routetable.yml\n\n- name: Append  name to tags\nset_fact:\nroutetable_tags: \"{{ routetable_tags |\ncombine({routekey.key: routekey.value}) }}\"\nwith_items:\n46:     - {key: 'Name', value: \"{{ res_def['name'] }}\"}\nloop_control:\nloop_var: routekey\n\n- name: \"Provision/teardown AWS_EC2_VPC_ROUTETABLE\"\nec2_vpc_route_table:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: CentOS-PaaS-SIG_linchpin-linchpin-provision-roles-aws-tasks-provision_aws_ec2_vpc_routetable.yml\n# Target line: 46\n\n     41: - name: Append  name to tags\n     42:   set_fact:\n     43:     routetable_tags: \"{{ routetable_tags |\n     44:                          combine({routekey.key: routekey.value}) }}\"\n     45:   with_items:\n>>>  46:     - {key: 'Name', value: \"{{ res_def['name'] }}\"}\n     47:   loop_control:\n     48:     loop_var: routekey\n     49: \n     50: - name: \"Provision/teardown AWS_EC2_VPC_ROUTETABLE\"\n     51:   ec2_vpc_route_table:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-eu_infrastructure-playbook-group_vars-all.yml", "content": "- /etc/ssh/ssh_host_rsa_key-cert.pub", "line": 128, "detection_span": [123, 133], "with_context": "# Ansible file: usegalaxy-eu_infrastructure-playbook-group_vars-all.yml\n\n123: # SSH\n124:\n125: # ALL hosts should have signed SSH keys.\n126: # ssh-host-(re)sign role\n127: ssh_host_key_cert_files:\n128:   - /etc/ssh/ssh_host_rsa_key-cert.pub\n129:   - /etc/ssh/ssh_host_ecdsa_key-cert.pub\n130:   - /etc/ssh/ssh_host_ed25519_key-cert.pub\n131:\n132: # dev-sec.ssh-hardening role\n133: # Allow root login on all machines", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-eu_infrastructure-playbook-group_vars-all.yml\n# Target line: 128\n\n    123: # SSH\n    124: \n    125: # ALL hosts should have signed SSH keys.\n    126: # ssh-host-(re)sign role\n    127: ssh_host_key_cert_files:\n>>> 128:   - /etc/ssh/ssh_host_rsa_key-cert.pub\n    129:   - /etc/ssh/ssh_host_ecdsa_key-cert.pub\n    130:   - /etc/ssh/ssh_host_ed25519_key-cert.pub\n    131: \n    132: # dev-sec.ssh-hardening role\n    133: # Allow root login on all machines\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml", "content": "nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem", "line": 45, "detection_span": [40, 50], "with_context": "# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n\n\n## used by: galaxyproject.galaxy\nnginx_srv: /srv/nginx\nnginx_ssl_role: usegalaxy_eu.certbot\nnginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n45: nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n\ncertbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\ncertbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\ncertbot_auth_method: --webroot\ncertbot_install_method: virtualenv", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n# Target line: 45\n\n     40: \n     41: ## used by: galaxyproject.galaxy\n     42: nginx_srv: /srv/nginx\n     43: nginx_ssl_role: usegalaxy_eu.certbot\n     44: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n>>>  45: nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n     46: \n     47: certbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\n     48: certbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\n     49: certbot_auth_method: --webroot\n     50: certbot_install_method: virtualenv\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "RedHatGov_redhatgov.workshops-rhel_edge_aws-group_vars-all_example.yml", "content": "letsencrypt:                      false", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: RedHatGov_redhatgov.workshops-rhel_edge_aws-group_vars-all_example.yml\n\nrhsm_activationkey:               \"\"\nrhsm_org_id:                      \"\"\n#------------------------------------------------------------------------------\n# LetsEncrypt              |      email\nletsencrypt_email:                \"someone@redhat.com\"\n61: letsencrypt:                      false\n#------------------------------------------------------------------------------\n# console                  |      password\nworkshop_password:                \"\" # Note that Windows 2016 requires 3 character classes and 10 characters\n#------------------------------------------------------------------------------\n# ports to open            |      Add any ports that you may need to this dict", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: RedHatGov_redhatgov.workshops-rhel_edge_aws-group_vars-all_example.yml\n# Target line: 61\n\n     56: rhsm_activationkey:               \"\"\n     57: rhsm_org_id:                      \"\"\n     58: #------------------------------------------------------------------------------\n     59: # LetsEncrypt              |      email\n     60: letsencrypt_email:                \"someone@redhat.com\"\n>>>  61: letsencrypt:                      false\n     62: #------------------------------------------------------------------------------\n     63: # console                  |      password\n     64: workshop_password:                \"\" # Note that Windows 2016 requires 3 character classes and 10 characters\n     65: #------------------------------------------------------------------------------\n     66: # ports to open            |      Add any ports that you may need to this dict\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml", "content": "nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n\n\n\n## used by: galaxyproject.galaxy\nnginx_srv: /srv/nginx\nnginx_ssl_role: usegalaxy_eu.certbot\n44: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\nnginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n\ncertbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\ncertbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\ncertbot_auth_method: --webroot", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: galaxyproject_usegalaxy-playbook-env-common-group_vars-toolshedwebservers.yml\n# Target line: 44\n\n     39: \n     40: \n     41: ## used by: galaxyproject.galaxy\n     42: nginx_srv: /srv/nginx\n     43: nginx_ssl_role: usegalaxy_eu.certbot\n>>>  44: nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem\n     45: nginx_conf_ssl_certificate_key: /etc/ssl/private/privkey.pem\n     46: \n     47: certbot_auto_renew_hour: \"{{ 23 |random(seed=inventory_hostname)  }}\"\n     48: certbot_auto_renew_minute: \"{{ 59 |random(seed=inventory_hostname)  }}\"\n     49: certbot_auth_method: --webroot\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-dev_slurm.yml", "content": "auth_key_user: ubuntu", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-dev_slurm.yml\n\n\n2: auth_key_user: ubuntu\n\nhead_nodes: \"{{ groups['dev_slurm_head'] }}\"\nworker_nodes: \"{{ groups['dev_workers'] }}\"\ngalaxy_nodes: \"{{ groups['dev_galaxy_server'] }}\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-dev_slurm.yml\n# Target line: 2\n\n      1: \n>>>   2: auth_key_user: ubuntu\n      3: \n      4: head_nodes: \"{{ groups['dev_slurm_head'] }}\"\n      5: worker_nodes: \"{{ groups['dev_workers'] }}\"\n      6: galaxy_nodes: \"{{ groups['dev_galaxy_server'] }}\"\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cyverse_atmosphere-ansible-ansible-playbooks-instance_deploy-50_shell_access.yml", "content": "EXTERNAL_HOST_KEY_GROUP: root", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: cyverse_atmosphere-ansible-ansible-playbooks-instance_deploy-50_shell_access.yml\n\nhosts: all\nvars:\nEXTERNAL_HOST_KEY_NAME: \"id_rsa_gateone\"\nEXTERNAL_HOST_KEY_DIR: \"/var/lib/gateone/users/{{ ATMOUSERNAME }}/.ssh\"\nEXTERNAL_HOST_KEY_OWNER: root\n8:     EXTERNAL_HOST_KEY_GROUP: root\nEXTERNAL_HOST: \"shell\"\nUSERNAME: \"{{ ATMOUSERNAME }}\"\nroles:\n- { role: \"sshkey-host-access\", when: (SETUP_GUACAMOLE | default(true)) == false }\ntasks:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cyverse_atmosphere-ansible-ansible-playbooks-instance_deploy-50_shell_access.yml\n# Target line: 8\n\n      3:   hosts: all\n      4:   vars:\n      5:     EXTERNAL_HOST_KEY_NAME: \"id_rsa_gateone\"\n      6:     EXTERNAL_HOST_KEY_DIR: \"/var/lib/gateone/users/{{ ATMOUSERNAME }}/.ssh\"\n      7:     EXTERNAL_HOST_KEY_OWNER: root\n>>>   8:     EXTERNAL_HOST_KEY_GROUP: root\n      9:     EXTERNAL_HOST: \"shell\"\n     10:     USERNAME: \"{{ ATMOUSERNAME }}\"\n     11:   roles:\n     12:     - { role: \"sshkey-host-access\", when: (SETUP_GUACAMOLE | default(true)) == false }\n     13:   tasks:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ComplianceAsCode_content-products-jre-product.yml", "content": "benchmark_root: \"./guide\"", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n\nproduct: jre\nfull_name: Java Runtime Environment\ntype: product\n\nbenchmark_id: JRE\n6: benchmark_root: \"./guide\"\n\nprofiles_root: \"./profiles\"\n\npkg_manager: \"yum\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n# Target line: 6\n\n      1: product: jre\n      2: full_name: Java Runtime Environment\n      3: type: product\n      4: \n      5: benchmark_id: JRE\n>>>   6: benchmark_root: \"./guide\"\n      7: \n      8: profiles_root: \"./profiles\"\n      9: \n     10: pkg_manager: \"yum\"\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-steam-defaults-main.yml", "content": "matrix_mx_puppet_steam_database_username: matrix_mx_puppet_steam", "line": 62, "detection_span": [57, 67], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-steam-defaults-main.yml\n\nmatrix_mx_puppet_steam_database_engine: sqlite\n\nmatrix_mx_puppet_steam_sqlite_database_path_local: \"{{ matrix_mx_puppet_steam_data_path }}/database.db\"\nmatrix_mx_puppet_steam_sqlite_database_path_in_container: \"/data/database.db\"\n\n62: matrix_mx_puppet_steam_database_username: matrix_mx_puppet_steam\nmatrix_mx_puppet_steam_database_password: ~\nmatrix_mx_puppet_steam_database_hostname: 'matrix-postgres'\nmatrix_mx_puppet_steam_database_port: 5432\nmatrix_mx_puppet_steam_database_name: matrix_mx_puppet_steam\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-steam-defaults-main.yml\n# Target line: 62\n\n     57: matrix_mx_puppet_steam_database_engine: sqlite\n     58: \n     59: matrix_mx_puppet_steam_sqlite_database_path_local: \"{{ matrix_mx_puppet_steam_data_path }}/database.db\"\n     60: matrix_mx_puppet_steam_sqlite_database_path_in_container: \"/data/database.db\"\n     61: \n>>>  62: matrix_mx_puppet_steam_database_username: matrix_mx_puppet_steam\n     63: matrix_mx_puppet_steam_database_password: ~\n     64: matrix_mx_puppet_steam_database_hostname: 'matrix-postgres'\n     65: matrix_mx_puppet_steam_database_port: 5432\n     66: matrix_mx_puppet_steam_database_name: matrix_mx_puppet_steam\n     67: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-default_vars_osp.yml", "content": "install_student_user: false", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-default_vars_osp.yml\n\n### OSP Environment variables\n################################################################################\n\n\ncloud_provider: osp\n7: install_student_user: false\n\n\nansible_user: cloud-user\nremote_user: cloud-user\nosp_cluster_dns_zone: red.osp.opentlc.com", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-multi-cloud-capsule-default_vars_osp.yml\n# Target line: 7\n\n      2: ### OSP Environment variables\n      3: ################################################################################\n      4: \n      5: \n      6: cloud_provider: osp                               \n>>>   7: install_student_user: false\n      8: \n      9: \n     10: ansible_user: cloud-user\n     11: remote_user: cloud-user\n     12: osp_cluster_dns_zone: red.osp.opentlc.com\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OnrampLab_laravel-starter-tools-infrastructure-vm-based-provisioning-ansible-provision-production.yml", "content": "phpmyadmin_user: admin", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: OnrampLab_laravel-starter-tools-infrastructure-vm-based-provisioning-ansible-provision-production.yml\n\ncertbot_email: myemail@email.com\n- role: phpmyadmin\ntags: [ 'phpmyadmin' ]\nphpmyadmin_database: phpmyadmin\nphpmyadmin_server_ip: localhost\n14:         phpmyadmin_user: admin\nphpmyadmin_password: mypassword\nphpmyadmin_client_ip: pma.laravel-starter.com\nphpmyadmin_hostname: pma.laravel-starter.com\ncertbot_email: myemail@email.com\n- role: oefenweb.yarn", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OnrampLab_laravel-starter-tools-infrastructure-vm-based-provisioning-ansible-provision-production.yml\n# Target line: 14\n\n      9:         certbot_email: myemail@email.com\n     10:       - role: phpmyadmin\n     11:         tags: [ 'phpmyadmin' ]\n     12:         phpmyadmin_database: phpmyadmin\n     13:         phpmyadmin_server_ip: localhost\n>>>  14:         phpmyadmin_user: admin\n     15:         phpmyadmin_password: mypassword\n     16:         phpmyadmin_client_ip: pma.laravel-starter.com\n     17:         phpmyadmin_hostname: pma.laravel-starter.com\n     18:         certbot_email: myemail@email.com\n     19:       - role: oefenweb.yarn\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-roles-ufmonitor-defaults-main.yml", "content": "ufmonitor_db_user: \"ufmonitor\"", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: tmzullinger_fedora-ansible-roles-ufmonitor-defaults-main.yml\n\napiserver_container_image: \"docker.io/fedoraqa/ufmonitor-apiserver:latest\"\nupdater_container_image: \"docker.io/fedoraqa/ufmonitor-updater:latest\"\nufmonitor_db_host: \"172.17.0.1\"\nufmonitor_db_name: \"ufmonitor\"\n5: ufmonitor_db_user: \"ufmonitor\"\nufmonitor_db_password: \"terribleinsecurepassword\"\nufmonitor_config_path: \"/etc/sysconfig/ufmonitor\"\nufmonitor_home: \"/var/www/ufmonitor\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-roles-ufmonitor-defaults-main.yml\n# Target line: 5\n\n      1: apiserver_container_image: \"docker.io/fedoraqa/ufmonitor-apiserver:latest\"\n      2: updater_container_image: \"docker.io/fedoraqa/ufmonitor-updater:latest\"\n      3: ufmonitor_db_host: \"172.17.0.1\"\n      4: ufmonitor_db_name: \"ufmonitor\"\n>>>   5: ufmonitor_db_user: \"ufmonitor\"\n      6: ufmonitor_db_password: \"terribleinsecurepassword\"\n      7: ufmonitor_config_path: \"/etc/sysconfig/ufmonitor\"\n      8: ufmonitor_home: \"/var/www/ufmonitor\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dimagi_commcare-cloud-changelog-0010-letsencrypt-restart-nginx.yml", "content": "key: letsencrypt-restart-nginx", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: dimagi_commcare-cloud-changelog-0010-letsencrypt-restart-nginx.yml\n\ntitle: Restart nginx after every letsencrypt cert auto-renewal\n2: key: letsencrypt-restart-nginx\ndate: 2019-01-02\n\noptional_per_env: yes\n\nmin_commcare_version:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dimagi_commcare-cloud-changelog-0010-letsencrypt-restart-nginx.yml\n# Target line: 2\n\n      1: title: Restart nginx after every letsencrypt cert auto-renewal\n>>>   2: key: letsencrypt-restart-nginx\n      3: date: 2019-01-02\n      4: \n      5: optional_per_env: yes\n      6: \n      7: min_commcare_version:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml", "content": "- doc_root: \"/var/local/visual_materials\"", "line": 52, "detection_span": [47, 57], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n\n- doc_root: \"/var/local/versailles\"\ngit_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'versailles'\n52:     - doc_root: \"/var/local/visual_materials\"\ngit_repo: 'git@github.com:PrincetonUniversityLibrary/visual_materials.git'\noptions: 'Indexes FollowSymLinks MultiViews'\nversion: 'main'\nalias: 'visual_materials'\nssh_opts: -i /home/deploy/.ssh/id_rsa -o StrictHostKeyChecking=no", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-libstatic-defaults-main.yml\n# Target line: 52\n\n     47:     - doc_root: \"/var/local/versailles\"\n     48:       git_repo: 'https://github.com/pulibrary/versailles_exhibit_archive.git'\n     49:       options: 'Indexes FollowSymLinks MultiViews'\n     50:       version: 'main'\n     51:       alias: 'versailles'\n>>>  52:     - doc_root: \"/var/local/visual_materials\"\n     53:       git_repo: 'git@github.com:PrincetonUniversityLibrary/visual_materials.git'\n     54:       options: 'Indexes FollowSymLinks MultiViews'\n     55:       version: 'main'\n     56:       alias: 'visual_materials'\n     57:       ssh_opts: -i /home/deploy/.ssh/id_rsa -o StrictHostKeyChecking=no\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_create_admin-tasks-distribute_key_files.yml", "content": "dest: /home/{{ tripleo_admin_user }}/.ssh/id_rsa", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_create_admin-tasks-distribute_key_files.yml\n\n# License for the specific language governing permissions and limitations\n# under the License.\n\n- name: Install private key on nodes for user {{ tripleo_admin_user }}\ncopy:\n19:     dest: /home/{{ tripleo_admin_user }}/.ssh/id_rsa\ncontent: \"{{ tripleo_admin_prikey }}\"\nowner: \"{{ tripleo_admin_user }}\"\ngroup: \"{{ tripleo_admin_user }}\"\nmode: '0600'\nwhen:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_create_admin-tasks-distribute_key_files.yml\n# Target line: 19\n\n     14: # License for the specific language governing permissions and limitations\n     15: # under the License.\n     16: \n     17: - name: Install private key on nodes for user {{ tripleo_admin_user }}\n     18:   copy:\n>>>  19:     dest: /home/{{ tripleo_admin_user }}/.ssh/id_rsa\n     20:     content: \"{{ tripleo_admin_prikey }}\"\n     21:     owner: \"{{ tripleo_admin_user }}\"\n     22:     group: \"{{ tripleo_admin_user }}\"\n     23:     mode: '0600'\n     24:   when:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-playbooks-manual-upgrade-koschei.yml", "content": "become_user: koschei", "line": 60, "detection_span": [55, 65], "with_context": "# Ansible file: tmzullinger_fedora-ansible-playbooks-manual-upgrade-koschei.yml\n\n- name: run DB migration\nhosts: \"{{ koschei_backend_hosts | default('koschei-backend:koschei-backend-stg') }}\"\ntasks:\n- name: run db migration\nbecome: yes\n60:     become_user: koschei\ncommand: koschei-admin alembic upgrade head\n\n- name: restart httpd\nhosts: \"{{ koschei_web_hosts | default('koschei-web:koschei-web-stg') }}\"\nvars_files:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-playbooks-manual-upgrade-koschei.yml\n# Target line: 60\n\n     55: - name: run DB migration\n     56:   hosts: \"{{ koschei_backend_hosts | default('koschei-backend:koschei-backend-stg') }}\"\n     57:   tasks:\n     58:   - name: run db migration\n     59:     become: yes\n>>>  60:     become_user: koschei\n     61:     command: koschei-admin alembic upgrade head\n     62: \n     63: - name: restart httpd\n     64:   hosts: \"{{ koschei_web_hosts | default('koschei-web:koschei-web-stg') }}\"\n     65:   vars_files:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "neki06_kolla-ansible-ansible-roles-octavia-defaults-main.yml", "content": "octavia_keystone_user: \"octavia\"", "line": 83, "detection_span": [78, 88], "with_context": "# Ansible file: neki06_kolla-ansible-ansible-roles-octavia-defaults-main.yml\n\noctavia_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ octavia_api_port }}\"\noctavia_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ octavia_api_port }}\"\n\noctavia_logging_debug: \"{{ openstack_logging_debug }}\"\n\n83: octavia_keystone_user: \"octavia\"\n\nopenstack_octavia_auth: \"{{ openstack_auth }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: neki06_kolla-ansible-ansible-roles-octavia-defaults-main.yml\n# Target line: 83\n\n     78: octavia_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ octavia_api_port }}\"\n     79: octavia_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ octavia_api_port }}\"\n     80: \n     81: octavia_logging_debug: \"{{ openstack_logging_debug }}\"\n     82: \n>>>  83: octavia_keystone_user: \"octavia\"\n     84: \n     85: openstack_octavia_auth: \"{{ openstack_auth }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Ansible-roles-glassfish-tasks-glassfish.yml", "content": "become_user: liferayadmin", "line": 40, "detection_span": [35, 45], "with_context": "# Ansible file: AAROC_DevOps-Ansible-roles-glassfish-tasks-glassfish.yml\n\ndest: /home/liferayadmin/glassfish-3.1.2.2.zip\nwhen: glassfish_stat.stat.exists | bool != True\n\n- name: extract the zip\nbecome: true\n40:   become_user: liferayadmin\n#  unarchive: src=/home/liferayadmin/glassfish-3.1.2.2.zip  dest=/opt/glassfish copy=no creates=/opt/glassfish/glassfish3/glassfish/bin/asadmin\ncommand: \"/usr/bin/unzip -d /opt/glassfish glassfish-3.1.2.2.zip creates=/opt/glassfish/glassfish3/\"\nwhen: asadmin_stat.stat.exists == false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Ansible-roles-glassfish-tasks-glassfish.yml\n# Target line: 40\n\n     35:     dest: /home/liferayadmin/glassfish-3.1.2.2.zip\n     36:   when: glassfish_stat.stat.exists | bool != True\n     37: \n     38: - name: extract the zip\n     39:   become: true\n>>>  40:   become_user: liferayadmin\n     41: #  unarchive: src=/home/liferayadmin/glassfish-3.1.2.2.zip  dest=/opt/glassfish copy=no creates=/opt/glassfish/glassfish3/glassfish/bin/asadmin\n     42:   command: \"/usr/bin/unzip -d /opt/glassfish glassfish-3.1.2.2.zip creates=/opt/glassfish/glassfish3/\"\n     43:   when: asadmin_stat.stat.exists == false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tungstenfabric_tf-ansible-deployer-playbooks-roles-contrail_deployer-defaults-main.yml", "content": "KEYSTONE_AUTH_ADMIN_USER: admin", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-contrail_deployer-defaults-main.yml\n\n- mesos\n- vcenter\n- none\ncontrail_configuration_keystone_default:\nKEYSTONE_AUTH_ADMIN_TENANT: admin\n9:   KEYSTONE_AUTH_ADMIN_USER: admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-contrail_deployer-defaults-main.yml\n# Target line: 9\n\n      4:   - mesos\n      5:   - vcenter\n      6:   - none\n      7: contrail_configuration_keystone_default:\n      8:   KEYSTONE_AUTH_ADMIN_TENANT: admin\n>>>   9:   KEYSTONE_AUTH_ADMIN_USER: admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml", "content": "key: this-file-does-not-exist-and-must-be-overridden", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n\ncert: this-file-does-not-exist-and-must-be-overridden\n2: key: this-file-does-not-exist-and-must-be-overridden", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-httpd-certificate-vars-main.yml\n# Target line: 2\n\n      1: cert: this-file-does-not-exist-and-must-be-overridden\n>>>   2: key: this-file-does-not-exist-and-must-be-overridden\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml", "content": "minio_access_key: sandbox-minio-access", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n\n# normal circumstances.\nminio_namespace: minio\nminio_credential_secret: minio-credentials\nminio_service_name: minio-service\nminio_route_name: minio\n49: minio_access_key: sandbox-minio-access\nminio_secret_key: sandbox-minio-secret\nminio_bucket_name: threescale\nminio_bucket_region: us-east-1\nminio_pvc_size: 1Gi\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-3scale-s3-defaults-main.yml\n# Target line: 49\n\n     44: # normal circumstances.\n     45: minio_namespace: minio\n     46: minio_credential_secret: minio-credentials\n     47: minio_service_name: minio-service\n     48: minio_route_name: minio\n>>>  49: minio_access_key: sandbox-minio-access\n     50: minio_secret_key: sandbox-minio-secret\n     51: minio_bucket_name: threescale\n     52: minio_bucket_region: us-east-1\n     53: minio_pvc_size: 1Gi\n     54: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Shwetas25_ansiblenew-jboss-standalone-site.yml", "content": "remote_user: ansible", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: Shwetas25_ansiblenew-jboss-standalone-site.yml\n\n---\n# This playbook deploys a simple standalone JBoss server.\n\n- hosts: all\n5:   remote_user: ansible\nsudo: yes\n\nroles:\n- jboss-standalone", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Shwetas25_ansiblenew-jboss-standalone-site.yml\n# Target line: 5\n\n      1: ---\n      2: # This playbook deploys a simple standalone JBoss server. \n      3: \n      4: - hosts: all\n>>>   5:   remote_user: ansible\n      6:   sudo: yes\n      7: \n      8:   roles:\n      9:     - jboss-standalone\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "paramasivamsathyaprakash_ansiblerepo-elk-provisioning-web-vars-main.yml", "content": "filebeat_ssl_key_file: elk-example.p8", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: paramasivamsathyaprakash_ansiblerepo-elk-provisioning-web-vars-main.yml\n\n\nfilebeat_output_logstash_enabled: true\nfilebeat_output_logstash_hosts:\n- \"logs.test:5044\"\n\n9: filebeat_ssl_key_file: elk-example.p8\nfilebeat_ssl_certificate_file: elk-example.crt\nfilebeat_ssl_insecure: \"true\"\n\nfilebeat_inputs:\n- type: log", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: paramasivamsathyaprakash_ansiblerepo-elk-provisioning-web-vars-main.yml\n# Target line: 9\n\n      4: \n      5: filebeat_output_logstash_enabled: true\n      6: filebeat_output_logstash_hosts:\n      7:   - \"logs.test:5044\"\n      8: \n>>>   9: filebeat_ssl_key_file: elk-example.p8\n     10: filebeat_ssl_certificate_file: elk-example.crt\n     11: filebeat_ssl_insecure: \"true\"\n     12: \n     13: filebeat_inputs:\n     14:   - type: log\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norbert_florin-vars-defaults.yml", "content": "selfoss_db_username: selfoss", "line": 108, "detection_span": [103, 113], "with_context": "# Ansible file: norbert_florin-vars-defaults.yml\n\n103: prosody_virtual_domain: \"{{ domain }}\"\n104: # prosody_accounts: (required)\n105:\n106: # news\n107: selfoss_domain: \"news.{{ domain }}\"\n108: selfoss_db_username: selfoss\n109: # selfoss_db_password: (required)\n110: selfoss_db_database: selfoss\n111:\n112: # git\n113: cgit_version: 0.10.1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: norbert_florin-vars-defaults.yml\n# Target line: 108\n\n    103: prosody_virtual_domain: \"{{ domain }}\"\n    104: # prosody_accounts: (required)\n    105: \n    106: # news\n    107: selfoss_domain: \"news.{{ domain }}\"\n>>> 108: selfoss_db_username: selfoss\n    109: # selfoss_db_password: (required)\n    110: selfoss_db_database: selfoss\n    111: \n    112: # git\n    113: cgit_version: 0.10.1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aruba_aruba-ansible-modules-example_playbooks-arubaos_controller-ap_whitelist_config.yml", "content": "verify_cert: True", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: aruba_aruba-ansible-modules-example_playbooks-arubaos_controller-ap_whitelist_config.yml\n\npassword: \"{{ mm_password }}\"\nmethod: \"{{ method_type }}\"\nconfig_path: \"{{ configuration_path }}\"\napi_name: wdb_cpsec_add_mac\ndata: { \"ap_name\": \"test_ap\", \"ap_group\": \"default\", \"name\": \"<ap-mac>\" }\n17:         verify_cert: True", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aruba_aruba-ansible-modules-example_playbooks-arubaos_controller-ap_whitelist_config.yml\n# Target line: 17\n\n     12:         password: \"{{ mm_password }}\"\n     13:         method: \"{{ method_type }}\"\n     14:         config_path: \"{{ configuration_path }}\"\n     15:         api_name: wdb_cpsec_add_mac\n     16:         data: { \"ap_name\": \"test_ap\", \"ap_group\": \"default\", \"name\": \"<ap-mac>\" }\n>>>  17:         verify_cert: True\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ansible-collections_community.zabbix-roles-zabbix_proxy-defaults-main.yml", "content": "zabbix_proxy_dbpassword: zabbix_proxy", "line": 85, "detection_span": [80, 90], "with_context": "# Ansible file: ansible-collections_community.zabbix-roles-zabbix_proxy-defaults-main.yml\n\nzabbix_proxy_dbcollation: utf8_bin\nzabbix_proxy_dbhost: localhost\nzabbix_proxy_dbname: zabbix_proxy\nzabbix_proxy_dbschema:\nzabbix_proxy_dbuser: zabbix_proxy\n85: zabbix_proxy_dbpassword: zabbix_proxy\nzabbix_proxy_dbsocket:\nzabbix_proxy_dbport: 5432\nzabbix_proxy_dbhost_run_install: true\nzabbix_proxy_privileged_host: localhost\nzabbix_proxy_localbuffer: 0          # Will be deprecated in 2.0.0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ansible-collections_community.zabbix-roles-zabbix_proxy-defaults-main.yml\n# Target line: 85\n\n     80: zabbix_proxy_dbcollation: utf8_bin\n     81: zabbix_proxy_dbhost: localhost\n     82: zabbix_proxy_dbname: zabbix_proxy\n     83: zabbix_proxy_dbschema:\n     84: zabbix_proxy_dbuser: zabbix_proxy\n>>>  85: zabbix_proxy_dbpassword: zabbix_proxy\n     86: zabbix_proxy_dbsocket:\n     87: zabbix_proxy_dbport: 5432\n     88: zabbix_proxy_dbhost_run_install: true\n     89: zabbix_proxy_privileged_host: localhost\n     90: zabbix_proxy_localbuffer: 0          # Will be deprecated in 2.0.0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml", "content": "matrix_mx_puppet_twitter_appservice_token: ''", "line": 60, "detection_span": [55, 65], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n\nmatrix_mx_puppet_twitter_systemd_required_services_list: ['docker.service']\n\n# List of systemd services that mx-puppet-twitter.service wants\nmatrix_mx_puppet_twitter_systemd_wanted_services_list: []\n\n60: matrix_mx_puppet_twitter_appservice_token: ''\nmatrix_mx_puppet_twitter_homeserver_token: ''\n\n# Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\nmatrix_mx_puppet_twitter_login_shared_secret: ''\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-bridge-mx-puppet-twitter-defaults-main.yml\n# Target line: 60\n\n     55: matrix_mx_puppet_twitter_systemd_required_services_list: ['docker.service']\n     56: \n     57: # List of systemd services that mx-puppet-twitter.service wants\n     58: matrix_mx_puppet_twitter_systemd_wanted_services_list: []\n     59: \n>>>  60: matrix_mx_puppet_twitter_appservice_token: ''\n     61: matrix_mx_puppet_twitter_homeserver_token: ''\n     62: \n     63: # Can be set to enable automatic double-puppeting via Shared Secret Auth (https://github.com/devture/matrix-synapse-shared-secret-auth).\n     64: matrix_mx_puppet_twitter_login_shared_secret: ''\n     65: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_htpasswd_certs_logging_infra.yml", "content": "- key: elasticsearch", "line": 109, "detection_span": [104, 114], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_htpasswd_certs_logging_infra.yml\n\n104:   total_replicas: 1\n105:   total_replicas_min: 1\n106:   total_replicas_max: 1\n107:   role: elasticsearch\n108:   taints:\n109:   - key: elasticsearch\nvalue: reserved\neffect: NoSchedule\n112:   - key: elasticsearch\nvalue: reserved\neffect: NoExecute", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_htpasswd_certs_logging_infra.yml\n# Target line: 109\n\n    104:   total_replicas: 1\n    105:   total_replicas_min: 1\n    106:   total_replicas_max: 1\n    107:   role: elasticsearch\n    108:   taints:\n>>> 109:   - key: elasticsearch\n    110:     value: reserved\n    111:     effect: NoSchedule\n    112:   - key: elasticsearch\n    113:     value: reserved\n    114:     effect: NoExecute\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "neki06_kolla-ansible-ansible-roles-watcher-defaults-main.yml", "content": "watcher_keystone_user: \"watcher\"", "line": 69, "detection_span": [64, 74], "with_context": "# Ansible file: neki06_kolla-ansible-ansible-roles-watcher-defaults-main.yml\n\nwatcher_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ watcher_api_port }}\"\nwatcher_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ watcher_api_port }}\"\n\nwatcher_logging_debug: \"{{ openstack_logging_debug }}\"\n\n69: watcher_keystone_user: \"watcher\"\n\nopenstack_watcher_auth: \"{{ openstack_auth }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: neki06_kolla-ansible-ansible-roles-watcher-defaults-main.yml\n# Target line: 69\n\n     64: watcher_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ watcher_api_port }}\"\n     65: watcher_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn }}:{{ watcher_api_port }}\"\n     66: \n     67: watcher_logging_debug: \"{{ openstack_logging_debug }}\"\n     68: \n>>>  69: watcher_keystone_user: \"watcher\"\n     70: \n     71: openstack_watcher_auth: \"{{ openstack_auth }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "henrysher_fedora-infra-ansible-playbooks-manual-staging-sync-koji.yml", "content": "- postgresql_user: name=backup", "line": 69, "detection_span": [64, 74], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-playbooks-manual-staging-sync-koji.yml\n\n- template: src=templates/koji-reset-staging.sql dest=/var/lib/pgsql/koji-reset-staging.sql\ntags:\n- db-sync-script\n\n- postgresql_user: name=koji password={{ kojiPassword }}\n69:   - postgresql_user: name=backup\n- postgresql_db: name=koji state=absent\n# buildroot_listing is excluded from the sync to save some time\n# TODO: install mbuffer on db-koji.stg\n- name: Import the prod db.  This will take quite a while.  Go get a snack!\nshell: >", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-playbooks-manual-staging-sync-koji.yml\n# Target line: 69\n\n     64:   - template: src=templates/koji-reset-staging.sql dest=/var/lib/pgsql/koji-reset-staging.sql\n     65:     tags:\n     66:     - db-sync-script\n     67: \n     68:   - postgresql_user: name=koji password={{ kojiPassword }}\n>>>  69:   - postgresql_user: name=backup\n     70:   - postgresql_db: name=koji state=absent\n     71: # buildroot_listing is excluded from the sync to save some time\n     72: # TODO: install mbuffer on db-koji.stg\n     73:   - name: Import the prod db.  This will take quite a while.  Go get a snack!\n     74:     shell: >\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "EMCECS_ECS-CommunityEdition-examples-local-lab-4-node-deploy.yml", "content": "is_system_admin: true", "line": 147, "detection_span": [142, 152], "with_context": "# Ansible file: EMCECS_ECS-CommunityEdition-examples-local-lab-4-node-deploy.yml\n\n142:   # Management Users\n143:   management_users:\n- username: admin1\npassword: ChangeMe\noptions:\n147:         is_system_admin: true\n- username: monitor1\npassword: ChangeMe\noptions:\nis_system_monitor: true\n152:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: EMCECS_ECS-CommunityEdition-examples-local-lab-4-node-deploy.yml\n# Target line: 147\n\n    142:   # Management Users\n    143:   management_users:\n    144:     - username: admin1\n    145:       password: ChangeMe\n    146:       options:\n>>> 147:         is_system_admin: true\n    148:     - username: monitor1\n    149:       password: ChangeMe\n    150:       options:\n    151:         is_system_monitor: true\n    152: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ArkCase_arkcase-ce-vagrant-provisioning-roles-alfresco-ee-tasks-main.yml", "content": "become_user: alfresco", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-alfresco-ee-tasks-main.yml\n\n# downloaded.  However, since we are downloading a specific version,\n# we can just check whether the file already exists before downloading it\n\n- name: see if Alfresco EE content services already downloaded\nbecome: yes\n9:   become_user: alfresco\nstat:\npath: \"{{ root_folder }}/install/alfresco/alfresco-content-services-distribution-{{ alfresco_ee_version}}.zip\"\nregister: content_services_download\n\n- name: retrieve Alfresco EE ACS distribution zip file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArkCase_arkcase-ce-vagrant-provisioning-roles-alfresco-ee-tasks-main.yml\n# Target line: 9\n\n      4: # downloaded.  However, since we are downloading a specific version,\n      5: # we can just check whether the file already exists before downloading it\n      6: \n      7: - name: see if Alfresco EE content services already downloaded\n      8:   become: yes\n>>>   9:   become_user: alfresco\n     10:   stat:\n     11:     path: \"{{ root_folder }}/install/alfresco/alfresco-content-services-distribution-{{ alfresco_ee_version}}.zip\"\n     12:   register: content_services_download  \n     13: \n     14: - name: retrieve Alfresco EE ACS distribution zip file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml", "content": "ansible_user: ec2-user", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n\nhosts:\n13.232.25.155:\nansible_become: 'yes'\nansible_become_pass: password\nansible_ssh_pass: password\n19:           ansible_user: ec2-user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n# Target line: 19\n\n     14:       hosts:\n     15:         13.232.25.155:\n     16:           ansible_become: 'yes'\n     17:           ansible_become_pass: password\n     18:           ansible_ssh_pass: password\n>>>  19:           ansible_user: ec2-user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml", "content": "- key: \"api_url\"", "line": 79, "detection_span": [74, 84], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n\nvalue: \"{{ env_type }}-{{ email }}\"\n- key: \"api_user\"\nvalue: \"{{ osp_auth_username_member }}\"\n- key: \"api_pass\"\nvalue: \"{{ osp_auth_password_member }}\"\n79:       - key: \"api_url\"\nvalue: \"{{ osp_auth_url }}\"\n- key: \"project_name\"\nvalue: \"{{ osp_project_name }}\"\n- key: \"pxe_image\"\nvalue: \"pxeboot\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n# Target line: 79\n\n     74:         value: \"{{ env_type }}-{{ email }}\"\n     75:       - key: \"api_user\"\n     76:         value: \"{{ osp_auth_username_member }}\"\n     77:       - key: \"api_pass\"\n     78:         value: \"{{ osp_auth_password_member }}\"\n>>>  79:       - key: \"api_url\"\n     80:         value: \"{{ osp_auth_url }}\"\n     81:       - key: \"project_name\"\n     82:         value: \"{{ osp_project_name }}\"\n     83:       - key: \"pxe_image\"\n     84:         value: \"pxeboot\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aristanetworks_ansible-cvp-ansible_collections-arista-cvp-molecule-cv_device-inventory-hosts.yml", "content": "ansible_user: root", "line": 7, "detection_span": [2, 12], "with_context": "# Ansible file: aristanetworks_ansible-cvp-ansible_collections-arista-cvp-molecule-cv_device-inventory-hosts.yml\n\nall:\nchildren:\nCVP:\nhosts:\ncv_server:\n7:           ansible_user: root", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-cvp-ansible_collections-arista-cvp-molecule-cv_device-inventory-hosts.yml\n# Target line: 7\n\n      2: all:\n      3:   children:\n      4:     CVP:\n      5:       hosts:\n      6:         cv_server:\n>>>   7:           ansible_user: root\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Boes-man_ansible-galaxy-molecule-ec2_centos7-molecule.yml", "content": "ssh_user: centos", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: Boes-man_ansible-galaxy-molecule-ec2_centos7-molecule.yml\n\n- dcos\n- name: agent1-centos7\nimage: ami-9887c6e7\nregion: us-east-1\ninstance_type: m5.large\n27:     ssh_user: centos\ngroups:\n- agents_private\n- agents\n- dcos\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Boes-man_ansible-galaxy-molecule-ec2_centos7-molecule.yml\n# Target line: 27\n\n     22:       - dcos\n     23:   - name: agent1-centos7\n     24:     image: ami-9887c6e7\n     25:     region: us-east-1\n     26:     instance_type: m5.large\n>>>  27:     ssh_user: centos\n     28:     groups:\n     29:       - agents_private\n     30:       - agents\n     31:       - dcos\n     32: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "TerryHowe_ansible-modules-hashivault-functional-test_not_there.yml", "content": "key: 'value'", "line": 51, "detection_span": [46, 56], "with_context": "# Ansible file: TerryHowe_ansible-modules-hashivault-functional-test_not_there.yml\n\nothervalue: 'one'\n\n- name: Nonexistent key with default\nhashivault_read:\nsecret: '{{secret_name}}'\n51:         key: 'value'\ndefault: 'better'\nregister: 'vault_read'\n- assert: { that: \"'{{vault_read.value}}' == 'better'\" }\n\n- set_fact:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: TerryHowe_ansible-modules-hashivault-functional-test_not_there.yml\n# Target line: 51\n\n     46:             othervalue: 'one'\n     47: \n     48:     - name: Nonexistent key with default\n     49:       hashivault_read:\n     50:         secret: '{{secret_name}}'\n>>>  51:         key: 'value'\n     52:         default: 'better'\n     53:       register: 'vault_read'\n     54:     - assert: { that: \"'{{vault_read.value}}' == 'better'\" }\n     55: \n     56:     - set_fact:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_infra-ansible-inventory-idm-server-group_vars-all.yml", "content": "key_secret: 'key_secret'", "line": 16, "detection_span": [11, 21], "with_context": "# Ansible file: redhat-cop_infra-ansible-inventory-idm-server-group_vars-all.yml\n\nstate: present\nnamed: True\nnsupdate:\n- server: \"dns_server_ip\"\nkey_name: \"dns_zone_key_name\"\n16:               key_secret: 'key_secret'\nkey_algorithm: 'hmac-sha256'\nentries:\n- type: A\nrecord: \"idm.subdomain\"\nvalue: \"{{ hostvars['idm.subdomain']['openstack']['private_v4'] }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_infra-ansible-inventory-idm-server-group_vars-all.yml\n# Target line: 16\n\n     11:           state: present\n     12:           named: True\n     13:           nsupdate:\n     14:             - server: \"dns_server_ip\"\n     15:               key_name: \"dns_zone_key_name\"\n>>>  16:               key_secret: 'key_secret'\n     17:               key_algorithm: 'hmac-sha256'\n     18:           entries:\n     19:             - type: A\n     20:               record: \"idm.subdomain\"\n     21:               value: \"{{ hostvars['idm.subdomain']['openstack']['private_v4'] }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-tasks-generate_install_config.yml", "content": "path: /home/{{ ansible_user }}/.ssh/id_rsa.pub", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-tasks-generate_install_config.yml\n\nargs:\ncreates: /home/{{ ansible_user }}/.ssh/id_rsa.pub\n\n- name: Slurp public key\nslurp:\n13:     path: /home/{{ ansible_user }}/.ssh/id_rsa.pub\nregister: idrsapub\n\n- name: Create cluster directory\nfile:\npath: /home/{{ ansible_user }}/{{ cluster_name }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-tasks-generate_install_config.yml\n# Target line: 13\n\n      8:   args:\n      9:     creates: /home/{{ ansible_user }}/.ssh/id_rsa.pub\n     10: \n     11: - name: Slurp public key\n     12:   slurp:\n>>>  13:     path: /home/{{ ansible_user }}/.ssh/id_rsa.pub\n     14:   register: idrsapub\n     15: \n     16: - name: Create cluster directory\n     17:   file:\n     18:     path: /home/{{ ansible_user }}/{{ cluster_name }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-host_vars-prod-rabbit.usegalaxy.org.au.yml", "content": "- user: admin", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: usegalaxy-au_infrastructure-host_vars-prod-rabbit.usegalaxy.org.au.yml\n\n\n\n# Host specific Rabbit settings\nrabbitmq_users:\n5:   - user: admin\npassword: \"{{ rabbitmq_password_admin }}\"\ntags: administrator\nvhost: /\n- user: telegraf\npassword: \"{{ rabbitmq_password_telegraf }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-host_vars-prod-rabbit.usegalaxy.org.au.yml\n# Target line: 5\n\n      1: \n      2: \n      3: # Host specific Rabbit settings\n      4: rabbitmq_users:\n>>>   5:   - user: admin\n      6:     password: \"{{ rabbitmq_password_admin }}\"\n      7:     tags: administrator\n      8:     vhost: /\n      9:   - user: telegraf\n     10:     password: \"{{ rabbitmq_password_telegraf }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "oidcng_api_metadata_push_password: secret", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nmyconext: secret\n\nmongo_admin_password: secret\n\nengine_api_metadata_push_password: secret\n26: oidcng_api_metadata_push_password: secret\noidcng_api_tokens_profile_password: secret\noidcng_api_tokens_eduid_password: secret\nmyconext_api_attribute_manipulation_password: secret\nmyconext_oidcng_rs_client_secret: secret\nmyconext_api_attribute_aggregation_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 26\n\n     21:    myconext: secret\n     22: \n     23: mongo_admin_password: secret\n     24: \n     25: engine_api_metadata_push_password: secret\n>>>  26: oidcng_api_metadata_push_password: secret\n     27: oidcng_api_tokens_profile_password: secret\n     28: oidcng_api_tokens_eduid_password: secret\n     29: myconext_api_attribute_manipulation_password: secret\n     30: myconext_oidcng_rs_client_secret: secret\n     31: myconext_api_attribute_aggregation_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ComplianceAsCode_content-products-jre-product.yml", "content": "profiles_root: \"./profiles\"", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n\ntype: product\n\nbenchmark_id: JRE\nbenchmark_root: \"./guide\"\n\n8: profiles_root: \"./profiles\"\n\npkg_manager: \"yum\"\n\ncpes_root: \"../../shared/applicability\"\ncpes:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ComplianceAsCode_content-products-jre-product.yml\n# Target line: 8\n\n      3: type: product\n      4: \n      5: benchmark_id: JRE\n      6: benchmark_root: \"./guide\"\n      7: \n>>>   8: profiles_root: \"./profiles\"\n      9: \n     10: pkg_manager: \"yum\"\n     11: \n     12: cpes_root: \"../../shared/applicability\"\n     13: cpes:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-all.yml", "content": "key: files/keys/gareth.pub", "line": 38, "detection_span": [33, 43], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n\nkey: files/keys/mike.pub\nemail: \"{{ mike_email }}\"\n- name: gareth\nroles:\n- galaxy_admin\n38:       key: files/keys/gareth.pub\nemail: \"{{ gareth_email }}\"\n- name: jenkins_bot\nroles:\n- sudo\n- galaxy_admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n# Target line: 38\n\n     33:       key: files/keys/mike.pub\n     34:       email: \"{{ mike_email }}\"\n     35:     - name: gareth\n     36:       roles:\n     37:         - galaxy_admin\n>>>  38:       key: files/keys/gareth.pub\n     39:       email: \"{{ gareth_email }}\"\n     40:     - name: jenkins_bot\n     41:       roles:\n     42:         - sudo\n     43:         - galaxy_admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Alfresco_alfresco-ansible-deployment-molecule-manual-activemq-hosts.yml", "content": "activemq_username: alfresco", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: Alfresco_alfresco-ansible-deployment-molecule-manual-activemq-hosts.yml\n\nexternal:\nchildren:\nexternal_activemq:\nhosts:\nwhatever.mq.eu-west-1.amazonaws.com:\n8:               activemq_username: alfresco\nactivemq_password: alfresco\nactivemq_port: 61617", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Alfresco_alfresco-ansible-deployment-molecule-manual-activemq-hosts.yml\n# Target line: 8\n\n      3:     external:\n      4:       children:\n      5:         external_activemq:\n      6:           hosts:\n      7:             whatever.mq.eu-west-1.amazonaws.com:\n>>>   8:               activemq_username: alfresco\n      9:               activemq_password: alfresco\n     10:               activemq_port: 61617\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_openstack-ansible-os_keystone-examples-playbook.yml", "content": "keystone_oslomsg_rpc_userid: keystone", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: openstack_openstack-ansible-os_keystone-examples-playbook.yml\n\nkeystone_container_mysql_password: \"SuperSecrete\"\nkeystone_oslomsg_rpc_transport: rabbit\nkeystone_oslomsg_rpc_servers: 10.100.100.101\nkeystone_oslomsg_rpc_port: 5671\nkeystone_oslomsg_rpc_use_ssl: true\n23:     keystone_oslomsg_rpc_userid: keystone\nkeystone_oslomsg_rpc_vhost: /keystone\nkeystone_oslomsg_notify_transport: rabbit\nkeystone_oslomsg_notify_servers: 10.100.100.101\nkeystone_oslomsg_notify_port: 5671\nkeystone_oslomsg_notify_use_ssl: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_openstack-ansible-os_keystone-examples-playbook.yml\n# Target line: 23\n\n     18:     keystone_container_mysql_password: \"SuperSecrete\"\n     19:     keystone_oslomsg_rpc_transport: rabbit\n     20:     keystone_oslomsg_rpc_servers: 10.100.100.101\n     21:     keystone_oslomsg_rpc_port: 5671\n     22:     keystone_oslomsg_rpc_use_ssl: true\n>>>  23:     keystone_oslomsg_rpc_userid: keystone\n     24:     keystone_oslomsg_rpc_vhost: /keystone\n     25:     keystone_oslomsg_notify_transport: rabbit\n     26:     keystone_oslomsg_notify_servers: 10.100.100.101\n     27:     keystone_oslomsg_notify_port: 5671\n     28:     keystone_oslomsg_notify_use_ssl: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "FrostyX_fedora-infra-ansible-playbooks-manual-rebuild-fedora-packages.yml", "content": "become_user: apache", "line": 50, "detection_span": [45, 55], "with_context": "# Ansible file: FrostyX_fedora-infra-ansible-playbooks-manual-rebuild-fedora-packages.yml\n\n- name: Rebuild that search index on the side and install it. (just prod)\nhosts: packages\ntags: rebuild-prod-index\nuser: root\nbecome: True\n50:   become_user: apache\ngather_facts: False\n\nvars_files:\n- /srv/web/infra/ansible/vars/global.yml\n- \"{{ private }}/vars.yml\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: FrostyX_fedora-infra-ansible-playbooks-manual-rebuild-fedora-packages.yml\n# Target line: 50\n\n     45: - name: Rebuild that search index on the side and install it. (just prod)\n     46:   hosts: packages\n     47:   tags: rebuild-prod-index\n     48:   user: root\n     49:   become: True\n>>>  50:   become_user: apache\n     51:   gather_facts: False\n     52: \n     53:   vars_files: \n     54:    - /srv/web/infra/ansible/vars/global.yml\n     55:    - \"{{ private }}/vars.yml\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sivabayya_ansible-provisioner-roles-manage_ec2_instances-tasks-inventory-addhost_windows.yml", "content": "ansible_user: \"Administrator\"", "line": 100, "detection_span": [95, 105], "with_context": "# Ansible file: sivabayya_ansible-provisioner-roles-manage_ec2_instances-tasks-inventory-addhost_windows.yml\n\nhostname: \"student{{ item.item.tags.Student | regex_replace('[^0-9]', '') }}-win2\"\nshort_name: \"{{ item.item.tags.short_name }}\"\nansible_host: \"{{ item.item.public_ip_address }}\"\nprivate_ip: \"{{ item.item.private_ip_address }}\"\nansible_port: 5986\n100:     ansible_user: \"Administrator\"\nansible_password: \"{{ item.win_password }}\"\nansible_become_password: \"{{ admin_password }}\"\nansible_connection: \"winrm\"\nansible_winrm_transport: \"ntlm\"\nansible_winrm_server_cert_validation: \"ignore\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sivabayya_ansible-provisioner-roles-manage_ec2_instances-tasks-inventory-addhost_windows.yml\n# Target line: 100\n\n     95:     hostname: \"student{{ item.item.tags.Student | regex_replace('[^0-9]', '') }}-win2\"\n     96:     short_name: \"{{ item.item.tags.short_name }}\"\n     97:     ansible_host: \"{{ item.item.public_ip_address }}\"\n     98:     private_ip: \"{{ item.item.private_ip_address }}\"\n     99:     ansible_port: 5986\n>>> 100:     ansible_user: \"Administrator\"\n    101:     ansible_password: \"{{ item.win_password }}\"\n    102:     ansible_become_password: \"{{ admin_password }}\"\n    103:     ansible_connection: \"winrm\"\n    104:     ansible_winrm_transport: \"ntlm\"\n    105:     ansible_winrm_server_cert_validation: \"ignore\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "crv4all_openshift-ansible-roles-openshift_manageiq-vars-main.yml", "content": "user: management-admin", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: crv4all_openshift-ansible-roles-openshift_manageiq-vars-main.yml\n\n---\nmanage_iq_tasks:\n- resource_kind: role\nresource_name: admin\n5:   user: management-admin\n- resource_kind: role\nresource_name: admin\nuser: system:serviceaccount:management-infra:management-admin\n- resource_kind: cluster-role\nresource_name: management-infra-admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-roles-openshift_manageiq-vars-main.yml\n# Target line: 5\n\n      1: ---\n      2: manage_iq_tasks:\n      3: - resource_kind: role\n      4:   resource_name: admin\n>>>   5:   user: management-admin\n      6: - resource_kind: role\n      7:   resource_name: admin\n      8:   user: system:serviceaccount:management-infra:management-admin\n      9: - resource_kind: cluster-role\n     10:   resource_name: management-infra-admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "BCDevOps_platform-services-tools-github-backups-cron-github-backups.yml", "content": "key: secret", "line": 40, "detection_span": [35, 45], "with_context": "# Ansible file: BCDevOps_platform-services-tools-github-backups-cron-github-backups.yml\n\nkey: id\n- name: S3_SECRET\nvalueFrom:\nsecretKeyRef:\nname: github-backups-s3-creds\n40:                       key: secret\n- name: S3_URL\nvalueFrom:\nsecretKeyRef:\nname: github-backups-s3-creds\nkey: URL", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: BCDevOps_platform-services-tools-github-backups-cron-github-backups.yml\n# Target line: 40\n\n     35:                       key: id\n     36:                 - name: S3_SECRET\n     37:                   valueFrom:\n     38:                     secretKeyRef:\n     39:                       name: github-backups-s3-creds\n>>>  40:                       key: secret\n     41:                 - name: S3_URL\n     42:                   valueFrom:\n     43:                     secretKeyRef:\n     44:                       name: github-backups-s3-creds\n     45:                       key: URL\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml", "content": "control_center_ldap_user: control_center", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n\nkafka_connect_ldap_password: password\nksql_ldap_user: ksql\nksql_ldap_password: password\nkafka_rest_ldap_user: rest_proxy\nkafka_rest_ldap_password: password\n49:     control_center_ldap_user: control_center\ncontrol_center_ldap_password: password\n\nkafka_broker_custom_listeners:\nclient:\nname: CLIENT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n# Target line: 49\n\n     44:     kafka_connect_ldap_password: password\n     45:     ksql_ldap_user: ksql\n     46:     ksql_ldap_password: password\n     47:     kafka_rest_ldap_user: rest_proxy\n     48:     kafka_rest_ldap_password: password\n>>>  49:     control_center_ldap_user: control_center\n     50:     control_center_ldap_password: password\n     51: \n     52:     kafka_broker_custom_listeners:\n     53:       client:\n     54:         name: CLIENT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ManageIQ_manageiq-config-messaging.kafka.yml", "content": "password: smartvm", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: ManageIQ_manageiq-config-messaging.kafka.yml\n\n---\nbase: &base\nhostname: localhost\nport: 9092\nusername: admin\n6:   password: smartvm\n\ndevelopment:\n<<: *base\n\nproduction:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ManageIQ_manageiq-config-messaging.kafka.yml\n# Target line: 6\n\n      1: ---\n      2: base: &base\n      3:   hostname: localhost\n      4:   port: 9092\n      5:   username: admin\n>>>   6:   password: smartvm\n      7: \n      8: development:\n      9:   <<: *base\n     10: \n     11: production:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloudera_cloudera-playbook-group_vars-db_server.yml", "content": "pass: 'navms_password'", "line": 41, "detection_span": [36, 46], "with_context": "# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n\npass: 'nav_password'\ntype: '{{ database_type }}'\nnavms:\nname: 'navms'\nuser: 'navms'\n41:     pass: 'navms_password'\ntype: '{{ database_type }}'\nmetastore:\nname: 'metastore'\nuser: 'hive'\npass: 'hive_password'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudera_cloudera-playbook-group_vars-db_server.yml\n# Target line: 41\n\n     36:     pass: 'nav_password'\n     37:     type: '{{ database_type }}'\n     38:   navms:\n     39:     name: 'navms'\n     40:     user: 'navms'\n>>>  41:     pass: 'navms_password'\n     42:     type: '{{ database_type }}'\n     43:   metastore:\n     44:     name: 'metastore'\n     45:     user: 'hive'\n     46:     pass: 'hive_password'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "EnterpriseDB_edb-ansible-roles-setup_pemagent-defaults-main.yml", "content": "pg_pem_agent_password: \"\"", "line": 11, "detection_span": [6, 16], "with_context": "# Ansible file: EnterpriseDB_edb-ansible-roles-setup_pemagent-defaults-main.yml\n\npass_dir: \"~/.edb\"\nefm_enabled: True\npg_pem_admin_user: \"pemadmin\"\npg_pem_admin_password: \"\"\npg_pem_agent_user: \"pemagent\"\n11: pg_pem_agent_password: \"\"\npg_ssl: true\n\npem_server_exists: false\n# efm information\nefm_version: \"4.4\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: EnterpriseDB_edb-ansible-roles-setup_pemagent-defaults-main.yml\n# Target line: 11\n\n      6: pass_dir: \"~/.edb\"\n      7: efm_enabled: True\n      8: pg_pem_admin_user: \"pemadmin\"\n      9: pg_pem_admin_password: \"\"\n     10: pg_pem_agent_user: \"pemagent\"\n>>>  11: pg_pem_agent_password: \"\"\n     12: pg_ssl: true\n     13: \n     14: pem_server_exists: false\n     15: # efm information\n     16: efm_version: \"4.4\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-all.yml", "content": "key: files/keys/nuwan.pub", "line": 50, "detection_span": [45, 55], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n\nemail: \"{{ jenkins_bot_email }}\" # this is not a real email address and will cause issues if validation is required\n- name: nuwan\nroles:\n- sudo\n- galaxy_admin\n50:       key: files/keys/nuwan.pub\ngalaxy_admin: true\nemail: \"{{ nuwan_email }}\"\n- name: justin\nroles:\n- sudo", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n# Target line: 50\n\n     45:       email: \"{{ jenkins_bot_email }}\" # this is not a real email address and will cause issues if validation is required\n     46:     - name: nuwan\n     47:       roles:\n     48:         - sudo\n     49:         - galaxy_admin\n>>>  50:       key: files/keys/nuwan.pub\n     51:       galaxy_admin: true\n     52:       email: \"{{ nuwan_email }}\"\n     53:     - name: justin\n     54:       roles:\n     55:         - sudo\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml", "content": "ansible_become_pass: password", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n\nungrouped: {}\nweb:\nhosts:\n13.232.25.155:\nansible_become: 'yes'\n17:           ansible_become_pass: password\nansible_ssh_pass: password\nansible_user: ec2-user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: devopsschool-training-notes_Ansible-astrazeneca-June-2020-Lakshminarayanan-inventory.yaml\n# Target line: 17\n\n     12:     ungrouped: {}\n     13:     web:\n     14:       hosts:\n     15:         13.232.25.155:\n     16:           ansible_become: 'yes'\n>>>  17:           ansible_become_pass: password\n     18:           ansible_ssh_pass: password\n     19:           ansible_user: ec2-user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-osp-satellite-vm-sample_vars.yml", "content": "admin_user: gucore", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-osp-satellite-vm-sample_vars.yml\n\nproject: dev-ansible-tower-implementation-3.3-v6\n#project: EMEA-PC-azure-gold-image-bp\n\ncloud_provider: osp\n\n10: admin_user: gucore\n\nstudent_name: guillaume\n\n\nexternal_network: ee9d9e11-9f4b-4b78-8802-3d3e670ca0f0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-osp-satellite-vm-sample_vars.yml\n# Target line: 10\n\n      5: project: dev-ansible-tower-implementation-3.3-v6\n      6: #project: EMEA-PC-azure-gold-image-bp\n      7: \n      8: cloud_provider: osp\n      9: \n>>>  10: admin_user: gucore\n     11: \n     12: student_name: guillaume\n     13: \n     14: \n     15: external_network: ee9d9e11-9f4b-4b78-8802-3d3e670ca0f0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-ccnrd-stable-defaults-main.yml", "content": "workshop_che_user_password: 'r3dh4t1!'", "line": 23, "detection_span": [18, 28], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-ccnrd-stable-defaults-main.yml\n\ngogs_pwd: 'r3dh4t1!'\n\nworkshop_openshift_user_name: userXX\nworkshop_openshift_user_password: 'r3dh4t1!'\nworkshop_che_user_name: userXX\n23: workshop_che_user_password: 'r3dh4t1!'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-ccnrd-stable-defaults-main.yml\n# Target line: 23\n\n     18: gogs_pwd: 'r3dh4t1!'\n     19: \n     20: workshop_openshift_user_name: userXX\n     21: workshop_openshift_user_password: 'r3dh4t1!'\n     22: workshop_che_user_name: userXX\n>>>  23: workshop_che_user_password: 'r3dh4t1!'\n     24: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "splunk_splunk-ansible-roles-splunk_standalone-molecule-apps-group_vars-all.yml", "content": "password: helloworld", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: splunk_splunk-ansible-roles-splunk_standalone-molecule-apps-group_vars-all.yml\n\napps_location:\n- http://nginx/splunk_app_simple.tgz\n- /tmp/splunk_app_httpexample.tgz\nhec:\ntoken: abcd1234\n10:   password: helloworld\ndisable_popups: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: splunk_splunk-ansible-roles-splunk_standalone-molecule-apps-group_vars-all.yml\n# Target line: 10\n\n      5:   apps_location:\n      6:     - http://nginx/splunk_app_simple.tgz\n      7:     - /tmp/splunk_app_httpexample.tgz\n      8:   hec:\n      9:     token: abcd1234\n>>>  10:   password: helloworld\n     11:   disable_popups: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "vijaykakkar_ansible-automation-exercises-ansible_network-supplemental-parsers-show_ip_interfaces.yaml", "content": "- key: data", "line": 19, "detection_span": [14, 24], "with_context": "# Ansible file: vijaykakkar_ansible-automation-exercises-ansible_network-supplemental-parsers-show_ip_interfaces.yaml\n\n- name: GENERATE JSON DATA STRUCTURE\njson_template:\ntemplate:\n- key: \"{{ item.matches.0 }}\"\nobject:\n19:         - key: data\nobject:\n- key: name\nvalue: \"{{ item.matches.0 }}\"\n- key: ip\nvalue: \"{{ item.matches.1 }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: vijaykakkar_ansible-automation-exercises-ansible_network-supplemental-parsers-show_ip_interfaces.yaml\n# Target line: 19\n\n     14: - name: GENERATE JSON DATA STRUCTURE\n     15:   json_template:\n     16:     template:\n     17:       - key: \"{{ item.matches.0 }}\"\n     18:         object:\n>>>  19:         - key: data\n     20:           object:\n     21:             - key: name\n     22:               value: \"{{ item.matches.0 }}\"\n     23:             - key: ip\n     24:               value: \"{{ item.matches.1 }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "prasha94_ansible-windows-create-user.yml", "content": "password: \"@ns1bl3\"", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: prasha94_ansible-windows-create-user.yml\n\ngather_facts: false\ntasks:\n- name: Add User\nwin_user:\nname: ansible\n9:         password: \"@ns1bl3\"\nstate: present", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: prasha94_ansible-windows-create-user.yml\n# Target line: 9\n\n      4:   gather_facts: false\n      5:   tasks:\n      6:     - name: Add User\n      7:       win_user:\n      8:         name: ansible\n>>>   9:         password: \"@ns1bl3\"\n     10:         state: present\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-serverless-defaults-main.yaml", "content": "ocp4_workload_dil_serverless_user_access_token: \"hybridcloud\"", "line": 22, "detection_span": [17, 27], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-serverless-defaults-main.yaml\n\nocp4_workload_dil_serverless_system_storage_size: '100Mi'\n\n#  user_registration\nocp4_workload_dil_serverless_lab_title: \"Serverless Workshop\"\nocp4_workload_dil_serverless_username_prefix: \"user\"\n22: ocp4_workload_dil_serverless_user_access_token: \"hybridcloud\"\n\n# provision_shared\nocp4_workload_dil_serverless_num_zk_nodes: 3\nocp4_workload_dil_serverless_num_kafka_brokers: 3\nocp4_workload_dil_serverless_kafka_namespace: 'kafka'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-serverless-defaults-main.yaml\n# Target line: 22\n\n     17: ocp4_workload_dil_serverless_system_storage_size: '100Mi'\n     18: \n     19: #  user_registration\n     20: ocp4_workload_dil_serverless_lab_title: \"Serverless Workshop\"\n     21: ocp4_workload_dil_serverless_username_prefix: \"user\"\n>>>  22: ocp4_workload_dil_serverless_user_access_token: \"hybridcloud\"\n     23: \n     24: # provision_shared\n     25: ocp4_workload_dil_serverless_num_zk_nodes: 3\n     26: ocp4_workload_dil_serverless_num_kafka_brokers: 3\n     27: ocp4_workload_dil_serverless_kafka_namespace: 'kafka'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chz8494_tdlab-openstack-playbooks-os-glance-install.yml", "content": "glance_galera_user: glance", "line": 92, "detection_span": [87, 97], "with_context": "# Ansible file: chz8494_tdlab-openstack-playbooks-os-glance-install.yml\n\n- role: \"system_crontab_coordination\"\ntags:\n- crontab\nvars:\nis_metal: \"{{ properties.is_metal|default(false) }}\"\n92:     glance_galera_user: glance\nglance_galera_database: glance\nglance_galera_address: \"{{ galera_address }}\"\ntags:\n- glance", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: chz8494_tdlab-openstack-playbooks-os-glance-install.yml\n# Target line: 92\n\n     87:     - role: \"system_crontab_coordination\"\n     88:       tags:\n     89:         - crontab\n     90:   vars:\n     91:     is_metal: \"{{ properties.is_metal|default(false) }}\"\n>>>  92:     glance_galera_user: glance\n     93:     glance_galera_database: glance\n     94:     glance_galera_address: \"{{ galera_address }}\"\n     95:   tags:\n     96:     - glance\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "nova_service_password: 054e7b1078a9f2cd", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nneutron_service_password: 5043b5b40b09d31781afe9704\nnova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\nnova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n34: nova_service_password: 054e7b1078a9f2cd\nnova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\nnova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\nrabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\nrabbitmq_password: b763ef86fce7338e145c9c8c\nswift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 34\n\n     29: neutron_service_password: 5043b5b40b09d31781afe9704\n     30: nova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\n     31: nova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n>>>  34: nova_service_password: 054e7b1078a9f2cd\n     35: nova_v21_service_password: 5cdb440ee434d1896d026bf00d7160c6008f63a21ca57a4c7e75b9a7c5985\n     36: nova_v3_service_password: 0d34e76d18cce9781a9f3c65e7663ba2d765ca6652c\n     37: rabbitmq_cookie_token: ec503f12b2e5ad80e477ed93a2013ae123aac4671a51ab2f78e78bb713d5eed899248\n     38: rabbitmq_password: b763ef86fce7338e145c9c8c\n     39: swift_container_mysql_password: 0fd1397bc6ebb0bfc522e37a3c0f36b0d1b9f7e72b05a2bb36bf858fc85a\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sivabayya_ansible-provisioner-sample_workshops-sample-vars-demo.yml", "content": "admin_password: ansible", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: sivabayya_ansible-provisioner-sample_workshops-sample-vars-demo.yml\n\nstudent_total: 1\n# workshop is put into isecurity mode\nworkshop_type: 'demo'\nsecurity_console: 'qradar'\n## Optional Variables\n12: admin_password: ansible\nwindows_password: Ansible+Red*Hat19!20\ntowerinstall: true\ndemo: all\ncreate_cluster: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sivabayya_ansible-provisioner-sample_workshops-sample-vars-demo.yml\n# Target line: 12\n\n      7: student_total: 1\n      8: # workshop is put into isecurity mode\n      9: workshop_type: 'demo'\n     10: security_console: 'qradar'\n     11: ## Optional Variables\n>>>  12: admin_password: ansible\n     13: windows_password: Ansible+Red*Hat19!20\n     14: towerinstall: true\n     15: demo: all\n     16: create_cluster: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "contiv_ansible-roles-ceph-osd-defaults-main.yml", "content": "ceph_osd_docker_username: ceph", "line": 112, "detection_span": [107, 117], "with_context": "# Ansible file: contiv_ansible-roles-ceph-osd-defaults-main.yml\n\n107: ##########\n108: # DOCKER #\n109: ##########\n110:\n111: osd_containerized_deployment: false\n112: ceph_osd_docker_username: ceph\n113: ceph_osd_docker_imagename: daemon\n114: ceph_osd_docker_extra_env: \"CEPH_DAEMON=OSD_CEPH_DISK\" # comma separated variables\n115: #ceph_osd_docker_device:\n116: # - /dev/sdb", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: contiv_ansible-roles-ceph-osd-defaults-main.yml\n# Target line: 112\n\n    107: ##########\n    108: # DOCKER #\n    109: ##########\n    110: \n    111: osd_containerized_deployment: false\n>>> 112: ceph_osd_docker_username: ceph\n    113: ceph_osd_docker_imagename: daemon\n    114: ceph_osd_docker_extra_env: \"CEPH_DAEMON=OSD_CEPH_DISK\" # comma separated variables\n    115: #ceph_osd_docker_device:\n    116: # - /dev/sdb\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloud-bulldozer_browbeat-ansible-browbeat-adjustment-db.yml", "content": "remote_user: heat-admin", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: cloud-bulldozer_browbeat-ansible-browbeat-adjustment-db.yml\n\n---\n#\n#\n\n- hosts: Controller\n6:   remote_user: heat-admin\ngather_facts: false\nvars:\nansible_become: true\ngreenlet_pool_size: 100\nmax_overflow: 100", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloud-bulldozer_browbeat-ansible-browbeat-adjustment-db.yml\n# Target line: 6\n\n      1: ---\n      2: #\n      3: #\n      4: \n      5: - hosts: Controller\n>>>   6:   remote_user: heat-admin\n      7:   gather_facts: false\n      8:   vars:\n      9:     ansible_become: true\n     10:     greenlet_pool_size: 100\n     11:     max_overflow: 100\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-playbooks-roles-mongo_3_6-defaults-main.yml", "content": "- user: cs_comments_service", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: openedx_configuration-playbooks-roles-mongo_3_6-defaults-main.yml\n\n\n# Vars Meant to be overridden\nMONGO_ADMIN_USER: 'admin'\nMONGO_ADMIN_PASSWORD: 'password'\nMONGO_USERS:\n37:   - user: cs_comments_service\npassword: password\ndatabase: cs_comments_service\nroles: readWrite\n- user: edxapp\npassword: password", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-playbooks-roles-mongo_3_6-defaults-main.yml\n# Target line: 37\n\n     32: \n     33: # Vars Meant to be overridden\n     34: MONGO_ADMIN_USER: 'admin'\n     35: MONGO_ADMIN_PASSWORD: 'password'\n     36: MONGO_USERS:\n>>>  37:   - user: cs_comments_service\n     38:     password: password\n     39:     database: cs_comments_service\n     40:     roles: readWrite\n     41:   - user: edxapp\n     42:     password: password\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml", "content": "api_db_username: \"fgapiserver\"", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n\ndb_container_name: \"fg-db\"\n# root password of the db - put this in your group_vars and then in a vault in production\ndb_root_password: \"changeme\"\n# API Server db config\n# API Server user name and password - should be kept in group_vars\n14: api_db_username: \"fgapiserver\"\napi_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\napi_db_name: fgapiserver\n# where will we store the SQL data ?\nsql_data_dir: /tmp/fgapi-server-db-data/\n# Repos", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Containers-Ansible-Container-FutureGatewayStack-ansible-vars.yml\n# Target line: 14\n\n      9: db_container_name: \"fg-db\"\n     10: # root password of the db - put this in your group_vars and then in a vault in production\n     11: db_root_password: \"changeme\"\n     12: # API Server db config\n     13: # API Server user name and password - should be kept in group_vars\n>>>  14: api_db_username: \"fgapiserver\"\n     15: api_db_userpass: \"wo6YqaSCp-Ur-Nma4kPp2qJOMXhW_bUg\"\n     16: api_db_name: fgapiserver\n     17: # where will we store the SQL data ?\n     18: sql_data_dir: /tmp/fgapi-server-db-data/\n     19: # Repos\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "spantaleev_matrix-docker-ansible-deploy-roles-matrix-base-tasks-server_base-setup_redhat8.yml", "content": "key: https://download.docker.com/linux/centos/gpg", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-base-tasks-server_base-setup_redhat8.yml\n\nwhen: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n\n- name: Ensure Docker's RPM key is trusted\nrpm_key:\nstate: present\n15:     key: https://download.docker.com/linux/centos/gpg\nwhen: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n\n- name: Ensure EPEL is installed\nyum:\nname:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: spantaleev_matrix-docker-ansible-deploy-roles-matrix-base-tasks-server_base-setup_redhat8.yml\n# Target line: 15\n\n     10:   when: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n     11: \n     12: - name: Ensure Docker's RPM key is trusted\n     13:   rpm_key:\n     14:     state: present\n>>>  15:     key: https://download.docker.com/linux/centos/gpg\n     16:   when: matrix_docker_installation_enabled|bool and matrix_docker_package_name == 'docker-ce'\n     17: \n     18: - name: Ensure EPEL is installed\n     19:   yum:\n     20:     name:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-docker-build-ecommerce-ecommerce.yml", "content": "SAILTHRU_SECRET: sailthru secret here", "line": 115, "detection_span": [110, 120], "with_context": "# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n\nerror_url: /checkout/error/\nmode: sandbox\nreceipt_url: /checkout/receipt/\n113: PLATFORM_NAME: Your Platform Name Here\n114: SAILTHRU_KEY: sailthru key here\n115: SAILTHRU_SECRET: sailthru secret here\n116: SECRET_KEY: Your secret key here\n117: SESSION_COOKIE_SECURE: true\n118: SESSION_EXPIRE_AT_BROWSER_CLOSE: false\n119: SOCIAL_AUTH_EDX_OAUTH2_ISSUER: http://127.0.0.1:8000\n120: SOCIAL_AUTH_EDX_OAUTH2_KEY: ecommerce-sso-key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-docker-build-ecommerce-ecommerce.yml\n# Target line: 115\n\n    110:             error_url: /checkout/error/\n    111:             mode: sandbox\n    112:             receipt_url: /checkout/receipt/\n    113: PLATFORM_NAME: Your Platform Name Here\n    114: SAILTHRU_KEY: sailthru key here\n>>> 115: SAILTHRU_SECRET: sailthru secret here\n    116: SECRET_KEY: Your secret key here\n    117: SESSION_COOKIE_SECURE: true\n    118: SESSION_EXPIRE_AT_BROWSER_CLOSE: false\n    119: SOCIAL_AUTH_EDX_OAUTH2_ISSUER: http://127.0.0.1:8000\n    120: SOCIAL_AUTH_EDX_OAUTH2_KEY: ecommerce-sso-key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml", "content": "username: \"admin\"", "line": 137, "detection_span": [132, 142], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n\nstorageDriverName: \"ontap-nas\"     # should be the same as storageclass.parameters.backendType\nbackendName: \"nas-backend\"\nmanagementLIF: \"10.0.0.1\"\ndataLIF: \"10.0.0.2\"\nsvm: \"svm_nfs\"\n137:     username: \"admin\"\npassword: \"secret\"\n# nfsMountOptions: \"nfsvers=4\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n# Target line: 137\n\n    132:     storageDriverName: \"ontap-nas\"     # should be the same as storageclass.parameters.backendType\n    133:     backendName: \"nas-backend\"\n    134:     managementLIF: \"10.0.0.1\"\n    135:     dataLIF: \"10.0.0.2\"\n    136:     svm: \"svm_nfs\"\n>>> 137:     username: \"admin\"\n    138:     password: \"secret\"\n    139:     # nfsMountOptions: \"nfsvers=4\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml", "content": "- { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }", "line": 72, "detection_span": [67, 77], "with_context": "# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n\n#  shell: echo -e \"{{ kadmin_pass }}\\n{{ kadmin_pass }}\" | kadmin.local -q \"addprinc cloudera-scm/admin\" && touch /var/kerberos/cdh_admin_created creates=/var/kerberos/cdh_admin_created\n\n- name: create users\nkadduser: name='{{ item.name }}' password='{{ item.pass }}' params='{{ item.params }}'\nwith_items:\n72:     - { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n- { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n- { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n- { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trustedanalytics_platform-ansible-roles-kerberos_base_server-tasks-main.yml\n# Target line: 72\n\n     67: #  shell: echo -e \"{{ kadmin_pass }}\\n{{ kadmin_pass }}\" | kadmin.local -q \"addprinc cloudera-scm/admin\" && touch /var/kerberos/cdh_admin_created creates=/var/kerberos/cdh_admin_created\n     68: \n     69: - name: create users\n     70:   kadduser: name='{{ item.name }}' password='{{ item.pass }}' params='{{ item.params }}'\n     71:   with_items:\n>>>  72:     - { name: '{{ arcadia.kerberos.user }}', pass: '', params: '-randkey -requires_preauth' }\n     73:     - { name: 'h2o', pass: '{{ h2o_password }}', params: '-requires_preauth' }\n     74:     - { name: 'hdfs', pass: '{{ kadmin_pass }}', params: '-requires_preauth' }\n     75:     - { name: 'hdfs/sys', pass: '', params: '-randkey -requires_preauth' }\n     76:     - { name: 'hbase/sys', pass: '', params: '-randkey -requires_preauth' }\n     77:     - { name: 'hive/sys', pass: '', params: '-randkey -requires_preauth' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dimagi_commcare-cloud-src-commcare_cloud-manage_commcare_cloud-monitors-pg_connections_high_icds.yml", "content": "env_key: host.environment", "line": 1, "detection_span": [1, 6], "with_context": "# Ansible file: dimagi_commcare-cloud-src-commcare_cloud-manage_commcare_cloud-monitors-pg_connections_high_icds.yml\n\n1: env_key: host.environment\nid: 5895436\nmessage: |-\n{{#is_alert}} {{value}} connections waiting on PgBouncer. Which is above threshold of {{threshold}} for the last 5 mins.{{/is_alert}}\n@slack-alerts-icds\nname: '[ICDS] PgBouncer connections waiting {{host.name}}'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dimagi_commcare-cloud-src-commcare_cloud-manage_commcare_cloud-monitors-pg_connections_high_icds.yml\n# Target line: 1\n\n>>>   1: env_key: host.environment\n      2: id: 5895436\n      3: message: |-\n      4:   {{#is_alert}} {{value}} connections waiting on PgBouncer. Which is above threshold of {{threshold}} for the last 5 mins.{{/is_alert}}\n      5:   @slack-alerts-icds\n      6: name: '[ICDS] PgBouncer connections waiting {{host.name}}'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "social-network_matrix-deployer-roles-matrix-bridge-mx-puppet-slack-defaults-main.yml", "content": "matrix_mx_puppet_slack_appservice_token: ''", "line": 47, "detection_span": [42, 52], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-mx-puppet-slack-defaults-main.yml\n\nmatrix_mx_puppet_slack_systemd_required_services_list: ['docker.service']\n\n# List of systemd services that matrix-puppet-slack.service wants\nmatrix_mx_puppet_slack_systemd_wanted_services_list: []\n\n47: matrix_mx_puppet_slack_appservice_token: ''\nmatrix_mx_puppet_slack_homeserver_token: ''\n\n# Default configuration template which covers the generic use case.\n# You can customize it by controlling the various variables inside it.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-mx-puppet-slack-defaults-main.yml\n# Target line: 47\n\n     42: matrix_mx_puppet_slack_systemd_required_services_list: ['docker.service']\n     43: \n     44: # List of systemd services that matrix-puppet-slack.service wants\n     45: matrix_mx_puppet_slack_systemd_wanted_services_list: []\n     46: \n>>>  47: matrix_mx_puppet_slack_appservice_token: ''\n     48: matrix_mx_puppet_slack_homeserver_token: ''\n     49: \n     50: # Default configuration template which covers the generic use case.\n     51: # You can customize it by controlling the various variables inside it.\n     52: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml", "content": "key: password", "line": 79, "detection_span": [74, 84], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n\nkey: username\n- name: DB_PASSWORD\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_DB}\"\n79:                 key: password\n- name: EC_CRT\nvalueFrom:\nsecretKeyRef:\nname: \"${EC_SECRET_CRT}\"\nkey: crt", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp-workload-iot-demo-files-vpn.yml\n# Target line: 79\n\n     74:                 key: username\n     75:           - name: DB_PASSWORD\n     76:             valueFrom:\n     77:               secretKeyRef:\n     78:                 name: \"${EC_SECRET_DB}\"\n>>>  79:                 key: password\n     80:           - name: EC_CRT\n     81:             valueFrom:\n     82:               secretKeyRef:\n     83:                 name: \"${EC_SECRET_CRT}\"\n     84:                 key: crt\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cip_dci-openstack-agent-plays-prepare_local_mirror.yml", "content": "generate_ssh_key: 'yes'", "line": 35, "detection_span": [30, 40], "with_context": "# Ansible file: redhat-cip_dci-openstack-agent-plays-prepare_local_mirror.yml\n\nwith_fileglob: '{{ dci_mirror_location }}/dci_repo/dci_repo*.repo'\nbecome: true\n- name: Generating RSA key for stack\nuser:\nname: '{{ ansible_user_id }}'\n35:     generate_ssh_key: 'yes'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cip_dci-openstack-agent-plays-prepare_local_mirror.yml\n# Target line: 35\n\n     30:   with_fileglob: '{{ dci_mirror_location }}/dci_repo/dci_repo*.repo'\n     31:   become: true\n     32: - name: Generating RSA key for stack\n     33:   user:\n     34:     name: '{{ ansible_user_id }}'\n>>>  35:     generate_ssh_key: 'yes'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "zhangi_kolla-ansible-ansible-roles-cyborg-defaults-main.yml", "content": "cyborg_keystone_user: \"cyborg\"", "line": 132, "detection_span": [127, 137], "with_context": "# Ansible file: zhangi_kolla-ansible-ansible-roles-cyborg-defaults-main.yml\n\n127: cyborg_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n128: cyborg_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n129:\n130: cyborg_logging_debug: \"{{ openstack_logging_debug }}\"\n131:\n132: cyborg_keystone_user: \"cyborg\"\n133:\n134: openstack_cyborg_auth: \"{{ openstack_auth }}\"\n135:\n136:\n137: ####################", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: zhangi_kolla-ansible-ansible-roles-cyborg-defaults-main.yml\n# Target line: 132\n\n    127: cyborg_internal_endpoint: \"{{ internal_protocol }}://{{ kolla_internal_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n    128: cyborg_public_endpoint: \"{{ public_protocol }}://{{ kolla_external_fqdn | put_address_in_context('url') }}:{{ cyborg_api_port }}\"\n    129: \n    130: cyborg_logging_debug: \"{{ openstack_logging_debug }}\"\n    131: \n>>> 132: cyborg_keystone_user: \"cyborg\"\n    133: \n    134: openstack_cyborg_auth: \"{{ openstack_auth }}\"\n    135: \n    136: \n    137: ####################\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Tamilneediarasu_ansible-jboss-standalone-roles-jboss-standalone-tasks-main.yml", "content": "user: name=jboss group=jboss home=/usr/share/jboss-as", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: Tamilneediarasu_ansible-jboss-standalone-roles-jboss-standalone-tasks-main.yml\n\n\n- name: Add group \"jboss\"\ngroup: name=jboss\n\n- name: Add user \"jboss\"\n28:   user: name=jboss group=jboss home=/usr/share/jboss-as\n\n- name: Change ownership of JBoss installation\nfile: path=/usr/share/jboss-as/ owner=jboss group=jboss state=directory recurse=yes\n\n- name: Copy the init script", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Tamilneediarasu_ansible-jboss-standalone-roles-jboss-standalone-tasks-main.yml\n# Target line: 28\n\n     23: \n     24: - name: Add group \"jboss\"\n     25:   group: name=jboss\n     26: \n     27: - name: Add user \"jboss\"\n>>>  28:   user: name=jboss group=jboss home=/usr/share/jboss-as\n     29: \n     30: - name: Change ownership of JBoss installation\n     31:   file: path=/usr/share/jboss-as/ owner=jboss group=jboss state=directory recurse=yes\n     32: \n     33: - name: Copy the init script\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-openstack_khaleesi-playbooks-installer-rdo-manager-overcloud-heat-templates-run.yml", "content": "cert_filename: \"overcloud-cacert.pem\"", "line": 89, "detection_span": [84, 94], "with_context": "# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-overcloud-heat-templates-run.yml\n\n\n- name: fetch template from single remote host\ntls_tht:\nsource_dir: \"{{ instack_user_home }}/local_tht/\"\ndest_dir: \"{{ instack_user_home }}/\"\n89:             cert_filename: \"overcloud-cacert.pem\"\ncert_ca_filename: \"overcloud-cacert.pem\"\nkey_filename: \"overcloud-privkey.pem\"\nwhen: installer.ssl\n\n- name: copy the self-signed SSL cert", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-playbooks-installer-rdo-manager-overcloud-heat-templates-run.yml\n# Target line: 89\n\n     84: \n     85:       - name: fetch template from single remote host\n     86:         tls_tht:\n     87:             source_dir: \"{{ instack_user_home }}/local_tht/\"\n     88:             dest_dir: \"{{ instack_user_home }}/\"\n>>>  89:             cert_filename: \"overcloud-cacert.pem\"\n     90:             cert_ca_filename: \"overcloud-cacert.pem\"\n     91:             key_filename: \"overcloud-privkey.pem\"\n     92:         when: installer.ssl\n     93: \n     94:       - name: copy the self-signed SSL cert\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga_ansible-playbooks-icinga2-ansible-web2-ui-defaults-main.yml", "content": "icinga2_db_user: \"icinga\"", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: Icinga_ansible-playbooks-icinga2-ansible-web2-ui-defaults-main.yml\n\n---\n# defaults file for icinga2-ansible-web2-ui\n\nicinga2_db: \"icinga\"\nicinga2_db_pass: \"icinga\"\n6: icinga2_db_user: \"icinga\"\nicinga2_web_mysql_schema: \"/usr/share/icinga2-ido-mysql/schema/mysql.sql\"\n\nicinga2_ido_mysql_conf: \"/etc/icinga2/features-available/ido-mysql.conf\"\n\nicinga2_web2_db: \"icingaweb\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Icinga_ansible-playbooks-icinga2-ansible-web2-ui-defaults-main.yml\n# Target line: 6\n\n      1: ---\n      2: # defaults file for icinga2-ansible-web2-ui\n      3: \n      4: icinga2_db: \"icinga\"\n      5: icinga2_db_pass: \"icinga\"\n>>>   6: icinga2_db_user: \"icinga\"\n      7: icinga2_web_mysql_schema: \"/usr/share/icinga2-ido-mysql/schema/mysql.sql\"\n      8: \n      9: icinga2_ido_mysql_conf: \"/etc/icinga2/features-available/ido-mysql.conf\"\n     10: \n     11: icinga2_web2_db: \"icingaweb\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "usegalaxy-au_infrastructure-group_vars-all.yml", "content": "public_key_src: files/keys/ubuntu_maintenance_key.pub", "line": 180, "detection_span": [175, 185], "with_context": "# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n\n175: pulsar_job_metrics_plugins: \"{{ galaxy_job_metrics_plugins }}\"\n176:\n177: internal_ssh_keys:\n178:   ubuntu_maintenance_key:\nprivate_key_content: \"{{ vault_ubuntu_maintenance_key }}\"\n180:     public_key_src: files/keys/ubuntu_maintenance_key.pub\nuser: ubuntu\n182:\n183: # Golang\n184: golang_version: '1.15.6' # default for role version 2.6.3\n185: golang_install_dir: '/opt/go/{{ golang_version }}' # default for role version 2.6.3", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: usegalaxy-au_infrastructure-group_vars-all.yml\n# Target line: 180\n\n    175: pulsar_job_metrics_plugins: \"{{ galaxy_job_metrics_plugins }}\"\n    176: \n    177: internal_ssh_keys:\n    178:   ubuntu_maintenance_key:\n    179:     private_key_content: \"{{ vault_ubuntu_maintenance_key }}\"\n>>> 180:     public_key_src: files/keys/ubuntu_maintenance_key.pub\n    181:     user: ubuntu\n    182: \n    183: # Golang\n    184: golang_version: '1.15.6' # default for role version 2.6.3\n    185: golang_install_dir: '/opt/go/{{ golang_version }}' # default for role version 2.6.3\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml", "content": "kafka_connect_ldap_password: password", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n\nkafka_broker_ldap_user: kafka_broker\nkafka_broker_ldap_password: password\nschema_registry_ldap_user: schema_registry\nschema_registry_ldap_password: password\nkafka_connect_ldap_user: connect_worker\n44:     kafka_connect_ldap_password: password\nksql_ldap_user: ksql\nksql_ldap_password: password\nkafka_rest_ldap_user: rest_proxy\nkafka_rest_ldap_password: password\ncontrol_center_ldap_user: control_center", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-rbac_kerberos_custom_certs_example.yml\n# Target line: 44\n\n     39:     kafka_broker_ldap_user: kafka_broker\n     40:     kafka_broker_ldap_password: password\n     41:     schema_registry_ldap_user: schema_registry\n     42:     schema_registry_ldap_password: password\n     43:     kafka_connect_ldap_user: connect_worker\n>>>  44:     kafka_connect_ldap_password: password\n     45:     ksql_ldap_user: ksql\n     46:     ksql_ldap_password: password\n     47:     kafka_rest_ldap_user: rest_proxy\n     48:     kafka_rest_ldap_password: password\n     49:     control_center_ldap_user: control_center\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "davestephens_ansible-nas-roles-bitwarden-defaults-main.yml", "content": "bitwarden_admin_token: qwertyuiop1234567890poiuytrewq0987654321", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: davestephens_ansible-nas-roles-bitwarden-defaults-main.yml\n\nbitwarden_ip_whitelist: \"0.0.0.0/0\"\n\n# Keep this token secret, this is password to access admin area of your server!\n# This token can be anything, but it's recommended to use a long, randomly generated string of characters,\n# for example running openssl rand -base64 48\n13: bitwarden_admin_token: qwertyuiop1234567890poiuytrewq0987654321\n\n# To create a user set this to \"true\", and reprovision the container by re-running the ansible-nas playbook.\n# Once you have created your user, set to \"false\" and run one more time.\n# Target just Bitwarden by running: ansible-playbook -i inventory nas.yml -b -K -t bitwarden\nbitwarden_allow_signups: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: davestephens_ansible-nas-roles-bitwarden-defaults-main.yml\n# Target line: 13\n\n      8: bitwarden_ip_whitelist: \"0.0.0.0/0\"\n      9: \n     10: # Keep this token secret, this is password to access admin area of your server!\n     11: # This token can be anything, but it's recommended to use a long, randomly generated string of characters,\n     12: # for example running openssl rand -base64 48\n>>>  13: bitwarden_admin_token: qwertyuiop1234567890poiuytrewq0987654321\n     14: \n     15: # To create a user set this to \"true\", and reprovision the container by re-running the ansible-nas playbook.\n     16: # Once you have created your user, set to \"false\" and run one more time.\n     17: # Target just Bitwarden by running: ansible-playbook -i inventory nas.yml -b -K -t bitwarden\n     18: bitwarden_allow_signups: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "aa_ala_password: secret", "line": 68, "detection_span": [63, 73], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\naa_sab_password: secret\naa_idin_client_secret: secret\naa_orcid_password: secret\naa_surfmarket_password: secret\naa_sbs_password: secret\n68: aa_ala_password: secret\naa_manage_password: secret\n\nmanage_pdp_password: secret\nattribute_aggregator_js_access_token: secret\npdp_js_access_token: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 68\n\n     63: aa_sab_password: secret\n     64: aa_idin_client_secret: secret\n     65: aa_orcid_password: secret\n     66: aa_surfmarket_password: secret\n     67: aa_sbs_password: secret\n>>>  68: aa_ala_password: secret\n     69: aa_manage_password: secret\n     70: \n     71: manage_pdp_password: secret\n     72: attribute_aggregator_js_access_token: secret\n     73: pdp_js_access_token: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openedx_configuration-playbooks-roles-mariadb-defaults-main.yml", "content": "MARIADB_CLUSTER_USER_ADMIN: \"mariadb_clu_root\"", "line": 21, "detection_span": [16, 26], "with_context": "# Ansible file: openedx_configuration-playbooks-roles-mariadb-defaults-main.yml\n\n# Note: version is determined by repo\nMARIADB_REPO: \"deb http://mirrors.syringanetworks.net/mariadb/repo/10.0/ubuntu {{ ansible_distribution_release }} main\"\n\nMARIADB_CREATE_DBS: yes\nMARIADB_CLUSTERED: no\n21: MARIADB_CLUSTER_USER_ADMIN: \"mariadb_clu_root\"\nMARIADB_CLUSTER_PASSWORD_ADMIN: \"password\"\nMARIADB_HOST_PRIV: '%'\n\nMARIADB_HAPROXY_USER: 'haproxy'\nMARIADB_HAPROXY_HOSTS:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openedx_configuration-playbooks-roles-mariadb-defaults-main.yml\n# Target line: 21\n\n     16: # Note: version is determined by repo\n     17: MARIADB_REPO: \"deb http://mirrors.syringanetworks.net/mariadb/repo/10.0/ubuntu {{ ansible_distribution_release }} main\"\n     18: \n     19: MARIADB_CREATE_DBS: yes\n     20: MARIADB_CLUSTERED: no\n>>>  21: MARIADB_CLUSTER_USER_ADMIN: \"mariadb_clu_root\"\n     22: MARIADB_CLUSTER_PASSWORD_ADMIN: \"password\"\n     23: MARIADB_HOST_PRIV: '%'\n     24: \n     25: MARIADB_HAPROXY_USER: 'haproxy'\n     26: MARIADB_HAPROXY_HOSTS:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "IBM_z_ansible_collections_samples-zos_concepts-certificate_management-create_SITE_cert_tsocmd.yml", "content": "cert_label: 'ANDY SITE'", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-certificate_management-create_SITE_cert_tsocmd.yml\n\n- ibm.ibm_zos_core\ngather_facts: no\nenvironment: \"{{ environment_vars }}\"\nvars:\nowner_id: 'OMVSKERN'\n12:     cert_label: 'ANDY SITE'\nsign_label: 'ANDY CA'\ncn: '{{cert_label}}.svl.ibm.com'\nou: '{{cert_label}}'\ncountry: 'US'\nexpiry_date: '2021-12-28'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-certificate_management-create_SITE_cert_tsocmd.yml\n# Target line: 12\n\n      7:     - ibm.ibm_zos_core\n      8:   gather_facts: no\n      9:   environment: \"{{ environment_vars }}\"\n     10:   vars:\n     11:     owner_id: 'OMVSKERN'\n>>>  12:     cert_label: 'ANDY SITE'\n     13:     sign_label: 'ANDY CA'\n     14:     cn: '{{cert_label}}.svl.ibm.com'\n     15:     ou: '{{cert_label}}'\n     16:     country: 'US'\n     17:     expiry_date: '2021-12-28'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "enthought_edx_ansible-playbooks-roles-insights-defaults-main.yml", "content": "INSIGHTS_EMAIL_HOST_PASSWORD: \"mail_password\"", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-insights-defaults-main.yml\n\n# should match the timezone of your map reduce pipeline\nINSIGHTS_TIME_ZONE: 'UTC'\nINSIGHTS_LANGUAGE_CODE: 'en-us'\n# email config\nINSIGHTS_EMAIL_HOST: 'smtp.example.com'\n46: INSIGHTS_EMAIL_HOST_PASSWORD: \"mail_password\"\nINSIGHTS_EMAIL_HOST_USER: \"mail_user\"\nINSIGHTS_EMAIL_PORT: 587\nINSIGHTS_ENABLE_AUTO_AUTH: false\nINSIGHTS_SEGMENT_IGNORE_EMAIL_REGEX: !!null\nINSIGHTS_THEME_SCSS: 'sass/themes/open-edx.scss'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-insights-defaults-main.yml\n# Target line: 46\n\n     41: # should match the timezone of your map reduce pipeline\n     42: INSIGHTS_TIME_ZONE: 'UTC'\n     43: INSIGHTS_LANGUAGE_CODE: 'en-us'\n     44: # email config\n     45: INSIGHTS_EMAIL_HOST: 'smtp.example.com'\n>>>  46: INSIGHTS_EMAIL_HOST_PASSWORD: \"mail_password\"\n     47: INSIGHTS_EMAIL_HOST_USER: \"mail_user\"\n     48: INSIGHTS_EMAIL_PORT: 587\n     49: INSIGHTS_ENABLE_AUTO_AUTH: false\n     50: INSIGHTS_SEGMENT_IGNORE_EMAIL_REGEX: !!null\n     51: INSIGHTS_THEME_SCSS: 'sass/themes/open-edx.scss'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sensu_sensu-go-ansible-vagrant-windows-inventory.yaml", "content": "ansible_password: vagrant", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: sensu_sensu-go-ansible-vagrant-windows-inventory.yaml\n\nhosts:\nwindows:\nansible_host: 192.168.50.90\nansible_port: 5985\nansible_user: vagrant\n8:       ansible_password: vagrant\nansible_connection: winrm\nansible_winrm_transport: basic", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sensu_sensu-go-ansible-vagrant-windows-inventory.yaml\n# Target line: 8\n\n      3:   hosts:\n      4:     windows:\n      5:       ansible_host: 192.168.50.90\n      6:       ansible_port: 5985\n      7:       ansible_user: vagrant\n>>>   8:       ansible_password: vagrant\n      9:       ansible_connection: winrm\n     10:       ansible_winrm_transport: basic\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "social-network_matrix-deployer-roles-matrix-base-defaults-main.yml", "content": "matrix_user_username: \"matrix\"", "line": 24, "detection_span": [19, 29], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-base-defaults-main.yml\n\nmatrix_server_fqn_dimension: \"dimension.{{ matrix_domain }}\"\n\n# This is where you access Jitsi.\nmatrix_server_fqn_jitsi: \"jitsi.{{ matrix_domain }}\"\n\n24: matrix_user_username: \"matrix\"\nmatrix_user_groupname: \"matrix\"\n\nmatrix_base_data_path: \"/matrix\"\nmatrix_base_data_path_mode: \"750\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-base-defaults-main.yml\n# Target line: 24\n\n     19: matrix_server_fqn_dimension: \"dimension.{{ matrix_domain }}\"\n     20: \n     21: # This is where you access Jitsi.\n     22: matrix_server_fqn_jitsi: \"jitsi.{{ matrix_domain }}\"\n     23: \n>>>  24: matrix_user_username: \"matrix\"\n     25: matrix_user_groupname: \"matrix\"\n     26: \n     27: matrix_base_data_path: \"/matrix\"\n     28: matrix_base_data_path_mode: \"750\"\n     29: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pulp_pulp-operator-roles-pulp-api-tasks-s3-storage-configuration.yml", "content": "s3_secret_access_key_available: true", "line": 35, "detection_span": [30, 40], "with_context": "# Ansible file: pulp_pulp-operator-roles-pulp-api-tasks-s3-storage-configuration.yml\n\n- _custom_s3_configuration.resources[0].data['s3-access-key-id'] is defined\n- _custom_s3_configuration.resources[0].data['s3-access-key-id'] | length\n\n- name: Check if s3-secret-access-key is found\nset_fact:\n35:     s3_secret_access_key_available: true\nwhen:\n- s3_secret_data_available\n- _custom_s3_configuration.resources[0].data['s3-secret-access-key'] is defined\n- _custom_s3_configuration.resources[0].data['s3-secret-access-key'] | length\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulp_pulp-operator-roles-pulp-api-tasks-s3-storage-configuration.yml\n# Target line: 35\n\n     30:     - _custom_s3_configuration.resources[0].data['s3-access-key-id'] is defined\n     31:     - _custom_s3_configuration.resources[0].data['s3-access-key-id'] | length\n     32: \n     33: - name: Check if s3-secret-access-key is found\n     34:   set_fact:\n>>>  35:     s3_secret_access_key_available: true\n     36:   when:\n     37:     - s3_secret_data_available\n     38:     - _custom_s3_configuration.resources[0].data['s3-secret-access-key'] is defined\n     39:     - _custom_s3_configuration.resources[0].data['s3-secret-access-key'] | length\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "confluentinc_cp-ansible-docs-sample_inventories-kafka_connect_replicator.yml", "content": "kafka_connect_replicator_ssl_ca_cert_path: \"/generated_ssl_files/ca.crt\"", "line": 21, "detection_span": [16, 26], "with_context": "# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-kafka_connect_replicator.yml\n\n\nkafka_connect_replicator_white_list: test-replicator-source\nkafka_connect_replicator_bootstrap_servers: ip-10-0-0-10.eu-west-2.compute.internal:9092\nkafka_connect_replicator_kerberos_principal: \"replicator/kafka-connect-replicator1.confluent@CONFLUENT.EXAMPLE.COM\"\nkafka_connect_replicator_kerberos_keytab_path: \"/keytabs/kafka-connect-replicator1.keytab\"\n21:     kafka_connect_replicator_ssl_ca_cert_path: \"/generated_ssl_files/ca.crt\"\nkafka_connect_replicator_ssl_cert_path: \"/generated_ssl_files/{{inventory_hostname}}-ca1-signed.crt\"\nkafka_connect_replicator_ssl_key_path: \"/generated_ssl_files/{{inventory_hostname}}-key.pem\"\nkafka_connect_replicator_ssl_key_password: keypass\n\nkafka_connect_replicator_consumer_listener:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: confluentinc_cp-ansible-docs-sample_inventories-kafka_connect_replicator.yml\n# Target line: 21\n\n     16: \n     17:     kafka_connect_replicator_white_list: test-replicator-source\n     18:     kafka_connect_replicator_bootstrap_servers: ip-10-0-0-10.eu-west-2.compute.internal:9092\n     19:     kafka_connect_replicator_kerberos_principal: \"replicator/kafka-connect-replicator1.confluent@CONFLUENT.EXAMPLE.COM\"\n     20:     kafka_connect_replicator_kerberos_keytab_path: \"/keytabs/kafka-connect-replicator1.keytab\"\n>>>  21:     kafka_connect_replicator_ssl_ca_cert_path: \"/generated_ssl_files/ca.crt\"\n     22:     kafka_connect_replicator_ssl_cert_path: \"/generated_ssl_files/{{inventory_hostname}}-ca1-signed.crt\"\n     23:     kafka_connect_replicator_ssl_key_path: \"/generated_ssl_files/{{inventory_hostname}}-key.pem\"\n     24:     kafka_connect_replicator_ssl_key_password: keypass\n     25: \n     26:     kafka_connect_replicator_consumer_listener:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml", "content": "neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n\nkeystone_auth_admin_password: secrete\nkeystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\nkeystone_container_mysql_password: a94e95b30824305cda80caba7cac67\nkeystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\nmemcached_encryption_key: 78a191237b291b66e23a49c3\n28: neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443\nneutron_service_password: 5043b5b40b09d31781afe9704\nnova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\nnova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\nnova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\nnova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: VaneCloud_openstack-ansible-openstack_deploy-user_secrets.yml\n# Target line: 28\n\n     23: keystone_auth_admin_password: secrete\n     24: keystone_auth_admin_token: 0c3d6f7d54b6982bd6c9d2fe641a096787e96db72726faff6b2246f348fa50b5a365a28\n     25: keystone_container_mysql_password: a94e95b30824305cda80caba7cac67\n     26: keystone_service_password: 3fb537c47a884c7d21f2fa59daf6649aa4d5299fe98\n     27: memcached_encryption_key: 78a191237b291b66e23a49c3\n>>>  28: neutron_container_mysql_password: feb83aee268e0b4b10e87c08b6cb836883614d8eb31cb443\n     29: neutron_service_password: 5043b5b40b09d31781afe9704\n     30: nova_container_mysql_password: 6f85e3aeaa605609fa57632f6413b7e\n     31: nova_ec2_service_password: cb455728f92d097d6b32a54784d7f153b6db\n     32: nova_metadata_proxy_secret: ae6c2cbc70aeb9c3703deb332b7f3da699905064adf350d4abdb0a50\n     33: nova_s3_service_password: 413e0989bacdf8e75dc0f60fa95076f6215bd197a861\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "teams_api_lifecycle_password: secret", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\nvoot_oidcng_checkToken_secret: secret\n\nexternal_group_provider_secrets:\nteams: secret\n\n49: teams_api_lifecycle_password: secret\nteams_api_spdashboard_password: secret\nattribute_aggregator_api_lifecycle_password: secret\n\noidc_playground_secret: secret\noidc_playground_jwt_secret: very-long-long-long-long-long-secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 49\n\n     44: voot_oidcng_checkToken_secret: secret\n     45: \n     46: external_group_provider_secrets:\n     47:   teams: secret\n     48: \n>>>  49: teams_api_lifecycle_password: secret\n     50: teams_api_spdashboard_password: secret\n     51: attribute_aggregator_api_lifecycle_password: secret\n     52: \n     53: oidc_playground_secret: secret\n     54: oidc_playground_jwt_secret: very-long-long-long-long-long-secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_infra-ansible-inventory-rh-sso-group_vars-rh-sso-hosts.yml", "content": "keystore_pass: changeit", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: redhat-cop_infra-ansible-inventory-rh-sso-group_vars-rh-sso-hosts.yml\n\nrh_sso_protocol: https\nrh_sso_ssl:\ncert: /the/path/to/my/cert.crt\nkey: /the/path/to/my/cert.key\nkeystore_name: default\n17:   keystore_pass: changeit\nkeystore_path: \"/etc/security/keystore.jks\"\n\nrealms:\n- name: my-awesome-realm\nid: my-awesome-realm", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_infra-ansible-inventory-rh-sso-group_vars-rh-sso-hosts.yml\n# Target line: 17\n\n     12: rh_sso_protocol: https\n     13: rh_sso_ssl:\n     14:   cert: /the/path/to/my/cert.crt\n     15:   key: /the/path/to/my/cert.key\n     16:   keystore_name: default\n>>>  17:   keystore_pass: changeit\n     18:   keystore_path: \"/etc/security/keystore.jks\"\n     19: \n     20: realms:\n     21:   - name: my-awesome-realm\n     22:     id: my-awesome-realm\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-evpn_underlay_ebgp_overlay_ebgp-intended-structured_configs-DC1-L2LEAF3A.yml", "content": "key: telarista", "line": 12, "detection_span": [7, 17], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-evpn_underlay_ebgp_overlay_ebgp-intended-structured_configs-DC1-L2LEAF3A.yml\n\ndaemon_terminattr:\ncvaddrs:\n- 192.168.200.11:9910\ncvauth:\nmethod: key\n12:     key: telarista\ncvvrf: MGMT\nsmashexcludes: ale,flexCounter,hardware,kni,pulse,strata\ningestexclude: /Sysdb/cell/1/agent,/Sysdb/cell/2/agent\ndisable_aaa: false\nvlan_internal_order:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-evpn_underlay_ebgp_overlay_ebgp-intended-structured_configs-DC1-L2LEAF3A.yml\n# Target line: 12\n\n      7: daemon_terminattr:\n      8:   cvaddrs:\n      9:   - 192.168.200.11:9910\n     10:   cvauth:\n     11:     method: key\n>>>  12:     key: telarista\n     13:   cvvrf: MGMT\n     14:   smashexcludes: ale,flexCounter,hardware,kni,pulse,strata\n     15:   ingestexclude: /Sysdb/cell/1/agent,/Sysdb/cell/2/agent\n     16:   disable_aaa: false\n     17: vlan_internal_order:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cloud-bulldozer_browbeat-ansible-gather-group_vars-all.yml", "content": "host_remote_user: heat-admin", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: cloud-bulldozer_browbeat-ansible-gather-group_vars-all.yml\n\n# Adjust Browbeat user if you are deploying Browbeat on a different machine than the Undercloud\nbrowbeat_user: \"{{ ansible_user | default('stack') }}\"\n# Login user for the local/jump machine (Typically Undercloud)\nlocal_remote_user: \"{{ ansible_user | default('stack') }}\"\n# Login user for the Overcloud hosts\n8: host_remote_user: heat-admin\n\nhome_dir: \"/home/{{ browbeat_user }}\"\nbrowbeat_path: \"{{ home_dir }}/browbeat\"\ncontainer_cli: docker", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloud-bulldozer_browbeat-ansible-gather-group_vars-all.yml\n# Target line: 8\n\n      3: # Adjust Browbeat user if you are deploying Browbeat on a different machine than the Undercloud\n      4: browbeat_user: \"{{ ansible_user | default('stack') }}\"\n      5: # Login user for the local/jump machine (Typically Undercloud)\n      6: local_remote_user: \"{{ ansible_user | default('stack') }}\"\n      7: # Login user for the Overcloud hosts\n>>>   8: host_remote_user: heat-admin\n      9: \n     10: home_dir: \"/home/{{ browbeat_user }}\"\n     11: browbeat_path: \"{{ home_dir }}/browbeat\"\n     12: container_cli: docker\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "crv4all_openshift-ansible-roles-openshift_console-tasks-install.yml", "content": "- key: auth#oauthEndpointCAFile", "line": 56, "detection_span": [51, 61], "with_context": "# Ansible file: crv4all_openshift-ansible-roles-openshift_console-tasks-install.yml\n\nvalue: \"https://{{ openshift_console_hostname }}\"\n- key: clusterInfo#consoleBasePath\nvalue: \"{{ openshift_console_base_path | default('') }}\"\n- key: clusterInfo#masterPublicURL\nvalue: \"{{ openshift.master.public_api_url }}\"\n56:     - key: auth#oauthEndpointCAFile\nvalue: \"{{ openshift_console_auth_ca_file }}\"\n- key: auth#logoutRedirect\nvalue: \"{{ openshift.master.logout_url | default('') }}\"\n- key: customization#logoImageName\nvalue: \"{{ openshift_console_logo_image_name }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-roles-openshift_console-tasks-install.yml\n# Target line: 56\n\n     51:       value: \"https://{{ openshift_console_hostname }}\"\n     52:     - key: clusterInfo#consoleBasePath\n     53:       value: \"{{ openshift_console_base_path | default('') }}\"\n     54:     - key: clusterInfo#masterPublicURL\n     55:       value: \"{{ openshift.master.public_api_url }}\"\n>>>  56:     - key: auth#oauthEndpointCAFile\n     57:       value: \"{{ openshift_console_auth_ca_file }}\"\n     58:     - key: auth#logoutRedirect\n     59:       value: \"{{ openshift.master.logout_url | default('') }}\"\n     60:     - key: customization#logoImageName\n     61:       value: \"{{ openshift_console_logo_image_name }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml", "content": "url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace\"", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n\nregister: workspace_devfile\nignore_errors: yes\n\n- name: Get workspace for {{ ocp4_workload_iot_managed_workshop_openshift_user_username}}\nuri:\n61:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace\"\nmethod: GET\nheaders:\nAccept: application/json\nAuthorization: \"Bearer {{ access_token }}\"\nstatus_code: 200", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n# Target line: 61\n\n     56:   register: workspace_devfile\n     57:   ignore_errors: yes\n     58:   \n     59: - name: Get workspace for {{ ocp4_workload_iot_managed_workshop_openshift_user_username}}\n     60:   uri:\n>>>  61:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace\"\n     62:     method: GET\n     63:     headers:\n     64:       Accept: application/json\n     65:       Authorization: \"Bearer {{ access_token }}\"\n     66:     status_code: 200\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "social-network_matrix-deployer-roles-matrix-bridge-appservice-discord-defaults-main.yml", "content": "matrix_appservice_discord_appservice_url: 'http://matrix-appservice-discord:9005'", "line": 34, "detection_span": [29, 39], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-discord-defaults-main.yml\n\nmatrix_appservice_discord_systemd_required_services_list: ['docker.service']\n\n# List of systemd services that matrix-appservice-discord.service wants\nmatrix_appservice_discord_systemd_wanted_services_list: []\n\n34: matrix_appservice_discord_appservice_url: 'http://matrix-appservice-discord:9005'\n\nmatrix_appservice_discord_bridge_domain: \"{{ matrix_domain }}\"\n# As of right now, the homeserver URL must be a public URL. See below.\nmatrix_appservice_discord_bridge_homeserverUrl: \"{{ matrix_homeserver_url }}\"\nmatrix_appservice_discord_bridge_disablePresence: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-discord-defaults-main.yml\n# Target line: 34\n\n     29: matrix_appservice_discord_systemd_required_services_list: ['docker.service']\n     30: \n     31: # List of systemd services that matrix-appservice-discord.service wants\n     32: matrix_appservice_discord_systemd_wanted_services_list: []\n     33: \n>>>  34: matrix_appservice_discord_appservice_url: 'http://matrix-appservice-discord:9005'\n     35: \n     36: matrix_appservice_discord_bridge_domain: \"{{ matrix_domain }}\"\n     37: # As of right now, the homeserver URL must be a public URL. See below.\n     38: matrix_appservice_discord_bridge_homeserverUrl: \"{{ matrix_homeserver_url }}\"\n     39: matrix_appservice_discord_bridge_disablePresence: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "carlosthe19916_openshift-ansible-playbooks-adhoc-zabbix_setup-create_app.yml", "content": "g_zserver: http://oso-rhel7-zabbix-web.kwoodsontest2.opstest.online.openshift.com/zabbix/api_jsonrpc.php", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: carlosthe19916_openshift-ansible-playbooks-adhoc-zabbix_setup-create_app.yml\n\ngather_facts: no\nvars_files:\n- vars/template_heartbeat.yml\n- vars/template_os_linux.yml\nvars:\n8:     g_zserver: http://oso-rhel7-zabbix-web.kwoodsontest2.opstest.online.openshift.com/zabbix/api_jsonrpc.php\ng_zuser: Admin\ng_zpassword: zabbix\nroles:\n- ../roles/os_zabbix\npost_tasks:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: carlosthe19916_openshift-ansible-playbooks-adhoc-zabbix_setup-create_app.yml\n# Target line: 8\n\n      3:   gather_facts: no\n      4:   vars_files:\n      5:   - vars/template_heartbeat.yml\n      6:   - vars/template_os_linux.yml\n      7:   vars:\n>>>   8:     g_zserver: http://oso-rhel7-zabbix-web.kwoodsontest2.opstest.online.openshift.com/zabbix/api_jsonrpc.php\n      9:     g_zuser: Admin\n     10:     g_zpassword: zabbix\n     11:   roles:\n     12:   - ../roles/os_zabbix\n     13:   post_tasks:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-streaming-tasks-provision_crw.yaml", "content": "url: 'http://keycloak-{{ che_project }}.{{ route_subdomain }}/auth/admin/realms/master'", "line": 89, "detection_span": [84, 94], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-streaming-tasks-provision_crw.yaml\n\nset_fact:\nadmin_token: '{{token_result.json.access_token}}'\n\n- name: Increase Token Lifespan (60mins)\nuri:\n89:     url: 'http://keycloak-{{ che_project }}.{{ route_subdomain }}/auth/admin/realms/master'\nmethod: PUT\nbody: \"{\\\"realm\\\":\\\"master\\\", \\\"accessTokenLifespan\\\":\\\"3600\\\"}\"\nbody_format: json\nheaders:\nContent-Type: \"application/json\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-dil-streaming-tasks-provision_crw.yaml\n# Target line: 89\n\n     84:   set_fact:\n     85:     admin_token: '{{token_result.json.access_token}}'\n     86: \n     87: - name: Increase Token Lifespan (60mins)\n     88:   uri:\n>>>  89:     url: 'http://keycloak-{{ che_project }}.{{ route_subdomain }}/auth/admin/realms/master'\n     90:     method: PUT\n     91:     body: \"{\\\"realm\\\":\\\"master\\\", \\\"accessTokenLifespan\\\":\\\"3600\\\"}\"\n     92:     body_format: json\n     93:     headers:\n     94:       Content-Type: \"application/json\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Islandora-Devops_islandora-playbook-inventory-vagrant-group_vars-alpaca.yml", "content": "alpaca_houdini_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/houdini\"", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: Islandora-Devops_islandora-playbook-inventory-vagrant-group_vars-alpaca.yml\n\n\n\ntriplestore_namespace: islandora\nalpaca_triplestore_base_url: \"http://{{ hostvars[groups['tomcat'][0]].ansible_host  }}:8080/bigdata\"\nalpaca_milliner_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/milliner/\"\n13:  alpaca_houdini_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/houdini\"\nalpaca_homarus_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/homarus\"\nalpaca_hypercube_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/hypercube\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Islandora-Devops_islandora-playbook-inventory-vagrant-group_vars-alpaca.yml\n# Target line: 13\n\n      8: \n      9: \n     10:  triplestore_namespace: islandora\n     11:  alpaca_triplestore_base_url: \"http://{{ hostvars[groups['tomcat'][0]].ansible_host  }}:8080/bigdata\"\n     12:  alpaca_milliner_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/milliner/\"\n>>>  13:  alpaca_houdini_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/houdini\"\n     14:  alpaca_homarus_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/homarus\"\n     15:  alpaca_hypercube_base_url: \"http://{{ hostvars[groups['webserver'][0]].ansible_host  }}:{{ apache_listen_port }}/hypercube\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.crayfish-defaults-main.yml", "content": "pcdm: \"http://pcdm.org/models#\"", "line": 130, "detection_span": [125, 135], "with_context": "# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.crayfish-defaults-main.yml\n\n125: crayfish_recast_prefixes:\n126:   acl: \"http://www.w3.org/ns/auth/acl#\"\n127:   fedora: \"http://fedora.info/definitions/v4/repository#\"\n128:   ldp: \"http://www.w3.org/ns/ldp#\"\n129:   memento: \"http://mementoweb.org/ns#\"\n130:   pcdm: \"http://pcdm.org/models#\"\n131:   pcdmuse: \"http://pcdm.org/use#\"\n132:   webac: \"http://fedora.info/definitions/v4/webac#\"\n133:   vcard: \"http://www.w3.org/2006/vcard/ns#\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Islandora-Devops_islandora-playbook-roles-internal-Islandora-Devops.crayfish-defaults-main.yml\n# Target line: 130\n\n    125: crayfish_recast_prefixes:\n    126:   acl: \"http://www.w3.org/ns/auth/acl#\"\n    127:   fedora: \"http://fedora.info/definitions/v4/repository#\"\n    128:   ldp: \"http://www.w3.org/ns/ldp#\"\n    129:   memento: \"http://mementoweb.org/ns#\"\n>>> 130:   pcdm: \"http://pcdm.org/models#\"\n    131:   pcdmuse: \"http://pcdm.org/use#\"\n    132:   webac: \"http://fedora.info/definitions/v4/webac#\"\n    133:   vcard: \"http://www.w3.org/2006/vcard/ns#\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "shourya7_Ansible_sha-ansible-configs-bu-workshop-files-import_gitlab_repos.yml", "content": "url: 'http://{{ gitlab_hostname }}/api/v3/projects'", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: shourya7_Ansible_sha-ansible-configs-bu-workshop-files-import_gitlab_repos.yml\n\nregister: project_absent\nignore_errors: true\n\n- name: 'Import nationalparks repository for {{ item }}'\nuri:\n26:     url: 'http://{{ gitlab_hostname }}/api/v3/projects'\nHEADER_PRIVATE-TOKEN: \"{{token_out.json.private_token}}\"\nbody: 'name=nationalparks&import_url=https://github.com/openshift-roadshow/nationalparks&public=true'\nmethod: POST\nstatus_code: 201\nreturn_content: no", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: shourya7_Ansible_sha-ansible-configs-bu-workshop-files-import_gitlab_repos.yml\n# Target line: 26\n\n     21:   register: project_absent\n     22:   ignore_errors: true\n     23: \n     24: - name: 'Import nationalparks repository for {{ item }}'\n     25:   uri:\n>>>  26:     url: 'http://{{ gitlab_hostname }}/api/v3/projects'\n     27:     HEADER_PRIVATE-TOKEN: \"{{token_out.json.private_token}}\"\n     28:     body: 'name=nationalparks&import_url=https://github.com/openshift-roadshow/nationalparks&public=true'\n     29:     method: POST\n     30:     status_code: 201\n     31:     return_content: no\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack_tripleo-quickstart-config-release-master.yml", "content": "baseurl: http://mirror.centos.org/centos/8-stream/HighAvailability/x86_64/os/", "line": 69, "detection_span": [64, 74], "with_context": "# Ansible file: openstack_tripleo-quickstart-config-release-master.yml\n\nbaseurl: http://mirror.centos.org/centos/8-stream/PowerTools/x86_64/os/\n\n- type: generic\nreponame: quickstart-centos-highavailability\nfilename: quickstart-centos-highavailability.repo\n69:     baseurl: http://mirror.centos.org/centos/8-stream/HighAvailability/x86_64/os/\n\n- type: generic\nreponame: quickstart-centos-extras\nfilename: quickstart-centos-extras.repo\nbaseurl: http://mirror.centos.org/centos/8-stream/extras/x86_64/os/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-quickstart-config-release-master.yml\n# Target line: 69\n\n     64:     baseurl: http://mirror.centos.org/centos/8-stream/PowerTools/x86_64/os/\n     65: \n     66:   - type: generic\n     67:     reponame: quickstart-centos-highavailability\n     68:     filename: quickstart-centos-highavailability.repo\n>>>  69:     baseurl: http://mirror.centos.org/centos/8-stream/HighAvailability/x86_64/os/\n     70: \n     71:   - type: generic\n     72:     reponame: quickstart-centos-extras\n     73:     filename: quickstart-centos-extras.repo\n     74:     baseurl: http://mirror.centos.org/centos/8-stream/extras/x86_64/os/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack_tripleo-quickstart-config-release-centosci-CentOS-8-train-current-tripleo.yml", "content": "baseurl: http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/", "line": 38, "detection_span": [33, 43], "with_context": "# Ansible file: openstack_tripleo-quickstart-config-release-centosci-CentOS-8-train-current-tripleo.yml\n\ndown_url: https://trunk.rdoproject.org/{{ distro_ver }}-{{ release }}/delorean-deps.repo\n\n- type: generic\nreponame: quickstart-centos-base\nfilename: quickstart-centos-base.repo\n38:     baseurl: http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/\n\n- type: generic\nreponame: quickstart-centos-appstreams\nfilename: quickstart-centos-appstreams.repo\nbaseurl: http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-quickstart-config-release-centosci-CentOS-8-train-current-tripleo.yml\n# Target line: 38\n\n     33:     down_url: https://trunk.rdoproject.org/{{ distro_ver }}-{{ release }}/delorean-deps.repo\n     34: \n     35:   - type: generic\n     36:     reponame: quickstart-centos-base\n     37:     filename: quickstart-centos-base.repo\n>>>  38:     baseurl: http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/\n     39: \n     40:   - type: generic\n     41:     reponame: quickstart-centos-appstreams\n     42:     filename: quickstart-centos-appstreams.repo\n     43:     baseurl: http://mirror.centos.org/centos/8-stream/AppStream/x86_64/os/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml", "content": "url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace/{{ workspace_def.json[0].id }}/runtime\"", "line": 82, "detection_span": [77, 87], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n\n\n\n- name: Verify and start workspace for {{ ocp_username }} again if stopped\nwhen: workspace_def.json[0].status == \"STOPPED\"\nuri:\n82:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace/{{ workspace_def.json[0].id }}/runtime\"\nmethod: POST\nheaders:\nAccept: application/json\nAuthorization: \"Bearer {{ access_token }}\"\nstatus_code: 200", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-ocp4-workload-iot-managed-user-tasks-user_che_workspace.yaml\n# Target line: 82\n\n     77:     \n     78:     \n     79: - name: Verify and start workspace for {{ ocp_username }} again if stopped\n     80:   when: workspace_def.json[0].status == \"STOPPED\"\n     81:   uri:\n>>>  82:     url: \"http://che-{{ che_project }}.{{ route_subdomain }}/api/workspace/{{ workspace_def.json[0].id }}/runtime\"\n     83:     method: POST\n     84:     headers:\n     85:       Accept: application/json\n     86:       Authorization: \"Bearer {{ access_token }}\"\n     87:     status_code: 200\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack_kolla-ansible-roles-cephadm-defaults-main.yml", "content": "cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n- shortname: \"ceph-noarch\"\nname: \"Ceph noarch repository\"\nurl: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n\n13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n\ncephadm_ceph_osd_devices:\n- primary:/dev/cephvg/cephlv\n- secondary1:/dev/cephvg/cephlv\n- secondary2:/dev/cephvg/cephlv", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_kolla-ansible-roles-cephadm-defaults-main.yml\n# Target line: 13\n\n      8:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/{{ ansible_architecture }}/\"\n      9:   - shortname: \"ceph-noarch\"\n     10:     name: \"Ceph noarch repository\"\n     11:     url: \"http://download.ceph.com/rpm-{{ cephadm_ceph_release }}/el8/noarch/\"\n     12: \n>>>  13: cephadm_ceph_rpm_gpg_key: http://download.ceph.com/keys/release.gpg\n     14: \n     15: cephadm_ceph_osd_devices:\n     16:   - primary:/dev/cephvg/cephlv\n     17:   - secondary1:/dev/cephvg/cephlv\n     18:   - secondary2:/dev/cephvg/cephlv\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "geerlingguy_ansible-role-jenkins-tasks-main.yml", "content": "url: \"http://{{ jenkins_hostname }}:{{ jenkins_http_port }}{{ jenkins_url_prefix }}/cli/\"", "line": 37, "detection_span": [32, 42], "with_context": "# Ansible file: geerlingguy_ansible-role-jenkins-tasks-main.yml\n\n- name: Ensure Jenkins is started and runs on startup.\nservice: name=jenkins state=started enabled=yes\n\n- name: Wait for Jenkins to start up before proceeding.\nuri:\n37:     url: \"http://{{ jenkins_hostname }}:{{ jenkins_http_port }}{{ jenkins_url_prefix }}/cli/\"\nmethod: GET\nreturn_content: \"yes\"\ntimeout: 5\nbody_format: raw\nfollow_redirects: \"no\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_ansible-role-jenkins-tasks-main.yml\n# Target line: 37\n\n     32: - name: Ensure Jenkins is started and runs on startup.\n     33:   service: name=jenkins state=started enabled=yes\n     34: \n     35: - name: Wait for Jenkins to start up before proceeding.\n     36:   uri:\n>>>  37:     url: \"http://{{ jenkins_hostname }}:{{ jenkins_http_port }}{{ jenkins_url_prefix }}/cli/\"\n     38:     method: GET\n     39:     return_content: \"yes\"\n     40:     timeout: 5\n     41:     body_format: raw\n     42:     follow_redirects: \"no\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "enthought_edx_ansible-playbooks-roles-common_vars-defaults-main.yml", "content": "COMMON_UBUNTU_APT_KEYSERVER: \"http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=\"", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-common_vars-defaults-main.yml\n\n\nCOMMON_ENVIRONMENT: 'default_env'\nCOMMON_DEPLOYMENT: 'default_deployment'\nCOMMON_PYPI_MIRROR_URL: 'https://pypi.python.org/simple'\nCOMMON_NPM_MIRROR_URL: 'http://registry.npmjs.org'\n44: COMMON_UBUNTU_APT_KEYSERVER: \"http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=\"\n\nCOMMON_EDX_PPA: \"deb http://ppa.edx.org {{ ansible_distribution_release }} main\"\nCOMMON_EDX_PPA_KEY_SERVER: \"keyserver.ubuntu.com\"\nCOMMON_EDX_PPA_KEY_ID: \"69464050\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-common_vars-defaults-main.yml\n# Target line: 44\n\n     39:     \n     40: COMMON_ENVIRONMENT: 'default_env'\n     41: COMMON_DEPLOYMENT: 'default_deployment'\n     42: COMMON_PYPI_MIRROR_URL: 'https://pypi.python.org/simple'\n     43: COMMON_NPM_MIRROR_URL: 'http://registry.npmjs.org'\n>>>  44: COMMON_UBUNTU_APT_KEYSERVER: \"http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=\"\n     45: \n     46: COMMON_EDX_PPA: \"deb http://ppa.edx.org {{ ansible_distribution_release }} main\"\n     47: COMMON_EDX_PPA_KEY_SERVER: \"keyserver.ubuntu.com\"\n     48: COMMON_EDX_PPA_KEY_ID: \"69464050\"\n     49: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "trustedanalytics_platform-ansible-defaults-yum_repos.yml", "content": "baseurl: http://dl.fedoraproject.org/pub/epel/6/x86_64/", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: trustedanalytics_platform-ansible-defaults-yum_repos.yml\n\nname: Extra Packages for Enterprise Linux 6 - $basearch\nenabled: 1\nfailovermethod: priority\ngpgcheck: 1\ngpgkey: http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\n9:     baseurl: http://dl.fedoraproject.org/pub/epel/6/x86_64/\nsslverify: true\nepel-testing:\nname: Extra Packages for Enterprise Linux 6 - Testing - $basearch\nenabled: 1\nfailovermethod: priority", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: trustedanalytics_platform-ansible-defaults-yum_repos.yml\n# Target line: 9\n\n      4:     name: Extra Packages for Enterprise Linux 6 - $basearch\n      5:     enabled: 1\n      6:     failovermethod: priority\n      7:     gpgcheck: 1\n      8:     gpgkey: http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\n>>>   9:     baseurl: http://dl.fedoraproject.org/pub/epel/6/x86_64/\n     10:     sslverify: true\n     11:   epel-testing:\n     12:     name: Extra Packages for Enterprise Linux 6 - Testing - $basearch\n     13:     enabled: 1\n     14:     failovermethod: priority\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "ArdanaCLM_cobbler-ansible-roles-cobbler-tasks-set-vars.yml", "content": "deployer_server: \"http://{{ cobbler_server_ip_addr | ipwrap }}:{{ deployer_server_port }}\"", "line": 88, "detection_span": [83, 93], "with_context": "# Ansible file: ArdanaCLM_cobbler-ansible-roles-cobbler-tasks-set-vars.yml\n\ncobbler_name_server: \"{{ cobbler_server_ip_addr }}\"\nwhen: cobbler_name_server is not defined\n\n- name: cobbler | set-vars | Set local repo ip url\nset_fact:\n88:     deployer_server: \"http://{{ cobbler_server_ip_addr | ipwrap }}:{{ deployer_server_port }}\"\nwhen: deployer_server is not defined\n\n# Set vars for currently used rhel distro\n- include: set-rhel-vars.yml\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArdanaCLM_cobbler-ansible-roles-cobbler-tasks-set-vars.yml\n# Target line: 88\n\n     83:     cobbler_name_server: \"{{ cobbler_server_ip_addr }}\"\n     84:   when: cobbler_name_server is not defined\n     85: \n     86: - name: cobbler | set-vars | Set local repo ip url\n     87:   set_fact:\n>>>  88:     deployer_server: \"http://{{ cobbler_server_ip_addr | ipwrap }}:{{ deployer_server_port }}\"\n     89:   when: deployer_server is not defined\n     90: \n     91: # Set vars for currently used rhel distro\n     92: - include: set-rhel-vars.yml\n     93: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "pulibrary_princeton_ansible-roles-ojs-molecule-default-converge.yml", "content": "method: md5", "line": 48, "detection_span": [43, 53], "with_context": "# Ansible file: pulibrary_princeton_ansible-roles-ojs-molecule-default-converge.yml\n\nmethod: md5\n- type: host\ndatabase: ojs_db\nuser: ojs_db_user\naddress: 127.0.0.1/32\n48:           method: md5\ntasks:\n- name: \"Include roles/psql\"\ninclude_role:\nname: \"psql\"\n- name: \"Include roles/ojs\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: pulibrary_princeton_ansible-roles-ojs-molecule-default-converge.yml\n# Target line: 48\n\n     43:           method: md5\n     44:         - type: host\n     45:           database: ojs_db\n     46:           user: ojs_db_user\n     47:           address: 127.0.0.1/32\n>>>  48:           method: md5\n     49:   tasks:\n     50:     - name: \"Include roles/psql\"\n     51:       include_role:\n     52:         name: \"psql\"\n     53:     - name: \"Include roles/ojs\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "voc_cm-ansible-roles-common-tasks-ssh_known_hosts.yml", "content": "lineinfile: dest=/etc/ssh/ssh_known_hosts state=present", "line": 16, "detection_span": [11, 21], "with_context": "# Ansible file: voc_cm-ansible-roles-common-tasks-ssh_known_hosts.yml\n\nlineinfile: dest=/etc/ssh/ssh_known_hosts state=present\nregexp=\"^mng.ber.c3voc.de.*ecdsa-sha2-nistp521\\ .*\"\nline=\"mng.ber.c3voc.de,2001:67c:20a0:e::163,195.54.164.163 ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBADFt5dEapTckFu1xDMmTdELUPSrtOQiyQM18n9d/M1BkIS5mjaobRzLkcALqhenzG0OJMIdQmxRbQECBYQdomZb9gF02MMExqppESajZBHbBPno/59z1TgMRfZ9+Q353ck4yz9IXdK7cjw+6uvH+m//fom8xnaZW5xg/QlqxO46KgQ2Gw==\"\n\n- name: add \u00bbgithub.com\u00ab to global known_hosts file\n16:     lineinfile: dest=/etc/ssh/ssh_known_hosts state=present\nregexp=\"^github.com,192.30.252.131.*ssh-rsa\\ .*\"\nline=\"github.com,192.30.252.131,192.30.252.129 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: voc_cm-ansible-roles-common-tasks-ssh_known_hosts.yml\n# Target line: 16\n\n     11:     lineinfile: dest=/etc/ssh/ssh_known_hosts state=present\n     12:                 regexp=\"^mng.ber.c3voc.de.*ecdsa-sha2-nistp521\\ .*\"\n     13:                 line=\"mng.ber.c3voc.de,2001:67c:20a0:e::163,195.54.164.163 ecdsa-sha2-nistp521 AAAAE2VjZHNhLXNoYTItbmlzdHA1MjEAAAAIbmlzdHA1MjEAAACFBADFt5dEapTckFu1xDMmTdELUPSrtOQiyQM18n9d/M1BkIS5mjaobRzLkcALqhenzG0OJMIdQmxRbQECBYQdomZb9gF02MMExqppESajZBHbBPno/59z1TgMRfZ9+Q353ck4yz9IXdK7cjw+6uvH+m//fom8xnaZW5xg/QlqxO46KgQ2Gw==\"\n     14: \n     15:   - name: add \u00bbgithub.com\u00ab to global known_hosts file\n>>>  16:     lineinfile: dest=/etc/ssh/ssh_known_hosts state=present\n     17:                 regexp=\"^github.com,192.30.252.131.*ssh-rsa\\ .*\"\n     18:                 line=\"github.com,192.30.252.131,192.30.252.129 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "cloudalchemy_ansible-grafana-.circleci-config.yml", "content": "GIT_COMMIT_DESC: git log --format=%B -n 1 ${CIRCLE_SHA1}", "line": 49, "detection_span": [44, 54], "with_context": "# Ansible file: cloudalchemy_ansible-grafana-.circleci-config.yml\n\nrelease:\nexecutor: python\nenvironment:\nGIT_MAIL: cloudalchemybot@gmail.com\nGIT_USER: cloudalchemybot\n49:       GIT_COMMIT_DESC: git log --format=%B -n 1 ${CIRCLE_SHA1}\nsteps:\n- checkout\n- setup_remote_docker\n- run: pip install git-semver\n- run: git config --global user.email \"${GIT_MAIL}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cloudalchemy_ansible-grafana-.circleci-config.yml\n# Target line: 49\n\n     44:   release:\n     45:     executor: python\n     46:     environment:\n     47:       GIT_MAIL: cloudalchemybot@gmail.com\n     48:       GIT_USER: cloudalchemybot\n>>>  49:       GIT_COMMIT_DESC: git log --format=%B -n 1 ${CIRCLE_SHA1}\n     50:     steps:\n     51:       - checkout\n     52:       - setup_remote_docker\n     53:       - run: pip install git-semver\n     54:       - run: git config --global user.email \"${GIT_MAIL}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "ArdanaCLM_monasca-ansible-roles-monasca-persister-tasks-java_configure.yml", "content": "when: not monasca_persister_jar_old_md5_file_result.stat.exists or", "line": 72, "detection_span": [67, 77], "with_context": "# Ansible file: ArdanaCLM_monasca-ansible-roles-monasca-persister-tasks-java_configure.yml\n\nregister: monasca_persister_jar_old_md5_result\n\n- name: Mark Monasca Persister for restart if new monasca-persister jar\ndebug: msg=\"restart monasca-persister because monasca-persister jar changed\"\nchanged_when: True\n72:   when: not monasca_persister_jar_old_md5_file_result.stat.exists or\n( monasca_persister_jar_old_md5_file_result.stat.exists and\n( monasca_persister_jar_result.stat.md5 !=\n( monasca_persister_jar_old_md5_result.content | b64decode ) ) )\nregister: ardana_notify_monasca_persister_restart_required\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArdanaCLM_monasca-ansible-roles-monasca-persister-tasks-java_configure.yml\n# Target line: 72\n\n     67:   register: monasca_persister_jar_old_md5_result\n     68: \n     69: - name: Mark Monasca Persister for restart if new monasca-persister jar\n     70:   debug: msg=\"restart monasca-persister because monasca-persister jar changed\"\n     71:   changed_when: True\n>>>  72:   when: not monasca_persister_jar_old_md5_file_result.stat.exists or\n     73:         ( monasca_persister_jar_old_md5_file_result.stat.exists and\n     74:           ( monasca_persister_jar_result.stat.md5 !=\n     75:             ( monasca_persister_jar_old_md5_result.content | b64decode ) ) )\n     76:   register: ardana_notify_monasca_persister_restart_required\n     77: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "ArdanaCLM_ardana-ansible-roles-service-guest-image-tasks-upload_image.yml", "content": "shell: \"md5sum {{ guest_image_tempdir.stdout }}/{{ IMAGE_NAME }}*.qcow2 | cut -d ' ' -f 1\"", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: ArdanaCLM_ardana-ansible-roles-service-guest-image-tasks-upload_image.yml\n\n- ses_config_path is defined\n- ses_nova_set_images_type | default(False)\n\n# get the md5sum for the new image\n- name: service-guest-image | upload-image | get checksum for new image\n27:   shell: \"md5sum {{ guest_image_tempdir.stdout }}/{{ IMAGE_NAME }}*.qcow2 | cut -d ' ' -f 1\"\nregister: image_checksum\nrun_once: true\n\n# verify if the md5sum match and if the image is in ACTIVE status\n- name: service-guest-image | upload-image | find image that matches the checksum and name", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ArdanaCLM_ardana-ansible-roles-service-guest-image-tasks-upload_image.yml\n# Target line: 27\n\n     22:     - ses_config_path is defined\n     23:     - ses_nova_set_images_type | default(False)\n     24: \n     25: # get the md5sum for the new image\n     26: - name: service-guest-image | upload-image | get checksum for new image\n>>>  27:   shell: \"md5sum {{ guest_image_tempdir.stdout }}/{{ IMAGE_NAME }}*.qcow2 | cut -d ' ' -f 1\"\n     28:   register: image_checksum\n     29:   run_once: true\n     30: \n     31: # verify if the md5sum match and if the image is in ACTIVE status\n     32: - name: service-guest-image | upload-image | find image that matches the checksum and name\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "myrepo5588_openshift-ansible-roles-openshift_web_console-files-console-template.yaml", "content": "- /bin/sh", "line": 76, "detection_span": [71, 81], "with_context": "# Ansible file: myrepo5588_openshift-ansible-roles-openshift_web_console-files-console-template.yaml\n\nport: 8443\nscheme: HTTPS\nlivenessProbe:\nexec:\ncommand:\n76:                 - /bin/sh\n- -c\n- |-\nif [[ ! -f /tmp/webconsole-config.hash ]]; then \\\nmd5sum /var/webconsole-config/webconsole-config.yaml > /tmp/webconsole-config.hash; \\\nelif [[ $(md5sum /var/webconsole-config/webconsole-config.yaml) != $(cat /tmp/webconsole-config.hash) ]]; then \\", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: myrepo5588_openshift-ansible-roles-openshift_web_console-files-console-template.yaml\n# Target line: 76\n\n     71:               port: 8443\n     72:               scheme: HTTPS\n     73:           livenessProbe:\n     74:             exec:\n     75:               command:\n>>>  76:                 - /bin/sh\n     77:                 - -c\n     78:                 - |-\n     79:                   if [[ ! -f /tmp/webconsole-config.hash ]]; then \\\n     80:                     md5sum /var/webconsole-config/webconsole-config.yaml > /tmp/webconsole-config.hash; \\\n     81:                   elif [[ $(md5sum /var/webconsole-config/webconsole-config.yaml) != $(cat /tmp/webconsole-config.hash) ]]; then \\\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "oVirt_ovirt-ansible-collection-roles-infra-roles-aaa_jdbc-tasks-main.yml", "content": "# FIXME: Support only add, if the user is removed from list, it's not removed from the group:", "line": 77, "detection_span": [72, 82], "with_context": "# Ansible file: oVirt_ovirt-ansible-collection-roles-infra-roles-aaa_jdbc-tasks-main.yml\n\nfailed_when: \"out_groups.rc != 5 and out_groups.rc != 0 and out_groups.rc != 4\"\ntags:\n- ovirt-aaa-jdbc\n- user_groups\n\n77: # FIXME: Support only add, if the user is removed from list, it's not removed from the group:\n- name: Manage groups members\ncommand: \"{{ aaa_jdbc_prefix }}/ovirt-aaa-jdbc-tool group-manage {{ (item.state is undefined or item.state == 'present') | ternary('useradd','userdel') }} {{ item.0.name }} --user {{ item.1 }}\"\nwith_subelements:\n- \"{{ user_groups | default([]) }}\"\n- users", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: oVirt_ovirt-ansible-collection-roles-infra-roles-aaa_jdbc-tasks-main.yml\n# Target line: 77\n\n     72:   failed_when: \"out_groups.rc != 5 and out_groups.rc != 0 and out_groups.rc != 4\"\n     73:   tags:\n     74:     - ovirt-aaa-jdbc\n     75:     - user_groups\n     76: \n>>>  77: # FIXME: Support only add, if the user is removed from list, it's not removed from the group:\n     78: - name: Manage groups members\n     79:   command: \"{{ aaa_jdbc_prefix }}/ovirt-aaa-jdbc-tool group-manage {{ (item.state is undefined or item.state == 'present') | ternary('useradd','userdel') }} {{ item.0.name }} --user {{ item.1 }}\"\n     80:   with_subelements:\n     81:     - \"{{ user_groups | default([]) }}\"\n     82:     - users\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_network_config-defaults-main.yml", "content": "# All variables within this role should have a prefix of \"tripleo_network_config\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_network_config-defaults-main.yml\n\n# under the License.\n\n\n# All variables intended for modification should be placed in this file.\n\n20: # All variables within this role should have a prefix of \"tripleo_network_config\"\ntripleo_network_config_update: False\ntripleo_network_config_async_poll: 3\ntripleo_network_config_async_timeout: 300\ntripleo_network_config_bridge_name: br-ex\ntripleo_network_config_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_network_config-defaults-main.yml\n# Target line: 20\n\n     15: # under the License.\n     16: \n     17: \n     18: # All variables intended for modification should be placed in this file.\n     19: \n>>>  20: # All variables within this role should have a prefix of \"tripleo_network_config\"\n     21: tripleo_network_config_update: False\n     22: tripleo_network_config_async_poll: 3\n     23: tripleo_network_config_async_timeout: 300\n     24: tripleo_network_config_bridge_name: br-ex\n     25: tripleo_network_config_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack_tripleo-validations-roles-undercloud_debug-defaults-main.yml", "content": "# Parse following ini files, retrieving value of the 'debug' key", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: openstack_tripleo-validations-roles-undercloud_debug-defaults-main.yml\n\n---\n# Fail if the 'debug' key is set to value of 'debug_check'\ndebug_check: true\n\n5: # Parse following ini files, retrieving value of the 'debug' key\nservices_conf_files:\n- /var/lib/config-data/puppet-generated/nova/etc/nova/nova.conf\n- /var/lib/config-data/puppet-generated/neutron/etc/neutron/neutron.conf\n- /var/lib/config-data/puppet-generated/ceilometer/etc/ceilometer/ceilometer.conf\n- /var/lib/config-data/puppet-generated/heat/etc/heat/heat.conf", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-validations-roles-undercloud_debug-defaults-main.yml\n# Target line: 5\n\n      1: ---\n      2: # Fail if the 'debug' key is set to value of 'debug_check'\n      3: debug_check: true\n      4: \n>>>   5: # Parse following ini files, retrieving value of the 'debug' key\n      6: services_conf_files:\n      7:   - /var/lib/config-data/puppet-generated/nova/etc/nova/nova.conf\n      8:   - /var/lib/config-data/puppet-generated/neutron/etc/neutron/neutron.conf\n      9:   - /var/lib/config-data/puppet-generated/ceilometer/etc/ceilometer/ceilometer.conf\n     10:   - /var/lib/config-data/puppet-generated/heat/etc/heat/heat.conf\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "crv4all_openshift-ansible-roles-openshift_control_plane-tasks-bootstrap.yml", "content": "# TODO: create a module for this command.", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: crv4all_openshift-ansible-roles-openshift_control_plane-tasks-bootstrap.yml\n\n---\n2: # TODO: create a module for this command.\n# oc_serviceaccounts_kubeconfig\n- name: create service account kubeconfig with csr rights\ncommand: >\n{{ openshift_client_binary }} --config={{ openshift.common.config_base }}/master/admin.kubeconfig serviceaccounts create-kubeconfig {{ openshift_master_csr_sa }} -n {{ openshift_master_csr_namespace }}\nregister: kubeconfig_out", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: crv4all_openshift-ansible-roles-openshift_control_plane-tasks-bootstrap.yml\n# Target line: 2\n\n      1: ---\n>>>   2: # TODO: create a module for this command.\n      3: # oc_serviceaccounts_kubeconfig\n      4: - name: create service account kubeconfig with csr rights\n      5:   command: >\n      6:     {{ openshift_client_binary }} --config={{ openshift.common.config_base }}/master/admin.kubeconfig serviceaccounts create-kubeconfig {{ openshift_master_csr_sa }} -n {{ openshift_master_csr_namespace }}\n      7:   register: kubeconfig_out\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "galaxyproject_usegalaxy-playbook-env-common-host_vars-jetstream2.galaxyproject.org.yml", "content": "#  prefix: \"{{ _pulsar_dependencies_dir }}/_conda\"", "line": 63, "detection_span": [58, 68], "with_context": "# Ansible file: galaxyproject_usegalaxy-playbook-env-common-host_vars-jetstream2.galaxyproject.org.yml\n\namqp_publish_retry_interval_step: 10\namqp_publish_retry_interval_max: 60\ndependency_resolution:\nresolvers:\n#- type: conda\n63:       #  prefix: \"{{ _pulsar_dependencies_dir }}/_conda\"\n#- type: conda\n#  prefix: \"{{ _jetstream_scratch_root }}/conda\"\n#  auto_init: true\n#  auto_install: true\n#- type: tool_shed_packages", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: galaxyproject_usegalaxy-playbook-env-common-host_vars-jetstream2.galaxyproject.org.yml\n# Target line: 63\n\n     58:   amqp_publish_retry_interval_step: 10\n     59:   amqp_publish_retry_interval_max: 60\n     60:   dependency_resolution:\n     61:     resolvers:\n     62:       #- type: conda\n>>>  63:       #  prefix: \"{{ _pulsar_dependencies_dir }}/_conda\"\n     64:       #- type: conda\n     65:       #  prefix: \"{{ _jetstream_scratch_root }}/conda\"\n     66:       #  auto_init: true\n     67:       #  auto_install: true\n     68:       #- type: tool_shed_packages\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_serverless_ml_workshop-defaults-main.yml", "content": "## When you go to create a ServiceNow ticket to create", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_serverless_ml_workshop-defaults-main.yml\n\nbecome_override: false\nocp_username: opentlc-mgr\nsilent: false\n\n## ADD Variables here for use in your role, if needed.\n8: ## When you go to create a ServiceNow ticket to create\n## the RHPDS catalog item, you can ask the engineer to feed\n## values the requesting user enters in the form in RHPDS\n## into these variables. Everything you add here should be\n## prefixed with the role name: ocp4_workload_serverless_ml_workshop\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles_ocp_workloads-ocp4_workload_serverless_ml_workshop-defaults-main.yml\n# Target line: 8\n\n      3: become_override: false\n      4: ocp_username: opentlc-mgr\n      5: silent: false\n      6: \n      7: ## ADD Variables here for use in your role, if needed.\n>>>   8: ## When you go to create a ServiceNow ticket to create\n      9: ## the RHPDS catalog item, you can ask the engineer to feed\n     10: ## values the requesting user enters in the form in RHPDS\n     11: ## into these variables. Everything you add here should be\n     12: ## prefixed with the role name: ocp4_workload_serverless_ml_workshop\n     13: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "vijaykakkar_ansible-automation-provisioner-sample_workshops-sample-vars-f5.yml", "content": "# name prefix for all the VMs", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: vijaykakkar_ansible-automation-provisioner-sample_workshops-sample-vars-f5.yml\n\n---\n# region where the nodes will live\nec2_region: us-east-1\n4: # name prefix for all the VMs\nec2_name_prefix: TESTWORKSHOP\n# amount of work benches to provision\nstudent_total: 2\n# workshp runs in F5 mode\nworkshop_type: f5", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: vijaykakkar_ansible-automation-provisioner-sample_workshops-sample-vars-f5.yml\n# Target line: 4\n\n      1: ---\n      2: # region where the nodes will live\n      3: ec2_region: us-east-1\n>>>   4: # name prefix for all the VMs\n      5: ec2_name_prefix: TESTWORKSHOP\n      6: # amount of work benches to provision\n      7: student_total: 2\n      8: # workshp runs in F5 mode\n      9: workshop_type: f5\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "litmuschaos_litmus-.github-stale.yml", "content": "# Label to use when marking an issue as stale", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: litmuschaos_litmus-.github-stale.yml\n\ndaysUntilClose: 7\n# Issues with these labels will never be considered stale\nexemptLabels:\n- pinned\n- security\n9: # Label to use when marking an issue as stale\nstaleLabel: wontfix\n# Comment to post when marking an issue as stale. Set to `false` to disable\nmarkComment: >\nThis issue has been automatically marked as stale because it has not had\nrecent activity. It will be closed if no further activity occurs. Thank you", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: litmuschaos_litmus-.github-stale.yml\n# Target line: 9\n\n      4: daysUntilClose: 7\n      5: # Issues with these labels will never be considered stale\n      6: exemptLabels:\n      7:   - pinned\n      8:   - security\n>>>   9: # Label to use when marking an issue as stale\n     10: staleLabel: wontfix\n     11: # Comment to post when marking an issue as stale. Set to `false` to disable\n     12: markComment: >\n     13:   This issue has been automatically marked as stale because it has not had\n     14:   recent activity. It will be closed if no further activity occurs. Thank you\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "integr8ly_ansible-tower-configuration-playbooks-roles-integreatly-tasks-bootstrap_install.yml", "content": "# Need to use this one liner due to known bug on tower https://github.com/ansible/tower-cli/issues/331", "line": 169, "detection_span": [164, 174], "with_context": "# Ansible file: integr8ly_ansible-tower-configuration-playbooks-roles-integreatly-tasks-bootstrap_install.yml\n\n164:   until: remove_host_ref_raw is succeeded\n165:   retries: 10\n166:   delay: 5\n167:\n168: - name: Retrieve cluster provisioning vars inventory\n169:   # Need to use this one liner due to known bug on tower https://github.com/ansible/tower-cli/issues/331\n170:   shell: \"tower-cli inventory get -n \\\"{{ cluster_provisioning_vars_inventory }}\\\" -f yaml | yq r - variables\"\n171:   register: cluster_provisioning_vars_raw\n172:\n173: - set_fact:\ncluster_provisioning_vars: \"{{ cluster_provisioning_vars_raw.stdout | from_yaml }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: integr8ly_ansible-tower-configuration-playbooks-roles-integreatly-tasks-bootstrap_install.yml\n# Target line: 169\n\n    164:   until: remove_host_ref_raw is succeeded\n    165:   retries: 10\n    166:   delay: 5\n    167: \n    168: - name: Retrieve cluster provisioning vars inventory\n>>> 169:   # Need to use this one liner due to known bug on tower https://github.com/ansible/tower-cli/issues/331\n    170:   shell: \"tower-cli inventory get -n \\\"{{ cluster_provisioning_vars_inventory }}\\\" -f yaml | yq r - variables\"\n    171:   register: cluster_provisioning_vars_raw\n    172: \n    173: - set_fact:\n    174:     cluster_provisioning_vars: \"{{ cluster_provisioning_vars_raw.stdout | from_yaml }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sensu_sensu-ansible-tasks-Amazon-rabbit.yml", "content": "# causing dependency issues during installs", "line": 51, "detection_span": [46, 56], "with_context": "# Ansible file: sensu_sensu-ansible-tasks-Amazon-rabbit.yml\n\n- rabbitmq\n- rabbitmq-erlang\n\n# Hard dependency for rabbitmq-server, however, typically comes from EPEL, so\n# we simply install it here, as we purposely disable epel when installing rabbitmq\n51: # causing dependency issues during installs\n- name: Ensure socat is installed\ntags: rabbitmq\nyum:\nname: socat\nstate: present", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: sensu_sensu-ansible-tasks-Amazon-rabbit.yml\n# Target line: 51\n\n     46:     - rabbitmq\n     47:     - rabbitmq-erlang\n     48: \n     49: # Hard dependency for rabbitmq-server, however, typically comes from EPEL, so\n     50: # we simply install it here, as we purposely disable epel when installing rabbitmq\n>>>  51: # causing dependency issues during installs\n     52: - name: Ensure socat is installed\n     53:   tags: rabbitmq\n     54:   yum:\n     55:     name: socat\n     56:     state: present\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-openstack_infrared-plugins-packstack-create_external_network.yml", "content": "# TODO(yfried): enable if/when packstack uses floating ips and localhost can access cloud", "line": 15, "detection_span": [10, 20], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n\ngather_facts: yes\nany_errors_fatal: true\nhosts: controller[0]\ntags:\n- external_net\n15: # TODO(yfried): enable if/when packstack uses floating ips and localhost can access cloud\n#  hosts: localhost\n#  vars:\n#      first_controller: \"{{ groups.controller | first }}\"\nvars_files:\n- \"{{ install.network.service }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n# Target line: 15\n\n     10:   gather_facts: yes\n     11:   any_errors_fatal: true\n     12:   hosts: controller[0]\n     13:   tags:\n     14:       - external_net\n>>>  15: # TODO(yfried): enable if/when packstack uses floating ips and localhost can access cloud\n     16: #  hosts: localhost\n     17: #  vars:\n     18: #      first_controller: \"{{ groups.controller | first }}\"\n     19:   vars_files:\n     20:       - \"{{ install.network.service }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "debops_debops-ansible-roles-sks-defaults-main.yml", "content": "# FIXME: Move configuration from the template.", "line": 106, "detection_span": [101, 111], "with_context": "# Ansible file: debops_debops-ansible-roles-sks-defaults-main.yml\n\n101:\n# ]]]\n103: # .. envvar:: sks__ferm__dependent_rules [[[\n104: #\n105: # Configuration for the :ref:`debops.ferm` Ansible role.\n106: # FIXME: Move configuration from the template.\n107: sks__ferm__dependent_rules: []\n108:\n# ]]]\n110: # .. envvar:: sks__nginx__dependent_servers [[[\n111: #", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: debops_debops-ansible-roles-sks-defaults-main.yml\n# Target line: 106\n\n    101: \n    102:                                                                    # ]]]\n    103: # .. envvar:: sks__ferm__dependent_rules [[[\n    104: #\n    105: # Configuration for the :ref:`debops.ferm` Ansible role.\n>>> 106: # FIXME: Move configuration from the template.\n    107: sks__ferm__dependent_rules: []\n    108: \n    109:                                                                    # ]]]\n    110: # .. envvar:: sks__nginx__dependent_servers [[[\n    111: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openfoodfoundation_ofn-install-inventory-host_vars-_example.com-secrets.example.yml", "content": "#bugsnag_key: ''", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: openfoodfoundation_ofn-install-inventory-host_vars-_example.com-secrets.example.yml\n\n# datadog_key: 'API_key_for_the_OFN_account'\n\n# Bugsnag collects all errors and notifies you.\n# https://github.com/openfoodfoundation/ofn-install/wiki/Issue-reporting\n#\n64: #bugsnag_key: ''\n\n# Example settings for integrations like Zapier.\n# ----------------------------------------------\n# Generate a strong password with this command: `openssl rand -hex 128`.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openfoodfoundation_ofn-install-inventory-host_vars-_example.com-secrets.example.yml\n# Target line: 64\n\n     59: # datadog_key: 'API_key_for_the_OFN_account'\n     60: \n     61: # Bugsnag collects all errors and notifies you.\n     62: # https://github.com/openfoodfoundation/ofn-install/wiki/Issue-reporting\n     63: #\n>>>  64: #bugsnag_key: ''\n     65: \n     66: # Example settings for integrations like Zapier.\n     67: # ----------------------------------------------\n     68: # Generate a strong password with this command: `openssl rand -hex 128`.\n     69: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-openstack_infrared-plugins-openstack-post.yml", "content": "# FIXME: move this change to a different review", "line": 50, "detection_span": [45, 55], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-openstack-post.yml\n\nport: \"{{ openstack_ports |\nselectattr('device_id', 'equalto', server.id) |\nselectattr('mac_address', 'equalto', nic.macaddress) |\nlist | first }}\"\n# todo(yfried): add subnets to know if dhcp is on or no\n50:         # FIXME: move this change to a different review\ncopy:\ncontent: |\nBOOTPROTO=static\nIPADDR={{ port.fixed_ips[0].ip_address }}\nNETMASK=255.255.255.0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-openstack-post.yml\n# Target line: 50\n\n     45:             port: \"{{ openstack_ports |\n     46:                         selectattr('device_id', 'equalto', server.id) |\n     47:                         selectattr('mac_address', 'equalto', nic.macaddress) |\n     48:                         list | first }}\"\n     49:             # todo(yfried): add subnets to know if dhcp is on or no\n>>>  50:         # FIXME: move this change to a different review\n     51:         copy:\n     52:             content: |\n     53:                 BOOTPROTO=static\n     54:                 IPADDR={{ port.fixed_ips[0].ip_address }}\n     55:                 NETMASK=255.255.255.0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SalientCRGT_openshift-ansible-roles-openshift_openstack-tasks-container-storage-setup.yml", "content": "# TODO(shadower): Find out which CentOS version supports overlayfs2", "line": 35, "detection_span": [30, 40], "with_context": "# Ansible file: SalientCRGT_openshift-ansible-roles-openshift_openstack-tasks-container-storage-setup.yml\n\ndest: /etc/sysconfig/docker-storage-setup\nowner: root\ngroup: root\nmode: 0644\n\n35:   # TODO(shadower): Find out which CentOS version supports overlayfs2\nwhen:\n- ansible_distribution == \"CentOS\"\n\n- name: Check if docker is running\ncommand: systemctl status {{ openshift_docker_service_name }}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: SalientCRGT_openshift-ansible-roles-openshift_openstack-tasks-container-storage-setup.yml\n# Target line: 35\n\n     30:         dest: /etc/sysconfig/docker-storage-setup\n     31:         owner: root\n     32:         group: root\n     33:         mode: 0644\n     34: \n>>>  35:   # TODO(shadower): Find out which CentOS version supports overlayfs2\n     36:   when:\n     37:     - ansible_distribution == \"CentOS\"\n     38: \n     39: - name: Check if docker is running\n     40:   command: systemctl status {{ openshift_docker_service_name }}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-defaults-main.yml", "content": "# https://bugzilla.redhat.com/show_bug.cgi?id=1897603", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-defaults-main.yml\n\n# change the manifests.\nocp4_network_ovn_install_workaround: false\n\n# On OpenStack 16 device ids are not truncated to 20 characters.\n# This MachineConfig adds a udev configuration to work around this issue.\n10: # https://bugzilla.redhat.com/show_bug.cgi?id=1897603\nocp4_scsi_device_detection_workaround: false\n\n# Configure OCP4 install to not configure the OpenStack external network\n# and have Ansible manage it instead.\nocp4_ansible_managed_osp_external_network: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-host-ocp4-installer-defaults-main.yml\n# Target line: 10\n\n      5: # change the manifests.\n      6: ocp4_network_ovn_install_workaround: false\n      7: \n      8: # On OpenStack 16 device ids are not truncated to 20 characters.\n      9: # This MachineConfig adds a udev configuration to work around this issue.\n>>>  10: # https://bugzilla.redhat.com/show_bug.cgi?id=1897603\n     11: ocp4_scsi_device_detection_workaround: false\n     12: \n     13: # Configure OCP4 install to not configure the OpenStack external network\n     14: # and have Ansible manage it instead.\n     15: ocp4_ansible_managed_osp_external_network: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "IBM_z_ansible_collections_samples-zos_concepts-data_transfer-dump_pack_ftp_unpack_restore-changelog.yml", "content": "#                 - bug fixes", "line": 17, "detection_span": [12, 22], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-data_transfer-dump_pack_ftp_unpack_restore-changelog.yml\n\n#             added:\n#                 - new features are added\n#             deprecated:\n#                 - features being removed in the future\n#             fixed:\n17: #                 - bug fixes\n#             minor:\n#                 - changes in existing functionality\n#             removed:\n#                 - features removed no longer available\n#             security:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_concepts-data_transfer-dump_pack_ftp_unpack_restore-changelog.yml\n# Target line: 17\n\n     12: #             added:\n     13: #                 - new features are added\n     14: #             deprecated:\n     15: #                 - features being removed in the future\n     16: #             fixed:\n>>>  17: #                 - bug fixes\n     18: #             minor:\n     19: #                 - changes in existing functionality\n     20: #             removed:\n     21: #                 - features removed no longer available\n     22: #             security:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "devopsschool-training-notes_Tesco-Git-Ansible-Batch2-Nov-final-roles-web-meta-main.yml", "content": "# - GPL-2.0-or-later", "line": 13, "detection_span": [8, 18], "with_context": "# Ansible file: devopsschool-training-notes_Tesco-Git-Ansible-Batch2-Nov-final-roles-web-meta-main.yml\n\n# issue_tracker_url: http://example.com/issue/tracker\n\n# Choose a valid license ID from https://spdx.org - some suggested licenses:\n# - BSD-3-Clause (default)\n# - MIT\n13:   # - GPL-2.0-or-later\n# - GPL-3.0-only\n# - Apache-2.0\n# - CC-BY-4.0\nlicense: license (GPL-2.0-or-later, MIT, etc)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: devopsschool-training-notes_Tesco-Git-Ansible-Batch2-Nov-final-roles-web-meta-main.yml\n# Target line: 13\n\n      8:   # issue_tracker_url: http://example.com/issue/tracker\n      9: \n     10:   # Choose a valid license ID from https://spdx.org - some suggested licenses:\n     11:   # - BSD-3-Clause (default)\n     12:   # - MIT\n>>>  13:   # - GPL-2.0-or-later\n     14:   # - GPL-3.0-only\n     15:   # - Apache-2.0\n     16:   # - CC-BY-4.0\n     17:   license: license (GPL-2.0-or-later, MIT, etc)\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "AtlasOfLivingAustralia_ala-install-ansible-roles-ansible-elasticsearch-.github-stale.yml", "content": "# Number of days of inactivity before an stale issue is closed", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-ansible-elasticsearch-.github-stale.yml\n\n---\n# Number of days of inactivity before an issue becomes stale\ndaysUntilStale: 90\n\n5: # Number of days of inactivity before an stale issue is closed\ndaysUntilClose: 30\n\n# Label to use when marking an issue as stale\nstaleLabel: triage/stale\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AtlasOfLivingAustralia_ala-install-ansible-roles-ansible-elasticsearch-.github-stale.yml\n# Target line: 5\n\n      1: ---\n      2: # Number of days of inactivity before an issue becomes stale\n      3: daysUntilStale: 90\n      4: \n>>>   5: # Number of days of inactivity before an stale issue is closed\n      6: daysUntilClose: 30\n      7: \n      8: # Label to use when marking an issue as stale\n      9: staleLabel: triage/stale\n     10: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml", "content": "# MAS Cluster Issuer", "line": 68, "detection_span": [63, 73], "with_context": "# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n\n# Do you want to update a DNS entry if it already exists?\nupdate_dns: \"{{ lookup('env', 'UPDATE_DNS_ENTRIES') | default(true, true) }}\"\n# e.g: \"apps.joaopauloksn.cp.fyre.ibm.com\" Default will be always from cluster ingress CR.\ncustom_ocp_ingress: \"{{ lookup('env', 'OCP_INGRESS') | default(None, true)}}\"\n\n68: # MAS Cluster Issuer\n# -----------------------------------------------------------------------------\n# If cis, custom_cluster_issuer = cis-letsencrypt-production-{{ mas_instance_id }}\n# If PKI, custom_cluster_issuer = MAS_CUSTOM_CLUSTER_ISSUER\n# If not specified, custom_cluster_issuer = autogenerated\ndefault_custom_cluster_issuer: \"cis-letsencrypt-production-{{ mas_instance_id }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n# Target line: 68\n\n     63: # Do you want to update a DNS entry if it already exists?\n     64: update_dns: \"{{ lookup('env', 'UPDATE_DNS_ENTRIES') | default(true, true) }}\"\n     65: # e.g: \"apps.joaopauloksn.cp.fyre.ibm.com\" Default will be always from cluster ingress CR.\n     66: custom_ocp_ingress: \"{{ lookup('env', 'OCP_INGRESS') | default(None, true)}}\"\n     67: \n>>>  68: # MAS Cluster Issuer\n     69: # -----------------------------------------------------------------------------\n     70: # If cis, custom_cluster_issuer = cis-letsencrypt-production-{{ mas_instance_id }}\n     71: # If PKI, custom_cluster_issuer = MAS_CUSTOM_CLUSTER_ISSUER\n     72: # If not specified, custom_cluster_issuer = autogenerated\n     73: default_custom_cluster_issuer: \"cis-letsencrypt-production-{{ mas_instance_id }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "henrysher_fedora-infra-ansible-roles-postfix_logreport-tasks-main.yml", "content": "# tasklist for setting up postfix/logreport", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-postfix_logreport-tasks-main.yml\n\n---\n2: # tasklist for setting up postfix/logreport\n# This is the base set of files needed for postfix/logreport\n\n- name: install postfix-perl-scripts package\npackage: name=postfix-perl-scripts state=present\ntags:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-postfix_logreport-tasks-main.yml\n# Target line: 2\n\n      1: ---\n>>>   2: # tasklist for setting up postfix/logreport\n      3: # This is the base set of files needed for postfix/logreport\n      4: \n      5: - name: install postfix-perl-scripts package\n      6:   package: name=postfix-perl-scripts state=present\n      7:   tags:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "geerlingguy_drupal-vm-provisioning-roles-geerlingguy.drupal-.github-stale.yml", "content": "# Number of days of inactivity before an Issue or Pull Request becomes stale", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.drupal-.github-stale.yml\n\n# Configuration for probot-stale - https://github.com/probot/stale\n\n3: # Number of days of inactivity before an Issue or Pull Request becomes stale\ndaysUntilStale: 90\n\n# Number of days of inactivity before an Issue or Pull Request with the stale label is closed.\n# Set to false to disable. If disabled, issues still need to be closed manually, but will remain marked as stale.\ndaysUntilClose: 30", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.drupal-.github-stale.yml\n# Target line: 3\n\n      1: # Configuration for probot-stale - https://github.com/probot/stale\n      2: \n>>>   3: # Number of days of inactivity before an Issue or Pull Request becomes stale\n      4: daysUntilStale: 90\n      5: \n      6: # Number of days of inactivity before an Issue or Pull Request with the stale label is closed.\n      7: # Set to false to disable. If disabled, issues still need to be closed manually, but will remain marked as stale.\n      8: daysUntilClose: 30\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "Kubeinit_kubeinit-kubeinit-roles-kubeinit_prepare-defaults-main.yml", "content": "# All variables within this role should have a prefix of \"kubeinit_prepare_\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: Kubeinit_kubeinit-kubeinit-roles-kubeinit_prepare-defaults-main.yml\n\n# under the License.\n\n\n# All variables intended for modification should be placed in this file.\n\n20: # All variables within this role should have a prefix of \"kubeinit_prepare_\"\nkubeinit_prepare_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"\nkubeinit_prepare_hide_sensitive_logs: true\n\nkubeinit_prepare_podman_dependencies:\n- podman", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Kubeinit_kubeinit-kubeinit-roles-kubeinit_prepare-defaults-main.yml\n# Target line: 20\n\n     15: # under the License.\n     16: \n     17: \n     18: # All variables intended for modification should be placed in this file.\n     19: \n>>>  20: # All variables within this role should have a prefix of \"kubeinit_prepare_\"\n     21: kubeinit_prepare_debug: \"{{ (ansible_verbosity | int) >= 2 | bool }}\"\n     22: kubeinit_prepare_hide_sensitive_logs: true\n     23: \n     24: kubeinit_prepare_podman_dependencies:\n     25:   - podman\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml", "content": "# solve the DNS01 challenge.", "line": 6, "detection_span": [1, 11], "with_context": "# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n\n# The GroupName here is used to identify your company or business unit that\n# created this webhook.\n# For example, this may be \"acme.mycompany.com\".\n# This name will need to be referenced in each Issuer's `webhook` stanza to\n# inform cert-manager of where to send ChallengePayload resources in order to\n6: # solve the DNS01 challenge.\n# This group name should be **unique**, hence using your own company's domain\n# here is recommended.\ngroupName: acme.msmaximoappsuite.br\n\nlogLevel: 1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ibm-mas_ansible-devops-ibm-mas_devops-roles-suite_dns-defaults-main.yaml\n# Target line: 6\n\n      1: # The GroupName here is used to identify your company or business unit that\n      2: # created this webhook.\n      3: # For example, this may be \"acme.mycompany.com\".\n      4: # This name will need to be referenced in each Issuer's `webhook` stanza to\n      5: # inform cert-manager of where to send ChallengePayload resources in order to\n>>>   6: # solve the DNS01 challenge.\n      7: # This group name should be **unique**, hence using your own company's domain\n      8: # here is recommended.\n      9: groupName: acme.msmaximoappsuite.br\n     10: \n     11: logLevel: 1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "fgravato_ansible-fedora-infra-roles-nagios_client-tasks-main.yml", "content": "# FIXME? figure out nrpe selinux policy of DOOM is needed", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: fgravato_ansible-fedora-infra-roles-nagios_client-tasks-main.yml\n\n# then we symlinked that to /usr/lib64/nagios/plugins\n# it was a nightmare - don't do that - my ghost will haunt you if you do\n# skvidal 2013-05-21\n\n\n36: # FIXME? figure out nrpe selinux policy of DOOM is needed\n\n- name: /etc/nagios/nrpe.cfg\ntemplate: src=nrpe.cfg.j2 dest=/etc/nagios/nrpe.cfg\nnotify:\n- restart nrpe", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: fgravato_ansible-fedora-infra-roles-nagios_client-tasks-main.yml\n# Target line: 36\n\n     31: # then we symlinked that to /usr/lib64/nagios/plugins\n     32: # it was a nightmare - don't do that - my ghost will haunt you if you do\n     33: # skvidal 2013-05-21\n     34: \n     35: \n>>>  36: # FIXME? figure out nrpe selinux policy of DOOM is needed\n     37: \n     38: - name: /etc/nagios/nrpe.cfg\n     39:   template: src=nrpe.cfg.j2 dest=/etc/nagios/nrpe.cfg\n     40:   notify:\n     41:   - restart nrpe\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "banalas_ansible-examples-language_features-intro_example.yml", "content": "# for when we use the 'template' action/module later on...", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: banalas_ansible-examples-language_features-intro_example.yml\n\n#  remote_user: mdehaan\n#  become: yes\n#  become_method: sudo\n\n# make these variables available inside of templates\n20:   # for when we use the 'template' action/module later on...\n\nvars:\nhttp_port: 80\nmax_clients: 200\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: banalas_ansible-examples-language_features-intro_example.yml\n# Target line: 20\n\n     15: #  remote_user: mdehaan\n     16: #  become: yes\n     17: #  become_method: sudo\n     18: \n     19:   # make these variables available inside of templates\n>>>  20:   # for when we use the 'template' action/module later on...\n     21: \n     22:   vars:\n     23:     http_port: 80\n     24:     max_clients: 200\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "epiphany-platform_epiphany-ansible-playbooks-roles-postgresql-molecule-debian-repmgr-molecule.yml", "content": "# linter's project dir is changed to avoid issues with include_tasks", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: epiphany-platform_epiphany-ansible-playbooks-roles-postgresql-molecule-debian-repmgr-molecule.yml\n\n---\ndependency:\nenabled: false\n4: # linter's project dir is changed to avoid issues with include_tasks\nlint: ansible-lint --project-dir=../.. roles/postgresql --exclude roles/postgresql/molecule\ndriver:\nname: docker\nplatforms:\n- name: instance-1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: epiphany-platform_epiphany-ansible-playbooks-roles-postgresql-molecule-debian-repmgr-molecule.yml\n# Target line: 4\n\n      1: ---\n      2: dependency:\n      3:   enabled: false\n>>>   4: # linter's project dir is changed to avoid issues with include_tasks\n      5: lint: ansible-lint --project-dir=../.. roles/postgresql --exclude roles/postgresql/molecule\n      6: driver:\n      7:   name: docker\n      8: platforms:\n      9:   - name: instance-1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-openstack_infrared-plugins-packstack-create_external_network.yml", "content": "# TODO(yfried): Use localhost where shade is mandatory", "line": 64, "detection_span": [59, 69], "with_context": "# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n\ncomment: \"Infrared: bz1404763\"\nchain: INPUT\njump: ACCEPT\nprotocol: tcp\n\n64:       # TODO(yfried): Use localhost where shade is mandatory\n- name: create the external network\nvars:\nansible_python_interpreter: \"{{ shade_path_venv | default('/var/tmp/venv_shade') }}/bin/python\"\nos_network:\nauth: \"{{ creds.stdout | from_yaml }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_infrared-plugins-packstack-create_external_network.yml\n# Target line: 64\n\n     59:             comment: \"Infrared: bz1404763\"\n     60:             chain: INPUT\n     61:             jump: ACCEPT\n     62:             protocol: tcp\n     63: \n>>>  64:       # TODO(yfried): Use localhost where shade is mandatory\n     65:       - name: create the external network\n     66:         vars:\n     67:             ansible_python_interpreter: \"{{ shade_path_venv | default('/var/tmp/venv_shade') }}/bin/python\"\n     68:         os_network:\n     69:             auth: \"{{ creds.stdout | from_yaml }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "gluster_gdeploy-playbooks-define_service_ports.yml", "content": "# The above hack is way too ugly. But no other choice on Ansible 1.9", "line": 10, "detection_span": [5, 15], "with_context": "# Ansible file: gluster_gdeploy-playbooks-define_service_ports.yml\n\n\ntasks:\n- name: Define service port\nlineinfile: dest=/etc/sysconfig/nfs regexp='^#STATD_PORT=.*' line='STATD_PORT=662'\n\n10: # The above hack is way too ugly. But no other choice on Ansible 1.9\n\n# Some of our channels provide only ansible1.9 and backrefs in lineinfile\n# fails. Currently hardcoding to 662\n# replace the above lineinfile with the below backrefs, once all channels are\n# updated with ansible 2.0", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: gluster_gdeploy-playbooks-define_service_ports.yml\n# Target line: 10\n\n      5: \n      6:   tasks:\n      7:   - name: Define service port\n      8:     lineinfile: dest=/etc/sysconfig/nfs regexp='^#STATD_PORT=.*' line='STATD_PORT=662'\n      9: \n>>>  10: # The above hack is way too ugly. But no other choice on Ansible 1.9\n     11: \n     12: # Some of our channels provide only ansible1.9 and backrefs in lineinfile\n     13: # fails. Currently hardcoding to 662\n     14: # replace the above lineinfile with the below backrefs, once all channels are\n     15: # updated with ansible 2.0\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "georgegoh_openshift-ansible-playbooks-common-openshift-cluster-upgrades-rpm_upgrade.yml", "content": "# TODO: If the sdn package isn't already installed this will install it, we", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-upgrades-rpm_upgrade.yml\n\n# available and the whole set of dependencies end up at the latest version.\n# Since the package module, unlike the yum module, doesn't flatten a list\n# of packages into one transaction we need to do that explicitly. The ansible\n# core team tells us not to rely on yum module transaction flattening anyway.\n\n9: # TODO: If the sdn package isn't already installed this will install it, we\n# should fix that\n\n- name: Upgrade master packages\npackage: name={{ master_pkgs | join(',') }} state=present\nvars:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: georgegoh_openshift-ansible-playbooks-common-openshift-cluster-upgrades-rpm_upgrade.yml\n# Target line: 9\n\n      4: # available and the whole set of dependencies end up at the latest version.\n      5: # Since the package module, unlike the yum module, doesn't flatten a list\n      6: # of packages into one transaction we need to do that explicitly. The ansible\n      7: # core team tells us not to rely on yum module transaction flattening anyway.\n      8: \n>>>   9: # TODO: If the sdn package isn't already installed this will install it, we\n     10: # should fix that\n     11: \n     12: - name: Upgrade master packages\n     13:   package: name={{ master_pkgs | join(',') }} state=present\n     14:   vars:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml", "content": "### IPv4 Prefix-Lists ###", "line": 1, "detection_span": [1, 6], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n\n1: ### IPv4 Prefix-Lists ###\ndynamic_prefix_lists:\n- name: DYNAMIC_PREFIX_LIST_NAME_3\nmatch_map: Test_2\nprefix_list:\nipv4: IPV4_PREFIX_LIST", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n# Target line: 1\n\n>>>   1: ### IPv4 Prefix-Lists ###\n      2: dynamic_prefix_lists:\n      3:   - name: DYNAMIC_PREFIX_LIST_NAME_3\n      4:     match_map: Test_2\n      5:     prefix_list:\n      6:       ipv4: IPV4_PREFIX_LIST\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml", "content": "### IPv6 Prefix-lists ###", "line": 27, "detection_span": [22, 32], "with_context": "# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n\naction: \"permit 192.168.255.0/24 eq 32\"\n20:\naction: \"permit 192.168.254.0/24 eq 32\"\n\n\n27: ### IPv6 Prefix-lists ###\nipv6_prefix_lists:\nPL-IPV6-LOOPBACKS:\nsequence_numbers:\n10:\naction: permit 1b11:3a00:22b0:0082::/64 eq 128", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: aristanetworks_ansible-avd-ansible_collections-arista-avd-molecule-eos_cli_config_gen-inventory-host_vars-prefix-lists.yml\n# Target line: 27\n\n     22:         action: \"permit 192.168.255.0/24 eq 32\"\n     23:       20:\n     24:         action: \"permit 192.168.254.0/24 eq 32\"\n     25: \n     26: \n>>>  27: ### IPv6 Prefix-lists ###\n     28: ipv6_prefix_lists:\n     29:   PL-IPV6-LOOPBACKS:\n     30:     sequence_numbers:\n     31:       10:\n     32:         action: permit 1b11:3a00:22b0:0082::/64 eq 128\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "SalientCRGT_openshift-ansible-playbooks-openstack-openshift-cluster-provision.yml", "content": "# TODO(shadower): consider splitting this up so people can stop here", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: SalientCRGT_openshift-ansible-playbooks-openstack-openshift-cluster-provision.yml\n\n\n- name: Gather facts for the new nodes\nsetup:\n\n\n26: # TODO(shadower): consider splitting this up so people can stop here\n# and configure their DNS if they have to.\n- name: Populate the DNS entries\nany_errors_fatal: true\nhosts: localhost\ntasks:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: SalientCRGT_openshift-ansible-playbooks-openstack-openshift-cluster-provision.yml\n# Target line: 26\n\n     21: \n     22:   - name: Gather facts for the new nodes\n     23:     setup:\n     24: \n     25: \n>>>  26: # TODO(shadower): consider splitting this up so people can stop here\n     27: # and configure their DNS if they have to.\n     28: - name: Populate the DNS entries\n     29:   any_errors_fatal: true\n     30:   hosts: localhost\n     31:   tasks:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "henrysher_fedora-infra-ansible-roles-copr-backend-files-provision-provision_builder_tasks.yml", "content": "- 204.157.3.70 # https://pagure.io/fedora-infrastructure/issue/8096", "line": 116, "detection_span": [111, 121], "with_context": "# Ansible file: henrysher_fedora-infra-ansible-roles-copr-backend-files-provision-provision_builder_tasks.yml\n\nenabled: no\n112:\n113: - name: blacklist ipv4 addresses for some mirrors\n114:   shell: ip route add unreachable \"{{ item }}\"\n115:   with_items:\n116:   - 204.157.3.70 # https://pagure.io/fedora-infrastructure/issue/8096\n117:   when:\n118:   - prepare_base_image is not defined", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: henrysher_fedora-infra-ansible-roles-copr-backend-files-provision-provision_builder_tasks.yml\n# Target line: 116\n\n    111:     enabled: no\n    112: \n    113: - name: blacklist ipv4 addresses for some mirrors\n    114:   shell: ip route add unreachable \"{{ item }}\"\n    115:   with_items:\n>>> 116:   - 204.157.3.70 # https://pagure.io/fedora-infrastructure/issue/8096\n    117:   when:\n    118:   - prepare_base_image is not defined\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-openstack_khaleesi-roles-common-tasks-main.yml", "content": "#to-do this is inconsistently failing w/ perm denied", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: redhat-openstack_khaleesi-roles-common-tasks-main.yml\n\n---\n2: #to-do this is inconsistently failing w/ perm denied\n- name: Set local time to UTC\nshell: unlink /etc/localtime; ln -s /usr/share/zoneinfo/UTC /etc/localtime\nsudo: yes\nignore_errors: yes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-openstack_khaleesi-roles-common-tasks-main.yml\n# Target line: 2\n\n      1: ---\n>>>   2: #to-do this is inconsistently failing w/ perm denied\n      3: - name: Set local time to UTC\n      4:   shell: unlink /etc/localtime; ln -s /usr/share/zoneinfo/UTC /etc/localtime\n      5:   sudo: yes\n      6:   ignore_errors: yes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "BCDevOps_platform-services-monitoring-sysdig-openshift-lab-cm-sysdig-agent-infra.yaml", "content": "##### Debug and disable undesired metrics", "line": 33, "detection_span": [28, 38], "with_context": "# Ansible file: BCDevOps_platform-services-monitoring-sysdig-openshift-lab-cm-sysdig-agent-infra.yaml\n\n\n#######################################\nnew_k8s: true\nk8s_cluster_name: lab-pathfinder\n\n33:     ##### Debug and disable undesired metrics\napp_checks_enabled: true\nstatsd:\nenabled: true\njmx:\nenabled: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: BCDevOps_platform-services-monitoring-sysdig-openshift-lab-cm-sysdig-agent-infra.yaml\n# Target line: 33\n\n     28: \n     29:     #######################################\n     30:     new_k8s: true\n     31:     k8s_cluster_name: lab-pathfinder\n     32: \n>>>  33:     ##### Debug and disable undesired metrics\n     34:     app_checks_enabled: true\n     35:     statsd:\n     36:       enabled: true\n     37:     jmx:\n     38:       enabled: true    \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "enthought_edx_ansible-playbooks-roles-xqwatcher-defaults-main.yml", "content": "#TODO: change this to /edx/etc after pulling xqwatcher.json out", "line": 83, "detection_span": [78, 88], "with_context": "# Ansible file: enthought_edx_ansible-playbooks-roles-xqwatcher-defaults-main.yml\n\nxqwatcher_app_data: \"{{ xqwatcher_app_dir }}/data\"\nxqwatcher_code_dir: \"{{ xqwatcher_app_dir }}/src\"\n\nxqwatcher_repo_name: xqueue-watcher.git\n\n83: #TODO: change this to /edx/etc after pulling xqwatcher.json out\nxqwatcher_conf_dir: \"{{ xqwatcher_app_dir }}\"\n\n#TODO: remove after refactoring out all the git stuff\nxqwatcher_course_git_ssh_opts: \"-o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i {{ xqwatcher_app_dir }}/.ssh/{{ xqwatcher_service_name }}-courses\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: enthought_edx_ansible-playbooks-roles-xqwatcher-defaults-main.yml\n# Target line: 83\n\n     78: xqwatcher_app_data: \"{{ xqwatcher_app_dir }}/data\"\n     79: xqwatcher_code_dir: \"{{ xqwatcher_app_dir }}/src\"\n     80: \n     81: xqwatcher_repo_name: xqueue-watcher.git\n     82: \n>>>  83: #TODO: change this to /edx/etc after pulling xqwatcher.json out\n     84: xqwatcher_conf_dir: \"{{ xqwatcher_app_dir }}\"\n     85: \n     86: #TODO: remove after refactoring out all the git stuff\n     87: xqwatcher_course_git_ssh_opts: \"-o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i {{ xqwatcher_app_dir }}/.ssh/{{ xqwatcher_service_name }}-courses\"\n     88: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-roles-host-lets-encrypt-certs-defaults-main.yml", "content": "# to prevent issues with the Let's Encrypt rate limits", "line": 36, "detection_span": [31, 41], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-roles-host-lets-encrypt-certs-defaults-main.yml\n\nacme_cache_key_file:       \"/tmp/ssl.key\"\nacme_cache_ca_file:        \"/tmp/ssl_ca.cert\"\nacme_cache_fullchain_file: \"/tmp/fullchain.cer\"\n\n# Use the Production Let's Encrypt Server. Leave to False for testing runs\n36: # to prevent issues with the Let's Encrypt rate limits\nacme_production: False\n\n# Install a cron job to automatically renew Certificates. Checks\n# once a day.\nacme_renew_automatically: False", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-roles-host-lets-encrypt-certs-defaults-main.yml\n# Target line: 36\n\n     31: acme_cache_key_file:       \"/tmp/ssl.key\"\n     32: acme_cache_ca_file:        \"/tmp/ssl_ca.cert\"\n     33: acme_cache_fullchain_file: \"/tmp/fullchain.cer\"\n     34: \n     35: # Use the Production Let's Encrypt Server. Leave to False for testing runs\n>>>  36: # to prevent issues with the Let's Encrypt rate limits\n     37: acme_production: False\n     38: \n     39: # Install a cron job to automatically renew Certificates. Checks\n     40: # once a day.\n     41: acme_renew_automatically: False\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "IBM_z_ansible_collections_samples-zos_subsystems-cics-cmci-reporting-report.yml", "content": "#   IBM z/OS CICS collection 1.0.0 or later", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-cics-cmci-reporting-report.yml\n\n#  resource tables supported by CPSM. The retrieved information is written to a\n#  csv file, suitable for opening as a spreadsheet.  This sample additionally\n#  shows how to automate installation of pre-requisites for the CMCI modules.\n#\n# Requirements:\n28: #   IBM z/OS CICS collection 1.0.0 or later\n###############################################################################\n---\n- name:  CICS CMCI Report\n\ncollections:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: IBM_z_ansible_collections_samples-zos_subsystems-cics-cmci-reporting-report.yml\n# Target line: 28\n\n     23: #  resource tables supported by CPSM. The retrieved information is written to a\n     24: #  csv file, suitable for opening as a spreadsheet.  This sample additionally\n     25: #  shows how to automate installation of pre-requisites for the CMCI modules.\n     26: #\n     27: # Requirements:\n>>>  28: #   IBM z/OS CICS collection 1.0.0 or later\n     29: ###############################################################################\n     30: ---\n     31: - name:  CICS CMCI Report\n     32: \n     33:   collections:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "myrepo5588_openshift-ansible-roles-kube_proxy_and_dns-files-kube-proxy-and-dns.yaml", "content": "# TODO: Temporarily disabled until we determine how to wait for clean default", "line": 120, "detection_span": [115, 125], "with_context": "# Ansible file: myrepo5588_openshift-ansible-roles-kube_proxy_and_dns-files-kube-proxy-and-dns.yaml\n\n- name: OPENSHIFT_DNS_DOMAIN\nvalue: cluster.local\nports:\n- name: healthz\ncontainerPort: 10256\n120:         # TODO: Temporarily disabled until we determine how to wait for clean default\n# config\n# livenessProbe:\n#   initialDelaySeconds: 10\n#   httpGet:\n#     path: /healthz", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: myrepo5588_openshift-ansible-roles-kube_proxy_and_dns-files-kube-proxy-and-dns.yaml\n# Target line: 120\n\n    115:         - name: OPENSHIFT_DNS_DOMAIN\n    116:           value: cluster.local\n    117:         ports:\n    118:         - name: healthz\n    119:           containerPort: 10256\n>>> 120:         # TODO: Temporarily disabled until we determine how to wait for clean default\n    121:         # config\n    122:         # livenessProbe:\n    123:         #   initialDelaySeconds: 10\n    124:         #   httpGet:\n    125:         #     path: /healthz\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "tungstenfabric_tf-ansible-deployer-playbooks-roles-k8s_deployer-tasks-main.yml", "content": "# TODO: there are no private_ip/ansible_user/ansible_ssh_pass/ansible_ssh_private_key_file", "line": 42, "detection_span": [37, 47], "with_context": "# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-k8s_deployer-tasks-main.yml\n\ncontrail_configuration: \"{{ contrail_configuration | combine({'KUBERNETES_API_SERVER': k8s_master_ip}) }}\"\nwhen:\n- contrail_configuration.KUBERNETES_API_SERVER is undefined\n- k8s_master_ip is defined\n\n42: # TODO: there are no private_ip/ansible_user/ansible_ssh_pass/ansible_ssh_private_key_file\n- name: create k8s_master_host host group\nadd_host:\nhostname: \"{{ item.value.ip }}\"\ngroupname: k8s_master_host\ninstance_name: \"{{ item.key }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tungstenfabric_tf-ansible-deployer-playbooks-roles-k8s_deployer-tasks-main.yml\n# Target line: 42\n\n     37:     contrail_configuration: \"{{ contrail_configuration | combine({'KUBERNETES_API_SERVER': k8s_master_ip}) }}\"\n     38:   when:\n     39:     - contrail_configuration.KUBERNETES_API_SERVER is undefined\n     40:     - k8s_master_ip is defined\n     41: \n>>>  42: # TODO: there are no private_ip/ansible_user/ansible_ssh_pass/ansible_ssh_private_key_file\n     43: - name: create k8s_master_host host group\n     44:   add_host:\n     45:     hostname: \"{{ item.value.ip }}\"\n     46:     groupname: k8s_master_host\n     47:     instance_name: \"{{ item.key }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "Juniper_contrail-ansible-internal-playbooks-roles-contrail-analyticsdb-tasks-install-RedHat.yml", "content": "# This is a workaround on issue https://github.com/Juniper/contrail-docker/issues/2", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: Juniper_contrail-ansible-internal-playbooks-roles-contrail-analyticsdb-tasks-install-RedHat.yml\n\n\n# Workaround for LP #1669295\n- name: Disable contrail-database to auto start on reboot\ncommand: chkconfig contrail-database off\n\n14: # This is a workaround on issue https://github.com/Juniper/contrail-docker/issues/2\n- name: Remove supervisor-database from /etc/sensitive_servies (WA for issue contrail-docker/2)\nlineinfile: dest=/etc/sensitive_services line=supervisor-database state=absent", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Juniper_contrail-ansible-internal-playbooks-roles-contrail-analyticsdb-tasks-install-RedHat.yml\n# Target line: 14\n\n      9: \n     10: # Workaround for LP #1669295\n     11: - name: Disable contrail-database to auto start on reboot\n     12:   command: chkconfig contrail-database off\n     13: \n>>>  14: # This is a workaround on issue https://github.com/Juniper/contrail-docker/issues/2\n     15: - name: Remove supervisor-database from /etc/sensitive_servies (WA for issue contrail-docker/2)\n     16:   lineinfile: dest=/etc/sensitive_services line=supervisor-database state=absent\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "AAROC_DevOps-Ansible-roles-top-bdii-tasks-configure.yml", "content": "#     regexp: \"^suffix\\s*\\\"o\\=grid\\\"\"", "line": 20, "detection_span": [15, 25], "with_context": "# Ansible file: AAROC_DevOps-Ansible-roles-top-bdii-tasks-configure.yml\n\n#\n# - name: Ensure that relay database suffix is disabled\n#   become: true\n#   lineinefile:\n#     dest: /etc/bdii/bdii-top-slapd.conf\n20: #     regexp: \"^suffix\\s*\\\"o\\=grid\\\"\"\n#     line: \"#suffix \\\"o=grid\\\"\"\n#   when: ansible_os_family == 'RedHat' && ansible_distribution_major_version == '6'\n\n- name: Tweak relay db\nbecome: true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AAROC_DevOps-Ansible-roles-top-bdii-tasks-configure.yml\n# Target line: 20\n\n     15: #\n     16: # - name: Ensure that relay database suffix is disabled\n     17: #   become: true\n     18: #   lineinefile:\n     19: #     dest: /etc/bdii/bdii-top-slapd.conf\n>>>  20: #     regexp: \"^suffix\\s*\\\"o\\=grid\\\"\"\n     21: #     line: \"#suffix \\\"o=grid\\\"\"\n     22: #   when: ansible_os_family == 'RedHat' && ansible_distribution_major_version == '6'\n     23: \n     24: - name: Tweak relay db\n     25:   become: true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "redhat-cop_controller_configuration-roles-ad_hoc_command_cancel-meta-main.yml", "content": "# If the issue tracker for your role is not on github, uncomment the", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: redhat-cop_controller_configuration-roles-ad_hoc_command_cancel-meta-main.yml\n\nrole_name: \"ad_hoc_command_cancel\"\nauthor: \"Sean Sullivan\"\ndescription: \"An Ansible Role to cancel ad hoc commands in Ansible Controller.\"\ncompany: \"Red Hat\"\n\n8:   # If the issue tracker for your role is not on github, uncomment the\n# next line and provide a value\n# issue_tracker_url: http://example.com/issue/tracker\nlicense: \"GPLv3+\"\n\nmin_ansible_version: \"2.9\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_controller_configuration-roles-ad_hoc_command_cancel-meta-main.yml\n# Target line: 8\n\n      3:   role_name: \"ad_hoc_command_cancel\"\n      4:   author: \"Sean Sullivan\"\n      5:   description: \"An Ansible Role to cancel ad hoc commands in Ansible Controller.\"\n      6:   company: \"Red Hat\"\n      7: \n>>>   8:   # If the issue tracker for your role is not on github, uncomment the\n      9:   # next line and provide a value\n     10:   # issue_tracker_url: http://example.com/issue/tracker\n     11:   license: \"GPLv3+\"\n     12: \n     13:   min_ansible_version: \"2.9\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "suspicious_comment", "file": "debops_debops-ansible-playbooks-service-extrepo.yml", "content": "# SPDX-License-Identifier: GPL-3.0-or-later", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: debops_debops-ansible-playbooks-service-extrepo.yml\n\n---\n# Copyright (C) 2021 Maciej Delmanowski <drybjed@gmail.com>\n# Copyright (C) 2021 DebOps <https://debops.org/>\n4: # SPDX-License-Identifier: GPL-3.0-or-later\n\n- name: Manage external APT sources\ncollections: [ 'debops.debops', 'debops.roles01',\n'debops.roles02', 'debops.roles03' ]\nhosts: [ 'debops_service_extrepo' ]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: debops_debops-ansible-playbooks-service-extrepo.yml\n# Target line: 4\n\n      1: ---\n      2: # Copyright (C) 2021 Maciej Delmanowski <drybjed@gmail.com>\n      3: # Copyright (C) 2021 DebOps <https://debops.org/>\n>>>   4: # SPDX-License-Identifier: GPL-3.0-or-later\n      5: \n      6: - name: Manage external APT sources\n      7:   collections: [ 'debops.debops', 'debops.roles01',\n      8:                  'debops.roles02', 'debops.roles03' ]\n      9:   hosts: [ 'debops_service_extrepo' ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "dgoodlad@puppet-chruby-manifests-params.pp", "content": "$user          = 'root'", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: dgoodlad@puppet-chruby-manifests-params.pp\n\n}\n\ndefault: {\n$chruby_root   = '/usr/local/share/chruby'\n$chruby_rubies = '/opt/rubies'\n17:       $user          = 'root'\n}\n}\n\n$chruby_version = '0.3.7'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: dgoodlad@puppet-chruby-manifests-params.pp\n# Target line: 17\n\n     12:     }\n     13: \n     14:     default: {\n     15:       $chruby_root   = '/usr/local/share/chruby'\n     16:       $chruby_rubies = '/opt/rubies'\n>>>  17:       $user          = 'root'\n     18:     }\n     19:   }\n     20: \n     21:   $chruby_version = '0.3.7'\n     22: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-network-contrail-heat.pp", "content": "$admin_user     = hiera('contrail::admin_user'),", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-heat.pp\n\n#  Defaults to 'False'\n#\nclass tripleo::network::contrail::heat(\n$admin_password = hiera('contrail::admin_password'),\n$admin_token    = hiera('contrail::admin_token'),\n70:   $admin_user     = hiera('contrail::admin_user'),\n$api_server     = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n$api_port       = 8082,\n$auth_host      = hiera('contrail::auth_host'),\n$step           = Integer(hiera('step')),\n$use_ssl        = 'False',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-heat.pp\n# Target line: 70\n\n     65: #  Defaults to 'False'\n     66: #\n     67: class tripleo::network::contrail::heat(\n     68:   $admin_password = hiera('contrail::admin_password'),\n     69:   $admin_token    = hiera('contrail::admin_token'),\n>>>  70:   $admin_user     = hiera('contrail::admin_user'),\n     71:   $api_server     = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n     72:   $api_port       = 8082,\n     73:   $auth_host      = hiera('contrail::auth_host'),\n     74:   $step           = Integer(hiera('step')),\n     75:   $use_ssl        = 'False',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-postgres-manifests-server.pp", "content": "user            => \"postgres\",", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-postgres-manifests-server.pp\n\nrequire         => Package[\"postgresql-server\"],\n}\n\nexec { \"pginitdb\":\ncommand         => \"/usr/bin/initdb --pgdata='/var/lib/pgsql/data' -E UTF8 -A ident\",\n28:         user            => \"postgres\",\ngroup           => \"postgres\",\ncreates         => \"/var/lib/pgsql/data/PG_VERSION\",\nrequire         => Package[\"postgresql-server\"],\nnotify          => Service[\"postgresql\"],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-postgres-manifests-server.pp\n# Target line: 28\n\n     23:         require         => Package[\"postgresql-server\"],\n     24:     }\n     25: \n     26:     exec { \"pginitdb\":\n     27:         command         => \"/usr/bin/initdb --pgdata='/var/lib/pgsql/data' -E UTF8 -A ident\",\n>>>  28:         user            => \"postgres\",\n     29:         group           => \"postgres\",\n     30:         creates         => \"/var/lib/pgsql/data/PG_VERSION\",\n     31:         require         => Package[\"postgresql-server\"],\n     32:         notify          => Service[\"postgresql\"],\n     33:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp", "content": "aeolus::conductor::login{\"admin\": password => \"password\",", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n\nemail           => 'root@localhost.localdomain',\npassword        => \"password\",\nfirst_name      => 'Administrator',\nlast_name       => ''}\n\n23:   aeolus::conductor::login{\"admin\": password => \"password\",\nrequire  => Aeolus::Conductor::Site_admin['admin']}\n\naeolus::conductor::provider{\"mock\":\ntype           => \"mock\",\nurl            => \"http://localhost:3002/api\"}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n# Target line: 23\n\n     18:      email           => 'root@localhost.localdomain',\n     19:      password        => \"password\",\n     20:      first_name      => 'Administrator',\n     21:      last_name       => ''}\n     22: \n>>>  23:   aeolus::conductor::login{\"admin\": password => \"password\",\n     24:      require  => Aeolus::Conductor::Site_admin['admin']}\n     25: \n     26:   aeolus::conductor::provider{\"mock\":\n     27:                                 type           => \"mock\",\n     28:                                 url            => \"http://localhost:3002/api\"}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-manifests-params.pp", "content": "$misc_owner_root = 'root',", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n\n\n# external modules...\n$include_puppet_facter = true,\n\n# Owner/Group\n67: \t$misc_owner_root = 'root',\n$misc_group_root = 'root',\n$misc_group_nobody = 'nobody',\n\n# Default directories\n# See http://manpages.ubuntu.com/manpages/trusty/man8/mount.glusterfs.8.html", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n# Target line: 67\n\n     62: \n     63: \t# external modules...\n     64: \t$include_puppet_facter = true,\n     65: \n     66: \t# Owner/Group\n>>>  67: \t$misc_owner_root = 'root',\n     68: \t$misc_group_root = 'root',\n     69: \t$misc_group_nobody = 'nobody',\n     70: \n     71: \t# Default directories\n     72: \t# See http://manpages.ubuntu.com/manpages/trusty/man8/mount.glusterfs.8.html\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-midonet.pp", "content": "'MIDONET/password'    : value => $password, secret => true;", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-midonet.pp\n\ninclude ::neutron::deps\n\nneutron_plugin_ml2 {\n'MIDONET/midonet_uri' : value => $midonet_uri;\n'MIDONET/username'    : value => $username;\n33:     'MIDONET/password'    : value => $password, secret => true;\n'MIDONET/project_id'  : value => $project_id;\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-midonet.pp\n# Target line: 33\n\n     28:   include ::neutron::deps\n     29: \n     30:   neutron_plugin_ml2 {\n     31:     'MIDONET/midonet_uri' : value => $midonet_uri;\n     32:     'MIDONET/username'    : value => $username;\n>>>  33:     'MIDONET/password'    : value => $password, secret => true;\n     34:     'MIDONET/project_id'  : value => $project_id;\n     35:   }\n     36: \n     37: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp", "content": "key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n\napt::source { 'logstash':\nlocation    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\nrelease     => 'stable',\nrepos       => 'main',\nkey         => 'D88E42B4',\n11:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\ninclude_src => false,\n}\n\nclass { '::logstash':\nversion            => '1.4.2-1-2c0f5a1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n# Target line: 11\n\n      6:   apt::source { 'logstash':\n      7:     location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\n      8:     release     => 'stable',\n      9:     repos       => 'main',\n     10:     key         => 'D88E42B4',\n>>>  11:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     12:     include_src => false,\n     13:   }\n     14: \n     15:   class { '::logstash':\n     16:     version            => '1.4.2-1-2c0f5a1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-deploy-setup.pp", "content": "username  => 'deploy',", "line": 126, "detection_span": [121, 131], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy-setup.pp\n\n121:\n122:   govuk_bundler::config { 'deploy-bundler':\nserver    => $gemstash_server,\nrequire   => User['deploy'],\nuser_home => '/home/deploy',\n126:     username  => 'deploy',\n127:   }\n128: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy-setup.pp\n# Target line: 126\n\n    121: \n    122:   govuk_bundler::config { 'deploy-bundler':\n    123:     server    => $gemstash_server,\n    124:     require   => User['deploy'],\n    125:     user_home => '/home/deploy',\n>>> 126:     username  => 'deploy',\n    127:   }\n    128: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-init.pp", "content": "admin    => false,", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-init.pp\n\nread_permission      => '.*',\nwrite_permission     => '.*',\n}\n\nrabbitmq_user { $monitoring_user:\n71:     admin    => false,\ntags     => [ 'monitoring' ],\npassword => $monitoring_password,\n}\n\nrabbitmq_user_permissions { \"${monitoring_user}@${root_vhost}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-init.pp\n# Target line: 71\n\n     66:     read_permission      => '.*',\n     67:     write_permission     => '.*',\n     68:   }\n     69: \n     70:   rabbitmq_user { $monitoring_user:\n>>>  71:     admin    => false,\n     72:     tags     => [ 'monitoring' ],\n     73:     password => $monitoring_password,\n     74:   }\n     75: \n     76:   rabbitmq_user_permissions { \"${monitoring_user}@${root_vhost}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp", "content": "$request_uuid                = false,", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n\n$client_max_body_size        = '10m',\n$is_django                   = false,\n$client_max_body_size        = '10m',\n$ssl_cert                    = hiera('public_ssl_cert'),\n$ssl_key                     = hiera('public_ssl_key'),\n26:   $request_uuid                = false,\n$statsd_prefix               = $title,\n) {\nvalidate_bool($request_uuid)\ninclude nginx\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n# Target line: 26\n\n     21:   $client_max_body_size        = '10m',\n     22:   $is_django                   = false,\n     23:   $client_max_body_size        = '10m',\n     24:   $ssl_cert                    = hiera('public_ssl_cert'),\n     25:   $ssl_key                     = hiera('public_ssl_key'),\n>>>  26:   $request_uuid                = false,\n     27:   $statsd_prefix               = $title,\n     28: ) {\n     29:   validate_bool($request_uuid)\n     30:   include nginx\n     31: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-sebastianschmieschek.pp", "content": "ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7VcUWYh2s+lrZ2/Yidodl0nAU2/hI5LP9RNK2Vx0u05KHp5MP8JJl1oGL53KgVuwxQ0YGm9mJzMVmp16F15H/kVR9HAVHpgqfm/6vRGPoHvkWTXc8IdrhmSO/O+kJO+vhFRwp1SQ1dvoGoEjWj/fJ/9NuMjfMUIMm4j+S6mqG5+qq+lJxd/0yFe1tFnh0dxWbFnUIR55s2FaXNTx+dTMTeq2/gw2cPo/oH8x1OoH4XTeWev7Ey0bMAvqKH0kwGJXe54LuTcwNxCABWP3KP+UZ1/E58D6Bilc6KYH4ukwLukZVFP6e+L6VB8/HJZJU2GTSQmsDdk5V6IvbeEtZcMcdMqJjlHP0IxvmhRt17TC85H29ig23DxSgZsWQ+37YMZLfHrwdqMccp8LvYFyiuWLWieyKNNMnU/cSnejoLykyBVrePjDbSqI8z/fQn4h8JVcol/i2wt0NNe9AjTYlWgTZlKFl5WkAZFfX+cZ84IzqdoXKHFaw9QkHPzMGsV3yQgn2x2CEB+evnbaBBxqSCB2re04zNtAqkQMjTa7xWJ7VglqrnfH2TYlrXXBccGSakhZgwTlG+rkz4/BRGQxowPcANrZAH5AmRvQMpWKIOIgbHpp4vzD4+rgwOXH4sei1tQMS/xRAL191s4Tsdt5xgue5Jv8cZ03apT+SPMbh0TSd8w== sebastianschmieschek@gds5607.local',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-sebastianschmieschek.pp\n\n# Creates the user schmie for Sebastian Schmieschek\nclass users::sebastianschmieschek {\ngovuk_user { 'sebastianschmieschek':\nfullname => 'Sebastian Schmieschek',\nemail    => 'sebastian.schmieschek@digital.cabinet-office.gov.uk',\n6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7VcUWYh2s+lrZ2/Yidodl0nAU2/hI5LP9RNK2Vx0u05KHp5MP8JJl1oGL53KgVuwxQ0YGm9mJzMVmp16F15H/kVR9HAVHpgqfm/6vRGPoHvkWTXc8IdrhmSO/O+kJO+vhFRwp1SQ1dvoGoEjWj/fJ/9NuMjfMUIMm4j+S6mqG5+qq+lJxd/0yFe1tFnh0dxWbFnUIR55s2FaXNTx+dTMTeq2/gw2cPo/oH8x1OoH4XTeWev7Ey0bMAvqKH0kwGJXe54LuTcwNxCABWP3KP+UZ1/E58D6Bilc6KYH4ukwLukZVFP6e+L6VB8/HJZJU2GTSQmsDdk5V6IvbeEtZcMcdMqJjlHP0IxvmhRt17TC85H29ig23DxSgZsWQ+37YMZLfHrwdqMccp8LvYFyiuWLWieyKNNMnU/cSnejoLykyBVrePjDbSqI8z/fQn4h8JVcol/i2wt0NNe9AjTYlWgTZlKFl5WkAZFfX+cZ84IzqdoXKHFaw9QkHPzMGsV3yQgn2x2CEB+evnbaBBxqSCB2re04zNtAqkQMjTa7xWJ7VglqrnfH2TYlrXXBccGSakhZgwTlG+rkz4/BRGQxowPcANrZAH5AmRvQMpWKIOIgbHpp4vzD4+rgwOXH4sei1tQMS/xRAL191s4Tsdt5xgue5Jv8cZ03apT+SPMbh0TSd8w== sebastianschmieschek@gds5607.local',\n],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-sebastianschmieschek.pp\n# Target line: 6\n\n      1: # Creates the user schmie for Sebastian Schmieschek\n      2: class users::sebastianschmieschek {\n      3:   govuk_user { 'sebastianschmieschek':\n      4:     fullname => 'Sebastian Schmieschek',\n      5:     email    => 'sebastian.schmieschek@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7VcUWYh2s+lrZ2/Yidodl0nAU2/hI5LP9RNK2Vx0u05KHp5MP8JJl1oGL53KgVuwxQ0YGm9mJzMVmp16F15H/kVR9HAVHpgqfm/6vRGPoHvkWTXc8IdrhmSO/O+kJO+vhFRwp1SQ1dvoGoEjWj/fJ/9NuMjfMUIMm4j+S6mqG5+qq+lJxd/0yFe1tFnh0dxWbFnUIR55s2FaXNTx+dTMTeq2/gw2cPo/oH8x1OoH4XTeWev7Ey0bMAvqKH0kwGJXe54LuTcwNxCABWP3KP+UZ1/E58D6Bilc6KYH4ukwLukZVFP6e+L6VB8/HJZJU2GTSQmsDdk5V6IvbeEtZcMcdMqJjlHP0IxvmhRt17TC85H29ig23DxSgZsWQ+37YMZLfHrwdqMccp8LvYFyiuWLWieyKNNMnU/cSnejoLykyBVrePjDbSqI8z/fQn4h8JVcol/i2wt0NNe9AjTYlWgTZlKFl5WkAZFfX+cZ84IzqdoXKHFaw9QkHPzMGsV3yQgn2x2CEB+evnbaBBxqSCB2re04zNtAqkQMjTa7xWJ7VglqrnfH2TYlrXXBccGSakhZgwTlG+rkz4/BRGQxowPcANrZAH5AmRvQMpWKIOIgbHpp4vzD4+rgwOXH4sei1tQMS/xRAL191s4Tsdt5xgue5Jv8cZ03apT+SPMbh0TSd8w== sebastianschmieschek@gds5607.local',\n      7:     ],\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-bootstrap-manifests-profile-guacamole.pp", "content": "password => 'some_password',", "line": 75, "detection_span": [70, 80], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-guacamole.pp\n\n}\ncontain ::mysql::server\n\nmysql::db {'guacamole_db':\nuser     => 'guacamole_user',\n75: \tpassword => 'some_password',\nhost     => '%',\ngrant    => ['SELECT','INSERT','UPDATE','DELETE'],\nsql      => $guacamole_initdb_file,\nrequire  => File[$guacamole_initdb_file],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-guacamole.pp\n# Target line: 75\n\n     70:       }\n     71:       contain ::mysql::server\n     72: \n     73:       mysql::db {'guacamole_db':\n     74: \tuser     => 'guacamole_user',\n>>>  75: \tpassword => 'some_password',\n     76: \thost     => '%',\n     77: \tgrant    => ['SELECT','INSERT','UPDATE','DELETE'],\n     78: \tsql      => $guacamole_initdb_file,\n     79: \trequire  => File[$guacamole_initdb_file],\n     80:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp", "content": "$passenger_root   = '/usr'", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n\n$mpm_module       = 'worker'\n$dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n$default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n$default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$ssl_certs_dir    = '/etc/ssl/certs'\n95:     $passenger_root   = '/usr'\n$passenger_ruby   = '/usr/bin/ruby'\n$mod_packages     = {\n'auth_kerb'  => 'libapache2-mod-auth-kerb',\n'fcgid'      => 'libapache2-mod-fcgid',\n'passenger'  => 'libapache2-mod-passenger',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n# Target line: 95\n\n     90:     $mpm_module       = 'worker'\n     91:     $dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n     92:     $default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n     93:     $default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     94:     $ssl_certs_dir    = '/etc/ssl/certs'\n>>>  95:     $passenger_root   = '/usr'\n     96:     $passenger_ruby   = '/usr/bin/ruby'\n     97:     $mod_packages     = {\n     98:       'auth_kerb'  => 'libapache2-mod-auth-kerb',\n     99:       'fcgid'      => 'libapache2-mod-fcgid',\n    100:       'passenger'  => 'libapache2-mod-passenger',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-contacts-db.pp", "content": "$mysql_contacts_admin = '',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-contacts-db.pp\n\n#\n# [*password*]\n#   The DB user password.\n#\nclass govuk::apps::contacts::db (\n12:   $mysql_contacts_admin = '',\n$mysql_contacts_frontend =  '',\n){\nmysql::db { 'contacts_production':\nuser     => 'contacts',\nhost     => '%',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-contacts-db.pp\n# Target line: 12\n\n      7: #\n      8: # [*password*]\n      9: #   The DB user password.\n     10: #\n     11: class govuk::apps::contacts::db (\n>>>  12:   $mysql_contacts_admin = '',\n     13:   $mysql_contacts_frontend =  '',\n     14: ){\n     15:   mysql::db { 'contacts_production':\n     16:     user     => 'contacts',\n     17:     host     => '%',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-edwardkerry.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7jBVz4z6BrhddvmRxxaYFPndUsrusaqzQARHRWWEVCGgLgmODjr66mIYTA7refk1zkJCmpvZobG5MuUEF/O3uYkml1YmRIrE/cyAUptiJKNWPds6YsCnX+4efJFdUfVQUvUH0uXs7I6shrPz6dAJwZjFy6y2u42RFliX6HhXtI3KHAt9Xb/hrbjM29lTQiVB8lHCdM6hdesyIK5WlYzGM/33DlqtXywr8WhOOlYGhix0FgWoiWAt3WX8hRDZaa0KuRKDaWuQ9nJRAFzINb+EvYwephSrpXWO/BtCoLLTb1emJl7ehKwb8DDmcNKV9eTIlW9iL4Xf8ZxB1GncQDu/bpfuLUzmbVMp0aJJMZFPwG+4mS8VFxd1yDAC4NucjbgekVrp2KLoUzMPlG9JTQ31/h7KTH6KP0hYGpKwY0FoTMafC6n5CQv3I00Fvl+zjh2g8xZbfllVJAcweEHwCcAQNI36+zusvKW6ptepyNcJiJB6MQzHhT+nCkUNnjYkoyLtyCyG+a9muiCFDDkVDHxapnNNXJF6ikWFHLGb0WHeLvjZ894JJjAbC7xuMYDTfYoKgPKCwfuGM3LRayPNc4faYqyo97qk7D0CvrnS6AXZylNVeeeTxkAoyq4AlTe7Pj1n478Dsq4jkxY637y6FOEnmPTJ2t9XPrPxncAaPyajBvQ== edward.kerry@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-edwardkerry.pp\n\n# Creates the user edwardkerry\nclass users::edwardkerry {\ngovuk_user { 'edwardkerry':\nfullname => 'Edward Kerry',\nemail    => 'edward.kerry@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7jBVz4z6BrhddvmRxxaYFPndUsrusaqzQARHRWWEVCGgLgmODjr66mIYTA7refk1zkJCmpvZobG5MuUEF/O3uYkml1YmRIrE/cyAUptiJKNWPds6YsCnX+4efJFdUfVQUvUH0uXs7I6shrPz6dAJwZjFy6y2u42RFliX6HhXtI3KHAt9Xb/hrbjM29lTQiVB8lHCdM6hdesyIK5WlYzGM/33DlqtXywr8WhOOlYGhix0FgWoiWAt3WX8hRDZaa0KuRKDaWuQ9nJRAFzINb+EvYwephSrpXWO/BtCoLLTb1emJl7ehKwb8DDmcNKV9eTIlW9iL4Xf8ZxB1GncQDu/bpfuLUzmbVMp0aJJMZFPwG+4mS8VFxd1yDAC4NucjbgekVrp2KLoUzMPlG9JTQ31/h7KTH6KP0hYGpKwY0FoTMafC6n5CQv3I00Fvl+zjh2g8xZbfllVJAcweEHwCcAQNI36+zusvKW6ptepyNcJiJB6MQzHhT+nCkUNnjYkoyLtyCyG+a9muiCFDDkVDHxapnNNXJF6ikWFHLGb0WHeLvjZ894JJjAbC7xuMYDTfYoKgPKCwfuGM3LRayPNc4faYqyo97qk7D0CvrnS6AXZylNVeeeTxkAoyq4AlTe7Pj1n478Dsq4jkxY637y6FOEnmPTJ2t9XPrPxncAaPyajBvQ== edward.kerry@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-edwardkerry.pp\n# Target line: 6\n\n      1: # Creates the user edwardkerry\n      2: class users::edwardkerry {\n      3:   govuk_user { 'edwardkerry':\n      4:     fullname => 'Edward Kerry',\n      5:     email    => 'edward.kerry@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7jBVz4z6BrhddvmRxxaYFPndUsrusaqzQARHRWWEVCGgLgmODjr66mIYTA7refk1zkJCmpvZobG5MuUEF/O3uYkml1YmRIrE/cyAUptiJKNWPds6YsCnX+4efJFdUfVQUvUH0uXs7I6shrPz6dAJwZjFy6y2u42RFliX6HhXtI3KHAt9Xb/hrbjM29lTQiVB8lHCdM6hdesyIK5WlYzGM/33DlqtXywr8WhOOlYGhix0FgWoiWAt3WX8hRDZaa0KuRKDaWuQ9nJRAFzINb+EvYwephSrpXWO/BtCoLLTb1emJl7ehKwb8DDmcNKV9eTIlW9iL4Xf8ZxB1GncQDu/bpfuLUzmbVMp0aJJMZFPwG+4mS8VFxd1yDAC4NucjbgekVrp2KLoUzMPlG9JTQ31/h7KTH6KP0hYGpKwY0FoTMafC6n5CQv3I00Fvl+zjh2g8xZbfllVJAcweEHwCcAQNI36+zusvKW6ptepyNcJiJB6MQzHhT+nCkUNnjYkoyLtyCyG+a9muiCFDDkVDHxapnNNXJF6ikWFHLGb0WHeLvjZ894JJjAbC7xuMYDTfYoKgPKCwfuGM3LRayPNc4faYqyo97qk7D0CvrnS6AXZylNVeeeTxkAoyq4AlTe7Pj1n478Dsq4jkxY637y6FOEnmPTJ2t9XPrPxncAaPyajBvQ== edward.kerry@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-rabbitmq-examples-user-add.pp", "content": "password => 'phoey!',", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: voxpupuli@puppet-rabbitmq-examples-user-add.pp\n\nrabbitmq_user { ['blah2', 'blah3', 'blah4']:\n2:   password => 'phoey!',\n#provider => 'rabbitmqctl',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-rabbitmq-examples-user-add.pp\n# Target line: 2\n\n      1: rabbitmq_user { ['blah2', 'blah3', 'blah4']:\n>>>   2:   password => 'phoey!',\n      3:   #provider => 'rabbitmqctl',\n      4: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-httpd-manifests-vhost-proxy.pp", "content": "$docroot         = undef,", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: openstack-infra@puppet-httpd-manifests-vhost-proxy.pp\n\n# Sample Usage:\n#\ndefine httpd::vhost::proxy (\n$dest,\n$port,\n24:     $docroot         = undef,\n$priority        = '10',\n$proxyexclusions = undef,\n$serveraliases   = undef,\n$servername      = undef,\n$ssl             = false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-httpd-manifests-vhost-proxy.pp\n# Target line: 24\n\n     19: # Sample Usage:\n     20: #\n     21: define httpd::vhost::proxy (\n     22:     $dest,\n     23:     $port,\n>>>  24:     $docroot         = undef,\n     25:     $priority        = '10',\n     26:     $proxyexclusions = undef,\n     27:     $serveraliases   = undef,\n     28:     $servername      = undef,\n     29:     $ssl             = false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute.pp", "content": "password    => hiera('CONFIG_NOVA_KS_PW'),", "line": 89, "detection_span": [84, 94], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute.pp\n\nforce_config_drive            => false,\n}\n\nclass { '::nova::placement':\nauth_url    => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\n89:       password    => hiera('CONFIG_NOVA_KS_PW'),\nregion_name => hiera('CONFIG_KEYSTONE_REGION'),\n}\n\nclass { '::nova::compute::pci':\npassthrough => hiera('CONFIG_NOVA_PCI_PASSTHROUGH_WHITELIST')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute.pp\n# Target line: 89\n\n     84:       force_config_drive            => false,\n     85:     }\n     86: \n     87:     class { '::nova::placement':\n     88:       auth_url    => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\n>>>  89:       password    => hiera('CONFIG_NOVA_KS_PW'),\n     90:       region_name => hiera('CONFIG_KEYSTONE_REGION'),\n     91:     }\n     92: \n     93:     class { '::nova::compute::pci':\n     94:       passthrough => hiera('CONFIG_NOVA_PCI_PASSTHROUGH_WHITELIST')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'EA312927';", "line": 88, "detection_span": [83, 93], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'dist',\nkey      => '7F0CEB10';\n'mongodb3.2':\nlocation => 'https://repo.mongodb.org/apt/ubuntu',\nrelease  => 'trusty/mongodb-org/3.2',\n88:       key      => 'EA312927';\n'nginx':\nlocation => 'https://nginx.org/packages/ubuntu/',\nrelease  => 'trusty',\nkey      => 'ABF5BD827BD9BF62';\n'nginx-precise':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 88\n\n     83:       release  => 'dist',\n     84:       key      => '7F0CEB10';\n     85:     'mongodb3.2':\n     86:       location => 'https://repo.mongodb.org/apt/ubuntu',\n     87:       release  => 'trusty/mongodb-org/3.2',\n>>>  88:       key      => 'EA312927';\n     89:     'nginx':\n     90:       location => 'https://nginx.org/packages/ubuntu/',\n     91:       release  => 'trusty',\n     92:       key      => 'ABF5BD827BD9BF62';\n     93:     'nginx-precise':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp", "content": "$superuser        = false,", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n\n$password_hash    = false,\n$createdb         = false,\n$createrole       = false,\n$db               = 'postgres',\n$login            = false,\n25:   $superuser        = false,\n$replication      = false,\n$connection_limit = '-1',\n$username         = $title\n) {\ninclude postgresql::params", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n# Target line: 25\n\n     20:   $password_hash    = false,\n     21:   $createdb         = false,\n     22:   $createrole       = false,\n     23:   $db               = 'postgres',\n     24:   $login            = false,\n>>>  25:   $superuser        = false,\n     26:   $replication      = false,\n     27:   $connection_limit = '-1',\n     28:   $username         = $title\n     29: ) {\n     30:   include postgresql::params\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp", "content": "key    => 'wvous-bl-modifier',", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n\nvalue  => 4,\n}\nboxen::osx_defaults { 'Bottom left screen corner \u2192 Modifier':\nuser   => $::luser,\ndomain => 'com.apple.dock',\n61:     key    => 'wvous-bl-modifier',\ntype   => 'int',\nvalue  => 0,\n}\nboxen::osx_defaults { 'Top right screen corner \u2192 Mission Control':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n# Target line: 61\n\n     56:     value  => 4,\n     57:   }\n     58:   boxen::osx_defaults { 'Bottom left screen corner \u2192 Modifier':\n     59:     user   => $::luser,\n     60:     domain => 'com.apple.dock',\n>>>  61:     key    => 'wvous-bl-modifier',\n     62:     type   => 'int',\n     63:     value  => 0,\n     64:   }\n     65:   boxen::osx_defaults { 'Top right screen corner \u2192 Mission Control':\n     66:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp", "content": "admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n\ndebug => hiera('CONFIG_DEBUG_MODE'),\n}\n\nclass { '::keystone':\nadmin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\n36:       admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\ndatabase_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\ntoken_provider      => \"${keystone_token_provider_str}\",\nenable_fernet_setup => true,\nservice_name        => 'httpd',\nenable_ssl          => $keystone_use_ssl,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n# Target line: 36\n\n     31:       debug => hiera('CONFIG_DEBUG_MODE'),\n     32:     }\n     33: \n     34:     class { '::keystone':\n     35:       admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\n>>>  36:       admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\n     37:       database_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\n     38:       token_provider      => \"${keystone_token_provider_str}\",\n     39:       enable_fernet_setup => true,\n     40:       service_name        => 'httpd',\n     41:       enable_ssl          => $keystone_use_ssl,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-aodh.pp", "content": "password => 'aodh',", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-aodh.pp\n\ndatabase_connection        => 'mysql+pymysql://aodh:aodh@127.0.0.1/aodh?charset=utf8',\nnotification_topics        => $notification_topics,\nnotification_driver        => 'messagingv2',\n}\nclass { '::aodh::db::mysql':\n52:     password => 'aodh',\n}\nclass { '::aodh::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:8042\",\ninternal_url => \"${::openstack_integration::config::base_url}:8042\",\nadmin_url    => \"${::openstack_integration::config::base_url}:8042\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-aodh.pp\n# Target line: 52\n\n     47:     database_connection        => 'mysql+pymysql://aodh:aodh@127.0.0.1/aodh?charset=utf8',\n     48:     notification_topics        => $notification_topics,\n     49:     notification_driver        => 'messagingv2',\n     50:   }\n     51:   class { '::aodh::db::mysql':\n>>>  52:     password => 'aodh',\n     53:   }\n     54:   class { '::aodh::keystone::auth':\n     55:     public_url   => \"${::openstack_integration::config::base_url}:8042\",\n     56:     internal_url => \"${::openstack_integration::config::base_url}:8042\",\n     57:     admin_url    => \"${::openstack_integration::config::base_url}:8042\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-postgresql-manifests-server-role.pp", "content": "$pwd_md5 = md5(\"${password_hash}${username}\")", "line": 115, "detection_span": [110, 120], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n\n110:\nif $password_hash and $update_password {\nif($password_hash =~ /^md5.+/) {\n$pwd_hash_sql = $password_hash\n} else {\n115:         $pwd_md5 = md5(\"${password_hash}${username}\")\n$pwd_hash_sql = \"md5${pwd_md5}\"\n}\npostgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\ncommand     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\nunless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n# Target line: 115\n\n    110: \n    111:     if $password_hash and $update_password {\n    112:       if($password_hash =~ /^md5.+/) {\n    113:         $pwd_hash_sql = $password_hash\n    114:       } else {\n>>> 115:         $pwd_md5 = md5(\"${password_hash}${username}\")\n    116:         $pwd_hash_sql = \"md5${pwd_md5}\"\n    117:       }\n    118:       postgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\n    119:         command     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\n    120:         unless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ceph-manifests-mgr.pp", "content": "$inject_key          = false,", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: openstack@puppet-ceph-manifests-mgr.pp\n\n$enable              = true,\n$ensure              = running,\n$cluster             = 'ceph',\n$authentication_type = 'cephx',\n$key                 = undef,\n53:   $inject_key          = false,\n) {\nfile { '/var/lib/ceph/mgr':\nensure  => directory,\nowner   => 'ceph',\ngroup   => 'ceph',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ceph-manifests-mgr.pp\n# Target line: 53\n\n     48:   $enable              = true,\n     49:   $ensure              = running,\n     50:   $cluster             = 'ceph',\n     51:   $authentication_type = 'cephx',\n     52:   $key                 = undef,\n>>>  53:   $inject_key          = false,\n     54: ) {\n     55:   file { '/var/lib/ceph/mgr':\n     56:     ensure  => directory,\n     57:     owner   => 'ceph',\n     58:     group   => 'ceph',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-manuals_publisher.pp", "content": "$email_alert_api_bearer_token = undef,", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-manuals_publisher.pp\n\n#   Default: undef\n#\nclass govuk::apps::manuals_publisher(\n$port = 3205,\n$asset_manager_bearer_token = undef,\n67:   $email_alert_api_bearer_token = undef,\n$enable_procfile_worker = true,\n$sentry_dsn = undef,\n$mongodb_nodes,\n$mongodb_name,\n$oauth_id = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-manuals_publisher.pp\n# Target line: 67\n\n     62: #   Default: undef\n     63: #\n     64: class govuk::apps::manuals_publisher(\n     65:   $port = 3205,\n     66:   $asset_manager_bearer_token = undef,\n>>>  67:   $email_alert_api_bearer_token = undef,\n     68:   $enable_procfile_worker = true,\n     69:   $sentry_dsn = undef,\n     70:   $mongodb_nodes,\n     71:   $mongodb_name,\n     72:   $oauth_id = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-influxdb-bootstrap.pp", "content": "$influxdb_dbuser_ro_password = undef,", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n\n# [*influxdb_retention_replication*]\n#   influxdb retention policy replication factor\n#\nclass monasca::influxdb::bootstrap(\n$influxdb_password = undef,\n30:   $influxdb_dbuser_ro_password = undef,\n$influxdb_def_ret_pol_name = 'raw',\n$influxdb_def_ret_pol_duration = '390d',\n$influxdb_tmp_ret_pol_name = 'tmp',\n$influxdb_tmp_ret_pol_duration = '1h',\n$influxdb_retention_replication = 1,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n# Target line: 30\n\n     25: # [*influxdb_retention_replication*]\n     26: #   influxdb retention policy replication factor\n     27: #\n     28: class monasca::influxdb::bootstrap(\n     29:   $influxdb_password = undef,\n>>>  30:   $influxdb_dbuser_ro_password = undef,\n     31:   $influxdb_def_ret_pol_name = 'raw',\n     32:   $influxdb_def_ret_pol_duration = '390d',\n     33:   $influxdb_tmp_ret_pol_name = 'tmp',\n     34:   $influxdb_tmp_ret_pol_duration = '1h',\n     35:   $influxdb_retention_replication = 1,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-global-key_repeat_rate.pp", "content": "key    => 'KeyRepeat',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: quintel@boxen-modules-osx-manifests-global-key_repeat_rate.pp\n\n#     rate => 2\n#   }\nclass osx::global::key_repeat_rate($rate = 0) {\nboxen::osx_defaults { 'key repeat rate':\ndomain => 'NSGlobalDomain',\n17:     key    => 'KeyRepeat',\nvalue  => $rate,\nuser   => $::boxen_user;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-osx-manifests-global-key_repeat_rate.pp\n# Target line: 17\n\n     12: #     rate => 2\n     13: #   }\n     14: class osx::global::key_repeat_rate($rate = 0) {\n     15:   boxen::osx_defaults { 'key repeat rate':\n     16:     domain => 'NSGlobalDomain',\n>>>  17:     key    => 'KeyRepeat',\n     18:     value  => $rate,\n     19:     user   => $::boxen_user;\n     20:   }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-zooming.pp", "content": "key    => 'closeViewScrollWheelToggle',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-zooming.pp\n\nclass people::felho::osx_settings::zooming {\nboxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) modifier key to zoom':\nuser   => $::luser,\ndomain => 'com.apple.universalaccess',\n5:     key    => 'closeViewScrollWheelToggle',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Zooming: zoom panning mode':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-zooming.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::zooming {\n      2:   boxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) modifier key to zoom':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.universalaccess',\n>>>   5:     key    => 'closeViewScrollWheelToggle',\n      6:     type   => 'bool',\n      7:     value  => true,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Zooming: zoom panning mode':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-magnum.pp", "content": "password             => hiera('CONFIG_MAGNUM_KS_PW'),", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-magnum.pp\n\nclass { '::magnum::keystone::authtoken':\nwww_authenticate_uri => \"${magnum_protocol}://${magnum_host}:5000/v3\",\nauth_url             => \"${magnum_protocol}://${magnum_host}:5000\",\nauth_version         => 'v3',\nusername             => 'magnum',\n20:       password             => hiera('CONFIG_MAGNUM_KS_PW'),\nauth_type            => 'password',\nmemcached_servers    => \"${magnum_host}:11211\",\nproject_name         => 'services'\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-magnum.pp\n# Target line: 20\n\n     15:     class { '::magnum::keystone::authtoken':\n     16:       www_authenticate_uri => \"${magnum_protocol}://${magnum_host}:5000/v3\",\n     17:       auth_url             => \"${magnum_protocol}://${magnum_host}:5000\",\n     18:       auth_version         => 'v3',\n     19:       username             => 'magnum',\n>>>  20:       password             => hiera('CONFIG_MAGNUM_KS_PW'),\n     21:       auth_type            => 'password',\n     22:       memcached_servers    => \"${magnum_host}:11211\",\n     23:       project_name         => 'services'\n     24:     }\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-shorewall-manifests-mangle.pp", "content": "$user            = '-',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: duritong@puppet-shorewall-manifests-mangle.pp\n\n$destination,\n$action          = $name,\n$proto           = '-',\n$destinationport = '-',\n$sourceport      = '-',\n8:   $user            = '-',\n$test            = '-',\n$length          = '-',\n$tos             = '-',\n$connbytes       = '-',\n$helper          = '-',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-shorewall-manifests-mangle.pp\n# Target line: 8\n\n      3:   $destination,\n      4:   $action          = $name,\n      5:   $proto           = '-',\n      6:   $destinationport = '-',\n      7:   $sourceport      = '-',\n>>>   8:   $user            = '-',\n      9:   $test            = '-',\n     10:   $length          = '-',\n     11:   $tos             = '-',\n     12:   $connbytes       = '-',\n     13:   $helper          = '-',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write-rabbitmq.pp", "content": "$amqp_pass  = 'backdrop_write',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write-rabbitmq.pp\n\n#   The virtual host that this application is restricted to\n#   Default: backdrop_write\n#\nclass govuk::apps::backdrop_write::rabbitmq (\n$amqp_user  = 'backdrop_write',\n29:   $amqp_pass  = 'backdrop_write',\n$amqp_vhost = 'backdrop_write',\n) {\n\nrabbitmq_vhost { \"/${amqp_vhost}\":\nensure   => present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write-rabbitmq.pp\n# Target line: 29\n\n     24: #   The virtual host that this application is restricted to\n     25: #   Default: backdrop_write\n     26: #\n     27: class govuk::apps::backdrop_write::rabbitmq (\n     28:   $amqp_user  = 'backdrop_write',\n>>>  29:   $amqp_pass  = 'backdrop_write',\n     30:   $amqp_vhost = 'backdrop_write',\n     31: ) {\n     32: \n     33:   rabbitmq_vhost { \"/${amqp_vhost}\":\n     34:     ensure   => present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_clicking.pp", "content": "key    => 'com.apple.mouse.tapBehavior',", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_clicking.pp\n\n\nboxen::osx_defaults { 'Enable tap to click for the active user':\nuser   => $::luser,\nhost   => 'currentHost',\ndomain => 'NSGlobalDomain',\n36:     key    => 'com.apple.mouse.tapBehavior',\ntype   => 'int',\nvalue  => $tapBehavior,\n}\n\nboxen::osx_defaults { 'Enable tap to click on the login screen':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_clicking.pp\n# Target line: 36\n\n     31: \n     32:   boxen::osx_defaults { 'Enable tap to click for the active user':\n     33:     user   => $::luser,\n     34:     host   => 'currentHost',\n     35:     domain => 'NSGlobalDomain',\n>>>  36:     key    => 'com.apple.mouse.tapBehavior',\n     37:     type   => 'int',\n     38:     value  => $tapBehavior,\n     39:   }\n     40: \n     41:   boxen::osx_defaults { 'Enable tap to click on the login screen':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "biemond@biemond-oradb-manifests-autostartdatabase.pp", "content": "String $user         = lookup('oradb::user'),", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: biemond@biemond-oradb-manifests-autostartdatabase.pp\n\n# @param service_name\n#\ndefine oradb::autostartdatabase(\nString $oracle_home  = undef,\nString $db_name      = lookup('oradb::database_name'),\n23:   String $user         = lookup('oradb::user'),\nString $service_name = lookup('oradb::host::service_name')\n){\n\nclass { 'oradb::prepareautostart':\noracle_home  => $oracle_home,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-oradb-manifests-autostartdatabase.pp\n# Target line: 23\n\n     18: # @param service_name\n     19: #\n     20: define oradb::autostartdatabase(\n     21:   String $oracle_home  = undef,\n     22:   String $db_name      = lookup('oradb::database_name'),\n>>>  23:   String $user         = lookup('oradb::user'),\n     24:   String $service_name = lookup('oradb::host::service_name')\n     25: ){\n     26: \n     27:   class { 'oradb::prepareautostart':\n     28:     oracle_home  => $oracle_home,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp", "content": "key               => '89DF5277',", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n\n::apt::source { 'packages.dotdeb.org-php56-repo.puphpet':\nlocation          => 'http://repo.puphpet.com/dotdeb/',\nrelease           => 'wheezy-php56',\nrepos             => 'all',\nrequired_packages => 'debian-keyring debian-archive-keyring',\n41:           key               => '89DF5277',\nkey_server        => 'keys.gnupg.net',\ninclude_src       => true\n}\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n# Target line: 41\n\n     36:        ::apt::source { 'packages.dotdeb.org-php56-repo.puphpet':\n     37:           location          => 'http://repo.puphpet.com/dotdeb/',\n     38:           release           => 'wheezy-php56',\n     39:           repos             => 'all',\n     40:           required_packages => 'debian-keyring debian-archive-keyring',\n>>>  41:           key               => '89DF5277',\n     42:           key_server        => 'keys.gnupg.net',\n     43:           include_src       => true\n     44:         }\n     45:       }\n     46:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-nginx-manifests-init.pp", "content": "user       => 'www-data',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-init.pp\n\nnotify => Class['nginx::service'];\n}\n\nlimits::limits { 'www-data_nofile':\nensure     => present,\n23:     user       => 'www-data',\nlimit_type => 'nofile',\nboth       => 16384,\n}\n\nclass { 'nginx::package':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-init.pp\n# Target line: 23\n\n     18:     notify => Class['nginx::service'];\n     19:   }\n     20: \n     21:   limits::limits { 'www-data_nofile':\n     22:     ensure     => present,\n>>>  23:     user       => 'www-data',\n     24:     limit_type => 'nofile',\n     25:     both       => 16384,\n     26:   }\n     27: \n     28:   class { 'nginx::package':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "solarkennedy@puppet-consul-manifests-params.pp", "content": "$user = 'consul'", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: solarkennedy@puppet-consul-manifests-params.pp\n\n$config_defaults  = {\ndata_dir => '/opt/consul'\n}\n$manage_user = true\n$manage_group = true\n56:       $user = 'consul'\n$group = 'consul'\n}\n}\n\ncase $facts['os']['name'] {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: solarkennedy@puppet-consul-manifests-params.pp\n# Target line: 56\n\n     51:       $config_defaults  = {\n     52:         data_dir => '/opt/consul'\n     53:       }\n     54:       $manage_user = true\n     55:       $manage_group = true\n>>>  56:       $user = 'consul'\n     57:       $group = 'consul'\n     58:     }\n     59:   }\n     60: \n     61:   case $facts['os']['name'] {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-gnocchi-examples-site.pp", "content": "password     => 'verysecrete',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: openstack@puppet-gnocchi-examples-site.pp\n\n\nclass { '::gnocchi::keystone::auth':\nadmin_url    => 'http://10.0.0.1:8041',\ninternal_url => 'http://10.0.0.1:8041',\npublic_url   => 'http://10.0.0.1:8041',\n7:   password     => 'verysecrete',\nregion       => 'OpenStack'\n}\n\nclass { '::gnocchi':\ndatabase_connection => 'mysql+pymysql://gnocchi:secrete@10.0.0.1/gnocchi?charset=utf8',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-gnocchi-examples-site.pp\n# Target line: 7\n\n      2: \n      3: class { '::gnocchi::keystone::auth':\n      4:   admin_url    => 'http://10.0.0.1:8041',\n      5:   internal_url => 'http://10.0.0.1:8041',\n      6:   public_url   => 'http://10.0.0.1:8041',\n>>>   7:   password     => 'verysecrete',\n      8:   region       => 'OpenStack'\n      9: }\n     10: \n     11: class { '::gnocchi':\n     12:   database_connection => 'mysql+pymysql://gnocchi:secrete@10.0.0.1/gnocchi?charset=utf8',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp", "content": "$postgres_password    = undef,", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n\n#\nclass govuk::node::s_transition_db_admin(\n$backup_s3_bucket     = undef,\n$postgres_host        = undef,\n$postgres_user        = undef,\n11:   $postgres_password    = undef,\n$postgres_port        = '5432',\n$postgres_backup_hour = 7,\n$postgres_backup_min  = 30,\n$apt_mirror_hostname,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n# Target line: 11\n\n      6: #\n      7: class govuk::node::s_transition_db_admin(\n      8:   $backup_s3_bucket     = undef,\n      9:   $postgres_host        = undef,\n     10:   $postgres_user        = undef,\n>>>  11:   $postgres_password    = undef,\n     12:   $postgres_port        = '5432',\n     13:   $postgres_backup_hour = 7,\n     14:   $postgres_backup_min  = 30,\n     15:   $apt_mirror_hostname,\n     16: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'ABF5BD827BD9BF62';", "line": 92, "detection_span": [87, 97], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'trusty/mongodb-org/3.2',\nkey      => 'EA312927';\n'nginx':\nlocation => 'https://nginx.org/packages/ubuntu/',\nrelease  => 'trusty',\n92:       key      => 'ABF5BD827BD9BF62';\n'nginx-precise':\nlocation => 'https://nginx.org/packages/ubuntu/',\nrelease  => 'precise',\nkey      => 'ABF5BD827BD9BF62';\n'nodejs':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 92\n\n     87:       release  => 'trusty/mongodb-org/3.2',\n     88:       key      => 'EA312927';\n     89:     'nginx':\n     90:       location => 'https://nginx.org/packages/ubuntu/',\n     91:       release  => 'trusty',\n>>>  92:       key      => 'ABF5BD827BD9BF62';\n     93:     'nginx-precise':\n     94:       location => 'https://nginx.org/packages/ubuntu/',\n     95:       release  => 'precise',\n     96:       key      => 'ABF5BD827BD9BF62';\n     97:     'nodejs':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-dev@devstack-vagrant-puppet-modules-user-manifests-stack.pp", "content": "is_admin => true,", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-stack.pp\n\n\nuser::create { 'stack':\nuser => $username,\npass => $stack_password,\nkey => $stack_sshkey,\n25:     is_admin => true,\n} ->\n\nfile {'/home/stack/.bashrc':\nowner => $username,\ngroup => $username,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-stack.pp\n# Target line: 25\n\n     20: \n     21:   user::create { 'stack':\n     22:     user => $username,\n     23:     pass => $stack_password,\n     24:     key => $stack_sshkey,\n>>>  25:     is_admin => true,\n     26:   } ->\n     27: \n     28:   file {'/home/stack/.bashrc':\n     29:     owner => $username,\n     30:     group => $username,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-mplayerx.pp", "content": "key    => 'ASVTS',", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-mplayerx.pp\n\ntype   => 'int',\nvalue  => 0;\n'ASVTS (this should be set for some reason)':\nuser   => $::luser,\ndomain => 'org.niltsh.MPlayerX',\n28:       key    => 'ASVTS',\ntype   => 'int',\nvalue  => 2;\n}\n\nboxen::osx_defaults { 'MPlayerX: set subtitle font color to red':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-mplayerx.pp\n# Target line: 28\n\n     23:       type   => 'int',\n     24:       value  => 0;\n     25:     'ASVTS (this should be set for some reason)':\n     26:       user   => $::luser,\n     27:       domain => 'org.niltsh.MPlayerX',\n>>>  28:       key    => 'ASVTS',\n     29:       type   => 'int',\n     30:       value  => 2;\n     31:   }\n     32: \n     33:   boxen::osx_defaults { 'MPlayerX: set subtitle font color to red':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp", "content": "routing_key   => '*.major.#',", "line": 44, "detection_span": [39, 49], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n\n} ->\n\ngovuk_rabbitmq::queue_with_binding { $amqp_major_change_queue:\namqp_exchange => $amqp_exchange,\namqp_queue    => $amqp_major_change_queue,\n44:     routing_key   => '*.major.#',\ndurable       => true,\n} ->\n\ngovuk_rabbitmq::queue_with_binding { $amqp_unpublishing_queue:\namqp_exchange => $amqp_exchange,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n# Target line: 44\n\n     39:   } ->\n     40: \n     41:   govuk_rabbitmq::queue_with_binding { $amqp_major_change_queue:\n     42:     amqp_exchange => $amqp_exchange,\n     43:     amqp_queue    => $amqp_major_change_queue,\n>>>  44:     routing_key   => '*.major.#',\n     45:     durable       => true,\n     46:   } ->\n     47: \n     48:   govuk_rabbitmq::queue_with_binding { $amqp_unpublishing_queue:\n     49:     amqp_exchange => $amqp_exchange,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-ctf-hidden_file-manifests-install.pp", "content": "password   => pw_hash($account['password'], 'SHA-512', 'mysalt'),", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ctf-hidden_file-manifests-install.pp\n\n$storage_directory = \"/home/$username\"\n\n# Create user account\n::accounts::user { $username:\nshell      => '/bin/bash',\n18:       password   => pw_hash($account['password'], 'SHA-512', 'mysalt'),\nmanagehome => true,\nhome_mode  => '0755',\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ctf-hidden_file-manifests-install.pp\n# Target line: 18\n\n     13:     $storage_directory = \"/home/$username\"\n     14: \n     15:     # Create user account\n     16:     ::accounts::user { $username:\n     17:       shell      => '/bin/bash',\n>>>  18:       password   => pw_hash($account['password'], 'SHA-512', 'mysalt'),\n     19:       managehome => true,\n     20:       home_mode  => '0755',\n     21:     }\n     22:   }\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp", "content": "routing_key   => '*.*',", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\nensure        => $toggled_ensure,\namqp_exchange => $amqp_exchange,\namqp_queue    => 'rummager_govuk_index',\n48:     routing_key   => '*.*',\ndurable       => true,\n}\n\n# When we want to manually refresh data in search, we can run a task in\n# publishing API to send \"bulk reindex\" messages. The routing key has", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n# Target line: 48\n\n     43: \n     44:   govuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\n     45:     ensure        => $toggled_ensure,\n     46:     amqp_exchange => $amqp_exchange,\n     47:     amqp_queue    => 'rummager_govuk_index',\n>>>  48:     routing_key   => '*.*',\n     49:     durable       => true,\n     50:   }\n     51: \n     52:   # When we want to manually refresh data in search, we can run a task in\n     53:   # publishing API to send \"bulk reindex\" messages. The routing key has\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-table_grant.pp", "content": "$psql_user = undef", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-table_grant.pp\n\n$privilege,\n$table,\n$db,\n$role,\n$psql_db   = undef,\n8:   $psql_user = undef\n) {\ninclude postgresql::params\npostgresql::grant { \"table:${name}\":\nrole        => $role,\ndb          => $db,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-table_grant.pp\n# Target line: 8\n\n      3:   $privilege,\n      4:   $table,\n      5:   $db,\n      6:   $role,\n      7:   $psql_db   = undef,\n>>>   8:   $psql_user = undef\n      9: ) {\n     10:   include postgresql::params\n     11:   postgresql::grant { \"table:${name}\":\n     12:     role        => $role,\n     13:     db          => $db,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-divvy.pp", "content": "key    => 'globalHotkey',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-divvy.pp\n\n}\n\npeople::felho::osx_defaults_extended { 'Divvy globalHotkey':\nuser   => $::luser,\ndomain => 'com.mizage.Divvy',\n12:     key    => 'globalHotkey',\ntype   => 'dict',\nvalue  => { 'keyCode' => 13, 'modifiers' => 2304 },\n}\n\nboxen::osx_defaults { 'Divvy shortcuts':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-divvy.pp\n# Target line: 12\n\n      7:   }\n      8: \n      9:   people::felho::osx_defaults_extended { 'Divvy globalHotkey':\n     10:     user   => $::luser,\n     11:     domain => 'com.mizage.Divvy',\n>>>  12:     key    => 'globalHotkey',\n     13:     type   => 'dict',\n     14:     value  => { 'keyCode' => 13, 'modifiers' => 2304 },\n     15:   }\n     16: \n     17:   boxen::osx_defaults { 'Divvy shortcuts':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-keystone-auth.pp", "content": "$configure_user      = true,", "line": 79, "detection_span": [74, 84], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-keystone-auth.pp\n\n$password,\n$auth_name           = 'neutron',\n$email               = 'neutron@localhost',\n$tenant              = 'services',\n$configure_endpoint  = true,\n79:   $configure_user      = true,\n$configure_user_role = true,\n$service_name        = 'neutron',\n$service_type        = 'network',\n$service_description = 'Neutron Networking Service',\n$region              = 'RegionOne',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-keystone-auth.pp\n# Target line: 79\n\n     74:   $password,\n     75:   $auth_name           = 'neutron',\n     76:   $email               = 'neutron@localhost',\n     77:   $tenant              = 'services',\n     78:   $configure_endpoint  = true,\n>>>  79:   $configure_user      = true,\n     80:   $configure_user_role = true,\n     81:   $service_name        = 'neutron',\n     82:   $service_type        = 'network',\n     83:   $service_description = 'Neutron Networking Service',\n     84:   $region              = 'RegionOne',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-tijmenbrommet.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChxDnHtmrP+8wTqONV76/sHMAVkJeyeMs/yDNl4+bumjWum9+ZqKGTS6QvvZGh/rTKg5934ncv5xPv910NmisYW6SetjT4hWMZuqtnZKdLBN2YpSyqTjIWK0kpdKMS1linkeE5/6X38Ebi3UKP63VqTsDM7o4W2v/CshoIbC5+UKt7WjtcMsrijpul1leSw8gvwCtoq6z5N3vLqECTcv5/AoH+LxWDW/TYlywGqUD4Lfa1jJGf+D5ICK+StQMQ1RBU4ICby43htus+RR+NqMyDnQLkGdrVVT+/Tc2jQrj0wz78nVvJPULiG889NvgPrjXn1s9w45DuVl7i3a4c+X8yFGg6hcgW8pHcH+2sOPC5g1Y84ZARLj6yIr1ezdr6H5vSLiUBTauYuTOP3u2F5h1MKLHdXuhUKaV4jIj42jKpCwnKnd62uHs4oOkfIz4OFbVNCNDvUdBMYbRkJd8yDYHeSzbEFElSSSxBRtwMnfX1DJ21myNtI0AGzQMP27NYkroHQGLmbbHiLeWuFly8yuEmeeustdtQBwf6qMTcJeCXtAkzgTUDFYLsu3zBCZQN9wJt/OCBPrGbwn5cutaUMmn9RGEeUgqNYxzvKEwmF+1/QINAD3PZjk3byfh0u1LRYnppvQrfsg24wh5dtlTRzPfuPxtrWdKTxkPm3gLvqdJmvw== tijmen.brommet@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-tijmenbrommet.pp\n\n# Creates the tijmenbrommet user\nclass users::tijmenbrommet {\ngovuk_user { 'tijmenbrommet':\nfullname => 'Tijmen Brommet',\nemail    => 'tijmen.brommet@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChxDnHtmrP+8wTqONV76/sHMAVkJeyeMs/yDNl4+bumjWum9+ZqKGTS6QvvZGh/rTKg5934ncv5xPv910NmisYW6SetjT4hWMZuqtnZKdLBN2YpSyqTjIWK0kpdKMS1linkeE5/6X38Ebi3UKP63VqTsDM7o4W2v/CshoIbC5+UKt7WjtcMsrijpul1leSw8gvwCtoq6z5N3vLqECTcv5/AoH+LxWDW/TYlywGqUD4Lfa1jJGf+D5ICK+StQMQ1RBU4ICby43htus+RR+NqMyDnQLkGdrVVT+/Tc2jQrj0wz78nVvJPULiG889NvgPrjXn1s9w45DuVl7i3a4c+X8yFGg6hcgW8pHcH+2sOPC5g1Y84ZARLj6yIr1ezdr6H5vSLiUBTauYuTOP3u2F5h1MKLHdXuhUKaV4jIj42jKpCwnKnd62uHs4oOkfIz4OFbVNCNDvUdBMYbRkJd8yDYHeSzbEFElSSSxBRtwMnfX1DJ21myNtI0AGzQMP27NYkroHQGLmbbHiLeWuFly8yuEmeeustdtQBwf6qMTcJeCXtAkzgTUDFYLsu3zBCZQN9wJt/OCBPrGbwn5cutaUMmn9RGEeUgqNYxzvKEwmF+1/QINAD3PZjk3byfh0u1LRYnppvQrfsg24wh5dtlTRzPfuPxtrWdKTxkPm3gLvqdJmvw== tijmen.brommet@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-tijmenbrommet.pp\n# Target line: 6\n\n      1: # Creates the tijmenbrommet user\n      2: class users::tijmenbrommet {\n      3:   govuk_user { 'tijmenbrommet':\n      4:     fullname => 'Tijmen Brommet',\n      5:     email    => 'tijmen.brommet@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChxDnHtmrP+8wTqONV76/sHMAVkJeyeMs/yDNl4+bumjWum9+ZqKGTS6QvvZGh/rTKg5934ncv5xPv910NmisYW6SetjT4hWMZuqtnZKdLBN2YpSyqTjIWK0kpdKMS1linkeE5/6X38Ebi3UKP63VqTsDM7o4W2v/CshoIbC5+UKt7WjtcMsrijpul1leSw8gvwCtoq6z5N3vLqECTcv5/AoH+LxWDW/TYlywGqUD4Lfa1jJGf+D5ICK+StQMQ1RBU4ICby43htus+RR+NqMyDnQLkGdrVVT+/Tc2jQrj0wz78nVvJPULiG889NvgPrjXn1s9w45DuVl7i3a4c+X8yFGg6hcgW8pHcH+2sOPC5g1Y84ZARLj6yIr1ezdr6H5vSLiUBTauYuTOP3u2F5h1MKLHdXuhUKaV4jIj42jKpCwnKnd62uHs4oOkfIz4OFbVNCNDvUdBMYbRkJd8yDYHeSzbEFElSSSxBRtwMnfX1DJ21myNtI0AGzQMP27NYkroHQGLmbbHiLeWuFly8yuEmeeustdtQBwf6qMTcJeCXtAkzgTUDFYLsu3zBCZQN9wJt/OCBPrGbwn5cutaUMmn9RGEeUgqNYxzvKEwmF+1/QINAD3PZjk3byfh0u1LRYnppvQrfsg24wh5dtlTRzPfuPxtrWdKTxkPm3gLvqdJmvw== tijmen.brommet@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-init.pp", "content": "$manage_user         = true,", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-init.pp\n\n$user                = $::tomcat::params::user,\n$group               = $::tomcat::params::group,\n$install_from_source = true,\n$purge_connectors    = false,\n$purge_realms        = false,\n37:   $manage_user         = true,\n$manage_group        = true,\n$manage_home         = true,\n$manage_base         = true,\n$manage_properties   = true,\n) inherits ::tomcat::params {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-init.pp\n# Target line: 37\n\n     32:   $user                = $::tomcat::params::user,\n     33:   $group               = $::tomcat::params::group,\n     34:   $install_from_source = true,\n     35:   $purge_connectors    = false,\n     36:   $purge_realms        = false,\n>>>  37:   $manage_user         = true,\n     38:   $manage_group        = true,\n     39:   $manage_home         = true,\n     40:   $manage_base         = true,\n     41:   $manage_properties   = true,\n     42: ) inherits ::tomcat::params {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp", "content": "key    => 'wvous-tl-corner',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n\n# 10: Put display to sleep\n# 11: Launchpad\nboxen::osx_defaults { 'Top left screen corner \u2192 Application windows':\nuser   => $::luser,\ndomain => 'com.apple.dock',\n40:     key    => 'wvous-tl-corner',\ntype   => 'int',\nvalue  => 3,\n}\nboxen::osx_defaults { 'Top left screen corner \u2192 Modifier':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n# Target line: 40\n\n     35:   # 10: Put display to sleep\n     36:   # 11: Launchpad\n     37:   boxen::osx_defaults { 'Top left screen corner \u2192 Application windows':\n     38:     user   => $::luser,\n     39:     domain => 'com.apple.dock',\n>>>  40:     key    => 'wvous-tl-corner',\n     41:     type   => 'int',\n     42:     value  => 3,\n     43:   }\n     44:   boxen::osx_defaults { 'Top left screen corner \u2192 Modifier':\n     45:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n'curl', default: {\n$http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n$http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n$http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n$ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n}\n'wget': {\n$http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n$http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n$http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 58\n\n     53:     'curl', default: {\n     54:       $http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n     55:       $http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n     56:       $http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n     57:       $ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n>>>  58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n     59:     }\n     60:     'wget': {\n     61:       $http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n     62:       $http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n     63:       $http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-db-mysql.pp", "content": "$user          = 'neutron',", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-db-mysql.pp\n\n#   Defaults to 'utf8_general_ci'\n#\nclass neutron::db::mysql (\n$password,\n$dbname        = 'neutron',\n36:   $user          = 'neutron',\n$host          = '127.0.0.1',\n$allowed_hosts = undef,\n$charset       = 'utf8',\n$collate       = 'utf8_general_ci',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-db-mysql.pp\n# Target line: 36\n\n     31: #   Defaults to 'utf8_general_ci'\n     32: #\n     33: class neutron::db::mysql (\n     34:   $password,\n     35:   $dbname        = 'neutron',\n>>>  36:   $user          = 'neutron',\n     37:   $host          = '127.0.0.1',\n     38:   $allowed_hosts = undef,\n     39:   $charset       = 'utf8',\n     40:   $collate       = 'utf8_general_ci',\n     41: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-radosgw_keystone.pp", "content": "configure_user      => false,", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-radosgw_keystone.pp\n\nadmin_url           => $admin_url,\ninternal_url        => $internal_url,\n}->\n\nkeystone::resource::service_identity { 'radosgw_s3':\n45:     configure_user      => false,\nconfigure_user_role => false,\nservice_type        => 's3',\nservice_description => 'Openstack Object-Store Service',\nservice_name        => 'swift_s3',\nregion              => $region,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-radosgw_keystone.pp\n# Target line: 45\n\n     40:     admin_url           => $admin_url,\n     41:     internal_url        => $internal_url,\n     42:   }->\n     43: \n     44:   keystone::resource::service_identity { 'radosgw_s3':\n>>>  45:     configure_user      => false,\n     46:     configure_user_role => false,\n     47:     service_type        => 's3',\n     48:     service_description => 'Openstack Object-Store Service',\n     49:     service_name        => 'swift_s3',\n     50:     region              => $region,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph_nova_compute.pp", "content": "$user                = 'compute',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph_nova_compute.pp\n\n# configure the nova_compute parts if present\nclass osnailyfacter::ceph_nova_compute (\n$rbd_secret_uuid     = 'a5d0dd94-57c4-ae55-ffe0-7e3732a24455',\n4:   $user                = 'compute',\n$compute_pool        = 'compute',\n$secret_xml          = '/root/.secret_attrs.xml',\n$libvirt_images_type = 'rbd',\n) {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph_nova_compute.pp\n# Target line: 4\n\n      1: # configure the nova_compute parts if present\n      2: class osnailyfacter::ceph_nova_compute (\n      3:   $rbd_secret_uuid     = 'a5d0dd94-57c4-ae55-ffe0-7e3732a24455',\n>>>   4:   $user                = 'compute',\n      5:   $compute_pool        = 'compute',\n      6:   $secret_xml          = '/root/.secret_attrs.xml',\n      7:   $libvirt_images_type = 'rbd',\n      8: ) {\n      9: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-hpelefthand.pp", "content": "$cinder_hpelefthand_username           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_username', undef),", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-hpelefthand.pp\n\n#   Defaults to hiera('step')\n#\nclass tripleo::profile::base::cinder::volume::hpelefthand (\n$backend_name                          = hiera('cinder::backend::hpelefthand_iscsi::volume_backend_name', 'tripleo_hpelefthand'),\n$backend_availability_zone             = hiera('cinder::backend::hpelefthand_iscsi::backend_availability_zone', undef),\n55:   $cinder_hpelefthand_username           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_username', undef),\n$cinder_hpelefthand_password           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_password', undef),\n$cinder_hpelefthand_clustername        = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_clustername', undef),\n$cinder_hpelefthand_api_url            = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_api_url', undef),\n$cinder_hpelefthand_iscsi_chap_enabled = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_iscsi_chap_enabled', undef),\n$cinder_hpelefthand_debug              = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_debug', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-hpelefthand.pp\n# Target line: 55\n\n     50: #   Defaults to hiera('step')\n     51: #\n     52: class tripleo::profile::base::cinder::volume::hpelefthand (\n     53:   $backend_name                          = hiera('cinder::backend::hpelefthand_iscsi::volume_backend_name', 'tripleo_hpelefthand'),\n     54:   $backend_availability_zone             = hiera('cinder::backend::hpelefthand_iscsi::backend_availability_zone', undef),\n>>>  55:   $cinder_hpelefthand_username           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_username', undef),\n     56:   $cinder_hpelefthand_password           = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_password', undef),\n     57:   $cinder_hpelefthand_clustername        = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_clustername', undef),\n     58:   $cinder_hpelefthand_api_url            = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_api_url', undef),\n     59:   $cinder_hpelefthand_iscsi_chap_enabled = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_iscsi_chap_enabled', undef),\n     60:   $cinder_hpelefthand_debug              = hiera('cinder::backend::hpelefthand_iscsi::hpelefthand_debug', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-apt-manifests-debian-testing.pp", "content": "key_server        => 'subkeys.pgp.net',", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apt-manifests-debian-testing.pp\n\nlocation          => 'http://debian.mirror.iweb.ca/debian/',\nrelease           => 'testing',\nrepos             => 'main contrib non-free',\nrequired_packages => 'debian-keyring debian-archive-keyring',\nkey               => '46925553',\n18:     key_server        => 'subkeys.pgp.net',\npin               => '-10',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apt-manifests-debian-testing.pp\n# Target line: 18\n\n     13:     location          => 'http://debian.mirror.iweb.ca/debian/',\n     14:     release           => 'testing',\n     15:     repos             => 'main contrib non-free',\n     16:     required_packages => 'debian-keyring debian-archive-keyring',\n     17:     key               => '46925553',\n>>>  18:     key_server        => 'subkeys.pgp.net',\n     19:     pin               => '-10',\n     20:   }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker.pp", "content": "$amqp_pass = 'guest',", "line": 44, "detection_span": [39, 49], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker.pp\n\nclass govuk::apps::govuk_crawler_worker (\n$airbrake_api_key = '',\n$airbrake_endpoint = '',\n$airbrake_env = '',\n$amqp_host = 'localhost',\n44:   $amqp_pass = 'guest',\n$blacklist_paths = [],\n$enabled   = false,\n$mirror_root = '/mnt/crawler_worker',\n$port = '3074',\n$root_urls = [],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker.pp\n# Target line: 44\n\n     39: class govuk::apps::govuk_crawler_worker (\n     40:   $airbrake_api_key = '',\n     41:   $airbrake_endpoint = '',\n     42:   $airbrake_env = '',\n     43:   $amqp_host = 'localhost',\n>>>  44:   $amqp_pass = 'guest',\n     45:   $blacklist_paths = [],\n     46:   $enabled   = false,\n     47:   $mirror_root = '/mnt/crawler_worker',\n     48:   $port = '3074',\n     49:   $root_urls = [],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp", "content": "$amqp_user  = 'content_data_api',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n\n#   The RabbitMQ queue to set up for workers of this type to read from\n#   for bulk importer of content into the Content Data API\n#   (default: 'content_data_api_govuk_importer')\n#\nclass govuk::apps::content_data_api::rabbitmq (\n30:   $amqp_user  = 'content_data_api',\n$amqp_pass = undef,\n$amqp_exchange = 'published_documents',\n$amqp_queue = 'content_data_api',\n$amqp_bulk_importing_queue = 'content_data_api_govuk_importer'\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n# Target line: 30\n\n     25: #   The RabbitMQ queue to set up for workers of this type to read from\n     26: #   for bulk importer of content into the Content Data API\n     27: #   (default: 'content_data_api_govuk_importer')\n     28: #\n     29: class govuk::apps::content_data_api::rabbitmq (\n>>>  30:   $amqp_user  = 'content_data_api',\n     31:   $amqp_pass = undef,\n     32:   $amqp_exchange = 'published_documents',\n     33:   $amqp_queue = 'content_data_api',\n     34:   $amqp_bulk_importing_queue = 'content_data_api_govuk_importer'\n     35: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$nodetree = {", "line": 98, "detection_span": [93, 103], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n98: $nodetree = {\n'annex1.example.com' => {\n100: \t\t'ip' => '172.16.1.81',\n101: \t\t'uuid' => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n102: \t\t'bricks' => {\n103: \t\t\t'/mnt/storage1a' => $brick1a,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 98\n\n     93: \txfs_inode64 => true,\n     94: \txfs_nobarrier => true,\n     95: \tareyousure => true,\n     96: }\n     97: \n>>>  98: $nodetree = {\n     99: \t'annex1.example.com' => {\n    100: \t\t'ip' => '172.16.1.81',\n    101: \t\t'uuid' => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n    102: \t\t'bricks' => {\n    103: \t\t\t'/mnt/storage1a' => $brick1a,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-network-contrail-database.pp", "content": "$admin_password       = hiera('contrail::admin_password'),", "line": 107, "detection_span": [102, 112], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-database.pp\n\n102: #  (optional) Zookeeper ip list\n103: #  Array of string (IPv4) values\n104: #  Defaults to hiera('contrail_database_node_ips')\n105: #\n106: class tripleo::network::contrail::database(\n107:   $admin_password       = hiera('contrail::admin_password'),\n108:   $admin_tenant_name    = hiera('contrail::admin_tenant_name'),\n$admin_token          = hiera('contrail::admin_token'),\n$admin_user           = hiera('contrail::admin_user'),\n$api_server           = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n$api_port             = hiera('contrail::api_port'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-database.pp\n# Target line: 107\n\n    102: #  (optional) Zookeeper ip list\n    103: #  Array of string (IPv4) values\n    104: #  Defaults to hiera('contrail_database_node_ips')\n    105: #\n    106: class tripleo::network::contrail::database(\n>>> 107:   $admin_password       = hiera('contrail::admin_password'),\n    108:   $admin_tenant_name    = hiera('contrail::admin_tenant_name'),\n    109:   $admin_token          = hiera('contrail::admin_token'),\n    110:   $admin_user           = hiera('contrail::admin_user'),\n    111:   $api_server           = hiera('contrail_config_vip',hiera('internal_api_virtual_ip')),\n    112:   $api_port             = hiera('contrail::api_port'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "biemond@biemond-wildfly-manifests-init.pp", "content": "Boolean $manage_user                                        = true,", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: biemond@biemond-wildfly-manifests-init.pp\n\nStdlib::Unixpath $dirname                                   = '/opt/wildfly',\nStdlib::Unixpath $java_home                                 = '/usr/java/default',\nStdlib::Unixpath $console_log                               = '/var/log/wildfly/console.log',\nStdlib::Unixpath $install_cache_dir                         = '/var/cache/wget',\nStdlib::Unixpath $deploy_cache_dir                          = '/opt',\n64:   Boolean $manage_user                                        = true,\nString $user                                                = 'wildfly',\nStdlib::Unixpath $user_home                                 = '/home/wildfly',\nString $group                                               = 'wildfly',\nString $mode_template                                       = \"wildfly/${mode}.conf\",\nWildfly::Config_file $config                                = 'standalone.xml',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-wildfly-manifests-init.pp\n# Target line: 64\n\n     59:   Stdlib::Unixpath $dirname                                   = '/opt/wildfly',\n     60:   Stdlib::Unixpath $java_home                                 = '/usr/java/default',\n     61:   Stdlib::Unixpath $console_log                               = '/var/log/wildfly/console.log',\n     62:   Stdlib::Unixpath $install_cache_dir                         = '/var/cache/wget',\n     63:   Stdlib::Unixpath $deploy_cache_dir                          = '/opt',\n>>>  64:   Boolean $manage_user                                        = true,\n     65:   String $user                                                = 'wildfly',\n     66:   Stdlib::Unixpath $user_home                                 = '/home/wildfly',\n     67:   String $group                                               = 'wildfly',\n     68:   String $mode_template                                       = \"wildfly/${mode}.conf\",\n     69:   Wildfly::Config_file $config                                = 'standalone.xml',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-dock-2d.pp", "content": "key    => 'no-glass',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: boxen@puppet-osx-manifests-dock-2d.pp\n\nclass osx::dock::2d {\ninclude osx::dock\n\nboxen::osx_defaults { 'Use a flat, 2d style for the Dock':\nuser   => $::boxen_user,\n7:     key    => 'no-glass',\ndomain => 'com.apple.dock',\nvalue  => true,\nnotify => Exec['killall Dock'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-dock-2d.pp\n# Target line: 7\n\n      2: class osx::dock::2d {\n      3:   include osx::dock\n      4: \n      5:   boxen::osx_defaults { 'Use a flat, 2d style for the Dock':\n      6:     user   => $::boxen_user,\n>>>   7:     key    => 'no-glass',\n      8:     domain => 'com.apple.dock',\n      9:     value  => true,\n     10:     notify => Exec['killall Dock'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-db-online_data_migrations.pp", "content": "user        => 'ironic',", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-db-online_data_migrations.pp\n\ninclude ::ironic::params\n\nexec { 'ironic-db-online-data-migrations':\ncommand     => \"${::ironic::params::dbsync_command} ${extra_params} online_data_migrations ${migration_params}\",\npath        => '/usr/bin',\n28:     user        => 'ironic',\nrefreshonly => true,\ntry_sleep   => 5,\ntries       => 10,\nlogoutput   => on_failure,\nsubscribe   => [", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-db-online_data_migrations.pp\n# Target line: 28\n\n     23:   include ::ironic::params\n     24: \n     25:   exec { 'ironic-db-online-data-migrations':\n     26:     command     => \"${::ironic::params::dbsync_command} ${extra_params} online_data_migrations ${migration_params}\",\n     27:     path        => '/usr/bin',\n>>>  28:     user        => 'ironic',\n     29:     refreshonly => true,\n     30:     try_sleep   => 5,\n     31:     tries       => 10,\n     32:     logoutput   => on_failure,\n     33:     subscribe   => [\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$brick2c = {", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n48: $brick2c = {\ndev => '/dev/disk/by-id/scsi-36003048007df450014ca280e1bda8e70',\t# /dev/sdd\nlabeltype => 'gpt',\nfstype => 'xfs',\nfsuuid => '2c434d6c-7800-4eec-9121-483bee2336f6',\nxfs_inode64 => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 48\n\n     43: \txfs_inode64 => true,\n     44: \txfs_nobarrier => true,\n     45: \tareyousure => true,\n     46: }\n     47: \n>>>  48: $brick2c = {\n     49: \tdev => '/dev/disk/by-id/scsi-36003048007df450014ca280e1bda8e70',\t# /dev/sdd\n     50: \tlabeltype => 'gpt',\n     51: \tfstype => 'xfs',\n     52: \tfsuuid => '2c434d6c-7800-4eec-9121-483bee2336f6',\n     53: \txfs_inode64 => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp", "content": "$nginx_ssl_kibana_certificate  = undef,", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n\n$logstash_ssl_certificate      = undef,\n$logstash_ssl_key              = undef,\n# /FIXME.\n$nginx_ssl_elastic_certificate = undef,\n$nginx_ssl_elastic_key         = undef,\n18:   $nginx_ssl_kibana_certificate  = undef,\n$nginx_ssl_kibana_key          = undef,\n) { }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n# Target line: 18\n\n     13:   $logstash_ssl_certificate      = undef,\n     14:   $logstash_ssl_key              = undef,\n     15:   # /FIXME.\n     16:   $nginx_ssl_elastic_certificate = undef,\n     17:   $nginx_ssl_elastic_key         = undef,\n>>>  18:   $nginx_ssl_kibana_certificate  = undef,\n     19:   $nginx_ssl_kibana_key          = undef,\n     20:   ) { }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puphpet@puppet-puphpet-manifests-params.pp", "content": "$ssh_username      = pick(getvar('::ssh_username'), 'root')", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: puphpet@puppet-puphpet-manifests-params.pp\n\n$extra_config_files = []\n) {\n\n$puphpet_core_dir  = pick(getvar('::puphpet_core_dir'), '/opt/puphpet')\n$puphpet_state_dir = pick(getvar('::puphpet_state_dir'), '/opt/puphpet-state')\n7:   $ssh_username      = pick(getvar('::ssh_username'), 'root')\n$provisioner_type  = pick(getvar('::provisioner_type'), 'remote')\n\n$puphpet_manifest_dir = \"${puphpet_core_dir}/puppet/modules/puphpet\"\n\n$base_configs = [", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puphpet@puppet-puphpet-manifests-params.pp\n# Target line: 7\n\n      2:   $extra_config_files = []\n      3: ) {\n      4: \n      5:   $puphpet_core_dir  = pick(getvar('::puphpet_core_dir'), '/opt/puphpet')\n      6:   $puphpet_state_dir = pick(getvar('::puphpet_state_dir'), '/opt/puphpet-state')\n>>>   7:   $ssh_username      = pick(getvar('::ssh_username'), 'root')\n      8:   $provisioner_type  = pick(getvar('::provisioner_type'), 'remote')\n      9: \n     10:   $puphpet_manifest_dir = \"${puphpet_core_dir}/puppet/modules/puphpet\"\n     11: \n     12:   $base_configs = [\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-glance.pp", "content": "swift_store_key                     => 'a_big_secret',", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-glance.pp\n\n}\n'swift': {\n$backend_store = ['swift']\nclass { '::glance::backend::swift':\nswift_store_user                    => 'services:glance',\n70:         swift_store_key                     => 'a_big_secret',\nswift_store_create_container_on_put => 'True',\nswift_store_auth_address            => \"${::openstack_integration::config::keystone_auth_uri}/v3\",\nswift_store_auth_version            => '3',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-glance.pp\n# Target line: 70\n\n     65:     }\n     66:     'swift': {\n     67:       $backend_store = ['swift']\n     68:       class { '::glance::backend::swift':\n     69:         swift_store_user                    => 'services:glance',\n>>>  70:         swift_store_key                     => 'a_big_secret',\n     71:         swift_store_create_container_on_put => 'True',\n     72:         swift_store_auth_address            => \"${::openstack_integration::config::keystone_auth_uri}/v3\",\n     73:         swift_store_auth_version            => '3',\n     74:       }\n     75:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-params.pp", "content": "$gitlab_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n\n$gitlab_email_display_name= 'GitLab'\n$gitlab_support_email     = 'support@localhost'\n$gitlab_ssl               = false\n$gitlab_ssl_protocols     = 'TLSv1.2 TLSv1.1 TLSv1'\n$gitlab_ssl_ciphers       = 'AES:HIGH:!aNULL:!RC4:!MD5:!ADH:!MDF'\n64:   $gitlab_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n$gitlab_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$gitlab_ssl_self_signed   = false\n$gitlab_projects          = '10'\n$gitlab_username_change   = true\n$gitlab_unicorn_listen    = '127.0.0.1'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n# Target line: 64\n\n     59:   $gitlab_email_display_name= 'GitLab'\n     60:   $gitlab_support_email     = 'support@localhost'\n     61:   $gitlab_ssl               = false\n     62:   $gitlab_ssl_protocols     = 'TLSv1.2 TLSv1.1 TLSv1'\n     63:   $gitlab_ssl_ciphers       = 'AES:HIGH:!aNULL:!RC4:!MD5:!ADH:!MDF'\n>>>  64:   $gitlab_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n     65:   $gitlab_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     66:   $gitlab_ssl_self_signed   = false\n     67:   $gitlab_projects          = '10'\n     68:   $gitlab_username_change   = true\n     69:   $gitlab_unicorn_listen    = '127.0.0.1'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-apps-mirror_rubygems.pp", "content": "user        => 'rubygems',", "line": 103, "detection_span": [98, 108], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-apps-mirror_rubygems.pp\n\n\ncron { 'rubygems-mirror' :\nminute      => $cron_frequency,\ncommand     => 'flock -n /var/run/rubygems/mirror.lock timeout -k 2m 30m gem mirror 2>&1 | logger -t rubygems-mirror',\nenvironment => 'PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin',\n103:     user        => 'rubygems',\n104:   }\n105:\n106: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-apps-mirror_rubygems.pp\n# Target line: 103\n\n     98: \n     99:   cron { 'rubygems-mirror' :\n    100:     minute      => $cron_frequency,\n    101:     command     => 'flock -n /var/run/rubygems/mirror.lock timeout -k 2m 30m gem mirror 2>&1 | logger -t rubygems-mirror',\n    102:     environment => 'PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin',\n>>> 103:     user        => 'rubygems',\n    104:   }\n    105: \n    106: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_from_staging_to_aws.pp", "content": "$whitehall_mysql_password = undef,", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_from_staging_to_aws.pp\n\n$mysql_dst_root_pw = undef,\n$pg_src_env_sync_pw = undef,\n$pg_dst_env_sync_pw = undef,\n$pg_tr_dst_env_sync_pw = undef,\n$pg_tr_src_env_sync_pw = undef,\n12:   $whitehall_mysql_password = undef,\n$app_domain = hiera('app_domain'),\n) {\n$check_name = 'copy_data_from_staging_to_aws'\n$service_description = 'Copy Data from Production to Aws'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_from_staging_to_aws.pp\n# Target line: 12\n\n      7:   $mysql_dst_root_pw = undef,\n      8:   $pg_src_env_sync_pw = undef,\n      9:   $pg_dst_env_sync_pw = undef,\n     10:   $pg_tr_dst_env_sync_pw = undef,\n     11:   $pg_tr_src_env_sync_pw = undef,\n>>>  12:   $whitehall_mysql_password = undef,\n     13:   $app_domain = hiera('app_domain'),\n     14: ) {\n     15:   $check_name = 'copy_data_from_staging_to_aws'\n     16:   $service_description = 'Copy Data from Production to Aws'\n     17: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp", "content": "$ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n\n$swarm_password = ''\n$swarm_package = 'jenkins-swarm-slave'\n$swarm_service = 'jenkins-swarm-slave'\n\n$ssl_cert_file = '/etc/ssl/jenkins.crt'\n32:   $ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\nMIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\nVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\ncyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\nMDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT\nb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQxGjAY", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n# Target line: 32\n\n     27:   $swarm_password = ''\n     28:   $swarm_package = 'jenkins-swarm-slave'\n     29:   $swarm_service = 'jenkins-swarm-slave'\n     30: \n     31:   $ssl_cert_file = '/etc/ssl/jenkins.crt'\n>>>  32:   $ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\n     33: MIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\n     34: VTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\n     35: cyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\n     36: MDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT\n     37: b21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQxGjAY\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "password => 'whitehall',", "line": 99, "detection_span": [94, 104], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\n'whitehall_test14',\n'whitehall_test15',\n'whitehall_test16',\n]:\nuser     => 'whitehall',\n99:       password => 'whitehall',\ngrant    => ['ALL'],\nrequire  => Class['::mysql::server'];\n102:   }\n103: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 99\n\n     94:       'whitehall_test14',\n     95:       'whitehall_test15',\n     96:       'whitehall_test16',\n     97:     ]:\n     98:       user     => 'whitehall',\n>>>  99:       password => 'whitehall',\n    100:       grant    => ['ALL'],\n    101:       require  => Class['::mysql::server'];\n    102:   }\n    103: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'stable',\nkey      => 'D88E42B4';\n'elasticsearch-1.5':\nlocation => 'http://packages.elastic.co/elasticsearch/1.5/debian',\nrelease  => 'stable',\n56:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n'elasticsearch-1.7':\nlocation => 'http://packages.elastic.co/elasticsearch/1.7/debian',\nrelease  => 'stable',\nkey      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n'elasticsearch-2.x':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 56\n\n     51:       release  => 'stable',\n     52:       key      => 'D88E42B4';\n     53:     'elasticsearch-1.5':\n     54:       location => 'http://packages.elastic.co/elasticsearch/1.5/debian',\n     55:       release  => 'stable',\n>>>  56:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n     57:     'elasticsearch-1.7':\n     58:       location => 'http://packages.elastic.co/elasticsearch/1.7/debian',\n     59:       release  => 'stable',\n     60:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n     61:     'elasticsearch-2.x':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-amqp.pp", "content": "ssl_fail_if_no_peer_cert => true,", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-amqp.pp\n\npackage_provider         => 'yum',\nrepos_ensure             => false,\nadmin_enable             => false,\nloopback_users           => [],\n# FIXME: it's ugly to not to require client certs\n33:       ssl_fail_if_no_peer_cert => true,\nconfig_variables         => {\n'tcp_listen_options' => '[binary,{packet, raw},{reuseaddr, true},{backlog, 128},{nodelay, true},{exit_on_close, false},{keepalive, true}]',\n},\n}\n} else {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-amqp.pp\n# Target line: 33\n\n     28:       package_provider         => 'yum',\n     29:       repos_ensure             => false,\n     30:       admin_enable             => false,\n     31:       loopback_users           => [],\n     32:       # FIXME: it's ugly to not to require client certs\n>>>  33:       ssl_fail_if_no_peer_cert => true,\n     34:       config_variables         => {\n     35:      'tcp_listen_options' => '[binary,{packet, raw},{reuseaddr, true},{backlog, 128},{nodelay, true},{exit_on_close, false},{keepalive, true}]',\n     36:       },\n     37:     }\n     38:   } else {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-certmonger-libvirt_dirs.pp", "content": "seluser => 'system_u',", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-certmonger-libvirt_dirs.pp\n\nif $key_dir {\nfile { $key_dir :\nensure  => 'directory',\nselrole => 'object_r',\nseltype => 'cert_t',\n55:       seluser => 'system_u',\n}\nFile[$key_dir] ~> Certmonger_certificate<| tag == 'libvirt-cert' |>\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-certmonger-libvirt_dirs.pp\n# Target line: 55\n\n     50:   if $key_dir {\n     51:     file { $key_dir :\n     52:       ensure  => 'directory',\n     53:       selrole => 'object_r',\n     54:       seltype => 'cert_t',\n>>>  55:       seluser => 'system_u',\n     56:     }\n     57:     File[$key_dir] ~> Certmonger_certificate<| tag == 'libvirt-cert' |>\n     58:   }\n     59: \n     60: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bd808@my-boxen-modules-people-manifests-bd808-osx_settings.pp", "content": "key => 'mcx-disabled',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: bd808@my-boxen-modules-people-manifests-bd808-osx_settings.pp\n\n}\nclass { 'osx::appearance::sidebar_icons': size => 'small' }\n\nboxen::osx_defaults { 'Disable dashboard':\nuser => $::boxen_user,\n17:     key => 'mcx-disabled',\ndomain => 'com.apple.dashboard',\nvalue => true,\n}\n\nclass { 'osx::desktop::displayed_items':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bd808@my-boxen-modules-people-manifests-bd808-osx_settings.pp\n# Target line: 17\n\n     12:   }\n     13:   class { 'osx::appearance::sidebar_icons': size => 'small' }\n     14: \n     15:   boxen::osx_defaults { 'Disable dashboard':\n     16:     user => $::boxen_user,\n>>>  17:     key => 'mcx-disabled',\n     18:     domain => 'com.apple.dashboard',\n     19:     value => true,\n     20:   }\n     21: \n     22:   class { 'osx::desktop::displayed_items':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-aodh.pp", "content": "$oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),", "line": 91, "detection_span": [86, 96], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n\n$oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n$oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n$oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n$oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n$oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n91:   $oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n$oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n) {\n\nif $::hostname == downcase($bootstrap_node) {\n$sync_db = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n# Target line: 91\n\n     86:   $oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     87:   $oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n     88:   $oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n     89:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n     90:   $oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n>>>  91:   $oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n     92:   $oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n     93: ) {\n     94: \n     95:   if $::hostname == downcase($bootstrap_node) {\n     96:     $sync_db = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp", "content": "password     => hiera('CONFIG_GNOCCHI_KS_PW'),", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n\n{\n$gnocchi_keystone_host_url = hiera('CONFIG_KEYSTONE_HOST_URL')\n\nclass { '::gnocchi::keystone::auth':\nregion       => hiera('CONFIG_KEYSTONE_REGION'),\n7:       password     => hiera('CONFIG_GNOCCHI_KS_PW'),\npublic_url   => \"http://${gnocchi_keystone_host_url}:8041\",\nadmin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\ninternal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n# Target line: 7\n\n      2: {\n      3:     $gnocchi_keystone_host_url = hiera('CONFIG_KEYSTONE_HOST_URL')\n      4: \n      5:     class { '::gnocchi::keystone::auth':\n      6:       region       => hiera('CONFIG_KEYSTONE_REGION'),\n>>>   7:       password     => hiera('CONFIG_GNOCCHI_KS_PW'),\n      8:       public_url   => \"http://${gnocchi_keystone_host_url}:8041\",\n      9:       admin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\n     10:       internal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n     11:     }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp", "content": "jenkins_username            => hiera('jenkins_username', 'jenkins'),", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n\nvhost_name                  => $vhost_name,\nproject_config_repo         => hiera('project_config_repo'),\nserveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\njenkins_version             => hiera('jenkins_version', 'present'),\njenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\n37:     jenkins_username            => hiera('jenkins_username', 'jenkins'),\njenkins_password            => hiera('jenkins_password', 'XXX'),\njenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\njenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\njava_args_override          => hiera('java_args_override', undef),\ngerrit_server               => hiera('gerrit_server', 'review.openstack.org'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n# Target line: 37\n\n     32:     vhost_name                  => $vhost_name,\n     33:     project_config_repo         => hiera('project_config_repo'),\n     34:     serveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\n     35:     jenkins_version             => hiera('jenkins_version', 'present'),\n     36:     jenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\n>>>  37:     jenkins_username            => hiera('jenkins_username', 'jenkins'),\n     38:     jenkins_password            => hiera('jenkins_password', 'XXX'),\n     39:     jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\n     40:     jenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\n     41:     java_args_override          => hiera('java_args_override', undef),\n     42:     gerrit_server               => hiera('gerrit_server', 'review.openstack.org'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp", "content": "$sahara_user     = pick($sahara_hash['user'], 'sahara')", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n\n$sahara_hash     = hiera_hash('sahara', {})\n$public_ssl_hash = hiera_hash('public_ssl')\n$public_vip      = hiera('public_vip')\n$admin_address   = hiera('management_vip')\n$api_bind_port   = '8386'\n10:   $sahara_user     = pick($sahara_hash['user'], 'sahara')\n$sahara_password = pick($sahara_hash['user_password'])\n$tenant          = pick($sahara_hash['tenant'], 'services')\n$region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n$service_name    = pick($sahara_hash['service_name'], 'sahara')\n$public_address = $public_ssl_hash['services'] ? {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n# Target line: 10\n\n      5:   $sahara_hash     = hiera_hash('sahara', {})\n      6:   $public_ssl_hash = hiera_hash('public_ssl')\n      7:   $public_vip      = hiera('public_vip')\n      8:   $admin_address   = hiera('management_vip')\n      9:   $api_bind_port   = '8386'\n>>>  10:   $sahara_user     = pick($sahara_hash['user'], 'sahara')\n     11:   $sahara_password = pick($sahara_hash['user_password'])\n     12:   $tenant          = pick($sahara_hash['tenant'], 'services')\n     13:   $region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n     14:   $service_name    = pick($sahara_hash['service_name'], 'sahara')\n     15:   $public_address = $public_ssl_hash['services'] ? {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp", "content": "routing_key   => '*.links',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_to_be_indexed':\nensure        => $toggled_ensure,\namqp_exchange => $amqp_exchange,\namqp_queue    => 'rummager_to_be_indexed',\n40:     routing_key   => '*.links',\ndurable       => true,\n}\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\nensure        => $toggled_ensure,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n# Target line: 40\n\n     35: \n     36:   govuk_rabbitmq::queue_with_binding { 'rummager_to_be_indexed':\n     37:     ensure        => $toggled_ensure,\n     38:     amqp_exchange => $amqp_exchange,\n     39:     amqp_queue    => 'rummager_to_be_indexed',\n>>>  40:     routing_key   => '*.links',\n     41:     durable       => true,\n     42:   }\n     43: \n     44:   govuk_rabbitmq::queue_with_binding { 'rummager_govuk_index':\n     45:     ensure        => $toggled_ensure,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-kafka-manifests-params.pp", "content": "$user           = 'kafka'", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: voxpupuli@puppet-kafka-manifests-params.pp\n\n$proxy_server   = undef\n$proxy_host     = undef\n$proxy_port     = undef\n$proxy_type     = undef\n$package_ensure = 'present'\n33:   $user           = 'kafka'\n$group          = 'kafka'\n$user_id        = undef\n$group_id       = undef\n$system_user    = false\n$system_group   = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-kafka-manifests-params.pp\n# Target line: 33\n\n     28:   $proxy_server   = undef\n     29:   $proxy_host     = undef\n     30:   $proxy_port     = undef\n     31:   $proxy_type     = undef\n     32:   $package_ensure = 'present'\n>>>  33:   $user           = 'kafka'\n     34:   $group          = 'kafka'\n     35:   $user_id        = undef\n     36:   $group_id       = undef\n     37:   $system_user    = false\n     38:   $system_group   = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-keystone.pp", "content": "$configure_user      = pick($ceilometer_hash['configure_user'], true)", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-keystone.pp\n\n\n$region              = pick($ceilometer_hash['region'], hiera('region', 'RegionOne'))\n$password            = $ceilometer_hash['user_password']\n$auth_name           = pick($ceilometer_hash['auth_name'], 'ceilometer')\n$configure_endpoint  = pick($ceilometer_hash['configure_endpoint'], true)\n26:   $configure_user      = pick($ceilometer_hash['configure_user'], true)\n$configure_user_role = pick($ceilometer_hash['configure_user_role'], true)\n$service_name        = pick($ceilometer_hash['service_name'], 'ceilometer')\n$tenant              = pick($ceilometer_hash['tenant'], 'services')\nvalidate_string($public_address)\nvalidate_string($password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-keystone.pp\n# Target line: 26\n\n     21: \n     22:   $region              = pick($ceilometer_hash['region'], hiera('region', 'RegionOne'))\n     23:   $password            = $ceilometer_hash['user_password']\n     24:   $auth_name           = pick($ceilometer_hash['auth_name'], 'ceilometer')\n     25:   $configure_endpoint  = pick($ceilometer_hash['configure_endpoint'], true)\n>>>  26:   $configure_user      = pick($ceilometer_hash['configure_user'], true)\n     27:   $configure_user_role = pick($ceilometer_hash['configure_user_role'], true)\n     28:   $service_name        = pick($ceilometer_hash['service_name'], 'ceilometer')\n     29:   $tenant              = pick($ceilometer_hash['tenant'], 'services')\n     30:   validate_string($public_address)\n     31:   validate_string($password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp", "content": "$rabbit_password            = 'rabbit_pw',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n\n$syslog_log_facility_cinder = 'LOG_LOCAL3',\n$debug                      = false,\n$verbose                    = true,\n# Rabbit details necessary for cinder\n$rabbit_nodes               = false,\n43:   $rabbit_password            = 'rabbit_pw',\n$rabbit_host                = false,\n$rabbit_user                = 'nova',\n$rabbit_ha_virtual_ip       = false,\n$queue_provider             = 'rabbitmq',\n$qpid_password              = 'qpid_pw',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n# Target line: 43\n\n     38:   $syslog_log_facility_cinder = 'LOG_LOCAL3',\n     39:   $debug                      = false,\n     40:   $verbose                    = true,\n     41:   # Rabbit details necessary for cinder\n     42:   $rabbit_nodes               = false,\n>>>  43:   $rabbit_password            = 'rabbit_pw',\n     44:   $rabbit_host                = false,\n     45:   $rabbit_user                = 'nova',\n     46:   $rabbit_ha_virtual_ip       = false,\n     47:   $queue_provider             = 'rabbitmq',\n     48:   $qpid_password              = 'qpid_pw',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "solarkennedy@puppet-consul-manifests-service.pp", "content": "$override_key = 'enable_tag_override'", "line": 88, "detection_span": [83, 93], "with_context": "# Puppet file: solarkennedy@puppet-consul-manifests-service.pp\n\ninclude consul\n\nconsul::validate_checks($checks)\n\nif versioncmp($consul::version, '1.0.0') >= 0 {\n88:     $override_key = 'enable_tag_override'\n} else {\n$override_key = 'enableTagOverride'\n}\n\n$default_config_hash = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: solarkennedy@puppet-consul-manifests-service.pp\n# Target line: 88\n\n     83:   include consul\n     84: \n     85:   consul::validate_checks($checks)\n     86: \n     87:   if versioncmp($consul::version, '1.0.0') >= 0 {\n>>>  88:     $override_key = 'enable_tag_override'\n     89:   } else {\n     90:     $override_key = 'enableTagOverride'\n     91:   }\n     92: \n     93:   $default_config_hash = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-ceph.pp", "content": "user                        => 'ceph',", "line": 123, "detection_span": [118, 128], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n\n118:\n#configure rgw to use keystone\nceph::rgw::keystone { 'radosgw.gateway':\nrgw_keystone_url            => $::openstack_integration::config::keystone_admin_uri,\nrgw_keystone_version        => 'v3',\n123:       user                        => 'ceph',\nuse_pki                     => false,\nrgw_keystone_accepted_roles => ['admin', 'member'],\nrgw_keystone_admin_domain   => $user_domain,\nrgw_keystone_admin_project  => $project,\nrgw_keystone_admin_user     => $auth_name,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n# Target line: 123\n\n    118: \n    119:     #configure rgw to use keystone\n    120:     ceph::rgw::keystone { 'radosgw.gateway':\n    121:       rgw_keystone_url            => $::openstack_integration::config::keystone_admin_uri,\n    122:       rgw_keystone_version        => 'v3',\n>>> 123:       user                        => 'ceph',\n    124:       use_pki                     => false,\n    125:       rgw_keystone_accepted_roles => ['admin', 'member'],\n    126:       rgw_keystone_admin_domain   => $user_domain,\n    127:       rgw_keystone_admin_project  => $project,\n    128:       rgw_keystone_admin_user     => $auth_name,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$certificate = undef, #: https certificate file", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n#\ndefine staging::file (\n$source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n$target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n$username    = undef, #: https or ftp username\n16:   $certificate = undef, #: https certificate file\n$password    = undef, #: https or ftp user password or https certificate password\n$environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n$timeout     = undef, #: the the time to wait for the file transfer to complete\n$curl_option = undef, #: options to pass to curl\n$wget_option = undef, #: options to pass to wget", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 16\n\n     11: #\n     12: define staging::file (\n     13:   $source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n     14:   $target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n     15:   $username    = undef, #: https or ftp username\n>>>  16:   $certificate = undef, #: https certificate file\n     17:   $password    = undef, #: https or ftp user password or https certificate password\n     18:   $environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n     19:   $timeout     = undef, #: the the time to wait for the file transfer to complete\n     20:   $curl_option = undef, #: options to pass to curl\n     21:   $wget_option = undef, #: options to pass to wget\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-erinrajstaniland.pp", "content": "ssh_key  => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMcNbnQbVVQAse1UUD8OD/HuKQJ2Divi6scGvNKfL4ai erin.raj-staniland@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-erinrajstaniland.pp\n\n# Creates erinrajstaniland user\nclass users::erinrajstaniland {\ngovuk_user { 'erinrajstaniland':\nfullname => 'Erin Raj-Staniland',\nemail    => 'erin.raj-staniland@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMcNbnQbVVQAse1UUD8OD/HuKQJ2Divi6scGvNKfL4ai erin.raj-staniland@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-erinrajstaniland.pp\n# Target line: 6\n\n      1: # Creates erinrajstaniland user\n      2: class users::erinrajstaniland {\n      3:   govuk_user { 'erinrajstaniland':\n      4:     fullname => 'Erin Raj-Staniland',\n      5:     email    => 'erin.raj-staniland@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMcNbnQbVVQAse1UUD8OD/HuKQJ2Divi6scGvNKfL4ai erin.raj-staniland@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-osx-manifests-universal_access-ctrl_mod_zoom.pp", "content": "key    => 'HIDScrollZoomModifierMask',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: quintel@boxen-modules-osx-manifests-universal_access-ctrl_mod_zoom.pp\n\n# Public: Enables Ctrl-scroll to zoom.\nclass osx::universal_access::ctrl_mod_zoom {\nboxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) key to zoom':\nuser   => $::boxen_user,\ndomain => 'com.apple.universalaccess',\n6:     key    => 'HIDScrollZoomModifierMask',\nvalue  => 262144;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-osx-manifests-universal_access-ctrl_mod_zoom.pp\n# Target line: 6\n\n      1: # Public: Enables Ctrl-scroll to zoom.\n      2: class osx::universal_access::ctrl_mod_zoom {\n      3:   boxen::osx_defaults { 'Use scroll gesture with the Ctrl (^) key to zoom':\n      4:     user   => $::boxen_user,\n      5:     domain => 'com.apple.universalaccess',\n>>>   6:     key    => 'HIDScrollZoomModifierMask',\n      7:     value  => 262144;\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_warehouse_db_admin.pp", "content": "key          => 'B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8',", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_warehouse_db_admin.pp\n\napt::source { 'postgresql':\nensure       => present,\nlocation     => \"http://${apt_mirror_hostname}/postgresql\",\nrelease      => \"${::lsbdistcodename}-pgdg\",\narchitecture => $::architecture,\n57:     key          => 'B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8',\n} ->\n\nclass { '::postgresql::server':\ndefault_connect_settings => $default_connect_settings,\n} ->", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_warehouse_db_admin.pp\n# Target line: 57\n\n     52:   apt::source { 'postgresql':\n     53:     ensure       => present,\n     54:     location     => \"http://${apt_mirror_hostname}/postgresql\",\n     55:     release      => \"${::lsbdistcodename}-pgdg\",\n     56:     architecture => $::architecture,\n>>>  57:     key          => 'B97B0AFCAA1A47F044F244A07FCC7D46ACCC4CF8',\n     58:   } ->\n     59: \n     60:   class { '::postgresql::server':\n     61:     default_connect_settings => $default_connect_settings,\n     62:   } ->\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-bootstrap-manifests-params.pp", "content": "$docroot          = '/var/www'", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-params.pp\n\n# the following config variables should rarely be touched\n$source_path      = '/usr/src/installer/'\n$admin_user       = 'training'\n$ec2_lock_passwd  = true\n\n13:   $docroot          = '/var/www'\n$psk              = 'figaro'\n\n$courseware_cache = '/var/cache/showoff/courseware'\n$courseware_url   = 'git@github.com:puppet-training/courseware.git'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-params.pp\n# Target line: 13\n\n      8:   # the following config variables should rarely be touched\n      9:   $source_path      = '/usr/src/installer/'\n     10:   $admin_user       = 'training'\n     11:   $ec2_lock_passwd  = true\n     12: \n>>>  13:   $docroot          = '/var/www'\n     14:   $psk              = 'figaro'\n     15: \n     16:   $courseware_cache = '/var/cache/showoff/courseware'\n     17:   $courseware_url   = 'git@github.com:puppet-training/courseware.git'\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-transition-postgresql_db.pp", "content": "$password = '',", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-transition-postgresql_db.pp\n\n#\n# [*lb_ip_range*]\n#   Network range for the load balancer.\n#\nclass govuk::apps::transition::postgresql_db (\n20:   $password = '',\n$backend_ip_range = '10.3.0.0/16',\n$allow_auth_from_lb = false,\n$lb_ip_range = undef,\n$rds = false,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-transition-postgresql_db.pp\n# Target line: 20\n\n     15: #\n     16: # [*lb_ip_range*]\n     17: #   Network range for the load balancer.\n     18: #\n     19: class govuk::apps::transition::postgresql_db (\n>>>  20:   $password = '',\n     21:   $backend_ip_range = '10.3.0.0/16',\n     22:   $allow_auth_from_lb = false,\n     23:   $lb_ip_range = undef,\n     24:   $rds = false,\n     25: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus_creds.pp", "content": "$https_local_certificate = undef,", "line": 119, "detection_span": [114, 124], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus_creds.pp\n\n114:   $nve_src_intf = undef,\n$physnet      = undef,\n$vpc_pool     = undef,\n117:   $intfcfg_portchannel = undef,\n118:   $https_verify = undef,\n119:   $https_local_certificate = undef,\n120:\n121: ) {\n122:   include ::neutron::deps\n123:\n124:   ensure_resource('file', '/var/lib/neutron/.ssh',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus_creds.pp\n# Target line: 119\n\n    114:   $nve_src_intf = undef,\n    115:   $physnet      = undef,\n    116:   $vpc_pool     = undef,\n    117:   $intfcfg_portchannel = undef,\n    118:   $https_verify = undef,\n>>> 119:   $https_local_certificate = undef,\n    120: \n    121: ) {\n    122:   include ::neutron::deps\n    123: \n    124:   ensure_resource('file', '/var/lib/neutron/.ssh',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp", "content": "$default_ssl_cert     = '/etc/pki/tls/certs/localhost.crt'", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n\n$ports_file           = \"${conf_dir}/ports.conf\"\n$logroot              = '/var/log/httpd'\n$lib_path             = 'modules'\n$mpm_module           = 'prefork'\n$dev_packages         = 'httpd-devel'\n46:     $default_ssl_cert     = '/etc/pki/tls/certs/localhost.crt'\n$default_ssl_key      = '/etc/pki/tls/private/localhost.key'\n$ssl_certs_dir        = $distrelease ? {\n'5' => '/etc/pki/tls/certs',\n'6' => '/etc/ssl/certs',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n# Target line: 46\n\n     41:     $ports_file           = \"${conf_dir}/ports.conf\"\n     42:     $logroot              = '/var/log/httpd'\n     43:     $lib_path             = 'modules'\n     44:     $mpm_module           = 'prefork'\n     45:     $dev_packages         = 'httpd-devel'\n>>>  46:     $default_ssl_cert     = '/etc/pki/tls/certs/localhost.crt'\n     47:     $default_ssl_key      = '/etc/pki/tls/private/localhost.key'\n     48:     $ssl_certs_dir        = $distrelease ? {\n     49:       '5' => '/etc/pki/tls/certs',\n     50:       '6' => '/etc/ssl/certs',\n     51:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ceph-manifests-rgw-keystone.pp", "content": "$rgw_keystone_admin_token         = undef,", "line": 101, "detection_span": [96, 106], "with_context": "# Puppet file: openstack@puppet-ceph-manifests-rgw-keystone.pp\n\n$rgw_keystone_token_cache_size    = 500,\n$rgw_s3_auth_use_keystone         = true,\n$rgw_keystone_implicit_tenants    = true,\n## DEPRECATED PARAMS\n$rgw_keystone_version             = undef,\n101:   $rgw_keystone_admin_token         = undef,\n$use_pki                          = undef,\n103:   $rgw_keystone_revocation_interval = undef,\n$nss_db_path                      = undef,\n$user                             = undef,\n106: ) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ceph-manifests-rgw-keystone.pp\n# Target line: 101\n\n     96:   $rgw_keystone_token_cache_size    = 500,\n     97:   $rgw_s3_auth_use_keystone         = true,\n     98:   $rgw_keystone_implicit_tenants    = true,\n     99:   ## DEPRECATED PARAMS\n    100:   $rgw_keystone_version             = undef,\n>>> 101:   $rgw_keystone_admin_token         = undef,\n    102:   $use_pki                          = undef,\n    103:   $rgw_keystone_revocation_interval = undef,\n    104:   $nss_db_path                      = undef,\n    105:   $user                             = undef,\n    106: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-zaqar.pp", "content": "ssl_key   => \"/etc/zaqar/ssl/private/${::fqdn}.pem\",", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-zaqar.pp\n\ninclude ::apache\nclass { '::zaqar::wsgi::apache':\nbind_host => $::openstack_integration::config::ip_for_url,\nssl       => $::openstack_integration::config::ssl,\nssl_cert  => $::openstack_integration::params::cert_path,\n56:     ssl_key   => \"/etc/zaqar/ssl/private/${::fqdn}.pem\",\nworkers   => 2,\n}\ninclude ::zaqar::db::sync\n# run a second instance using websockets, the Debian system does\n# not support the use of services to run a second instance.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-zaqar.pp\n# Target line: 56\n\n     51:   include ::apache\n     52:   class { '::zaqar::wsgi::apache':\n     53:     bind_host => $::openstack_integration::config::ip_for_url,\n     54:     ssl       => $::openstack_integration::config::ssl,\n     55:     ssl_cert  => $::openstack_integration::params::cert_path,\n>>>  56:     ssl_key   => \"/etc/zaqar/ssl/private/${::fqdn}.pem\",\n     57:     workers   => 2,\n     58:   }\n     59:   include ::zaqar::db::sync\n     60:   # run a second instance using websockets, the Debian system does\n     61:   # not support the use of services to run a second instance.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-haproxy-stats.pp", "content": "$user        = 'admin'", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-haproxy-stats.pp\n\nclass tripleo::haproxy::stats (\n$haproxy_listen_bind_param,\n$ip,\n$password    = undef,\n$certificate = undef,\n48:   $user        = 'admin'\n) {\nif $certificate {\n$haproxy_stats_bind_opts = {\n\"${ip}:1993\" => union($haproxy_listen_bind_param, ['ssl', 'crt', $certificate]),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-haproxy-stats.pp\n# Target line: 48\n\n     43: class tripleo::haproxy::stats (\n     44:   $haproxy_listen_bind_param,\n     45:   $ip,\n     46:   $password    = undef,\n     47:   $certificate = undef,\n>>>  48:   $user        = 'admin'\n     49: ) {\n     50:   if $certificate {\n     51:     $haproxy_stats_bind_opts = {\n     52:       \"${ip}:1993\" => union($haproxy_listen_bind_param, ['ssl', 'crt', $certificate]),\n     53:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-ftp-vsftpd-manifests-params.pp", "content": "$nopriv_user             = 'nobody'", "line": 116, "detection_span": [111, 121], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-ftp-vsftpd-manifests-params.pp\n\n$listen_address          = ''\n$local_enable            = true\n$local_root              = ''\n$local_umask             = '022'\n$log_ftp_protocol        = false\n116:   $nopriv_user             = 'nobody'\n$pam_service_name        = 'vsftpd'\n$pasv_max_port           = 0\n$pasv_min_port           = 0\n$secure_chroot_dir       = $::osfamily ? {\n/Debian/ => '/var/run/vsftpd/empty',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-ftp-vsftpd-manifests-params.pp\n# Target line: 116\n\n    111:   $listen_address          = ''\n    112:   $local_enable            = true\n    113:   $local_root              = ''\n    114:   $local_umask             = '022'\n    115:   $log_ftp_protocol        = false\n>>> 116:   $nopriv_user             = 'nobody'\n    117:   $pam_service_name        = 'vsftpd'\n    118:   $pasv_max_port           = 0\n    119:   $pasv_min_port           = 0\n    120:   $secure_chroot_dir       = $::osfamily ? {\n    121:     /Debian/ => '/var/run/vsftpd/empty',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-link.pp", "content": "$username = '*',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-link.pp\n\n$hostname,\n$port,\n$password_connect,\n$password_receive,\n$password_receive_auth = undef,\n8:   $username = '*',\n$bind_ip = '*',\n$hub = undef,\n$leaf = undef,\n$leafdepth = undef,\n$linkclass = 'servers',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-link.pp\n# Target line: 8\n\n      3:   $hostname,\n      4:   $port,\n      5:   $password_connect,\n      6:   $password_receive,\n      7:   $password_receive_auth = undef,\n>>>   8:   $username = '*',\n      9:   $bind_ip = '*',\n     10:   $hub = undef,\n     11:   $leaf = undef,\n     12:   $leafdepth = undef,\n     13:   $linkclass = 'servers',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-ceilometer.pp", "content": "$auth_username = 'ceilometer'", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-ceilometer.pp\n\n$mongo_connection = join([ \"mongodb://ceilometer:\", $mongo_password, \"@\", join($database_ip_list,':27017,') ,\":27017/ceilometer?replicaSet=rs-ceilometer\" ],'')\n$auth_url = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n$auth_uri = \"http://${keystone_ip_to_use}:5000\"\n$auth_password = $ceilometer_password\n$auth_tenant_name = 'services'\n43:   $auth_username = 'ceilometer'\n$telemetry_secret = $metering_secret\nif ($internal_vip!='') {\n$coordination_url = join([\"kazoo://\", $database_ip_to_use, ':2181'])\nClass['::ceilometer']->\nceilometer_config {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-ceilometer.pp\n# Target line: 43\n\n     38:   $mongo_connection = join([ \"mongodb://ceilometer:\", $mongo_password, \"@\", join($database_ip_list,':27017,') ,\":27017/ceilometer?replicaSet=rs-ceilometer\" ],'')\n     39:   $auth_url = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n     40:   $auth_uri = \"http://${keystone_ip_to_use}:5000\"\n     41:   $auth_password = $ceilometer_password\n     42:   $auth_tenant_name = 'services'\n>>>  43:   $auth_username = 'ceilometer'\n     44:   $telemetry_secret = $metering_secret\n     45:   if ($internal_vip!='') {\n     46:     $coordination_url = join([\"kazoo://\", $database_ip_to_use, ':2181'])\n     47:     Class['::ceilometer']->\n     48:     ceilometer_config {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-glance-db.pp", "content": "$db_user     = pick($glance_hash['db_user'], 'glance')", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-glance-db.pp\n\n\n$mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n$mysql_db_create     = pick($mysql_hash['db_create'], true)\n$mysql_root_password = $mysql_hash['root_password']\n\n14:   $db_user     = pick($glance_hash['db_user'], 'glance')\n$db_name     = pick($glance_hash['db_name'], 'glance')\n$db_password = pick($glance_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($glance_hash['db_host'], $database_vip)\n$db_create        = pick($glance_hash['db_create'], $mysql_db_create)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-glance-db.pp\n# Target line: 14\n\n      9: \n     10:   $mysql_root_user     = pick($mysql_hash['root_user'], 'root')\n     11:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     12:   $mysql_root_password = $mysql_hash['root_password']\n     13: \n>>>  14:   $db_user     = pick($glance_hash['db_user'], 'glance')\n     15:   $db_name     = pick($glance_hash['db_name'], 'glance')\n     16:   $db_password = pick($glance_hash['db_password'], $mysql_root_password)\n     17: \n     18:   $db_host          = pick($glance_hash['db_host'], $database_vip)\n     19:   $db_create        = pick($glance_hash['db_create'], $mysql_db_create)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp", "content": "$ssl_cert                    = hiera('public_ssl_cert'),", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n\n$proxy_ssl                   = false,\n$add_header                  = undef,\n$client_max_body_size        = '10m',\n$is_django                   = false,\n$client_max_body_size        = '10m',\n24:   $ssl_cert                    = hiera('public_ssl_cert'),\n$ssl_key                     = hiera('public_ssl_key'),\n$request_uuid                = false,\n$statsd_prefix               = $title,\n) {\nvalidate_bool($request_uuid)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-gunicorn_app.pp\n# Target line: 24\n\n     19:   $proxy_ssl                   = false,\n     20:   $add_header                  = undef,\n     21:   $client_max_body_size        = '10m',\n     22:   $is_django                   = false,\n     23:   $client_max_body_size        = '10m',\n>>>  24:   $ssl_cert                    = hiera('public_ssl_cert'),\n     25:   $ssl_key                     = hiera('public_ssl_key'),\n     26:   $request_uuid                = false,\n     27:   $statsd_prefix               = $title,\n     28: ) {\n     29:   validate_bool($request_uuid)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'AF953139C1DF9EF3476DE1D58F571BB27A86F4A2';", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'squeeze',\nkey      => 'ED75B5A4483DA07C';\n'duplicity':\nlocation => 'http://ppa.launchpad.net/duplicity-team/ppa/ubuntu',\nrelease  => 'trusty',\n43:       key      => 'AF953139C1DF9EF3476DE1D58F571BB27A86F4A2';\n'docker':\nlocation => 'https://download.docker.com/linux/ubuntu',\nrelease  => 'trusty',\nrepos    => ['stable'],\nkey      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 43\n\n     38:       release  => 'squeeze',\n     39:       key      => 'ED75B5A4483DA07C';\n     40:     'duplicity':\n     41:       location => 'http://ppa.launchpad.net/duplicity-team/ppa/ubuntu',\n     42:       release  => 'trusty',\n>>>  43:       key      => 'AF953139C1DF9EF3476DE1D58F571BB27A86F4A2';\n     44:     'docker':\n     45:       location => 'https://download.docker.com/linux/ubuntu',\n     46:       release  => 'trusty',\n     47:       repos    => ['stable'],\n     48:       key      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-mysql-manifests-user-grant.pp", "content": "mysql_user => 'root',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: boxen@puppet-mysql-manifests-user-grant.pp\n\nensure     => $ensure,\nusername   => $username,\nhost       => $host,\ndatabase   => $database,\ngrants     => $grants,\n37:     mysql_user => 'root',\nmysql_pass => '',\nmysql_host => $mysql::host,\nmysql_port => $mysql::port,\nexecutable => $mysql::client,\nrequire    => Exec['wait-for-mysql'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-mysql-manifests-user-grant.pp\n# Target line: 37\n\n     32:     ensure     => $ensure,\n     33:     username   => $username,\n     34:     host       => $host,\n     35:     database   => $database,\n     36:     grants     => $grants,\n>>>  37:     mysql_user => 'root',\n     38:     mysql_pass => '',\n     39:     mysql_host => $mysql::host,\n     40:     mysql_port => $mysql::port,\n     41:     executable => $mysql::client,\n     42:     require    => Exec['wait-for-mysql'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-enhanced_ecommerce_search_api.pp", "content": "$auth_password = undef,", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-enhanced_ecommerce_search_api.pp\n\n# Create a file on disk that can be parsed by jenkins-job-builder\n#\nclass govuk_jenkins::jobs::enhanced_ecommerce_search_api (\n$app_domain = hiera('app_domain'),\n$auth_username = undef,\n8:   $auth_password = undef,\n$rate_limit_token = undef,\n$cron_schedule = '0 5 * * *'\n) {\n\n$job_name = 'enhanced_ecommerce_search_api'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-enhanced_ecommerce_search_api.pp\n# Target line: 8\n\n      3: # Create a file on disk that can be parsed by jenkins-job-builder\n      4: #\n      5: class govuk_jenkins::jobs::enhanced_ecommerce_search_api (\n      6:   $app_domain = hiera('app_domain'),\n      7:   $auth_username = undef,\n>>>   8:   $auth_password = undef,\n      9:   $rate_limit_token = undef,\n     10:   $cron_schedule = '0 5 * * *'\n     11: ) {\n     12: \n     13:   $job_name = 'enhanced_ecommerce_search_api'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-jenkins-manifests-slave.pp", "content": "$gerrituser = 'jenkins',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n\n$ssh_key = undef,\n$user = true,\n$gitfullname = 'OpenStack Jenkins',\n$gitemail = 'jenkins@openstack.org',\n$gitpgpkey = 'jenkins@openstack.org',\n9:   $gerrituser = 'jenkins',\n$gerritkeytype = 'rsa',\n$gerritkey = undef,\n) {\n\ninclude ::haveged", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n# Target line: 9\n\n      4:   $ssh_key = undef,\n      5:   $user = true,\n      6:   $gitfullname = 'OpenStack Jenkins',\n      7:   $gitemail = 'jenkins@openstack.org',\n      8:   $gitpgpkey = 'jenkins@openstack.org',\n>>>   9:   $gerrituser = 'jenkins',\n     10:   $gerritkeytype = 'rsa',\n     11:   $gerritkey = undef,\n     12: ) {\n     13: \n     14:   include ::haveged\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp", "content": "$link_checker_api_bearer_token = undef,", "line": 84, "detection_span": [79, 89], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n\n$redis_port = undef,\n$secret_key_base = undef,\n$show_historical_edition_link = false,\n$email_alert_api_bearer_token = undef,\n$link_checker_api_secret_token = undef,\n84:   $link_checker_api_bearer_token = undef,\n) {\n$app_name = 'travel-advice-publisher'\n\ngovuk::app { $app_name:\napp_type           => 'rack',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n# Target line: 84\n\n     79:   $redis_port = undef,\n     80:   $secret_key_base = undef,\n     81:   $show_historical_edition_link = false,\n     82:   $email_alert_api_bearer_token = undef,\n     83:   $link_checker_api_secret_token = undef,\n>>>  84:   $link_checker_api_bearer_token = undef,\n     85: ) {\n     86:   $app_name = 'travel-advice-publisher'\n     87: \n     88:   govuk::app { $app_name:\n     89:     app_type           => 'rack',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-zuul_merger.pp", "content": "$gerrit_user = '',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n\n#\nclass openstackci::zuul_merger(\n$vhost_name = $::fqdn,\n$gearman_server = '127.0.0.1',\n$gerrit_server = '',\n23:   $gerrit_user = '',\n$known_hosts_content = '',\n$zuul_ssh_private_key = '',\n$layout_file_name = 'layout.yaml',\n$zuul_url = \"http://${::fqdn}/p\",\n$git_email = 'zuul@domain.example',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n# Target line: 23\n\n     18: #\n     19: class openstackci::zuul_merger(\n     20:   $vhost_name = $::fqdn,\n     21:   $gearman_server = '127.0.0.1',\n     22:   $gerrit_server = '',\n>>>  23:   $gerrit_user = '',\n     24:   $known_hosts_content = '',\n     25:   $zuul_ssh_private_key = '',\n     26:   $layout_file_name = 'layout.yaml',\n     27:   $zuul_url = \"http://${::fqdn}/p\",\n     28:   $git_email = 'zuul@domain.example',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-trackpad-scrolling_speed.pp", "content": "key    => 'com.apple.trackpad.scrolling',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-trackpad-scrolling_speed.pp\n\nclass people::felho::osx_settings::trackpad::scrolling_speed($speed = 0.6875) {\nboxen::osx_defaults { 'Set the scrolling speed of trackpad':\nuser   => $::luser,\ndomain => 'NSGlobalDomain',\n5:     key    => 'com.apple.trackpad.scrolling',\ntype   => 'float',\nvalue  => $speed,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-trackpad-scrolling_speed.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::trackpad::scrolling_speed($speed = 0.6875) {\n      2:   boxen::osx_defaults { 'Set the scrolling speed of trackpad':\n      3:     user   => $::luser,\n      4:     domain => 'NSGlobalDomain',\n>>>   5:     key    => 'com.apple.trackpad.scrolling',\n      6:     type   => 'float',\n      7:     value  => $speed,\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-itunes.pp", "content": "key    => 'play-songs-while-importing',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-itunes.pp\n\nclass people::felho::application_settings::itunes {\nboxen::osx_defaults { 'Disable playing songs when importing':\nuser   => $::luser,\ndomain => 'com.apple.iTunes',\n5:     key    => 'play-songs-while-importing',\ntype   => 'bool',\nvalue  => false,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-itunes.pp\n# Target line: 5\n\n      1: class people::felho::application_settings::itunes {\n      2:   boxen::osx_defaults { 'Disable playing songs when importing':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.iTunes',\n>>>   5:     key    => 'play-songs-while-importing',\n      6:     type   => 'bool',\n      7:     value  => false,\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp", "content": "log_user        => 'syslog',", "line": 112, "detection_span": [107, 117], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n\n}\n108:\nPackage['rssh'] -> File['/etc/rssh.conf'] -> File['/usr/lib/rssh/rssh_chroot_helper']\n110:\nclass { 'rsyslog':\n112:       log_user        => 'syslog',\nrun_user        => 'syslog',\nrun_group       => 'syslog',\npurge_rsyslog_d => true,\n}\n117:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n# Target line: 112\n\n    107:     }\n    108: \n    109:     Package['rssh'] -> File['/etc/rssh.conf'] -> File['/usr/lib/rssh/rssh_chroot_helper']\n    110: \n    111:     class { 'rsyslog':\n>>> 112:       log_user        => 'syslog',\n    113:       run_user        => 'syslog',\n    114:       run_group       => 'syslog',\n    115:       purge_rsyslog_d => true,\n    116:     }\n    117: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-devopslib-manifests-ssl_certificate.pp", "content": "$certificate = hiera_hash(\"ssl_certificates::${title}\"),", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-devopslib-manifests-ssl_certificate.pp\n\n# devopslib::ssl_certificate { 'sample_cert':\n#   owner => 'www-data'\n# }\n#\ndefine devopslib::ssl_certificate(\n28:   $certificate = hiera_hash(\"ssl_certificates::${title}\"),\n$owner       = 'root',\n$group       = 'root',\n$mode        = '0400',\n) {\nfile { $certificate['crt']['filename'] :", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-devopslib-manifests-ssl_certificate.pp\n# Target line: 28\n\n     23: # devopslib::ssl_certificate { 'sample_cert':\n     24: #   owner => 'www-data'\n     25: # }\n     26: #\n     27: define devopslib::ssl_certificate(\n>>>  28:   $certificate = hiera_hash(\"ssl_certificates::${title}\"),\n     29:   $owner       = 'root',\n     30:   $group       = 'root',\n     31:   $mode        = '0400',\n     32: ) {\n     33:   file { $certificate['crt']['filename'] :\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellps.pp", "content": "chap_password             => hiera('cinder::backend::eqlx::eqlx_chap_password', undef),", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellps.pp\n\nsan_thin_provision        => hiera('cinder::backend::eqlx::san_thin_provision', undef),\neqlx_group_name           => hiera('cinder::backend::eqlx::eqlx_group_name', undef),\neqlx_pool                 => hiera('cinder::backend::eqlx::eqlx_pool', undef),\nuse_chap_auth             => hiera('cinder::backend::eqlx::eqlx_use_chap', undef),\nchap_username             => hiera('cinder::backend::eqlx::eqlx_chap_login', undef),\n48:       chap_password             => hiera('cinder::backend::eqlx::eqlx_chap_password', undef),\n}\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellps.pp\n# Target line: 48\n\n     43:       san_thin_provision        => hiera('cinder::backend::eqlx::san_thin_provision', undef),\n     44:       eqlx_group_name           => hiera('cinder::backend::eqlx::eqlx_group_name', undef),\n     45:       eqlx_pool                 => hiera('cinder::backend::eqlx::eqlx_pool', undef),\n     46:       use_chap_auth             => hiera('cinder::backend::eqlx::eqlx_use_chap', undef),\n     47:       chap_username             => hiera('cinder::backend::eqlx::eqlx_chap_login', undef),\n>>>  48:       chap_password             => hiera('cinder::backend::eqlx::eqlx_chap_password', undef),\n     49:     }\n     50:   }\n     51: \n     52: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp", "content": "password             => hiera('CONFIG_CINDER_KS_PW'),", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n\n}\n\nclass { '::cinder::keystone::authtoken':\nwww_authenticate_uri => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\nauth_url             => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n31:       password             => hiera('CONFIG_CINDER_KS_PW'),\n}\n\nclass { '::cinder::api':\nbind_host               => $bind_host,\nservice_workers         => hiera('CONFIG_SERVICE_WORKERS'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n# Target line: 31\n\n     26:     }\n     27: \n     28:     class { '::cinder::keystone::authtoken':\n     29:       www_authenticate_uri => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\n     30:       auth_url             => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n>>>  31:       password             => hiera('CONFIG_CINDER_KS_PW'),\n     32:     }\n     33: \n     34:     class { '::cinder::api':\n     35:       bind_host               => $bind_host,\n     36:       service_workers         => hiera('CONFIG_SERVICE_WORKERS'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mroth@my-boxen-modules-people-manifests-mroth.pp", "content": "key    => 'AppleAquaColorVariant',", "line": 163, "detection_span": [158, 168], "with_context": "# Puppet file: mroth@my-boxen-modules-people-manifests-mroth.pp\n\n158:   # some sensible OSX defaults\n159:   #\n160:   boxen::osx_defaults {\n\"Set aqua color variant to graphite\":\nensure => present,\n163:       key    => 'AppleAquaColorVariant',\ndomain => 'NSGlobalDomain',\nuser   => $::boxen_user,\ntype   => 'int',\nvalue  => 6;\n\"disables Dashboard\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: mroth@my-boxen-modules-people-manifests-mroth.pp\n# Target line: 163\n\n    158:   # some sensible OSX defaults\n    159:   #\n    160:   boxen::osx_defaults {\n    161:     \"Set aqua color variant to graphite\":\n    162:       ensure => present,\n>>> 163:       key    => 'AppleAquaColorVariant',\n    164:       domain => 'NSGlobalDomain',\n    165:       user   => $::boxen_user,\n    166:       type   => 'int',\n    167:       value  => 6;\n    168:     \"disables Dashboard\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@puppet-foreman-manifests-config.pp", "content": "ssl_content => template('foreman/auth_kerb.conf.erb'),", "line": 136, "detection_span": [131, 141], "with_context": "# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n\nforeman::config::apache::fragment { 'lookup_identity':\nssl_content => template('foreman/lookup_identity.conf.erb'),\n}\n134:\nforeman::config::apache::fragment { 'auth_kerb':\n136:         ssl_content => template('foreman/auth_kerb.conf.erb'),\n}\n138:\n139:\nif $::foreman::ipa_manage_sssd {\n$sssd_services = join(unique(pick($facts['sssd']['services'], []) + ['ifp']), ', ')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n# Target line: 136\n\n    131:       foreman::config::apache::fragment { 'lookup_identity':\n    132:         ssl_content => template('foreman/lookup_identity.conf.erb'),\n    133:       }\n    134: \n    135:       foreman::config::apache::fragment { 'auth_kerb':\n>>> 136:         ssl_content => template('foreman/auth_kerb.conf.erb'),\n    137:       }\n    138: \n    139: \n    140:       if $::foreman::ipa_manage_sssd {\n    141:         $sssd_services = join(unique(pick($facts['sssd']['services'], []) + ['ifp']), ', ')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp", "content": "www_root             => '/opt/stagecraft/current/assets',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n\nlocation             => '/stagecraft/',\nrewrite_rules        => [\n'^/stagecraft(.*)$ $1 break'\n],\nvhost                => $::assets_internal_vhost,\n43:     www_root             => '/opt/stagecraft/current/assets',\nlocation_cfg_prepend => {\n'expires' => '1h',\n},\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n# Target line: 43\n\n     38:     location             => '/stagecraft/',\n     39:     rewrite_rules        => [\n     40:       '^/stagecraft(.*)$ $1 break'\n     41:     ],\n     42:     vhost                => $::assets_internal_vhost,\n>>>  43:     www_root             => '/opt/stagecraft/current/assets',\n     44:     location_cfg_prepend => {\n     45:       'expires' => '1h',\n     46:     },\n     47:   }\n     48: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-httpd-manifests-params.pp", "content": "$user          = 'www-data'", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: openstack-infra@puppet-httpd-manifests-params.pp\n\n$redirect_ssl  = false\n$serveraliases = undef\n$servername    = undef\n$ssl           = true\n$template      = 'httpd/vhost-default.conf.erb'\n31:   $user          = 'www-data'\n$vhost_name    = '*'\n\ncase $::operatingsystem {\n'centos', 'redhat', 'fedora', 'scientific': {\n$apache_name = 'httpd'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-httpd-manifests-params.pp\n# Target line: 31\n\n     26:   $redirect_ssl  = false\n     27:   $serveraliases = undef\n     28:   $servername    = undef\n     29:   $ssl           = true\n     30:   $template      = 'httpd/vhost-default.conf.erb'\n>>>  31:   $user          = 'www-data'\n     32:   $vhost_name    = '*'\n     33: \n     34:   case $::operatingsystem {\n     35:     'centos', 'redhat', 'fedora', 'scientific': {\n     36:       $apache_name = 'httpd'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-boxen-manifests-security.pp", "content": "key    => 'askForPassword',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: boxen@puppet-boxen-manifests-security.pp\n\n$screensaver_delay_sec = 5\n) {\nboxen::osx_defaults { 'require password at screensaver':\nensure => present,\ndomain => 'com.apple.screensaver',\n10:     key    => 'askForPassword',\nvalue  => $require_password,\ntype   => 'bool',\nuser   => $::boxen_user\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-boxen-manifests-security.pp\n# Target line: 10\n\n      5:   $screensaver_delay_sec = 5\n      6: ) {\n      7:   boxen::osx_defaults { 'require password at screensaver':\n      8:     ensure => present,\n      9:     domain => 'com.apple.screensaver',\n>>>  10:     key    => 'askForPassword',\n     11:     value  => $require_password,\n     12:     type   => 'bool',\n     13:     user   => $::boxen_user\n     14:   }\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp", "content": "user        => 'postgres',", "line": 191, "detection_span": [186, 196], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n\n186:\n187:   postgresql::server::pg_hba_rule { 'Allow local connections with authentication under postgres user' :\ndescription => 'Allow local connections with authentication under postgres user',\ntype        => 'local',\ndatabase    => 'all',\n191:     user        => 'postgres',\nauth_method => 'md5',\n193:   }\n194:\n195:   file { '/var/log/nailgun' :\nensure  => directory,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n# Target line: 191\n\n    186: \n    187:   postgresql::server::pg_hba_rule { 'Allow local connections with authentication under postgres user' :\n    188:     description => 'Allow local connections with authentication under postgres user',\n    189:     type        => 'local',\n    190:     database    => 'all',\n>>> 191:     user        => 'postgres',\n    192:     auth_method => 'md5',\n    193:   }\n    194: \n    195:   file { '/var/log/nailgun' :\n    196:     ensure  => directory,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-log_server_site.pp", "content": "jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n\n# usage.\n\nnode default {\nclass { '::openstackci::logserver':\ndomain                  => hiera('domain'),\n25:     jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\nara_middleware          => hiera('ara_middleware', false),\nswift_authurl           => hiera('swift_authurl', ''),\nswift_user              => hiera('swift_user', ''),\nswift_key               => hiera('swift_key', ''),\nswift_tenant_name       => hiera('swift_tenant_name', ''),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n# Target line: 25\n\n     20: # usage.\n     21: \n     22: node default {\n     23:   class { '::openstackci::logserver':\n     24:     domain                  => hiera('domain'),\n>>>  25:     jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\n     26:     ara_middleware          => hiera('ara_middleware', false),\n     27:     swift_authurl           => hiera('swift_authurl', ''),\n     28:     swift_user              => hiera('swift_user', ''),\n     29:     swift_key               => hiera('swift_key', ''),\n     30:     swift_tenant_name       => hiera('swift_tenant_name', ''),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-netapp.pp", "content": "netapp_password                      => hiera('CONFIG_MANILA_NETAPP_PASSWORD'),", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-netapp.pp\n\n{\nmanila::backend::netapp{ 'netapp':\ndriver_handles_share_servers         => hiera('CONFIG_MANILA_NETAPP_DRV_HANDLES_SHARE_SERVERS'),\nnetapp_transport_type                => hiera('CONFIG_MANILA_NETAPP_TRANSPORT_TYPE'),\nnetapp_login                         => hiera('CONFIG_MANILA_NETAPP_LOGIN'),\n7:       netapp_password                      => hiera('CONFIG_MANILA_NETAPP_PASSWORD'),\nnetapp_server_hostname               => hiera('CONFIG_MANILA_NETAPP_SERVER_HOSTNAME'),\nnetapp_storage_family                => hiera('CONFIG_MANILA_NETAPP_STORAGE_FAMILY'),\nnetapp_server_port                   => hiera('CONFIG_MANILA_NETAPP_SERVER_PORT'),\nnetapp_vserver                       => hiera('CONFIG_MANILA_NETAPP_VSERVER', undef),\nnetapp_aggregate_name_search_pattern => hiera('CONFIG_MANILA_NETAPP_AGGREGATE_NAME_SEARCH_PATTERN'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-netapp.pp\n# Target line: 7\n\n      2: {\n      3:     manila::backend::netapp{ 'netapp':\n      4:       driver_handles_share_servers         => hiera('CONFIG_MANILA_NETAPP_DRV_HANDLES_SHARE_SERVERS'),\n      5:       netapp_transport_type                => hiera('CONFIG_MANILA_NETAPP_TRANSPORT_TYPE'),\n      6:       netapp_login                         => hiera('CONFIG_MANILA_NETAPP_LOGIN'),\n>>>   7:       netapp_password                      => hiera('CONFIG_MANILA_NETAPP_PASSWORD'),\n      8:       netapp_server_hostname               => hiera('CONFIG_MANILA_NETAPP_SERVER_HOSTNAME'),\n      9:       netapp_storage_family                => hiera('CONFIG_MANILA_NETAPP_STORAGE_FAMILY'),\n     10:       netapp_server_port                   => hiera('CONFIG_MANILA_NETAPP_SERVER_PORT'),\n     11:       netapp_vserver                       => hiera('CONFIG_MANILA_NETAPP_VSERVER', undef),\n     12:       netapp_aggregate_name_search_pattern => hiera('CONFIG_MANILA_NETAPP_AGGREGATE_NAME_SEARCH_PATTERN'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp", "content": "$ssl_cert              = '/etc/mysql/server-cert.pem'", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n\n$ruby_package_name     = 'ruby-mysql'\n$ruby_package_provider = 'gem'\n$service_name          = 'mysqld'\n$socket                = '/var/lib/mysql/mysql.sock'\n$ssl_ca                = '/etc/mysql/cacert.pem'\n72:       $ssl_cert              = '/etc/mysql/server-cert.pem'\n$ssl_key               = '/etc/mysql/server-key.pem'\n}\n\n'Suse': {\n$basedir               = '/usr'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n# Target line: 72\n\n     67:       $ruby_package_name     = 'ruby-mysql'\n     68:       $ruby_package_provider = 'gem'\n     69:       $service_name          = 'mysqld'\n     70:       $socket                = '/var/lib/mysql/mysql.sock'\n     71:       $ssl_ca                = '/etc/mysql/cacert.pem'\n>>>  72:       $ssl_cert              = '/etc/mysql/server-cert.pem'\n     73:       $ssl_key               = '/etc/mysql/server-key.pem'\n     74:     }\n     75: \n     76:     'Suse': {\n     77:       $basedir               = '/usr'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fraenki@puppet-galera-examples-centos7.pp", "content": "root_password   => 'pa$$w0rd',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: fraenki@puppet-galera-examples-centos7.pp\n\nnode default {\nclass { 'galera':\ngalera_servers  => ['10.0.99.101', '10.0.99.102'],\ngalera_master   => 'node1.example.com',\nvendor_type     => 'mariadb',\n6:     root_password   => 'pa$$w0rd',\nstatus_password => 'pa$$w0rd',\nbind_address    => $::ipaddress_enp0s8,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-examples-centos7.pp\n# Target line: 6\n\n      1: node default {\n      2:   class { 'galera':\n      3:     galera_servers  => ['10.0.99.101', '10.0.99.102'],\n      4:     galera_master   => 'node1.example.com',\n      5:     vendor_type     => 'mariadb',\n>>>   6:     root_password   => 'pa$$w0rd',\n      7:     status_password => 'pa$$w0rd',\n      8:     bind_address    => $::ipaddress_enp0s8,\n      9:   }\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-web_training-dvwa-manifests-config.pp", "content": "$docroot = '/var/www/dvwa'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-web_training-dvwa-manifests-config.pp\n\nclass dvwa::config {\n$secgen_parameters = secgen_functions::get_parameters($::base64_inputs_file)\n$port = $secgen_parameters['port'][0]\n$db_password = $secgen_parameters['db_password'][0]\n\n6:   $docroot = '/var/www/dvwa'\n\nfile { \"$docroot/config/config.inc.php\":\nensure  => present,\nmode   => '0600',\nowner => 'www-data',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-web_training-dvwa-manifests-config.pp\n# Target line: 6\n\n      1: class dvwa::config {\n      2:   $secgen_parameters = secgen_functions::get_parameters($::base64_inputs_file)\n      3:   $port = $secgen_parameters['port'][0]\n      4:   $db_password = $secgen_parameters['db_password'][0]\n      5:   \n>>>   6:   $docroot = '/var/www/dvwa'\n      7: \n      8:   file { \"$docroot/config/config.inc.php\":\n      9:     ensure  => present,\n     10:     mode   => '0600',\n     11:     owner => 'www-data',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@puppet-foreman-manifests-config.pp", "content": "ssl_content => template('foreman/lookup_identity.conf.erb'),", "line": 132, "detection_span": [127, 137], "with_context": "# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n\nforeman::config::apache::fragment { 'intercept_form_submit':\nssl_content => template('foreman/intercept_form_submit.conf.erb'),\n}\n130:\nforeman::config::apache::fragment { 'lookup_identity':\n132:         ssl_content => template('foreman/lookup_identity.conf.erb'),\n}\n134:\nforeman::config::apache::fragment { 'auth_kerb':\nssl_content => template('foreman/auth_kerb.conf.erb'),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@puppet-foreman-manifests-config.pp\n# Target line: 132\n\n    127:       foreman::config::apache::fragment { 'intercept_form_submit':\n    128:         ssl_content => template('foreman/intercept_form_submit.conf.erb'),\n    129:       }\n    130: \n    131:       foreman::config::apache::fragment { 'lookup_identity':\n>>> 132:         ssl_content => template('foreman/lookup_identity.conf.erb'),\n    133:       }\n    134: \n    135:       foreman::config::apache::fragment { 'auth_kerb':\n    136:         ssl_content => template('foreman/auth_kerb.conf.erb'),\n    137:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-osx_config-manifests-trackpad-doubleclick_speed.pp", "content": "key    => 'com.apple.mouse.doubleClickThreshold',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-doubleclick_speed.pp\n\nclass osx_config::trackpad::doubleclick_speed($speed = 1.1) {\nboxen::osx_defaults { 'Set the double-click speed of trackpad':\nuser   => $::luser,\ndomain => 'NSGlobalDomain',\n5:     key    => 'com.apple.mouse.doubleClickThreshold',\ntype   => 'float',\nvalue  => $speed,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-doubleclick_speed.pp\n# Target line: 5\n\n      1: class osx_config::trackpad::doubleclick_speed($speed = 1.1) {\n      2:   boxen::osx_defaults { 'Set the double-click speed of trackpad':\n      3:     user   => $::luser,\n      4:     domain => 'NSGlobalDomain',\n>>>   5:     key    => 'com.apple.mouse.doubleClickThreshold',\n      6:     type   => 'float',\n      7:     value  => $speed,\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "user     => 'contacts',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\nuser     => 'collections_pub',\npassword => 'collections_publisher',\nrequire  => Class['::mysql::server'];\n\n'contacts_test':\n24:       user     => 'contacts',\npassword => 'contacts',\nrequire  => Class['::mysql::server'];\n\n'content_planner_test':\nuser     => 'content_planner',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 24\n\n     19:       user     => 'collections_pub',\n     20:       password => 'collections_publisher',\n     21:       require  => Class['::mysql::server'];\n     22: \n     23:     'contacts_test':\n>>>  24:       user     => 'contacts',\n     25:       password => 'contacts',\n     26:       require  => Class['::mysql::server'];\n     27: \n     28:     'content_planner_test':\n     29:       user     => 'content_planner',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "zend-patterns@ZendServerPuppet-manifests-sdk-command.pp", "content": "$zssecret           = undef,", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-sdk-command.pp\n\ndefine zendserver::sdk::command (\n$target,\n$api_command        = $name,\n$zsurl              = undef,\n$zskey              = undef,\n29:   $zssecret           = undef,\n$http_timeout       = 60,\n$additional_options = '',\n$tries              = 3,\n$try_sleep          = 5,\n$cwd                = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-sdk-command.pp\n# Target line: 29\n\n     24: define zendserver::sdk::command (\n     25:   $target,\n     26:   $api_command        = $name,\n     27:   $zsurl              = undef,\n     28:   $zskey              = undef,\n>>>  29:   $zssecret           = undef,\n     30:   $http_timeout       = 60,\n     31:   $additional_options = '',\n     32:   $tries              = 3,\n     33:   $try_sleep          = 5,\n     34:   $cwd                = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-gnocchi.pp", "content": "ceph_username => 'openstack',", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n\nmetric_processing_delay => 5,\ncoordination_url        => $::openstack_integration::config::tooz_url,\n}\nif $integration_enable {\nclass { '::gnocchi::storage::ceph':\n77:       ceph_username => 'openstack',\nceph_keyring  => '/etc/ceph/ceph.client.openstack.keyring',\nmanage_cradox => ($::osfamily == 'RedHat'),\nmanage_rados  => ($::osfamily == 'Debian'),\n}\n# make sure ceph pool exists before running gnocchi (dbsync & services)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n# Target line: 77\n\n     72:     metric_processing_delay => 5,\n     73:     coordination_url        => $::openstack_integration::config::tooz_url,\n     74:   }\n     75:   if $integration_enable {\n     76:     class { '::gnocchi::storage::ceph':\n>>>  77:       ceph_username => 'openstack',\n     78:       ceph_keyring  => '/etc/ceph/ceph.client.openstack.keyring',\n     79:       manage_cradox => ($::osfamily == 'RedHat'),\n     80:       manage_rados  => ($::osfamily == 'Debian'),\n     81:     }\n     82:     # make sure ceph pool exists before running gnocchi (dbsync & services)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-ci-params.pp", "content": "$gitlabci_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n\n$gitlabci_domain_alias      = false\n$gitlabci_repodir           = $ci_home\n$gitlabci_relative_url_root = false\n$gitlabci_ssl               = false\n$gitlabci_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n32:   $gitlabci_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$gitlabci_ssl_self_signed   = false\n$gitlabci_projects          = '10'\n$gitlabci_username_change   = true\n$gitlabci_unicorn_listen    = '127.0.0.1'\n$gitlabci_unicorn_port      = '8081'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n# Target line: 32\n\n     27:   $gitlabci_domain_alias      = false\n     28:   $gitlabci_repodir           = $ci_home\n     29:   $gitlabci_relative_url_root = false\n     30:   $gitlabci_ssl               = false\n     31:   $gitlabci_ssl_cert          = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n>>>  32:   $gitlabci_ssl_key           = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     33:   $gitlabci_ssl_self_signed   = false\n     34:   $gitlabci_projects          = '10'\n     35:   $gitlabci_username_change   = true\n     36:   $gitlabci_unicorn_listen    = '127.0.0.1'\n     37:   $gitlabci_unicorn_port      = '8081'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-oauth-consumer.pp", "content": "$access_secret = undef,", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-oauth-consumer.pp\n\n$grants        = ['authonly'],\n$restrictions  = {'IPAddresses' => ['0.0.0.0/0','::/0']},\n$user          = 'Admin',\n$owner_only    = false,\n$access_token  = undef,\n42:     $access_secret = undef,\n$db_name       = $::mediawiki::db_name,\n) {\ninclude ::role::oauth\n\n$grants_json = ordered_json($grants)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-oauth-consumer.pp\n# Target line: 42\n\n     37:     $grants        = ['authonly'],\n     38:     $restrictions  = {'IPAddresses' => ['0.0.0.0/0','::/0']},\n     39:     $user          = 'Admin',\n     40:     $owner_only    = false,\n     41:     $access_token  = undef,\n>>>  42:     $access_secret = undef,\n     43:     $db_name       = $::mediawiki::db_name,\n     44: ) {\n     45:     include ::role::oauth\n     46: \n     47:     $grants_json = ordered_json($grants)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-params.pp", "content": "$mcollective_user = 'root'", "line": 84, "detection_span": [79, 89], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-params.pp\n\ncentos  => \"/usr/libexec/mcollective/mcollective\",\nredhat  => \"/usr/libexec/mcollective/mcollective\",\ndefault => \"/usr/libexec/mcollective/mcollective\",\n}\n\n84:   $mcollective_user = 'root'\n$mcollective_group = 'root'\n\n\n# Commands used in puppi info templates\n$info_package_query = $::operatingsystem ? {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-params.pp\n# Target line: 84\n\n     79:     centos  => \"/usr/libexec/mcollective/mcollective\",\n     80:     redhat  => \"/usr/libexec/mcollective/mcollective\",\n     81:     default => \"/usr/libexec/mcollective/mcollective\",\n     82:   }\n     83: \n>>>  84:   $mcollective_user = 'root'\n     85:   $mcollective_group = 'root'\n     86: \n     87: \n     88: # Commands used in puppi info templates\n     89:   $info_package_query = $::operatingsystem ? {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-pp_postgres-manifests-monitoring-primary.pp", "content": "login         => true,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-monitoring-primary.pp\n\nclass pp_postgres::monitoring::primary {\ninclude('pp_postgres::monitoring::base')\n\npostgresql::server::role { 'monitoring':\n5:     login         => true,\npassword_hash => postgresql_password('monitoring', 'monitoring'),\n}\npostgresql::server::database_grant { 'GRANT monitoring - CONNECT - stagecraft':\nprivilege => 'CONNECT',\ndb        => 'stagecraft',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-monitoring-primary.pp\n# Target line: 5\n\n      1: class pp_postgres::monitoring::primary {\n      2:   include('pp_postgres::monitoring::base')\n      3: \n      4:   postgresql::server::role { 'monitoring':\n>>>   5:     login         => true,\n      6:     password_hash => postgresql_password('monitoring', 'monitoring'),\n      7:   }\n      8:   postgresql::server::database_grant { 'GRANT monitoring - CONNECT - stagecraft':\n      9:     privilege => 'CONNECT',\n     10:     db        => 'stagecraft',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-deploy.pp", "content": "$vpn_pass          = undef,", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-deploy.pp\n\nclass performanceplatform::deploy (\n$vpn_url           = undef,\n$vpn_user          = undef,\n4:     $vpn_pass          = undef,\n$basic_auth        = undef,\n$jenkins_key       = undef,\n$jenkins_publickey = undef,\n) {\n#Only phone home if the vpn credentials are set", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-deploy.pp\n# Target line: 4\n\n      1: class performanceplatform::deploy (\n      2:     $vpn_url           = undef,\n      3:     $vpn_user          = undef,\n>>>   4:     $vpn_pass          = undef,\n      5:     $basic_auth        = undef,\n      6:     $jenkins_key       = undef,\n      7:     $jenkins_publickey = undef,\n      8: ) {\n      9:     #Only phone home if the vpn credentials are set\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_asset_master.pp", "content": "$cron_user = 'assets'", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_asset_master.pp\n\n} else {\ninclude assets::ssh_private_key\n\ncreate_resources('ufw::allow', $asset_slave_ip_ranges)\n\n26:     $cron_user = 'assets'\n}\n\n# daemontools provides setlock\n$cron_requires = [\nFile['/usr/local/bin/copy-attachments.sh'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_asset_master.pp\n# Target line: 26\n\n     21:   } else {\n     22:     include assets::ssh_private_key\n     23: \n     24:     create_resources('ufw::allow', $asset_slave_ip_ranges)\n     25: \n>>>  26:     $cron_user = 'assets'\n     27:   }\n     28: \n     29:   # daemontools provides setlock\n     30:   $cron_requires = [\n     31:     File['/usr/local/bin/copy-attachments.sh'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@mediawiki-vagrant-puppet-modules-npm-manifests-update.pp", "content": "user        => 'vagrant',", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-npm-manifests-update.pp\n\nrequire ::npm\n\nexec { \"${title}_npm_install\":\ncommand     => '/usr/bin/npm update --no-bin-links',\ncwd         => $directory,\n22:         user        => 'vagrant',\nenvironment => [\n\"NPM_CONFIG_CACHE=${::npm::cache_dir}\",\n'NPM_CONFIG_GLOBAL=false',\n'LINK=g++',\n'HOME=/home/vagrant',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-npm-manifests-update.pp\n# Target line: 22\n\n     17:     require ::npm\n     18: \n     19:     exec { \"${title}_npm_install\":\n     20:         command     => '/usr/bin/npm update --no-bin-links',\n     21:         cwd         => $directory,\n>>>  22:         user        => 'vagrant',\n     23:         environment => [\n     24:             \"NPM_CONFIG_CACHE=${::npm::cache_dir}\",\n     25:             'NPM_CONFIG_GLOBAL=false',\n     26:             'LINK=g++',\n     27:             'HOME=/home/vagrant',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp", "content": "$pp_data_bearer_token = undef,", "line": 98, "detection_span": [93, 103], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n\n$sentry_dsn = undef,\n$oauth_id = undef,\n$oauth_secret = undef,\n$port = '3075',\n$pp_data_url = undef,\n98:   $pp_data_bearer_token = undef,\n$redis_host = undef,\n100:   $redis_port = undef,\n101:   $secret_key_base = undef,\n102:   $zendesk_anonymous_ticket_email = undef,\n103:   $zendesk_client_password = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n# Target line: 98\n\n     93:   $sentry_dsn = undef,\n     94:   $oauth_id = undef,\n     95:   $oauth_secret = undef,\n     96:   $port = '3075',\n     97:   $pp_data_url = undef,\n>>>  98:   $pp_data_bearer_token = undef,\n     99:   $redis_host = undef,\n    100:   $redis_port = undef,\n    101:   $secret_key_base = undef,\n    102:   $zendesk_anonymous_ticket_email = undef,\n    103:   $zendesk_client_password = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-designate-central.pp", "content": "user    => 'designate',", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-designate-central.pp\n\ninclude ::designate::quota\n}\nif ($step == 5 and $sync_db) {\nexec { 'pool update':\ncommand => '/bin/designate-manage pool update',\n65:       user    => 'designate',\n}\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-designate-central.pp\n# Target line: 65\n\n     60:     include ::designate::quota\n     61:   }\n     62:   if ($step == 5 and $sync_db) {\n     63:     exec { 'pool update':\n     64:       command => '/bin/designate-manage pool update',\n>>>  65:       user    => 'designate',\n     66:     }\n     67:   }\n     68: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mozilla@socorro-infra-puppet-modules-socorro-manifests-role-common.pp", "content": "$datadog_api_key=hiera(\"${::environment}/datadog_api_key\")", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: mozilla@socorro-infra-puppet-modules-socorro-manifests-role-common.pp\n\nensure => running,\nenable => true\n}\n\n# Datadog agent install\n43:   $datadog_api_key=hiera(\"${::environment}/datadog_api_key\")\n\nfile {\n'/etc/dd-agent/datadog.conf':\nmode    => '0640',\nowner   => 'dd-agent',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: mozilla@socorro-infra-puppet-modules-socorro-manifests-role-common.pp\n# Target line: 43\n\n     38:       ensure => running,\n     39:       enable => true\n     40:   }\n     41: \n     42:   # Datadog agent install\n>>>  43:   $datadog_api_key=hiera(\"${::environment}/datadog_api_key\")\n     44: \n     45:   file {\n     46:     '/etc/dd-agent/datadog.conf':\n     47:       mode    => '0640',\n     48:       owner   => 'dd-agent',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhost_ip_based.pp", "content": "docroot  => '/var/www/first',", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhost_ip_based.pp\n\napache::listen { '81': }\n\n# IP-based vhosts\napache::vhost { 'first.example.com':\nip       => '10.0.0.10',\n18:   docroot  => '/var/www/first',\nip_based => true,\n}\napache::vhost { 'second.example.com':\nip       => '10.0.0.11',\ndocroot  => '/var/www/second',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhost_ip_based.pp\n# Target line: 18\n\n     13: apache::listen { '81': }\n     14: \n     15: # IP-based vhosts\n     16: apache::vhost { 'first.example.com':\n     17:   ip       => '10.0.0.10',\n>>>  18:   docroot  => '/var/www/first',\n     19:   ip_based => true,\n     20: }\n     21: apache::vhost { 'second.example.com':\n     22:   ip       => '10.0.0.11',\n     23:   docroot  => '/var/www/second',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-sshkeygen.pp", "content": "$username = \"root\",", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-sshkeygen.pp\n\ndefine fuel::sshkeygen (\n$length = 2048,\n$homedir = \"/root\",\n4:   $username = \"root\",\n$groupname = \"root\",\n$keytype = \"rsa\",\n){\n\nExec { path => '/usr/bin:/bin:/usr/sbin:/sbin' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-sshkeygen.pp\n# Target line: 4\n\n      1: define fuel::sshkeygen (\n      2:   $length = 2048,\n      3:   $homedir = \"/root\",\n>>>   4:   $username = \"root\",\n      5:   $groupname = \"root\",\n      6:   $keytype = \"rsa\",\n      7: ){\n      8: \n      9:   Exec { path => '/usr/bin:/bin:/usr/sbin:/sbin' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-heat.pp", "content": "domain_password   => hiera('CONFIG_HEAT_DOMAIN_PASSWORD'),", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-heat.pp\n\n}\n\nclass { '::heat::keystone::domain':\ndomain_name       => hiera('CONFIG_HEAT_DOMAIN'),\ndomain_admin      => hiera('CONFIG_HEAT_DOMAIN_ADMIN'),\n23:       domain_password   => hiera('CONFIG_HEAT_DOMAIN_PASSWORD'),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-heat.pp\n# Target line: 23\n\n     18:     }\n     19: \n     20:     class { '::heat::keystone::domain':\n     21:       domain_name       => hiera('CONFIG_HEAT_DOMAIN'),\n     22:       domain_admin      => hiera('CONFIG_HEAT_DOMAIN_ADMIN'),\n>>>  23:       domain_password   => hiera('CONFIG_HEAT_DOMAIN_PASSWORD'),\n     24:     }\n     25: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-stash-manifests-init.pp", "content": "$backupuser             = 'admin',", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: voxpupuli@puppet-stash-manifests-init.pp\n\n# Backup Settings\n$backup_ensure          = 'present',\n$backupclient_url       = 'https://maven.atlassian.com/public/com/atlassian/stash/backup/stash-backup-distribution',\n$backupclient_version   = '1.9.1',\n$backup_home            = '/opt/stash-backup',\n58:   $backupuser             = 'admin',\n$backuppass             = 'password',\n$backup_schedule_hour   = '5',\n$backup_schedule_minute = '0',\n$backup_keep_age        = '4w',\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-stash-manifests-init.pp\n# Target line: 58\n\n     53:   # Backup Settings\n     54:   $backup_ensure          = 'present',\n     55:   $backupclient_url       = 'https://maven.atlassian.com/public/com/atlassian/stash/backup/stash-backup-distribution',\n     56:   $backupclient_version   = '1.9.1',\n     57:   $backup_home            = '/opt/stash-backup',\n>>>  58:   $backupuser             = 'admin',\n     59:   $backuppass             = 'password',\n     60:   $backup_schedule_hour   = '5',\n     61:   $backup_schedule_minute = '0',\n     62:   $backup_keep_age        = '4w',\n     63: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$puppetdb_user     = '_puppetdb'", "line": 146, "detection_span": [141, 151], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n$puppetdb_user     = 'puppetdb'\n$puppetdb_group    = 'puppetdb'\n$puppetdb_initconf = '/etc/default/puppetdb'\n}\n'OpenBSD': {\n146:       $puppetdb_user     = '_puppetdb'\n$puppetdb_group    = '_puppetdb'\n$puppetdb_initconf = undef\n}\n'FreeBSD': {\n$puppetdb_user     = 'puppetdb'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 146\n\n    141:       $puppetdb_user     = 'puppetdb'\n    142:       $puppetdb_group    = 'puppetdb'\n    143:       $puppetdb_initconf = '/etc/default/puppetdb'\n    144:     }\n    145:     'OpenBSD': {\n>>> 146:       $puppetdb_user     = '_puppetdb'\n    147:       $puppetdb_group    = '_puppetdb'\n    148:       $puppetdb_initconf = undef\n    149:     }\n    150:     'FreeBSD': {\n    151:       $puppetdb_user     = 'puppetdb'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-rochtrinque.pp", "content": "ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNw0X1UURCTVJ05JzGNr182vI3pft/MDzz2KffYWurcS4rtxxQB9lm2ZyfJLC/OCIVhqsjNJbGWA66f3Hh/LO7GRkjJ1fKfWxDf4Gf307nVjhElo4ZfQHjKU1QBmS9KNavrLTv0vMXp4I9j3QxJsuuCkgt7p5nkR+2nPFywKwMqvTzkt/RhW13BgWN4/J+I65luNqkdgFupjZ+HKTswz9scnOblT2xShGpCXzBPqHuNWCcBaElWNFTY4lWRP6Qyuibku6qPW1+BI3S9iJgnGi8LiktZljxS79Lmx+Qj/CDaS3XLp+VqsAlRVBvUzjdE5hfTphIpZp04kCOs4aY8xMxzulB7a8knggxEuJ8PL8S7nKXi21KulURH9yN91hjV1dS4h9E6NRIwibSjGAiQ8leghbzWmMQX9fAczTKx33U9DHrLUSH9mh85eqlRnkkeiaI6by+8RojvM8m3Q4DPjfc4PQ6Lw9AnbTvOkxRHo5IPQGhuZ5jn11XxVEkBWcXV7cVRUq6g1Iyxz722EeWJ0VE0tkDIqCCW3urU5VOinJTehVOdT+D0tYI320Vwuxa42G5OjUfEsOb+UiQOifVgGZHlJIBRFWJNjn8jqaeo/y/C7OT2rm//Jn4jcR3jOuSmb2SUeg0icZKsLAnYyqz/zd/7+Y+E8MqH/b/HCRjDZ3wJw== rochtrinque@gds8064.local','ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNo1GmCNbA4m+myfuUGmZZWfED773dX8u7a48vimUCUa72ajaKK+kBUa29JFzCHW/GYV7lNpgbj9LitR9FA75Lk28ZhDVPeg3czn0ygb4yuN1APXS2NnCeuz6pPwvCWoSJTAHRXRZRBuM/xMYjsKz5uAL3528jnmaosmKSCks7mMXPhqZ00IFBmd974g2kGF0PGz8QHGTcDl2niyJf/EERNpzFGjf7PdVvEJFcPmnUPH1uk6RUqSqd87ZtReDJLUgVgkpYXZpZPEQTi6JNzhCNQ55fBkZrVNbdF+Wxomar9D/6Z2jFygZAFV3ZXlJl6Xd9yWrzfQtOxwOjeDPbjW920D4xDZR+whs4X2BVebzUMARQX1ZRwwbybYlGilW5iS7l+CCAUTakBwM5+3CXZ2WgZxyTLjIkNjmyFWD5CEodlO8hNqB8I59t6uI1fCpMFGxEKSL7LyVUgD2Whp0wZlDfR4c4LBq5T7j2NXVnsfWTQ1WceTVtT2ExFpPgfrnc/9OUL1fSxtyJwFIGqO7VmwKzI4+5Kj5AUHgo7wAnLr4n+wKzsYDrarLG32bXRxFMzJxhWdwkAlM+lE80f50SxYp9RgsTGa0PkbV51tEcxVYwT9us24pZgwzGulcFpQCDgqXg98Q8UcVjdmWQQZLptY23bmfHOzatoaMmr2Zh+P492Q== roch@simu' ,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-rochtrinque.pp\n\n# Creates the rochtrinque user\nclass users::rochtrinque {\ngovuk_user { 'rochtrinque':\nfullname => 'Roch Trinque',\nemail    => 'roch.trinque@digital.cabinet-office.gov.uk',\n6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNw0X1UURCTVJ05JzGNr182vI3pft/MDzz2KffYWurcS4rtxxQB9lm2ZyfJLC/OCIVhqsjNJbGWA66f3Hh/LO7GRkjJ1fKfWxDf4Gf307nVjhElo4ZfQHjKU1QBmS9KNavrLTv0vMXp4I9j3QxJsuuCkgt7p5nkR+2nPFywKwMqvTzkt/RhW13BgWN4/J+I65luNqkdgFupjZ+HKTswz9scnOblT2xShGpCXzBPqHuNWCcBaElWNFTY4lWRP6Qyuibku6qPW1+BI3S9iJgnGi8LiktZljxS79Lmx+Qj/CDaS3XLp+VqsAlRVBvUzjdE5hfTphIpZp04kCOs4aY8xMxzulB7a8knggxEuJ8PL8S7nKXi21KulURH9yN91hjV1dS4h9E6NRIwibSjGAiQ8leghbzWmMQX9fAczTKx33U9DHrLUSH9mh85eqlRnkkeiaI6by+8RojvM8m3Q4DPjfc4PQ6Lw9AnbTvOkxRHo5IPQGhuZ5jn11XxVEkBWcXV7cVRUq6g1Iyxz722EeWJ0VE0tkDIqCCW3urU5VOinJTehVOdT+D0tYI320Vwuxa42G5OjUfEsOb+UiQOifVgGZHlJIBRFWJNjn8jqaeo/y/C7OT2rm//Jn4jcR3jOuSmb2SUeg0icZKsLAnYyqz/zd/7+Y+E8MqH/b/HCRjDZ3wJw== rochtrinque@gds8064.local','ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNo1GmCNbA4m+myfuUGmZZWfED773dX8u7a48vimUCUa72ajaKK+kBUa29JFzCHW/GYV7lNpgbj9LitR9FA75Lk28ZhDVPeg3czn0ygb4yuN1APXS2NnCeuz6pPwvCWoSJTAHRXRZRBuM/xMYjsKz5uAL3528jnmaosmKSCks7mMXPhqZ00IFBmd974g2kGF0PGz8QHGTcDl2niyJf/EERNpzFGjf7PdVvEJFcPmnUPH1uk6RUqSqd87ZtReDJLUgVgkpYXZpZPEQTi6JNzhCNQ55fBkZrVNbdF+Wxomar9D/6Z2jFygZAFV3ZXlJl6Xd9yWrzfQtOxwOjeDPbjW920D4xDZR+whs4X2BVebzUMARQX1ZRwwbybYlGilW5iS7l+CCAUTakBwM5+3CXZ2WgZxyTLjIkNjmyFWD5CEodlO8hNqB8I59t6uI1fCpMFGxEKSL7LyVUgD2Whp0wZlDfR4c4LBq5T7j2NXVnsfWTQ1WceTVtT2ExFpPgfrnc/9OUL1fSxtyJwFIGqO7VmwKzI4+5Kj5AUHgo7wAnLr4n+wKzsYDrarLG32bXRxFMzJxhWdwkAlM+lE80f50SxYp9RgsTGa0PkbV51tEcxVYwT9us24pZgwzGulcFpQCDgqXg98Q8UcVjdmWQQZLptY23bmfHOzatoaMmr2Zh+P492Q== roch@simu' ,\n],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-rochtrinque.pp\n# Target line: 6\n\n      1: # Creates the rochtrinque user\n      2: class users::rochtrinque {\n      3:   govuk_user { 'rochtrinque':\n      4:     fullname => 'Roch Trinque',\n      5:     email    => 'roch.trinque@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => [ 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNw0X1UURCTVJ05JzGNr182vI3pft/MDzz2KffYWurcS4rtxxQB9lm2ZyfJLC/OCIVhqsjNJbGWA66f3Hh/LO7GRkjJ1fKfWxDf4Gf307nVjhElo4ZfQHjKU1QBmS9KNavrLTv0vMXp4I9j3QxJsuuCkgt7p5nkR+2nPFywKwMqvTzkt/RhW13BgWN4/J+I65luNqkdgFupjZ+HKTswz9scnOblT2xShGpCXzBPqHuNWCcBaElWNFTY4lWRP6Qyuibku6qPW1+BI3S9iJgnGi8LiktZljxS79Lmx+Qj/CDaS3XLp+VqsAlRVBvUzjdE5hfTphIpZp04kCOs4aY8xMxzulB7a8knggxEuJ8PL8S7nKXi21KulURH9yN91hjV1dS4h9E6NRIwibSjGAiQ8leghbzWmMQX9fAczTKx33U9DHrLUSH9mh85eqlRnkkeiaI6by+8RojvM8m3Q4DPjfc4PQ6Lw9AnbTvOkxRHo5IPQGhuZ5jn11XxVEkBWcXV7cVRUq6g1Iyxz722EeWJ0VE0tkDIqCCW3urU5VOinJTehVOdT+D0tYI320Vwuxa42G5OjUfEsOb+UiQOifVgGZHlJIBRFWJNjn8jqaeo/y/C7OT2rm//Jn4jcR3jOuSmb2SUeg0icZKsLAnYyqz/zd/7+Y+E8MqH/b/HCRjDZ3wJw== rochtrinque@gds8064.local','ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDNo1GmCNbA4m+myfuUGmZZWfED773dX8u7a48vimUCUa72ajaKK+kBUa29JFzCHW/GYV7lNpgbj9LitR9FA75Lk28ZhDVPeg3czn0ygb4yuN1APXS2NnCeuz6pPwvCWoSJTAHRXRZRBuM/xMYjsKz5uAL3528jnmaosmKSCks7mMXPhqZ00IFBmd974g2kGF0PGz8QHGTcDl2niyJf/EERNpzFGjf7PdVvEJFcPmnUPH1uk6RUqSqd87ZtReDJLUgVgkpYXZpZPEQTi6JNzhCNQ55fBkZrVNbdF+Wxomar9D/6Z2jFygZAFV3ZXlJl6Xd9yWrzfQtOxwOjeDPbjW920D4xDZR+whs4X2BVebzUMARQX1ZRwwbybYlGilW5iS7l+CCAUTakBwM5+3CXZ2WgZxyTLjIkNjmyFWD5CEodlO8hNqB8I59t6uI1fCpMFGxEKSL7LyVUgD2Whp0wZlDfR4c4LBq5T7j2NXVnsfWTQ1WceTVtT2ExFpPgfrnc/9OUL1fSxtyJwFIGqO7VmwKzI4+5Kj5AUHgo7wAnLr4n+wKzsYDrarLG32bXRxFMzJxhWdwkAlM+lE80f50SxYp9RgsTGa0PkbV51tEcxVYwT9us24pZgwzGulcFpQCDgqXg98Q8UcVjdmWQQZLptY23bmfHOzatoaMmr2Zh+P492Q== roch@simu' ,\n      7:     ],\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-nodepool_builder.pp", "content": "$mysql_root_password = '',", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool_builder.pp\n\n\n# == Class: openstackci::nodepool_builder\n#\nclass openstackci::nodepool_builder (\n$oscc_file_contents = undef,\n20:   $mysql_root_password = '',\n$mysql_password = '',\n$nodepool_ssh_public_key = undef,\n$git_source_repo = 'https://git.openstack.org/openstack-infra/nodepool',\n$revision = 'master',\n$environment = {},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool_builder.pp\n# Target line: 20\n\n     15: \n     16: # == Class: openstackci::nodepool_builder\n     17: #\n     18: class openstackci::nodepool_builder (\n     19:   $oscc_file_contents = undef,\n>>>  20:   $mysql_root_password = '',\n     21:   $mysql_password = '',\n     22:   $nodepool_ssh_public_key = undef,\n     23:   $git_source_repo = 'https://git.openstack.org/openstack-infra/nodepool',\n     24:   $revision = 'master',\n     25:   $environment = {},\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$ks_encrypted_root_password    = '\\$6\\$tCD3X7ji\\$1urw6qEMDkVxOkD33b4TpQAjRiCeDZx0jmgMhDYhfB9KuGfqO9OcMaKyUxnGGWslEDQ4HxTw7vcAMP85NxQe61'", "line": 91, "detection_span": [86, 96], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$admin_network                 = '10.20.0.*'\n$extra_networks                = undef\n\n$nailgun_api_url               = \"http://${::ipaddress}:8000/api\"\n# default password is 'r00tme'\n91:   $ks_encrypted_root_password    = '\\$6\\$tCD3X7ji\\$1urw6qEMDkVxOkD33b4TpQAjRiCeDZx0jmgMhDYhfB9KuGfqO9OcMaKyUxnGGWslEDQ4HxTw7vcAMP85NxQe61'\n\n$ntp_upstream                  = ''\n\n$mco_host                      = $::ipaddress\n$mco_port                      = '61613'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 91\n\n     86:   $admin_network                 = '10.20.0.*'\n     87:   $extra_networks                = undef\n     88: \n     89:   $nailgun_api_url               = \"http://${::ipaddress}:8000/api\"\n     90:   # default password is 'r00tme'\n>>>  91:   $ks_encrypted_root_password    = '\\$6\\$tCD3X7ji\\$1urw6qEMDkVxOkD33b4TpQAjRiCeDZx0jmgMhDYhfB9KuGfqO9OcMaKyUxnGGWslEDQ4HxTw7vcAMP85NxQe61'\n     92: \n     93:   $ntp_upstream                  = ''\n     94: \n     95:   $mco_host                      = $::ipaddress\n     96:   $mco_port                      = '61613'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan-db.pp", "content": "user                    => 'ckan',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan-db.pp\n\nif !$rds {\nclass { 'postgresql::server::postgis': }\n}\n\ngovuk_postgresql::db { 'ckan_production':\n31:     user                    => 'ckan',\npassword                => $password,\nallow_auth_from_backend => true,\nbackend_ip_range        => $backend_ip_range,\nallow_auth_from_lb      => $allow_auth_from_lb,\nlb_ip_range             => $lb_ip_range,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan-db.pp\n# Target line: 31\n\n     26:   if !$rds {\n     27:     class { 'postgresql::server::postgis': }\n     28:   }\n     29: \n     30:   govuk_postgresql::db { 'ckan_production':\n>>>  31:     user                    => 'ckan',\n     32:     password                => $password,\n     33:     allow_auth_from_backend => true,\n     34:     backend_ip_range        => $backend_ip_range,\n     35:     allow_auth_from_lb      => $allow_auth_from_lb,\n     36:     lb_ip_range             => $lb_ip_range,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp", "content": "$cobbler_password    = 'cobbler'", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n\n$dhcp_start_address  = '10.0.0.201'\n$dhcp_end_address    = '10.0.0.254'\n$dhcp_netmask        = '255.255.255.0'\n$dhcp_gateway        = '10.0.0.100'\n$cobbler_user        = 'cobbler'\n10: $cobbler_password    = 'cobbler'\n$pxetimeout          = '0'\n$dhcp_interface      = 'eth0'\n\nstage {'openstack-custom-repo': before => Stage['main']}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n# Target line: 10\n\n      5: $dhcp_start_address  = '10.0.0.201'\n      6: $dhcp_end_address    = '10.0.0.254'\n      7: $dhcp_netmask        = '255.255.255.0'\n      8: $dhcp_gateway        = '10.0.0.100'\n      9: $cobbler_user        = 'cobbler'\n>>>  10: $cobbler_password    = 'cobbler'\n     11: $pxetimeout          = '0'\n     12: $dhcp_interface      = 'eth0'\n     13: \n     14: stage {'openstack-custom-repo': before => Stage['main']}\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$rabbitmq_astute_user          = 'naily'", "line": 60, "detection_span": [55, 65], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n# network interface configuration timeout (in seconds)\n$bootstrap_ethdevice_timeout   = '120'\n$bootstrap_profile             = 'ubuntu_bootstrap'\n\n$rabbitmq_host                 = '127.0.0.1'\n60:   $rabbitmq_astute_user          = 'naily'\n$rabbitmq_astute_password      = 'naily'\n\n$rabbitmq_gid                  = 495\n$rabbitmq_uid                  = 495\n$rabbitmq_management_port      = 15672", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 60\n\n     55:   # network interface configuration timeout (in seconds)\n     56:   $bootstrap_ethdevice_timeout   = '120'\n     57:   $bootstrap_profile             = 'ubuntu_bootstrap'\n     58: \n     59:   $rabbitmq_host                 = '127.0.0.1'\n>>>  60:   $rabbitmq_astute_user          = 'naily'\n     61:   $rabbitmq_astute_password      = 'naily'\n     62: \n     63:   $rabbitmq_gid                  = 495\n     64:   $rabbitmq_uid                  = 495\n     65:   $rabbitmq_management_port      = 15672\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-config.pp", "content": "$rabbitmq_user = undef,", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n\n$mysql_user_neutron = undef,\n$mysql_pass_neutron = undef,\n$mysql_user_heat = undef,\n$mysql_pass_heat = undef,\n$rabbitmq_hosts = undef,\n38:   $rabbitmq_user = undef,\n$rabbitmq_password = undef,\n$keystone_admin_token = undef,\n$keystone_admin_email = undef,\n$keystone_admin_password = undef,\n$keystone_tenants = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n# Target line: 38\n\n     33:   $mysql_user_neutron = undef,\n     34:   $mysql_pass_neutron = undef,\n     35:   $mysql_user_heat = undef,\n     36:   $mysql_pass_heat = undef,\n     37:   $rabbitmq_hosts = undef,\n>>>  38:   $rabbitmq_user = undef,\n     39:   $rabbitmq_password = undef,\n     40:   $keystone_admin_token = undef,\n     41:   $keystone_admin_email = undef,\n     42:   $keystone_admin_password = undef,\n     43:   $keystone_tenants = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$keystone_ostf_password        = 'ostf'", "line": 110, "detection_span": [105, 115], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n'ironic-fa-bootstrap-configs',\n'fuel-bootstrap-cli',\n107:   ]\n108:\n$keystone_ostf_user            = 'ostf'\n110:   $keystone_ostf_password        = 'ostf'\n111:\n$puppet_master_hostname        = \"${::hostname}.${::domain}\"\n113:\n$repo_root                     = '/var/www/nailgun'\n$repo_port                     = '8080'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 110\n\n    105:     'ironic-fa-bootstrap-configs',\n    106:     'fuel-bootstrap-cli',\n    107:   ]\n    108: \n    109:   $keystone_ostf_user            = 'ostf'\n>>> 110:   $keystone_ostf_password        = 'ostf'\n    111: \n    112:   $puppet_master_hostname        = \"${::hostname}.${::domain}\"\n    113: \n    114:   $repo_root                     = '/var/www/nailgun'\n    115:   $repo_port                     = '8080'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp", "content": "$admin_password        = hiera('admin_password', ''),", "line": 66, "detection_span": [61, 71], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n\n# [*zookeeper_hostnames*]\n#   (Optional) The IPs of the Zookeeper Servers\n#   Defaults to hiera('controller_node_names')\n#\nclass tripleo::profile::base::neutron::midonet (\n66:   $admin_password        = hiera('admin_password', ''),\n$bind_address          = hiera('neutron::bind_host', ''),\n$keystone_admin_token  = hiera('keystone::admin_token', ''),\n$neutron_api_node_ips  = hiera('neutron_api_node_ips', ''),\n$neutron_auth_password = hiera('neutron::keystone::authtoken::password', ''),\n$neutron_auth_tenant   = hiera('neutron::keystone::authtoken::project_name', ''),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n# Target line: 66\n\n     61: # [*zookeeper_hostnames*]\n     62: #   (Optional) The IPs of the Zookeeper Servers\n     63: #   Defaults to hiera('controller_node_names')\n     64: #\n     65: class tripleo::profile::base::neutron::midonet (\n>>>  66:   $admin_password        = hiera('admin_password', ''),\n     67:   $bind_address          = hiera('neutron::bind_host', ''),\n     68:   $keystone_admin_token  = hiera('keystone::admin_token', ''),\n     69:   $neutron_api_node_ips  = hiera('neutron_api_node_ips', ''),\n     70:   $neutron_auth_password = hiera('neutron::keystone::authtoken::password', ''),\n     71:   $neutron_auth_tenant   = hiera('neutron::keystone::authtoken::project_name', ''),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support.pp", "content": "$oauth_secret = undef,", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support.pp\n\nclass govuk::apps::support(\n$emergency_contact_details = undef,\n$sentry_dsn = undef,\n$enable_procfile_worker = true,\n$oauth_id = undef,\n68:   $oauth_secret = undef,\n$port = '3031',\n$redis_host = undef,\n$redis_port = undef,\n$secret_key_base = undef,\n$support_api_bearer_token = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support.pp\n# Target line: 68\n\n     63: class govuk::apps::support(\n     64:   $emergency_contact_details = undef,\n     65:   $sentry_dsn = undef,\n     66:   $enable_procfile_worker = true,\n     67:   $oauth_id = undef,\n>>>  68:   $oauth_secret = undef,\n     69:   $port = '3031',\n     70:   $redis_host = undef,\n     71:   $redis_port = undef,\n     72:   $secret_key_base = undef,\n     73:   $support_api_bearer_token = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-search_admin-db.pp", "content": "user     => 'search_admin',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-search_admin-db.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::apps::search_admin::db(\n$mysql_search_admin,\n) {\nmysql::db {'search_admin_production':\n6:     user     => 'search_admin',\nhost     => '%',\npassword => $mysql_search_admin,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-search_admin-db.pp\n# Target line: 6\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::apps::search_admin::db(\n      3:   $mysql_search_admin,\n      4: ) {\n      5:   mysql::db {'search_admin_production':\n>>>   6:     user     => 'search_admin',\n      7:     host     => '%',\n      8:     password => $mysql_search_admin,\n      9:   }\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-andysellick.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCzgYIqGtST23/OgNRRLtJD7m7+Lsvos3oQxuktiRfBKZ8SblLSssbjGC1DJG24ZGT6f+BBROpz86uxEVe86K0NWU6I1UIZZoBHzidg7tyX2WFjgMUBqlgAKkEaKsm1Xp0JiJjPc1bhyf2gOYu+0dng3fiS8hS28J7y+FMx7ejKvcIcMApD/dTgKwePtQT7T1HO3bYRs2lj1dMwCsLjdUyKtysCmRirQC8wVHvUUCyH++Chov27uU5QrbfGWZOa0D+9GZf4OoViNtTD0zq4DbD1ioGHRRi+FRhnLhucwVSrdAwy8fhMO2edhwNLLRnDvOJla1AMO+QshR9kOhl4PRiMbWngxtJnfRmkSlU/5VrFornOntOIS7RNjGoqwgp4hYI3TQ4OP8hXZ+NkPpNJyf3vyfoCDFtkUCJzxvhjbZ0d9T4NTPUdoVjkvUL12riEsX2SD/z9qnEnXFtM1c1vggwUHPX1GriOg5HJ78poH+VGvlwWs2rL/SvMWnBkCnuZsYo3D7CS+k6dCv/DbuobrPvN7sivzJHW5Tcnx0V1LwaSCPDaHUxJFWYUnGBpJDS8/zOjfLa7mboYtFDKY+lpt9g1oC4NYjZzfFQiQrcX/HzUn0thJ0RahzwsOKljDjMG6jway+aEH+YcsEV8HF8C39hAhthI7z1oz7sJBgvNxA679Q== andy.sellick@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-andysellick.pp\n\n# Creates the andysellick user\nclass users::andysellick {\ngovuk_user { 'andysellick':\nfullname => 'Andy Sellick',\nemail    => 'andy.sellick@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCzgYIqGtST23/OgNRRLtJD7m7+Lsvos3oQxuktiRfBKZ8SblLSssbjGC1DJG24ZGT6f+BBROpz86uxEVe86K0NWU6I1UIZZoBHzidg7tyX2WFjgMUBqlgAKkEaKsm1Xp0JiJjPc1bhyf2gOYu+0dng3fiS8hS28J7y+FMx7ejKvcIcMApD/dTgKwePtQT7T1HO3bYRs2lj1dMwCsLjdUyKtysCmRirQC8wVHvUUCyH++Chov27uU5QrbfGWZOa0D+9GZf4OoViNtTD0zq4DbD1ioGHRRi+FRhnLhucwVSrdAwy8fhMO2edhwNLLRnDvOJla1AMO+QshR9kOhl4PRiMbWngxtJnfRmkSlU/5VrFornOntOIS7RNjGoqwgp4hYI3TQ4OP8hXZ+NkPpNJyf3vyfoCDFtkUCJzxvhjbZ0d9T4NTPUdoVjkvUL12riEsX2SD/z9qnEnXFtM1c1vggwUHPX1GriOg5HJ78poH+VGvlwWs2rL/SvMWnBkCnuZsYo3D7CS+k6dCv/DbuobrPvN7sivzJHW5Tcnx0V1LwaSCPDaHUxJFWYUnGBpJDS8/zOjfLa7mboYtFDKY+lpt9g1oC4NYjZzfFQiQrcX/HzUn0thJ0RahzwsOKljDjMG6jway+aEH+YcsEV8HF8C39hAhthI7z1oz7sJBgvNxA679Q== andy.sellick@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-andysellick.pp\n# Target line: 6\n\n      1: # Creates the andysellick user\n      2: class users::andysellick {\n      3:   govuk_user { 'andysellick':\n      4:     fullname => 'Andy Sellick',\n      5:     email    => 'andy.sellick@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCzgYIqGtST23/OgNRRLtJD7m7+Lsvos3oQxuktiRfBKZ8SblLSssbjGC1DJG24ZGT6f+BBROpz86uxEVe86K0NWU6I1UIZZoBHzidg7tyX2WFjgMUBqlgAKkEaKsm1Xp0JiJjPc1bhyf2gOYu+0dng3fiS8hS28J7y+FMx7ejKvcIcMApD/dTgKwePtQT7T1HO3bYRs2lj1dMwCsLjdUyKtysCmRirQC8wVHvUUCyH++Chov27uU5QrbfGWZOa0D+9GZf4OoViNtTD0zq4DbD1ioGHRRi+FRhnLhucwVSrdAwy8fhMO2edhwNLLRnDvOJla1AMO+QshR9kOhl4PRiMbWngxtJnfRmkSlU/5VrFornOntOIS7RNjGoqwgp4hYI3TQ4OP8hXZ+NkPpNJyf3vyfoCDFtkUCJzxvhjbZ0d9T4NTPUdoVjkvUL12riEsX2SD/z9qnEnXFtM1c1vggwUHPX1GriOg5HJ78poH+VGvlwWs2rL/SvMWnBkCnuZsYo3D7CS+k6dCv/DbuobrPvN7sivzJHW5Tcnx0V1LwaSCPDaHUxJFWYUnGBpJDS8/zOjfLa7mboYtFDKY+lpt9g1oC4NYjZzfFQiQrcX/HzUn0thJ0RahzwsOKljDjMG6jway+aEH+YcsEV8HF8C39hAhthI7z1oz7sJBgvNxA679Q== andy.sellick@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-gerrit-manifests-cron.pp", "content": "user        => 'gerrit2',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: openstack-infra@puppet-gerrit-manifests-cron.pp\n\ncron { 'gerrit_repack':\nensure => absent,\nuser   => 'gerrit2',\n}\ncron { 'optimize_git_repo':\n21:     user        => 'gerrit2',\nweekday     => '0',\nhour        => '4',\nminute      => '7',\ncommand     => \"find /home/gerrit2/review_site/git/ -type d -name \\\"*.git\\\" -print -exec git --git-dir=\\\"{}\\\" ${git_cmd} \\\\;\",\nenvironment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-gerrit-manifests-cron.pp\n# Target line: 21\n\n     16:   cron { 'gerrit_repack':\n     17:     ensure => absent,\n     18:     user   => 'gerrit2',\n     19:   }\n     20:   cron { 'optimize_git_repo':\n>>>  21:     user        => 'gerrit2',\n     22:     weekday     => '0',\n     23:     hour        => '4',\n     24:     minute      => '7',\n     25:     command     => \"find /home/gerrit2/review_site/git/ -type d -name \\\"*.git\\\" -print -exec git --git-dir=\\\"{}\\\" ${git_cmd} \\\\;\",\n     26:     environment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "password => 'content_planner',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\npassword => 'contacts',\nrequire  => Class['::mysql::server'];\n\n'content_planner_test':\nuser     => 'content_planner',\n30:       password => 'content_planner',\nrequire  => Class['::mysql::server'];\n\n[\n'efg_test',\n'efg_test1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 30\n\n     25:       password => 'contacts',\n     26:       require  => Class['::mysql::server'];\n     27: \n     28:     'content_planner_test':\n     29:       user     => 'content_planner',\n>>>  30:       password => 'content_planner',\n     31:       require  => Class['::mysql::server'];\n     32: \n     33:     [\n     34:       'efg_test',\n     35:       'efg_test1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance.pp", "content": "$_user = pick($user, $::tomcat::user)", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance.pp\n\ninclude tomcat\n$_catalina_home = pick($catalina_home, $::tomcat::catalina_home)\n$_catalina_base = pick($catalina_base, $_catalina_home) #default to home\ntag(sha1($_catalina_home))\ntag(sha1($_catalina_base))\n52:   $_user = pick($user, $::tomcat::user)\n$_group = pick($group, $::tomcat::group)\n$_manage_user = pick($manage_user, $::tomcat::manage_user)\n$_manage_group = pick($manage_group, $::tomcat::manage_group)\n$_manage_base = pick($manage_base, $::tomcat::manage_base)\n$_manage_properties = pick($manage_properties, $::tomcat::manage_properties)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-instance.pp\n# Target line: 52\n\n     47:   include tomcat\n     48:   $_catalina_home = pick($catalina_home, $::tomcat::catalina_home)\n     49:   $_catalina_base = pick($catalina_base, $_catalina_home) #default to home\n     50:   tag(sha1($_catalina_home))\n     51:   tag(sha1($_catalina_base))\n>>>  52:   $_user = pick($user, $::tomcat::user)\n     53:   $_group = pick($group, $::tomcat::group)\n     54:   $_manage_user = pick($manage_user, $::tomcat::manage_user)\n     55:   $_manage_group = pick($manage_group, $::tomcat::manage_group)\n     56:   $_manage_base = pick($manage_base, $::tomcat::manage_base)\n     57:   $_manage_properties = pick($manage_properties, $::tomcat::manage_properties)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus1000v.pp", "content": "'ml2_cisco_n1kv/password'                      : value => $n1kv_vsm_password, secret => true;", "line": 97, "detection_span": [92, 102], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus1000v.pp\n\ninclude ::neutron::plugins::ml2::cisco\n\nneutron_plugin_ml2 {\n'ml2_cisco_n1kv/n1kv_vsm_ips'                  : value => $n1kv_vsm_ip;\n'ml2_cisco_n1kv/username'                      : value => $n1kv_vsm_username;\n97:     'ml2_cisco_n1kv/password'                      : value => $n1kv_vsm_password, secret => true;\n'ml2_cisco_n1kv/default_policy_profile'        : value => $default_policy_profile;\n'ml2_cisco_n1kv/default_vlan_network_profile'  : value => $default_vlan_network_profile;\n'ml2_cisco_n1kv/default_vxlan_network_profile' : value => $default_vxlan_network_profile;\n'ml2_cisco_n1kv/poll_duration'                 : value => $poll_duration;\n'ml2_cisco_n1kv/http_pool_size'                : value => $http_pool_size;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-nexus1000v.pp\n# Target line: 97\n\n     92:   include ::neutron::plugins::ml2::cisco\n     93: \n     94:   neutron_plugin_ml2 {\n     95:     'ml2_cisco_n1kv/n1kv_vsm_ips'                  : value => $n1kv_vsm_ip;\n     96:     'ml2_cisco_n1kv/username'                      : value => $n1kv_vsm_username;\n>>>  97:     'ml2_cisco_n1kv/password'                      : value => $n1kv_vsm_password, secret => true;\n     98:     'ml2_cisco_n1kv/default_policy_profile'        : value => $default_policy_profile;\n     99:     'ml2_cisco_n1kv/default_vlan_network_profile'  : value => $default_vlan_network_profile;\n    100:     'ml2_cisco_n1kv/default_vxlan_network_profile' : value => $default_vxlan_network_profile;\n    101:     'ml2_cisco_n1kv/poll_duration'                 : value => $poll_duration;\n    102:     'ml2_cisco_n1kv/http_pool_size'                : value => $http_pool_size;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-mapit.pp", "content": "user                => 'mapit',", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-mapit.pp\n\nsentry_dsn            => $sentry_dsn,\nmonitor_unicornherder => true,\n}\n\ngovuk_postgresql::db { 'mapit':\n41:       user                => 'mapit',\npassword            => $db_password,\nextensions          => ['plpgsql', 'postgis'],\nenable_in_pgbouncer => false,\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-mapit.pp\n# Target line: 41\n\n     36:       sentry_dsn            => $sentry_dsn,\n     37:       monitor_unicornherder => true,\n     38:     }\n     39: \n     40:     govuk_postgresql::db { 'mapit':\n>>>  41:       user                => 'mapit',\n     42:       password            => $db_password,\n     43:       extensions          => ['plpgsql', 'postgis'],\n     44:       enable_in_pgbouncer => false,\n     45:     }\n     46: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-kentsang.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7b3NnBnUVDh9fDud8HtxJ8KKL+EeHKNomIrurFZ716G3j00FHX3igkFVILQKJ5B5aZAwpwHcIWDkoRd4VItUAhfWIHndLFb86A+c+YADQHqCeNIzOLUg4Qac6YTGY64iFfDSuox6UHRLK5k/JrmGAYQWsrhUivsezu3Xjab/r5dTjcLiOeSLqInrNqusvYKfU39ZS6sewpOXULEyAnb+n11QP+1EiMtRP1dpxZWxOLFjHnXKDzO0CWDm2VNquFK8C85gnFZ6bsfz7JPnpO18eh2PIZNgyo7sWjd3iArBHhZeflgmjnBJBEeeGYCE92wnuFvjdRfyhOAbMZmKSW44R7u1h5QsB3rkUp5kgha5hAfmNRO+ww25U0Fn+L1f6fHBoSlyfXy6AQuGNZw+zkIfNOLleABToH6zDWMLIJOWly85wWdpABWjQ3siekOgCyhblU1cORgGiOAPHriQz8caYGB2LkSMZ2TY2odseWDqLSe0x2XBu+XNbuJFK+hnkcoVjLcaeYDCN2T2aQnhhhbY22BTkA729LyS+V1O7vNWL8/CrBvLtGNgraz/bv+6l4x/Cuj4pqRBanMWBbfL276O3HEd4Y2psWRlTXhqBXOsfeyFavBP8KkPO5wqutg13Ncgy7Vo2bfKafou89jMYoe4gqC8ZL01I6Od9SDFbgXhMdQ== ken.tsang@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-kentsang.pp\n\n# Create the kentsang user\nclass users::kentsang {\ngovuk_user { 'kentsang':\nfullname => 'Ken Tsang',\nemail    => 'ken.tsang@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7b3NnBnUVDh9fDud8HtxJ8KKL+EeHKNomIrurFZ716G3j00FHX3igkFVILQKJ5B5aZAwpwHcIWDkoRd4VItUAhfWIHndLFb86A+c+YADQHqCeNIzOLUg4Qac6YTGY64iFfDSuox6UHRLK5k/JrmGAYQWsrhUivsezu3Xjab/r5dTjcLiOeSLqInrNqusvYKfU39ZS6sewpOXULEyAnb+n11QP+1EiMtRP1dpxZWxOLFjHnXKDzO0CWDm2VNquFK8C85gnFZ6bsfz7JPnpO18eh2PIZNgyo7sWjd3iArBHhZeflgmjnBJBEeeGYCE92wnuFvjdRfyhOAbMZmKSW44R7u1h5QsB3rkUp5kgha5hAfmNRO+ww25U0Fn+L1f6fHBoSlyfXy6AQuGNZw+zkIfNOLleABToH6zDWMLIJOWly85wWdpABWjQ3siekOgCyhblU1cORgGiOAPHriQz8caYGB2LkSMZ2TY2odseWDqLSe0x2XBu+XNbuJFK+hnkcoVjLcaeYDCN2T2aQnhhhbY22BTkA729LyS+V1O7vNWL8/CrBvLtGNgraz/bv+6l4x/Cuj4pqRBanMWBbfL276O3HEd4Y2psWRlTXhqBXOsfeyFavBP8KkPO5wqutg13Ncgy7Vo2bfKafou89jMYoe4gqC8ZL01I6Od9SDFbgXhMdQ== ken.tsang@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-kentsang.pp\n# Target line: 6\n\n      1: # Create the kentsang user\n      2: class users::kentsang {\n      3:   govuk_user { 'kentsang':\n      4:     fullname => 'Ken Tsang',\n      5:     email    => 'ken.tsang@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7b3NnBnUVDh9fDud8HtxJ8KKL+EeHKNomIrurFZ716G3j00FHX3igkFVILQKJ5B5aZAwpwHcIWDkoRd4VItUAhfWIHndLFb86A+c+YADQHqCeNIzOLUg4Qac6YTGY64iFfDSuox6UHRLK5k/JrmGAYQWsrhUivsezu3Xjab/r5dTjcLiOeSLqInrNqusvYKfU39ZS6sewpOXULEyAnb+n11QP+1EiMtRP1dpxZWxOLFjHnXKDzO0CWDm2VNquFK8C85gnFZ6bsfz7JPnpO18eh2PIZNgyo7sWjd3iArBHhZeflgmjnBJBEeeGYCE92wnuFvjdRfyhOAbMZmKSW44R7u1h5QsB3rkUp5kgha5hAfmNRO+ww25U0Fn+L1f6fHBoSlyfXy6AQuGNZw+zkIfNOLleABToH6zDWMLIJOWly85wWdpABWjQ3siekOgCyhblU1cORgGiOAPHriQz8caYGB2LkSMZ2TY2odseWDqLSe0x2XBu+XNbuJFK+hnkcoVjLcaeYDCN2T2aQnhhhbY22BTkA729LyS+V1O7vNWL8/CrBvLtGNgraz/bv+6l4x/Cuj4pqRBanMWBbfL276O3HEd4Y2psWRlTXhqBXOsfeyFavBP8KkPO5wqutg13Ncgy7Vo2bfKafou89jMYoe4gqC8ZL01I6Od9SDFbgXhMdQ== ken.tsang@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq.pp", "content": "$amqp_pass  = 'email_alert_service',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq.pp\n\n#   a warning.\n#\nclass govuk::apps::email_alert_service::rabbitmq (\n$ensure = 'present',\n$amqp_user  = 'email_alert_service',\n38:   $amqp_pass  = 'email_alert_service',\n$amqp_exchange = 'published_documents',\n$amqp_major_change_queue = 'email_alert_service',\n$amqp_unpublishing_queue = 'email_unpublishing',\n$amqp_workflow_queue = 'email_alert_service_workflow',\n$queue_size_critical_threshold,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq.pp\n# Target line: 38\n\n     33: #   a warning.\n     34: #\n     35: class govuk::apps::email_alert_service::rabbitmq (\n     36:   $ensure = 'present',\n     37:   $amqp_user  = 'email_alert_service',\n>>>  38:   $amqp_pass  = 'email_alert_service',\n     39:   $amqp_exchange = 'published_documents',\n     40:   $amqp_major_change_queue = 'email_alert_service',\n     41:   $amqp_unpublishing_queue = 'email_unpublishing',\n     42:   $amqp_workflow_queue = 'email_alert_service_workflow',\n     43:   $queue_size_critical_threshold,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-postfix-manifests-init.pp", "content": "$smarthost_user = undef,", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n\n# [*smarthost_pass*]\n#   Pass to authenticate all relayed mail with.\n#\nclass postfix (\n$smarthost = undef,\n27:   $smarthost_user = undef,\n$smarthost_pass = undef,\n$rewrite_mail_domain = 'localhost',\n$rewrite_mail_list = 'noemail'\n) {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n# Target line: 27\n\n     22: # [*smarthost_pass*]\n     23: #   Pass to authenticate all relayed mail with.\n     24: #\n     25: class postfix (\n     26:   $smarthost = undef,\n>>>  27:   $smarthost_user = undef,\n     28:   $smarthost_pass = undef,\n     29:   $rewrite_mail_domain = 'localhost',\n     30:   $rewrite_mail_list = 'noemail'\n     31: ) {\n     32: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-mouse-swipe_between_pages.pp", "content": "key    => 'AppleEnableMouseSwipeNavigateWithScrolls',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: boxen@puppet-osx-manifests-mouse-swipe_between_pages.pp\n\n# Public: Enable/disable swipe between pages for multitouch mice (default = disabled). Requires re-login.\nclass osx::mouse::swipe_between_pages($enabled = false) {\nboxen::osx_defaults { 'Enable swipe between pages for multitouch mice':\nuser   => $::boxen_user,\ndomain => 'NSGlobalDomain',\n6:     key    => 'AppleEnableMouseSwipeNavigateWithScrolls',\nvalue  => $enabled,\ntype   => 'boolean'\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-mouse-swipe_between_pages.pp\n# Target line: 6\n\n      1: # Public: Enable/disable swipe between pages for multitouch mice (default = disabled). Requires re-login.\n      2: class osx::mouse::swipe_between_pages($enabled = false) {\n      3:   boxen::osx_defaults { 'Enable swipe between pages for multitouch mice':\n      4:     user   => $::boxen_user,\n      5:     domain => 'NSGlobalDomain',\n>>>   6:     key    => 'AppleEnableMouseSwipeNavigateWithScrolls',\n      7:     value  => $enabled,\n      8:     type   => 'boolean'\n      9:   }\n     10: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'D27A72F32D867DF9300A241574490FD6EC51E8C4';", "line": 136, "detection_span": [131, 141], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrelease  => 'testing',\nkey      => '6026DFCA';\n'sysdig':\nlocation => 'http://download.draios.com/stable/deb',\nrelease  => 'stable-amd64/',\n136:       key      => 'D27A72F32D867DF9300A241574490FD6EC51E8C4';\n'yarn':\nlocation => 'https://dl.yarnpkg.com/debian/',\nrelease  => 'stable',\nrepos    => ['main'],\nkey      => '72ECF46A56B4AD39C907BBB71646B01B86E50310';", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 136\n\n    131:       release  => 'testing',\n    132:       key      => '6026DFCA';\n    133:     'sysdig':\n    134:       location => 'http://download.draios.com/stable/deb',\n    135:       release  => 'stable-amd64/',\n>>> 136:       key      => 'D27A72F32D867DF9300A241574490FD6EC51E8C4';\n    137:     'yarn':\n    138:       location => 'https://dl.yarnpkg.com/debian/',\n    139:       release  => 'stable',\n    140:       repos    => ['main'],\n    141:       key      => '72ECF46A56B4AD39C907BBB71646B01B86E50310';\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-init.pp", "content": "$mms_token       = undef,", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-init.pp\n\n$nohttpinterface = undef,\n$noscripting     = undef,\n$notablescan     = undef,\n$noprealloc      = undef,\n$nssize          = undef,\n68:   $mms_token       = undef,\n$mms_name        = undef,\n$mms_interval    = undef,\n$slave           = undef,\n$only            = undef,\n$master          = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-init.pp\n# Target line: 68\n\n     63:   $nohttpinterface = undef,\n     64:   $noscripting     = undef,\n     65:   $notablescan     = undef,\n     66:   $noprealloc      = undef,\n     67:   $nssize          = undef,\n>>>  68:   $mms_token       = undef,\n     69:   $mms_name        = undef,\n     70:   $mms_interval    = undef,\n     71:   $slave           = undef,\n     72:   $only            = undef,\n     73:   $master          = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring.pp", "content": "key     => 'crm.node.check[*]',", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring.pp\n\ncommand => '/etc/zabbix/scripts/vfs.mdadm.discovery.sh';\n'proc.vmstat':\nkey     => 'proc.vmstat[*]',\ncommand => 'grep \\'$1\\' /proc/vmstat | awk \\'{print $$2}\\'';\n'crm.node.check':\n86:         key     => 'crm.node.check[*]',\ncommand => '/etc/zabbix/scripts/crm_node_check.sh $1';\n'netns.udp.listen':\nkey     => 'netns.udp.listen[*]',\ncommand => '/usr/bin/sudo /etc/zabbix/scripts/netns.listen.sh UDP $1 $2 $3';\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring.pp\n# Target line: 86\n\n     81:         command => '/etc/zabbix/scripts/vfs.mdadm.discovery.sh';\n     82:       'proc.vmstat':\n     83:         key     => 'proc.vmstat[*]',\n     84:         command => 'grep \\'$1\\' /proc/vmstat | awk \\'{print $$2}\\'';\n     85:       'crm.node.check':\n>>>  86:         key     => 'crm.node.check[*]',\n     87:         command => '/etc/zabbix/scripts/crm_node_check.sh $1';\n     88:       'netns.udp.listen':\n     89:         key     => 'netns.udp.listen[*]',\n     90:         command => '/usr/bin/sudo /etc/zabbix/scripts/netns.listen.sh UDP $1 $2 $3';\n     91:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "epost-dev@opennebula-puppet-module-manifests-prerequisites.pp", "content": "key_source => 'http://downloads.opennebula.org/repo/Debian/repo.key',", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: epost-dev@opennebula-puppet-module-manifests-prerequisites.pp\n\ndefault: { fail(\"Unrecognized operating system ${::operatingsystem}\") }\n}\n\napt::key { 'one_repo_key':\nkey        => '85E16EBF',\n58:           key_source => 'http://downloads.opennebula.org/repo/Debian/repo.key',\n} ->\n\napt::source { 'one-official': # lint:ignore:security_apt_no_key\nlocation          => \"http://downloads.opennebula.org/repo/${apt_location}\",\nrelease           => 'stable',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: epost-dev@opennebula-puppet-module-manifests-prerequisites.pp\n# Target line: 58\n\n     53:           default: { fail(\"Unrecognized operating system ${::operatingsystem}\") }\n     54:         }\n     55: \n     56:         apt::key { 'one_repo_key':\n     57:           key        => '85E16EBF',\n>>>  58:           key_source => 'http://downloads.opennebula.org/repo/Debian/repo.key',\n     59:         } ->\n     60: \n     61:         apt::source { 'one-official': # lint:ignore:security_apt_no_key\n     62:           location          => \"http://downloads.opennebula.org/repo/${apt_location}\",\n     63:           release           => 'stable',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@foreman-installer-staypuft-modules-foreman-manifests-plugin-staypuft_client.pp", "content": "$puppetssh_user = 'root',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: theforeman@foreman-installer-staypuft-modules-foreman-manifests-plugin-staypuft_client.pp\n\n# $puppetssh_user::             A user to use when connecting using SSH\n#\n# $staypuft_ssh_public_key::    This key will be added to SSH authorized keys\n#\nclass foreman::plugin::staypuft_client(\n12:   $puppetssh_user = 'root',\n$staypuft_ssh_public_key,\n) {\nssh_authorized_key { 'staypuft public key':\nkey  => $staypuft_ssh_public_key,\nuser => $puppetssh_user,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@foreman-installer-staypuft-modules-foreman-manifests-plugin-staypuft_client.pp\n# Target line: 12\n\n      7: # $puppetssh_user::             A user to use when connecting using SSH\n      8: #\n      9: # $staypuft_ssh_public_key::    This key will be added to SSH authorized keys\n     10: #\n     11: class foreman::plugin::staypuft_client(\n>>>  12:   $puppetssh_user = 'root',\n     13:   $staypuft_ssh_public_key,\n     14: ) {\n     15:   ssh_authorized_key { 'staypuft public key':\n     16:     key  => $staypuft_ssh_public_key,\n     17:     user => $puppetssh_user,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-manifests-server-monitor.pp", "content": "$mysql_monitor_username = '',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-manifests-server-monitor.pp\n\n#This is a helper class to add a monitoring user to the database\nclass mysql::server::monitor (\n3:   $mysql_monitor_username = '',\n$mysql_monitor_password = '',\n$mysql_monitor_hostname = ''\n) {\n\nAnchor['mysql::server::end'] -> Class['mysql::server::monitor']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-manifests-server-monitor.pp\n# Target line: 3\n\n      1: #This is a helper class to add a monitoring user to the database\n      2: class mysql::server::monitor (\n>>>   3:   $mysql_monitor_username = '',\n      4:   $mysql_monitor_password = '',\n      5:   $mysql_monitor_hostname = ''\n      6: ) {\n      7: \n      8:   Anchor['mysql::server::end'] -> Class['mysql::server::monitor']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$ostf_db_user                  = 'ostf'", "line": 128, "detection_span": [123, 133], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n123:   $nailgun_serialization_port    = '8002'\n$nailgun_ssl_port              = '8443'\n125:\n$ostf_host                     = '127.0.0.1'\n$ostf_port                     = '8777'\n128:   $ostf_db_user                  = 'ostf'\n$ostf_db_password              = 'ostf'\n$ostf_db_name                  = 'ostf'\n131: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 128\n\n    123:   $nailgun_serialization_port    = '8002'\n    124:   $nailgun_ssl_port              = '8443'\n    125: \n    126:   $ostf_host                     = '127.0.0.1'\n    127:   $ostf_port                     = '8777'\n>>> 128:   $ostf_db_user                  = 'ostf'\n    129:   $ostf_db_password              = 'ostf'\n    130:   $ostf_db_name                  = 'ostf'\n    131: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-master.pp", "content": "www_root => '/usr/share/error_pages',", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-master.pp\n\nensure   => 'present',\nvhost    => 'jenkins',\nlocation => '~ ^\\/(mirantis|fuel-infra)\\/(403|404|5xx)\\.html$',\nssl      => true,\nssl_only => true,\n64:     www_root => '/usr/share/error_pages',\nrequire  => Package['error-pages'],\n}\n\n$jenkins_additional_ssh_keys = hiera_hash('fuel_project::jenkins::master::jenkins_additional_ssh_keys', {})\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-master.pp\n# Target line: 64\n\n     59:     ensure   => 'present',\n     60:     vhost    => 'jenkins',\n     61:     location => '~ ^\\/(mirantis|fuel-infra)\\/(403|404|5xx)\\.html$',\n     62:     ssl      => true,\n     63:     ssl_only => true,\n>>>  64:     www_root => '/usr/share/error_pages',\n     65:     require  => Package['error-pages'],\n     66:   }\n     67: \n     68:   $jenkins_additional_ssh_keys = hiera_hash('fuel_project::jenkins::master::jenkins_additional_ssh_keys', {})\n     69: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder.pp", "content": "$jenkins_api_token = '',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder.pp\n\n#\nclass govuk_jenkins::job_builder (\n$app_domain = hiera('app_domain'),\n$environment = 'development',\n$jenkins_api_user = 'jenkins_api_user',\n38:   $jenkins_api_token = '',\n$jenkins_url = 'http://localhost:8080/',\n$jobs = [],\n) {\n\nvalidate_array($jobs)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder.pp\n# Target line: 38\n\n     33: #\n     34: class govuk_jenkins::job_builder (\n     35:   $app_domain = hiera('app_domain'),\n     36:   $environment = 'development',\n     37:   $jenkins_api_user = 'jenkins_api_user',\n>>>  38:   $jenkins_api_token = '',\n     39:   $jenkins_url = 'http://localhost:8080/',\n     40:   $jobs = [],\n     41: ) {\n     42: \n     43:   validate_array($jobs)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-zuul-manifests-merger.pp", "content": "user        => 'zuul',", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: openstack-infra@puppet-zuul-manifests-merger.pp\n\nrequire    => [File['/etc/init.d/zuul-merger'],\nClass['zuul::systemd_reload']]\n}\n\ncron { 'zuul_repack':\n32:     user        => 'zuul',\nhour        => '4',\nminute      => '7',\ncommand     => 'find /var/lib/zuul/git/ -maxdepth 3 -type d -name \".git\" -exec git --git-dir=\"{}\" pack-refs --all \\;',\nenvironment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',\nrequire     => [User['zuul'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-zuul-manifests-merger.pp\n# Target line: 32\n\n     27:     require    => [File['/etc/init.d/zuul-merger'],\n     28:                   Class['zuul::systemd_reload']]\n     29:   }\n     30: \n     31:   cron { 'zuul_repack':\n>>>  32:     user        => 'zuul',\n     33:     hour        => '4',\n     34:     minute      => '7',\n     35:     command     => 'find /var/lib/zuul/git/ -maxdepth 3 -type d -name \".git\" -exec git --git-dir=\"{}\" pack-refs --all \\;',\n     36:     environment => 'PATH=/usr/bin:/bin:/usr/sbin:/sbin',\n     37:     require     => [User['zuul'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-nginx.pp", "content": "ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-nginx.pp\n\nlisten_port            => 4637,\ngzip_types             => 'application/octet-stream',\nssl_port               => 4637,\nssl                    => true,\nssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\n27:       ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\nssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\nssl_crl                => '/var/lib/puppet/ssl/crl.pem',\nssl_verify_client      => 'on',\nwww_root               => '/var/log',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-nginx.pp\n# Target line: 27\n\n     22:       listen_port            => 4637,\n     23:       gzip_types             => 'application/octet-stream',\n     24:       ssl_port               => 4637,\n     25:       ssl                    => true,\n     26:       ssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\n>>>  27:       ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\n     28:       ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\n     29:       ssl_crl                => '/var/lib/puppet/ssl/crl.pem',\n     30:       ssl_verify_client      => 'on',\n     31:       www_root               => '/var/log',\n     32:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-custom_scripts.pp", "content": "$docker_user   = 'jenkins',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-custom_scripts.pp\n\n#\n\nclass fuel_project::jenkins::slave::custom_scripts (\n$configs_dir   = '/etc/custom_scripts/',\n$configs_paths = {},\n13:   $docker_user   = 'jenkins',\n$known_hosts   = undef,\n) {\n$configs = hiera_hash('fuel_project::jenkins::slave::custom_scripts::configs', {})\n$packages = [\n'git',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-custom_scripts.pp\n# Target line: 13\n\n      8: #\n      9: \n     10: class fuel_project::jenkins::slave::custom_scripts (\n     11:   $configs_dir   = '/etc/custom_scripts/',\n     12:   $configs_paths = {},\n>>>  13:   $docker_user   = 'jenkins',\n     14:   $known_hosts   = undef,\n     15: ) {\n     16:   $configs = hiera_hash('fuel_project::jenkins::slave::custom_scripts::configs', {})\n     17:   $packages = [\n     18:     'git',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-cisco-vts.pp", "content": "'ml2_cc/password':     value => $vts_password, secret => true;", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-vts.pp\n\n}\n)\n\nneutron_plugin_ml2 {\n'ml2_cc/username':     value => $vts_username;\n68:     'ml2_cc/password':     value => $vts_password, secret => true;\n'ml2_cc/url':          value => $vts_url;\n'ml2_cc/timeout':      value => $vts_timeout;\n'ml2_cc/sync_timeout': value => $vts_sync_timeout;\n'ml2_cc/retry_count':  value => $vts_retry_count;\n'ml2_cc/vmm_id':       value => $vts_vmmid;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-cisco-vts.pp\n# Target line: 68\n\n     63:     }\n     64:   )\n     65: \n     66:   neutron_plugin_ml2 {\n     67:     'ml2_cc/username':     value => $vts_username;\n>>>  68:     'ml2_cc/password':     value => $vts_password, secret => true;\n     69:     'ml2_cc/url':          value => $vts_url;\n     70:     'ml2_cc/timeout':      value => $vts_timeout;\n     71:     'ml2_cc/sync_timeout': value => $vts_sync_timeout;\n     72:     'ml2_cc/retry_count':  value => $vts_retry_count;\n     73:     'ml2_cc/vmm_id':       value => $vts_vmmid;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "echoes-tech@puppet-monit-manifests-params.pp", "content": "$httpd_password            = 'monit'", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: echoes-tech@puppet-monit-manifests-params.pp\n\n$config_dir_purge          = false\n$httpd                     = false\n$httpd_port                = 2812\n$httpd_address             = 'localhost'\n$httpd_user                = 'admin'\n11:   $httpd_password            = 'monit'\n$manage_firewall           = false\n$package_ensure            = 'present'\n$package_name              = 'monit'\n$service_enable            = true\n$service_ensure            = 'running'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: echoes-tech@puppet-monit-manifests-params.pp\n# Target line: 11\n\n      6:   $config_dir_purge          = false\n      7:   $httpd                     = false\n      8:   $httpd_port                = 2812\n      9:   $httpd_address             = 'localhost'\n     10:   $httpd_user                = 'admin'\n>>>  11:   $httpd_password            = 'monit'\n     12:   $manage_firewall           = false\n     13:   $package_ensure            = 'present'\n     14:   $package_name              = 'monit'\n     15:   $service_enable            = true\n     16:   $service_ensure            = 'running'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-userprefs-manifests-editors_registry.pp", "content": "key    => 'HKLM\\Software\\Classes\\sourcecode',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n\nclass userprefs::editors_registry {\nregistry::value { 'Filetype description':\n3:     key    => 'HKLM\\Software\\Classes\\sourcecode',\nvalue  => '(Default)',\ndata   => 'Source Code',\n}\n\nregistry::value { 'Puppet Manifests':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n# Target line: 3\n\n      1: class userprefs::editors_registry {\n      2:   registry::value { 'Filetype description':\n>>>   3:     key    => 'HKLM\\Software\\Classes\\sourcecode',\n      4:     value  => '(Default)',\n      5:     data   => 'Source Code',\n      6:   }\n      7: \n      8:   registry::value { 'Puppet Manifests':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "garethr@garethr-docker-manifests-registry.pp", "content": "$password    = undef,", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: garethr@garethr-docker-manifests-registry.pp\n\n#\ndefine docker::registry(\n$server      = $title,\n$ensure      = 'present',\n$username    = undef,\n34:   $password    = undef,\n$email       = undef,\n$local_user  = 'root',\n) {\ninclude docker::params\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: garethr@garethr-docker-manifests-registry.pp\n# Target line: 34\n\n     29: #\n     30: define docker::registry(\n     31:   $server      = $title,\n     32:   $ensure      = 'present',\n     33:   $username    = undef,\n>>>  34:   $password    = undef,\n     35:   $email       = undef,\n     36:   $local_user  = 'root',\n     37: ) {\n     38:   include docker::params\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp", "content": "netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n\nensure_packages(['iscsi-initiator-utils'], {'ensure' => 'present'})\n}\n\nelsif $netapp_storage_protocol == 'fc' {\ncinder::backend::netapp { $netapp_backend_name:\n95:           netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\nnetapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\nnetapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\nnetapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\nnetapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\nnetapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n# Target line: 95\n\n     90:         ensure_packages(['iscsi-initiator-utils'], {'ensure' => 'present'})\n     91:       }\n     92: \n     93:       elsif $netapp_storage_protocol == 'fc' {\n     94:         cinder::backend::netapp { $netapp_backend_name:\n>>>  95:           netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\n     96:           netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\n     97:           netapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\n     98:           netapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\n     99:           netapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\n    100:           netapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "user     => 'release',", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\nuser     => 'efg',\npassword => 'efg',\nrequire  => Class['::mysql::server'];\n\n['release_development', 'release_test']:\n49:       user     => 'release',\npassword => 'release',\nrequire  => Class['::mysql::server'];\n\n'search_admin_test':\nuser     => 'search_admin',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 49\n\n     44:       user     => 'efg',\n     45:       password => 'efg',\n     46:       require  => Class['::mysql::server'];\n     47: \n     48:     ['release_development', 'release_test']:\n>>>  49:       user     => 'release',\n     50:       password => 'release',\n     51:       require  => Class['::mysql::server'];\n     52: \n     53:     'search_admin_test':\n     54:       user     => 'search_admin',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "$ssl_kibana_key_file          = '/etc/nginx/ssl_kibana.key',", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\n$ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n$ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n$ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n$ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',\n$ssl_kibana_certificate       = $log_storage::params::nginx_ssl_kibana_certificate,\n47:   $ssl_kibana_key_file          = '/etc/nginx/ssl_kibana.key',\n$ssl_kibana_key               = $log_storage::params::nginx_ssl_kibana_key,\n$www_root                     = '/var/www/html',\n) inherits log_storage::params {\n\nif ($ssl_elastic_certificate and $ssl_elastic_key_file) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 47\n\n     42:   $ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n     43:   $ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n     44:   $ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n     45:   $ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',\n     46:   $ssl_kibana_certificate       = $log_storage::params::nginx_ssl_kibana_certificate,\n>>>  47:   $ssl_kibana_key_file          = '/etc/nginx/ssl_kibana.key',\n     48:   $ssl_kibana_key               = $log_storage::params::nginx_ssl_kibana_key,\n     49:   $www_root                     = '/var/www/html',\n     50: ) inherits log_storage::params {\n     51: \n     52:   if ($ssl_elastic_certificate and $ssl_elastic_key_file) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-system-two_shell_calls-manifests-account.pp", "content": "password   => pw_hash($password, 'SHA-512', 'mysalt'),", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-two_shell_calls-manifests-account.pp\n\ndefine two_shell_calls::account($username, $password, $strings_to_leak, $leaked_filenames) {\n::accounts::user { $username:\nshell      => '/bin/bash',\n4:     password   => pw_hash($password, 'SHA-512', 'mysalt'),\nmanagehome => true,\nhome_mode  => '0755',\n}\n\n# Leak strings in a text file in the users home directory", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-two_shell_calls-manifests-account.pp\n# Target line: 4\n\n      1: define two_shell_calls::account($username, $password, $strings_to_leak, $leaked_filenames) {\n      2:   ::accounts::user { $username:\n      3:     shell      => '/bin/bash',\n>>>   4:     password   => pw_hash($password, 'SHA-512', 'mysalt'),\n      5:     managehome => true,\n      6:     home_mode  => '0755',\n      7:   }\n      8: \n      9:   # Leak strings in a text file in the users home directory\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-jenkins-manifests-slave.pp", "content": "$user = true,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n\n# == Class: jenkins::slave\n#\nclass jenkins::slave(\n$ssh_key = undef,\n5:   $user = true,\n$gitfullname = 'OpenStack Jenkins',\n$gitemail = 'jenkins@openstack.org',\n$gitpgpkey = 'jenkins@openstack.org',\n$gerrituser = 'jenkins',\n$gerritkeytype = 'rsa',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-slave.pp\n# Target line: 5\n\n      1: # == Class: jenkins::slave\n      2: #\n      3: class jenkins::slave(\n      4:   $ssh_key = undef,\n>>>   5:   $user = true,\n      6:   $gitfullname = 'OpenStack Jenkins',\n      7:   $gitemail = 'jenkins@openstack.org',\n      8:   $gitpgpkey = 'jenkins@openstack.org',\n      9:   $gerrituser = 'jenkins',\n     10:   $gerritkeytype = 'rsa',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp", "content": "$access_token = '',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n\n#   [*sshprivkey_contents*] - SSH private key file contents\n#   [*update_status*] - update ticket statuses\n#   [*username*] - SSH username\n#\nclass fuel_project::devops_tools::lpupdatebug (\n26:   $access_token = '',\n$access_secret = '',\n$appname = 'lpupdatebug',\n$cachedir = '/var/tmp/launchpadlib/',\n$consumer_key = '',\n$consumer_secret = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n# Target line: 26\n\n     21: #   [*sshprivkey_contents*] - SSH private key file contents\n     22: #   [*update_status*] - update ticket statuses\n     23: #   [*username*] - SSH username\n     24: #\n     25: class fuel_project::devops_tools::lpupdatebug (\n>>>  26:   $access_token = '',\n     27:   $access_secret = '',\n     28:   $appname = 'lpupdatebug',\n     29:   $cachedir = '/var/tmp/launchpadlib/',\n     30:   $consumer_key = '',\n     31:   $consumer_secret = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service.pp", "content": "$rabbitmq_user = 'email_alert_service',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service.pp\n\n#   Bearer token for communication with the email-alert-api\n#\nclass govuk::apps::email_alert_service(\n$enabled = false,\n$rabbitmq_hosts = ['localhost'],\n34:   $rabbitmq_user = 'email_alert_service',\n$rabbitmq_password = 'email_alert_service',\n$sentry_dsn = undef,\n$redis_host = undef,\n$email_alert_api_bearer_token = undef,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service.pp\n# Target line: 34\n\n     29: #   Bearer token for communication with the email-alert-api\n     30: #\n     31: class govuk::apps::email_alert_service(\n     32:   $enabled = false,\n     33:   $rabbitmq_hosts = ['localhost'],\n>>>  34:   $rabbitmq_user = 'email_alert_service',\n     35:   $rabbitmq_password = 'email_alert_service',\n     36:   $sentry_dsn = undef,\n     37:   $redis_host = undef,\n     38:   $email_alert_api_bearer_token = undef,\n     39: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-package-debian.pp", "content": "key_source => 'http://nginx.org/keys/nginx_signing.key',", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-package-debian.pp\n\n'nginx': {\napt::source { 'nginx':\nlocation   => \"http://nginx.org/packages/${distro}\",\nrepos      => 'nginx',\nkey        => '7BD9BF62',\n42:           key_source => 'http://nginx.org/keys/nginx_signing.key',\nnotify     => Exec['apt_get_update_for_nginx'],\n}\n}\n'passenger': {\nensure_resource('package', 'apt-transport-https', {'ensure' => 'present' })", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-package-debian.pp\n# Target line: 42\n\n     37:       'nginx': {\n     38:         apt::source { 'nginx':\n     39:           location   => \"http://nginx.org/packages/${distro}\",\n     40:           repos      => 'nginx',\n     41:           key        => '7BD9BF62',\n>>>  42:           key_source => 'http://nginx.org/keys/nginx_signing.key',\n     43:           notify     => Exec['apt_get_update_for_nginx'],\n     44:         }\n     45:       }\n     46:       'passenger': {\n     47:         ensure_resource('package', 'apt-transport-https', {'ensure' => 'present' })\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "Optional[Boolean]               $chroot              = undef,", "line": 115, "detection_span": [110, 120], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nString                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\nString                          $myorigin            = $::fqdn,\nOptional[String]                $relayhost           = undef,         # postfix_relayhost\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n115:   Optional[Boolean]               $chroot              = undef,\nBoolean                         $satellite           = false,\nString                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\nBoolean                         $use_amavisd         = false,         # postfix_use_amavisd\nBoolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\nVariant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 115\n\n    110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n    111:   String                          $myorigin            = $::fqdn,\n    112:   Optional[String]                $relayhost           = undef,         # postfix_relayhost\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n>>> 115:   Optional[Boolean]               $chroot              = undef,\n    116:   Boolean                         $satellite           = false,\n    117:   String                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\n    118:   Boolean                         $use_amavisd         = false,         # postfix_use_amavisd\n    119:   Boolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\n    120:   Variant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp", "content": "user    => 'jboss',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n\n\n# The standard puppet way to create dirs recursively does not work when paths overlap\n# They do, because many modules are created in /usr/share/jbossas/modules/com...\nexec { $client_module_base_path:\ncommand => \"mkdir -p ${client_module_base_path}\",\n34:         user    => 'jboss',\n}\n\n$module_path = \"${client_module_base_path}/healthcheck/main\"\n$module_dirs = [\"${client_module_base_path}/healthcheck\", $module_path]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n# Target line: 34\n\n     29: \n     30:     # The standard puppet way to create dirs recursively does not work when paths overlap\n     31:     # They do, because many modules are created in /usr/share/jbossas/modules/com...\n     32:     exec { $client_module_base_path:\n     33:         command => \"mkdir -p ${client_module_base_path}\",\n>>>  34:         user    => 'jboss',\n     35:     }\n     36: \n     37:     $module_path = \"${client_module_base_path}/healthcheck/main\"\n     38:     $module_dirs = [\"${client_module_base_path}/healthcheck\", $module_path]\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp", "content": "routing_key      => '*.minor',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n\nensure           => 'present',\nname             => \"${amqp_exchange}@${amqp_queue}@minor@/\",\nuser             => 'root',\npassword         => $::govuk_rabbitmq::root_password,\ndestination_type => 'queue',\n51:     routing_key      => '*.minor',\narguments        => {},\n}\n\nrabbitmq_binding { \"binding_links_${amqp_exchange}@${amqp_queue}@/\":\nensure           => 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_data_api-rabbitmq.pp\n# Target line: 51\n\n     46:     ensure           => 'present',\n     47:     name             => \"${amqp_exchange}@${amqp_queue}@minor@/\",\n     48:     user             => 'root',\n     49:     password         => $::govuk_rabbitmq::root_password,\n     50:     destination_type => 'queue',\n>>>  51:     routing_key      => '*.minor',\n     52:     arguments        => {},\n     53:   }\n     54: \n     55:   rabbitmq_binding { \"binding_links_${amqp_exchange}@${amqp_queue}@/\":\n     56:     ensure           => 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_monitoring.pp", "content": "user       => 'nagios',", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_monitoring.pp\n\nroot         => '/dev/null',\n}\n\nlimits::limits { 'nagios_nofile':\nensure     => present,\n69:     user       => 'nagios',\nlimit_type => 'nofile',\nboth       => 16384,\n}\n\nfile { '/opt/smokey':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_monitoring.pp\n# Target line: 69\n\n     64:     root         => '/dev/null',\n     65:   }\n     66: \n     67:   limits::limits { 'nagios_nofile':\n     68:     ensure     => present,\n>>>  69:     user       => 'nagios',\n     70:     limit_type => 'nofile',\n     71:     both       => 16384,\n     72:   }\n     73: \n     74:   file { '/opt/smokey':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-gnocchi.pp", "content": "ssl_key   => \"/etc/gnocchi/ssl/private/${::fqdn}.pem\",", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n\n}\ninclude ::apache\nclass { '::gnocchi::wsgi::apache':\nbind_host => $::openstack_integration::config::ip_for_url,\nssl       => $::openstack_integration::config::ssl,\n54:     ssl_key   => \"/etc/gnocchi/ssl/private/${::fqdn}.pem\",\nssl_cert  => $::openstack_integration::params::cert_path,\nworkers   => 2,\n}\nclass { '::gnocchi::client': }\nclass { '::gnocchi::metricd':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-gnocchi.pp\n# Target line: 54\n\n     49:   }\n     50:   include ::apache\n     51:   class { '::gnocchi::wsgi::apache':\n     52:     bind_host => $::openstack_integration::config::ip_for_url,\n     53:     ssl       => $::openstack_integration::config::ssl,\n>>>  54:     ssl_key   => \"/etc/gnocchi/ssl/private/${::fqdn}.pem\",\n     55:     ssl_cert  => $::openstack_integration::params::cert_path,\n     56:     workers   => 2,\n     57:   }\n     58:   class { '::gnocchi::client': }\n     59:   class { '::gnocchi::metricd':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp", "content": "$http_password = undef,", "line": 73, "detection_span": [68, 78], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n\n$port = 3111,\n$secret_key_base = undef,\n$publishing_api_bearer_token = undef,\n$asset_manager_bearer_token = undef,\n$http_username = undef,\n73:   $http_password = undef,\n) {\n\ninclude govuk_postgresql::client #installs libpq-dev package needed for pg gem\n\n$app_name = 'service-manual-publisher'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n# Target line: 73\n\n     68:   $port = 3111,\n     69:   $secret_key_base = undef,\n     70:   $publishing_api_bearer_token = undef,\n     71:   $asset_manager_bearer_token = undef,\n     72:   $http_username = undef,\n>>>  73:   $http_password = undef,\n     74: ) {\n     75: \n     76:   include govuk_postgresql::client #installs libpq-dev package needed for pg gem\n     77: \n     78:   $app_name = 'service-manual-publisher'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-mistral.pp", "content": "ssl_key   => \"/etc/mistral/ssl/private/${::fqdn}.pem\",", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n\n}\ninclude ::apache\nclass { '::mistral::wsgi::apache':\nbind_host => $::openstack_integration::config::ip_for_url,\nssl       => $::openstack_integration::config::ssl,\n52:     ssl_key   => \"/etc/mistral/ssl/private/${::fqdn}.pem\",\nssl_cert  => $::openstack_integration::params::cert_path,\nworkers   => 2,\nthreads   => 1,\n}\nclass { '::mistral::client': }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n# Target line: 52\n\n     47:   }\n     48:   include ::apache\n     49:   class { '::mistral::wsgi::apache':\n     50:     bind_host => $::openstack_integration::config::ip_for_url,\n     51:     ssl       => $::openstack_integration::config::ssl,\n>>>  52:     ssl_key   => \"/etc/mistral/ssl/private/${::fqdn}.pem\",\n     53:     ssl_cert  => $::openstack_integration::params::cert_path,\n     54:     workers   => 2,\n     55:     threads   => 1,\n     56:   }\n     57:   class { '::mistral::client': }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp", "content": "key     => 'haproxy.fe.discovery',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n\ncommand => '/etc/zabbix/scripts/haproxy.sh -b';\n'haproxy.be':\nkey     => 'haproxy.be[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.fe.discovery':\n34:         key     => 'haproxy.fe.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -f';\n'haproxy.fe':\nkey     => 'haproxy.fe[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.sv.discovery':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n# Target line: 34\n\n     29:         command => '/etc/zabbix/scripts/haproxy.sh -b';\n     30:       'haproxy.be':\n     31:         key     => 'haproxy.be[*]',\n     32:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     33:       'haproxy.fe.discovery':\n>>>  34:         key     => 'haproxy.fe.discovery',\n     35:         command => '/etc/zabbix/scripts/haproxy.sh -f';\n     36:       'haproxy.fe':\n     37:         key     => 'haproxy.fe[*]',\n     38:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     39:       'haproxy.sv.discovery':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_SAHARA_DB_PW'),", "line": 122, "detection_span": [117, 127], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\n}\n}\n119:\nif hiera('CONFIG_SAHARA_INSTALL') == 'y' {\nclass { '::sahara::db::mysql':\n122:           password      => hiera('CONFIG_SAHARA_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\n}\n126:\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 122\n\n    117:         }\n    118:     }\n    119: \n    120:     if hiera('CONFIG_SAHARA_INSTALL') == 'y' {\n    121:         class { '::sahara::db::mysql':\n>>> 122:           password      => hiera('CONFIG_SAHARA_DB_PW'),\n    123:           host          => '%',\n    124:           allowed_hosts => '%',\n    125:         }\n    126: \n    127:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp", "content": "mysql_root_password         => hiera('mysql_root_password'),", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n\nzuulv2                      => hiera('zuulv2', true),\nzuul_revision               => hiera('zuul_revision', 'master'),\nzuul_git_source_repo        => hiera('zuul_git_source_repo',\n'https://git.openstack.org/openstack-infra/zuul'),\noscc_file_contents          => hiera('oscc_file_contents', ''),\n59:     mysql_root_password         => hiera('mysql_root_password'),\nmysql_nodepool_password     => hiera('mysql_nodepool_password'),\nnodepool_jenkins_target     => hiera('nodepool_jenkins_target', 'jenkins1'),\njenkins_api_key             => hiera('jenkins_api_key', 'XXX'),\njenkins_credentials_id      => hiera('jenkins_credentials_id', 'XXX'),\nnodepool_revision           => hiera('nodepool_revision', 'master'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n# Target line: 59\n\n     54:     zuulv2                      => hiera('zuulv2', true),\n     55:     zuul_revision               => hiera('zuul_revision', 'master'),\n     56:     zuul_git_source_repo        => hiera('zuul_git_source_repo',\n     57:       'https://git.openstack.org/openstack-infra/zuul'),\n     58:     oscc_file_contents          => hiera('oscc_file_contents', ''),\n>>>  59:     mysql_root_password         => hiera('mysql_root_password'),\n     60:     mysql_nodepool_password     => hiera('mysql_nodepool_password'),\n     61:     nodepool_jenkins_target     => hiera('nodepool_jenkins_target', 'jenkins1'),\n     62:     jenkins_api_key             => hiera('jenkins_api_key', 'XXX'),\n     63:     jenkins_credentials_id      => hiera('jenkins_credentials_id', 'XXX'),\n     64:     nodepool_revision           => hiera('nodepool_revision', 'master'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-ceph_compute.pp", "content": "user    => 'nova',", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-ceph_compute.pp\n\ncap_osd => 'allow *',\ncap_mds => 'allow',\n}\n\nceph::key { \"client.${compute_user}\":\n69:       user    => 'nova',\ngroup   => 'nova',\nsecret  => $secret,\ncap_mon => 'allow r',\ncap_osd => \"allow class-read object_prefix rbd_children, allow rwx pool=${cinder_pool}, allow rwx pool=${glance_pool}, allow rwx pool=${compute_pool}\",\ninject  => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-ceph-ceph_compute.pp\n# Target line: 69\n\n     64:       cap_osd => 'allow *',\n     65:       cap_mds => 'allow',\n     66:     }\n     67: \n     68:     ceph::key { \"client.${compute_user}\":\n>>>  69:       user    => 'nova',\n     70:       group   => 'nova',\n     71:       secret  => $secret,\n     72:       cap_mon => 'allow r',\n     73:       cap_osd => \"allow class-read object_prefix rbd_children, allow rwx pool=${cinder_pool}, allow rwx pool=${glance_pool}, allow rwx pool=${compute_pool}\",\n     74:       inject  => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-link_checker_api-db.pp", "content": "user                    => 'link_checker_api',", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-link_checker_api-db.pp\n\n$allow_auth_from_lb = false,\n$lb_ip_range = undef,\n$rds = false,\n) {\ngovuk_postgresql::db { 'link_checker_api_production':\n27:     user                    => 'link_checker_api',\npassword                => $password,\nallow_auth_from_backend => true,\nbackend_ip_range        => $backend_ip_range,\nallow_auth_from_lb      => $allow_auth_from_lb,\nlb_ip_range             => $lb_ip_range,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-link_checker_api-db.pp\n# Target line: 27\n\n     22:   $allow_auth_from_lb = false,\n     23:   $lb_ip_range = undef,\n     24:   $rds = false,\n     25: ) {\n     26:   govuk_postgresql::db { 'link_checker_api_production':\n>>>  27:     user                    => 'link_checker_api',\n     28:     password                => $password,\n     29:     allow_auth_from_backend => true,\n     30:     backend_ip_range        => $backend_ip_range,\n     31:     allow_auth_from_lb      => $allow_auth_from_lb,\n     32:     lb_ip_range             => $lb_ip_range,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_NOVA_DB_PW'),", "line": 104, "detection_span": [99, 109], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\nhost          => '%',\nallowed_hosts => '%',\ncharset       => 'utf8',\n}\nclass { '::nova::db::mysql_placement':\n104:           password      => hiera('CONFIG_NOVA_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\ncharset       => 'utf8',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 104\n\n     99:           host          => '%',\n    100:           allowed_hosts => '%',\n    101:           charset       => 'utf8',\n    102:         }\n    103:         class { '::nova::db::mysql_placement':\n>>> 104:           password      => hiera('CONFIG_NOVA_DB_PW'),\n    105:           host          => '%',\n    106:           allowed_hosts => '%',\n    107:           charset       => 'utf8',\n    108:         }\n    109:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp", "content": "$admin_password        = hiera('CONFIG_KEYSTONE_ADMIN_PW')", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n\n# Authentication/Keystone\n$identity_uri          = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v3', 'v2.0')\n$identity_uri_v3       = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v2.0', 'v3')\n$auth_version          = regsubst(hiera('CONFIG_KEYSTONE_API_VERSION'), '.0', '')\n$admin_username        = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n21:     $admin_password        = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$admin_tenant_name     = 'admin'\n$admin_domain_name     = 'Default'\n\n# get image and network id\n$configure_images          = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n# Target line: 21\n\n     16:     # Authentication/Keystone\n     17:     $identity_uri          = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v3', 'v2.0')\n     18:     $identity_uri_v3       = regsubst(hiera('CONFIG_KEYSTONE_PUBLIC_URL'), 'v2.0', 'v3')\n     19:     $auth_version          = regsubst(hiera('CONFIG_KEYSTONE_API_VERSION'), '.0', '')\n     20:     $admin_username        = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n>>>  21:     $admin_password        = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     22:     $admin_tenant_name     = 'admin'\n     23:     $admin_domain_name     = 'Default'\n     24: \n     25:     # get image and network id\n     26:     $configure_images          = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-nodes-hhvm.pp", "content": "user        => 'hhvm',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-hhvm.pp\n\n$supervisord_hhvm_cmd = \"hhvm --mode server -vServer.Type=fastcgi -vServer.Port=${hhvm_values['settings']['port']}\"\n\nsupervisord::program { 'hhvm':\ncommand     => $supervisord_hhvm_cmd,\npriority    => '100',\n40:     user        => 'hhvm',\nautostart   => true,\nautorestart => 'true',\nenvironment => { 'PATH' => '/bin:/sbin:/usr/bin:/usr/sbin' },\nrequire     => [\nUser['hhvm'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-hhvm.pp\n# Target line: 40\n\n     35:   $supervisord_hhvm_cmd = \"hhvm --mode server -vServer.Type=fastcgi -vServer.Port=${hhvm_values['settings']['port']}\"\n     36: \n     37:   supervisord::program { 'hhvm':\n     38:     command     => $supervisord_hhvm_cmd,\n     39:     priority    => '100',\n>>>  40:     user        => 'hhvm',\n     41:     autostart   => true,\n     42:     autorestart => 'true',\n     43:     environment => { 'PATH' => '/bin:/sbin:/usr/bin:/usr/sbin' },\n     44:     require     => [\n     45:       User['hhvm'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker-rabbitmq.pp", "content": "$amqp_user  = 'govuk_crawler_worker'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker-rabbitmq.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::apps::govuk_crawler_worker::rabbitmq (\n$amqp_pass  = 'guest',\n) {\n\n6:   $amqp_user  = 'govuk_crawler_worker'\n\nrabbitmq_user { $amqp_user:\nadmin    => false,\npassword => $amqp_pass,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-govuk_crawler_worker-rabbitmq.pp\n# Target line: 6\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::apps::govuk_crawler_worker::rabbitmq (\n      3:   $amqp_pass  = 'guest',\n      4: ) {\n      5: \n>>>   6:   $amqp_user  = 'govuk_crawler_worker'\n      7: \n      8:   rabbitmq_user { $amqp_user:\n      9:     admin    => false,\n     10:     password => $amqp_pass,\n     11:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp", "content": "$cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n\n\nclass { '::cinder::volume': }\n\nclass { '::cinder::client': }\n\n46:     $cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n$cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n$cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n\n# Cinder::Type requires keystone credentials", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n# Target line: 46\n\n     41: \n     42:     class { '::cinder::volume': }\n     43: \n     44:     class { '::cinder::client': }\n     45: \n>>>  46:     $cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n     47:     $cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     48:     $cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n     49:     $cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n     50: \n     51:     # Cinder::Type requires keystone credentials\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-params.pp", "content": "$gitlab_relative_url_root = false", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n\n$gitlab_backup            = false\n$gitlab_backup_path       = 'tmp/backups/'\n$gitlab_backup_keep_time  = '0'\n$gitlab_backup_time       = fqdn_rand(5)+1\n$gitlab_backup_postscript = false\n46:   $gitlab_relative_url_root = false\n$gitlab_issue_closing_pattern = undef\n$gitlab_repository_downloads_path = 'tmp/repositories'\n$gitlab_restricted_visibility_levels = undef\n$gitlab_default_projects_features_issues = true\n$gitlab_default_projects_features_merge_requests = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-params.pp\n# Target line: 46\n\n     41:   $gitlab_backup            = false\n     42:   $gitlab_backup_path       = 'tmp/backups/'\n     43:   $gitlab_backup_keep_time  = '0'\n     44:   $gitlab_backup_time       = fqdn_rand(5)+1\n     45:   $gitlab_backup_postscript = false\n>>>  46:   $gitlab_relative_url_root = false\n     47:   $gitlab_issue_closing_pattern = undef\n     48:   $gitlab_repository_downloads_path = 'tmp/repositories'\n     49:   $gitlab_restricted_visibility_levels = undef\n     50:   $gitlab_default_projects_features_issues = true\n     51:   $gitlab_default_projects_features_merge_requests = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "willdurand@puppet-nodejs-manifests-npm-file.pp", "content": "$exec_user = undef,", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: willdurand@puppet-nodejs-manifests-npm-file.pp\n\n# [*exec_env*]\n#   Exec environment.\n#\ndefine nodejs::npm::file(\n$directory,\n22:   $exec_user = undef,\n$exec_env  = undef,\n$options   = undef,\n) {\nif $caller_module_name != $module_name {\nwarning('::nodejs::npm::file is not meant for public use!')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: willdurand@puppet-nodejs-manifests-npm-file.pp\n# Target line: 22\n\n     17: # [*exec_env*]\n     18: #   Exec environment.\n     19: #\n     20: define nodejs::npm::file(\n     21:   $directory,\n>>>  22:   $exec_user = undef,\n     23:   $exec_env  = undef,\n     24:   $options   = undef,\n     25: ) {\n     26:   if $caller_module_name != $module_name {\n     27:     warning('::nodejs::npm::file is not meant for public use!')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-release.pp", "content": "$github_access_token = undef,", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-release.pp\n\n$db_hostname = undef,\n$db_username = undef,\n$db_password = undef,\n$db_name = 'release_production',\n$github_username = undef,\n50:   $github_access_token = undef,\n$oauth_id = undef,\n$oauth_secret = undef,\n) {\n$app_name = 'release'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-release.pp\n# Target line: 50\n\n     45:   $db_hostname = undef,\n     46:   $db_username = undef,\n     47:   $db_password = undef,\n     48:   $db_name = 'release_production',\n     49:   $github_username = undef,\n>>>  50:   $github_access_token = undef,\n     51:   $oauth_id = undef,\n     52:   $oauth_secret = undef,\n     53: ) {\n     54:   $app_name = 'release'\n     55: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp", "content": "key        => '420851BC',", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n\n'Debian': {\nclass { '::apt':\nstage => 'openstack-ci-repo'\n}->\nclass { '::openstack::repo::apt':\n22:       key        => '420851BC',\nlocation   => 'http://172.18.66.213/deb',\nkey_source => 'http://172.18.66.213/gpg.pub',\norigin     => '172.18.66.213',\nstage      => 'openstack-ci-repo'\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n# Target line: 22\n\n     17:   'Debian': {\n     18:     class { '::apt':\n     19:       stage => 'openstack-ci-repo'\n     20:     }->\n     21:     class { '::openstack::repo::apt':\n>>>  22:       key        => '420851BC',\n     23:       location   => 'http://172.18.66.213/deb',\n     24:       key_source => 'http://172.18.66.213/gpg.pub',\n     25:       origin     => '172.18.66.213',\n     26:       stage      => 'openstack-ci-repo'\n     27:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_slave.pp", "content": "$master_cert = 'master.localdomain'", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_slave.pp\n\n1: $master_cert = 'master.localdomain'\n$master_ip   = '192.168.5.16'\n\nclass { '::icinga2':\nmanage_repo  => true,\nconstants    => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_slave.pp\n# Target line: 1\n\n>>>   1: $master_cert = 'master.localdomain'\n      2: $master_ip   = '192.168.5.16'\n      3: \n      4: class { '::icinga2':\n      5:   manage_repo  => true,\n      6:   constants    => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp", "content": "$zendesk_client_password = undef,", "line": 103, "detection_span": [98, 108], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n\n$pp_data_bearer_token = undef,\n$redis_host = undef,\n100:   $redis_port = undef,\n101:   $secret_key_base = undef,\n102:   $zendesk_anonymous_ticket_email = undef,\n103:   $zendesk_client_password = undef,\n104:   $zendesk_client_username = undef,\n105:   $aws_access_key_id = undef,\n106:   $aws_secret_access_key = undef,\n107:   $aws_region = 'eu-west-1',\n108:   $aws_s3_bucket_name = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n# Target line: 103\n\n     98:   $pp_data_bearer_token = undef,\n     99:   $redis_host = undef,\n    100:   $redis_port = undef,\n    101:   $secret_key_base = undef,\n    102:   $zendesk_anonymous_ticket_email = undef,\n>>> 103:   $zendesk_client_password = undef,\n    104:   $zendesk_client_username = undef,\n    105:   $aws_access_key_id = undef,\n    106:   $aws_secret_access_key = undef,\n    107:   $aws_region = 'eu-west-1',\n    108:   $aws_s3_bucket_name = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-system-passwordless_user_account-manifests-init.pp", "content": "super_user      => str2bool($account['super_user']),", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-passwordless_user_account-manifests-init.pp\n\n$username = $account['username']\n\n::parameterised_accounts::account { \"passwordless_user_account_$username\":\nusername        => $username,\npassword        => '',\n10:     super_user      => str2bool($account['super_user']),\nstrings_to_leak => $secgen_parameters['strings_to_leak'],\nleaked_filenames => $account['leaked_filenames']\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-system-passwordless_user_account-manifests-init.pp\n# Target line: 10\n\n      5:   $username = $account['username']\n      6: \n      7:   ::parameterised_accounts::account { \"passwordless_user_account_$username\":\n      8:     username        => $username,\n      9:     password        => '',\n>>>  10:     super_user      => str2bool($account['super_user']),\n     11:     strings_to_leak => $secgen_parameters['strings_to_leak'],\n     12:     leaked_filenames => $account['leaked_filenames']\n     13:   }\n     14: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-phpmyadmin.pp", "content": "apt::key { '80E7349A06ED541C': key_server => 'hkp://keyserver.ubuntu.com:80' }", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-phpmyadmin.pp\n\n$webroot_location = '/var/www'\n) inherits puphpet::params {\n\nif $::osfamily == 'debian' {\nif $::operatingsystem == 'ubuntu' {\n11:       apt::key { '80E7349A06ED541C': key_server => 'hkp://keyserver.ubuntu.com:80' }\napt::ppa { 'ppa:nijel/phpmyadmin': require => Apt::Key['80E7349A06ED541C'] }\n}\n\n$phpMyAdmin_package = 'phpmyadmin'\n$phpMyAdmin_folder  = 'phpmyadmin'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-phpmyadmin.pp\n# Target line: 11\n\n      6:   $webroot_location = '/var/www'\n      7: ) inherits puphpet::params {\n      8: \n      9:   if $::osfamily == 'debian' {\n     10:     if $::operatingsystem == 'ubuntu' {\n>>>  11:       apt::key { '80E7349A06ED541C': key_server => 'hkp://keyserver.ubuntu.com:80' }\n     12:       apt::ppa { 'ppa:nijel/phpmyadmin': require => Apt::Key['80E7349A06ED541C'] }\n     13:     }\n     14: \n     15:     $phpMyAdmin_package = 'phpmyadmin'\n     16:     $phpMyAdmin_folder  = 'phpmyadmin'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "maxchk@puppet-varnish-manifests-shmlog.pp", "content": "pass    => '0',", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: maxchk@puppet-varnish-manifests-shmlog.pp\n\nname    => $shmlog_dir,\ntarget  => '/etc/fstab',\nfstype  => 'tmpfs',\ndevice  => 'tmpfs',\noptions => $options,\n50:     pass    => '0',\ndump    => '0',\nnotify  => Service['varnish'],\nrequire => File['shmlog-dir'],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: maxchk@puppet-varnish-manifests-shmlog.pp\n# Target line: 50\n\n     45:     name    => $shmlog_dir,\n     46:     target  => '/etc/fstab',\n     47:     fstype  => 'tmpfs',\n     48:     device  => 'tmpfs',\n     49:     options => $options,\n>>>  50:     pass    => '0',\n     51:     dump    => '0',\n     52:     notify  => Service['varnish'],\n     53:     require => File['shmlog-dir'],\n     54:   }\n     55: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Mirantis@solar-resources-nova_api_puppet-actions-remove.pp", "content": "admin_password => 'not important as removed'", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: Mirantis@solar-resources-nova_api_puppet-actions-remove.pp\n\nclass { 'nova::api':\nensure_package => 'absent',\nenabled        => false,\n4:   admin_password => 'not important as removed'\n}\n\ninclude nova::params\n\nexec { 'post-nova_config':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Mirantis@solar-resources-nova_api_puppet-actions-remove.pp\n# Target line: 4\n\n      1: class { 'nova::api':\n      2:   ensure_package => 'absent',\n      3:   enabled        => false,\n>>>   4:   admin_password => 'not important as removed'\n      5: }\n      6: \n      7: include nova::params\n      8: \n      9: exec { 'post-nova_config':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-obs_server-manifests-nginx.pp", "content": "$ssl_cert_file = '/srv/obs/certs/server.crt',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-obs_server-manifests-nginx.pp\n\n#\nclass obs_server::nginx (\n$access_log_file = '/srv/www/obs/api/log/nginx-obs-api-access.log',\n$error_log_file = '/srv/www/obs/api/log/nginx-obs-api-error.log',\n$ssl_key_file = '/srv/obs/certs/server.key',\n17:   $ssl_cert_file = '/srv/obs/certs/server.crt',\n$ssl_key_file_contents = '',\n$ssl_cert_file_contents = '',\n) inherits obs_server::folders {\n\npackage { 'nginx':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-obs_server-manifests-nginx.pp\n# Target line: 17\n\n     12: #\n     13: class obs_server::nginx (\n     14:   $access_log_file = '/srv/www/obs/api/log/nginx-obs-api-access.log',\n     15:   $error_log_file = '/srv/www/obs/api/log/nginx-obs-api-error.log',\n     16:   $ssl_key_file = '/srv/obs/certs/server.key',\n>>>  17:   $ssl_cert_file = '/srv/obs/certs/server.crt',\n     18:   $ssl_key_file_contents = '',\n     19:   $ssl_cert_file_contents = '',\n     20: ) inherits obs_server::folders {\n     21: \n     22: package { 'nginx':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp", "content": "san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n\n}\n\ncinder::backend::dellsc_iscsi { $backend_name :\nbackend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\nsan_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\n49:       san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\nsan_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\ndell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\ntarget_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\ntarget_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\ndell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n# Target line: 49\n\n     44:     }\n     45: \n     46:     cinder::backend::dellsc_iscsi { $backend_name :\n     47:       backend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\n     48:       san_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\n>>>  49:       san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\n     50:       san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\n     51:       dell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\n     52:       target_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\n     53:       target_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\n     54:       dell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-search_benchmark.pp", "content": "$auth_username = undef,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-search_benchmark.pp\n\n# == Class: govuk_jenkins::jobs::search_benchmark\n#\n# Create a file on disk that can be parsed by jenkins-job-builder\n#\nclass govuk_jenkins::jobs::search_benchmark (\n6:   $auth_username = undef,\n$auth_password = undef,\n$rate_limit_token = undef,\n$cron_schedule = '30 4 * * *'\n) {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-search_benchmark.pp\n# Target line: 6\n\n      1: # == Class: govuk_jenkins::jobs::search_benchmark\n      2: #\n      3: # Create a file on disk that can be parsed by jenkins-job-builder\n      4: #\n      5: class govuk_jenkins::jobs::search_benchmark (\n>>>   6:   $auth_username = undef,\n      7:   $auth_password = undef,\n      8:   $rate_limit_token = undef,\n      9:   $cron_schedule = '30 4 * * *'\n     10: ) {\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "$oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\n$oauth_access_file            = '/etc/nginx/oauth-access.lua',\n$oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n$oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n$oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n$oauth_domain                 = 'domain.com',\n40:   $oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n$ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n$ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n$ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n$ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n$ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 40\n\n     35:   $oauth_access_file            = '/etc/nginx/oauth-access.lua',\n     36:   $oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n     37:   $oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n     38:   $oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n     39:   $oauth_domain                 = 'domain.com',\n>>>  40:   $oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n     41:   $ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n     42:   $ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n     43:   $ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n     44:   $ssl_elastic_key              = $log_storage::params::nginx_ssl_elastic_key,\n     45:   $ssl_kibana_certificate_file  = '/etc/nginx/ssl_kibana.crt',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-icinga-manifests-config.pp", "content": "$http_password = '',", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config.pp\n\n#  Graphite host to check against\n#\nclass icinga::config (\n$enable_event_handlers = true,\n$http_username = '',\n22:   $http_password = '',\n$graphite_hostname = 'graphite.cluster',\n) {\n\nvalidate_bool($enable_event_handlers)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config.pp\n# Target line: 22\n\n     17: #  Graphite host to check against\n     18: #\n     19: class icinga::config (\n     20:   $enable_event_handlers = true,\n     21:   $http_username = '',\n>>>  22:   $http_password = '',\n     23:   $graphite_hostname = 'graphite.cluster',\n     24: ) {\n     25: \n     26:   validate_bool($enable_event_handlers)\n     27: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "camptocamp@puppet-archive-manifests-extract.pp", "content": "$user=undef,", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: camptocamp@puppet-archive-manifests-extract.pp\n\n$extension='tar.gz',\n$timeout=120,\n$path=$::path,\n$strip_components=0,\n$purge=false,\n43:   $user=undef,\n$tar_command=$::osfamily ? {\n'Solaris' => 'gtar',\ndefault   => 'tar',\n},\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-archive-manifests-extract.pp\n# Target line: 43\n\n     38:   $extension='tar.gz',\n     39:   $timeout=120,\n     40:   $path=$::path,\n     41:   $strip_components=0,\n     42:   $purge=false,\n>>>  43:   $user=undef,\n     44:   $tar_command=$::osfamily ? {\n     45:     'Solaris' => 'gtar',\n     46:     default   => 'tar',\n     47:   },\n     48: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "KrisBuytaert@puppet-graphite-manifests-params.pp", "content": "$carbon_amqp_password                      = 'guest',", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n\n$aggregator_use_whitelist                  = 'False',\n$aggregator_user                           = 'carbon',\n$carbon_ampq_user                          = 'guest',\n$carbon_amqp_exchange                      = 'graphite',\n$carbon_amqp_host                          = 'localhost',\n54:   $carbon_amqp_password                      = 'guest',\n$carbon_amqp_port                          = '5672',\n$carbon_amqp_verbose                       = 'False',\n$carbon_amqp_vhost                         = '/',\n$carbon_cache_amount                       = $::processorcount,\n$carbon_cache_query_interface              = '0.0.0.0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n# Target line: 54\n\n     49:   $aggregator_use_whitelist                  = 'False',\n     50:   $aggregator_user                           = 'carbon',\n     51:   $carbon_ampq_user                          = 'guest',\n     52:   $carbon_amqp_exchange                      = 'graphite',\n     53:   $carbon_amqp_host                          = 'localhost',\n>>>  54:   $carbon_amqp_password                      = 'guest',\n     55:   $carbon_amqp_port                          = '5672',\n     56:   $carbon_amqp_verbose                       = 'False',\n     57:   $carbon_amqp_vhost                         = '/',\n     58:   $carbon_cache_amount                       = $::processorcount,\n     59:   $carbon_cache_query_interface              = '0.0.0.0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-trove.pp", "content": "nova_proxy_admin_pass      => 'a_big_secret',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-trove.pp\n\n'password'  => 'an_even_bigger_secret',\n}),\ndatabase_connection        => 'mysql+pymysql://trove:trove@127.0.0.1/trove?charset=utf8',\nrabbit_use_ssl             => $::openstack_integration::config::ssl,\namqp_sasl_mechanisms       => 'PLAIN',\n45:     nova_proxy_admin_pass      => 'a_big_secret',\n}\nclass { '::trove::db::mysql':\npassword => 'trove',\n}\nclass { '::trove::keystone::auth':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-trove.pp\n# Target line: 45\n\n     40:       'password'  => 'an_even_bigger_secret',\n     41:     }),\n     42:     database_connection        => 'mysql+pymysql://trove:trove@127.0.0.1/trove?charset=utf8',\n     43:     rabbit_use_ssl             => $::openstack_integration::config::ssl,\n     44:     amqp_sasl_mechanisms       => 'PLAIN',\n>>>  45:     nova_proxy_admin_pass      => 'a_big_secret',\n     46:   }\n     47:   class { '::trove::db::mysql':\n     48:     password => 'trove',\n     49:   }\n     50:   class { '::trove::keystone::auth':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-stash-examples-stash_postgres_java_install.pp", "content": "password => postgresql_password('stash', 'password'),", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: voxpupuli@puppet-stash-examples-stash_postgres_java_install.pp\n\n}\nclass { 'stash::gc': }\nclass { 'stash::facts': }\npostgresql::server::db { 'stash':\nuser     => 'stash',\n30:     password => postgresql_password('stash', 'password'),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-stash-examples-stash_postgres_java_install.pp\n# Target line: 30\n\n     25:   }\n     26:   class { 'stash::gc': }\n     27:   class { 'stash::facts': }\n     28:   postgresql::server::db { 'stash':\n     29:     user     => 'stash',\n>>>  30:     password => postgresql_password('stash', 'password'),\n     31:   }\n     32: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-arista.pp", "content": "'ml2_arista/eapi_password': value => $eapi_password, secret => true;", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-arista.pp\n\nrequire ::neutron::plugins::ml2\n\nneutron_plugin_ml2 {\n'ml2_arista/eapi_host'    : value => $eapi_host;\n'ml2_arista/eapi_username': value => $eapi_username;\n61:     'ml2_arista/eapi_password': value => $eapi_password, secret => true;\n'ml2_arista/region_name'  : value => $region_name;\n'ml2_arista/sync_interval': value => $sync_interval;\n'ml2_arista/use_fqdn'     : value => $use_fqdn;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-arista.pp\n# Target line: 61\n\n     56:   require ::neutron::plugins::ml2\n     57: \n     58:   neutron_plugin_ml2 {\n     59:     'ml2_arista/eapi_host'    : value => $eapi_host;\n     60:     'ml2_arista/eapi_username': value => $eapi_username;\n>>>  61:     'ml2_arista/eapi_password': value => $eapi_password, secret => true;\n     62:     'ml2_arista/region_name'  : value => $region_name;\n     63:     'ml2_arista/sync_interval': value => $sync_interval;\n     64:     'ml2_arista/use_fqdn'     : value => $use_fqdn;\n     65:   }\n     66: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-global-enable_dark_mode_shortcut.pp", "content": "key    => '_HIEnableThemeSwitchHotKey',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: boxen@puppet-osx-manifests-global-enable_dark_mode_shortcut.pp\n\n# Public: Enables dark mode toggler shortcut\nclass osx::global::enable_dark_mode_shortcut {\nboxen::osx_defaults { 'Enable \"dark mode\" shortcut':\nensure => present,\ndomain => 'NSGlobalDomain',\n6:     key    => '_HIEnableThemeSwitchHotKey',\nvalue  => true,\ntype   => bool,\nuser   => $::boxen_user;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-global-enable_dark_mode_shortcut.pp\n# Target line: 6\n\n      1: # Public: Enables dark mode toggler shortcut\n      2: class osx::global::enable_dark_mode_shortcut {\n      3:   boxen::osx_defaults { 'Enable \"dark mode\" shortcut':\n      4:     ensure => present,\n      5:     domain => 'NSGlobalDomain',\n>>>   6:     key    => '_HIEnableThemeSwitchHotKey',\n      7:     value  => true,\n      8:     type   => bool,\n      9:     user   => $::boxen_user;\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bodepd@puppetlabs-openstack-examples-site.pp", "content": "$keystone_admin_token    = 'keystone_admin_token'", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n\n$private_interface       = 'eth1'\n# credentials\n$admin_email             = 'root@localhost'\n$admin_password          = 'keystone_admin'\n$keystone_db_password    = 'keystone_db_pass'\n26: $keystone_admin_token    = 'keystone_admin_token'\n$nova_db_password        = 'nova_pass'\n$nova_user_password      = 'nova_pass'\n$glance_db_password      = 'glance_pass'\n$glance_user_password    = 'glance_pass'\n$rabbit_password         = 'openstack_rabbit_password'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n# Target line: 26\n\n     21: $private_interface       = 'eth1'\n     22: # credentials\n     23: $admin_email             = 'root@localhost'\n     24: $admin_password          = 'keystone_admin'\n     25: $keystone_db_password    = 'keystone_db_pass'\n>>>  26: $keystone_admin_token    = 'keystone_admin_token'\n     27: $nova_db_password        = 'nova_pass'\n     28: $nova_user_password      = 'nova_pass'\n     29: $glance_db_password      = 'glance_pass'\n     30: $glance_user_password    = 'glance_pass'\n     31: $rabbit_password         = 'openstack_rabbit_password'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-appstore.pp", "content": "key    => 'WebKitDeveloperExtras',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-appstore.pp\n\nclass people::felho::osx_settings::appstore {\nboxen::osx_defaults { 'Enable the WebKit Developer Tools in the Mac App Store':\nuser   => $::luser,\ndomain => 'com.apple.appstore',\n5:     key    => 'WebKitDeveloperExtras',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Enable Debug Menu in the Mac App Store':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-appstore.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::appstore {\n      2:   boxen::osx_defaults { 'Enable the WebKit Developer Tools in the Mac App Store':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.appstore',\n>>>   5:     key    => 'WebKitDeveloperExtras',\n      6:     type   => 'bool',\n      7:     value  => true,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Enable Debug Menu in the Mac App Store':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp", "content": "$image_alt_ssh_user = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n\n\n# Image\n$uec_image_name     = hiera('CONFIG_PROVISION_UEC_IMAGE_NAME')\n$image_ssh_user     = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n$image_name_alt     = \"${uec_image_name}_alt\"\n33:     $image_alt_ssh_user = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n$image_source       = hiera('CONFIG_PROVISION_IMAGE_URL')\n$image_format       = hiera('CONFIG_PROVISION_IMAGE_FORMAT')\n\n# network name\n$public_network_name = 'public'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n# Target line: 33\n\n     28: \n     29:     # Image\n     30:     $uec_image_name     = hiera('CONFIG_PROVISION_UEC_IMAGE_NAME')\n     31:     $image_ssh_user     = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n     32:     $image_name_alt     = \"${uec_image_name}_alt\"\n>>>  33:     $image_alt_ssh_user = hiera('CONFIG_PROVISION_IMAGE_SSH_USER')\n     34:     $image_source       = hiera('CONFIG_PROVISION_IMAGE_URL')\n     35:     $image_format       = hiera('CONFIG_PROVISION_IMAGE_FORMAT')\n     36: \n     37:     # network name\n     38:     $public_network_name = 'public'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-postfix-manifests-init.pp", "content": "$smarthost_pass = undef,", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n\n#   Pass to authenticate all relayed mail with.\n#\nclass postfix (\n$smarthost = undef,\n$smarthost_user = undef,\n28:   $smarthost_pass = undef,\n$rewrite_mail_domain = 'localhost',\n$rewrite_mail_list = 'noemail'\n) {\n\nanchor { 'postfix::begin':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-init.pp\n# Target line: 28\n\n     23: #   Pass to authenticate all relayed mail with.\n     24: #\n     25: class postfix (\n     26:   $smarthost = undef,\n     27:   $smarthost_user = undef,\n>>>  28:   $smarthost_pass = undef,\n     29:   $rewrite_mail_domain = 'localhost',\n     30:   $rewrite_mail_list = 'noemail'\n     31: ) {\n     32: \n     33:   anchor { 'postfix::begin':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-windows-update-windows_update-manifests-params.pp", "content": "$p_reg_key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU'", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-windows-update-windows_update-manifests-params.pp\n\n$use_wuserver                        = '0'\n\nif $::operatingsystemrelease == 'Server 2012' {\n$p_reg_key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update'\n} else {\n31:     $p_reg_key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU'\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-windows-update-windows_update-manifests-params.pp\n# Target line: 31\n\n     26:   $use_wuserver                        = '0'\n     27: \n     28:   if $::operatingsystemrelease == 'Server 2012' {\n     29:     $p_reg_key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update'\n     30:   } else {\n>>>  31:     $p_reg_key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU'\n     32:   }\n     33: \n     34: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bastelfreak@puppet-prometheus2-manifests-params.pp", "content": "$user = 'prometheus'", "line": 89, "detection_span": [84, 94], "with_context": "# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n\n$statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n$statsd_exporter_package_ensure = 'latest'\n$statsd_exporter_package_name = 'statsd_exporter'\n$statsd_exporter_user = 'statsd-exporter'\n$statsd_exporter_version = '0.3.0'\n89:   $user = 'prometheus'\n$version = '1.5.2'\ncase $::architecture {\n'x86_64', 'amd64': { $arch = 'amd64' }\n'i386':            { $arch = '386'   }\ndefault:           {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n# Target line: 89\n\n     84:   $statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n     85:   $statsd_exporter_package_ensure = 'latest'\n     86:   $statsd_exporter_package_name = 'statsd_exporter'\n     87:   $statsd_exporter_user = 'statsd-exporter'\n     88:   $statsd_exporter_version = '0.3.0'\n>>>  89:   $user = 'prometheus'\n     90:   $version = '1.5.2'\n     91:   case $::architecture {\n     92:     'x86_64', 'amd64': { $arch = 'amd64' }\n     93:     'i386':            { $arch = '386'   }\n     94:     default:           {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-storage-cephmon.pp", "content": "$dashboard_user       = 'admin',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: norcams@himlar-profile-manifests-storage-cephmon.pp\n\n# Class: profile::storage::cephmon\n#\n#\nclass profile::storage::cephmon (\n$dashboard_password,\n6:   $dashboard_user       = 'admin',\n$manage_dashboard     = false,\n$crt_dir              = '/etc/pki/tls/certs',\n$key_dir              = '/etc/pki/tls/private',\n$cert_name            = $::fqdn,\n$flagfile             = '/var/lib/ceph/.ceph-dashboard-set-up',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-storage-cephmon.pp\n# Target line: 6\n\n      1: # Class: profile::storage::cephmon\n      2: #\n      3: #\n      4: class profile::storage::cephmon (\n      5:   $dashboard_password,\n>>>   6:   $dashboard_user       = 'admin',\n      7:   $manage_dashboard     = false,\n      8:   $crt_dir              = '/etc/pki/tls/certs',\n      9:   $key_dir              = '/etc/pki/tls/private',\n     10:   $cert_name            = $::fqdn,\n     11:   $flagfile             = '/var/lib/ceph/.ceph-dashboard-set-up',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp", "content": "$db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n\n$db_name     = pick($murano_hash['db_name'], 'murano')\n$db_password = pick($murano_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($murano_hash['db_host'], $database_vip)\n$db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n22:   $db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n$db_root_password = pick($murano_hash['root_password'], $mysql_root_password)\n\n$allowed_hosts = [ $node_name, 'localhost', '127.0.0.1', '%' ]\n\nvalidate_string($mysql_root_user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n# Target line: 22\n\n     17:   $db_name     = pick($murano_hash['db_name'], 'murano')\n     18:   $db_password = pick($murano_hash['db_password'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($murano_hash['db_host'], $database_vip)\n     21:   $db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n>>>  22:   $db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n     23:   $db_root_password = pick($murano_hash['root_password'], $mysql_root_password)\n     24: \n     25:   $allowed_hosts = [ $node_name, 'localhost', '127.0.0.1', '%' ]\n     26: \n     27:   validate_string($mysql_root_user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-global-expand_save_dialog.pp", "content": "key    => 'NSNavPanelExpandedStateForSaveMode',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: boxen@puppet-osx-manifests-global-expand_save_dialog.pp\n\n# Public: Expand the Save panel by default.\nclass osx::global::expand_save_dialog {\nboxen::osx_defaults { 'Expand save panel by default':\nuser   => $::boxen_user,\n5:     key    => 'NSNavPanelExpandedStateForSaveMode',\ndomain => 'NSGlobalDomain',\nvalue  => true;\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-global-expand_save_dialog.pp\n# Target line: 5\n\n      1: # Public: Expand the Save panel by default.\n      2: class osx::global::expand_save_dialog {\n      3:   boxen::osx_defaults { 'Expand save panel by default':\n      4:     user   => $::boxen_user,\n>>>   5:     key    => 'NSNavPanelExpandedStateForSaveMode',\n      6:     domain => 'NSGlobalDomain',\n      7:     value  => true;\n      8:   }\n      9: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_stats-manifests-db.pp", "content": "password => postgresql_password($psql_user, $psql_pass),", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_stats-manifests-db.pp\n\n],\n}\n}\npostgresql::server::db { $psql_db:\nuser     => $psql_user,\n37:       password => postgresql_password($psql_user, $psql_pass),\n}\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_stats-manifests-db.pp\n# Target line: 37\n\n     32:         ],\n     33:       }\n     34:     }\n     35:     postgresql::server::db { $psql_db:\n     36:       user     => $psql_user,\n>>>  37:       password => postgresql_password($psql_user, $psql_pass),\n     38:     }\n     39:   }\n     40: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-jenkins-manifests-job_builder.pp", "content": "$manage_user = false,", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n\n$git_url = 'https://git.openstack.org/openstack-infra/jenkins-job-builder',\n$config_dir = '',\n$jenkins_jobs_update_timeout = '600',\n$query_plugins_info = true,\n$extensions = [],\n13:   $manage_user = false,\n) {\nvalidate_array($extensions)\n\n# A lot of things need yaml, be conservative requiring this package to avoid\n# conflicts with other modules.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n# Target line: 13\n\n      8:   $git_url = 'https://git.openstack.org/openstack-infra/jenkins-job-builder',\n      9:   $config_dir = '',\n     10:   $jenkins_jobs_update_timeout = '600',\n     11:   $query_plugins_info = true,\n     12:   $extensions = [],\n>>>  13:   $manage_user = false,\n     14: ) {\n     15:   validate_array($extensions)\n     16: \n     17:   # A lot of things need yaml, be conservative requiring this package to avoid\n     18:   # conflicts with other modules.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-dock-hot_corner.pp", "content": "key    => \"wvous-${position_value}-modifier\",", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: boxen@puppet-osx-manifests-dock-hot_corner.pp\n\nnotify => Exec['killall Dock'];\n}\n\nboxen::osx_defaults { \"Hot Corners ${position} Modifier\":\ndomain => 'com.apple.dock',\n61:     key    => \"wvous-${position_value}-modifier\",\ntype   => int,\nvalue  => 0,\nuser   => $::boxen_user,\nnotify => Exec['killall Dock'];\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-dock-hot_corner.pp\n# Target line: 61\n\n     56:     notify => Exec['killall Dock'];\n     57:   }\n     58: \n     59:   boxen::osx_defaults { \"Hot Corners ${position} Modifier\":\n     60:     domain => 'com.apple.dock',\n>>>  61:     key    => \"wvous-${position_value}-modifier\",\n     62:     type   => int,\n     63:     value  => 0,\n     64:     user   => $::boxen_user,\n     65:     notify => Exec['killall Dock'];\n     66:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-jenkins_master.pp", "content": "$jenkins_username        = 'jenkins',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-jenkins_master.pp\n\n# == Class: openstackci::jenkins_master\n#\nclass openstackci::jenkins_master (\n$serveradmin,\n$jenkins_password,\n6:   $jenkins_username        = 'jenkins',\n$vhost_name              = $::fqdn,\n$logo                    = '', # Logo must be present in puppet-jenkins/files\n$ssl_cert_file           = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$ssl_key_file            = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$ssl_chain_file          = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-jenkins_master.pp\n# Target line: 6\n\n      1: # == Class: openstackci::jenkins_master\n      2: #\n      3: class openstackci::jenkins_master (\n      4:   $serveradmin,\n      5:   $jenkins_password,\n>>>   6:   $jenkins_username        = 'jenkins',\n      7:   $vhost_name              = $::fqdn,\n      8:   $logo                    = '', # Logo must be present in puppet-jenkins/files\n      9:   $ssl_cert_file           = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     10:   $ssl_key_file            = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     11:   $ssl_chain_file          = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-openstack-resource-imagebuilder.pp", "content": "$user    = 'imagebuilder',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-resource-imagebuilder.pp\n\n# Manage imagebuilder user and project\nclass profile::openstack::resource::imagebuilder(\n$password,\n$manage  = false,\n$ensure  = present,\n6:   $user    = 'imagebuilder',\n$project = 'imagebuilder',\n$domain  = 'default'\n) {\n\nif $manage {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-resource-imagebuilder.pp\n# Target line: 6\n\n      1: # Manage imagebuilder user and project\n      2: class profile::openstack::resource::imagebuilder(\n      3:   $password,\n      4:   $manage  = false,\n      5:   $ensure  = present,\n>>>   6:   $user    = 'imagebuilder',\n      7:   $project = 'imagebuilder',\n      8:   $domain  = 'default'\n      9: ) {\n     10: \n     11:   if $manage {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp", "content": "service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n\nvcpus  => '1',\nrequire => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n} ->\nmanila::service_instance{ 'generic':\nservice_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\n35:       service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\nservice_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\nservice_instance_network_helper_type => $service_instance_network_helper_type,\nservice_instance_flavor_id           => 66,\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n# Target line: 35\n\n     30:       vcpus  => '1',\n     31:       require => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n     32:     } ->\n     33:     manila::service_instance{ 'generic':\n     34:       service_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\n>>>  35:       service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\n     36:       service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\n     37:       service_instance_network_helper_type => $service_instance_network_helper_type,\n     38:       service_instance_flavor_id           => 66,\n     39:     }\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-qdr.pp", "content": "key_path => \"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\",", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-qdr.pp\n\nmode                    => '0755',\nselinux_ignore_defaults => true,\nbefore                  => File[\"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\"],\n}\nopenstack_integration::ssl_key { 'qdrouterd':\n36:       key_path => \"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\",\nrequire  => File['/etc/qpid-dispatch/ssl/private'],\nnotify   => Service['qdrouterd'],\n}\nclass { '::qdr':\nlistener_require_ssl   => 'yes',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-qdr.pp\n# Target line: 36\n\n     31:       mode                    => '0755',\n     32:       selinux_ignore_defaults => true,\n     33:       before                  => File[\"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\"],\n     34:     }\n     35:     openstack_integration::ssl_key { 'qdrouterd':\n>>>  36:       key_path => \"/etc/qpid-dispatch/ssl/private/${::fqdn}.pem\",\n     37:       require  => File['/etc/qpid-dispatch/ssl/private'],\n     38:       notify   => Service['qdrouterd'],\n     39:     }\n     40:     class { '::qdr':\n     41:       listener_require_ssl   => 'yes',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp", "content": "$db_root_password = pick($neutron_db['root_password'], $mysql_root_password)", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n\n$db_password = pick($neutron_db['passwd'], $mysql_root_password)\n\n$db_host          = pick($neutron_db['db_host'], $database_vip)\n$db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n$db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n23:   $db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n\n$allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n\nvalidate_string($mysql_root_user)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n# Target line: 23\n\n     18:   $db_password = pick($neutron_db['passwd'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($neutron_db['db_host'], $database_vip)\n     21:   $db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n     22:   $db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n>>>  23:   $db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n     24: \n     25:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     26: \n     27:   validate_string($mysql_root_user)\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-openstackclient.pp", "content": "$ost_cl_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-openstackclient.pp\n\n\nif hiera('CONFIG_MANILA_INSTALL') == 'y' {\nensure_packages(['/usr/bin/manila'], {'ensure' => 'present'})\n}\n\n13:     $ost_cl_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n$ost_cl_keystone_admin_pw       = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$ost_cl_ctrl_keystone_url       = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n$ost_cl_keystone_region         = hiera('CONFIG_KEYSTONE_REGION')\n$ost_cl_keystone_demo_pw        = hiera('CONFIG_KEYSTONE_DEMO_PW')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-openstackclient.pp\n# Target line: 13\n\n      8: \n      9:     if hiera('CONFIG_MANILA_INSTALL') == 'y' {\n     10:       ensure_packages(['/usr/bin/manila'], {'ensure' => 'present'})\n     11:     }\n     12: \n>>>  13:     $ost_cl_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n     14:     $ost_cl_keystone_admin_pw       = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     15:     $ost_cl_ctrl_keystone_url       = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n     16:     $ost_cl_keystone_region         = hiera('CONFIG_KEYSTONE_REGION')\n     17:     $ost_cl_keystone_demo_pw        = hiera('CONFIG_KEYSTONE_DEMO_PW')\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_AODH_DB_PW'),", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\n}\n\nif hiera('CONFIG_AODH_INSTALL') == 'y' and\nhiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\nclass { '::aodh::db::mysql':\n39:           password      => hiera('CONFIG_AODH_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 39\n\n     34:     }\n     35: \n     36:     if hiera('CONFIG_AODH_INSTALL') == 'y' and\n     37:        hiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\n     38:         class { '::aodh::db::mysql':\n>>>  39:           password      => hiera('CONFIG_AODH_DB_PW'),\n     40:           host          => '%',\n     41:           allowed_hosts => '%',\n     42:         }\n     43:     }\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-ironic.pp", "content": "password     => hiera('CONFIG_IRONIC_KS_PW'),", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-ironic.pp\n\n$ironic_port = '6385'\n$ironic_url = \"${ironic_protocol}://${ironic_host}:$ironic_port\"\n\nclass { '::ironic::keystone::auth':\nregion       => hiera('CONFIG_KEYSTONE_REGION'),\n10:         password     => hiera('CONFIG_IRONIC_KS_PW'),\npublic_url   => $ironic_url,\nadmin_url    => $ironic_url,\ninternal_url => $ironic_url,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-ironic.pp\n# Target line: 10\n\n      5:     $ironic_port = '6385'\n      6:     $ironic_url = \"${ironic_protocol}://${ironic_host}:$ironic_port\"\n      7: \n      8:     class { '::ironic::keystone::auth':\n      9:         region       => hiera('CONFIG_KEYSTONE_REGION'),\n>>>  10:         password     => hiera('CONFIG_IRONIC_KS_PW'),\n     11:         public_url   => $ironic_url,\n     12:         admin_url    => $ironic_url,\n     13:         internal_url => $ironic_url,\n     14:     }\n     15: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-windows-alias.pp", "content": "$ps_module_root = 'C:/Users/Administrator/Documents/WindowsPowerShell'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-alias.pp\n\nclass classroom::windows::alias {\n\nassert_private('This class should not be called directly')\n\n5:   $ps_module_root = 'C:/Users/Administrator/Documents/WindowsPowerShell'\n$ps_module_path = 'C:/Users/Administrator/Documents/WindowsPowerShell/Modules'\n$alias_dir      = \"${ps_module_path}/alias\"\n$psm_file       = 'alias.psm1'\n$psd_file       = 'alias.psd1'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-alias.pp\n# Target line: 5\n\n      1: class classroom::windows::alias {\n      2: \n      3:   assert_private('This class should not be called directly')\n      4: \n>>>   5:   $ps_module_root = 'C:/Users/Administrator/Documents/WindowsPowerShell'\n      6:   $ps_module_path = 'C:/Users/Administrator/Documents/WindowsPowerShell/Modules'\n      7:   $alias_dir      = \"${ps_module_path}/alias\"\n      8:   $psm_file       = 'alias.psm1'\n      9:   $psd_file       = 'alias.psd1'\n     10: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puphpet@puppet-puphpet-manifests-rabbitmq-params.pp", "content": "$gpg_key     = '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB'", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: puphpet@puppet-puphpet-manifests-rabbitmq-params.pp\n\n$repo_location = $::osfamily ? {\n'debian' => 'https://packagecloud.io/rabbitmq/rabbitmq-server',\n'redhat' => \"https://packagecloud.io/rabbitmq/rabbitmq-server/el/${facts['os'][release][major]}/\\$basearch\",\n}\n\n10:   $gpg_key     = '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB'\n\nif array_true($puphpet::params::hiera['apache'], 'install') or\narray_true($puphpet::params::hiera['nginx'], 'install')\n{\n$webserver_restart = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puphpet@puppet-puphpet-manifests-rabbitmq-params.pp\n# Target line: 10\n\n      5:   $repo_location = $::osfamily ? {\n      6:     'debian' => 'https://packagecloud.io/rabbitmq/rabbitmq-server',\n      7:     'redhat' => \"https://packagecloud.io/rabbitmq/rabbitmq-server/el/${facts['os'][release][major]}/\\$basearch\",\n      8:   }\n      9: \n>>>  10:   $gpg_key     = '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB'\n     11: \n     12:   if array_true($puphpet::params::hiera['apache'], 'install') or\n     13:      array_true($puphpet::params::hiera['nginx'], 'install')\n     14:   {\n     15:     $webserver_restart = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-gearman-manifests-server.pp", "content": "user         => 'gearman',", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-gearman-manifests-server.pp\n\n->\n\ndaemon { $fullname:\nbinary       => '/usr/sbin/gearmand',\nargs         => $daemon_args,\n65:     user         => 'gearman',\nlimit_nofile => 16384,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-gearman-manifests-server.pp\n# Target line: 65\n\n     60:   ->\n     61: \n     62:   daemon { $fullname:\n     63:     binary       => '/usr/sbin/gearmand',\n     64:     args         => $daemon_args,\n>>>  65:     user         => 'gearman',\n     66:     limit_nofile => 16384,\n     67:   }\n     68: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-git-manifests-config-local.pp", "content": "$split_key = split($key, '\\.')", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: boxen@puppet-git-manifests-config-local.pp\n\n#   git::config::local { '/tmp/foo':\n#     key   => 'user.name',\n#     value => 'Hugh Bot',\n#   }\ndefine git::config::local($key, $value, $repo = $name, $ensure = present) {\n17:   $split_key = split($key, '\\.')\n\nini_setting { \"set ${key} to ${value} in ${repo}\":\nensure  => $ensure,\npath    => \"${repo}/.git/config\",\nsection => $split_key[0],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-git-manifests-config-local.pp\n# Target line: 17\n\n     12: #   git::config::local { '/tmp/foo':\n     13: #     key   => 'user.name',\n     14: #     value => 'Hugh Bot',\n     15: #   }\n     16: define git::config::local($key, $value, $repo = $name, $ensure = present) {\n>>>  17:   $split_key = split($key, '\\.')\n     18: \n     19:   ini_setting { \"set ${key} to ${value} in ${repo}\":\n     20:     ensure  => $ensure,\n     21:     path    => \"${repo}/.git/config\",\n     22:     section => $split_key[0],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-apache-examples-vhost_directories.pp", "content": "docroot     => '/var/www/location',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-examples-vhost_directories.pp\n\n],\n}\n\n# location test\napache::vhost { 'location.example.net':\n23:   docroot     => '/var/www/location',\ndirectories => [\n{\n'path'         => '/location',\n'provider'     => 'location',\n'ServerTokens' => 'prod'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-examples-vhost_directories.pp\n# Target line: 23\n\n     18:   ],\n     19: }\n     20: \n     21: # location test\n     22: apache::vhost { 'location.example.net':\n>>>  23:   docroot     => '/var/www/location',\n     24:   directories => [\n     25:     {\n     26:       'path'         => '/location',\n     27:       'provider'     => 'location',\n     28:       'ServerTokens' => 'prod'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-placement.pp", "content": "password => 'placement',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-placement.pp\n\n}\nExec['update-ca-certificates'] ~> Service['httpd']\n}\n\nclass { '::placement::db::mysql':\n19:     password => 'placement',\n}\n\nif ($::os_package_type == 'debian') {\nclass { '::placement::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:8778\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-placement.pp\n# Target line: 19\n\n     14:     }\n     15:     Exec['update-ca-certificates'] ~> Service['httpd']\n     16:   }\n     17: \n     18:   class { '::placement::db::mysql':\n>>>  19:     password => 'placement',\n     20:   }\n     21: \n     22:   if ($::os_package_type == 'debian') {\n     23:     class { '::placement::keystone::auth':\n     24:       public_url   => \"${::openstack_integration::config::base_url}:8778\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "theforeman@puppet-foreman-manifests-cli-params.pp", "content": "$password = undef", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: theforeman@puppet-foreman-manifests-cli-params.pp\n\nclass foreman::cli::params {\n$foreman_url = undef\n$version = 'installed'\n$manage_root_config = true\n$username = undef\n7:   $password = undef\n$refresh_cache = false\n$request_timeout = 120\n$ssl_ca_file = undef\n\n# OS specific paths", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@puppet-foreman-manifests-cli-params.pp\n# Target line: 7\n\n      2: class foreman::cli::params {\n      3:   $foreman_url = undef\n      4:   $version = 'installed'\n      5:   $manage_root_config = true\n      6:   $username = undef\n>>>   7:   $password = undef\n      8:   $refresh_cache = false\n      9:   $request_timeout = 120\n     10:   $ssl_ca_file = undef\n     11: \n     12:   # OS specific paths\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-jira-examples-jira_mysql_nativessl_install.pp", "content": "user     => 'jiraadm',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: voxpupuli@puppet-jira-examples-jira_mysql_nativessl_install.pp\n\nclass { 'mysql::server':\nroot_password    => 'strongpassword',\n}\n\nmysql::db { 'jira':\n11:     user     => 'jiraadm',\npassword => 'mypassword',\nhost     => 'localhost',\ngrant    => ['ALL'],\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-jira-examples-jira_mysql_nativessl_install.pp\n# Target line: 11\n\n      6:   class { 'mysql::server':\n      7:     root_password    => 'strongpassword',\n      8:   }\n      9: \n     10:   mysql::db { 'jira':\n>>>  11:     user     => 'jiraadm',\n     12:     password => 'mypassword',\n     13:     host     => 'localhost',\n     14:     grant    => ['ALL'],\n     15:   }\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp", "content": "san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n\n\ncinder::backend::dellsc_iscsi { $backend_name :\nbackend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\nsan_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\nsan_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\n50:       san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\ndell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\ntarget_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\ntarget_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\ndell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),\ndell_sc_server_folder        => hiera('cinder::backend::dellsc_iscsi::dell_sc_server_folder', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-dellsc.pp\n# Target line: 50\n\n     45: \n     46:     cinder::backend::dellsc_iscsi { $backend_name :\n     47:       backend_availability_zone    => hiera('cinder::backend::dellsc_iscsi::backend_availability_zone', undef),\n     48:       san_ip                       => hiera('cinder::backend::dellsc_iscsi::san_ip', undef),\n     49:       san_login                    => hiera('cinder::backend::dellsc_iscsi::san_login', undef),\n>>>  50:       san_password                 => hiera('cinder::backend::dellsc_iscsi::san_password', undef),\n     51:       dell_sc_ssn                  => hiera('cinder::backend::dellsc_iscsi::dell_sc_ssn', undef),\n     52:       target_ip_address            => hiera('cinder::backend::dellsc_iscsi::iscsi_ip_address', undef),\n     53:       target_port                  => hiera('cinder::backend::dellsc_iscsi::iscsi_port', undef),\n     54:       dell_sc_api_port             => hiera('cinder::backend::dellsc_iscsi::dell_sc_api_port', undef),\n     55:       dell_sc_server_folder        => hiera('cinder::backend::dellsc_iscsi::dell_sc_server_folder', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-nodes-xhprof.pp", "content": "apt::key { '8D0DC64F': key_server => 'hkp://keyserver.ubuntu.com:80' }", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-xhprof.pp\n\nand hash_key_equals($php_values, 'install', 1)\n{\nif $::operatingsystem == 'ubuntu'\nand $::lsbdistcodename in ['lucid', 'maverick', 'natty', 'oneiric', 'precise']\n{\n14:     apt::key { '8D0DC64F': key_server => 'hkp://keyserver.ubuntu.com:80' }\napt::ppa { 'ppa:brianmercer/php5-xhprof': require => Apt::Key['8D0DC64F'] }\n}\n\n$xhprof_php_prefix = $::osfamily ? {\n'debian' => 'php5-',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-xhprof.pp\n# Target line: 14\n\n      9:   and hash_key_equals($php_values, 'install', 1)\n     10: {\n     11:   if $::operatingsystem == 'ubuntu'\n     12:     and $::lsbdistcodename in ['lucid', 'maverick', 'natty', 'oneiric', 'precise']\n     13:   {\n>>>  14:     apt::key { '8D0DC64F': key_server => 'hkp://keyserver.ubuntu.com:80' }\n     15:     apt::ppa { 'ppa:brianmercer/php5-xhprof': require => Apt::Key['8D0DC64F'] }\n     16:   }\n     17: \n     18:   $xhprof_php_prefix = $::osfamily ? {\n     19:     'debian' => 'php5-',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-ci-runner.pp", "content": "$user                = 'gitlab_ci_runner',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-runner.pp\n\n$ensure              = 'present',\n$branch              = '5-0-stable',\n$exec_path           = '/home/gitlab_ci_runner/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin',\n$ruby_version        = '2.1.6',\n$source              = 'https://gitlab.com/gitlab-org/gitlab-ci-runner.git',\n51:   $user                = 'gitlab_ci_runner',\n$user_home           = '/home/gitlab_ci_runner',\n){\n\nuser { $user:\nensure     => $ensure,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-runner.pp\n# Target line: 51\n\n     46:   $ensure              = 'present',\n     47:   $branch              = '5-0-stable',\n     48:   $exec_path           = '/home/gitlab_ci_runner/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin',\n     49:   $ruby_version        = '2.1.6',\n     50:   $source              = 'https://gitlab.com/gitlab-org/gitlab-ci-runner.git',\n>>>  51:   $user                = 'gitlab_ci_runner',\n     52:   $user_home           = '/home/gitlab_ci_runner',\n     53: ){\n     54: \n     55:   user { $user:\n     56:     ensure     => $ensure,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp", "content": "$ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n\n#\nclass ci_environment::jenkins_master (\n$github_enterprise_cert,\n$vhost,\n$ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n26:   $ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$legacy_vhost = undef,\n$legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$slave_user = 'slave',\n$jenkins_home", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n# Target line: 26\n\n     21: #\n     22: class ci_environment::jenkins_master (\n     23:   $github_enterprise_cert,\n     24:   $vhost,\n     25:   $ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n>>>  26:   $ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     27:   $legacy_vhost = undef,\n     28:   $legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     29:   $legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     30:   $slave_user = 'slave',\n     31:   $jenkins_home\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-icinga-manifests-config-pingdom.pp", "content": "$password = 'UNSET',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config-pingdom.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass icinga::config::pingdom (\n$username = 'UNSET',\n4:   $password = 'UNSET',\n$key = 'UNSET'\n) {\n\nfile { '/etc/pingdom.ini':\ncontent => template('icinga/etc/pingdom.ini.erb'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-config-pingdom.pp\n# Target line: 4\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class icinga::config::pingdom (\n      3:   $username = 'UNSET',\n>>>   4:   $password = 'UNSET',\n      5:   $key = 'UNSET'\n      6: ) {\n      7: \n      8:   file { '/etc/pingdom.ini':\n      9:     content => template('icinga/etc/pingdom.ini.erb'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp", "content": "$etc_root_password   = false", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n\nclass mysql::params {\n\n$bind_address        = '127.0.0.1'\n$config_template     = 'mysql/my.cnf.erb'\n$default_engine      = 'UNSET'\n18:   $etc_root_password   = false\n$manage_service      = true\n$old_root_password   = ''\n$package_ensure      = 'present'\n$purge_conf_dir      = false\n$max_connections     = 151", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n# Target line: 18\n\n     13: class mysql::params {\n     14: \n     15:   $bind_address        = '127.0.0.1'\n     16:   $config_template     = 'mysql/my.cnf.erb'\n     17:   $default_engine      = 'UNSET'\n>>>  18:   $etc_root_password   = false\n     19:   $manage_service      = true\n     20:   $old_root_password   = ''\n     21:   $package_ensure      = 'present'\n     22:   $purge_conf_dir      = false\n     23:   $max_connections     = 151\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n}\n\ncase $::staging_http_get {\n'curl', default: {\n$http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n55:       $http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n$http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n$ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n$ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n}\n'wget': {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 55\n\n     50:   }\n     51: \n     52:   case $::staging_http_get {\n     53:     'curl', default: {\n     54:       $http_get        = \"curl ${curl_option} -f -L -o ${name} ${quoted_source}\"\n>>>  55:       $http_get_passwd = \"curl ${curl_option} -f -L -o ${name} -u ${username}:${password} ${quoted_source}\"\n     56:       $http_get_cert   = \"curl ${curl_option} -f -L -o ${name} -E ${certificate}:${password} ${quoted_source}\"\n     57:       $ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n     58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n     59:     }\n     60:     'wget': {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-socket_redis-manifests-init.pp", "content": "$statusToken = undef,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-socket_redis-manifests-init.pp\n\nclass socket_redis (\n$version     = 'latest',\n$redisHost   = 'localhost',\n$socketPorts = [8090],\n$statusPort  = '8085',\n6:   $statusToken = undef,\n) {\n\nrequire 'nodejs'\n\nif $redisHost == 'localhost' {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-socket_redis-manifests-init.pp\n# Target line: 6\n\n      1: class socket_redis (\n      2:   $version     = 'latest',\n      3:   $redisHost   = 'localhost',\n      4:   $socketPorts = [8090],\n      5:   $statusPort  = '8085',\n>>>   6:   $statusToken = undef,\n      7: ) {\n      8: \n      9:   require 'nodejs'\n     10: \n     11:   if $redisHost == 'localhost' {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-service_catalog.pp", "content": "'service_catalog/password':            value => $password, secret => true;", "line": 63, "detection_span": [58, 68], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-service_catalog.pp\n\ninclude ::ironic::deps\n\nironic_config {\n'service_catalog/auth_type':           value => $auth_type;\n'service_catalog/username':            value => $username;\n63:     'service_catalog/password':            value => $password, secret => true;\n'service_catalog/auth_url':            value => $auth_url;\n'service_catalog/project_name':        value => $project_name;\n'service_catalog/user_domain_name':    value => $user_domain_name;\n'service_catalog/project_domain_name': value => $project_domain_name;\n'service_catalog/endpoint_override':   value => $endpoint_override;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-service_catalog.pp\n# Target line: 63\n\n     58:   include ::ironic::deps\n     59: \n     60:   ironic_config {\n     61:     'service_catalog/auth_type':           value => $auth_type;\n     62:     'service_catalog/username':            value => $username;\n>>>  63:     'service_catalog/password':            value => $password, secret => true;\n     64:     'service_catalog/auth_url':            value => $auth_url;\n     65:     'service_catalog/project_name':        value => $project_name;\n     66:     'service_catalog/user_domain_name':    value => $user_domain_name;\n     67:     'service_catalog/project_domain_name': value => $project_domain_name;\n     68:     'service_catalog/endpoint_override':   value => $endpoint_override;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-distributed-replicate-example.pp", "content": "fsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n\n\ngluster::brick { 'annex2.example.com:/mnt/storage2a':\ndev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\nlabeltype => 'gpt',\nfstype => 'xfs',\n57: \t\tfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n# Target line: 57\n\n     52: \n     53: \tgluster::brick { 'annex2.example.com:/mnt/storage2a':\n     54: \t\tdev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\n     55: \t\tlabeltype => 'gpt',\n     56: \t\tfstype => 'xfs',\n>>>  57: \t\tfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\n     58: \t\txfs_inode64 => true,\n     59: \t\txfs_nobarrier => true,\n     60: \t\tareyousure => true,\n     61: \t}\n     62: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-mysql.pp", "content": "user     => 'signonotron2',", "line": 82, "detection_span": [77, 87], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-mysql.pp\n\nuser     => 'search_admin',\npassword => 'search_admin',\nrequire  => Class['::mysql::server'];\n\n['signonotron2_test', 'signonotron2_integration_test']:\n82:       user     => 'signonotron2',\npassword => 'signonotron2',\nrequire  => Class['::mysql::server'];\n\n'support_contacts_test':\nuser     => 'support_contacts',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-mysql.pp\n# Target line: 82\n\n     77:       user     => 'search_admin',\n     78:       password => 'search_admin',\n     79:       require  => Class['::mysql::server'];\n     80: \n     81:     ['signonotron2_test', 'signonotron2_integration_test']:\n>>>  82:       user     => 'signonotron2',\n     83:       password => 'signonotron2',\n     84:       require  => Class['::mysql::server'];\n     85: \n     86:     'support_contacts_test':\n     87:       user     => 'support_contacts',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-publishing_api-rabbitmq.pp", "content": "$amqp_user  = 'publishing_api',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-publishing_api-rabbitmq.pp\n\n#\n# [*configure_test_exchange*]\n#   Whether or not to set up a test exchange for development (default: false)\n#\nclass govuk::apps::publishing_api::rabbitmq (\n24:   $amqp_user  = 'publishing_api',\n$amqp_pass  = 'publishing_api',\n$amqp_exchange = 'published_documents',\n$configure_test_exchange = false,\n) {\nrabbitmq_user { $amqp_user:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-publishing_api-rabbitmq.pp\n# Target line: 24\n\n     19: #\n     20: # [*configure_test_exchange*]\n     21: #   Whether or not to set up a test exchange for development (default: false)\n     22: #\n     23: class govuk::apps::publishing_api::rabbitmq (\n>>>  24:   $amqp_user  = 'publishing_api',\n     25:   $amqp_pass  = 'publishing_api',\n     26:   $amqp_exchange = 'published_documents',\n     27:   $configure_test_exchange = false,\n     28: ) {\n     29:   rabbitmq_user { $amqp_user:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_jenkins.pp", "content": "$jenkins_api_token = undef,", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_jenkins.pp\n\n#   A hash of environment variables that should be set for all Jenkins jobs.\n#\nclass govuk::node::s_jenkins (\n$github_client_id = undef,\n$github_client_secret_encrypted = undef,\n22:   $jenkins_api_token = undef,\n$environment_variables = {},\n) inherits govuk::node::s_base {\ninclude google_chrome\ninclude nginx\ninclude govuk_postgresql::client", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_jenkins.pp\n# Target line: 22\n\n     17: #   A hash of environment variables that should be set for all Jenkins jobs.\n     18: #\n     19: class govuk::node::s_jenkins (\n     20:   $github_client_id = undef,\n     21:   $github_client_secret_encrypted = undef,\n>>>  22:   $jenkins_api_token = undef,\n     23:   $environment_variables = {},\n     24: ) inherits govuk::node::s_base {\n     25:   include google_chrome\n     26:   include nginx\n     27:   include govuk_postgresql::client\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$brick2a = {", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n38: $brick2a = {\ndev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\nlabeltype => 'gpt',\nfstype => 'xfs',\nfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\nxfs_inode64 => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 38\n\n     33: \txfs_inode64 => true,\n     34: \txfs_nobarrier => true,\n     35: \tareyousure => true,\n     36: }\n     37: \n>>>  38: $brick2a = {\n     39: \tdev => '/dev/disk/by-id/scsi-36003048007df450014ca27ee19eaec55',\t# /dev/sdc\n     40: \tlabeltype => 'gpt',\n     41: \tfstype => 'xfs',\n     42: \tfsuuid => '2affe5e3-c10d-4d42-a887-cf8993a6c7b5',\n     43: \txfs_inode64 => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp", "content": "$http_username = undef,", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n\n$oauth_secret = '',\n$port = 3111,\n$secret_key_base = undef,\n$publishing_api_bearer_token = undef,\n$asset_manager_bearer_token = undef,\n72:   $http_username = undef,\n$http_password = undef,\n) {\n\ninclude govuk_postgresql::client #installs libpq-dev package needed for pg gem\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n# Target line: 72\n\n     67:   $oauth_secret = '',\n     68:   $port = 3111,\n     69:   $secret_key_base = undef,\n     70:   $publishing_api_bearer_token = undef,\n     71:   $asset_manager_bearer_token = undef,\n>>>  72:   $http_username = undef,\n     73:   $http_password = undef,\n     74: ) {\n     75: \n     76:   include govuk_postgresql::client #installs libpq-dev package needed for pg gem\n     77: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-manifests-init.pp", "content": "$cobbler_user       = 'cobbler',", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-manifests-init.pp\n\n$dhcp_end_address   = '10.0.0.254',\n$dhcp_netmask       = '255.255.255.0',\n$dhcp_gateway       = $ipaddress,\n$dhcp_ipaddress     = '127.0.0.1',\n\n59:   $cobbler_user       = 'cobbler',\n$cobbler_password   = 'cobbler',\n\n$pxetimeout         = '0'\n\n){", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-manifests-init.pp\n# Target line: 59\n\n     54:   $dhcp_end_address   = '10.0.0.254',\n     55:   $dhcp_netmask       = '255.255.255.0',\n     56:   $dhcp_gateway       = $ipaddress,\n     57:   $dhcp_ipaddress     = '127.0.0.1',\n     58: \n>>>  59:   $cobbler_user       = 'cobbler',\n     60:   $cobbler_password   = 'cobbler',\n     61: \n     62:   $pxetimeout         = '0'\n     63: \n     64:   ){\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_publishing_api_db_admin.pp", "content": "$postgres_user        = undef,", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_publishing_api_db_admin.pp\n\n# === Parameters\n#\nclass govuk::node::s_publishing_api_db_admin(\n$backup_s3_bucket     = undef,\n$postgres_host        = undef,\n10:   $postgres_user        = undef,\n$postgres_password    = undef,\n$postgres_port        = '5432',\n$postgres_backup_hour = 7,\n$postgres_backup_min  = 30,\n$apt_mirror_hostname,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_publishing_api_db_admin.pp\n# Target line: 10\n\n      5: # === Parameters\n      6: #\n      7: class govuk::node::s_publishing_api_db_admin(\n      8:   $backup_s3_bucket     = undef,\n      9:   $postgres_host        = undef,\n>>>  10:   $postgres_user        = undef,\n     11:   $postgres_password    = undef,\n     12:   $postgres_port        = '5432',\n     13:   $postgres_backup_hour = 7,\n     14:   $postgres_backup_min  = 30,\n     15:   $apt_mirror_hostname,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_compute.pp", "content": "key => 'vm.max_map_count',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_compute.pp\n\nif ($enable_dpdk) {\nmount { '/hugepages':\nensure => absent,\n} ->\ncontrail::lib::augeas_conf_rm { \"max_map_count_value_removed\":\n38:         key => 'vm.max_map_count',\nconfig_file => '/etc/sysctl.conf',\nlens_to_use => 'properties.lns',\n} ->\nfile_line {'fstab_hugetlbfs':\nensure  => absent,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_compute.pp\n# Target line: 38\n\n     33:     if ($enable_dpdk) {\n     34:       mount { '/hugepages':\n     35:         ensure => absent,\n     36:       } ->\n     37:       contrail::lib::augeas_conf_rm { \"max_map_count_value_removed\":\n>>>  38:         key => 'vm.max_map_count',\n     39:         config_file => '/etc/sysctl.conf',\n     40:         lens_to_use => 'properties.lns',\n     41:       } ->\n     42:       file_line {'fstab_hugetlbfs':\n     43:         ensure  => absent,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-jenkins-manifests-plugin-github.pp", "content": "$username = undef,", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-jenkins-manifests-plugin-github.pp\n\nclass jenkins::plugin::github(\n$oauth_access_token = undef,\n3:   $username = undef,\n$password = undef,\n$api_url = undef\n) {\n\nrequire 'jenkins::plugin::git'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-jenkins-manifests-plugin-github.pp\n# Target line: 3\n\n      1: class jenkins::plugin::github(\n      2:   $oauth_access_token = undef,\n>>>   3:   $username = undef,\n      4:   $password = undef,\n      5:   $api_url = undef\n      6: ) {\n      7: \n      8:   require 'jenkins::plugin::git'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-params.pp", "content": "$ca_bundle_cert_path = '/etc/ssl/certs/ca-bundle.crt'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-params.pp\n\nclass openstack_integration::params {\n\ncase $::osfamily {\n'RedHat': {\n5:       $ca_bundle_cert_path = '/etc/ssl/certs/ca-bundle.crt'\n$cert_path           = '/etc/pki/ca-trust/source/anchors/puppet_openstack.pem'\n$update_ca_certs_cmd = '/usr/bin/update-ca-trust force-enable && /usr/bin/update-ca-trust extract'\n}\n'Debian': {\n$ca_bundle_cert_path = '/etc/ssl/certs/puppet_openstack.pem'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-params.pp\n# Target line: 5\n\n      1: class openstack_integration::params {\n      2: \n      3:   case $::osfamily {\n      4:     'RedHat': {\n>>>   5:       $ca_bundle_cert_path = '/etc/ssl/certs/ca-bundle.crt'\n      6:       $cert_path           = '/etc/pki/ca-trust/source/anchors/puppet_openstack.pem'\n      7:       $update_ca_certs_cmd = '/usr/bin/update-ca-trust force-enable && /usr/bin/update-ca-trust extract'\n      8:     }\n      9:     'Debian': {\n     10:       $ca_bundle_cert_path = '/etc/ssl/certs/puppet_openstack.pem'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-horizon.pp", "content": "horizon_key      => \"/etc/openstack-dashboard/ssl/private/${::fqdn}.pem\",", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-horizon.pp\n\nsecret_key       => 'big_secret',\nallowed_hosts    => $::openstack_integration::config::ip_for_url,\nlisten_ssl       => $::openstack_integration::config::ssl,\nssl_redirect     => $::openstack_integration::config::ssl,\nhorizon_cert     => $::openstack_integration::params::cert_path,\n37:     horizon_key      => \"/etc/openstack-dashboard/ssl/private/${::fqdn}.pem\",\nhorizon_ca       => $::openstack_integration::params::ca_bundle_cert_path,\nkeystone_url     => $::openstack_integration::config::keystone_auth_uri,\nlog_level        => 'DEBUG',\n# need to disable offline compression due to\n# https://bugs.launchpad.net/ubuntu/+source/horizon/+bug/1424042", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-horizon.pp\n# Target line: 37\n\n     32:     secret_key       => 'big_secret',\n     33:     allowed_hosts    => $::openstack_integration::config::ip_for_url,\n     34:     listen_ssl       => $::openstack_integration::config::ssl,\n     35:     ssl_redirect     => $::openstack_integration::config::ssl,\n     36:     horizon_cert     => $::openstack_integration::params::cert_path,\n>>>  37:     horizon_key      => \"/etc/openstack-dashboard/ssl/private/${::fqdn}.pem\",\n     38:     horizon_ca       => $::openstack_integration::params::ca_bundle_cert_path,\n     39:     keystone_url     => $::openstack_integration::config::keystone_auth_uri,\n     40:     log_level        => 'DEBUG',\n     41:     # need to disable offline compression due to\n     42:     # https://bugs.launchpad.net/ubuntu/+source/horizon/+bug/1424042\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_api_mongo.pp", "content": "user       => 'mongodb',", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_api_mongo.pp\n\noutgoing => 27017,\n}\n\nlimits::limits { 'api_mongo_nofile':\nensure     => present,\n16:     user       => 'mongodb',\nlimit_type => 'nofile',\nboth       => 4096,\n}\n\nif ! $::aws_migration {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_api_mongo.pp\n# Target line: 16\n\n     11:     outgoing => 27017,\n     12:   }\n     13: \n     14:   limits::limits { 'api_mongo_nofile':\n     15:     ensure     => present,\n>>>  16:     user       => 'mongodb',\n     17:     limit_type => 'nofile',\n     18:     both       => 4096,\n     19:   }\n     20: \n     21:   if ! $::aws_migration {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp", "content": "key    => 'numberOfItemsPlaceInsideFolder',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n\n}\n\nboxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInsideFolder':\nuser   => $::luser,\ndomain => 'com.naotaka.ClipMenu',\n19:     key    => 'numberOfItemsPlaceInsideFolder',\nvalue  => 20,\n}\n\nboxen::osx_defaults { 'Clipmenu maxMenuItemTitleLength':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n# Target line: 19\n\n     14:   }\n     15: \n     16:   boxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInsideFolder':\n     17:     user   => $::luser,\n     18:     domain => 'com.naotaka.ClipMenu',\n>>>  19:     key    => 'numberOfItemsPlaceInsideFolder',\n     20:     value  => 20,\n     21:   }\n     22: \n     23:   boxen::osx_defaults { 'Clipmenu maxMenuItemTitleLength':\n     24:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ceph@puppet-ceph-manifests-rgw-apache.pp", "content": "$docroot = '/var/www',", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: ceph@puppet-ceph-manifests-rgw-apache.pp\n\n#   http://ceph.com/docs/master/install/install-ceph-gateway/\n#   for more info on repository recommendations.\n#\ndefine ceph::rgw::apache (\n$admin_email = 'root@localhost',\n55:   $docroot = '/var/www',\n$fcgi_file = '/var/www/s3gw.fcgi',\n$rgw_dns_name = $::fqdn,\n$rgw_port = 80,\n$rgw_socket_path = $::ceph::params::rgw_socket_path,\n$syslog = true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: ceph@puppet-ceph-manifests-rgw-apache.pp\n# Target line: 55\n\n     50: #   http://ceph.com/docs/master/install/install-ceph-gateway/\n     51: #   for more info on repository recommendations.\n     52: #\n     53: define ceph::rgw::apache (\n     54:   $admin_email = 'root@localhost',\n>>>  55:   $docroot = '/var/www',\n     56:   $fcgi_file = '/var/www/s3gw.fcgi',\n     57:   $rgw_dns_name = $::fqdn,\n     58:   $rgw_port = 80,\n     59:   $rgw_socket_path = $::ceph::params::rgw_socket_path,\n     60:   $syslog = true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-influxdb-bootstrap.pp", "content": "$influxdb_password = undef,", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n\n#\n# [*influxdb_retention_replication*]\n#   influxdb retention policy replication factor\n#\nclass monasca::influxdb::bootstrap(\n29:   $influxdb_password = undef,\n$influxdb_dbuser_ro_password = undef,\n$influxdb_def_ret_pol_name = 'raw',\n$influxdb_def_ret_pol_duration = '390d',\n$influxdb_tmp_ret_pol_name = 'tmp',\n$influxdb_tmp_ret_pol_duration = '1h',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-influxdb-bootstrap.pp\n# Target line: 29\n\n     24: #\n     25: # [*influxdb_retention_replication*]\n     26: #   influxdb retention policy replication factor\n     27: #\n     28: class monasca::influxdb::bootstrap(\n>>>  29:   $influxdb_password = undef,\n     30:   $influxdb_dbuser_ro_password = undef,\n     31:   $influxdb_def_ret_pol_name = 'raw',\n     32:   $influxdb_def_ret_pol_duration = '390d',\n     33:   $influxdb_tmp_ret_pol_name = 'tmp',\n     34:   $influxdb_tmp_ret_pol_duration = '1h',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp", "content": "key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n\nclass classroom::windows::disable_esc {\nassert_private('This class should not be called directly')\n\n# Disable Internet Explorer ESC for users and admins, both\nregistry::value { 'IE_ESC_users':\n6:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}',\nvalue => 'IsInstalled',\ntype  => dword,\ndata  => '0',\n}\nregistry::value { 'IE_ESC_admin':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n# Target line: 6\n\n      1: class classroom::windows::disable_esc {\n      2:   assert_private('This class should not be called directly')\n      3: \n      4:   # Disable Internet Explorer ESC for users and admins, both\n      5:   registry::value { 'IE_ESC_users':\n>>>   6:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}',\n      7:     value => 'IsInstalled',\n      8:     type  => dword,\n      9:     data  => '0',\n     10:   }\n     11:   registry::value { 'IE_ESC_admin':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-deploy.pp", "content": "$aws_ses_smtp_username = 'UNSET',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::deploy (\n$setup_actionmailer_ses_config = true,\n$actionmailer_enable_delivery = true,\n$aws_ses_smtp_host = 'UNSET',\n6:     $aws_ses_smtp_username = 'UNSET',\n$aws_ses_smtp_password = 'UNSET',\n){\ninclude govuk_harden\ninclude govuk_logging\ninclude govuk_python", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-deploy.pp\n# Target line: 6\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::deploy (\n      3:     $setup_actionmailer_ses_config = true,\n      4:     $actionmailer_enable_delivery = true,\n      5:     $aws_ses_smtp_host = 'UNSET',\n>>>   6:     $aws_ses_smtp_username = 'UNSET',\n      7:     $aws_ses_smtp_password = 'UNSET',\n      8: ){\n      9:   include govuk_harden\n     10:   include govuk_logging\n     11:   include govuk_python\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-gerrit-manifests-mysql.pp", "content": "$database_password = '',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-mysql.pp\n\n#   [*database_password*] - database user password\n#   [*database_user*] - database user name\n#\nclass gerrit::mysql (\n$database_name     = '',\n13:   $database_password = '',\n$database_user     = '',\n) {\n\nclass { '::mysql::server' :}\nclass { '::mysql::client' :}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-mysql.pp\n# Target line: 13\n\n      8: #   [*database_password*] - database user password\n      9: #   [*database_user*] - database user name\n     10: #\n     11: class gerrit::mysql (\n     12:   $database_name     = '',\n>>>  13:   $database_password = '',\n     14:   $database_user     = '',\n     15: ) {\n     16: \n     17:   class { '::mysql::server' :}\n     18:   class { '::mysql::client' :}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-apt-manifests-params.pp", "content": "$root           = '/etc/apt'", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-params.pp\n\nclass apt::params {\n2:   $root           = '/etc/apt'\n$provider       = '/usr/bin/apt-get'\n$sources_list_d = \"${root}/sources.list.d\"\n$apt_conf_d     = \"${root}/apt.conf.d\"\n$preferences_d  = \"${root}/preferences.d\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-params.pp\n# Target line: 2\n\n      1: class apt::params {\n>>>   2:   $root           = '/etc/apt'\n      3:   $provider       = '/usr/bin/apt-get'\n      4:   $sources_list_d = \"${root}/sources.list.d\"\n      5:   $apt_conf_d     = \"${root}/apt.conf.d\"\n      6:   $preferences_d  = \"${root}/preferences.d\"\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp", "content": "$username = 'lpupdatebug',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n\n$port = '29418',\n$projects = [],\n$sshprivkey = '/etc/lpupdatebug/lpupdatebug.key',\n$sshprivkey_contents = undef,\n$update_status = 'yes',\n43:   $username = 'lpupdatebug',\n) {\n\nensure_packages([$package_name])\n\nif ($sshprivkey_contents)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n# Target line: 43\n\n     38:   $port = '29418',\n     39:   $projects = [],\n     40:   $sshprivkey = '/etc/lpupdatebug/lpupdatebug.key',\n     41:   $sshprivkey_contents = undef,\n     42:   $update_status = 'yes',\n>>>  43:   $username = 'lpupdatebug',\n     44: ) {\n     45: \n     46:   ensure_packages([$package_name])\n     47: \n     48:   if ($sshprivkey_contents)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp", "content": "password => 'contacts',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n\npassword => 'collections_publisher',\nrequire  => Class['::mysql::server'];\n\n'contacts_test':\nuser     => 'contacts',\n25:       password => 'contacts',\nrequire  => Class['::mysql::server'];\n\n'content_planner_test':\nuser     => 'content_planner',\npassword => 'content_planner',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-mysql.pp\n# Target line: 25\n\n     20:       password => 'collections_publisher',\n     21:       require  => Class['::mysql::server'];\n     22: \n     23:     'contacts_test':\n     24:       user     => 'contacts',\n>>>  25:       password => 'contacts',\n     26:       require  => Class['::mysql::server'];\n     27: \n     28:     'content_planner_test':\n     29:       user     => 'content_planner',\n     30:       password => 'content_planner',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp", "content": "$slave_user = 'slave',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n\n$ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n$legacy_vhost = undef,\n$legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n$legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n30:   $slave_user = 'slave',\n$jenkins_home\n) {\nvalidate_string($github_enterprise_cert, $vhost, $jenkins_home)\n\napt::source { 'govuk-jenkins':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n# Target line: 30\n\n     25:   $ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     26:   $ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n     27:   $legacy_vhost = undef,\n     28:   $legacy_vhost_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem',\n     29:   $legacy_vhost_ssl_key = '/etc/ssl/private/ssl-cert-snakeoil.key',\n>>>  30:   $slave_user = 'slave',\n     31:   $jenkins_home\n     32: ) {\n     33:   validate_string($github_enterprise_cert, $vhost, $jenkins_home)\n     34: \n     35:   apt::source { 'govuk-jenkins':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-mistral.pp", "content": "password => 'mistral',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n\nadmin_url    => \"${::openstack_integration::config::base_url}:8989/v2\",\ninternal_url => \"${::openstack_integration::config::base_url}:8989/v2\",\npassword     => 'a_big_secret',\n}\nclass { '::mistral::db::mysql':\n43:     password => 'mistral',\n}\nclass { '::mistral::api':\nservice_name => 'httpd',\n}\ninclude ::apache", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-mistral.pp\n# Target line: 43\n\n     38:     admin_url    => \"${::openstack_integration::config::base_url}:8989/v2\",\n     39:     internal_url => \"${::openstack_integration::config::base_url}:8989/v2\",\n     40:     password     => 'a_big_secret',\n     41:   }\n     42:   class { '::mistral::db::mysql':\n>>>  43:     password => 'mistral',\n     44:   }\n     45:   class { '::mistral::api':\n     46:     service_name => 'httpd',\n     47:   }\n     48:   include ::apache\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp", "content": "key    => 'ShowDevelopMenu',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n\nclass people::felho::application_settings::twitter {\nboxen::osx_defaults { 'Enable the hidden \\'Develop\\' menu':\nuser   => $::luser,\ndomain => 'com.twitter.twitter-mac',\n5:     key    => 'ShowDevelopMenu',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Open links in the background':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n# Target line: 5\n\n      1: class people::felho::application_settings::twitter {\n      2:   boxen::osx_defaults { 'Enable the hidden \\'Develop\\' menu':\n      3:     user   => $::luser,\n      4:     domain => 'com.twitter.twitter-mac',\n>>>   5:     key    => 'ShowDevelopMenu',\n      6:     type   => 'bool',\n      7:     value  => true,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Open links in the background':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-pp_postgres-manifests-db.pp", "content": "password => postgresql_password($title, $password),", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-db.pp\n\ndefine pp_postgres::db(\n$password\n) {\npostgresql::server::db { $title:\nuser     => $title,\n6:     password => postgresql_password($title, $password),\n}\n\npp_postgres::hba_rule { $title:\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-pp_postgres-manifests-db.pp\n# Target line: 6\n\n      1: define pp_postgres::db(\n      2:   $password\n      3: ) {\n      4:   postgresql::server::db { $title:\n      5:     user     => $title,\n>>>   6:     password => postgresql_password($title, $password),\n      7:   }\n      8: \n      9:   pp_postgres::hba_rule { $title:\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-server-notifications.pp", "content": "'nova/password':            value => $password, secret => true;", "line": 117, "detection_span": [112, 122], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-server-notifications.pp\n\n112:   }\n113:\n114:   neutron_config {\n'nova/auth_url':            value => $auth_url;\n'nova/username':            value => $username;\n117:     'nova/password':            value => $password, secret => true;\n'nova/project_domain_id':   value => $project_domain_id;\n'nova/project_domain_name': value => $project_domain_name;\n'nova/project_name':        value => $project_name;\n'nova/user_domain_id':      value => $user_domain_id;\n'nova/user_domain_name':    value => $user_domain_name;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-server-notifications.pp\n# Target line: 117\n\n    112:   }\n    113: \n    114:   neutron_config {\n    115:     'nova/auth_url':            value => $auth_url;\n    116:     'nova/username':            value => $username;\n>>> 117:     'nova/password':            value => $password, secret => true;\n    118:     'nova/project_domain_id':   value => $project_domain_id;\n    119:     'nova/project_domain_name': value => $project_domain_name;\n    120:     'nova/project_name':        value => $project_name;\n    121:     'nova/user_domain_id':      value => $user_domain_id;\n    122:     'nova/user_domain_name':    value => $user_domain_name;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "attachmentgenie@attachmentgenie-ssh-manifests-params.pp", "content": "$permit_root_login               = 'no'", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: attachmentgenie@attachmentgenie-ssh-manifests-params.pp\n\n$max_sessions                    = 10\n$max_startups                    = '10:30:100'\n$password_authentication_groups  = []\n$password_authentication_users   = []\n$password_authentication         = 'no'\n38:   $permit_root_login               = 'no'\n$permit_tunnel                   = 'no'\n$permit_tty_users                = {}\n$permit_user_environment         = 'no'\n$port                            = '22'\n$print_motd                      = 'no'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: attachmentgenie@attachmentgenie-ssh-manifests-params.pp\n# Target line: 38\n\n     33:   $max_sessions                    = 10\n     34:   $max_startups                    = '10:30:100'\n     35:   $password_authentication_groups  = []\n     36:   $password_authentication_users   = []\n     37:   $password_authentication         = 'no'\n>>>  38:   $permit_root_login               = 'no'\n     39:   $permit_tunnel                   = 'no'\n     40:   $permit_tty_users                = {}\n     41:   $permit_user_environment         = 'no'\n     42:   $port                            = '22'\n     43:   $print_motd                      = 'no'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-dev@devstack-vagrant-puppet-modules-user-manifests-vagrant.pp", "content": "$username = 'vagrant'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-vagrant.pp\n\n# == Class: user::vagrant\n#\n\nclass user::vagrant(\n5:   $username = 'vagrant'\n)\n{\nfile {\"/home/${username}/.bashrc\":\nowner => $username,\ngroup => $username,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-dev@devstack-vagrant-puppet-modules-user-manifests-vagrant.pp\n# Target line: 5\n\n      1: # == Class: user::vagrant\n      2: #\n      3: \n      4: class user::vagrant(\n>>>   5:   $username = 'vagrant'\n      6: )\n      7: {\n      8:   file {\"/home/${username}/.bashrc\":\n      9:     owner => $username,\n     10:     group => $username,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_ci-manifests-limits.pp", "content": "user       => 'jenkins',", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-limits.pp\n\nboth       => 8192,\n}\n\nlimits::limits { 'jenkins_nproc':\nensure     => present,\n15:     user       => 'jenkins',\nlimit_type => 'nproc',\nboth       => 30654,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-limits.pp\n# Target line: 15\n\n     10:     both       => 8192,\n     11:   }\n     12: \n     13:   limits::limits { 'jenkins_nproc':\n     14:     ensure     => present,\n>>>  15:     user       => 'jenkins',\n     16:     limit_type => 'nproc',\n     17:     both       => 30654,\n     18:   }\n     19: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-tor-manifests-onionbalance.pp", "content": "$instance_user = '_tor-onionbalance'", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: duritong@puppet-tor-manifests-onionbalance.pp\n\n\ncase $facts['osfamily'] {\n'Debian': {\n$pkg_name = 'onionbalance'\n$instance_file = '/etc/tor/instances/onionbalance/torrc'\n24:       $instance_user = '_tor-onionbalance'\nexec{'/usr/sbin/tor-instance-create onionbalance':\ncreates => '/etc/tor/instances/onionbalance',\nrequire => Package['tor'],\nbefore  => File[$instance_file],\n} -> augeas{\"manage_onionbalance_in_group_${instance_user}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-tor-manifests-onionbalance.pp\n# Target line: 24\n\n     19: \n     20:   case $facts['osfamily'] {\n     21:     'Debian': {\n     22:       $pkg_name = 'onionbalance'\n     23:       $instance_file = '/etc/tor/instances/onionbalance/torrc'\n>>>  24:       $instance_user = '_tor-onionbalance'\n     25:       exec{'/usr/sbin/tor-instance-create onionbalance':\n     26:         creates => '/etc/tor/instances/onionbalance',\n     27:         require => Package['tor'],\n     28:         before  => File[$instance_file],\n     29:       } -> augeas{\"manage_onionbalance_in_group_${instance_user}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp", "content": "$default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'", "line": 93, "detection_span": [88, 98], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n\n$logroot          = '/var/log/apache2'\n$lib_path         = '/usr/lib/apache2/modules'\n$mpm_module       = 'worker'\n$dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n$default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n93:     $default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n$ssl_certs_dir    = '/etc/ssl/certs'\n$passenger_root   = '/usr'\n$passenger_ruby   = '/usr/bin/ruby'\n$mod_packages     = {\n'auth_kerb'  => 'libapache2-mod-auth-kerb',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-apache-manifests-params.pp\n# Target line: 93\n\n     88:     $logroot          = '/var/log/apache2'\n     89:     $lib_path         = '/usr/lib/apache2/modules'\n     90:     $mpm_module       = 'worker'\n     91:     $dev_packages     = ['libaprutil1-dev', 'libapr1-dev', 'apache2-prefork-dev']\n     92:     $default_ssl_cert = '/etc/ssl/certs/ssl-cert-snakeoil.pem'\n>>>  93:     $default_ssl_key  = '/etc/ssl/private/ssl-cert-snakeoil.key'\n     94:     $ssl_certs_dir    = '/etc/ssl/certs'\n     95:     $passenger_root   = '/usr'\n     96:     $passenger_ruby   = '/usr/bin/ruby'\n     97:     $mod_packages     = {\n     98:       'auth_kerb'  => 'libapache2-mod-auth-kerb',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-ml2-fujitsu-fossw.pp", "content": "'fujitsu_fossw/password'               : value => $password, secret => true;", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-fujitsu-fossw.pp\n\nrequire ::neutron::plugins::ml2\n\nneutron_plugin_ml2 {\n'fujitsu_fossw/fossw_ips'              : value => join(any2array($fossw_ips), ',');\n'fujitsu_fossw/username'               : value => $username;\n65:     'fujitsu_fossw/password'               : value => $password, secret => true;\n'fujitsu_fossw/port'                   : value => $port;\n'fujitsu_fossw/timeout'                : value => $timeout;\n'fujitsu_fossw/udp_dest_port'          : value => $udp_dest_port;\n'fujitsu_fossw/ovsdb_vlanid_range_min' : value => $ovsdb_vlanid_range_min;\n'fujitsu_fossw/ovsdb_port'             : value => $ovsdb_port;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-ml2-fujitsu-fossw.pp\n# Target line: 65\n\n     60:   require ::neutron::plugins::ml2\n     61: \n     62:   neutron_plugin_ml2 {\n     63:     'fujitsu_fossw/fossw_ips'              : value => join(any2array($fossw_ips), ',');\n     64:     'fujitsu_fossw/username'               : value => $username;\n>>>  65:     'fujitsu_fossw/password'               : value => $password, secret => true;\n     66:     'fujitsu_fossw/port'                   : value => $port;\n     67:     'fujitsu_fossw/timeout'                : value => $timeout;\n     68:     'fujitsu_fossw/udp_dest_port'          : value => $udp_dest_port;\n     69:     'fujitsu_fossw/ovsdb_vlanid_range_min' : value => $ovsdb_vlanid_range_min;\n     70:     'fujitsu_fossw/ovsdb_port'             : value => $ovsdb_port;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-aide-cron.pp", "content": "$aide_cron_user = hiera('aide_cron_user', 'root'),", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aide-cron.pp\n\n#   Defaults to mailx\n#\nclass tripleo::profile::base::aide::cron (\n$step           = Integer(hiera('step')),\n$aide_command   = '/usr/sbin/aide',\n53:   $aide_cron_user = hiera('aide_cron_user', 'root'),\n$aide_hour      = hiera('aide_hour', 3),\n$aide_minute    = hiera('aide_minute', 0),\n$aide_email     = hiera('aide_email', undef),\n$aide_mua_path  = hiera('aide_mua_path', '/bin/mailx')\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aide-cron.pp\n# Target line: 53\n\n     48: #   Defaults to mailx\n     49: #\n     50: class tripleo::profile::base::aide::cron (\n     51:   $step           = Integer(hiera('step')),\n     52:   $aide_command   = '/usr/sbin/aide',\n>>>  53:   $aide_cron_user = hiera('aide_cron_user', 'root'),\n     54:   $aide_hour      = hiera('aide_hour', 3),\n     55:   $aide_minute    = hiera('aide_minute', 0),\n     56:   $aide_email     = hiera('aide_email', undef),\n     57:   $aide_mua_path  = hiera('aide_mua_path', '/bin/mailx')\n     58:   ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-ceilometer.pp", "content": "auth_password => hiera('CONFIG_CEILOMETER_KS_PW'),", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-ceilometer.pp\n\nevent_pipeline_publishers => [\"gnocchi://\", \"panko://\"],\n}\n\nclass { '::ceilometer::agent::auth':\nauth_url      => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\n48:       auth_password => hiera('CONFIG_CEILOMETER_KS_PW'),\nauth_region   => hiera('CONFIG_KEYSTONE_REGION'),\n}\n\nclass { '::ceilometer::agent::central':\ncoordination_url => $coordination_url,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-ceilometer.pp\n# Target line: 48\n\n     43:       event_pipeline_publishers => [\"gnocchi://\", \"panko://\"],\n     44:     }\n     45: \n     46:     class { '::ceilometer::agent::auth':\n     47:       auth_url      => hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS'),\n>>>  48:       auth_password => hiera('CONFIG_CEILOMETER_KS_PW'),\n     49:       auth_region   => hiera('CONFIG_KEYSTONE_REGION'),\n     50:     }\n     51: \n     52:     class { '::ceilometer::agent::central':\n     53:       coordination_url => $coordination_url,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "key    => 'ShowPercent',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\nclass people::felho::osx_settings::miscellaneous {\n# Please note that this feature was removed in Lion\nboxen::osx_defaults { 'Show remaining battery percentage':\nuser   => $::luser,\ndomain => 'com.apple.menuextra.battery',\n6:     key    => 'ShowPercent',\ntype   => 'string',\nvalue  => 'YES',\n}\n\nboxen::osx_defaults { 'Expand save panel by default':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 6\n\n      1: class people::felho::osx_settings::miscellaneous {\n      2:   # Please note that this feature was removed in Lion\n      3:   boxen::osx_defaults { 'Show remaining battery percentage':\n      4:     user   => $::luser,\n      5:     domain => 'com.apple.menuextra.battery',\n>>>   6:     key    => 'ShowPercent',\n      7:     type   => 'string',\n      8:     value  => 'YES',\n      9:   }\n     10: \n     11:   boxen::osx_defaults { 'Expand save panel by default':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_multigesture.pp", "content": "key    => 'TrackpadThreeFingerTapGesture',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_multigesture.pp\n\n}\n\nboxen::osx_defaults { 'Enable Lookup with Tree Fingers on Trackpad':\nuser   => $::luser,\ndomain => 'com.apple.driver.AppleBluetoothMultitouch.trackpad',\n26:     key    => 'TrackpadThreeFingerTapGesture',\ntype   => 'int',\nvalue  => 2,\n}\n\nboxen::osx_defaults { 'Enable Notification Center on Trackpad':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-osx_config-manifests-trackpad-enable_multigesture.pp\n# Target line: 26\n\n     21:   }\n     22: \n     23:   boxen::osx_defaults { 'Enable Lookup with Tree Fingers on Trackpad':\n     24:     user   => $::luser,\n     25:     domain => 'com.apple.driver.AppleBluetoothMultitouch.trackpad',\n>>>  26:     key    => 'TrackpadThreeFingerTapGesture',\n     27:     type   => 'int',\n     28:     value  => 2,\n     29:   }\n     30: \n     31:   boxen::osx_defaults { 'Enable Notification Center on Trackpad':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-params.pp", "content": "$user                = pick($user, 'mongodb')", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-params.pp\n\n$bind_ip     = pick($bind_ip, ['127.0.0.1'])\n$fork        = true\n} else {\n# RedHat/CentOS doesn't come with a prepacked mongodb\n# so we assume that you are using EPEL repository.\n31:         $user                = pick($user, 'mongodb')\n$group               = pick($group, 'mongodb')\n$server_package_name = pick($server_package_name, 'mongodb-server')\n$client_package_name = pick($client_package_name, 'mongodb')\n\n$service_name        = pick($service_name, 'mongod')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-mongodb-manifests-params.pp\n# Target line: 31\n\n     26:         $bind_ip     = pick($bind_ip, ['127.0.0.1'])\n     27:         $fork        = true\n     28:       } else {\n     29:         # RedHat/CentOS doesn't come with a prepacked mongodb\n     30:         # so we assume that you are using EPEL repository.\n>>>  31:         $user                = pick($user, 'mongodb')\n     32:         $group               = pick($group, 'mongodb')\n     33:         $server_package_name = pick($server_package_name, 'mongodb-server')\n     34:         $client_package_name = pick($client_package_name, 'mongodb')\n     35: \n     36:         $service_name        = pick($service_name, 'mongod')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-vmdk.pp", "content": "set_key   => 'volume_backend_name',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-vmdk.pp\n\nhost_username => hiera('CONFIG_VCENTER_USER'),\nhost_password => hiera('CONFIG_VCENTER_PASSWORD'),\n}\n\ncinder::type { 'vmdk':\n10:       set_key   => 'volume_backend_name',\nset_value => 'vmdk',\nrequire   => Class['cinder::api'],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-vmdk.pp\n# Target line: 10\n\n      5:       host_username => hiera('CONFIG_VCENTER_USER'),\n      6:       host_password => hiera('CONFIG_VCENTER_PASSWORD'),\n      7:     }\n      8: \n      9:     cinder::type { 'vmdk':\n>>>  10:       set_key   => 'volume_backend_name',\n     11:       set_value => 'vmdk',\n     12:       require   => Class['cinder::api'],\n     13:     }\n     14: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp", "content": "$asset_manager_bearer_token = undef,", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n\n$oauth_id = '',\n$oauth_secret = '',\n$port = 3111,\n$secret_key_base = undef,\n$publishing_api_bearer_token = undef,\n71:   $asset_manager_bearer_token = undef,\n$http_username = undef,\n$http_password = undef,\n) {\n\ninclude govuk_postgresql::client #installs libpq-dev package needed for pg gem", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-service_manual_publisher.pp\n# Target line: 71\n\n     66:   $oauth_id = '',\n     67:   $oauth_secret = '',\n     68:   $port = 3111,\n     69:   $secret_key_base = undef,\n     70:   $publishing_api_bearer_token = undef,\n>>>  71:   $asset_manager_bearer_token = undef,\n     72:   $http_username = undef,\n     73:   $http_password = undef,\n     74: ) {\n     75: \n     76:   include govuk_postgresql::client #installs libpq-dev package needed for pg gem\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-authenticating_proxy.pp", "content": "$jwt_auth_secret = undef,", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-authenticating_proxy.pp\n\n$sentry_dsn = undef,\n$govuk_upstream_uri = 'http://localhost:3054',\n$oauth_id = undef,\n$oauth_secret = undef,\n$secret_key_base = undef,\n54:   $jwt_auth_secret = undef,\n$signon_uri_scheme = 'https',\n) {\n$app_name = 'authenticating-proxy'\n\ngovuk::app::envvar::mongodb_uri { $app_name:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-authenticating_proxy.pp\n# Target line: 54\n\n     49:   $sentry_dsn = undef,\n     50:   $govuk_upstream_uri = 'http://localhost:3054',\n     51:   $oauth_id = undef,\n     52:   $oauth_secret = undef,\n     53:   $secret_key_base = undef,\n>>>  54:   $jwt_auth_secret = undef,\n     55:   $signon_uri_scheme = 'https',\n     56: ) {\n     57:   $app_name = 'authenticating-proxy'\n     58: \n     59:   govuk::app::envvar::mongodb_uri { $app_name:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-finder-show_removable_media_on_desktop.pp", "content": "key    => 'ShowRemovableMediaOnDesktop',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: boxen@puppet-osx-manifests-finder-show_removable_media_on_desktop.pp\n\ninclude osx::finder\n\nboxen::osx_defaults { 'Show mounted media on the desktop':\nuser   => $::boxen_user,\ndomain => 'com.apple.finder',\n8:     key    => 'ShowRemovableMediaOnDesktop',\nvalue  => true,\nnotify => Exec['killall Finder'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-finder-show_removable_media_on_desktop.pp\n# Target line: 8\n\n      3:   include osx::finder\n      4: \n      5:   boxen::osx_defaults { 'Show mounted media on the desktop':\n      6:     user   => $::boxen_user,\n      7:     domain => 'com.apple.finder',\n>>>   8:     key    => 'ShowRemovableMediaOnDesktop',\n      9:     value  => true,\n     10:     notify => Exec['killall Finder'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-gerrit-manifests-cron.pp", "content": "user   => 'gerrit',", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-cron.pp\n\nuser   => 'gerrit',\n}\n\ncron { 'removedbdumps':\nensure => 'absent',\n23:     user   => 'gerrit',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-gerrit-manifests-cron.pp\n# Target line: 23\n\n     18:     user   => 'gerrit',\n     19:   }\n     20: \n     21:   cron { 'removedbdumps':\n     22:     ensure => 'absent',\n>>>  23:     user   => 'gerrit',\n     24:   }\n     25: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-etherpad_lite-manifests-webapp.pp", "content": "$ssl_certificate          = '/etc/ssl/certs/etherpad.crt',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-etherpad_lite-manifests-webapp.pp\n\n$nginx_error_log          = '/var/log/nginx/error.log',\n$nginx_log_format         = undef,\n$nginx_proxy_pass         = 'http://127.0.0.1:9001',\n$nginx_server_name        = $::fqdn,\n$packages                 = ['etherpad-lite'],\n45:   $ssl_certificate          = '/etc/ssl/certs/etherpad.crt',\n$ssl_key                  = '/etc/ssl/private/etherpad.key',\n) {\n$config = hiera_hash('etherpad_lite::webapp::config', {})\n$files = hiera_hash('etherpad_lite::webapp::files', {})\nensure_packages($packages)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-etherpad_lite-manifests-webapp.pp\n# Target line: 45\n\n     40:   $nginx_error_log          = '/var/log/nginx/error.log',\n     41:   $nginx_log_format         = undef,\n     42:   $nginx_proxy_pass         = 'http://127.0.0.1:9001',\n     43:   $nginx_server_name        = $::fqdn,\n     44:   $packages                 = ['etherpad-lite'],\n>>>  45:   $ssl_certificate          = '/etc/ssl/certs/etherpad.crt',\n     46:   $ssl_key                  = '/etc/ssl/private/etherpad.key',\n     47: ) {\n     48:   $config = hiera_hash('etherpad_lite::webapp::config', {})\n     49:   $files = hiera_hash('etherpad_lite::webapp::files', {})\n     50:   ensure_packages($packages)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "quintel@boxen-modules-nodejs-manifests-params.pp", "content": "$nodenv_root = '/usr/local/share/nodenv'", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: quintel@boxen-modules-nodejs-manifests-params.pp\n\n$nodenv_root = \"${boxen::config::home}/nodenv\"\n}\n\ndefault: {\n$nodenv_user = 'root'\n14:       $nodenv_root = '/usr/local/share/nodenv'\n}\n}\n\n$nodenv_version = 'v0.3.3'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-nodejs-manifests-params.pp\n# Target line: 14\n\n      9:       $nodenv_root = \"${boxen::config::home}/nodenv\"\n     10:     }\n     11: \n     12:     default: {\n     13:       $nodenv_user = 'root'\n>>>  14:       $nodenv_root = '/usr/local/share/nodenv'\n     15:     }\n     16:   }\n     17: \n     18:   $nodenv_version = 'v0.3.3'\n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_cinder-db.pp", "content": "$db_password = pick($cinder_hash['db_password'], $mysql_root_password)", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_cinder-db.pp\n\n$mysql_db_create     = pick($mysql_hash['db_create'], true)\n$mysql_root_password = $mysql_hash['root_password']\n\n$db_user     = pick($cinder_hash['db_user'], 'cinder')\n$db_name     = pick($cinder_hash['db_name'], 'cinder')\n16:   $db_password = pick($cinder_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($cinder_hash['db_host'], $database_vip)\n$db_create        = pick($cinder_hash['db_create'], $mysql_db_create)\n$db_root_user     = pick($cinder_hash['root_user'], $mysql_root_user)\n$db_root_password = pick($cinder_hash['root_password'], $mysql_root_password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_cinder-db.pp\n# Target line: 16\n\n     11:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     12:   $mysql_root_password = $mysql_hash['root_password']\n     13: \n     14:   $db_user     = pick($cinder_hash['db_user'], 'cinder')\n     15:   $db_name     = pick($cinder_hash['db_name'], 'cinder')\n>>>  16:   $db_password = pick($cinder_hash['db_password'], $mysql_root_password)\n     17: \n     18:   $db_host          = pick($cinder_hash['db_host'], $database_vip)\n     19:   $db_create        = pick($cinder_hash['db_create'], $mysql_db_create)\n     20:   $db_root_user     = pick($cinder_hash['root_user'], $mysql_root_user)\n     21:   $db_root_password = pick($cinder_hash['root_password'], $mysql_root_password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-openssl-manifests-certificate.pp", "content": "define openssl::certificate($user='root', $group='root'){", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-openssl-manifests-certificate.pp\n\n# Create a ssl certificate at the location specified by the name\n# (a '.crt' extension will be appended to the filename).\n3: define openssl::certificate($user='root', $group='root'){\nopenssl::key{$name:\nuser  => $user,\ngroup => $group\n}\nexec{\"create_${name}_certificate\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-openssl-manifests-certificate.pp\n# Target line: 3\n\n      1: # Create a ssl certificate at the location specified by the name\n      2: # (a '.crt' extension will be appended to the filename).\n>>>   3: define openssl::certificate($user='root', $group='root'){\n      4:   openssl::key{$name:\n      5:      user  => $user,\n      6:      group => $group \n      7:   }\n      8:   exec{\"create_${name}_certificate\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache_api_proxy.pp", "content": "docroot          => '/var/www/html',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache_api_proxy.pp\n\ninclude ::apache::mod::reqtimeout\n\n$apache_api_proxy_address = hiera('apache_api_proxy_address', '0.0.0.0')\n\napache::vhost { 'apache_api_proxy':\n40:     docroot          => '/var/www/html',\ncustom_fragment  => template('osnailyfacter/api_proxy.conf.erb'),\nport             => '8888',\nip               => $apache_api_proxy_address,\nadd_listen       => false,\nerror_log_syslog => 'syslog:local0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache_api_proxy.pp\n# Target line: 40\n\n     35:   include ::apache::mod::reqtimeout\n     36: \n     37:   $apache_api_proxy_address = hiera('apache_api_proxy_address', '0.0.0.0')\n     38: \n     39:   apache::vhost { 'apache_api_proxy':\n>>>  40:     docroot          => '/var/www/html',\n     41:     custom_fragment  => template('osnailyfacter/api_proxy.conf.erb'),\n     42:     port             => '8888',\n     43:     ip               => $apache_api_proxy_address,\n     44:     add_listen       => false,\n     45:     error_log_syslog => 'syslog:local0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-server_nova.pp", "content": "$admin_password            = dig44($neutron_config, ['keystone', 'admin_password'])", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-server_nova.pp\n\n\n$neutron_config            = hiera_hash('neutron_config')\n$management_vip            = hiera('management_vip')\n$service_endpoint          = hiera('service_endpoint', $management_vip)\n$neutron_endpoint          = hiera('neutron_endpoint', $management_vip)\n9:   $admin_password            = dig44($neutron_config, ['keystone', 'admin_password'])\n$admin_tenant_name         = dig44($neutron_config, ['keystone', 'admin_tenant'], 'services')\n$admin_username            = dig44($neutron_config, ['keystone', 'admin_user'], 'neutron')\n$region_name               = hiera('region', 'RegionOne')\n$auth_api_version          = 'v3'\n$ssl_hash                  = hiera_hash('use_ssl', {})", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-server_nova.pp\n# Target line: 9\n\n      4: \n      5:   $neutron_config            = hiera_hash('neutron_config')\n      6:   $management_vip            = hiera('management_vip')\n      7:   $service_endpoint          = hiera('service_endpoint', $management_vip)\n      8:   $neutron_endpoint          = hiera('neutron_endpoint', $management_vip)\n>>>   9:   $admin_password            = dig44($neutron_config, ['keystone', 'admin_password'])\n     10:   $admin_tenant_name         = dig44($neutron_config, ['keystone', 'admin_tenant'], 'services')\n     11:   $admin_username            = dig44($neutron_config, ['keystone', 'admin_user'], 'neutron')\n     12:   $region_name               = hiera('region', 'RegionOne')\n     13:   $auth_api_version          = 'v3'\n     14:   $ssl_hash                  = hiera_hash('use_ssl', {})\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "KrisBuytaert@puppet-graphite-manifests-params.pp", "content": "$carbon_ampq_user                          = 'guest',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n\n$aggregator_pickle_receiver_port           = '2014',\n$aggregator_replication_factor             = '1',\n$aggregator_use_flow_control               = 'True',\n$aggregator_use_whitelist                  = 'False',\n$aggregator_user                           = 'carbon',\n51:   $carbon_ampq_user                          = 'guest',\n$carbon_amqp_exchange                      = 'graphite',\n$carbon_amqp_host                          = 'localhost',\n$carbon_amqp_password                      = 'guest',\n$carbon_amqp_port                          = '5672',\n$carbon_amqp_verbose                       = 'False',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n# Target line: 51\n\n     46:   $aggregator_pickle_receiver_port           = '2014',\n     47:   $aggregator_replication_factor             = '1',\n     48:   $aggregator_use_flow_control               = 'True',\n     49:   $aggregator_use_whitelist                  = 'False',\n     50:   $aggregator_user                           = 'carbon',\n>>>  51:   $carbon_ampq_user                          = 'guest',\n     52:   $carbon_amqp_exchange                      = 'graphite',\n     53:   $carbon_amqp_host                          = 'localhost',\n     54:   $carbon_amqp_password                      = 'guest',\n     55:   $carbon_amqp_port                          = '5672',\n     56:   $carbon_amqp_verbose                       = 'False',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-thomasleese.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsFqOid5M3C4r4pqJOSF27LphXyGaVjRMVT6UWSi7VayzI6IaJRn4RsBq1A9fd/aXKySimAFGzEEx6sFBV/uU0b/jPDLZxk406wDjsAQc2nBhUR1eahsvkHCLJZzdcWEpqOgxQ+hzewRPLYBBmrd6PrzJOia3ieN/tkw8E1pAc9vmlQNavwx+1QPLHAY1DEtT6muTuOkfnfMJj6Z1o9y2/ZF/nSiu3g8gR1mgEK50xAhHlQ5lWc98GamZIQTRqd2fgbAN5d/bBH3f2m/UXCRL6S4ZLgpjsqzVO/84iG35iOXHI4hpL5w2Vr5ciaWGSDFDzMR8W/A/aNQLkyOWmltbvzo+3lmd+vwTbVAlIyHfMzxt9BYiCNMYxyk08J/3E+1W9+7RaniG103mup1UVllR0W32pZFYgvptwHIsVRPyS6kRbcyOKw4EXMY3RDV4cLXrA2WTKQaX1mr8iPDA3zYRiqs5Nc07yRPVWcFVZmS/IiMMf5uMUVsdA8PLxWpOM+P/quJkpJNHFsCwI4sG5xXlhne3gmr+HhbeYVf6jPcnRyqQ0/+SqoitafEP5ssEtRUZ0sKLIXO73HAzZrmxLZt2AhO1md1+RweNpbL6jt3aIaYaffV2hvpXo1Cd5V331Gx2yLODqRCceUjZP9Dg03zvIqewC0yD7u+/39qoPd6uNRw== thomas.leese@digital.cabinetoffice.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-thomasleese.pp\n\n# Creates the thomasleese user\nclass users::thomasleese {\ngovuk_user { 'thomasleese':\nfullname => 'Thomas Leese',\nemail    => 'thomas.leese@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsFqOid5M3C4r4pqJOSF27LphXyGaVjRMVT6UWSi7VayzI6IaJRn4RsBq1A9fd/aXKySimAFGzEEx6sFBV/uU0b/jPDLZxk406wDjsAQc2nBhUR1eahsvkHCLJZzdcWEpqOgxQ+hzewRPLYBBmrd6PrzJOia3ieN/tkw8E1pAc9vmlQNavwx+1QPLHAY1DEtT6muTuOkfnfMJj6Z1o9y2/ZF/nSiu3g8gR1mgEK50xAhHlQ5lWc98GamZIQTRqd2fgbAN5d/bBH3f2m/UXCRL6S4ZLgpjsqzVO/84iG35iOXHI4hpL5w2Vr5ciaWGSDFDzMR8W/A/aNQLkyOWmltbvzo+3lmd+vwTbVAlIyHfMzxt9BYiCNMYxyk08J/3E+1W9+7RaniG103mup1UVllR0W32pZFYgvptwHIsVRPyS6kRbcyOKw4EXMY3RDV4cLXrA2WTKQaX1mr8iPDA3zYRiqs5Nc07yRPVWcFVZmS/IiMMf5uMUVsdA8PLxWpOM+P/quJkpJNHFsCwI4sG5xXlhne3gmr+HhbeYVf6jPcnRyqQ0/+SqoitafEP5ssEtRUZ0sKLIXO73HAzZrmxLZt2AhO1md1+RweNpbL6jt3aIaYaffV2hvpXo1Cd5V331Gx2yLODqRCceUjZP9Dg03zvIqewC0yD7u+/39qoPd6uNRw== thomas.leese@digital.cabinetoffice.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-thomasleese.pp\n# Target line: 6\n\n      1: # Creates the thomasleese user\n      2: class users::thomasleese {\n      3:   govuk_user { 'thomasleese':\n      4:     fullname => 'Thomas Leese',\n      5:     email    => 'thomas.leese@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCsFqOid5M3C4r4pqJOSF27LphXyGaVjRMVT6UWSi7VayzI6IaJRn4RsBq1A9fd/aXKySimAFGzEEx6sFBV/uU0b/jPDLZxk406wDjsAQc2nBhUR1eahsvkHCLJZzdcWEpqOgxQ+hzewRPLYBBmrd6PrzJOia3ieN/tkw8E1pAc9vmlQNavwx+1QPLHAY1DEtT6muTuOkfnfMJj6Z1o9y2/ZF/nSiu3g8gR1mgEK50xAhHlQ5lWc98GamZIQTRqd2fgbAN5d/bBH3f2m/UXCRL6S4ZLgpjsqzVO/84iG35iOXHI4hpL5w2Vr5ciaWGSDFDzMR8W/A/aNQLkyOWmltbvzo+3lmd+vwTbVAlIyHfMzxt9BYiCNMYxyk08J/3E+1W9+7RaniG103mup1UVllR0W32pZFYgvptwHIsVRPyS6kRbcyOKw4EXMY3RDV4cLXrA2WTKQaX1mr8iPDA3zYRiqs5Nc07yRPVWcFVZmS/IiMMf5uMUVsdA8PLxWpOM+P/quJkpJNHFsCwI4sG5xXlhne3gmr+HhbeYVf6jPcnRyqQ0/+SqoitafEP5ssEtRUZ0sKLIXO73HAzZrmxLZt2AhO1md1+RweNpbL6jt3aIaYaffV2hvpXo1Cd5V331Gx2yLODqRCceUjZP9Dg03zvIqewC0yD7u+/39qoPd6uNRw== thomas.leese@digital.cabinetoffice.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "$config_admin_user = false", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\n$tenant_id = \"/%(tenant_id)s\"\n}\n$endpoint_version = \"v2\"\n\nif ($keystone_version == \"v3\" ) {\n39:     $config_admin_user = false\n} else {\n$config_admin_user = true\n}\n\nclass { 'keystone::endpoint':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 39\n\n     34:     $tenant_id = \"/%(tenant_id)s\"\n     35:   }\n     36:   $endpoint_version = \"v2\"\n     37: \n     38:   if ($keystone_version == \"v3\" ) {\n>>>  39:     $config_admin_user = false\n     40:   } else {\n     41:     $config_admin_user = true\n     42:   }\n     43: \n     44:   class { 'keystone::endpoint':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$puppetdb_user     = 'puppetdb'", "line": 136, "detection_span": [131, 141], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n131:   $confdir = \"${etcdir}/conf.d\"\n132:   $ssl_dir = \"${etcdir}/ssl\"\n133:\n134:   case $::osfamily {\n'RedHat', 'Suse', 'Archlinux': {\n136:       $puppetdb_user     = 'puppetdb'\n$puppetdb_group    = 'puppetdb'\n$puppetdb_initconf = '/etc/sysconfig/puppetdb'\n}\n'Debian': {\n$puppetdb_user     = 'puppetdb'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 136\n\n    131:   $confdir = \"${etcdir}/conf.d\"\n    132:   $ssl_dir = \"${etcdir}/ssl\"\n    133: \n    134:   case $::osfamily {\n    135:     'RedHat', 'Suse', 'Archlinux': {\n>>> 136:       $puppetdb_user     = 'puppetdb'\n    137:       $puppetdb_group    = 'puppetdb'\n    138:       $puppetdb_initconf = '/etc/sysconfig/puppetdb'\n    139:     }\n    140:     'Debian': {\n    141:       $puppetdb_user     = 'puppetdb'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "key    => 'DateFormat',", "line": 79, "detection_span": [74, 84], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\n}\n\nboxen::osx_defaults { 'Set clock format':\nuser   => $::luser,\ndomain => 'com.apple.menuextra.clock',\n79:     key    => 'DateFormat',\ntype   => 'string',\nvalue  => 'EEE d h:mm:ss a',\n}\n\nboxen::osx_defaults { 'Enable Dashboard dev mode (allows keeping widgets on the desktop)':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 79\n\n     74:   }\n     75: \n     76:   boxen::osx_defaults { 'Set clock format':\n     77:     user   => $::luser,\n     78:     domain => 'com.apple.menuextra.clock',\n>>>  79:     key    => 'DateFormat',\n     80:     type   => 'string',\n     81:     value  => 'EEE d h:mm:ss a',\n     82:   }\n     83: \n     84:   boxen::osx_defaults { 'Enable Dashboard dev mode (allows keeping widgets on the desktop)':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-iterm2.pp", "content": "key    => 'OnlyWhenMoreTabs',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-iterm2.pp\n\n}\n\nboxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':\nuser   => $::luser,\ndomain => 'com.googlecode.iterm2',\n13:     key    => 'OnlyWhenMoreTabs',\ntype   => 'bool',\nvalue  => false,\n}\n\npeople::felho::plistbuddy { 'Left option key acts as Meta+Esc':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-iterm2.pp\n# Target line: 13\n\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':\n     11:     user   => $::luser,\n     12:     domain => 'com.googlecode.iterm2',\n>>>  13:     key    => 'OnlyWhenMoreTabs',\n     14:     type   => 'bool',\n     15:     value  => false,\n     16:   }\n     17: \n     18:   people::felho::plistbuddy { 'Left option key acts as Meta+Esc':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp", "content": "password => 'nailgun',", "line": 170, "detection_span": [165, 175], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n\n165:\n166:   $ostf_db = ['ostf']\n167:\n168:   postgresql::server::db { $nailgun_db :\nuser     => 'nailgun',\n170:     password => 'nailgun',\n171:   }\n172:\n173:   postgresql::server::db { $ostf_db :\nuser     => 'ostf',\npassword => 'ostf',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n# Target line: 170\n\n    165: \n    166:   $ostf_db = ['ostf']\n    167: \n    168:   postgresql::server::db { $nailgun_db :\n    169:     user     => 'nailgun',\n>>> 170:     password => 'nailgun',\n    171:   }\n    172: \n    173:   postgresql::server::db { $ostf_db :\n    174:     user     => 'ostf',\n    175:     password => 'ostf',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision.pp", "content": "$username             = 'demo'", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision.pp\n\n$provision_tempest         = str2bool(hiera('CONFIG_PROVISION_TEMPEST'))\n$provision_neutron         = str2bool(hiera('CONFIG_NEUTRON_INSTALL'))\n$heat_available            = str2bool(hiera('CONFIG_HEAT_INSTALL'))\n\nif $provision_demo {\n9:       $username             = 'demo'\n$password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n$tenant_name          = 'demo'\n$floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n$allocation_pools     = hiera(\n'CONFIG_PROVISION_DEMO_ALLOCATION_POOLS')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision.pp\n# Target line: 9\n\n      4:     $provision_tempest         = str2bool(hiera('CONFIG_PROVISION_TEMPEST'))\n      5:     $provision_neutron         = str2bool(hiera('CONFIG_NEUTRON_INSTALL'))\n      6:     $heat_available            = str2bool(hiera('CONFIG_HEAT_INSTALL'))\n      7: \n      8:     if $provision_demo {\n>>>   9:       $username             = 'demo'\n     10:       $password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n     11:       $tenant_name          = 'demo'\n     12:       $floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n     13:       $allocation_pools     = hiera(\n     14:                               'CONFIG_PROVISION_DEMO_ALLOCATION_POOLS')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-config.pp", "content": "$keystone_admin_token = undef,", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n\n$mysql_user_heat = undef,\n$mysql_pass_heat = undef,\n$rabbitmq_hosts = undef,\n$rabbitmq_user = undef,\n$rabbitmq_password = undef,\n40:   $keystone_admin_token = undef,\n$keystone_admin_email = undef,\n$keystone_admin_password = undef,\n$keystone_tenants = undef,\n$keystone_users = undef,\n$keystone_use_httpd = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-config.pp\n# Target line: 40\n\n     35:   $mysql_user_heat = undef,\n     36:   $mysql_pass_heat = undef,\n     37:   $rabbitmq_hosts = undef,\n     38:   $rabbitmq_user = undef,\n     39:   $rabbitmq_password = undef,\n>>>  40:   $keystone_admin_token = undef,\n     41:   $keystone_admin_email = undef,\n     42:   $keystone_admin_password = undef,\n     43:   $keystone_tenants = undef,\n     44:   $keystone_users = undef,\n     45:   $keystone_use_httpd = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-puppet-manifests-master.pp", "content": "ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',", "line": 114, "detection_span": [109, 119], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-master.pp\n\nserver_name            => [$::fqdn],\nssl                    => true,\nssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\nssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\nssl_crl                => '/var/lib/puppet/ssl/crl.pem',\n114:       ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\nssl_verify_client      => 'optional',\naccess_log             => $nginx_access_log,\nerror_log              => $nginx_error_log,\nformat_log             => $nginx_log_format,\nuwsgi                  => '127.0.0.1:8141',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-master.pp\n# Target line: 114\n\n    109:       server_name            => [$::fqdn],\n    110:       ssl                    => true,\n    111:       ssl_cert               => \"/var/lib/puppet/ssl/certs/${::fqdn}.pem\",\n    112:       ssl_key                => \"/var/lib/puppet/ssl/private_keys/${::fqdn}.pem\",\n    113:       ssl_crl                => '/var/lib/puppet/ssl/crl.pem',\n>>> 114:       ssl_client_certificate => '/var/lib/puppet/ssl/certs/ca.pem',\n    115:       ssl_verify_client      => 'optional',\n    116:       access_log             => $nginx_access_log,\n    117:       error_log              => $nginx_error_log,\n    118:       format_log             => $nginx_log_format,\n    119:       uwsgi                  => '127.0.0.1:8141',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp", "content": "key    => 'CheckQuit',", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n\n}\n\nboxen::osx_defaults { 'Turn off prompt for removal of active transfers':\nuser   => $::luser,\ndomain => 'org.m0k.transmission',\n28:     key    => 'CheckQuit',\ntype   => 'bool',\nvalue  => false,\n}\n\nboxen::osx_defaults { 'Turn off prompt for quiting with active transfers':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n# Target line: 28\n\n     23:   }\n     24: \n     25:   boxen::osx_defaults { 'Turn off prompt for removal of active transfers':\n     26:     user   => $::luser,\n     27:     domain => 'org.m0k.transmission',\n>>>  28:     key    => 'CheckQuit',\n     29:     type   => 'bool',\n     30:     value  => false,\n     31:   }\n     32: \n     33:   boxen::osx_defaults { 'Turn off prompt for quiting with active transfers':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp", "content": "key_server        => 'keys.gnupg.net',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n\nlocation          => 'http://repo.puphpet.com/dotdeb/',\nrelease           => 'squeeze-php54',\nrepos             => 'all',\nrequired_packages => 'debian-keyring debian-archive-keyring',\nkey               => '89DF5277',\n19:           key_server        => 'keys.gnupg.net',\ninclude_src       => true\n}\n}\n# Wheezy : 5.4 (default) && 5.5 && 5.6\nelsif $::lsbdistcodename == 'wheezy' and $php_version == '55' {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-php-repos.pp\n# Target line: 19\n\n     14:           location          => 'http://repo.puphpet.com/dotdeb/',\n     15:           release           => 'squeeze-php54',\n     16:           repos             => 'all',\n     17:           required_packages => 'debian-keyring debian-archive-keyring',\n     18:           key               => '89DF5277',\n>>>  19:           key_server        => 'keys.gnupg.net',\n     20:           include_src       => true\n     21:         }\n     22:       }\n     23:       # Wheezy : 5.4 (default) && 5.5 && 5.6\n     24:       elsif $::lsbdistcodename == 'wheezy' and $php_version == '55' {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-params.pp", "content": "$user_name          = 'monasca-user',", "line": 76, "detection_span": [71, 81], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-params.pp\n\n$port               = '8070',\n$api_version        = 'v2.0',\n$region             = 'RegionOne',\n$admin_name         = 'monasca-admin',\n$agent_name         = 'monasca-agent',\n76:     $user_name          = 'monasca-user',\n$auth_method        = 'token',\n$admin_password     = undef,\n$admin_project_name = undef,\n$agent_password     = undef,\n$user_password      = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-params.pp\n# Target line: 76\n\n     71:     $port               = '8070',\n     72:     $api_version        = 'v2.0',\n     73:     $region             = 'RegionOne',\n     74:     $admin_name         = 'monasca-admin',\n     75:     $agent_name         = 'monasca-agent',\n>>>  76:     $user_name          = 'monasca-user',\n     77:     $auth_method        = 'token',\n     78:     $admin_password     = undef,\n     79:     $admin_project_name = undef,\n     80:     $agent_password     = undef,\n     81:     $user_password      = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp", "content": "proxy_pass => [", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n\n\n# vhost with proxy_pass and keywords\napache::vhost { 'third.example.com':\nport       => 80,\ndocroot    => '/var/www/third',\n42:   proxy_pass => [\n{\n'path'     => '/third',\n'url'      => 'http://localhost:8080/third',\n'keywords' => ['noquery', 'interpolate']\n},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n# Target line: 42\n\n     37: \n     38: # vhost with proxy_pass and keywords\n     39: apache::vhost { 'third.example.com':\n     40:   port       => 80,\n     41:   docroot    => '/var/www/third',\n>>>  42:   proxy_pass => [\n     43:     {\n     44:       'path'     => '/third',\n     45:       'url'      => 'http://localhost:8080/third',\n     46:       'keywords' => ['noquery', 'interpolate']\n     47:     },\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-heat.pp", "content": "domain_password => 'oh_my_no_secret',", "line": 75, "detection_span": [70, 80], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-heat.pp\n\npublic_url                => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\ninternal_url              => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\nadmin_url                 => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n}\nclass { '::heat::keystone::domain':\n75:     domain_password => 'oh_my_no_secret',\n}\nclass { '::heat::client': }\nclass { '::heat::api':\nservice_name => 'httpd',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-heat.pp\n# Target line: 75\n\n     70:     public_url                => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n     71:     internal_url              => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n     72:     admin_url                 => \"${::openstack_integration::config::base_url}:8004/v1/%(tenant_id)s\",\n     73:   }\n     74:   class { '::heat::keystone::domain':\n>>>  75:     domain_password => 'oh_my_no_secret',\n     76:   }\n     77:   class { '::heat::client': }\n     78:   class { '::heat::api':\n     79:     service_name => 'httpd',\n     80:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp", "content": "password => 'ostf',", "line": 175, "detection_span": [170, 180], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n\npassword => 'nailgun',\n171:   }\n172:\n173:   postgresql::server::db { $ostf_db :\nuser     => 'ostf',\n175:     password => 'ostf',\n176:   }\n177:\n178:   postgresql::server::pg_hba_rule { 'Allow local TCP connections with authentication under postgres user' :\ndescription => 'Allow local TCP connections with authentication under postgres user',\ntype        => 'host',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-verify_fuel_web.pp\n# Target line: 175\n\n    170:     password => 'nailgun',\n    171:   }\n    172: \n    173:   postgresql::server::db { $ostf_db :\n    174:     user     => 'ostf',\n>>> 175:     password => 'ostf',\n    176:   }\n    177: \n    178:   postgresql::server::pg_hba_rule { 'Allow local TCP connections with authentication under postgres user' :\n    179:     description => 'Allow local TCP connections with authentication under postgres user',\n    180:     type        => 'host',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp", "content": "$cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n\nclass { '::cinder::volume': }\n\nclass { '::cinder::client': }\n\n$cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n47:     $cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n$cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n$cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n\n# Cinder::Type requires keystone credentials\nCinder::Type {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder.pp\n# Target line: 47\n\n     42:     class { '::cinder::volume': }\n     43: \n     44:     class { '::cinder::client': }\n     45: \n     46:     $cinder_keystone_admin_username = hiera('CONFIG_KEYSTONE_ADMIN_USERNAME')\n>>>  47:     $cinder_keystone_admin_password = hiera('CONFIG_KEYSTONE_ADMIN_PW')\n     48:     $cinder_keystone_auth_url = hiera('CONFIG_KEYSTONE_PUBLIC_URL')\n     49:     $cinder_keystone_api = hiera('CONFIG_KEYSTONE_API_VERSION')\n     50: \n     51:     # Cinder::Type requires keystone credentials\n     52:     Cinder::Type {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_crawler-manifests-config.pp", "content": "$crawler_user   = 'govuk-crawler',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_crawler-manifests-config.pp\n\n#   Default: 'govuk-crawler'\n#\nclass govuk_crawler::config (\n$aws_access_key = undef,\n$aws_secret_key = undef,\n21:   $crawler_user   = 'govuk-crawler',\n) {\n$env_name = 's3_sync_mirror'\n\nfile { [\"/etc/govuk/${env_name}\", \"/etc/govuk/${env_name}/env.d\"]:\nensure  => 'directory',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_crawler-manifests-config.pp\n# Target line: 21\n\n     16: #   Default: 'govuk-crawler'\n     17: #\n     18: class govuk_crawler::config (\n     19:   $aws_access_key = undef,\n     20:   $aws_secret_key = undef,\n>>>  21:   $crawler_user   = 'govuk-crawler',\n     22: ) {\n     23:   $env_name = 's3_sync_mirror'\n     24: \n     25:   file { [\"/etc/govuk/${env_name}\", \"/etc/govuk/${env_name}/env.d\"]:\n     26:     ensure  => 'directory',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-panko.pp", "content": "password => 'panko',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-panko.pp\n\nclass { '::panko::db':\ndatabase_connection => 'mysql+pymysql://panko:panko@127.0.0.1/panko?charset=utf8',\n}\n\nclass { '::panko::db::mysql':\n25:     password => 'panko',\n}\nclass { '::panko::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:8977\",\ninternal_url => \"${::openstack_integration::config::base_url}:8977\",\nadmin_url    => \"${::openstack_integration::config::base_url}:8977\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-panko.pp\n# Target line: 25\n\n     20:   class { '::panko::db':\n     21:     database_connection => 'mysql+pymysql://panko:panko@127.0.0.1/panko?charset=utf8',\n     22:   }\n     23: \n     24:   class { '::panko::db::mysql':\n>>>  25:     password => 'panko',\n     26:   }\n     27:   class { '::panko::keystone::auth':\n     28:     public_url   => \"${::openstack_integration::config::base_url}:8977\",\n     29:     internal_url => \"${::openstack_integration::config::base_url}:8977\",\n     30:     admin_url    => \"${::openstack_integration::config::base_url}:8977\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp", "content": "key     => 'haproxy.be[*]',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n\nplugin_zabbix::agent::userparameter {\n'haproxy.be.discovery':\nkey     => 'haproxy.be.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -b';\n'haproxy.be':\n31:         key     => 'haproxy.be[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.fe.discovery':\nkey     => 'haproxy.fe.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -f';\n'haproxy.fe':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n# Target line: 31\n\n     26:     plugin_zabbix::agent::userparameter {\n     27:       'haproxy.be.discovery':\n     28:         key     => 'haproxy.be.discovery',\n     29:         command => '/etc/zabbix/scripts/haproxy.sh -b';\n     30:       'haproxy.be':\n>>>  31:         key     => 'haproxy.be[*]',\n     32:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     33:       'haproxy.fe.discovery':\n     34:         key     => 'haproxy.fe.discovery',\n     35:         command => '/etc/zabbix/scripts/haproxy.sh -f';\n     36:       'haproxy.fe':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "zend-patterns@ZendServerPuppet-manifests-repo-debian.pp", "content": "key_source => 'http://repos.zend.com/zend.key',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n\nwarning(\"${name} should not be directly included in the manifest.\")\n}\n\napt::key { 'zend':\nkey        => 'F7D2C623',\n11:     key_source => 'http://repos.zend.com/zend.key',\n}\n\n# TODO: maybe move $zend_repository setting to params.pp\n#\n#  For Ubuntu 12.04 or Debian 7 and above, use:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n# Target line: 11\n\n      6:     warning(\"${name} should not be directly included in the manifest.\")\n      7:   }\n      8: \n      9:   apt::key { 'zend':\n     10:     key        => 'F7D2C623',\n>>>  11:     key_source => 'http://repos.zend.com/zend.key',\n     12:   }\n     13: \n     14:   # TODO: maybe move $zend_repository setting to params.pp\n     15:   #\n     16:   #  For Ubuntu 12.04 or Debian 7 and above, use:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_package_idopgsql.pp", "content": "user => \"icinga2\",", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_package_idopgsql.pp\n\nmanage_package => false,\n}\n\nclass{ 'icinga2::feature::idopgsql':\nhost => \"127.0.0.1\",\n11:   user => \"icinga2\",\npassword => \"icinga2\",\ndatabase => \"icinga2\",\nimport_schema => true\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_package_idopgsql.pp\n# Target line: 11\n\n      6:   manage_package => false,\n      7: }\n      8: \n      9: class{ 'icinga2::feature::idopgsql':\n     10:   host => \"127.0.0.1\",\n>>>  11:   user => \"icinga2\",\n     12:   password => \"icinga2\",\n     13:   database => \"icinga2\",\n     14:   import_schema => true\n     15: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-build-unix-cleanup-manifests-init.pp", "content": "password   => pw_hash($root_password, 'SHA-512', 'mysalt'),", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: SecGen@SecGen-modules-build-unix-cleanup-manifests-init.pp\n\nExec { path => ['/bin','/sbin','/usr/bin', '/usr/sbin'] }\n\n# Set root password\n::accounts::user { 'root':\nshell      => '/bin/bash',\n13:     password   => pw_hash($root_password, 'SHA-512', 'mysalt'),\nmanagehome => true,\n}\n\n# Disable ssh\nif $disable_ssh {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-build-unix-cleanup-manifests-init.pp\n# Target line: 13\n\n      8:   Exec { path => ['/bin','/sbin','/usr/bin', '/usr/sbin'] }\n      9: \n     10:   # Set root password\n     11:   ::accounts::user { 'root':\n     12:     shell      => '/bin/bash',\n>>>  13:     password   => pw_hash($root_password, 'SHA-512', 'mysalt'),\n     14:     managehome => true,\n     15:   }\n     16: \n     17:   # Disable ssh\n     18:   if $disable_ssh {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-global_controller-keystone-auth.pp", "content": "$configure_user      = false,", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-global_controller-keystone-auth.pp\n\n$cgc_ip = $::contrail::params::ext_global_controller_ip,\n$cgc_port = $::contrail::params::ext_global_controller_port,\n$email               = 'gcg@localhost',\n$tenant              = 'services',\n$configure_endpoint  = true,\n18:   $configure_user      = false,\n$configure_user_role = false,\n) {\n\n$api_public_url = \"http://${api_server_ip}:${api_server_port}\"\n$api_internal_url = $api_public_url", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-global_controller-keystone-auth.pp\n# Target line: 18\n\n     13:   $cgc_ip = $::contrail::params::ext_global_controller_ip,\n     14:   $cgc_port = $::contrail::params::ext_global_controller_port,\n     15:   $email               = 'gcg@localhost',\n     16:   $tenant              = 'services',\n     17:   $configure_endpoint  = true,\n>>>  18:   $configure_user      = false,\n     19:   $configure_user_role = false,\n     20: ) {\n     21: \n     22:   $api_public_url = \"http://${api_server_ip}:${api_server_port}\"\n     23:   $api_internal_url = $api_public_url\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "tsuru@puppet-tsuru-gandalf-manifests-init.pp", "content": "$tsuru_api_token        = undef", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: tsuru@puppet-tsuru-gandalf-manifests-init.pp\n\n$gandalf_group          = 'git',\n$gandalf_user_home      = '/var/lib/gandalf',\n$gandalf_authorized_keys_path = '/var/lib/gandalf/.ssh/authorized_keys',\n$gandalf_version        = 'latest',\n$tsuru_api_host         = 'localhost:8081',\n39:   $tsuru_api_token        = undef\n) {\n\ninclude base\n\npackage { 'gandalf-server':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: tsuru@puppet-tsuru-gandalf-manifests-init.pp\n# Target line: 39\n\n     34:   $gandalf_group          = 'git',\n     35:   $gandalf_user_home      = '/var/lib/gandalf',\n     36:   $gandalf_authorized_keys_path = '/var/lib/gandalf/.ssh/authorized_keys',\n     37:   $gandalf_version        = 'latest',\n     38:   $tsuru_api_host         = 'localhost:8081',\n>>>  39:   $tsuru_api_token        = undef\n     40: ) {\n     41: \n     42:   include base\n     43: \n     44:   package { 'gandalf-server':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-keystone.pp", "content": "ssl_key         => \"/etc/keystone/ssl/private/${::fqdn}.pem\",", "line": 101, "detection_span": [96, 106], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-keystone.pp\n\ninclude ::apache\nclass { '::keystone::wsgi::apache':\nbind_host       => $::openstack_integration::config::ip_for_url,\nadmin_bind_host => $::openstack_integration::config::ip_for_url,\nssl             => $::openstack_integration::config::ssl,\n101:     ssl_key         => \"/etc/keystone/ssl/private/${::fqdn}.pem\",\nssl_cert        => $::openstack_integration::params::cert_path,\nworkers         => 2,\n104:   }\n105:   # Workaround to empty Keystone vhost that is provided & activated by default with running\n106:   # Canonical packaging (called 'keystone'). This will make sure upgrading the package is", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-keystone.pp\n# Target line: 101\n\n     96:   include ::apache\n     97:   class { '::keystone::wsgi::apache':\n     98:     bind_host       => $::openstack_integration::config::ip_for_url,\n     99:     admin_bind_host => $::openstack_integration::config::ip_for_url,\n    100:     ssl             => $::openstack_integration::config::ssl,\n>>> 101:     ssl_key         => \"/etc/keystone/ssl/private/${::fqdn}.pem\",\n    102:     ssl_cert        => $::openstack_integration::params::cert_path,\n    103:     workers         => 2,\n    104:   }\n    105:   # Workaround to empty Keystone vhost that is provided & activated by default with running\n    106:   # Canonical packaging (called 'keystone'). This will make sure upgrading the package is\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@puppet-cdh-manifests-hadoop-users.pp", "content": "user         => 'hdfs',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-users.pp\n\n}\n\ncdh::exec { 'create_hdfs_user_directories':\ncommand      => \"/usr/local/bin/create_hdfs_user_directories.sh --verbose ${groups}\",\nunless       => \"/usr/local/bin/create_hdfs_user_directories.sh --check-for-changes ${groups}\",\n34:         user         => 'hdfs',\nlogoutput    => true,\ntimeout      => 120,\nuse_kerberos => $use_kerberos,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-users.pp\n# Target line: 34\n\n     29:     }\n     30: \n     31:     cdh::exec { 'create_hdfs_user_directories':\n     32:         command      => \"/usr/local/bin/create_hdfs_user_directories.sh --verbose ${groups}\",\n     33:         unless       => \"/usr/local/bin/create_hdfs_user_directories.sh --check-for-changes ${groups}\",\n>>>  34:         user         => 'hdfs',\n     35:         logoutput    => true,\n     36:         timeout      => 120,\n     37:         use_kerberos => $use_kerberos,\n     38:     }\n     39: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-manifests-nodepool.pp", "content": "$image_log_document_root = '/var/log/nodepool/image',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool.pp\n\n$environment = {},\n$nodepool_ssh_private_key = '',\n$nodepool_ssh_public_key = '',\n$vhost_name = $::fqdn,\n$statsd_host = '',\n29:   $image_log_document_root = '/var/log/nodepool/image',\n$image_log_periodic_cleanup = true,\n$enable_image_log_via_http = true,\n$upload_log_document_root = '/var/log/nodepool/upload',\n$upload_log_periodic_cleanup = true,\n$enable_upload_log_via_http = false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-nodepool.pp\n# Target line: 29\n\n     24:   $environment = {},\n     25:   $nodepool_ssh_private_key = '',\n     26:   $nodepool_ssh_public_key = '',\n     27:   $vhost_name = $::fqdn,\n     28:   $statsd_host = '',\n>>>  29:   $image_log_document_root = '/var/log/nodepool/image',\n     30:   $image_log_periodic_cleanup = true,\n     31:   $enable_image_log_via_http = true,\n     32:   $upload_log_document_root = '/var/log/nodepool/upload',\n     33:   $upload_log_periodic_cleanup = true,\n     34:   $enable_upload_log_via_http = false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-signon.pp", "content": "$db_username = undef,", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-signon.pp\n\n#\nclass govuk::apps::signon(\n$db_hostname = undef,\n$db_name = undef,\n$db_password = undef,\n68:   $db_username = undef,\n$devise_pepper = undef,\n$devise_secret_key = undef,\n$enable_procfile_worker = true,\n$sentry_dsn = undef,\n$instance_name = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-signon.pp\n# Target line: 68\n\n     63: #\n     64: class govuk::apps::signon(\n     65:   $db_hostname = undef,\n     66:   $db_name = undef,\n     67:   $db_password = undef,\n>>>  68:   $db_username = undef,\n     69:   $devise_pepper = undef,\n     70:   $devise_secret_key = undef,\n     71:   $enable_procfile_worker = true,\n     72:   $sentry_dsn = undef,\n     73:   $instance_name = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp", "content": "$rabbit_user                = 'nova',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n\n$verbose                    = true,\n# Rabbit details necessary for cinder\n$rabbit_nodes               = false,\n$rabbit_password            = 'rabbit_pw',\n$rabbit_host                = false,\n45:   $rabbit_user                = 'nova',\n$rabbit_ha_virtual_ip       = false,\n$queue_provider             = 'rabbitmq',\n$qpid_password              = 'qpid_pw',\n$qpid_user                  = 'nova',\n$qpid_nodes                 = ['127.0.0.1'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n# Target line: 45\n\n     40:   $verbose                    = true,\n     41:   # Rabbit details necessary for cinder\n     42:   $rabbit_nodes               = false,\n     43:   $rabbit_password            = 'rabbit_pw',\n     44:   $rabbit_host                = false,\n>>>  45:   $rabbit_user                = 'nova',\n     46:   $rabbit_ha_virtual_ip       = false,\n     47:   $queue_provider             = 'rabbitmq',\n     48:   $qpid_password              = 'qpid_pw',\n     49:   $qpid_user                  = 'nova',\n     50:   $qpid_nodes                 = ['127.0.0.1'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "key    => 'ScheduleFrequency',", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\n}\n\nboxen::osx_defaults { 'Check for software updates daily, not just once per week':\nuser   => $::luser,\ndomain => 'com.apple.SoftwareUpdate',\n71:     key    => 'ScheduleFrequency',\ntype   => 'int',\nvalue  => 1,\n}\n\nboxen::osx_defaults { 'Set clock format':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 71\n\n     66:   }\n     67: \n     68:   boxen::osx_defaults { 'Check for software updates daily, not just once per week':\n     69:     user   => $::luser,\n     70:     domain => 'com.apple.SoftwareUpdate',\n>>>  71:     key    => 'ScheduleFrequency',\n     72:     type   => 'int',\n     73:     value  => 1,\n     74:   }\n     75: \n     76:   boxen::osx_defaults { 'Set clock format':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-finder-show_warning_before_emptying_trash.pp", "content": "key    => 'WarnOnEmptyTrash',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: boxen@puppet-osx-manifests-finder-show_warning_before_emptying_trash.pp\n\nclass osx::finder::show_warning_before_emptying_trash {\ninclude osx::finder\n\nboxen::osx_defaults { 'Show warning before emptying the trash':\nuser   => $::boxen_user,\n7:     key    => 'WarnOnEmptyTrash',\ndomain => 'com.apple.finder',\nvalue  => true,\nnotify => Exec['killall Finder'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-finder-show_warning_before_emptying_trash.pp\n# Target line: 7\n\n      2: class osx::finder::show_warning_before_emptying_trash {\n      3:   include osx::finder\n      4: \n      5:   boxen::osx_defaults { 'Show warning before emptying the trash':\n      6:     user   => $::boxen_user,\n>>>   7:     key    => 'WarnOnEmptyTrash',\n      8:     domain => 'com.apple.finder',\n      9:     value  => true,\n     10:     notify => Exec['killall Finder'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-postgresql-manifests-server-config_entry.pp", "content": "$requires_restart_until = {", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-config_entry.pp\n\n# Those are the variables that are marked as \"(change requires restart)\"\n# on postgresql.conf.  Items are ordered as on postgresql.conf.\n#\n# XXX: This resource supports setting other variables without knowing\n# their names.  Do not add them here.\n19:   $requires_restart_until = {\n'data_directory'                      => undef,\n'hba_file'                            => undef,\n'ident_file'                          => undef,\n'external_pid_file'                   => undef,\n'listen_addresses'                    => undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-config_entry.pp\n# Target line: 19\n\n     14:   # Those are the variables that are marked as \"(change requires restart)\"\n     15:   # on postgresql.conf.  Items are ordered as on postgresql.conf.\n     16:   #\n     17:   # XXX: This resource supports setting other variables without knowing\n     18:   # their names.  Do not add them here.\n>>>  19:   $requires_restart_until = {\n     20:     'data_directory'                      => undef,\n     21:     'hba_file'                            => undef,\n     22:     'ident_file'                          => undef,\n     23:     'external_pid_file'                   => undef,\n     24:     'listen_addresses'                    => undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-cinder.pp", "content": "rbd_secret_uuid    => '7200aea0-2ddd-4a32-aa2a-d49f66ab554c',", "line": 145, "detection_span": [140, 150], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-cinder.pp\n\n}\n'rbd': {\ncinder::backend::rbd { 'BACKEND_1':\nrbd_user           => 'openstack',\nrbd_pool           => 'cinder',\n145:         rbd_secret_uuid    => '7200aea0-2ddd-4a32-aa2a-d49f66ab554c',\nmanage_volume_type => true,\n}\n# make sure ceph pool exists before running Cinder API & Volume\nExec['create-cinder'] -> Service['httpd']\nExec['create-cinder'] -> Service['cinder-volume']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-cinder.pp\n# Target line: 145\n\n    140:     }\n    141:     'rbd': {\n    142:       cinder::backend::rbd { 'BACKEND_1':\n    143:         rbd_user           => 'openstack',\n    144:         rbd_pool           => 'cinder',\n>>> 145:         rbd_secret_uuid    => '7200aea0-2ddd-4a32-aa2a-d49f66ab554c',\n    146:         manage_volume_type => true,\n    147:       }\n    148:       # make sure ceph pool exists before running Cinder API & Volume\n    149:       Exec['create-cinder'] -> Service['httpd']\n    150:       Exec['create-cinder'] -> Service['cinder-volume']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-db-mysql.pp", "content": "$user          = 'ironic',", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-db-mysql.pp\n\n#   Defaults to undef\n#\nclass ironic::db::mysql (\n$password,\n$dbname        = 'ironic',\n50:   $user          = 'ironic',\n$host          = '127.0.0.1',\n$allowed_hosts = undef,\n$charset       = 'utf8',\n$collate       = 'utf8_general_ci',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-db-mysql.pp\n# Target line: 50\n\n     45: #   Defaults to undef\n     46: #\n     47: class ironic::db::mysql (\n     48:   $password,\n     49:   $dbname        = 'ironic',\n>>>  50:   $user          = 'ironic',\n     51:   $host          = '127.0.0.1',\n     52:   $allowed_hosts = undef,\n     53:   $charset       = 'utf8',\n     54:   $collate       = 'utf8_general_ci',\n     55: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_idomysql_ssl.pp", "content": "ssl_cert_path   => '/etc/mysql/server-cert.pem',", "line": 110, "detection_span": [105, 115], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql_ssl.pp\n\npassword        => 'supersecret',\ndatabase        => 'icinga',\n107:   import_schema   => true,\nenable_ssl      => true,\n109:   ssl_key_path    => '/etc/mysql/server-key.pem',\n110:   ssl_cert_path   => '/etc/mysql/server-cert.pem',\n111:   ssl_cacert_path => '/etc/mysql/cacert.pem',\nrequire         => Mysql::Db['icinga'],\n113: }\n114:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql_ssl.pp\n# Target line: 110\n\n    105:   password        => 'supersecret',\n    106:   database        => 'icinga',\n    107:   import_schema   => true,\n    108:   enable_ssl      => true,\n    109:   ssl_key_path    => '/etc/mysql/server-key.pem',\n>>> 110:   ssl_cert_path   => '/etc/mysql/server-cert.pem',\n    111:   ssl_cacert_path => '/etc/mysql/cacert.pem',\n    112:   require         => Mysql::Db['icinga'],\n    113: }\n    114: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-set.pp", "content": "$hosts_admin = \"\",", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-set.pp\n\n$help_channel = \"#help\",\n$hiddenhost_prefix = \"+x\",\n$hosts_local = undef,\n$hosts_global = \"\",\n$hosts_coadmin = \"\",\n64:   $hosts_admin = \"\",\n$hosts_servicesadmin = \"\",\n$hosts_netadmin = \"\",\n$hosts_host_on_oper_up = undef,\n$ssl_egd = undef,\n$ssl_certificate = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-irc-unrealirc-manifests-config-set.pp\n# Target line: 64\n\n     59:   $help_channel = \"#help\",\n     60:   $hiddenhost_prefix = \"+x\",\n     61:   $hosts_local = undef,\n     62:   $hosts_global = \"\",\n     63:   $hosts_coadmin = \"\",\n>>>  64:   $hosts_admin = \"\",\n     65:   $hosts_servicesadmin = \"\",\n     66:   $hosts_netadmin = \"\",\n     67:   $hosts_host_on_oper_up = undef,\n     68:   $ssl_egd = undef,\n     69:   $ssl_certificate = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-feedback.pp", "content": "$support_bearer_token = undef,", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-feedback.pp\n\n#\nclass govuk::apps::feedback(\n$port = '3028',\n$sentry_dsn = undef,\n$secret_key_base = undef,\n31:   $support_bearer_token = undef,\n$support_api_bearer_token = undef,\n$publishing_api_bearer_token = undef,\n$assisted_digital_google_spreadsheet_key = undef,\n$google_client_email = undef,\n$google_private_key = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-feedback.pp\n# Target line: 31\n\n     26: #\n     27: class govuk::apps::feedback(\n     28:   $port = '3028',\n     29:   $sentry_dsn = undef,\n     30:   $secret_key_base = undef,\n>>>  31:   $support_bearer_token = undef,\n     32:   $support_api_bearer_token = undef,\n     33:   $publishing_api_bearer_token = undef,\n     34:   $assisted_digital_google_spreadsheet_key = undef,\n     35:   $google_client_email = undef,\n     36:   $google_private_key = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp", "content": "$ssl_cert_file = '/etc/ssl/jenkins.crt'", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n\n$swarm_user = ''\n$swarm_password = ''\n$swarm_package = 'jenkins-swarm-slave'\n$swarm_service = 'jenkins-swarm-slave'\n\n31:   $ssl_cert_file = '/etc/ssl/jenkins.crt'\n$ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\nMIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\nVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\ncyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\nMDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-jenkins-manifests-params.pp\n# Target line: 31\n\n     26:   $swarm_user = ''\n     27:   $swarm_password = ''\n     28:   $swarm_package = 'jenkins-swarm-slave'\n     29:   $swarm_service = 'jenkins-swarm-slave'\n     30: \n>>>  31:   $ssl_cert_file = '/etc/ssl/jenkins.crt'\n     32:   $ssl_cert_file_contents = '-----BEGIN CERTIFICATE-----\n     33: MIIDPjCCAiYCCQCiiKl1cghBuDANBgkqhkiG9w0BAQUFADBhMQswCQYDVQQGEwJB\n     34: VTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50ZXJuZXQgV2lkZ2l0\n     35: cyBQdHkgTHRkMRowGAYDVQQDDBFzZXJ2ZXIudGVzdC5sb2NhbDAeFw0xNDA4MTEy\n     36: MDAzNTVaFw0xNTA4MTEyMDAzNTVaMGExCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApT\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-storage-ceph_extraconf.pp", "content": "$config_key            = 'default',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: norcams@himlar-profile-manifests-storage-ceph_extraconf.pp\n\n#\n# Create extra configuration for ceph\n#\ndefine profile::storage::ceph_extraconf (\n$manage                = true,\n6:   $config_key            = 'default',\n$config_value          = 'default',\n) {\n\nif $manage {\nceph_config {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-storage-ceph_extraconf.pp\n# Target line: 6\n\n      1: #\n      2: # Create extra configuration for ceph\n      3: #\n      4: define profile::storage::ceph_extraconf (\n      5:   $manage                = true,\n>>>   6:   $config_key            = 'default',\n      7:   $config_value          = 'default',\n      8: ) {\n      9: \n     10:   if $manage {\n     11:     ceph_config {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-config-beforeservice.pp", "content": "user => 'all',", "line": 63, "detection_span": [58, 68], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-config-beforeservice.pp\n\nnotify => Exec['reload_postgresql'],\n}\n\nPostgresql::Pg_hba_rule {\ndatabase => 'all',\n63:       user => 'all',\n}\n\n# Lets setup the base rules\npostgresql::pg_hba_rule { 'local access as postgres user':\ntype        => 'local',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-config-beforeservice.pp\n# Target line: 63\n\n     58:       notify => Exec['reload_postgresql'],\n     59:     }\n     60: \n     61:     Postgresql::Pg_hba_rule {\n     62:       database => 'all',\n>>>  63:       user => 'all',\n     64:     }\n     65: \n     66:     # Lets setup the base rules\n     67:     postgresql::pg_hba_rule { 'local access as postgres user':\n     68:       type        => 'local',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp", "content": "routing_key   => '*.bulk.reindex',", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n\n\ngovuk_rabbitmq::queue_with_binding { 'rummager_bulk_reindex':\nensure        => $toggled_bulk_ensure,\namqp_exchange => $amqp_exchange,\namqp_queue    => 'rummager_bulk_reindex',\n69:     routing_key   => '*.bulk.reindex',\ndurable       => true,\n}\n\n# match everything on queue 2 while we test\ngovuk_rabbitmq::consumer { 'rummager-v2':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-rummager-rabbitmq.pp\n# Target line: 69\n\n     64: \n     65:   govuk_rabbitmq::queue_with_binding { 'rummager_bulk_reindex':\n     66:     ensure        => $toggled_bulk_ensure,\n     67:     amqp_exchange => $amqp_exchange,\n     68:     amqp_queue    => 'rummager_bulk_reindex',\n>>>  69:     routing_key   => '*.bulk.reindex',\n     70:     durable       => true,\n     71:   }\n     72: \n     73:   # match everything on queue 2 while we test\n     74:   govuk_rabbitmq::consumer { 'rummager-v2':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-dock-magnification.pp", "content": "key    => 'largesize',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: boxen@puppet-osx-manifests-dock-magnification.pp\n\nnotify => Exec['killall Dock'];\n}\n\nboxen::osx_defaults { 'magnification_size':\ndomain => 'com.apple.dock',\n31:     key    => 'largesize',\ntype   => int,\nvalue  => $magnification_size,\nuser   => $::boxen_user,\nnotify => Exec['killall Dock'];\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-dock-magnification.pp\n# Target line: 31\n\n     26:     notify => Exec['killall Dock'];\n     27:   }\n     28: \n     29:   boxen::osx_defaults { 'magnification_size':\n     30:     domain => 'com.apple.dock',\n>>>  31:     key    => 'largesize',\n     32:     type   => int,\n     33:     value  => $magnification_size,\n     34:     user   => $::boxen_user,\n     35:     notify => Exec['killall Dock'];\n     36:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp", "content": "neutron_metadata_proxy_shared_secret => hiera('CONFIG_NEUTRON_METADATA_PW_UNQUOTED', undef),", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n\n\nclass { '::nova::api':\napi_bind_address                     => $bind_host,\nmetadata_listen                      => $bind_host,\nenabled                              => true,\n30:       neutron_metadata_proxy_shared_secret => hiera('CONFIG_NEUTRON_METADATA_PW_UNQUOTED', undef),\nsync_db                              => false,\nsync_db_api                          => false,\nosapi_compute_workers                => hiera('CONFIG_SERVICE_WORKERS'),\nmetadata_workers                     => hiera('CONFIG_SERVICE_WORKERS'),\nallow_resize_to_same_host            => hiera('CONFIG_NOVA_ALLOW_RESIZE_TO_SAME'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n# Target line: 30\n\n     25: \n     26:     class { '::nova::api':\n     27:       api_bind_address                     => $bind_host,\n     28:       metadata_listen                      => $bind_host,\n     29:       enabled                              => true,\n>>>  30:       neutron_metadata_proxy_shared_secret => hiera('CONFIG_NEUTRON_METADATA_PW_UNQUOTED', undef),\n     31:       sync_db                              => false,\n     32:       sync_db_api                          => false,\n     33:       osapi_compute_workers                => hiera('CONFIG_SERVICE_WORKERS'),\n     34:       metadata_workers                     => hiera('CONFIG_SERVICE_WORKERS'),\n     35:       allow_resize_to_same_host            => hiera('CONFIG_NOVA_ALLOW_RESIZE_TO_SAME'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-aodh.pp", "content": "$oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),", "line": 85, "detection_span": [80, 90], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n\n$bootstrap_node          = hiera('aodh_api_bootstrap_node_name', undef),\n$oslomsg_rpc_proto       = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n$oslomsg_rpc_hosts       = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n$oslomsg_rpc_password    = hiera('oslo_messaging_rpc_password'),\n$oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n85:   $oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n$oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n$oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n$oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n$oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n$oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-aodh.pp\n# Target line: 85\n\n     80:   $bootstrap_node          = hiera('aodh_api_bootstrap_node_name', undef),\n     81:   $oslomsg_rpc_proto       = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n     82:   $oslomsg_rpc_hosts       = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n     83:   $oslomsg_rpc_password    = hiera('oslo_messaging_rpc_password'),\n     84:   $oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n>>>  85:   $oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n     86:   $oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     87:   $oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n     88:   $oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n     89:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n     90:   $oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bastelfreak@puppet-prometheus2-manifests-params.pp", "content": "$statsd_exporter_user = 'statsd-exporter'", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n\n$statsd_exporter_group = 'statsd-exporter'\n$statsd_exporter_mapping_config_path = '/etc/statsd_mappings.conf'\n$statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n$statsd_exporter_package_ensure = 'latest'\n$statsd_exporter_package_name = 'statsd_exporter'\n87:   $statsd_exporter_user = 'statsd-exporter'\n$statsd_exporter_version = '0.3.0'\n$user = 'prometheus'\n$version = '1.5.2'\ncase $::architecture {\n'x86_64', 'amd64': { $arch = 'amd64' }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bastelfreak@puppet-prometheus2-manifests-params.pp\n# Target line: 87\n\n     82:   $statsd_exporter_group = 'statsd-exporter'\n     83:   $statsd_exporter_mapping_config_path = '/etc/statsd_mappings.conf'\n     84:   $statsd_exporter_maps = [{'map' => 'test.dispatcher.*.*.*','name' =>'dispatcher_events_total','labels' => { 'processor'=>'$1', 'action'=>'$2', 'outcome'=>'$3', 'job'=>'test_dispatcher'}}]\n     85:   $statsd_exporter_package_ensure = 'latest'\n     86:   $statsd_exporter_package_name = 'statsd_exporter'\n>>>  87:   $statsd_exporter_user = 'statsd-exporter'\n     88:   $statsd_exporter_version = '0.3.0'\n     89:   $user = 'prometheus'\n     90:   $version = '1.5.2'\n     91:   case $::architecture {\n     92:     'x86_64', 'amd64': { $arch = 'amd64' }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp", "content": "$user     = hiera('monitoring_rabbitmq_username', 'sensu'),", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n\n#   (Optional) String. RabbitMQ vhost to be used by Sensu\n#   Defaults to '/sensu'\n#\nclass tripleo::profile::base::monitoring::rabbitmq (\n$password = hiera('monitoring_rabbitmq_password', undef),\n35:   $user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n$vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n) {\nwarning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n\nrabbitmq_vhost { 'sensu-rabbit-vhost':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n# Target line: 35\n\n     30: #   (Optional) String. RabbitMQ vhost to be used by Sensu\n     31: #   Defaults to '/sensu'\n     32: #\n     33: class tripleo::profile::base::monitoring::rabbitmq (\n     34:   $password = hiera('monitoring_rabbitmq_password', undef),\n>>>  35:   $user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n     36:   $vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n     37: ) {\n     38:   warning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n     39: \n     40:   rabbitmq_vhost { 'sensu-rabbit-vhost':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp", "content": "$db_password = pick($murano_hash['db_password'], $mysql_root_password)", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n\n$mysql_db_create     = pick($mysql_hash['db_create'], true)\n$mysql_root_password = $mysql_hash['root_password']\n\n$db_user     = pick($murano_hash['db_user'], 'murano')\n$db_name     = pick($murano_hash['db_name'], 'murano')\n18:   $db_password = pick($murano_hash['db_password'], $mysql_root_password)\n\n$db_host          = pick($murano_hash['db_host'], $database_vip)\n$db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n$db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n$db_root_password = pick($murano_hash['root_password'], $mysql_root_password)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-db.pp\n# Target line: 18\n\n     13:   $mysql_db_create     = pick($mysql_hash['db_create'], true)\n     14:   $mysql_root_password = $mysql_hash['root_password']\n     15: \n     16:   $db_user     = pick($murano_hash['db_user'], 'murano')\n     17:   $db_name     = pick($murano_hash['db_name'], 'murano')\n>>>  18:   $db_password = pick($murano_hash['db_password'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($murano_hash['db_host'], $database_vip)\n     21:   $db_create        = pick($murano_hash['db_create'], $mysql_db_create)\n     22:   $db_root_user     = pick($murano_hash['root_user'], $mysql_root_user)\n     23:   $db_root_password = pick($murano_hash['root_password'], $mysql_root_password)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder.pp", "content": "$oslomsg_notify_password = hiera('oslo_messaging_notify_password'),", "line": 93, "detection_span": [88, 98], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder.pp\n\n$oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n$oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n$oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n$oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n$oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n93:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n$oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n$oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n$oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n) {\nif $::hostname == downcase($bootstrap_node) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder.pp\n# Target line: 93\n\n     88:   $oslomsg_rpc_port        = hiera('oslo_messaging_rpc_port', '5672'),\n     89:   $oslomsg_rpc_username    = hiera('oslo_messaging_rpc_user_name', 'guest'),\n     90:   $oslomsg_rpc_use_ssl     = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     91:   $oslomsg_notify_proto    = hiera('oslo_messaging_notify_scheme', 'rabbit'),\n     92:   $oslomsg_notify_hosts    = any2array(hiera('oslo_messaging_notify_node_names', undef)),\n>>>  93:   $oslomsg_notify_password = hiera('oslo_messaging_notify_password'),\n     94:   $oslomsg_notify_port     = hiera('oslo_messaging_notify_port', '5672'),\n     95:   $oslomsg_notify_username = hiera('oslo_messaging_notify_user_name', 'guest'),\n     96:   $oslomsg_notify_use_ssl  = hiera('oslo_messaging_notify_use_ssl', '0'),\n     97: ) {\n     98:   if $::hostname == downcase($bootstrap_node) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-params.pp", "content": "$ip_mask_deny_postgres_user = '0.0.0.0/0'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-params.pp\n\n# PRIVATE CLASS: do not use directly\nclass postgresql::params inherits postgresql::globals {\n$ensure                     = true\n$version                    = $globals_version\n$listen_addresses           = 'localhost'\n6:   $ip_mask_deny_postgres_user = '0.0.0.0/0'\n$ip_mask_allow_all_users    = '127.0.0.1/32'\n$ipv4acls                   = []\n$ipv6acls                   = []\n$user                       = pick($user, 'postgres')\n$group                      = pick($group, 'postgres')", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-params.pp\n# Target line: 6\n\n      1: # PRIVATE CLASS: do not use directly\n      2: class postgresql::params inherits postgresql::globals {\n      3:   $ensure                     = true\n      4:   $version                    = $globals_version\n      5:   $listen_addresses           = 'localhost'\n>>>   6:   $ip_mask_deny_postgres_user = '0.0.0.0/0'\n      7:   $ip_mask_allow_all_users    = '127.0.0.1/32'\n      8:   $ipv4acls                   = []\n      9:   $ipv6acls                   = []\n     10:   $user                       = pick($user, 'postgres')\n     11:   $group                      = pick($group, 'postgres')\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-swift-ceilometer.pp", "content": "password              => hiera('CONFIG_SWIFT_KS_PW'),", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-swift-ceilometer.pp\n\ncontrol_exchange      => 'swift',\ndriver                => 'messaging',\nignore_projects       => ['service'],\nauth_uri              => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\nauth_url              => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n16:       password              => hiera('CONFIG_SWIFT_KS_PW'),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-swift-ceilometer.pp\n# Target line: 16\n\n     11:       control_exchange      => 'swift',\n     12:       driver                => 'messaging',\n     13:       ignore_projects       => ['service'],\n     14:       auth_uri              => hiera('CONFIG_KEYSTONE_PUBLIC_URL'),\n     15:       auth_url              => hiera('CONFIG_KEYSTONE_ADMIN_URL'),\n>>>  16:       password              => hiera('CONFIG_SWIFT_KS_PW'),\n     17:     }\n     18: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp", "content": "$sahara_password = pick($sahara_hash['user_password'])", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n\n$public_ssl_hash = hiera_hash('public_ssl')\n$public_vip      = hiera('public_vip')\n$admin_address   = hiera('management_vip')\n$api_bind_port   = '8386'\n$sahara_user     = pick($sahara_hash['user'], 'sahara')\n11:   $sahara_password = pick($sahara_hash['user_password'])\n$tenant          = pick($sahara_hash['tenant'], 'services')\n$region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n$service_name    = pick($sahara_hash['service_name'], 'sahara')\n$public_address = $public_ssl_hash['services'] ? {\ntrue    => $public_ssl_hash['hostname'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-sahara-keystone.pp\n# Target line: 11\n\n      6:   $public_ssl_hash = hiera_hash('public_ssl')\n      7:   $public_vip      = hiera('public_vip')\n      8:   $admin_address   = hiera('management_vip')\n      9:   $api_bind_port   = '8386'\n     10:   $sahara_user     = pick($sahara_hash['user'], 'sahara')\n>>>  11:   $sahara_password = pick($sahara_hash['user_password'])\n     12:   $tenant          = pick($sahara_hash['tenant'], 'services')\n     13:   $region          = pick($sahara_hash['region'], hiera('region', 'RegionOne'))\n     14:   $service_name    = pick($sahara_hash['service_name'], 'sahara')\n     15:   $public_address = $public_ssl_hash['services'] ? {\n     16:     true    => $public_ssl_hash['hostname'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-vmware.pp", "content": "host_username => hiera('CONFIG_VCENTER_USER'),", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-vmware.pp\n\n$my_ip = choose_my_ip(hiera('HOST_LIST'))\n$nova_vcenter_cluster_name = $cluster_list[$my_ip]\n\nclass { '::nova::compute::vmware':\nhost_ip       => hiera('CONFIG_VCENTER_HOST'),\n9:       host_username => hiera('CONFIG_VCENTER_USER'),\nhost_password => hiera('CONFIG_VCENTER_PASSWORD'),\ncluster_name  => $nova_vcenter_cluster_name,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-vmware.pp\n# Target line: 9\n\n      4:     $my_ip = choose_my_ip(hiera('HOST_LIST'))\n      5:     $nova_vcenter_cluster_name = $cluster_list[$my_ip]\n      6: \n      7:     class { '::nova::compute::vmware':\n      8:       host_ip       => hiera('CONFIG_VCENTER_HOST'),\n>>>   9:       host_username => hiera('CONFIG_VCENTER_USER'),\n     10:       host_password => hiera('CONFIG_VCENTER_PASSWORD'),\n     11:       cluster_name  => $nova_vcenter_cluster_name,\n     12:     }\n     13: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-plugins-ml2-opendaylight.pp", "content": "$odl_password        = hiera('opendaylight::password'),", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-plugins-ml2-opendaylight.pp\n\n#   Defaults to hiera(''enable_ipv6', false)\n#\nclass tripleo::profile::base::neutron::plugins::ml2::opendaylight (\n$odl_port            = hiera('opendaylight::odl_rest_port'),\n$odl_username        = hiera('opendaylight::username'),\n61:   $odl_password        = hiera('opendaylight::password'),\n$odl_url_ip          = hiera('opendaylight_api_vip'),\n$conn_proto          = 'http',\n$enable_internal_tls = hiera('enable_internal_tls', false),\n$internal_api_fqdn   = hiera('cloud_name_internal_api'),\n$step                = Integer(hiera('step')),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-plugins-ml2-opendaylight.pp\n# Target line: 61\n\n     56: #   Defaults to hiera(''enable_ipv6', false)\n     57: #\n     58: class tripleo::profile::base::neutron::plugins::ml2::opendaylight (\n     59:   $odl_port            = hiera('opendaylight::odl_rest_port'),\n     60:   $odl_username        = hiera('opendaylight::username'),\n>>>  61:   $odl_password        = hiera('opendaylight::password'),\n     62:   $odl_url_ip          = hiera('opendaylight_api_vip'),\n     63:   $conn_proto          = 'http',\n     64:   $enable_internal_tls = hiera('enable_internal_tls', false),\n     65:   $internal_api_fqdn   = hiera('cloud_name_internal_api'),\n     66:   $step                = Integer(hiera('step')),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp", "content": "routing_key   => '*.workflow.#',", "line": 58, "detection_span": [53, 63], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n\n} ->\n\ngovuk_rabbitmq::queue_with_binding { $amqp_workflow_queue:\namqp_exchange => $amqp_exchange,\namqp_queue    => $amqp_workflow_queue,\n58:     routing_key   => '*.workflow.#',\ndurable       => true,\n} ->\n\ngovuk_rabbitmq::consumer { $amqp_user:\namqp_pass            => $amqp_pass,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n# Target line: 58\n\n     53:   } ->\n     54: \n     55:   govuk_rabbitmq::queue_with_binding { $amqp_workflow_queue:\n     56:     amqp_exchange => $amqp_exchange,\n     57:     amqp_queue    => $amqp_workflow_queue,\n>>>  58:     routing_key   => '*.workflow.#',\n     59:     durable       => true,\n     60:   } ->\n     61: \n     62:   govuk_rabbitmq::consumer { $amqp_user:\n     63:     amqp_pass            => $amqp_pass,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-whitehall-db.pp", "content": "$mysql_whitehall_admin = '',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-whitehall-db.pp\n\n# FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\nclass govuk::apps::whitehall::db (\n3:   $mysql_whitehall_admin = '',\n$whitehall_fe_password = '',\n){\nmysql::db { 'whitehall_production':\nuser     => 'whitehall',\nhost     => '%',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-whitehall-db.pp\n# Target line: 3\n\n      1: # FIXME: This class needs better documentation as per https://docs.puppetlabs.com/guides/style_guide.html#puppet-doc\n      2: class govuk::apps::whitehall::db (\n>>>   3:   $mysql_whitehall_admin = '',\n      4:   $whitehall_fe_password = '',\n      5: ){\n      6:   mysql::db { 'whitehall_production':\n      7:     user     => 'whitehall',\n      8:     host     => '%',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-common.pp", "content": "$temp_admin_login = \"temporary-administrative-user-${random}\"", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-common.pp\n\n#   limitations under the License.\n\nclass aeolus::profiles::common {\n#we will use one random hex string to name the temporary admin user\n$random = secure_random()\n18:   $temp_admin_login = \"temporary-administrative-user-${random}\"\n#and another random hex string for the temp user's password\n$temp_admin_password = secure_random()\n\naeolus::create_bucket{\"aeolus\":}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-common.pp\n# Target line: 18\n\n     13: #   limitations under the License.\n     14: \n     15: class aeolus::profiles::common {\n     16:   #we will use one random hex string to name the temporary admin user\n     17:   $random = secure_random()\n>>>  18:   $temp_admin_login = \"temporary-administrative-user-${random}\"\n     19:   #and another random hex string for the temp user's password\n     20:   $temp_admin_password = secure_random()\n     21: \n     22:   aeolus::create_bucket{\"aeolus\":}\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-content_audit_tool.pp", "content": "$db_username = 'content_audit_tool',", "line": 78, "detection_span": [73, 83], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_audit_tool.pp\n\n$db_hostname = undef,\n$db_port = undef,\n$db_allow_prepared_statements = undef,\n$db_name = 'content_audit_tool_production',\n$db_password = undef,\n78:   $db_username = 'content_audit_tool',\n$enable_procfile_worker = true,\n$google_analytics_govuk_view_id = undef,\n$google_client_email = undef,\n$google_private_key = undef,\n$oauth_id = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-content_audit_tool.pp\n# Target line: 78\n\n     73:   $db_hostname = undef,\n     74:   $db_port = undef,\n     75:   $db_allow_prepared_statements = undef,\n     76:   $db_name = 'content_audit_tool_production',\n     77:   $db_password = undef,\n>>>  78:   $db_username = 'content_audit_tool',\n     79:   $enable_procfile_worker = true,\n     80:   $google_analytics_govuk_view_id = undef,\n     81:   $google_client_email = undef,\n     82:   $google_private_key = undef,\n     83:   $oauth_id = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp", "content": "key    => 'BadgeDownloadRate',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n\n}\n\nboxen::osx_defaults { 'Disable total download rate on badge icon':\nuser   => $::luser,\ndomain => 'org.m0k.transmission',\n12:     key    => 'BadgeDownloadRate',\ntype   => 'bool',\nvalue  => false,\n}\n\nboxen::osx_defaults { 'Disable total upload rate on badge icon':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-transmission.pp\n# Target line: 12\n\n      7:   }\n      8: \n      9:   boxen::osx_defaults { 'Disable total download rate on badge icon':\n     10:     user   => $::luser,\n     11:     domain => 'org.m0k.transmission',\n>>>  12:     key    => 'BadgeDownloadRate',\n     13:     type   => 'bool',\n     14:     value  => false,\n     15:   }\n     16: \n     17:   boxen::osx_defaults { 'Disable total upload rate on badge icon':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-stephenharker.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7ctK3AiOjlVc/B1ECkueKBoj9z/ty5tbzaGTosie4o1tSd2vG6JRhIkGywBDbpGTEOtkCVGbgXkSsgm/7qD9kmfp/hMw11+C9aiVNcUQACXZmeUziitv4xTONVETebaNxzsS/0rdR8fRsxVuO1eX+Cr3F+ZogOpNLMOJDVd2nqUwiqgieomNqTTJU9jtRiabh/BddbvdRbAzZahY5owNT0kjqUmJcA86F0Phn0cjwQDhMsunsAa6pYnfIi/z9R1/kUE+XxKStrJRauQAXnWOXsV/7oacDtOD70rDfyLKfNDA475Q69sMdC8XFi35QrHpI5KsLtTSTKo2Y0IZBaQ4Iv2tr47Gb4zpNcez4fPHhW/1Ia+G32V/keAD3dPGE/0R7vDq4uX+udLle/oTWd+j0dr0HelZ3aqD9gNZAivRe9bKjtSPefEQD4dGPshCMP516BTb0NW1bWQLD2Qnzw9BQgh1lDDlGW0XblYAwKIZJq/KrLiMwXmv0XHcKCG41G3/JbQrXWOP0D4BnJ7nlLrUIj6ug/zk528+kMOudfbSZQwLJX/AKQ/7Dt5MGPLR8r1XSPIDoMUlrc9iBaN6tbz1J5CqGrLyMGQahP6yjRISZzgFwp9plkj87H76ApGNmRE7PnXTUMBj7/OgksrCsrj6DkOkbyeBKkudodXEkWol9AQ== stephenharker@gds5125.local',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-stephenharker.pp\n\n# Creates the stephenharker user\nclass users::stephenharker {\ngovuk_user { 'stephenharker':\nfullname => 'Stephen Harker',\nemail    => 'stephen.harker@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7ctK3AiOjlVc/B1ECkueKBoj9z/ty5tbzaGTosie4o1tSd2vG6JRhIkGywBDbpGTEOtkCVGbgXkSsgm/7qD9kmfp/hMw11+C9aiVNcUQACXZmeUziitv4xTONVETebaNxzsS/0rdR8fRsxVuO1eX+Cr3F+ZogOpNLMOJDVd2nqUwiqgieomNqTTJU9jtRiabh/BddbvdRbAzZahY5owNT0kjqUmJcA86F0Phn0cjwQDhMsunsAa6pYnfIi/z9R1/kUE+XxKStrJRauQAXnWOXsV/7oacDtOD70rDfyLKfNDA475Q69sMdC8XFi35QrHpI5KsLtTSTKo2Y0IZBaQ4Iv2tr47Gb4zpNcez4fPHhW/1Ia+G32V/keAD3dPGE/0R7vDq4uX+udLle/oTWd+j0dr0HelZ3aqD9gNZAivRe9bKjtSPefEQD4dGPshCMP516BTb0NW1bWQLD2Qnzw9BQgh1lDDlGW0XblYAwKIZJq/KrLiMwXmv0XHcKCG41G3/JbQrXWOP0D4BnJ7nlLrUIj6ug/zk528+kMOudfbSZQwLJX/AKQ/7Dt5MGPLR8r1XSPIDoMUlrc9iBaN6tbz1J5CqGrLyMGQahP6yjRISZzgFwp9plkj87H76ApGNmRE7PnXTUMBj7/OgksrCsrj6DkOkbyeBKkudodXEkWol9AQ== stephenharker@gds5125.local',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-stephenharker.pp\n# Target line: 6\n\n      1: # Creates the stephenharker user\n      2: class users::stephenharker {\n      3:   govuk_user { 'stephenharker':\n      4:     fullname => 'Stephen Harker',\n      5:     email    => 'stephen.harker@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7ctK3AiOjlVc/B1ECkueKBoj9z/ty5tbzaGTosie4o1tSd2vG6JRhIkGywBDbpGTEOtkCVGbgXkSsgm/7qD9kmfp/hMw11+C9aiVNcUQACXZmeUziitv4xTONVETebaNxzsS/0rdR8fRsxVuO1eX+Cr3F+ZogOpNLMOJDVd2nqUwiqgieomNqTTJU9jtRiabh/BddbvdRbAzZahY5owNT0kjqUmJcA86F0Phn0cjwQDhMsunsAa6pYnfIi/z9R1/kUE+XxKStrJRauQAXnWOXsV/7oacDtOD70rDfyLKfNDA475Q69sMdC8XFi35QrHpI5KsLtTSTKo2Y0IZBaQ4Iv2tr47Gb4zpNcez4fPHhW/1Ia+G32V/keAD3dPGE/0R7vDq4uX+udLle/oTWd+j0dr0HelZ3aqD9gNZAivRe9bKjtSPefEQD4dGPshCMP516BTb0NW1bWQLD2Qnzw9BQgh1lDDlGW0XblYAwKIZJq/KrLiMwXmv0XHcKCG41G3/JbQrXWOP0D4BnJ7nlLrUIj6ug/zk528+kMOudfbSZQwLJX/AKQ/7Dt5MGPLR8r1XSPIDoMUlrc9iBaN6tbz1J5CqGrLyMGQahP6yjRISZzgFwp9plkj87H76ApGNmRE7PnXTUMBj7/OgksrCsrj6DkOkbyeBKkudodXEkWol9AQ== stephenharker@gds5125.local',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-manifests-nodes.pp", "content": "$basic_auth_username = hiera('basic_auth_username')", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: alphagov@pp-puppet-manifests-nodes.pp\n\n$spotlight_vhost = join(['spotlight',$domain_name],'.')\n$screenshot_as_a_service_vhost = join(['screenshot', $public_domain_name], '.')\n\n$rabbitmq_sensu_password = hiera('rabbitmq_sensu_password')\n\n37: $basic_auth_username = hiera('basic_auth_username')\n$basic_auth_password = hiera('basic_auth_password')\n$basic_auth_password_hashed = hiera('basic_auth_password_hashed')\n\n$pp_environment = hiera('pp_environment')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-manifests-nodes.pp\n# Target line: 37\n\n     32: $spotlight_vhost = join(['spotlight',$domain_name],'.')\n     33: $screenshot_as_a_service_vhost = join(['screenshot', $public_domain_name], '.')\n     34: \n     35: $rabbitmq_sensu_password = hiera('rabbitmq_sensu_password')\n     36: \n>>>  37: $basic_auth_username = hiera('basic_auth_username')\n     38: $basic_auth_password = hiera('basic_auth_password')\n     39: $basic_auth_password_hashed = hiera('basic_auth_password_hashed')\n     40: \n     41: $pp_environment = hiera('pp_environment')\n     42: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_to_integration.pp", "content": "$jenkins_api_user_password = undef,", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_to_integration.pp\n\n$mysql_dst_root_pw = undef,\n$pg_src_env_sync_pw = undef,\n$pg_dst_env_sync_pw = undef,\n$pg_tr_dst_env_sync_pw = undef,\n$pg_wh_dst_env_sync_pw = undef,\n12:   $jenkins_api_user_password = undef,\n$enable_slack_notifications = true,\n$app_domain = hiera('app_domain'),\n) {\n\n$check_name = 'copy_data_to_integration'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-copy_data_to_integration.pp\n# Target line: 12\n\n      7:   $mysql_dst_root_pw = undef,\n      8:   $pg_src_env_sync_pw = undef,\n      9:   $pg_dst_env_sync_pw = undef,\n     10:   $pg_tr_dst_env_sync_pw = undef,\n     11:   $pg_wh_dst_env_sync_pw = undef,\n>>>  12:   $jenkins_api_user_password = undef,\n     13:   $enable_slack_notifications = true,\n     14:   $app_domain = hiera('app_domain'),\n     15: ) {\n     16: \n     17:   $check_name = 'copy_data_to_integration'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-userprefs-manifests-editors_registry.pp", "content": "key    => 'HKLM\\Software\\Classes\\.erb',", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n\nvalue  => '(Default)',\ndata   => 'sourcecode',\n}\n\nregistry::value { 'ERB Templates':\n27:     key    => 'HKLM\\Software\\Classes\\.erb',\nvalue  => '(Default)',\ndata   => 'sourcecode',\n}\n\nregistry::value { 'Ruby Source Code':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-userprefs-manifests-editors_registry.pp\n# Target line: 27\n\n     22:     value  => '(Default)',\n     23:     data   => 'sourcecode',\n     24:   }\n     25: \n     26:   registry::value { 'ERB Templates':\n>>>  27:     key    => 'HKLM\\Software\\Classes\\.erb',\n     28:     value  => '(Default)',\n     29:     data   => 'sourcecode',\n     30:   }\n     31: \n     32:   registry::value { 'Ruby Source Code':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-network-contrail-provision.pp", "content": "$admin_token       = hiera('contrail::admin_token'),", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-provision.pp\n\n#  Defaults to hiera('step')\n#\nclass tripleo::network::contrail::provision(\n$admin_password    = hiera('contrail::admin_password'),\n$admin_tenant_name = hiera('contrail::admin_tenant_name'),\n72:   $admin_token       = hiera('contrail::admin_token'),\n$admin_user        = hiera('contrail::admin_user'),\n$api_server        = hiera('contrail_config_vip'),\n$auth_host         = hiera('contrail::auth_host'),\n$auth_port         = hiera('contrail::auth_port'),\n$auth_protocol     = hiera('contrail::auth_protocol'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-network-contrail-provision.pp\n# Target line: 72\n\n     67: #  Defaults to hiera('step')\n     68: #\n     69: class tripleo::network::contrail::provision(\n     70:   $admin_password    = hiera('contrail::admin_password'),\n     71:   $admin_tenant_name = hiera('contrail::admin_tenant_name'),\n>>>  72:   $admin_token       = hiera('contrail::admin_token'),\n     73:   $admin_user        = hiera('contrail::admin_user'),\n     74:   $api_server        = hiera('contrail_config_vip'),\n     75:   $auth_host         = hiera('contrail::auth_host'),\n     76:   $auth_port         = hiera('contrail::auth_port'),\n     77:   $auth_protocol     = hiera('contrail::auth_protocol'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp", "content": "$middleware_user           = 'mcollective',", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n\n#\nclass mco_profile::params (\n$main_collective           = 'mcollective',\n$collectives               = undef,\n$middleware_hosts          = undef,\n8:   $middleware_user           = 'mcollective',\n$middleware_password       = 'mcollective',\n$middleware_ssl_port       = '61613',\n$ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n$ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n$ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n# Target line: 8\n\n      3: #\n      4: class mco_profile::params (\n      5:   $main_collective           = 'mcollective',\n      6:   $collectives               = undef,\n      7:   $middleware_hosts          = undef,\n>>>   8:   $middleware_user           = 'mcollective',\n      9:   $middleware_password       = 'mcollective',\n     10:   $middleware_ssl_port       = '61613',\n     11:   $ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n     12:   $ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n     13:   $ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-wrapper-example.pp", "content": "$brick1c = {", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n\nxfs_inode64 => true,\nxfs_nobarrier => true,\nareyousure => true,\n}\n\n28: $brick1c = {\ndev => '/dev/disk/by-id/scsi-36003048007e26c00173ad3b633a36700',\t# /dev/sdb\nlabeltype => 'gpt',\nfstype => 'xfs',\nfsuuid => '1c9ee010-9cd1-4d81-9a73-f0788d5b3e33',\nxfs_inode64 => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-wrapper-example.pp\n# Target line: 28\n\n     23: \txfs_inode64 => true,\n     24: \txfs_nobarrier => true,\n     25: \tareyousure => true,\n     26: }\n     27: \n>>>  28: $brick1c = {\n     29: \tdev => '/dev/disk/by-id/scsi-36003048007e26c00173ad3b633a36700',\t# /dev/sdb\n     30: \tlabeltype => 'gpt',\n     31: \tfstype => 'xfs',\n     32: \tfsuuid => '1c9ee010-9cd1-4d81-9a73-f0788d5b3e33',\n     33: \txfs_inode64 => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-finder.pp", "content": "key    => 'ShowStatusBar',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n\n}\n\nboxen::osx_defaults { 'Finder: show status bar':\nuser   => $::luser,\ndomain => 'com.apple.finder',\n29:     key    => 'ShowStatusBar',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Finder: show path bar':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n# Target line: 29\n\n     24:   }\n     25: \n     26:   boxen::osx_defaults { 'Finder: show status bar':\n     27:     user   => $::luser,\n     28:     domain => 'com.apple.finder',\n>>>  29:     key    => 'ShowStatusBar',\n     30:     type   => 'bool',\n     31:     value  => true,\n     32:   }\n     33: \n     34:   boxen::osx_defaults { 'Finder: show path bar':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$keystone_monitord_password = 'monitord'", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$keystone_admin_password    = 'admin'\n$keystone_admin_tenant      = 'admin'\n$keystone_nailgun_user      = 'nailgun'\n$keystone_nailgun_password  = 'nailgun'\n$keystone_monitord_user     = 'monitord'\n49:   $keystone_monitord_password = 'monitord'\n$keystone_monitord_tenant   = 'services'\n\n$keystone_admin_token       = 'admin'\n$keystone_token_expiration  = '86400'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 49\n\n     44:   $keystone_admin_password    = 'admin'\n     45:   $keystone_admin_tenant      = 'admin'\n     46:   $keystone_nailgun_user      = 'nailgun'\n     47:   $keystone_nailgun_password  = 'nailgun'\n     48:   $keystone_monitord_user     = 'monitord'\n>>>  49:   $keystone_monitord_password = 'monitord'\n     50:   $keystone_monitord_tenant   = 'services'\n     51: \n     52:   $keystone_admin_token       = 'admin'\n     53:   $keystone_token_expiration  = '86400'\n     54: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-tor-manifests-daemon-params.pp", "content": "$user          = 'toranon'", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n\n# setup variables for different distributions\nclass tor::daemon::params {\ncase $facts['osfamily'] {\n'RedHat': {\n5:       $user          = 'toranon'\n$group         = 'toranon'\n$manage_user   = false\n$data_dir_mode = '0750'\n}\n'Debian': {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n# Target line: 5\n\n      1: # setup variables for different distributions\n      2: class tor::daemon::params {\n      3:   case $facts['osfamily'] {\n      4:     'RedHat': {\n>>>   5:       $user          = 'toranon'\n      6:       $group         = 'toranon'\n      7:       $manage_user   = false\n      8:       $data_dir_mode = '0750'\n      9:     }\n     10:     'Debian': {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ceph-manifests-profile-mgr.pp", "content": "inject_key          => true,", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: openstack@puppet-ceph-manifests-profile-mgr.pp\n\nrequire ::ceph::profile::base\n\nceph::mgr { $::hostname:\nauthentication_type => $ceph::profile::params::authentication_type,\nkey                 => $ceph::profile::params::mgr_key,\n28:     inject_key          => true,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ceph-manifests-profile-mgr.pp\n# Target line: 28\n\n     23:   require ::ceph::profile::base\n     24: \n     25:   ceph::mgr { $::hostname:\n     26:     authentication_type => $ceph::profile::params::authentication_type,\n     27:     key                 => $ceph::profile::params::mgr_key,\n>>>  28:     inject_key          => true,\n     29:   }\n     30: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-pure.pp", "content": "pure_api_token               => hiera('cinder::backend::pure::pure_api_token', undef),", "line": 64, "detection_span": [59, 69], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-pure.pp\n\n\nif $step >= 4 {\ncinder::backend::pure { $backend_name :\nbackend_availability_zone    => hiera('cinder::backend::pure::backend_availability_zone', undef),\nsan_ip                       => hiera('cinder::backend::pure::san_ip', undef),\n64:       pure_api_token               => hiera('cinder::backend::pure::pure_api_token', undef),\npure_storage_protocol        => hiera('cinder::backend::pure::pure_storage_protocol', undef),\nuse_chap_auth                => hiera('cinder::backend::pure::use_chap_auth', undef),\nuse_multipath_for_image_xfer => hiera('cinder::backend::pure::use_multipath_for_image_xfer', undef),\nimage_volume_cache_enabled   => hiera('cinder::backend::pure::image_volume_cache_enabled', undef),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-pure.pp\n# Target line: 64\n\n     59: \n     60:   if $step >= 4 {\n     61:     cinder::backend::pure { $backend_name :\n     62:       backend_availability_zone    => hiera('cinder::backend::pure::backend_availability_zone', undef),\n     63:       san_ip                       => hiera('cinder::backend::pure::san_ip', undef),\n>>>  64:       pure_api_token               => hiera('cinder::backend::pure::pure_api_token', undef),\n     65:       pure_storage_protocol        => hiera('cinder::backend::pure::pure_storage_protocol', undef),\n     66:       use_chap_auth                => hiera('cinder::backend::pure::use_chap_auth', undef),\n     67:       use_multipath_for_image_xfer => hiera('cinder::backend::pure::use_multipath_for_image_xfer', undef),\n     68:       image_volume_cache_enabled   => hiera('cinder::backend::pure::image_volume_cache_enabled', undef),\n     69:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp", "content": "jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n\nserveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\njenkins_version             => hiera('jenkins_version', 'present'),\njenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\njenkins_username            => hiera('jenkins_username', 'jenkins'),\njenkins_password            => hiera('jenkins_password', 'XXX'),\n39:     jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\njenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\njava_args_override          => hiera('java_args_override', undef),\ngerrit_server               => hiera('gerrit_server', 'review.openstack.org'),\ngerrit_user                 => hiera('gerrit_user'),\ngerrit_user_ssh_public_key  => hiera('gerrit_user_ssh_public_key'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-single_node_ci_site.pp\n# Target line: 39\n\n     34:     serveradmin                 => hiera('serveradmin', \"webmaster@${vhost_name}\"),\n     35:     jenkins_version             => hiera('jenkins_version', 'present'),\n     36:     jenkins_vhost_name          => hiera('jenkins_vhost_name', 'jenkins'),\n     37:     jenkins_username            => hiera('jenkins_username', 'jenkins'),\n     38:     jenkins_password            => hiera('jenkins_password', 'XXX'),\n>>>  39:     jenkins_ssh_private_key     => hiera('jenkins_ssh_private_key'),\n     40:     jenkins_ssh_public_key      => hiera('jenkins_ssh_public_key'),\n     41:     java_args_override          => hiera('java_args_override', undef),\n     42:     gerrit_server               => hiera('gerrit_server', 'review.openstack.org'),\n     43:     gerrit_user                 => hiera('gerrit_user'),\n     44:     gerrit_user_ssh_public_key  => hiera('gerrit_user_ssh_public_key'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-aodh-keystone.pp", "content": "$aodh_user_name       = pick($aodh_hash['user'], 'aodh')", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-aodh-keystone.pp\n\nclass openstack_tasks::aodh::keystone {\n\nnotice('MODULAR: aodh/keystone.pp')\n\n$aodh_hash            = hiera_hash('aodh', {})\n6:   $aodh_user_name       = pick($aodh_hash['user'], 'aodh')\n$aodh_user_password   = $aodh_hash['user_password']\n$service_name         = pick($aodh_hash['service'], 'aodh')\n$region               = pick($aodh_hash['region'], hiera('region', 'RegionOne'))\n$tenant               = pick($aodh_hash['tenant'], 'services')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-aodh-keystone.pp\n# Target line: 6\n\n      1: class openstack_tasks::aodh::keystone {\n      2: \n      3:   notice('MODULAR: aodh/keystone.pp')\n      4: \n      5:   $aodh_hash            = hiera_hash('aodh', {})\n>>>   6:   $aodh_user_name       = pick($aodh_hash['user'], 'aodh')\n      7:   $aodh_user_password   = $aodh_hash['user_password']\n      8:   $service_name         = pick($aodh_hash['service'], 'aodh')\n      9:   $region               = pick($aodh_hash['region'], hiera('region', 'RegionOne'))\n     10:   $tenant               = pick($aodh_hash['tenant'], 'services')\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-monitor_messages.pp", "content": "$rabbitmq_user = 'monitoring',", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-monitor_messages.pp\n\n$rabbitmq_queue,\n$critical_threshold,\n$warning_threshold,\n$ensure = present,\n$rabbitmq_hostname = 'rabbitmq-1.backend',\n35:   $rabbitmq_user = 'monitoring',\n$rabbitmq_admin_port = 15672,\n){\n\nif $ensure == present {\ninclude icinga::plugin::check_rabbitmq_messages", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-monitor_messages.pp\n# Target line: 35\n\n     30:   $rabbitmq_queue,\n     31:   $critical_threshold,\n     32:   $warning_threshold,\n     33:   $ensure = present,\n     34:   $rabbitmq_hostname = 'rabbitmq-1.backend',\n>>>  35:   $rabbitmq_user = 'monitoring',\n     36:   $rabbitmq_admin_port = 15672,\n     37: ){\n     38: \n     39:   if $ensure == present {\n     40:     include icinga::plugin::check_rabbitmq_messages\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-nova-libvirt.pp", "content": "$tls_password    = '',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-nova-libvirt.pp\n\n#   Defaults to '' (disabled)\n#\nclass tripleo::profile::base::nova::libvirt (\n$step = Integer(hiera('step')),\n$libvirtd_config = {},\n37:   $tls_password    = '',\n) {\ninclude ::tripleo::profile::base::nova::compute_libvirt_shared\n\nif $step >= 4 {\ninclude ::tripleo::profile::base::nova", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-nova-libvirt.pp\n# Target line: 37\n\n     32: #   Defaults to '' (disabled)\n     33: #\n     34: class tripleo::profile::base::nova::libvirt (\n     35:   $step = Integer(hiera('step')),\n     36:   $libvirtd_config = {},\n>>>  37:   $tls_password    = '',\n     38: ) {\n     39:   include ::tripleo::profile::base::nova::compute_libvirt_shared\n     40: \n     41:   if $step >= 4 {\n     42:     include ::tripleo::profile::base::nova\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-compute.pp", "content": "$default_ceilometer_hash = {", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-compute.pp\n\n$syslog_log_facility      = hiera('syslog_log_facility_ceilometer', 'LOG_LOCAL0')\n$rabbit_hash              = hiera_hash('rabbit')\n$management_vip           = hiera('management_vip')\n$service_endpoint         = hiera('service_endpoint', $management_vip)\n\n12:   $default_ceilometer_hash = {\n'enabled'                    => false,\n'db_password'                => 'ceilometer',\n'user_password'              => 'ceilometer',\n'metering_secret'            => 'ceilometer',\n'http_timeout'               => '600',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-ceilometer-compute.pp\n# Target line: 12\n\n      7:   $syslog_log_facility      = hiera('syslog_log_facility_ceilometer', 'LOG_LOCAL0')\n      8:   $rabbit_hash              = hiera_hash('rabbit')\n      9:   $management_vip           = hiera('management_vip')\n     10:   $service_endpoint         = hiera('service_endpoint', $management_vip)\n     11: \n>>>  12:   $default_ceilometer_hash = {\n     13:     'enabled'                    => false,\n     14:     'db_password'                => 'ceilometer',\n     15:     'user_password'              => 'ceilometer',\n     16:     'metering_secret'            => 'ceilometer',\n     17:     'http_timeout'               => '600',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-cli.pp", "content": "$jenkins_api_user = 'jenkins_api_user',", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-cli.pp\n\n# [*jenkins_api_token*]\n#   The token used to authenticate with the Jenkins API.\n#\nclass govuk_jenkins::cli (\n$jenkins_home = '/var/lib/jenkins',\n27:   $jenkins_api_user = 'jenkins_api_user',\n$jenkins_api_token = '',\n) {\nrequire ::govuk_jenkins\n\ncurl::fetch { 'Jenkins CLI tool':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-cli.pp\n# Target line: 27\n\n     22: # [*jenkins_api_token*]\n     23: #   The token used to authenticate with the Jenkins API.\n     24: #\n     25: class govuk_jenkins::cli (\n     26:   $jenkins_home = '/var/lib/jenkins',\n>>>  27:   $jenkins_api_user = 'jenkins_api_user',\n     28:   $jenkins_api_token = '',\n     29: ) {\n     30:   require ::govuk_jenkins\n     31: \n     32:   curl::fetch { 'Jenkins CLI tool':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-disk_cache.pp", "content": "$cache_root = undef,", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-disk_cache.pp\n\nclass apache::mod::disk_cache (\n2:   $cache_root = undef,\n) {\ninclude ::apache\nif $cache_root {\n$_cache_root = $cache_root\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-disk_cache.pp\n# Target line: 2\n\n      1: class apache::mod::disk_cache (\n>>>   2:   $cache_root = undef,\n      3: ) {\n      4:   include ::apache\n      5:   if $cache_root {\n      6:     $_cache_root = $cache_root\n      7:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-resources-database.pp", "content": "$user = getvar(\"::openstack::config::mysql_user_${title}\"),", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-database.pp\n\ndefine openstack::resources::database (\n2:   $user = getvar(\"::openstack::config::mysql_user_${title}\"),\n$password = getvar(\"::openstack::config::mysql_pass_${title}\"),\n) {\nclass { \"::${title}::db::mysql\":\nuser          => $user,\npassword      => $password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-database.pp\n# Target line: 2\n\n      1: define openstack::resources::database (\n>>>   2:   $user = getvar(\"::openstack::config::mysql_user_${title}\"),\n      3:   $password = getvar(\"::openstack::config::mysql_pass_${title}\"),\n      4: ) {\n      5:   class { \"::${title}::db::mysql\":\n      6:     user          => $user,\n      7:     password      => $password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-mahmudhussain.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCx9sd0QWv6mbNVp6EYcZ0RWS3VBu3gRqt5EvJBscWnPrxcK265df0NXFFQ0HdNFVYybcfNw7wjBuz7WLUd8M3p3uWoZtoaQNq8fH5AxUC1yvQbOaFLFcFuOGOLvS+ej3CBns3OQ+r02kuZijYHVPbGFwjKJps2621gP6E3LWGuJMnf58GUu5TEte6jKDGhiIe/3/0dAhlv+epKa9kCmi+uRgKZoxZyucjsQ8LrdLuw1kIghJ04qkDiMqyCasG9omwsAdMbEDA6kj8IJpbJV7wX1e8KSCQZFy8d+OxwN+9FMkvly7ZpET2ABbw69Wj0kTs4g4gXX5wW6w35Zd6OX+asnQztL4sRaTkhtNCpSjuiIpIO09Rq7+V7shy16P5OAZS/EDA7XTtV/CGDE6Id2hccFzwqJBkPqaWwTHfWRbmXSJuqfiHDF+5nViOgkQGd0J2OLwxN/cKFPW5zo5Wj7RCbkowM2UVO19QsU7EXVrPWc/t+CfDSRgu+uAEJZbH6kmOsrhBXtdU35J46MY8nPQjHc0FHaiXA8mdrK4EDZ/y5dAGW2fyAlgf5lPk/kxeWAv8+c9yX3u3uIzsO//iQTpC3y0jZgpZYLN21ehoLtiZS/c1H/OR8CwhH2eW973C7RUO3UXPlLiAbtpvjJ6PUCQQbrIe9/nwlZvX5l8S3JGnqRQ== mahmud.hussain@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-mahmudhussain.pp\n\n# Creates mahmudhussain user\nclass users::mahmudhussain {\ngovuk_user { 'mahmudhussain':\nfullname => 'Mahmud Hussain',\nemail    => 'mahmud.hussain@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCx9sd0QWv6mbNVp6EYcZ0RWS3VBu3gRqt5EvJBscWnPrxcK265df0NXFFQ0HdNFVYybcfNw7wjBuz7WLUd8M3p3uWoZtoaQNq8fH5AxUC1yvQbOaFLFcFuOGOLvS+ej3CBns3OQ+r02kuZijYHVPbGFwjKJps2621gP6E3LWGuJMnf58GUu5TEte6jKDGhiIe/3/0dAhlv+epKa9kCmi+uRgKZoxZyucjsQ8LrdLuw1kIghJ04qkDiMqyCasG9omwsAdMbEDA6kj8IJpbJV7wX1e8KSCQZFy8d+OxwN+9FMkvly7ZpET2ABbw69Wj0kTs4g4gXX5wW6w35Zd6OX+asnQztL4sRaTkhtNCpSjuiIpIO09Rq7+V7shy16P5OAZS/EDA7XTtV/CGDE6Id2hccFzwqJBkPqaWwTHfWRbmXSJuqfiHDF+5nViOgkQGd0J2OLwxN/cKFPW5zo5Wj7RCbkowM2UVO19QsU7EXVrPWc/t+CfDSRgu+uAEJZbH6kmOsrhBXtdU35J46MY8nPQjHc0FHaiXA8mdrK4EDZ/y5dAGW2fyAlgf5lPk/kxeWAv8+c9yX3u3uIzsO//iQTpC3y0jZgpZYLN21ehoLtiZS/c1H/OR8CwhH2eW973C7RUO3UXPlLiAbtpvjJ6PUCQQbrIe9/nwlZvX5l8S3JGnqRQ== mahmud.hussain@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-mahmudhussain.pp\n# Target line: 6\n\n      1: # Creates mahmudhussain user\n      2: class users::mahmudhussain {\n      3:   govuk_user { 'mahmudhussain':\n      4:     fullname => 'Mahmud Hussain',\n      5:     email    => 'mahmud.hussain@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCx9sd0QWv6mbNVp6EYcZ0RWS3VBu3gRqt5EvJBscWnPrxcK265df0NXFFQ0HdNFVYybcfNw7wjBuz7WLUd8M3p3uWoZtoaQNq8fH5AxUC1yvQbOaFLFcFuOGOLvS+ej3CBns3OQ+r02kuZijYHVPbGFwjKJps2621gP6E3LWGuJMnf58GUu5TEte6jKDGhiIe/3/0dAhlv+epKa9kCmi+uRgKZoxZyucjsQ8LrdLuw1kIghJ04qkDiMqyCasG9omwsAdMbEDA6kj8IJpbJV7wX1e8KSCQZFy8d+OxwN+9FMkvly7ZpET2ABbw69Wj0kTs4g4gXX5wW6w35Zd6OX+asnQztL4sRaTkhtNCpSjuiIpIO09Rq7+V7shy16P5OAZS/EDA7XTtV/CGDE6Id2hccFzwqJBkPqaWwTHfWRbmXSJuqfiHDF+5nViOgkQGd0J2OLwxN/cKFPW5zo5Wj7RCbkowM2UVO19QsU7EXVrPWc/t+CfDSRgu+uAEJZbH6kmOsrhBXtdU35J46MY8nPQjHc0FHaiXA8mdrK4EDZ/y5dAGW2fyAlgf5lPk/kxeWAv8+c9yX3u3uIzsO//iQTpC3y0jZgpZYLN21ehoLtiZS/c1H/OR8CwhH2eW973C7RUO3UXPlLiAbtpvjJ6PUCQQbrIe9/nwlZvX5l8S3JGnqRQ== mahmud.hussain@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-course-virtual-practitioner.pp", "content": "stomp_password   => chomp(file('/etc/puppetlabs/mcollective/credentials','/dev/null')),", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-course-virtual-practitioner.pp\n\npuppet_enterprise::mcollective::client { 'peadmin':\nactivemq_brokers => ['master.puppetlabs.vm'],\nkeypair_name     => 'pe-internal-peadmin-mcollective-client',\ncreate_user      => true,\nlogfile          => '/var/lib/peadmin/.mcollective.d/client.log',\n46:       stomp_password   => chomp(file('/etc/puppetlabs/mcollective/credentials','/dev/null')),\nstomp_port       => 61613,\nstomp_user       => 'mcollective',\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-course-virtual-practitioner.pp\n# Target line: 46\n\n     41:     puppet_enterprise::mcollective::client { 'peadmin':\n     42:       activemq_brokers => ['master.puppetlabs.vm'],\n     43:       keypair_name     => 'pe-internal-peadmin-mcollective-client',\n     44:       create_user      => true,\n     45:       logfile          => '/var/lib/peadmin/.mcollective.d/client.log',\n>>>  46:       stomp_password   => chomp(file('/etc/puppetlabs/mcollective/credentials','/dev/null')),\n     47:       stomp_port       => 61613,\n     48:       stomp_user       => 'mcollective',\n     49:     }\n     50:   }\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp", "content": "key        => '16d09fb4',", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n\n$os = downcase($::operatingsystem)\n\ncase $::osfamily {\n'debian': {\napt::key { 'hhvm':\n95:         key        => '16d09fb4',\nkey_source => 'http://dl.hhvm.com/conf/hhvm.gpg.key',\n}\n\napt::source { 'hhvm':\nlocation          => \"http://dl.hhvm.com/${os}\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n# Target line: 95\n\n     90:   $os = downcase($::operatingsystem)\n     91: \n     92:   case $::osfamily {\n     93:     'debian': {\n     94:       apt::key { 'hhvm':\n>>>  95:         key        => '16d09fb4',\n     96:         key_source => 'http://dl.hhvm.com/conf/hhvm.gpg.key',\n     97:       }\n     98: \n     99:       apt::source { 'hhvm':\n    100:         location          => \"http://dl.hhvm.com/${os}\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack-infra@puppet-openstackci-contrib-log_server_site.pp", "content": "swift_key               => hiera('swift_key', ''),", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n\ndomain                  => hiera('domain'),\njenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\nara_middleware          => hiera('ara_middleware', false),\nswift_authurl           => hiera('swift_authurl', ''),\nswift_user              => hiera('swift_user', ''),\n29:     swift_key               => hiera('swift_key', ''),\nswift_tenant_name       => hiera('swift_tenant_name', ''),\nswift_region_name       => hiera('swift_region_name', ''),\nswift_default_container => hiera('swift_default_container', ''),\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-contrib-log_server_site.pp\n# Target line: 29\n\n     24:     domain                  => hiera('domain'),\n     25:     jenkins_ssh_key         => hiera('jenkins_ssh_public_key'),\n     26:     ara_middleware          => hiera('ara_middleware', false),\n     27:     swift_authurl           => hiera('swift_authurl', ''),\n     28:     swift_user              => hiera('swift_user', ''),\n>>>  29:     swift_key               => hiera('swift_key', ''),\n     30:     swift_tenant_name       => hiera('swift_tenant_name', ''),\n     31:     swift_region_name       => hiera('swift_region_name', ''),\n     32:     swift_default_container => hiera('swift_default_container', ''),\n     33:   }\n     34: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhosts_without_listen.pp", "content": "docroot    => '/var/www/fifth',", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhosts_without_listen.pp\n\ndocroot    => '/var/www/fourth',\nadd_listen => false,\n}\napache::vhost { 'fifth.example.com':\nport       => '80',\n51:   docroot    => '/var/www/fifth',\nadd_listen => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-examples-vhosts_without_listen.pp\n# Target line: 51\n\n     46:   docroot    => '/var/www/fourth',\n     47:   add_listen => false,\n     48: }\n     49: apache::vhost { 'fifth.example.com':\n     50:   port       => '80',\n>>>  51:   docroot    => '/var/www/fifth',\n     52:   add_listen => false,\n     53: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-global-key_repeat_delay.pp", "content": "key    => 'InitialKeyRepeat',", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: boxen@puppet-osx-manifests-global-key_repeat_delay.pp\n\n#   }\nclass osx::global::key_repeat_delay($delay = 35) {\nboxen::osx_defaults { 'key repeat delay':\ndomain => 'NSGlobalDomain',\ntype   => 'int',\n18:     key    => 'InitialKeyRepeat',\nvalue  => $delay,\nuser   => $::boxen_user\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-global-key_repeat_delay.pp\n# Target line: 18\n\n     13: #   }\n     14: class osx::global::key_repeat_delay($delay = 35) {\n     15:   boxen::osx_defaults { 'key repeat delay':\n     16:     domain => 'NSGlobalDomain',\n     17:     type   => 'int',\n>>>  18:     key    => 'InitialKeyRepeat',\n     19:     value  => $delay,\n     20:     user   => $::boxen_user\n     21:   }\n     22: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-ironic.pp", "content": "password => 'ironic',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-ironic.pp\n\nrabbit_use_ssl        => $::openstack_integration::config::ssl,\namqp_sasl_mechanisms  => 'PLAIN',\ndatabase_connection   => 'mysql+pymysql://ironic:ironic@127.0.0.1/ironic?charset=utf8',\n}\nclass { '::ironic::db::mysql':\n34:     password => 'ironic',\n}\nclass { '::ironic::keystone::auth':\npublic_url   => \"${::openstack_integration::config::base_url}:6385\",\ninternal_url => \"${::openstack_integration::config::base_url}:6385\",\nadmin_url    => \"${::openstack_integration::config::base_url}:6385\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-ironic.pp\n# Target line: 34\n\n     29:     rabbit_use_ssl        => $::openstack_integration::config::ssl,\n     30:     amqp_sasl_mechanisms  => 'PLAIN',\n     31:     database_connection   => 'mysql+pymysql://ironic:ironic@127.0.0.1/ironic?charset=utf8',\n     32:   }\n     33:   class { '::ironic::db::mysql':\n>>>  34:     password => 'ironic',\n     35:   }\n     36:   class { '::ironic::keystone::auth':\n     37:     public_url   => \"${::openstack_integration::config::base_url}:6385\",\n     38:     internal_url => \"${::openstack_integration::config::base_url}:6385\",\n     39:     admin_url    => \"${::openstack_integration::config::base_url}:6385\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-router-manifests-errorpage.pp", "content": "user    => 'deploy',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n\n$cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n\nexec { \"update_error_page_${title}\":\ncommand => $cmd,\nunless  => \"find ${filename} -mmin -360 -print 2>/dev/null | grep -Eqs '^${filename}$'\",\n24:     user    => 'deploy',\ngroup   => 'deploy',\nrequire => Class['curl'],\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n# Target line: 24\n\n     19:   $cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n     20: \n     21:   exec { \"update_error_page_${title}\":\n     22:     command => $cmd,\n     23:     unless  => \"find ${filename} -mmin -360 -print 2>/dev/null | grep -Eqs '^${filename}$'\",\n>>>  24:     user    => 'deploy',\n     25:     group   => 'deploy',\n     26:     require => Class['curl'],\n     27:   }\n     28: \n     29: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-nginx-manifests-params.pp", "content": "$_module_os_overrides = {", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-params.pp\n\n}\ndefault: {\n## For cases not covered in $::osfamily\ncase $::operatingsystem {\n'SmartOS': {\n71:           $_module_os_overrides = {\n'conf_dir'    => '/usr/local/etc/nginx',\n'daemon_user' => 'www',\n}\n}\ndefault: { $_module_os_overrides = {} }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-params.pp\n# Target line: 71\n\n     66:     }\n     67:     default: {\n     68:       ## For cases not covered in $::osfamily\n     69:       case $::operatingsystem {\n     70:         'SmartOS': {\n>>>  71:           $_module_os_overrides = {\n     72:             'conf_dir'    => '/usr/local/etc/nginx',\n     73:             'daemon_user' => 'www',\n     74:           }\n     75:         }\n     76:         default: { $_module_os_overrides = {} }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-config.pp", "content": "docroot => '/var/www/labs',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-config.pp\n\ndefault_vhost => false,\n# overwrite_ports => false,\n}\napache::vhost { 'vhost.labs.com':\nport    => \"$port\",\n43:     docroot => '/var/www/labs',\n}\n\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-config.pp\n# Target line: 43\n\n     38:     default_vhost => false,\n     39:     # overwrite_ports => false,\n     40:   }\n     41:   apache::vhost { 'vhost.labs.com':\n     42:     port    => \"$port\",\n>>>  43:     docroot => '/var/www/labs',\n     44:   }\n     45: \n     46: \n     47: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-perestroika-publisher.pp", "content": "$gpg_pub_key_owner  = 'jenkins',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-perestroika-publisher.pp\n\nclass fuel_project::roles::perestroika::publisher (\n$gpg_content_priv,\n$gpg_content_pub,\n$gpg_id_priv,\n$gpg_id_pub,\n21:   $gpg_pub_key_owner  = 'jenkins',\n$gpg_priv_key_owner = 'jenkins',\n$packages = [\n'createrepo',\n'devscripts',\n'expect',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-perestroika-publisher.pp\n# Target line: 21\n\n     16: class fuel_project::roles::perestroika::publisher (\n     17:   $gpg_content_priv,\n     18:   $gpg_content_pub,\n     19:   $gpg_id_priv,\n     20:   $gpg_id_pub,\n>>>  21:   $gpg_pub_key_owner  = 'jenkins',\n     22:   $gpg_priv_key_owner = 'jenkins',\n     23:   $packages = [\n     24:     'createrepo',\n     25:     'devscripts',\n     26:     'expect',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-local_links_manager-db.pp", "content": "user                    => 'local_links_manager',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-local_links_manager-db.pp\n\n$allow_auth_from_lb = false,\n$lb_ip_range = undef,\n$rds = false,\n) {\ngovuk_postgresql::db { 'local-links-manager_production':\n31:     user                    => 'local_links_manager',\npassword                => $password,\nallow_auth_from_backend => true,\nbackend_ip_range        => $backend_ip_range,\nallow_auth_from_lb      => $allow_auth_from_lb,\nlb_ip_range             => $lb_ip_range,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-local_links_manager-db.pp\n# Target line: 31\n\n     26:   $allow_auth_from_lb = false,\n     27:   $lb_ip_range = undef,\n     28:   $rds = false,\n     29: ) {\n     30:   govuk_postgresql::db { 'local-links-manager_production':\n>>>  31:     user                    => 'local_links_manager',\n     32:     password                => $password,\n     33:     allow_auth_from_backend => true,\n     34:     backend_ip_range        => $backend_ip_range,\n     35:     allow_auth_from_lb      => $allow_auth_from_lb,\n     36:     lb_ip_range             => $lb_ip_range,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-osx-manifests-finder-empty_trash_securely.pp", "content": "key    => 'EmptyTrashSecurely',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: boxen@puppet-osx-manifests-finder-empty_trash_securely.pp\n\nclass osx::finder::empty_trash_securely {\ninclude osx::finder\n\nboxen::osx_defaults { 'Securely Empty Trash':\nuser   => $::boxen_user,\n7:     key    => 'EmptyTrashSecurely',\ndomain => 'com.apple.finder',\nvalue  => true,\nnotify => Exec['killall Finder'];\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-osx-manifests-finder-empty_trash_securely.pp\n# Target line: 7\n\n      2: class osx::finder::empty_trash_securely {\n      3:   include osx::finder\n      4: \n      5:   boxen::osx_defaults { 'Securely Empty Trash':\n      6:     user   => $::boxen_user,\n>>>   7:     key    => 'EmptyTrashSecurely',\n      8:     domain => 'com.apple.finder',\n      9:     value  => true,\n     10:     notify => Exec['killall Finder'];\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "garethr@garethr-docker-manifests-swarm.pp", "content": "$token = undef,", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: garethr@garethr-docker-manifests-swarm.pp\n\n$external_ca = undef,\n$force_new_cluster = false,\n$listen_addr = undef,\n$max_snapshots = undef,\n$snapshot_interval = undef,\n87:   $token = undef,\n$manager_ip = undef,\n){\n\ninclude docker::params\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: garethr@garethr-docker-manifests-swarm.pp\n# Target line: 87\n\n     82:   $external_ca = undef,\n     83:   $force_new_cluster = false,\n     84:   $listen_addr = undef,\n     85:   $max_snapshots = undef,\n     86:   $snapshot_interval = undef,\n>>>  87:   $token = undef,\n     88:   $manager_ip = undef,\n     89:   ){\n     90: \n     91:   include docker::params\n     92: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp", "content": "$password = hiera('monitoring_rabbitmq_password', undef),", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n\n# [*vhost*]\n#   (Optional) String. RabbitMQ vhost to be used by Sensu\n#   Defaults to '/sensu'\n#\nclass tripleo::profile::base::monitoring::rabbitmq (\n34:   $password = hiera('monitoring_rabbitmq_password', undef),\n$user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n$vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n) {\nwarning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-monitoring-rabbitmq.pp\n# Target line: 34\n\n     29: # [*vhost*]\n     30: #   (Optional) String. RabbitMQ vhost to be used by Sensu\n     31: #   Defaults to '/sensu'\n     32: #\n     33: class tripleo::profile::base::monitoring::rabbitmq (\n>>>  34:   $password = hiera('monitoring_rabbitmq_password', undef),\n     35:   $user     = hiera('monitoring_rabbitmq_username', 'sensu'),\n     36:   $vhost    = hiera('monitoring_rabbitmq_vhost', '/sensu'),\n     37: ) {\n     38:   warning('Service sensu-client is deprecated. Please take in mind, that it is going to be removed in T release.')\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp", "content": "netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),", "line": 96, "detection_span": [91, 101], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n\n}\n\nelsif $netapp_storage_protocol == 'fc' {\ncinder::backend::netapp { $netapp_backend_name:\nnetapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\n96:           netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\nnetapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\nnetapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\nnetapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\nnetapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),\nnetapp_storage_protocol     => hiera('CONFIG_CINDER_NETAPP_STORAGE_PROTOCOL'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-cinder-backend-netapp.pp\n# Target line: 96\n\n     91:       }\n     92: \n     93:       elsif $netapp_storage_protocol == 'fc' {\n     94:         cinder::backend::netapp { $netapp_backend_name:\n     95:           netapp_login                => hiera('CONFIG_CINDER_NETAPP_LOGIN'),\n>>>  96:           netapp_password             => hiera('CONFIG_CINDER_NETAPP_PASSWORD'),\n     97:           netapp_server_hostname      => hiera('CONFIG_CINDER_NETAPP_HOSTNAME'),\n     98:           netapp_server_port          => hiera('CONFIG_CINDER_NETAPP_SERVER_PORT'),\n     99:           netapp_size_multiplier      => hiera('CONFIG_CINDER_NETAPP_SIZE_MULTIPLIER'),\n    100:           netapp_storage_family       => hiera('CONFIG_CINDER_NETAPP_STORAGE_FAMILY'),\n    101:           netapp_storage_protocol     => hiera('CONFIG_CINDER_NETAPP_STORAGE_PROTOCOL'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp", "content": "service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n\nrequire => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n} ->\nmanila::service_instance{ 'generic':\nservice_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\nservice_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\n36:       service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\nservice_instance_network_helper_type => $service_instance_network_helper_type,\nservice_instance_flavor_id           => 66,\n}\n\nclass { '::manila::compute::nova':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n# Target line: 36\n\n     31:       require => [ Class['::nova::api'], Class['::nova::keystone::auth'] ],\n     32:     } ->\n     33:     manila::service_instance{ 'generic':\n     34:       service_image_location               => hiera('CONFIG_MANILA_SERVICE_IMAGE_LOCATION'),\n     35:       service_instance_user                => hiera('CONFIG_MANILA_SERVICE_INSTANCE_USER'),\n>>>  36:       service_instance_password            => hiera('CONFIG_MANILA_SERVICE_INSTANCE_PASSWORD'),\n     37:       service_instance_network_helper_type => $service_instance_network_helper_type,\n     38:       service_instance_flavor_id           => 66,\n     39:     }\n     40: \n     41:     class { '::manila::compute::nova':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-examples-server.pp", "content": "root_password => 'password',", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-server.pp\n\nclass { 'mysql::server':\n2:   root_password => 'password',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-server.pp\n# Target line: 2\n\n      1: class { 'mysql::server':\n>>>   2:   root_password => 'password',\n      3: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$cobbler_user                  = 'cobbler'", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$rabbitmq_management_port      = 15672\n$rabbitmq_management_bind_ip   = '127.0.0.1'\n\n$cobbler_host                  = $::ipaddress\n$cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n70:   $cobbler_user                  = 'cobbler'\n$cobbler_password              = 'cobbler'\n$centos_repos = [\n{\n'id'   => 'nailgun',\n'name' => 'Nailgun',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 70\n\n     65:   $rabbitmq_management_port      = 15672\n     66:   $rabbitmq_management_bind_ip   = '127.0.0.1'\n     67: \n     68:   $cobbler_host                  = $::ipaddress\n     69:   $cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n>>>  70:   $cobbler_user                  = 'cobbler'\n     71:   $cobbler_password              = 'cobbler'\n     72:   $centos_repos = [\n     73:     {\n     74:     'id'   => 'nailgun',\n     75:     'name' => 'Nailgun',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gds-operations@puppet-graphite-manifests-params.pp", "content": "$admin_password = 'sha1$1b11b$edeb0a67a9622f1f2cfeabf9188a711f5ac7d236'", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: gds-operations@puppet-graphite-manifests-params.pp\n\n# == Class: graphite::params\n#\n# Class to set default graphite params\n#\nclass graphite::params {\n6:   $admin_password = 'sha1$1b11b$edeb0a67a9622f1f2cfeabf9188a711f5ac7d236'\n$bind_address = '127.0.0.1'\n$port = 8000\n$root_dir = '/opt/graphite'\n$version = '0.9.12'\n$worker_processes = 2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: gds-operations@puppet-graphite-manifests-params.pp\n# Target line: 6\n\n      1: # == Class: graphite::params\n      2: #\n      3: # Class to set default graphite params\n      4: #\n      5: class graphite::params {\n>>>   6:   $admin_password = 'sha1$1b11b$edeb0a67a9622f1f2cfeabf9188a711f5ac7d236'\n      7:   $bind_address = '127.0.0.1'\n      8:   $port = 8000\n      9:   $root_dir = '/opt/graphite'\n     10:   $version = '0.9.12'\n     11:   $worker_processes = 2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp", "content": "# Postfix MTA service", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n\n# == Class: postfix\n#\n3: # Postfix MTA service\n#\nclass postfix {\n\n# T160660: Upgrade openssl before installing postfix.\n# Note: ensure => latest here is gross but there really isn't another way", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n# Target line: 3\n\n      1: # == Class: postfix\n      2: #\n>>>   3: # Postfix MTA service\n      4: #\n      5: class postfix {\n      6: \n      7:     # T160660: Upgrade openssl before installing postfix.\n      8:     # Note: ensure => latest here is gross but there really isn't another way\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "zend-patterns@ZendServerPuppet-manifests-zsmanage.pp", "content": "# TODO: use params class pattern", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-zsmanage.pp\n\n# Options to supply to the Zend Server command. See \"/usr/local/zend/bin/zs-manage --help\" for a list of the relevant options for each command.\n# [*zsurl*]\n# URL To the Zend Server web API (Default: http://localhost:10081/ZendServer)\n# [*onlyif*]\n# If this parameter is set, then this will only run if the command has an exit code of 0.\n19: # TODO: use params class pattern\n# TODO: merge into zendserver::sdk class as a provider\ndefine zendserver::zsmanage (\n$command,\n$zskey,\n$zssecret,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-zsmanage.pp\n# Target line: 19\n\n     14: # Options to supply to the Zend Server command. See \"/usr/local/zend/bin/zs-manage --help\" for a list of the relevant options for each command.\n     15: # [*zsurl*]\n     16: # URL To the Zend Server web API (Default: http://localhost:10081/ZendServer)\n     17: # [*onlyif*]\n     18: # If this parameter is set, then this will only run if the command has an exit code of 0.\n>>>  19: # TODO: use params class pattern\n     20: # TODO: merge into zendserver::sdk class as a provider\n     21: define zendserver::zsmanage (\n     22:   $command,\n     23:   $zskey,\n     24:   $zssecret,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "String                          $mydestination       = '$myorigin',   # postfix_mydestination", "line": 109, "detection_span": [104, 114], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nOptional[String]                $master_submission   = undef,         # postfix_master_submission\nOptional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\nString                          $master_bounce_command = 'bounce',\nString                          $master_defer_command  = 'bounce',\nBoolean                         $mta                 = false,\n109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\nString                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\nString                          $myorigin            = $::fqdn,\nOptional[String]                $relayhost           = undef,         # postfix_relayhost\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 109\n\n    104:   Optional[String]                $master_submission   = undef,         # postfix_master_submission\n    105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\n    106:   String                          $master_bounce_command = 'bounce',\n    107:   String                          $master_defer_command  = 'bounce',\n    108:   Boolean                         $mta                 = false,\n>>> 109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\n    110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n    111:   String                          $myorigin            = $::fqdn,\n    112:   Optional[String]                $relayhost           = undef,         # postfix_relayhost\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-nginx-manifests-resource-streamhost.pp", "content": "#   [*resolver*]            - Array: Configures name servers used to resolve", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-resource-streamhost.pp\n\n#   [*proxy*]               - Proxy server(s) for the root location to connect\n#     to.  Accepts a single value, can be used in conjunction with\n#     nginx::resource::upstream\n#   [*proxy_read_timeout*]  - Override the default the proxy read timeout value\n#     of 90 seconds\n29: #   [*resolver*]            - Array: Configures name servers used to resolve\n#     names of upstream servers into addresses.\n#   [*server_name*]         - List of streamhost names for which this streamhost will\n#     respond. Default [$name].\n#   [*raw_prepend*]            - A single string, or an array of strings to\n#     prepend to the server directive (after cfg prepend directives). NOTE:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-nginx-manifests-resource-streamhost.pp\n# Target line: 29\n\n     24: #   [*proxy*]               - Proxy server(s) for the root location to connect\n     25: #     to.  Accepts a single value, can be used in conjunction with\n     26: #     nginx::resource::upstream\n     27: #   [*proxy_read_timeout*]  - Override the default the proxy read timeout value\n     28: #     of 90 seconds\n>>>  29: #   [*resolver*]            - Array: Configures name servers used to resolve\n     30: #     names of upstream servers into addresses.\n     31: #   [*server_name*]         - List of streamhost names for which this streamhost will\n     32: #     respond. Default [$name].\n     33: #   [*raw_prepend*]            - A single string, or an array of strings to\n     34: #     prepend to the server directive (after cfg prepend directives). NOTE:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sbadia@puppet-gitlab-manifests-ci-setup.pp", "content": "# solution, please see issue #114 if you have a better solution.", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-setup.pp\n\n\n# By default, puppet-rbenv sets ~/.profile to load rbenv, which is\n# read when bash is invoked as an interactive login shell, but we\n# also need ~/.bashrc to load rbenv (which is read by interactive\n# but non-login shells). This works, but may not be the best\n67:   # solution, please see issue #114 if you have a better solution.\nfile { \"${ci_home}/.bashrc\":\nensure  => file,\ncontent => \"source ${ci_home}/.rbenvrc\",\nrequire => Rbenv::Install[$ci_user],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-setup.pp\n# Target line: 67\n\n     62: \n     63:   # By default, puppet-rbenv sets ~/.profile to load rbenv, which is\n     64:   # read when bash is invoked as an interactive login shell, but we\n     65:   # also need ~/.bashrc to load rbenv (which is read by interactive\n     66:   # but non-login shells). This works, but may not be the best\n>>>  67:   # solution, please see issue #114 if you have a better solution.\n     68:   file { \"${ci_home}/.bashrc\":\n     69:     ensure  => file,\n     70:     content => \"source ${ci_home}/.rbenvrc\",\n     71:     require => Rbenv::Install[$ci_user],\n     72:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-psql.pp", "content": "# TODO: FIXME: shellquote does not work, and this regex works for trivial", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-psql.pp\n\n$user        = $postgresql::params::user\n) {\n\ninclude postgresql::params\n\n29:   # TODO: FIXME: shellquote does not work, and this regex works for trivial\n# things but not nested escaping.  Need a lexer, preferably a ruby SQL parser\n# to catch errors at catalog time.  Possibly https://github.com/omghax/sql ?\n\nif ($postgresql::params::version != '8.1') {\n$no_password_option = '--no-password'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-psql.pp\n# Target line: 29\n\n     24:     $user        = $postgresql::params::user\n     25: ) {\n     26: \n     27:   include postgresql::params\n     28: \n>>>  29:   # TODO: FIXME: shellquote does not work, and this regex works for trivial\n     30:   # things but not nested escaping.  Need a lexer, preferably a ruby SQL parser\n     31:   # to catch errors at catalog time.  Possibly https://github.com/omghax/sql ?\n     32: \n     33:   if ($postgresql::params::version != '8.1') {\n     34:     $no_password_option = '--no-password'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-config.pp", "content": "# == Definition: postfix::config", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n\n#\n2: # == Definition: postfix::config\n#\n# Uses Augeas to add/alter/remove options in postfix main\n# configuation file (/etc/postfix/main.cf).\n#\n# TODO: make this a type with an Augeas and a postconf providers.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n# Target line: 2\n\n      1: #\n>>>   2: # == Definition: postfix::config\n      3: #\n      4: # Uses Augeas to add/alter/remove options in postfix main\n      5: # configuation file (/etc/postfix/main.cf).\n      6: #\n      7: # TODO: make this a type with an Augeas and a postconf providers.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-astute.pp", "content": "# FIXME(dteselkin): use correct versions of rubygem packages", "line": 90, "detection_span": [85, 95], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-astute.pp\n\nowner  => 'root',\ngroup  => 'root',\nmode   => '0755',\n}\n\n90:   # FIXME(dteselkin): use correct versions of rubygem packages\nexec {'use correct versions of rubygem packages':\ncommand => '/usr/bin/sed -i \"/amq-protocol/ s/~>/>=/\" /usr/share/gems/specifications/amqp-*.gemspec',\nrequire => Package[$packages],\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-astute.pp\n# Target line: 90\n\n     85:     owner  => 'root',\n     86:     group  => 'root',\n     87:     mode   => '0755',\n     88:   }\n     89: \n>>>  90:   # FIXME(dteselkin): use correct versions of rubygem packages\n     91:   exec {'use correct versions of rubygem packages':\n     92:     command => '/usr/bin/sed -i \"/amq-protocol/ s/~>/>=/\" /usr/share/gems/specifications/amqp-*.gemspec',\n     93:     require => Package[$packages],\n     94:   }\n     95: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp", "content": "# This define creates a basic todo file that simply contains informations", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n\n# Define puppi::todo\n#\n3: # This define creates a basic todo file that simply contains informations\n# on how to complete tasks that for time or other reasons could not be\n# entirely automated by Puppet.\n# The basic idea is to have a quick way to document and check if are completed\n# some specific operations that are required to bring a new, puppettized system\n# to full operative status.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n# Target line: 3\n\n      1: # Define puppi::todo\n      2: #\n>>>   3: # This define creates a basic todo file that simply contains informations\n      4: # on how to complete tasks that for time or other reasons could not be\n      5: # entirely automated by Puppet.\n      6: # The basic idea is to have a quick way to document and check if are completed\n      7: # some specific operations that are required to bring a new, puppettized system\n      8: # to full operative status.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-gnocchi-manifests-storage-s3.pp", "content": "#   (optional) S3 bucket prefix for gnocchi", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack@puppet-gnocchi-manifests-storage-s3.pp\n\n# [*s3_secret_access_key*]\n#   (optional) S3 storage secret access key.\n#   Defaults to undef\n#\n# [*s3_bucket_prefix*]\n25: #   (optional) S3 bucket prefix for gnocchi\n#   Defaults to undef\n#\nclass gnocchi::storage::s3(\n$s3_endpoint_url      = $::os_service_default,\n$s3_region_name       = $::os_service_default,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-gnocchi-manifests-storage-s3.pp\n# Target line: 25\n\n     20: # [*s3_secret_access_key*]\n     21: #   (optional) S3 storage secret access key.\n     22: #   Defaults to undef\n     23: #\n     24: # [*s3_bucket_prefix*]\n>>>  25: #   (optional) S3 bucket prefix for gnocchi\n     26: #   Defaults to undef\n     27: #\n     28: class gnocchi::storage::s3(\n     29:   $s3_endpoint_url      = $::os_service_default,\n     30:   $s3_region_name       = $::os_service_default,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod-php.pp", "content": "# Controls php version and libphp prefix", "line": 61, "detection_span": [56, 66], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n\n$_php_major = regsubst($php_version, '^(\\d+)\\..*$', '\\1')\n$_php_version_no_dot = regsubst($php_version, '\\.', '')\nif $apache::version::scl_httpd_version {\n$_lib = \"librh-php${_php_version_no_dot}-php${_php_major}.so\"\n} else {\n61:     # Controls php version and libphp prefix\n$_lib = \"${libphp_prefix}${php_version}.so\"\n}\n\nif $::operatingsystem == 'SLES' {\n::apache::mod { $mod:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n# Target line: 61\n\n     56:   $_php_major = regsubst($php_version, '^(\\d+)\\..*$', '\\1')\n     57:   $_php_version_no_dot = regsubst($php_version, '\\.', '')\n     58:   if $apache::version::scl_httpd_version {\n     59:     $_lib = \"librh-php${_php_version_no_dot}-php${_php_major}.so\"\n     60:   } else {\n>>>  61:     # Controls php version and libphp prefix\n     62:     $_lib = \"${libphp_prefix}${php_version}.so\"\n     63:   }\n     64: \n     65:   if $::operatingsystem == 'SLES' {\n     66:     ::apache::mod { $mod:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack-infra@puppet-jenkins-manifests-job_builder.pp", "content": "#       at some point, but that still has some problems.", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n\nPackage['python-yaml'],\n],\n}\n\n# TODO: We should put in  notify Exec['jenkins_jobs_update']\n86: #       at some point, but that still has some problems.\nfile { '/etc/jenkins_jobs/jenkins_jobs.ini':\nensure  => present,\nmode    => '0400',\ncontent => template('jenkins/jenkins_jobs.ini.erb'),\nrequire => File['/etc/jenkins_jobs'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-jenkins-manifests-job_builder.pp\n# Target line: 86\n\n     81:       Package['python-yaml'],\n     82:     ],\n     83:   }\n     84: \n     85: # TODO: We should put in  notify Exec['jenkins_jobs_update']\n>>>  86: #       at some point, but that still has some problems.\n     87:   file { '/etc/jenkins_jobs/jenkins_jobs.ini':\n     88:     ensure  => present,\n     89:     mode    => '0400',\n     90:     content => template('jenkins/jenkins_jobs.ini.erb'),\n     91:     require => File['/etc/jenkins_jobs'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-puppet-manifests-package.pp", "content": "# Install packages for Puppet and various fixups that we require.", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-package.pp\n\n# == Class: puppet::package\n#\n3: # Install packages for Puppet and various fixups that we require.\n#\nclass puppet::package (\n$facter_version = '2.0.2-1puppetlabs1',\n$hiera_version = '1.3.4-1puppetlabs1',\n$puppet_version = '3.8.5-1puppetlabs1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-package.pp\n# Target line: 3\n\n      1: # == Class: puppet::package\n      2: #\n>>>   3: # Install packages for Puppet and various fixups that we require.\n      4: #\n      5: class puppet::package (\n      6:   $facter_version = '2.0.2-1puppetlabs1',\n      7:   $hiera_version = '1.3.4-1puppetlabs1',\n      8:   $puppet_version = '3.8.5-1puppetlabs1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Icinga@puppet-icinga2-manifests-feature-debuglog.pp", "content": "#   /var/log/icinga2/debug.log on Linux", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-feature-debuglog.pp\n\n# [*ensure*]\n#   Set to present enables the feature mainlog, absent disables it. Defaults to present.\n#\n# [*path*]\n#   Absolute path to the log file. Default depends on platform:\n12: #   /var/log/icinga2/debug.log on Linux\n#   C:/ProgramData/icinga2/var/log/icinga2/debug.log on Windows\n#\n#\nclass icinga2::feature::debuglog(\nEnum['absent', 'present'] $ensure   = present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-feature-debuglog.pp\n# Target line: 12\n\n      7: # [*ensure*]\n      8: #   Set to present enables the feature mainlog, absent disables it. Defaults to present.\n      9: #\n     10: # [*path*]\n     11: #   Absolute path to the log file. Default depends on platform:\n>>>  12: #   /var/log/icinga2/debug.log on Linux\n     13: #   C:/ProgramData/icinga2/var/log/icinga2/debug.log on Windows\n     14: #\n     15: #\n     16: class icinga2::feature::debuglog(\n     17:   Enum['absent', 'present'] $ensure   = present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-cluster-zookeeper.pp", "content": "# TODO: Remove comments below once we can guarantee that all the distros", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n\n$zookeeper_server_ips,\n$zookeeper_client_ip,\n$zookeeper_hostnames\n)\n{\n42:   # TODO: Remove comments below once we can guarantee that all the distros\n# deploying TripleO use Puppet > 3.7 because of this bug:\n# https://tickets.puppetlabs.com/browse/PUP-1299\n\n# validate_array($zookeeper_server_ips)\nvalidate_ipv4_address($zookeeper_client_ip)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n# Target line: 42\n\n     37:   $zookeeper_server_ips,\n     38:   $zookeeper_client_ip,\n     39:   $zookeeper_hostnames\n     40: )\n     41: {\n>>>  42:   # TODO: Remove comments below once we can guarantee that all the distros\n     43:   # deploying TripleO use Puppet > 3.7 because of this bug:\n     44:   # https://tickets.puppetlabs.com/browse/PUP-1299\n     45: \n     46:   # validate_array($zookeeper_server_ips)\n     47:   validate_ipv4_address($zookeeper_client_ip)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-upgrade_kernel.pp", "content": "# TODO: Document the function", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-upgrade_kernel.pp\n\n1: # TODO: Document the function\n\ndefine contrail::lib::upgrade_kernel(\n$contrail_kernel_upgrade,\n$contrail_kernel_version_to_upgrade = $::contrail::params::contrail_dist_kernel_version,\n$contrail_logoutput = false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-upgrade_kernel.pp\n# Target line: 1\n\n>>>   1: # TODO: Document the function\n      2: \n      3: define contrail::lib::upgrade_kernel(\n      4:     $contrail_kernel_upgrade,\n      5:     $contrail_kernel_version_to_upgrade = $::contrail::params::contrail_dist_kernel_version,\n      6:     $contrail_logoutput = false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-fuel-examples-cobbler.pp", "content": "# TODO(mmalchuk): the right way with updated loadyaml function", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-examples-cobbler.pp\n\n$dns_domain                  = $::fuel_settings['DNS_DOMAIN']\n$dns_search                  = $::fuel_settings['DNS_SEARCH']\n$dns_upstream                = split($::fuel_settings['DNS_UPSTREAM'], ',')\n$cobbler_host                = $::fuel_settings['ADMIN_NETWORK']['ipaddress']\n\n17: # TODO(mmalchuk): the right way with updated loadyaml function\n# $bootstrap_meta = loadyaml(\"${bootstrap_path}/metadata.yaml\", {})\n# and remove if else block\n$metadata_yaml = file(\"${bootstrap_path}/metadata.yaml\", '/dev/null')\nif empty($metadata_yaml) {\n$bootstrap_meta = {}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-examples-cobbler.pp\n# Target line: 17\n\n     12: $dns_domain                  = $::fuel_settings['DNS_DOMAIN']\n     13: $dns_search                  = $::fuel_settings['DNS_SEARCH']\n     14: $dns_upstream                = split($::fuel_settings['DNS_UPSTREAM'], ',')\n     15: $cobbler_host                = $::fuel_settings['ADMIN_NETWORK']['ipaddress']\n     16: \n>>>  17: # TODO(mmalchuk): the right way with updated loadyaml function\n     18: # $bootstrap_meta = loadyaml(\"${bootstrap_path}/metadata.yaml\", {})\n     19: # and remove if else block\n     20: $metadata_yaml = file(\"${bootstrap_path}/metadata.yaml\", '/dev/null')\n     21: if empty($metadata_yaml) {\n     22:   $bootstrap_meta = {}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-apache-manifests-mod.pp", "content": "$mod_package = $mod_packages[$mod] # 2.6 compatibility hack", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod.pp\n\n$_id = \"${mod}_module\"\n}\n\n# Determine if we have a package\n$mod_packages = $::apache::params::mod_packages\n43:   $mod_package = $mod_packages[$mod] # 2.6 compatibility hack\nif $package {\n$_package = $package\n} elsif $mod_package {\n$_package = $mod_package\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod.pp\n# Target line: 43\n\n     38:     $_id = \"${mod}_module\"\n     39:   }\n     40: \n     41:   # Determine if we have a package\n     42:   $mod_packages = $::apache::params::mod_packages\n>>>  43:   $mod_package = $mod_packages[$mod] # 2.6 compatibility hack\n     44:   if $package {\n     45:     $_package = $package\n     46:   } elsif $mod_package {\n     47:     $_package = $mod_package\n     48:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp", "content": "# Also output to a file for handy debugging", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n\n$outputs = [\n# Output to Kafka.  All messages will produced to topics prefixed\n# with a datacenter name.\n# In mediawiki-vagrant this defaults to 'datacenter1'.\n'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n40:         # Also output to a file for handy debugging\n'file:///vagrant/logs/eventbus.log',\n]\neventlogging::service { 'eventbus':\nport         => 8085,\nschemas_path => \"${::eventschemas::path}/jsonschema\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n# Target line: 40\n\n     35:     $outputs = [\n     36:         # Output to Kafka.  All messages will produced to topics prefixed\n     37:         # with a datacenter name.\n     38:         # In mediawiki-vagrant this defaults to 'datacenter1'.\n     39:         'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n>>>  40:         # Also output to a file for handy debugging\n     41:         'file:///vagrant/logs/eventbus.log',\n     42:     ]\n     43:     eventlogging::service { 'eventbus':\n     44:         port         => 8085,\n     45:         schemas_path => \"${::eventschemas::path}/jsonschema\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp", "content": "# /FIXME.", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n\n$logstash_beats_ssl_key,\n# FIXME: deprecated, to be removed when Lumberjack will get replaced by Filebeat.\n$logstash_ssl_ca               = undef,\n$logstash_ssl_certificate      = undef,\n$logstash_ssl_key              = undef,\n15:   # /FIXME.\n$nginx_ssl_elastic_certificate = undef,\n$nginx_ssl_elastic_key         = undef,\n$nginx_ssl_kibana_certificate  = undef,\n$nginx_ssl_kibana_key          = undef,\n) { }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-params.pp\n# Target line: 15\n\n     10:   $logstash_beats_ssl_key,\n     11:   # FIXME: deprecated, to be removed when Lumberjack will get replaced by Filebeat.\n     12:   $logstash_ssl_ca               = undef,\n     13:   $logstash_ssl_certificate      = undef,\n     14:   $logstash_ssl_key              = undef,\n>>>  15:   # /FIXME.\n     16:   $nginx_ssl_elastic_certificate = undef,\n     17:   $nginx_ssl_elastic_key         = undef,\n     18:   $nginx_ssl_kibana_certificate  = undef,\n     19:   $nginx_ssl_kibana_key          = undef,\n     20:   ) { }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-buggy.pp", "content": "# == Class: role::buggy", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-buggy.pp\n\n1: # == Class: role::buggy\n# Buggy extension - an extension that generates bugs.\n#\nclass role::buggy {\nmediawiki::extension { 'Buggy': }\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-buggy.pp\n# Target line: 1\n\n>>>   1: # == Class: role::buggy\n      2: # Buggy extension - an extension that generates bugs.\n      3: #\n      4: class role::buggy {\n      5:     mediawiki::extension { 'Buggy': }\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-cluster-manifests-neutron-dhcp.pp", "content": "#TODO (bogdando) move to extras ha wrappers", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-neutron-dhcp.pp\n\n$dhcp_agent_package = $::neutron::params::dhcp_agent_package ? {\nfalse   => $::neutron::params::package_name,\ndefault => $::neutron::params::dhcp_agent_package\n}\n\n25:   #TODO (bogdando) move to extras ha wrappers\ncluster::corosync::cs_service {'dhcp':\nocf_script      => 'neutron-dhcp-agent',\ncsr_parameters  => {\n'plugin_config'                  => $plugin_config,\n'remove_artifacts_on_stop_start' => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-neutron-dhcp.pp\n# Target line: 25\n\n     20:   $dhcp_agent_package = $::neutron::params::dhcp_agent_package ? {\n     21:     false   => $::neutron::params::package_name,\n     22:     default => $::neutron::params::dhcp_agent_package\n     23:   }\n     24: \n>>>  25:   #TODO (bogdando) move to extras ha wrappers\n     26:   cluster::corosync::cs_service {'dhcp':\n     27:     ocf_script      => 'neutron-dhcp-agent',\n     28:     csr_parameters  => {\n     29:       'plugin_config'                  => $plugin_config,\n     30:       'remove_artifacts_on_stop_start' => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@puppet-cdh-manifests-hadoop-directory.pp", "content": "#                 gets a ticket for the service principal via a keytab. This", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-directory.pp\n\n# $owner        - HDFS directory owner. Default: hdfs\n# $group        - HDFS directory group owner. Default: hdfs\n# $mode         - HDFS directory mode. Default 0755\n# $use_kerberos - Configure whether Secure HDFS is used or not. Default: false\n#                 If $use_kerberos is enabled, a wrapper is launched which\n31: #                 gets a ticket for the service principal via a keytab. This\n#                 wrapper is not part of the cdh module, but can be found at\n#                 https://github.com/wikimedia/puppet/modules/kerberos.\n#\ndefine cdh::hadoop::directory (\n$path         = $title,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@puppet-cdh-manifests-hadoop-directory.pp\n# Target line: 31\n\n     26: # $owner        - HDFS directory owner. Default: hdfs\n     27: # $group        - HDFS directory group owner. Default: hdfs\n     28: # $mode         - HDFS directory mode. Default 0755\n     29: # $use_kerberos - Configure whether Secure HDFS is used or not. Default: false\n     30: #                 If $use_kerberos is enabled, a wrapper is launched which\n>>>  31: #                 gets a ticket for the service principal via a keytab. This\n     32: #                 wrapper is not part of the cdh module, but can be found at\n     33: #                 https://github.com/wikimedia/puppet/modules/kerberos.\n     34: #\n     35: define cdh::hadoop::directory (\n     36:     $path         = $title,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-config.pp", "content": "# Uses Augeas to add/alter/remove options in postfix main", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n\n#\n# == Definition: postfix::config\n#\n4: # Uses Augeas to add/alter/remove options in postfix main\n# configuation file (/etc/postfix/main.cf).\n#\n# TODO: make this a type with an Augeas and a postconf providers.\n#\n# === Parameters", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-config.pp\n# Target line: 4\n\n      1: #\n      2: # == Definition: postfix::config\n      3: #\n>>>   4: # Uses Augeas to add/alter/remove options in postfix main\n      5: # configuation file (/etc/postfix/main.cf).\n      6: #\n      7: # TODO: make this a type with an Augeas and a postconf providers.\n      8: #\n      9: # === Parameters\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#    postfix::config { \"canonical_alias_maps\":", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#    include postfix\n#\n#    postfix::hash { \"/etc/postfix/recipient_canonical\":\n#      ensure => present,\n#    }\n25: #    postfix::config { \"canonical_alias_maps\":\n#      value => \"hash:/etc/postfix/recipient_canonical\"\n#    }\n#    postfix::canonical {\n#      \"user@example.com\":\n#        file        => \"/etc/postfix/recipient_canonical\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 25\n\n     20: #    include postfix\n     21: #\n     22: #    postfix::hash { \"/etc/postfix/recipient_canonical\":\n     23: #      ensure => present,\n     24: #    }\n>>>  25: #    postfix::config { \"canonical_alias_maps\":\n     26: #      value => \"hash:/etc/postfix/recipient_canonical\"\n     27: #    }\n     28: #    postfix::canonical {\n     29: #      \"user@example.com\":\n     30: #        file        => \"/etc/postfix/recipient_canonical\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "jippi@puppet-php-manifests-extension-xdebug.pp", "content": "# == Class: php::extension::xdebug", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n\n1: # == Class: php::extension::xdebug\n#\n# Install and configure the xdebug PHP extension\n#\n# === Parameters\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n# Target line: 1\n\n>>>   1: # == Class: php::extension::xdebug\n      2: #\n      3: # Install and configure the xdebug PHP extension\n      4: #\n      5: # === Parameters\n      6: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Yelp@puppet-cron-manifests-job.pp", "content": "# that is its \"ticket\" to exist.  If a job is present without a ticket,", "line": 80, "detection_span": [75, 85], "with_context": "# Puppet file: Yelp@puppet-cron-manifests-job.pp\n\n# 1) Use symlinks anyway, and do 'initctl reload-configuration' a\n# bunch.\n# 2) Create the jobs as regular files, and find some other way to purge\n# them.\n# We've opted for #2, so each job is associated with a marker file\n80:   # that is its \"ticket\" to exist.  If a job is present without a ticket,\n# a cleanup job is programmed to remove it.\nfile { $job_ticket:\nensure  => 'file',\n} ->\nfile { $job_file:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Yelp@puppet-cron-manifests-job.pp\n# Target line: 80\n\n     75:   # 1) Use symlinks anyway, and do 'initctl reload-configuration' a\n     76:   # bunch.\n     77:   # 2) Create the jobs as regular files, and find some other way to purge\n     78:   # them.\n     79:   # We've opted for #2, so each job is associated with a marker file\n>>>  80:   # that is its \"ticket\" to exist.  If a job is present without a ticket,\n     81:   # a cleanup job is programmed to remove it.\n     82:   file { $job_ticket:\n     83:     ensure  => 'file',\n     84:   } ->\n     85:   file { $job_file:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-puppetdb-manifests-master-config.pp", "content": "# **WARNING**: Ugly hack to work around a yum bug with metadata parsing. This", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-master-config.pp\n\n$puppetdb_startup_timeout    = $puppetdb::params::puppetdb_startup_timeout,\n$test_url                    = $puppetdb::params::test_url,\n$restart_puppet              = true,\n) inherits puppetdb::params {\n\n33:   # **WARNING**: Ugly hack to work around a yum bug with metadata parsing. This\n# should not be copied, replicated or even looked at. In short, never rename\n# your packages...\n#\n# With `yum` we can't have the termini package override the terminus package\n# because that would prevent users from installing v2.3 of the terminus in", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-master-config.pp\n# Target line: 33\n\n     28:   $puppetdb_startup_timeout    = $puppetdb::params::puppetdb_startup_timeout,\n     29:   $test_url                    = $puppetdb::params::test_url,\n     30:   $restart_puppet              = true,\n     31: ) inherits puppetdb::params {\n     32: \n>>>  33:   # **WARNING**: Ugly hack to work around a yum bug with metadata parsing. This\n     34:   # should not be copied, replicated or even looked at. In short, never rename\n     35:   # your packages...\n     36:   #\n     37:   # With `yum` we can't have the termini package override the terminus package\n     38:   # because that would prevent users from installing v2.3 of the terminus in\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod-jk.pp", "content": "# Ensure that we are not using variables with the typo fixed by MODULES-6225", "line": 70, "detection_span": [65, 75], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-jk.pp\n\n# Provides important variables\ninclude ::apache\n# Manages basic module config\n::apache::mod { 'jk': }\n\n70:   # Ensure that we are not using variables with the typo fixed by MODULES-6225\n# anymore:\nif !empty($workers_file_content) and has_key($workers_file_content, 'worker_mantain') {\nfail('Please replace $workers_file_content[\\'worker_mantain\\'] by $workers_file_content[\\'worker_maintain\\']. See MODULES-6225 for details.')\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-jk.pp\n# Target line: 70\n\n     65:   # Provides important variables\n     66:   include ::apache\n     67:   # Manages basic module config\n     68:   ::apache::mod { 'jk': }\n     69: \n>>>  70:   # Ensure that we are not using variables with the typo fixed by MODULES-6225\n     71:   # anymore:\n     72:   if !empty($workers_file_content) and has_key($workers_file_content, 'worker_mantain') {\n     73:     fail('Please replace $workers_file_content[\\'worker_mantain\\'] by $workers_file_content[\\'worker_maintain\\']. See MODULES-6225 for details.')\n     74:   }\n     75: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-router-manifests-errorpage.pp", "content": "# To solve this we want router to try to get the templates from static", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n\n$filename = \"/usr/share/nginx/www/${title}.html\"\n\n$static_url = \"https://static.${app_domain}/templates/${title}.html.erb\"\n\n# We're dealing with a chicken and egg problem when building gov.uk here, static is not up before router, and router needs static for its error pages templates\n16: # To solve this we want router to try to get the templates from static\n# If that fails : keep the templates it has\n# If that fails and it has no templates: we generate basic tamplates for it.\n$cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n\nexec { \"update_error_page_${title}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-router-manifests-errorpage.pp\n# Target line: 16\n\n     11:   $filename = \"/usr/share/nginx/www/${title}.html\"\n     12: \n     13:   $static_url = \"https://static.${app_domain}/templates/${title}.html.erb\"\n     14: \n     15: # We're dealing with a chicken and egg problem when building gov.uk here, static is not up before router, and router needs static for its error pages templates\n>>>  16: # To solve this we want router to try to get the templates from static\n     17: # If that fails : keep the templates it has\n     18: # If that fails and it has no templates: we generate basic tamplates for it.\n     19:   $cmd = \"curl --connect-timeout 1 -sf ${static_url} -o ${filename} || if [ ! -f ${filename} ]; then echo '<!DOCTYPE html><html><b>${title}</b></html>' > ${filename}; fi\"\n     20: \n     21:   exec { \"update_error_page_${title}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "theforeman@foreman-installer-staypuft-modules-network-manifests-global.pp", "content": "# === TODO:", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: theforeman@foreman-installer-staypuft-modules-network-manifests-global.pp\n\n#     nisdomain  => 'domain.tld',\n#     vlan       => 'yes',\n#     nozeroconf => 'yes',\n#   }\n#\n42: # === TODO:\n#\n#   NETWORKING_IPV6=yes|no\n#\n# === Authors:\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: theforeman@foreman-installer-staypuft-modules-network-manifests-global.pp\n# Target line: 42\n\n     37: #     nisdomain  => 'domain.tld',\n     38: #     vlan       => 'yes',\n     39: #     nozeroconf => 'yes',\n     40: #   }\n     41: #\n>>>  42: # === TODO:\n     43: #\n     44: #   NETWORKING_IPV6=yes|no\n     45: #\n     46: # === Authors:\n     47: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpbugmanage.pp", "content": "# Class fuel_project::devops_tools::lpbugmanage", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpbugmanage.pp\n\n1: # Class fuel_project::devops_tools::lpbugmanage\n#\n# This class deploys lpbugmanage package and it's configuration.\n#\n# Parameters:\n#   [*id*] - unique ID used in config file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpbugmanage.pp\n# Target line: 1\n\n>>>   1: # Class fuel_project::devops_tools::lpbugmanage\n      2: #\n      3: # This class deploys lpbugmanage package and it's configuration.\n      4: #\n      5: # Parameters:\n      6: #   [*id*] - unique ID used in config file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-fixtures-scenario002.pp", "content": "# FIXME(ykarel) Disable SSL until services are ready to work with SSL + Python3", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: openstack@puppet-openstack-integration-fixtures-scenario002.pp\n\n}\n}\n\nif ($::os['name'] == 'Ubuntu') or ($::os['name'] == 'Fedora') or\n($::os['family'] == 'RedHat' and Integer.new($::os['release']['major']) > 7) {\n41:   # FIXME(ykarel) Disable SSL until services are ready to work with SSL + Python3\n$ssl = false\n} else {\n$ssl = true\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-fixtures-scenario002.pp\n# Target line: 41\n\n     36:   }\n     37: }\n     38: \n     39: if ($::os['name'] == 'Ubuntu') or ($::os['name'] == 'Fedora') or\n     40:   ($::os['family'] == 'RedHat' and Integer.new($::os['release']['major']) > 7) {\n>>>  41:   # FIXME(ykarel) Disable SSL until services are ready to work with SSL + Python3\n     42:   $ssl = false\n     43: } else {\n     44:   $ssl = true\n     45: }\n     46: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-enable_kernel_core.pp", "content": "# enable kernel core , below python code has bug, for now ignore by executing echo regardless and thus returning true for cmd.", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-enable_kernel_core.pp\n\nmode   => '0755',\nowner  => root,\ngroup  => root,\nsource => \"puppet:///modules/${module_name}/enable_kernel_core.py\"\n}\n11:     # enable kernel core , below python code has bug, for now ignore by executing echo regardless and thus returning true for cmd.\n# need to revisit afterwards.\n\nif ($::operatingsystem == 'Ubuntu') {\npackage { 'linux-crashdump' : ensure => present,}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-enable_kernel_core.pp\n# Target line: 11\n\n      6:         mode   => '0755',\n      7:         owner  => root,\n      8:         group  => root,\n      9:         source => \"puppet:///modules/${module_name}/enable_kernel_core.py\"\n     10:     }\n>>>  11:     # enable kernel core , below python code has bug, for now ignore by executing echo regardless and thus returning true for cmd.\n     12:     # need to revisit afterwards.\n     13: \n     14:     if ($::operatingsystem == 'Ubuntu') {\n     15:         package { 'linux-crashdump' : ensure => present,}\n     16:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-virtual.pp", "content": "#     postfix::virtual { \"user@example.com\":", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n\n#       ensure => present,\n#     }\n#     postfix::config { \"virtual_alias_maps\":\n#       value => \"hash:/etc/postfix/virtual\"\n#     }\n30: #     postfix::virtual { \"user@example.com\":\n#       ensure      => present,\n#       destination => ['root', 'postmaster'],\n#     }\n#   }\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n# Target line: 30\n\n     25: #       ensure => present,\n     26: #     }\n     27: #     postfix::config { \"virtual_alias_maps\":\n     28: #       value => \"hash:/etc/postfix/virtual\"\n     29: #     }\n>>>  30: #     postfix::virtual { \"user@example.com\":\n     31: #       ensure      => present,\n     32: #       destination => ['root', 'postmaster'],\n     33: #     }\n     34: #   }\n     35: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Icinga@puppet-icinga2-manifests-object.pp", "content": "#   Set object_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-object.pp\n\n# [*apply*]\n#   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n#   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n#\n# [*prefix*]\n22: #   Set object_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n#\n# [*apply_target*]\n#   Optional for an object type on which to target the apply rule. Valid values are `Host` and `Service`.\n#\n# [*import*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-object.pp\n# Target line: 22\n\n     17: # [*apply*]\n     18: #   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n     19: #   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n     20: #\n     21: # [*prefix*]\n>>>  22: #   Set object_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n     23: #\n     24: # [*apply_target*]\n     25: #   Optional for an object type on which to target the apply rule. Valid values are `Host` and `Service`.\n     26: #\n     27: # [*import*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-vulnerabilities-unix-ftp-proftpd_133c_backdoor-manifests-install.pp", "content": "command => '/usr/local/src/backdoored_proftpd-1.3.3c/configure', #--prefix=/usr/local/", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ftp-proftpd_133c_backdoor-manifests-install.pp\n\nnotify  => Exec['install_proftpd-1.3.3c'],\n}\n\nexec { 'install_proftpd-1.3.3c':\ncwd     => '/usr/local/src/backdoored_proftpd-1.3.3c/',\n24:     command => '/usr/local/src/backdoored_proftpd-1.3.3c/configure', #--prefix=/usr/local/\nnotify  => Exec['make_proftpd-1.3.3c'],\n}\n\nexec { 'make_proftpd-1.3.3c':\nrequire     => Exec['install_proftpd-1.3.3c'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-ftp-proftpd_133c_backdoor-manifests-install.pp\n# Target line: 24\n\n     19:     notify  => Exec['install_proftpd-1.3.3c'],\n     20:   }\n     21: \n     22:   exec { 'install_proftpd-1.3.3c':\n     23:     cwd     => '/usr/local/src/backdoored_proftpd-1.3.3c/',\n>>>  24:     command => '/usr/local/src/backdoored_proftpd-1.3.3c/configure', #--prefix=/usr/local/\n     25:     notify  => Exec['make_proftpd-1.3.3c'],\n     26:   }\n     27: \n     28:   exec { 'make_proftpd-1.3.3c':\n     29:     require     => Exec['install_proftpd-1.3.3c'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wazuh@ossec-puppet-manifests-repo.pp", "content": "# apt-key added by issue #34", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: wazuh@ossec-puppet-manifests-repo.pp\n\nrequire => File['/usr/src/ossec']\n}\n\ncase $::osfamily {\n'Debian' : {\n29:       # apt-key added by issue #34\napt::key { 'puppetlabs':\nid     => '9FE55537D1713CA519DFB85114B9C8DB9A1B1C65',\nsource => 'https://ossec.wazuh.com/repos/apt/conf/ossec-key.gpg.key',\nserver => 'pgp.mit.edu'\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wazuh@ossec-puppet-manifests-repo.pp\n# Target line: 29\n\n     24:     require => File['/usr/src/ossec']\n     25:   }\n     26: \n     27:   case $::osfamily {\n     28:     'Debian' : {\n>>>  29:       # apt-key added by issue #34\n     30:       apt::key { 'puppetlabs':\n     31:         id     => '9FE55537D1713CA519DFB85114B9C8DB9A1B1C65',\n     32:         source => 'https://ossec.wazuh.com/repos/apt/conf/ossec-key.gpg.key',\n     33:         server => 'pgp.mit.edu'\n     34:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-mongodb-manifests-server.pp", "content": "#   Version of mongodb. Should resolve to 2.6", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-server.pp\n\n# Setup a MongoDB server.\n#\n# === Parameters:\n#\n# [*version*]\n8: #   Version of mongodb. Should resolve to 2.6\n#\n# [*dbpath*]\n#   Path to database on filesystem\n#\n# [*oplog_size*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-server.pp\n# Target line: 8\n\n      3: # Setup a MongoDB server.\n      4: #\n      5: # === Parameters:\n      6: #\n      7: # [*version*]\n>>>   8: #   Version of mongodb. Should resolve to 2.6\n      9: #\n     10: # [*dbpath*]\n     11: #   Path to database on filesystem\n     12: #\n     13: # [*oplog_size*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-virtual.pp", "content": "# [*name*]        - name of address postfix will lookup. See virtual(8).", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n\n#\n# Manages content of the /etc/postfix/virtual map.\n#\n# === Parameters\n#\n7: # [*name*]        - name of address postfix will lookup. See virtual(8).\n# [*destination*] - a list of destinations where the emails will be delivered to. See virtual(8).\n# [*ensure*]      - present/absent, defaults to present.\n# [*file*]        - a string defining the location of the pre-hash map.\n#\n# === Requires", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n# Target line: 7\n\n      2: #\n      3: # Manages content of the /etc/postfix/virtual map.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # [*name*]        - name of address postfix will lookup. See virtual(8).\n      8: # [*destination*] - a list of destinations where the emails will be delivered to. See virtual(8).\n      9: # [*ensure*]      - present/absent, defaults to present.\n     10: # [*file*]        - a string defining the location of the pre-hash map.\n     11: #\n     12: # === Requires\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-contrail_setup_interface.pp", "content": "#TODO: Document the class", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-contrail_setup_interface.pp\n\n1: #TODO: Document the class\ndefine contrail::lib::contrail_setup_interface(\n$contrail_device,\n$contrail_members,\n$contrail_bond_opts,\n$contrail_ip,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-contrail_setup_interface.pp\n# Target line: 1\n\n>>>   1: #TODO: Document the class\n      2: define contrail::lib::contrail_setup_interface(\n      3:   $contrail_device,\n      4:   $contrail_members,\n      5:   $contrail_bond_opts,\n      6:   $contrail_ip,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-cassandra-manifests-datastax.pp", "content": "# This is a bit of a hack to work around puppet dependency cycles that are", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-cassandra-manifests-datastax.pp\n\n# == Class: cassandra::datastax\n#\n# Add the datastax apt repo\n#\n5: # This is a bit of a hack to work around puppet dependency cycles that are\n# created when apt::repository and require_package are used in the same\n# manifest. That ends up making a circular dep on Exec['apt-get update'].\n#\nclass cassandra::datastax {\napt::repository { 'datastax':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-cassandra-manifests-datastax.pp\n# Target line: 5\n\n      1: # == Class: cassandra::datastax\n      2: #\n      3: # Add the datastax apt repo\n      4: #\n>>>   5: # This is a bit of a hack to work around puppet dependency cycles that are\n      6: # created when apt::repository and require_package are used in the same\n      7: # manifest. That ends up making a circular dep on Exec['apt-get update'].\n      8: #\n      9: class cassandra::datastax {\n     10:     apt::repository { 'datastax':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-repos.pp", "content": "# Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141", "line": 117, "detection_span": [112, 122], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n\n# NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n# that causes the puppet-openvswitch module to fail parsing the output.\n# This issue does not occur in integration testing but only beaker tests since some\n# other package (probably nova) causes this package to be installed, or the yum upgrade\n# part in integration catches it.\n117:     # Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141\npackage { 'libibverbs':\nensure => 'present',\n}\n121:   }\n122:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n# Target line: 117\n\n    112:     # NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n    113:     # that causes the puppet-openvswitch module to fail parsing the output.\n    114:     # This issue does not occur in integration testing but only beaker tests since some\n    115:     # other package (probably nova) causes this package to be installed, or the yum upgrade\n    116:     # part in integration catches it.\n>>> 117:     # Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141\n    118:     package { 'libibverbs':\n    119:       ensure => 'present',\n    120:     }\n    121:   }\n    122: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp", "content": "# FIXME: remove this vhost when we're no longer using the old domain anywhere", "line": 66, "detection_span": [61, 71], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n\nssl_key          => $ssl_key,\nindex_files      => [],\nadd_header       => {'Strict-Transport-Security' => '\"max-age=31536000\"'},\n}\n\n66:   # FIXME: remove this vhost when we're no longer using the old domain anywhere\nif $legacy_vhost != undef {\nnginx::resource::vhost { $legacy_vhost:\nproxy            => 'http://localhost:8080/',\nproxy_set_header => $::nginx::config::proxy_set_header, # Necessary until https://github.com/jfryman/puppet-nginx/pull/700 is released\nssl              => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_master.pp\n# Target line: 66\n\n     61:     ssl_key          => $ssl_key,\n     62:     index_files      => [],\n     63:     add_header       => {'Strict-Transport-Security' => '\"max-age=31536000\"'},\n     64:   }\n     65: \n>>>  66:   # FIXME: remove this vhost when we're no longer using the old domain anywhere\n     67:   if $legacy_vhost != undef {\n     68:     nginx::resource::vhost { $legacy_vhost:\n     69:       proxy            => 'http://localhost:8080/',\n     70:       proxy_set_header => $::nginx::config::proxy_set_header, # Necessary until https://github.com/jfryman/puppet-nginx/pull/700 is released\n     71:       ssl              => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-cluster-zookeeper.pp", "content": "# deploying TripleO use Puppet > 3.7 because of this bug:", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n\n$zookeeper_client_ip,\n$zookeeper_hostnames\n)\n{\n# TODO: Remove comments below once we can guarantee that all the distros\n43:   # deploying TripleO use Puppet > 3.7 because of this bug:\n# https://tickets.puppetlabs.com/browse/PUP-1299\n\n# validate_array($zookeeper_server_ips)\nvalidate_ipv4_address($zookeeper_client_ip)\n# validate_array($zookeeper_hostnames)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-cluster-zookeeper.pp\n# Target line: 43\n\n     38:   $zookeeper_client_ip,\n     39:   $zookeeper_hostnames\n     40: )\n     41: {\n     42:   # TODO: Remove comments below once we can guarantee that all the distros\n>>>  43:   # deploying TripleO use Puppet > 3.7 because of this bug:\n     44:   # https://tickets.puppetlabs.com/browse/PUP-1299\n     45: \n     46:   # validate_array($zookeeper_server_ips)\n     47:   validate_ipv4_address($zookeeper_client_ip)\n     48:   # validate_array($zookeeper_hostnames)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-rabbitmq-manifests-init.pp", "content": "validate_re($version, '^\\d+\\.\\d+\\.\\d+(-\\d+)*$') # Allow 3 digits and optional -n postfix.", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-rabbitmq-manifests-init.pp\n\nvalidate_string($package_ensure)\nvalidate_string($package_gpg_key)\nvalidate_string($package_name)\nvalidate_string($package_provider)\nvalidate_bool($manage_repos)\n65:   validate_re($version, '^\\d+\\.\\d+\\.\\d+(-\\d+)*$') # Allow 3 digits and optional -n postfix.\n# Validate config parameters.\nvalidate_array($cluster_disk_nodes)\nvalidate_re($cluster_node_type, '^(ram|disc)$')\nvalidate_array($cluster_nodes)\nvalidate_string($config)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-rabbitmq-manifests-init.pp\n# Target line: 65\n\n     60:   validate_string($package_ensure)\n     61:   validate_string($package_gpg_key)\n     62:   validate_string($package_name)\n     63:   validate_string($package_provider)\n     64:   validate_bool($manage_repos)\n>>>  65:   validate_re($version, '^\\d+\\.\\d+\\.\\d+(-\\d+)*$') # Allow 3 digits and optional -n postfix.\n     66:   # Validate config parameters.\n     67:   validate_array($cluster_disk_nodes)\n     68:   validate_re($cluster_node_type, '^(ram|disc)$')\n     69:   validate_array($cluster_nodes)\n     70:   validate_string($config)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "willdurand@puppet-nodejs-manifests-instance.pp", "content": "$node_version    = $source_filename # use custom file format as version infix for resource names", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: willdurand@puppet-nodejs-manifests-instance.pp\n\nfail(\"Unexpected state reached! Either \\$source or \\$version must not be undef!\")\n}\n\nif $source != undef {\n$source_filename = source_filename($source)\n51:     $node_version    = $source_filename # use custom file format as version infix for resource names\n} else {\n$node_version = $version\n}\n\n$node_unpack_folder = \"${install_dir}/node-${node_version}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: willdurand@puppet-nodejs-manifests-instance.pp\n# Target line: 51\n\n     46:     fail(\"Unexpected state reached! Either \\$source or \\$version must not be undef!\")\n     47:   }\n     48: \n     49:   if $source != undef {\n     50:     $source_filename = source_filename($source)\n>>>  51:     $node_version    = $source_filename # use custom file format as version infix for resource names\n     52:   } else {\n     53:     $node_version = $version\n     54:   }\n     55: \n     56:   $node_unpack_folder = \"${install_dir}/node-${node_version}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-neutron-manifests-logging.pp", "content": "# [*logging_exception_prefix*]", "line": 72, "detection_span": [67, 77], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-logging.pp\n\n# [*logging_debug_format_suffix*]\n#   (Optional) Additional data to append to log message when logging level for the message is DEBUG'\n#   Defaults to $::os_service_default\n#   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n#\n72: # [*logging_exception_prefix*]\n#   (Optional) Prefix each line of exception output with this format.\n#   Defaults to $::os_service_default\n#   Example: '%(asctime)s.%(msecs)03d %(process)d ERROR %(name)s %(instance)s'\n#\n# [*logging_user_identity_format*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-logging.pp\n# Target line: 72\n\n     67: # [*logging_debug_format_suffix*]\n     68: #   (Optional) Additional data to append to log message when logging level for the message is DEBUG'\n     69: #   Defaults to $::os_service_default\n     70: #   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n     71: #\n>>>  72: # [*logging_exception_prefix*]\n     73: #   (Optional) Prefix each line of exception output with this format.\n     74: #   Defaults to $::os_service_default\n     75: #   Example: '%(asctime)s.%(msecs)03d %(process)d ERROR %(name)s %(instance)s'\n     76: #\n     77: # [*logging_user_identity_format*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "biemond@biemond-wildfly-functions-patch_args.pp", "content": "# @param override_all Whether it should solve all conflicts by overriding current files.", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: biemond@biemond-wildfly-functions-patch_args.pp\n\n# Generate args for JBoss-CLI `patch` command.\n#\n# @param source path to patch file.\n4: # @param override_all Whether it should solve all conflicts by overriding current files.\n# @param override List of files to be overridden.\n# @param preserve List of files to be preserved.\n# @return [String] args for patch command.\nfunction wildfly::patch_args(\nStdlib::Unixpath $source,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-wildfly-functions-patch_args.pp\n# Target line: 4\n\n      1: # Generate args for JBoss-CLI `patch` command.\n      2: #\n      3: # @param source path to patch file.\n>>>   4: # @param override_all Whether it should solve all conflicts by overriding current files.\n      5: # @param override List of files to be overridden.\n      6: # @param preserve List of files to be preserved.\n      7: # @return [String] args for patch command.\n      8: function wildfly::patch_args(\n      9:   Stdlib::Unixpath $source,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-nmap.pp", "content": "# FIXME: Remove once deployed", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-nmap.pp\n\n#\n# Configures nmap, ready to be used by Jenkins jobs\n#\nclass ci_environment::jenkins_job_support::nmap (){\n\n7:   # FIXME: Remove once deployed\npackage { 'nmap':\nensure => purged,\n}\nfile { '/etc/sudoers.d/jenkins-nmap':\nensure  => absent,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-jenkins_job_support-nmap.pp\n# Target line: 7\n\n      2: #\n      3: # Configures nmap, ready to be used by Jenkins jobs\n      4: #\n      5: class ci_environment::jenkins_job_support::nmap (){\n      6: \n>>>   7:   # FIXME: Remove once deployed\n      8:   package { 'nmap':\n      9:     ensure => purged,\n     10:   }\n     11:   file { '/etc/sudoers.d/jenkins-nmap':\n     12:     ensure  => absent,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-server.pp", "content": "$clients = []\t# list of allowed client ip's\t# TODO: get from exported resources", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n\n$baseport = '',\t# specify base port option as used in glusterd.vol file\n$rpcauthallowinsecure = false,\t# needed in some setups in glusterd.vol\n$shorewall = false,\n$zone = 'net',\t\t\t\t\t\t\t\t# TODO: allow a list of zones\n$ips = false,\t# an optional list of ip's for each in hosts[]\n30: \t$clients = []\t# list of allowed client ip's\t# TODO: get from exported resources\n) {\n$FW = '$FW'\t\t\t# make using $FW in shorewall easier\n\ninclude gluster::vardir\ninclude gluster::params", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n# Target line: 30\n\n     25: \t$baseport = '',\t# specify base port option as used in glusterd.vol file\n     26: \t$rpcauthallowinsecure = false,\t# needed in some setups in glusterd.vol\n     27: \t$shorewall = false,\n     28: \t$zone = 'net',\t\t\t\t\t\t\t\t# TODO: allow a list of zones\n     29: \t$ips = false,\t# an optional list of ip's for each in hosts[]\n>>>  30: \t$clients = []\t# list of allowed client ip's\t# TODO: get from exported resources\n     31: ) {\n     32: \t$FW = '$FW'\t\t\t# make using $FW in shorewall easier\n     33: \n     34: \tinclude gluster::vardir\n     35: \tinclude gluster::params\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-config-server-realm.pp", "content": "# https://github.com/hercules-team/augeas/issues/319", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-config-server-realm.pp\n\nfail('$realm_ensure must be set to \\'true\\' or \\'present\\' to use $purge_realms')\n}\n\nif $_purge_realms {\n# Perform deletions in reverse depth order as workaround for\n54:     # https://github.com/hercules-team/augeas/issues/319\n$__purge_realms = [\n'rm //Realm//Realm',\n'rm //Context//Realm',\n'rm //Host//Realm',\n'rm //Engine//Realm',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-config-server-realm.pp\n# Target line: 54\n\n     49:     fail('$realm_ensure must be set to \\'true\\' or \\'present\\' to use $purge_realms')\n     50:   }\n     51: \n     52:   if $_purge_realms {\n     53:     # Perform deletions in reverse depth order as workaround for\n>>>  54:     # https://github.com/hercules-team/augeas/issues/319\n     55:     $__purge_realms = [\n     56:       'rm //Realm//Realm',\n     57:       'rm //Context//Realm',\n     58:       'rm //Host//Realm',\n     59:       'rm //Engine//Realm',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-repos.pp", "content": "# TODO(tobasco): Remove this CBS candidate repo for Mimic and Nautilus when Storage SIG release it.", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n\n'descr'    => 'master delorean-deps',\n'gpgcheck' => 'no',\n},\n},\n}\n68:       # TODO(tobasco): Remove this CBS candidate repo for Mimic and Nautilus when Storage SIG release it.\n$ceph_mirror_fallback = $ceph_version_real ? {\n'mimic'    => 'http://cbs.centos.org/repos/storage7-ceph-mimic-candidate/x86_64/os/',\n'nautilus' => 'http://cbs.centos.org/repos/storage7-ceph-nautilus-candidate/x86_64/os/',\ndefault    => \"https://buildlogs.centos.org/centos/7/storage/x86_64/ceph-${ceph_version_real}/\"\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n# Target line: 68\n\n     63:             'descr'    => 'master delorean-deps',\n     64:             'gpgcheck' => 'no',\n     65:           },\n     66:         },\n     67:       }\n>>>  68:       # TODO(tobasco): Remove this CBS candidate repo for Mimic and Nautilus when Storage SIG release it.\n     69:       $ceph_mirror_fallback = $ceph_version_real ? {\n     70:         'mimic'    => 'http://cbs.centos.org/repos/storage7-ceph-mimic-candidate/x86_64/os/',\n     71:         'nautilus' => 'http://cbs.centos.org/repos/storage7-ceph-nautilus-candidate/x86_64/os/',\n     72:         default    => \"https://buildlogs.centos.org/centos/7/storage/x86_64/ceph-${ceph_version_real}/\"\n     73:       }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-openstack-object-proxy.pp", "content": "# Hack until swift::config also supports proxy config", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n\n\nif $test_file {\ninclude ::swift::test_file\n}\n\n55:   # Hack until swift::config also supports proxy config\ncreate_resources('swift_proxy_config', $proxy_config)\n\ncreate_resources('swift::ringsync', $ring_server)\n\nif $manage_firewall {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n# Target line: 55\n\n     50: \n     51:   if $test_file {\n     52:     include ::swift::test_file\n     53:   }\n     54: \n>>>  55:   # Hack until swift::config also supports proxy config\n     56:   create_resources('swift_proxy_config', $proxy_config)\n     57: \n     58:   create_resources('swift::ringsync', $ring_server)\n     59: \n     60:   if $manage_firewall {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp", "content": "#    Optional prefix for the sysctl.d file to be created. Default: none.", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n\n#\n# Parameters:\n#  $value:\n#    The value for the sysctl parameter. Mandatory, unless $ensure is 'absent'.\n#  $prefix:\n9: #    Optional prefix for the sysctl.d file to be created. Default: none.\n#  $ensure:\n#    Whether the variable's value should be 'present' or 'absent'.\n#    Defaults to 'present'.\n#\n# Sample Usage :", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: # Parameters:\n      6: #  $value:\n      7: #    The value for the sysctl parameter. Mandatory, unless $ensure is 'absent'.\n      8: #  $prefix:\n>>>   9: #    Optional prefix for the sysctl.d file to be created. Default: none.\n     10: #  $ensure:\n     11: #    Whether the variable's value should be 'present' or 'absent'.\n     12: #    Defaults to 'present'.\n     13: #\n     14: # Sample Usage :\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks", "line": 110, "detection_span": [105, 115], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nOptional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\nString                          $master_bounce_command = 'bounce',\nString                          $master_defer_command  = 'bounce',\nBoolean                         $mta                 = false,\nString                          $mydestination       = '$myorigin',   # postfix_mydestination\n110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\nString                          $myorigin            = $::fqdn,\nOptional[String]                $relayhost           = undef,         # postfix_relayhost\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\nOptional[Boolean]               $chroot              = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 110\n\n    105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\n    106:   String                          $master_bounce_command = 'bounce',\n    107:   String                          $master_defer_command  = 'bounce',\n    108:   Boolean                         $mta                 = false,\n    109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\n>>> 110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n    111:   String                          $myorigin            = $::fqdn,\n    112:   Optional[String]                $relayhost           = undef,         # postfix_relayhost\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n    115:   Optional[Boolean]               $chroot              = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-openldap-manifests-server-access_wrapper.pp", "content": "#   Mandatory. The suffix to apply acls", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n\n#\n# === Parameters\n#\n# [*suffix*]\n#   Default: $name\n9: #   Mandatory. The suffix to apply acls\n#\n# [*acl*]\n#   Default:\n#   Mandatory. Hash in the form { <what> => <access>, ... }\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n# Target line: 9\n\n      4: #\n      5: # === Parameters\n      6: #\n      7: # [*suffix*]\n      8: #   Default: $name\n>>>   9: #   Mandatory. The suffix to apply acls\n     10: #\n     11: # [*acl*]\n     12: #   Default:\n     13: #   Mandatory. Hash in the form { <what> => <access>, ... }\n     14: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack-infra@puppet-zuul-manifests-executor.pp", "content": "# This is a hack to make sure that systemd is aware of the new service", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: openstack-infra@puppet-zuul-manifests-executor.pp\n\nprovider => 'pip3',\nrequire  => Class['pip'],\n}\n\nif ($::operatingsystem == 'Ubuntu') and ($::operatingsystemrelease >= '16.04') {\n77:     # This is a hack to make sure that systemd is aware of the new service\n# before we attempt to start it.\nexec { 'zuul-executor-systemd-daemon-reload':\ncommand     => '/bin/systemctl daemon-reload',\nbefore      => Service['zuul-executor'],\nsubscribe   => File['/etc/init.d/zuul-executor'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-zuul-manifests-executor.pp\n# Target line: 77\n\n     72:     provider => 'pip3',\n     73:     require  => Class['pip'],\n     74:   }\n     75: \n     76:   if ($::operatingsystem == 'Ubuntu') and ($::operatingsystemrelease >= '16.04') {\n>>>  77:     # This is a hack to make sure that systemd is aware of the new service\n     78:     # before we attempt to start it.\n     79:     exec { 'zuul-executor-systemd-daemon-reload':\n     80:       command     => '/bin/systemctl daemon-reload',\n     81:       before      => Service['zuul-executor'],\n     82:       subscribe   => File['/etc/init.d/zuul-executor'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-base-physical.pp", "content": "# FIXME: This should be done more efficient when more vendors enter our scene", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: norcams@himlar-profile-manifests-base-physical.pp\n\ncontent => template(\"${module_name}/monitoring/sensu/redfish_check.sh.erb\"),\nmode    => '0755',\n}\n}\n\n87:   # FIXME: This should be done more efficient when more vendors enter our scene\nif ($configure_bmc_nic) and ($::runmode == 'default') {\n$addresslist = lookup('profile::network::services::dns_records', Hash, 'deep', '')\n$cname = $addresslist['CNAME'][$::clientcert]\nif empty($cname) {\n$mgmtaddress = $addresslist['A'][$::clientcert]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-base-physical.pp\n# Target line: 87\n\n     82:       content => template(\"${module_name}/monitoring/sensu/redfish_check.sh.erb\"),\n     83:       mode    => '0755',\n     84:     }\n     85:   }\n     86: \n>>>  87:   # FIXME: This should be done more efficient when more vendors enter our scene\n     88:   if ($configure_bmc_nic) and ($::runmode == 'default') {\n     89:     $addresslist = lookup('profile::network::services::dns_records', Hash, 'deep', '')\n     90:     $cname = $addresslist['CNAME'][$::clientcert]\n     91:     if empty($cname) {\n     92:       $mgmtaddress = $addresslist['A'][$::clientcert]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-user.pp", "content": "# Ruby's capitalize has a bug/feature where it *lower-cases* every", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-user.pp\n\n\n# Ideally, this would use the same canonicalization as core.\n# In the meantime, just address one common issue.\n\n# Capitalize first character\n53:     # Ruby's capitalize has a bug/feature where it *lower-cases* every\n# character except the first even when they were already\n# capitalized.  Puppet inherits this.\n$canonical_username = inline_template('<%= @username[0].capitalize + @username[1..-1] %>')\n\nmediawiki::maintenance { \"mediawiki_user_${canonical_username}_${wiki}\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-user.pp\n# Target line: 53\n\n     48: \n     49:     # Ideally, this would use the same canonicalization as core.\n     50:     # In the meantime, just address one common issue.\n     51: \n     52:     # Capitalize first character\n>>>  53:     # Ruby's capitalize has a bug/feature where it *lower-cases* every\n     54:     # character except the first even when they were already\n     55:     # capitalized.  Puppet inherits this.\n     56:     $canonical_username = inline_template('<%= @username[0].capitalize + @username[1..-1] %>')\n     57: \n     58:     mediawiki::maintenance { \"mediawiki_user_${canonical_username}_${wiki}\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp", "content": "# Set EnableSendfile to 'Off' to work around a bug with Vagrant.", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n\nonlyif      => '/usr/sbin/service apache2 status',\nrefreshonly => true,\nnotify      => Service['apache2'],\n}\n\n38:     # Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n# See <https://github.com/hashicorp/vagrant/issues/351>.\napache::conf { 'disable sendfile':\ncontent => 'EnableSendfile Off',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n# Target line: 38\n\n     33:         onlyif      => '/usr/sbin/service apache2 status',\n     34:         refreshonly => true,\n     35:         notify      => Service['apache2'],\n     36:     }\n     37: \n>>>  38:     # Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n     39:     # See <https://github.com/hashicorp/vagrant/issues/351>.\n     40:     apache::conf { 'disable sendfile':\n     41:         content => 'EnableSendfile Off',\n     42:     }\n     43: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "voxpupuli@puppet-nginx-manifests-resource-geo.pp", "content": "#                         name (automatically prefixed with $)", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: voxpupuli@puppet-nginx-manifests-resource-geo.pp\n\n#   [*ensure*]          - Enables or disables the specified location\n#   [*ranges*]          - Indicates that lookup keys (network addresses) are\n#                         specified as ranges.\n#   [*address*]         - Nginx defaults to using $remote_addr for testing.\n#                         This allows you to override that with another variable\n14: #                         name (automatically prefixed with $)\n#   [*delete*]          - deletes the specified network (see: geo module docs)\n#   [*proxy_recursive*] - Changes the behavior of address acquisition when\n#                         specifying trusted proxies via 'proxies' directive\n#   [*proxies*]         - Hash of network->value mappings.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-nginx-manifests-resource-geo.pp\n# Target line: 14\n\n      9: #   [*ensure*]          - Enables or disables the specified location\n     10: #   [*ranges*]          - Indicates that lookup keys (network addresses) are\n     11: #                         specified as ranges.\n     12: #   [*address*]         - Nginx defaults to using $remote_addr for testing.\n     13: #                         This allows you to override that with another variable\n>>>  14: #                         name (automatically prefixed with $)\n     15: #   [*delete*]          - deletes the specified network (see: geo module docs)\n     16: #   [*proxy_recursive*] - Changes the behavior of address acquisition when\n     17: #                         specifying trusted proxies via 'proxies' directive\n     18: #   [*proxies*]         - Hash of network->value mappings.\n     19: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod-php.pp", "content": "} elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n\n\n# Determine if we have a package\n$mod_packages = $::apache::mod_packages\nif $package_name {\n$_package_name = $package_name\n48:   } elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n$_package_name = $mod_packages[$mod]\n} elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n$_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n} else {\n$_package_name = undef", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod-php.pp\n# Target line: 48\n\n     43: \n     44:   # Determine if we have a package\n     45:   $mod_packages = $::apache::mod_packages\n     46:   if $package_name {\n     47:     $_package_name = $package_name\n>>>  48:   } elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n     49:     $_package_name = $mod_packages[$mod]\n     50:   } elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n     51:     $_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n     52:   } else {\n     53:     $_package_name = undef\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "zend-patterns@ZendServerPuppet-manifests-bootstrap-zsmanage.pp", "content": "# TODO:if api_key was not specified then save Zend Server API key as a fact.", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-bootstrap-zsmanage.pp\n\n# == Class: zendserver::bootstrap::zsmanage\n#  Bootstrap single server if the fact zend_gui.completed is not true\n#  Use the zsmanage tool\nclass zendserver::bootstrap::zsmanage inherits zendserver::bootstrap {\n5:     # TODO:if api_key was not specified then save Zend Server API key as a fact.\n$options = \"-p ${zendserver::admin_password} -a ${zendserver::accept_eula}\"\n\n#Check if Zend Server is already bootstrapped.\n#The zend_gui_completed fact is a string and not a boolean.\nif $::zend_gui_completed != true {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-bootstrap-zsmanage.pp\n# Target line: 5\n\n      1: # == Class: zendserver::bootstrap::zsmanage\n      2: #  Bootstrap single server if the fact zend_gui.completed is not true\n      3: #  Use the zsmanage tool\n      4: class zendserver::bootstrap::zsmanage inherits zendserver::bootstrap {\n>>>   5:     # TODO:if api_key was not specified then save Zend Server API key as a fact.\n      6:   $options = \"-p ${zendserver::admin_password} -a ${zendserver::accept_eula}\"\n      7: \n      8:   #Check if Zend Server is already bootstrapped.\n      9:   #The zend_gui_completed fact is a string and not a boolean.\n     10:   if $::zend_gui_completed != true {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "justindowning@puppet-rbenv-manifests-build.pp", "content": "# Updating rdoc before installing gems via rbenv::gem also fixes this issue", "line": 156, "detection_span": [151, 161], "with_context": "# Puppet file: justindowning@puppet-rbenv-manifests-build.pp\n\n151:   # Install Bundler with no docs\n152:   # The 2.5.x version of rdoc (used in Ruby 1.8.x and 1.9.x) causes\n153:   # this error if docs are included during puppet run:\n154:   #   ERROR:  While executing gem ... (TypeError)\n#     can't convert nil into String\n156:   # Updating rdoc before installing gems via rbenv::gem also fixes this issue\n157:   rbenv::gem { \"bundler-${title}\":\ngem          => 'bundler',\nruby_version => $title,\nskip_docs    => true,\nversion      => $bundler_version,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: justindowning@puppet-rbenv-manifests-build.pp\n# Target line: 156\n\n    151:   # Install Bundler with no docs\n    152:   # The 2.5.x version of rdoc (used in Ruby 1.8.x and 1.9.x) causes\n    153:   # this error if docs are included during puppet run:\n    154:   #   ERROR:  While executing gem ... (TypeError)\n    155:   #     can't convert nil into String\n>>> 156:   # Updating rdoc before installing gems via rbenv::gem also fixes this issue\n    157:   rbenv::gem { \"bundler-${title}\":\n    158:     gem          => 'bundler',\n    159:     ruby_version => $title,\n    160:     skip_docs    => true,\n    161:     version      => $bundler_version,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "#   source => 'puppet:///modules/postfix/ldapoptions.cf',", "line": 43, "detection_span": [38, 48], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n#     result_attribute => 'uid',\n#   }\n# }\n#\n# postfix::conffile { 'ldapoptions.cf':\n43: #   source => 'puppet:///modules/postfix/ldapoptions.cf',\n# }\n#\ndefine postfix::conffile (\nEnum['present', 'absent', 'directory'] $ensure   = 'present',\nVariant[Array[String], String, Undef]  $source   = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 43\n\n     38: #     result_attribute => 'uid',\n     39: #   }\n     40: # }\n     41: #\n     42: # postfix::conffile { 'ldapoptions.cf':\n>>>  43: #   source => 'puppet:///modules/postfix/ldapoptions.cf',\n     44: # }\n     45: #\n     46: define postfix::conffile (\n     47:   Enum['present', 'absent', 'directory'] $ensure   = 'present',\n     48:   Variant[Array[String], String, Undef]  $source   = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder_update.pp", "content": "# extracted to its own wrapper class to allow each of the jobs to issue", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder_update.pp\n\n# Class: govuk_jenkins::job_builder_update\n#\n# This class updates the jobs deployed to a Jenkins instance. It is\n4: # extracted to its own wrapper class to allow each of the jobs to issue\n# a `notify` against it without risk of side effects on other resources.\n#\n# == Parameters:\n#\n# [*jenkins_url*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-job_builder_update.pp\n# Target line: 4\n\n      1: # Class: govuk_jenkins::job_builder_update\n      2: #\n      3: # This class updates the jobs deployed to a Jenkins instance. It is\n>>>   4: # extracted to its own wrapper class to allow each of the jobs to issue\n      5: # a `notify` against it without risk of side effects on other resources.\n      6: #\n      7: # == Parameters:\n      8: #\n      9: # [*jenkins_url*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "jippi@puppet-php-manifests-extension-xdebug.pp", "content": "#  include php::extension::xdebug", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n\n#\n# No variables\n#\n# === Examples\n#\n31: #  include php::extension::xdebug\n#\n# === Authors\n#\n# Christian \"Jippi\" Winther <jippignu@gmail.com>\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: jippi@puppet-php-manifests-extension-xdebug.pp\n# Target line: 31\n\n     26: #\n     27: # No variables\n     28: #\n     29: # === Examples\n     30: #\n>>>  31: #  include php::extension::xdebug\n     32: #\n     33: # === Authors\n     34: #\n     35: # Christian \"Jippi\" Winther <jippignu@gmail.com>\n     36: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries", "line": 105, "detection_span": [100, 110], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nBoolean                         $manage_mailx        = true,\nOptional[String]                $mastercf_source     = undef,\nOptional[String]                $master_smtp         = undef,         # postfix_master_smtp\nOptional[String]                $master_smtps        = undef,         # postfix_master_smtps\nOptional[String]                $master_submission   = undef,         # postfix_master_submission\n105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\nString                          $master_bounce_command = 'bounce',\nString                          $master_defer_command  = 'bounce',\nBoolean                         $mta                 = false,\nString                          $mydestination       = '$myorigin',   # postfix_mydestination\nString                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 105\n\n    100:   Boolean                         $manage_mailx        = true,\n    101:   Optional[String]                $mastercf_source     = undef,\n    102:   Optional[String]                $master_smtp         = undef,         # postfix_master_smtp\n    103:   Optional[String]                $master_smtps        = undef,         # postfix_master_smtps\n    104:   Optional[String]                $master_submission   = undef,         # postfix_master_submission\n>>> 105:   Optional[Array[String]]         $master_entries      = undef,         # postfix_master_entries\n    106:   String                          $master_bounce_command = 'bounce',\n    107:   String                          $master_defer_command  = 'bounce',\n    108:   Boolean                         $mta                 = false,\n    109:   String                          $mydestination       = '$myorigin',   # postfix_mydestination\n    110:   String                          $mynetworks          = '127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128', # postfix_mynetworks\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-ldap.pp", "content": "# include postfix::ldap", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n\n# - Class[\"postfix\"]\n#\n# === Examples\n#\n# include postfix\n14: # include postfix::ldap\n#\nclass postfix::ldap {\n\nassert_type(String, $postfix::ldap_base)\nassert_type(String, $postfix::ldap_host)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n# Target line: 14\n\n      9: # - Class[\"postfix\"]\n     10: #\n     11: # === Examples\n     12: #\n     13: # include postfix\n>>>  14: # include postfix::ldap\n     15: #\n     16: class postfix::ldap {\n     17: \n     18:   assert_type(String, $postfix::ldap_base)\n     19:   assert_type(String, $postfix::ldap_host)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp", "content": "# == Class: postfix", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n\n1: # == Class: postfix\n#\n# Postfix MTA service\n#\nclass postfix {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-postfix-manifests-init.pp\n# Target line: 1\n\n>>>   1: # == Class: postfix\n      2: #\n      3: # Postfix MTA service\n      4: #\n      5: class postfix {\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp", "content": "# Class fuel_project::devops_tools::lpupdatebug", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n\n1: # Class fuel_project::devops_tools::lpupdatebug\n#\n# This class deploys lpupdatebug package and it's configuration.\n#\n# Parameters:\n#   [*access_token*] - OAuth access token", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-devops_tools-lpupdatebug.pp\n# Target line: 1\n\n>>>   1: # Class fuel_project::devops_tools::lpupdatebug\n      2: #\n      3: # This class deploys lpupdatebug package and it's configuration.\n      4: #\n      5: # Parameters:\n      6: #   [*access_token*] - OAuth access token\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-citoid-manifests-init.pp", "content": "#  the lowest level to log (trace, debug, info, warn, error, fatal)", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-citoid-manifests-init.pp\n\n#\n# [*port*]\n#   the port Citoid will be running on\n#\n# [*log_level*]\n11: #  the lowest level to log (trace, debug, info, warn, error, fatal)\n#\nclass citoid (\n$port,\n$log_level = undef,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-citoid-manifests-init.pp\n# Target line: 11\n\n      6: #\n      7: # [*port*]\n      8: #   the port Citoid will be running on\n      9: #\n     10: # [*log_level*]\n>>>  11: #  the lowest level to log (trace, debug, info, warn, error, fatal)\n     12: #\n     13: class citoid (\n     14:     $port,\n     15:     $log_level = undef,\n     16: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-neutron-manifests-agents-l2gw.pp", "content": "#   (optional) Print debug info in logs", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-agents-l2gw.pp\n\n# [*manage_service*]\n#   (optional) Whether to start/stop the service\n#   Defaults to true\n#\n# [*debug*]\n21: #   (optional) Print debug info in logs\n#   Defaults to $::os_service_default\n#\n# [*ovsdb_hosts*]\n#   (optional) OVSDB server tuples in the format\n#   Example: ovsdb_hosts = 'ovsdb1:16.95.16.1:6632,ovsdb2:16.95.16.2:6632'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-agents-l2gw.pp\n# Target line: 21\n\n     16: # [*manage_service*]\n     17: #   (optional) Whether to start/stop the service\n     18: #   Defaults to true\n     19: #\n     20: # [*debug*]\n>>>  21: #   (optional) Print debug info in logs\n     22: #   Defaults to $::os_service_default\n     23: #\n     24: # [*ovsdb_hosts*]\n     25: #   (optional) OVSDB server tuples in the format\n     26: #   Example: ovsdb_hosts = 'ovsdb1:16.95.16.1:6632,ovsdb2:16.95.16.2:6632'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-https.pp", "content": "# Fix wgServer in wgConf to take", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-https.pp\n\n'mwvSupportsHttps' => true,\n},\npriority => 1,\n}\n\n36:     # Fix wgServer in wgConf to take\n# wgAssumeProxiesUseDefaultProtocolPorts and preserving the port\n# when referencing other wikis into account.\n#\n# We don't need to change $wgServer, because CommonSettings.php\n# changes it anyway after the settings.d are handled.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-https.pp\n# Target line: 36\n\n     31:             'mwvSupportsHttps' => true,\n     32:         },\n     33:         priority => 1,\n     34:     }\n     35: \n>>>  36:     # Fix wgServer in wgConf to take\n     37:     # wgAssumeProxiesUseDefaultProtocolPorts and preserving the port\n     38:     # when referencing other wikis into account.\n     39:     #\n     40:     # We don't need to change $wgServer, because CommonSettings.php\n     41:     # changes it anyway after the settings.d are handled.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp", "content": "# Output to Kafka.  All messages will produced to topics prefixed", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n\n}\n\n# TODO: This will be deprecated in favor of eventgate service\n#       once schemas and events are compatible.\n$outputs = [\n36:         # Output to Kafka.  All messages will produced to topics prefixed\n# with a datacenter name.\n# In mediawiki-vagrant this defaults to 'datacenter1'.\n'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n# Also output to a file for handy debugging\n'file:///vagrant/logs/eventbus.log',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-eventbus.pp\n# Target line: 36\n\n     31:     }\n     32: \n     33:     # TODO: This will be deprecated in favor of eventgate service\n     34:     #       once schemas and events are compatible.\n     35:     $outputs = [\n>>>  36:         # Output to Kafka.  All messages will produced to topics prefixed\n     37:         # with a datacenter name.\n     38:         # In mediawiki-vagrant this defaults to 'datacenter1'.\n     39:         'kafka:///localhost:9092?async=False&topic=datacenter1.{meta[topic]}',\n     40:         # Also output to a file for handy debugging\n     41:         'file:///vagrant/logs/eventbus.log',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_graphite.pp", "content": "# FIXME: Remove this patch when Graphite is upgraded past 0.9.13", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_graphite.pp\n\nstorage_schemas_source     => 'puppet:///modules/govuk/node/s_graphite/storage-schemas.conf',\ncarbon_source              => 'puppet:///modules/govuk/node/s_graphite/carbon.conf',\nrequire                    => Govuk_mount[$graphite_path],\n}\n\n34:   # FIXME: Remove this patch when Graphite is upgraded past 0.9.13\n# This patch is https://github.com/graphite-project/carbon/pull/351 - the bug\n# that this fixes was released as part of 0.9.13 which breaks all of our\n# carbon-aggregator metrics.\n$service_py = \"${graphite_path}/lib/carbon/service.py\"\n$service_patch = \"${graphite_path}/graphite_carbon_service.patch\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_graphite.pp\n# Target line: 34\n\n     29:     storage_schemas_source     => 'puppet:///modules/govuk/node/s_graphite/storage-schemas.conf',\n     30:     carbon_source              => 'puppet:///modules/govuk/node/s_graphite/carbon.conf',\n     31:     require                    => Govuk_mount[$graphite_path],\n     32:   }\n     33: \n>>>  34:   # FIXME: Remove this patch when Graphite is upgraded past 0.9.13\n     35:   # This patch is https://github.com/graphite-project/carbon/pull/351 - the bug\n     36:   # that this fixes was released as part of 0.9.13 which breaks all of our\n     37:   # carbon-aggregator metrics.\n     38:   $service_py = \"${graphite_path}/lib/carbon/service.py\"\n     39:   $service_patch = \"${graphite_path}/graphite_carbon_service.patch\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-cluster-manifests-corosync-cs_service.pp", "content": "#TODO (bogdando) move to extras ha wrappers,", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-corosync-cs_service.pp\n\n# Not a doc string\n\n3: #TODO (bogdando) move to extras ha wrappers,\n#  remove mangling due to new pcs provider\ndefine cluster::corosync::cs_service (\n$ocf_script,\n$service_name,\n$service_title = undef,  # Title of Service, that been mangled for pacemakering", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cluster-manifests-corosync-cs_service.pp\n# Target line: 3\n\n      1: # Not a doc string\n      2: \n>>>   3: #TODO (bogdando) move to extras ha wrappers,\n      4: #  remove mangling due to new pcs provider\n      5: define cluster::corosync::cs_service (\n      6:   $ocf_script,\n      7:   $service_name,\n      8:   $service_title = undef,  # Title of Service, that been mangled for pacemakering\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fraenki@puppet-galera-manifests-debian.pp", "content": "# Fixes Debian specific compatibility issues", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n\n# == Class: galera::debian\n#\n3: # Fixes Debian specific compatibility issues\n#\nclass galera::debian {\nif ($facts['os']['family'] != 'Debian') {\nwarn('the galera::debian class has been included on a non-debian host')\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n# Target line: 3\n\n      1: # == Class: galera::debian\n      2: #\n>>>   3: # Fixes Debian specific compatibility issues\n      4: #\n      5: class galera::debian {\n      6:   if ($facts['os']['family'] != 'Debian') {\n      7:     warn('the galera::debian class has been included on a non-debian host')\n      8:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-toragent.pp", "content": "## TODO: document the class", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-toragent.pp\n\n1: ## TODO: document the class\nclass contrail::toragent(\n$config_ip = $::contrail::params::config_ip_list[0],\n$contrail_tsn_ip = $::contrail::params::tsn_ip_list[0],\n$contrail_tsn_hostname = $::contrail::params::tsn_name_list[0],\n$contrail_openstack_ip = $::contrail::params::openstack_ip_list[0],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-toragent.pp\n# Target line: 1\n\n>>>   1: ## TODO: document the class\n      2: class contrail::toragent(\n      3:     $config_ip = $::contrail::params::config_ip_list[0],\n      4:     $contrail_tsn_ip = $::contrail::params::tsn_ip_list[0],\n      5:     $contrail_tsn_hostname = $::contrail::params::tsn_name_list[0],\n      6:     $contrail_openstack_ip = $::contrail::params::openstack_ip_list[0],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_docker-manifests-init.pp", "content": "# Docker machines should run with the latest Xenial kernel to fix", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_docker-manifests-init.pp\n\n\ngovuk_harden::sysctl::conf { 'docker-ip-forward':\ncontent => \"net.ipv4.ip_forward = 1\\n\",\n}\n\n40:   # Docker machines should run with the latest Xenial kernel to fix\n# stability issues\n$kernel_packages = [\n'linux-generic-lts-xenial',\n'linux-image-generic-lts-xenial',\n]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_docker-manifests-init.pp\n# Target line: 40\n\n     35: \n     36:   govuk_harden::sysctl::conf { 'docker-ip-forward':\n     37:     content => \"net.ipv4.ip_forward = 1\\n\",\n     38:   }\n     39: \n>>>  40:   # Docker machines should run with the latest Xenial kernel to fix\n     41:   # stability issues\n     42:   $kernel_packages = [\n     43:     'linux-generic-lts-xenial',\n     44:     'linux-image-generic-lts-xenial',\n     45:   ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-resource-mailhost.pp", "content": "#                             While issue jfryman/puppet-nginx#30 is discussed, default value is 'default'.", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-resource-mailhost.pp\n\n#   [*ipv6_enable*]         - BOOL value to enable/disable IPv6 support (false|true). Module will check to see if IPv6\n#                             support exists on your system before enabling.\n#   [*ipv6_listen_ip*]      - Default IPv6 Address for NGINX to listen with this vHost on. Defaults to all interfaces (::)\n#   [*ipv6_listen_port*]    - Default IPv6 Port for NGINX to listen with this vHost on. Defaults to TCP 80\n#   [*ipv6_listen_options*] - Extra options for listen directive like 'default' to catchall. Template will allways add ipv6only=on.\n15: #                             While issue jfryman/puppet-nginx#30 is discussed, default value is 'default'.\n#   [*index_files*]         - Default index files for NGINX to read when traversing a directory\n#   [*ssl*]                 - Indicates whether to setup SSL bindings for this mailhost.\n#   [*ssl_cert*]            - Pre-generated SSL Certificate file to reference for SSL Support. This is not generated by this module.\n#   [*ssl_key*]             - Pre-generated SSL Key file to reference for SSL Support. This is not generated by this module.\n#   [*ssl_port*]            - Default IP Port for NGINX to listen with this SSL vHost on. Defaults to TCP 443", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-nginx-manifests-resource-mailhost.pp\n# Target line: 15\n\n     10: #   [*ipv6_enable*]         - BOOL value to enable/disable IPv6 support (false|true). Module will check to see if IPv6\n     11: #                             support exists on your system before enabling.\n     12: #   [*ipv6_listen_ip*]      - Default IPv6 Address for NGINX to listen with this vHost on. Defaults to all interfaces (::)\n     13: #   [*ipv6_listen_port*]    - Default IPv6 Port for NGINX to listen with this vHost on. Defaults to TCP 80\n     14: #   [*ipv6_listen_options*] - Extra options for listen directive like 'default' to catchall. Template will allways add ipv6only=on.\n>>>  15: #                             While issue jfryman/puppet-nginx#30 is discussed, default value is 'default'.\n     16: #   [*index_files*]         - Default index files for NGINX to read when traversing a directory\n     17: #   [*ssl*]                 - Indicates whether to setup SSL bindings for this mailhost.\n     18: #   [*ssl_cert*]            - Pre-generated SSL Certificate file to reference for SSL Support. This is not generated by this module.\n     19: #   [*ssl_key*]             - Pre-generated SSL Key file to reference for SSL Support. This is not generated by this module.\n     20: #   [*ssl_port*]            - Default IP Port for NGINX to listen with this SSL vHost on. Defaults to TCP 443\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "Boolean                         $use_amavisd         = false,         # postfix_use_amavisd", "line": 118, "detection_span": [113, 123], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\nBoolean                         $manage_root_alias   = true,\nVariant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\nOptional[Boolean]               $chroot              = undef,\nBoolean                         $satellite           = false,\nString                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\n118:   Boolean                         $use_amavisd         = false,         # postfix_use_amavisd\nBoolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\nVariant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder\nBoolean                         $use_sympa           = false,         # postfix_use_sympa\nString                          $postfix_ensure      = 'present',\nString                          $mailx_ensure        = 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 118\n\n    113:   Boolean                         $manage_root_alias   = true,\n    114:   Variant[Array[String], String]  $root_mail_recipient = 'nobody',      # root_mail_recipient\n    115:   Optional[Boolean]               $chroot              = undef,\n    116:   Boolean                         $satellite           = false,\n    117:   String                          $smtp_listen         = '127.0.0.1',   # postfix_smtp_listen\n>>> 118:   Boolean                         $use_amavisd         = false,         # postfix_use_amavisd\n    119:   Boolean                         $use_dovecot_lda     = false,         # postfix_use_dovecot_lda\n    120:   Variant[Integer[2, 3], Boolean] $use_schleuder       = false,         # postfix_use_schleuder\n    121:   Boolean                         $use_sympa           = false,         # postfix_use_sympa\n    122:   String                          $postfix_ensure      = 'present',\n    123:   String                          $mailx_ensure        = 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-mta.pp", "content": "# == Class: postfix::mta", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-mta.pp\n\n1: # == Class: postfix::mta\n#\n# This class configures a minimal MTA, delivering mail to\n# $mydestination.\n#\n# Either a valid relay host or the special word 'direct' is required", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-mta.pp\n# Target line: 1\n\n>>>   1: # == Class: postfix::mta\n      2: #\n      3: # This class configures a minimal MTA, delivering mail to\n      4: # $mydestination.\n      5: #\n      6: # Either a valid relay host or the special word 'direct' is required\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-openstack-manifests-corosync.pp", "content": "# NOTE(bogdando) debug is *too* verbose", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack-manifests-corosync.pp\n\nset_votequorum           => true,\nmanage_pacemaker_service => true,\nquorum_members           => $quorum_members,\nquorum_members_ids       => $quorum_members_ids,\nunicast_addresses        => $unicast_addresses,\n51:     # NOTE(bogdando) debug is *too* verbose\ndebug                    => false,\nlog_stderr               => false,\nlog_function_name        => true,\n# NOTE(scsnow) workaround for rhel7.2\ncluster_name             => 'openstack',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack-manifests-corosync.pp\n# Target line: 51\n\n     46:     set_votequorum           => true,\n     47:     manage_pacemaker_service => true,\n     48:     quorum_members           => $quorum_members,\n     49:     quorum_members_ids       => $quorum_members_ids,\n     50:     unicast_addresses        => $unicast_addresses,\n>>>  51:     # NOTE(bogdando) debug is *too* verbose\n     52:     debug                    => false,\n     53:     log_stderr               => false,\n     54:     log_function_name        => true,\n     55:     # NOTE(scsnow) workaround for rhel7.2\n     56:     cluster_name             => 'openstack',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-again.pp", "content": "# TODO: we could include an option to disable this exec again and", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-again.pp\n\n# puppet run, and that stuff that is going to happen is useful to what just did\n# run, which is why we don't want to wait for it to happen naturally in 30 min.\n\nclass gluster::again {\n\n28: \t# TODO: we could include an option to disable this exec again and\n# replace it with a \"dummy\" noop if someone doesn't want to use it.\ninclude common::again\n\n# when notified, this will run puppet again, delta sec after it ends!\ncommon::again::delta { 'gluster-exec-again':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-again.pp\n# Target line: 28\n\n     23: # puppet run, and that stuff that is going to happen is useful to what just did\n     24: # run, which is why we don't want to wait for it to happen naturally in 30 min.\n     25: \n     26: class gluster::again {\n     27: \n>>>  28: \t# TODO: we could include an option to disable this exec again and\n     29: \t# replace it with a \"dummy\" noop if someone doesn't want to use it.\n     30: \tinclude common::again\n     31: \n     32: \t# when notified, this will run puppet again, delta sec after it ends!\n     33: \tcommon::again::delta { 'gluster-exec-again':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-pg_hba_rule.pp", "content": "# probably points to a bug inside ripienaar-concat.", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-pg_hba_rule.pp\n\nif($type =~ /^host/ and $address == undef) {\nfail('You must specify an address property when type is host based')\n}\n\n# This is required to make sure concat::setup is initialized first. This\n26:   # probably points to a bug inside ripienaar-concat.\ninclude concat::setup\n\n# Create a rule fragment\n$fragname = \"pg_hba_rule_${name}\"\nconcat::fragment { $fragname:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-pg_hba_rule.pp\n# Target line: 26\n\n     21:   if($type =~ /^host/ and $address == undef) {\n     22:     fail('You must specify an address property when type is host based')\n     23:   }\n     24: \n     25:   # This is required to make sure concat::setup is initialized first. This\n>>>  26:   # probably points to a bug inside ripienaar-concat.\n     27:   include concat::setup\n     28: \n     29:   # Create a rule fragment\n     30:   $fragname = \"pg_hba_rule_${name}\"\n     31:   concat::fragment { $fragname:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "# It is mainly a file resource that also restarts postfix", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n# = Define: postfix::conffile\n#\n# Adds a postfix configuration file.\n4: # It is mainly a file resource that also restarts postfix\n#\n# == Parameters\n#\n# [*ensure*]\n#   Ensure parameter for the file resource. Defaults to 'present'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 4\n\n      1: # = Define: postfix::conffile\n      2: #\n      3: # Adds a postfix configuration file.\n>>>   4: # It is mainly a file resource that also restarts postfix\n      5: #\n      6: # == Parameters\n      7: #\n      8: # [*ensure*]\n      9: #   Ensure parameter for the file resource. Defaults to 'present'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-l23network-manifests-l3-ifconfig.pp", "content": "# # todo: move routing to separated resource with his own provider", "line": 127, "detection_span": [122, 132], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-ifconfig.pp\n\n}\n123:   }\n124:\n125:   if $method == 'static' {\n$def_gateway = $gateway\n127:     # # todo: move routing to separated resource with his own provider\n# if ($def_gateway and !defined(L23network::L3::Defaultroute[$def_gateway])) {\n#   Anchor['l23network::init'] ->\n#   L3_ifconfig[$interface]\n#   ->\n#   l23network::l3::defaultroute { $def_gateway: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-ifconfig.pp\n# Target line: 127\n\n    122:     }\n    123:   }\n    124: \n    125:   if $method == 'static' {\n    126:     $def_gateway = $gateway\n>>> 127:     # # todo: move routing to separated resource with his own provider\n    128:     # if ($def_gateway and !defined(L23network::L3::Defaultroute[$def_gateway])) {\n    129:     #   Anchor['l23network::init'] ->\n    130:     #   L3_ifconfig[$interface]\n    131:     #   ->\n    132:     #   l23network::l3::defaultroute { $def_gateway: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#    include postfix", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#\n#Example usage:\n#\n#  node \"toto.example.com\" {\n#\n20: #    include postfix\n#\n#    postfix::hash { \"/etc/postfix/recipient_canonical\":\n#      ensure => present,\n#    }\n#    postfix::config { \"canonical_alias_maps\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 20\n\n     15: #\n     16: #Example usage:\n     17: #\n     18: #  node \"toto.example.com\" {\n     19: #\n>>>  20: #    include postfix\n     21: #\n     22: #    postfix::hash { \"/etc/postfix/recipient_canonical\":\n     23: #      ensure => present,\n     24: #    }\n     25: #    postfix::config { \"canonical_alias_maps\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "HewlettPackard@oneview-puppet-examples-firmware_driver.pp", "content": "# Example: hotfixUris => ['value1', 'value2', 'value3']", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: HewlettPackard@oneview-puppet-examples-firmware_driver.pp\n\n\n# NOTE: Both 'customBaselineName' or simply 'name' are accepted as the single identifier for the custom firmware package.\n# It is required to have exactly one of those on each resource declaration\n# NOTE: 1- baselineUri and hotfixUris accept either the uri or names for the drivers\n# NOTE: 2- hotfixUris values must be inserted inside an array, enclosed by [].\n21:   # Example: hotfixUris => ['value1', 'value2', 'value3']\n\noneview_firmware_driver{'firmware_driver_1':\nensure => 'present',\ndata   => {\ncustomBaselineName => 'FirmwareDriver1_Example',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: HewlettPackard@oneview-puppet-examples-firmware_driver.pp\n# Target line: 21\n\n     16: \n     17: # NOTE: Both 'customBaselineName' or simply 'name' are accepted as the single identifier for the custom firmware package.\n     18:   # It is required to have exactly one of those on each resource declaration\n     19: # NOTE: 1- baselineUri and hotfixUris accept either the uri or names for the drivers\n     20: # NOTE: 2- hotfixUris values must be inserted inside an array, enclosed by [].\n>>>  21:   # Example: hotfixUris => ['value1', 'value2', 'value3']\n     22: \n     23: oneview_firmware_driver{'firmware_driver_1':\n     24:     ensure => 'present',\n     25:     data   => {\n     26:       customBaselineName => 'FirmwareDriver1_Example',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp", "content": "# puppi::todo { \"cacti_db_install\":", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n\n#    been accomplished, so it can't be notified if the todo has been done\n# 2- ERROR - The task to do has not been accomplished becuase the command\n#    specified as check_command returns an error (exit status different from 0)\n#\n# == Usage:\n26: # puppi::todo { \"cacti_db_install\":\n#   description => \"Manual cacti db installation\" ,\n# }\n#\ndefine puppi::todo (\n$description   = '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n# Target line: 26\n\n     21: #    been accomplished, so it can't be notified if the todo has been done\n     22: # 2- ERROR - The task to do has not been accomplished becuase the command\n     23: #    specified as check_command returns an error (exit status different from 0)\n     24: #\n     25: # == Usage:\n>>>  26: # puppi::todo { \"cacti_db_install\":\n     27: #   description => \"Manual cacti db installation\" ,\n     28: # }\n     29: #\n     30: define puppi::todo (\n     31:   $description   = '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-server.pp", "content": "# https://bugzilla.redhat.com/show_bug.cgi?id=987555", "line": 100, "detection_span": [95, 105], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n\n#notify => Service[\"${::gluster::params::service_glusterd}\"],\t# TODO: ???\nrequire => Package[\"${::gluster::params::package_glusterfs_server}\"],\n}\n\n# NOTE: this option can be useful for users of libvirt migration as in:\n100: \t# https://bugzilla.redhat.com/show_bug.cgi?id=987555\n101: \t$valid_baseport = inline_template('<%= [Fixnum, String].include?(@baseport.class) ? @baseport.to_i : 0 %>')\n102:\n103: \t$valid_rpcauthallowinsecure = $rpcauthallowinsecure ? {\n104: \t\ttrue => true,\n105: \t\tdefault => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n# Target line: 100\n\n     95: \t\t#notify => Service[\"${::gluster::params::service_glusterd}\"],\t# TODO: ???\n     96: \t\trequire => Package[\"${::gluster::params::package_glusterfs_server}\"],\n     97: \t}\n     98: \n     99: \t# NOTE: this option can be useful for users of libvirt migration as in:\n>>> 100: \t# https://bugzilla.redhat.com/show_bug.cgi?id=987555\n    101: \t$valid_baseport = inline_template('<%= [Fixnum, String].include?(@baseport.class) ? @baseport.to_i : 0 %>')\n    102: \n    103: \t$valid_rpcauthallowinsecure = $rpcauthallowinsecure ? {\n    104: \t\ttrue => true,\n    105: \t\tdefault => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-ironic-manifests-db-sync.pp", "content": "# as \"ironic\" user, if there is an old log file owned by root. Let's fix it.", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-db-sync.pp\n\n\ninclude ::ironic::deps\ninclude ::ironic::params\n\n# NOTE(dtantsur): previous ironic-dbsync was run as root. it will fail to run\n19:   # as \"ironic\" user, if there is an old log file owned by root. Let's fix it.\n# To be removed in Rocky.\nfile { '/var/log/ironic/ironic-dbsync.log':\nensure  => 'present',\nowner   => 'ironic',\ngroup   => 'ironic',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-db-sync.pp\n# Target line: 19\n\n     14: \n     15:   include ::ironic::deps\n     16:   include ::ironic::params\n     17: \n     18:   # NOTE(dtantsur): previous ironic-dbsync was run as root. it will fail to run\n>>>  19:   # as \"ironic\" user, if there is an old log file owned by root. Let's fix it.\n     20:   # To be removed in Rocky.\n     21:   file { '/var/log/ironic/ironic-dbsync.log':\n     22:     ensure  => 'present',\n     23:     owner   => 'ironic',\n     24:     group   => 'ironic',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-agents-midonet.pp", "content": "# TODO(devvesa) provide non-controller ips for these services", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-agents-midonet.pp\n\n$midonet_libvirt_qemu_data = hiera('midonet_libvirt_qemu_data', ''),\n$neutron_api_node_ips      = hiera('neutron_api_node_ips', ''),\n$step                      = Integer(hiera('step')),\n) {\nif $step >= 4 {\n39:     # TODO(devvesa) provide non-controller ips for these services\nclass { '::tripleo::network::midonet::agent':\nzookeeper_servers => $neutron_api_node_ips,\ncassandra_seeds   => $neutron_api_node_ips\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-agents-midonet.pp\n# Target line: 39\n\n     34:   $midonet_libvirt_qemu_data = hiera('midonet_libvirt_qemu_data', ''),\n     35:   $neutron_api_node_ips      = hiera('neutron_api_node_ips', ''),\n     36:   $step                      = Integer(hiera('step')),\n     37: ) {\n     38:   if $step >= 4 {\n>>>  39:     # TODO(devvesa) provide non-controller ips for these services\n     40:     class { '::tripleo::network::midonet::agent':\n     41:       zookeeper_servers => $neutron_api_node_ips,\n     42:       cassandra_seeds   => $neutron_api_node_ips\n     43:     }\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp", "content": "# 1- WARNING - User hasn't specified a check_command to verify if the todo as", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n\n#\n# Use the command puppi todo to show the todo present in your node.\n# The exit status can be:\n# 0 - OK - The task to do has been accomplished because the command specified\n#    as check_command returns true (exit status 0)\n20: # 1- WARNING - User hasn't specified a check_command to verify if the todo as\n#    been accomplished, so it can't be notified if the todo has been done\n# 2- ERROR - The task to do has not been accomplished becuase the command\n#    specified as check_command returns an error (exit status different from 0)\n#\n# == Usage:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-puppi-manifests-todo.pp\n# Target line: 20\n\n     15: #\n     16: # Use the command puppi todo to show the todo present in your node.\n     17: # The exit status can be:\n     18: # 0 - OK - The task to do has been accomplished because the command specified\n     19: #    as check_command returns true (exit status 0)\n>>>  20: # 1- WARNING - User hasn't specified a check_command to verify if the todo as\n     21: #    been accomplished, so it can't be notified if the todo has been done\n     22: # 2- ERROR - The task to do has not been accomplished becuase the command\n     23: #    specified as check_command returns an error (exit status different from 0)\n     24: #\n     25: # == Usage:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-apache-manifests-mod.pp", "content": "$mod_lib = $mod_libs[$mod] # 2.6 compatibility hack", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apache-manifests-mod.pp\n\n#include apache #This creates duplicate resources in rspec-puppet\n$mod_dir = $::apache::mod_dir\n\n# Determine if we have special lib\n$mod_libs = $::apache::params::mod_libs\n21:   $mod_lib = $mod_libs[$mod] # 2.6 compatibility hack\nif $lib {\n$_lib = $lib\n} elsif $mod_lib {\n$_lib = $mod_lib\n} else {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-apache-manifests-mod.pp\n# Target line: 21\n\n     16:   #include apache #This creates duplicate resources in rspec-puppet\n     17:   $mod_dir = $::apache::mod_dir\n     18: \n     19:   # Determine if we have special lib\n     20:   $mod_libs = $::apache::params::mod_libs\n>>>  21:   $mod_lib = $mod_libs[$mod] # 2.6 compatibility hack\n     22:   if $lib {\n     23:     $_lib = $lib\n     24:   } elsif $mod_lib {\n     25:     $_lib = $mod_lib\n     26:   } else {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-openldap-manifests-server-access_wrapper.pp", "content": "# [*suffix*]", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n\n#\n# Generate access from a given hash.\n#\n# === Parameters\n#\n7: # [*suffix*]\n#   Default: $name\n#   Mandatory. The suffix to apply acls\n#\n# [*acl*]\n#   Default:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-openldap-manifests-server-access_wrapper.pp\n# Target line: 7\n\n      2: #\n      3: # Generate access from a given hash.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # [*suffix*]\n      8: #   Default: $name\n      9: #   Mandatory. The suffix to apply acls\n     10: #\n     11: # [*acl*]\n     12: #   Default:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-murano.pp", "content": "# TODO(mmalchuk) remove this after LP#1628580 merged", "line": 118, "detection_span": [113, 123], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-murano.pp\n\n} else {\n$packages_service = 'murano'\n$enable_glare     = false\n}\n117:\n118:     # TODO(mmalchuk) remove this after LP#1628580 merged\nExec<| title == 'murano-dbmanage' |> {\ntries => '10',\ntry_sleep => '5'\n}\n123:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-murano-murano.pp\n# Target line: 118\n\n    113:     } else {\n    114:       $packages_service = 'murano'\n    115:       $enable_glare     = false\n    116:     }\n    117: \n>>> 118:     # TODO(mmalchuk) remove this after LP#1628580 merged\n    119:     Exec<| title == 'murano-dbmanage' |> {\n    120:       tries => '10',\n    121:       try_sleep => '5'\n    122:     }\n    123: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-debian.pp", "content": "# This fixes a bug in the iptables-persistent LSB headers in 6.x, without it", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-debian.pp\n\n}\n}\n\nif($::operatingsystemrelease =~ /^6\\./ and $enable == true and $::iptables_persistent_version\nand versioncmp($::iptables_persistent_version, '0.5.0') < 0) {\n38:     # This fixes a bug in the iptables-persistent LSB headers in 6.x, without it\n# we lose idempotency\nexec { 'iptables-persistent-enable':\nlogoutput => on_failure,\ncommand   => '/usr/sbin/update-rc.d iptables-persistent enable',\nunless    => '/usr/bin/test -f /etc/rcS.d/S*iptables-persistent',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-unix-firewall-firewall-manifests-linux-debian.pp\n# Target line: 38\n\n     33:     }\n     34:   }\n     35: \n     36:   if($::operatingsystemrelease =~ /^6\\./ and $enable == true and $::iptables_persistent_version\n     37:   and versioncmp($::iptables_persistent_version, '0.5.0') < 0) {\n>>>  38:     # This fixes a bug in the iptables-persistent LSB headers in 6.x, without it\n     39:     # we lose idempotency\n     40:     exec { 'iptables-persistent-enable':\n     41:       logoutput => on_failure,\n     42:       command   => '/usr/sbin/update-rc.d iptables-persistent enable',\n     43:       unless    => '/usr/bin/test -f /etc/rcS.d/S*iptables-persistent',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-install.pp", "content": "# $hackerbot_xml_configs = []", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-install.pp\n\n# $json_inputs = base64('decode', $::base64_inputs)\n# $secgen_parameters = parsejson($json_inputs)\n# $server_ip = $secgen_parameters['server_ip'][0]\n# $port = $secgen_parameters['port'][0]\n\n7:   # $hackerbot_xml_configs = []\n# $hackerbot_lab_sheets = []\n\nfile { '/opt/hackerbot':\nensure => directory,\nrecurse => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-utilities-unix-hackerbot-manifests-install.pp\n# Target line: 7\n\n      2:   # $json_inputs = base64('decode', $::base64_inputs)\n      3:   # $secgen_parameters = parsejson($json_inputs)\n      4:   # $server_ip = $secgen_parameters['server_ip'][0]\n      5:   # $port = $secgen_parameters['port'][0]\n      6: \n>>>   7:   # $hackerbot_xml_configs = []\n      8:   # $hackerbot_lab_sheets = []\n      9: \n     10:   file { '/opt/hackerbot':\n     11:     ensure => directory,\n     12:     recurse => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "basho-labs@puppet-riak-manifests-repository-el.pp", "content": "gpgcheck  => '0', # the rpm isn't signed, see https://github.com/basho/riak/issues/714", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: basho-labs@puppet-riak-manifests-repository-el.pp\n\n}\nyumrepo { 'basho_riak':\nbaseurl   => \"https://packagecloud.io/basho/riak/el/${::operatingsystemmajrelease}/${::architecture}\",\ndescr     => 'Riak packages distributed by Basho',\nenabled   => '1',\n17:     gpgcheck  => '0', # the rpm isn't signed, see https://github.com/basho/riak/issues/714\ngpgkey    => 'https://packagecloud.io/gpg.key',\nsslverify => '1',\nbefore    => Package[$::riak::package_name],\nrequire   => Exec['import-packagecloud_gpgkey'],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: basho-labs@puppet-riak-manifests-repository-el.pp\n# Target line: 17\n\n     12:   }\n     13:   yumrepo { 'basho_riak':\n     14:     baseurl   => \"https://packagecloud.io/basho/riak/el/${::operatingsystemmajrelease}/${::architecture}\",\n     15:     descr     => 'Riak packages distributed by Basho',\n     16:     enabled   => '1',\n>>>  17:     gpgcheck  => '0', # the rpm isn't signed, see https://github.com/basho/riak/issues/714\n     18:     gpgkey    => 'https://packagecloud.io/gpg.key',\n     19:     sslverify => '1',\n     20:     before    => Package[$::riak::package_name],\n     21:     require   => Exec['import-packagecloud_gpgkey'],\n     22:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-postfix-manifests-service.pp", "content": "# Manage the postfix service", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-service.pp\n\n# == Class: postfix::service\n#\n3: # Manage the postfix service\n#\nclass postfix::service {\nservice { 'postfix':\nensure  => running,\nrequire => Class['postfix::package'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-postfix-manifests-service.pp\n# Target line: 3\n\n      1: # == Class: postfix::service\n      2: #\n>>>   3: # Manage the postfix service\n      4: #\n      5: class postfix::service {\n      6:   service { 'postfix':\n      7:     ensure  => running,\n      8:     require => Class['postfix::package'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-pacemaker-manifests-new-setup-config.pp", "content": "#   * rrp_problem_count_timeout", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n\n#   * heartbeat_failures_allowed\n#   * max_network_delay\n#   * window_size\n#   * max_messages\n#   * miss_count_const\n55: #   * rrp_problem_count_timeout\n#   * rrp_problem_count_threshold\n#   * rrp_problem_count_mcast_threshold\n#   * rrp_token_expired_timeout\n#   * rrp_autorecovery_check_timeout\n#   Logging section:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n# Target line: 55\n\n     50: #   * heartbeat_failures_allowed\n     51: #   * max_network_delay\n     52: #   * window_size\n     53: #   * max_messages\n     54: #   * miss_count_const\n>>>  55: #   * rrp_problem_count_timeout\n     56: #   * rrp_problem_count_threshold\n     57: #   * rrp_problem_count_mcast_threshold\n     58: #   * rrp_token_expired_timeout\n     59: #   * rrp_autorecovery_check_timeout\n     60: #   Logging section:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-openstack-object-proxy.pp", "content": "# HACK: For some reason the swift::proxy::module need this directory", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n\ninclude ::swift::proxy::gatekeeper\ninclude ::swift::proxy::proxy_logging\ninclude ::swift::proxy::catch_errors\n\nif $manage_ceilometer {\n35:     # HACK: For some reason the swift::proxy::module need this directory\nfile { '/var/log/ceilometer':\nensure => directory\n}\ninclude ::swift::proxy::ceilometer\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-object-proxy.pp\n# Target line: 35\n\n     30:   include ::swift::proxy::gatekeeper\n     31:   include ::swift::proxy::proxy_logging\n     32:   include ::swift::proxy::catch_errors\n     33: \n     34:   if $manage_ceilometer {\n>>>  35:     # HACK: For some reason the swift::proxy::module need this directory\n     36:     file { '/var/log/ceilometer':\n     37:       ensure => directory\n     38:     }\n     39:     include ::swift::proxy::ceilometer\n     40:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-passenger.pp", "content": "gpgcheck       => 0, # To fix key autoimport", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-passenger.pp\n\nyum::managed_yumrepo { 'passenger':\ndescr          => 'Red Hat Enterprise $releasever - Phusion Passenger',\nbaseurl        => 'http://passenger.stealthymonkeys.com/rhel/$releasever/$basearch',\nmirrorlist     => 'http://passenger.stealthymonkeys.com/rhel/mirrors',\nenabled        => 1 ,\n12:     gpgcheck       => 0, # To fix key autoimport\nfailovermethod => 'priority',\ngpgkey         => 'http://passenger.stealthymonkeys.com/RPM-GPG-KEY-stealthymonkeys.asc',\nautokeyimport  => 'yes',\npriority       => 20,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-passenger.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'passenger':\n      8:     descr          => 'Red Hat Enterprise $releasever - Phusion Passenger',\n      9:     baseurl        => 'http://passenger.stealthymonkeys.com/rhel/$releasever/$basearch',\n     10:     mirrorlist     => 'http://passenger.stealthymonkeys.com/rhel/mirrors',\n     11:     enabled        => 1 ,\n>>>  12:     gpgcheck       => 0, # To fix key autoimport\n     13:     failovermethod => 'priority',\n     14:     gpgkey         => 'http://passenger.stealthymonkeys.com/RPM-GPG-KEY-stealthymonkeys.asc',\n     15:     autokeyimport  => 'yes',\n     16:     priority       => 20,\n     17:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-augeas.pp", "content": "#class postfix::augeas", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-augeas.pp\n\n1: #class postfix::augeas\n#  This class provides the augeas lenses used by the postfix class\n#\nclass postfix::augeas {\n\n$module_path = get_module_path($module_name)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-augeas.pp\n# Target line: 1\n\n>>>   1: #class postfix::augeas\n      2: #  This class provides the augeas lenses used by the postfix class\n      3: #\n      4: class postfix::augeas {\n      5: \n      6:   $module_path = get_module_path($module_name)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-virtual.pp", "content": "# - Postfix::Hash[\"/etc/postfix/virtual\"]", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n\n# [*file*]        - a string defining the location of the pre-hash map.\n#\n# === Requires\n#\n# - Class[\"postfix\"]\n15: # - Postfix::Hash[\"/etc/postfix/virtual\"]\n# - Postfix::Config[\"virtual_alias_maps\"]\n# - augeas\n#\n# === Examples\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-virtual.pp\n# Target line: 15\n\n     10: # [*file*]        - a string defining the location of the pre-hash map.\n     11: #\n     12: # === Requires\n     13: #\n     14: # - Class[\"postfix\"]\n>>>  15: # - Postfix::Hash[\"/etc/postfix/virtual\"]\n     16: # - Postfix::Config[\"virtual_alias_maps\"]\n     17: # - augeas\n     18: #\n     19: # === Examples\n     20: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-django-manifests-application.pp", "content": "#  [*debug*] - enable debug mode", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-django-manifests-application.pp\n\n#  [*apps*] - apps included in django settings file\n#  [*config*] - django configuration files location\n#  [*config_mode*] - django configuration files mode\n#  [*config_template*] - django settings file template\n#  [*database*] - django database settings file entries\n14: #  [*debug*] - enable debug mode\n#  [*group*] - django installation working group\n#  [*imports*] - imports used in django app\n#  [*logging*] - django logging settings file entries\n#  [*packages*] - system packages required by application\n#  [*secret_key*] - django application secret key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-django-manifests-application.pp\n# Target line: 14\n\n      9: #  [*apps*] - apps included in django settings file\n     10: #  [*config*] - django configuration files location\n     11: #  [*config_mode*] - django configuration files mode\n     12: #  [*config_template*] - django settings file template\n     13: #  [*database*] - django database settings file entries\n>>>  14: #  [*debug*] - enable debug mode\n     15: #  [*group*] - django installation working group\n     16: #  [*imports*] - imports used in django app\n     17: #  [*logging*] - django logging settings file entries\n     18: #  [*packages*] - system packages required by application\n     19: #  [*secret_key*] - django application secret key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-setenv-entry.pp", "content": "# - $doexport is the optional prefix before the variable.", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-setenv-entry.pp\n\n# - $ensure whether the fragment should be present or absent.\n# - $config_file is the path to the config file to edit\n# - $param is the parameter you're setting. Defaults to $name.\n# - $quote_char is the optional character to quote the value with.\n# - $order is the optional order to the param in the file. Defaults to 10\n12: # - $doexport is the optional prefix before the variable.\n# - (Deprecated) $base_path is the path to create the setenv.sh script under. Should be\n#   either $catalina_base/bin or $catalina_home/bin.\ndefine tomcat::setenv::entry (\n$value,\n$ensure        = 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-setenv-entry.pp\n# Target line: 12\n\n      7: # - $ensure whether the fragment should be present or absent.\n      8: # - $config_file is the path to the config file to edit\n      9: # - $param is the parameter you're setting. Defaults to $name.\n     10: # - $quote_char is the optional character to quote the value with.\n     11: # - $order is the optional order to the param in the file. Defaults to 10\n>>>  12: # - $doexport is the optional prefix before the variable.\n     13: # - (Deprecated) $base_path is the path to create the setenv.sh script under. Should be\n     14: #   either $catalina_base/bin or $catalina_home/bin.\n     15: define tomcat::setenv::entry (\n     16:   $value,\n     17:   $ensure        = 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack-infra@puppet-mailman-manifests-site.pp", "content": "# We alias the resource name here so that it can resolve properly", "line": 97, "detection_span": [92, 102], "with_context": "# Puppet file: openstack-infra@puppet-mailman-manifests-site.pp\n\nrequire => File['/etc/mailman/sites'],\npath    => '/etc/mailman/sites',\nline    => \"${default_email_host}: /srv/mailman/${name}\",\n}\n\n97:   # We alias the resource name here so that it can resolve properly\n# within the vhost template when evaluated as part of the vhost\n# define (which will override $name).\n100:   $mailman_site_name = $name\n101:   ::httpd::vhost { $default_url_host:\nport     => 80,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-mailman-manifests-site.pp\n# Target line: 97\n\n     92:     require => File['/etc/mailman/sites'],\n     93:     path    => '/etc/mailman/sites',\n     94:     line    => \"${default_email_host}: /srv/mailman/${name}\",\n     95:   }\n     96: \n>>>  97:   # We alias the resource name here so that it can resolve properly\n     98:   # within the vhost template when evaluated as part of the vhost\n     99:   # define (which will override $name).\n    100:   $mailman_site_name = $name\n    101:   ::httpd::vhost { $default_url_host:\n    102:     port     => 80,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp", "content": "# TODO: create a 'bind' hiera key for zookeeper", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n\n\n# Run zookeeper in the controller if configured\nif zk_on_controller {\nclass {'::tripleo::cluster::zookeeper':\nzookeeper_server_ips => $neutron_api_node_ips,\n87:         # TODO: create a 'bind' hiera key for zookeeper\nzookeeper_client_ip  => $zookeeper_client_ip,\nzookeeper_hostnames  => split($zookeeper_hostnames, ',')\n}\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-midonet.pp\n# Target line: 87\n\n     82: \n     83:     # Run zookeeper in the controller if configured\n     84:     if zk_on_controller {\n     85:       class {'::tripleo::cluster::zookeeper':\n     86:         zookeeper_server_ips => $neutron_api_node_ips,\n>>>  87:         # TODO: create a 'bind' hiera key for zookeeper\n     88:         zookeeper_client_ip  => $zookeeper_client_ip,\n     89:         zookeeper_hostnames  => split($zookeeper_hostnames, ',')\n     90:       }\n     91:     }\n     92: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp", "content": "# NB: Until the IPaddr2 RA has a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1445628", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n\n} else {\n$pacemaker_master = false\n}\n\n$ganesha_vip = hiera('ganesha_vip')\n46:   # NB: Until the IPaddr2 RA has a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1445628\n# we need to specify the nic when creating the ipv6 vip.\nif is_ipv6_address($ganesha_vip) {\n$netmask        = '128'\n$nic            = interface_for_ip($ganesha_vip)\n$ipv6_addrlabel = '99'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n# Target line: 46\n\n     41:   } else {\n     42:     $pacemaker_master = false\n     43:   }\n     44: \n     45:   $ganesha_vip = hiera('ganesha_vip')\n>>>  46:   # NB: Until the IPaddr2 RA has a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1445628\n     47:   # we need to specify the nic when creating the ipv6 vip.\n     48:   if is_ipv6_address($ganesha_vip) {\n     49:     $netmask        = '128'\n     50:     $nic            = interface_for_ip($ganesha_vip)\n     51:     $ipv6_addrlabel = '99'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "# postfix::conffile { 'ldapoptions.cf':", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n#     query_filter     => 'mail=%s',\n#     result_attribute => 'uid',\n#   }\n# }\n#\n42: # postfix::conffile { 'ldapoptions.cf':\n#   source => 'puppet:///modules/postfix/ldapoptions.cf',\n# }\n#\ndefine postfix::conffile (\nEnum['present', 'absent', 'directory'] $ensure   = 'present',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 42\n\n     37: #     query_filter     => 'mail=%s',\n     38: #     result_attribute => 'uid',\n     39: #   }\n     40: # }\n     41: #\n>>>  42: # postfix::conffile { 'ldapoptions.cf':\n     43: #   source => 'puppet:///modules/postfix/ldapoptions.cf',\n     44: # }\n     45: #\n     46: define postfix::conffile (\n     47:   Enum['present', 'absent', 'directory'] $ensure   = 'present',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wesleytodd@YeoPress-app-templates-puppet-modules-puppi-manifests-netinstall.pp", "content": "#   (without suffixes). Optional.", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-puppi-manifests-netinstall.pp\n\n#   Example: /var/www/html\n#\n# [*extracted_dir*]\n#   The name of a directory or file created after the extraction\n#   Needed only if its name is different from the downloaded file name\n23: #   (without suffixes). Optional.\n#\n# [*owner*]\n#   The user owner of the directory / file created. Default: root\n#\n# [*group*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-app-templates-puppet-modules-puppi-manifests-netinstall.pp\n# Target line: 23\n\n     18: #   Example: /var/www/html\n     19: #\n     20: # [*extracted_dir*]\n     21: #   The name of a directory or file created after the extraction \n     22: #   Needed only if its name is different from the downloaded file name\n>>>  23: #   (without suffixes). Optional.\n     24: #\n     25: # [*owner*]\n     26: #   The user owner of the directory / file created. Default: root\n     27: #\n     28: # [*group*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-init.pp", "content": "# FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n\n#\n# XXX: does parted align disks properly ?\n# XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n# XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n\n56: # FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n# FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n# FIXME: can we setup gluster by using templated volume files instead ?\n\n# TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n# TODO: find out when ports are actually necessary for version 3.3", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n# Target line: 56\n\n     51: #\n     52: # XXX: does parted align disks properly ?\n     53: # XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n     54: # XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n     55: \n>>>  56: # FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n     57: # FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n     58: # FIXME: can we setup gluster by using templated volume files instead ?\n     59: \n     60: # TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n     61: # TODO: find out when ports are actually necessary for version 3.3\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp", "content": "# FIXME {", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n\n$server                = undef,\n$service               = undef,\n$ssldir                = undef,\n$vardir                = undef,\n) {\n29:   # FIXME {\n# Legacy cleanup:\n# - /etc/puppet/puppet.conf.d/agent-config.conf\n# - /etc/puppet/puppet.conf.d/master-config.conf\n# - /etc/puppet/puppet.conf.d/\nif(!defined(File['/etc/puppet/puppet.conf.d/agent-config.conf'])) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n# Target line: 29\n\n     24:   $server                = undef,\n     25:   $service               = undef,\n     26:   $ssldir                = undef,\n     27:   $vardir                = undef,\n     28: ) {\n>>>  29:   # FIXME {\n     30:   # Legacy cleanup:\n     31:   # - /etc/puppet/puppet.conf.d/agent-config.conf\n     32:   # - /etc/puppet/puppet.conf.d/master-config.conf\n     33:   # - /etc/puppet/puppet.conf.d/\n     34:   if(!defined(File['/etc/puppet/puppet.conf.d/agent-config.conf'])) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp", "content": "# } FIXME", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n\nfile { '/etc/puppet/puppet.conf.d' :\nensure => 'absent',\nforce  => true,\n}\n}\n52:   # } FIXME\n\nif(!defined(Concat[$config])) {\nconcat { $config :\nensure         => 'present',\nowner          => 'puppet',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-puppet-manifests-config.pp\n# Target line: 52\n\n     47:     file { '/etc/puppet/puppet.conf.d' :\n     48:       ensure => 'absent',\n     49:       force  => true,\n     50:     }\n     51:   }\n>>>  52:   # } FIXME\n     53: \n     54:   if(!defined(Concat[$config])) {\n     55:     concat { $config :\n     56:       ensure         => 'present',\n     57:       owner          => 'puppet',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#    postfix::canonical {", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#      ensure => present,\n#    }\n#    postfix::config { \"canonical_alias_maps\":\n#      value => \"hash:/etc/postfix/recipient_canonical\"\n#    }\n28: #    postfix::canonical {\n#      \"user@example.com\":\n#        file        => \"/etc/postfix/recipient_canonical\",\n#        ensure      => present,\n#        destination => \"root\";\n#    }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 28\n\n     23: #      ensure => present,\n     24: #    }\n     25: #    postfix::config { \"canonical_alias_maps\":\n     26: #      value => \"hash:/etc/postfix/recipient_canonical\"\n     27: #    }\n>>>  28: #    postfix::canonical {\n     29: #      \"user@example.com\":\n     30: #        file        => \"/etc/postfix/recipient_canonical\",\n     31: #        ensure      => present,\n     32: #        destination => \"root\";\n     33: #    }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#- Class[\"postfix\"]", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#- *name*: name of address postfix will lookup. See canonical(5).\n#- *destination*: where the emails will be delivered to. See canonical(5).\n#- *ensure*: present/absent, defaults to present.\n#\n#Requires:\n11: #- Class[\"postfix\"]\n#- Postfix::Hash[\"/etc/postfix/canonical\"]\n#- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n#- augeas\n#\n#Example usage:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 11\n\n      6: #- *name*: name of address postfix will lookup. See canonical(5).\n      7: #- *destination*: where the emails will be delivered to. See canonical(5).\n      8: #- *ensure*: present/absent, defaults to present.\n      9: #\n     10: #Requires:\n>>>  11: #- Class[\"postfix\"]\n     12: #- Postfix::Hash[\"/etc/postfix/canonical\"]\n     13: #- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n     14: #- augeas\n     15: #\n     16: #Example usage:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-queue_with_binding.pp", "content": "# Another side effect of this problem is you can't define more than one binding for a queue.", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-queue_with_binding.pp\n\n# This makes it rather awkward to add or change bindings on any queue which already has a binding, because the\n# provider will think the binding already exists even if the routing keys differ, and will assume\n# that no work needs doing.\n# At present the workaround for changing a binding is to create a new queue for the new binding. Then switch the\n# consumers over to the new queue, and remove the old queue.\n15: # Another side effect of this problem is you can't define more than one binding for a queue.\n# This is possible in version 6.0.0, however that version also drops Puppet 3 support.\n# https://forge.puppet.com/puppet/rabbitmq/changelog\n#\n# govuk_rabbitmq::remove_queues and govuk_rabbitmq::remove_bindings can be used\n# to ensure old queues and bindings are cleaned up.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_rabbitmq-manifests-queue_with_binding.pp\n# Target line: 15\n\n     10: # This makes it rather awkward to add or change bindings on any queue which already has a binding, because the\n     11: # provider will think the binding already exists even if the routing keys differ, and will assume\n     12: # that no work needs doing.\n     13: # At present the workaround for changing a binding is to create a new queue for the new binding. Then switch the\n     14: # consumers over to the new queue, and remove the old queue.\n>>>  15: # Another side effect of this problem is you can't define more than one binding for a queue.\n     16: # This is possible in version 6.0.0, however that version also drops Puppet 3 support.\n     17: # https://forge.puppet.com/puppet/rabbitmq/changelog\n     18: #\n     19: # govuk_rabbitmq::remove_queues and govuk_rabbitmq::remove_bindings can be used\n     20: # to ensure old queues and bindings are cleaned up.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb.pp", "content": "# this is done in mysql::server::account_security but has problems", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb.pp\n\n},\n},\n}\n\n# deleting database users for security\n47:     # this is done in mysql::server::account_security but has problems\n# when there is no fqdn, so we're defining a slightly different one here\nmysql_user { [ 'root@127.0.0.1', 'root@::1', '@localhost', '@%' ]:\nensure  => 'absent',\nrequire => Class['mysql::server'],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb.pp\n# Target line: 47\n\n     42:         },\n     43:       },\n     44:     }\n     45: \n     46:     # deleting database users for security\n>>>  47:     # this is done in mysql::server::account_security but has problems\n     48:     # when there is no fqdn, so we're defining a slightly different one here\n     49:     mysql_user { [ 'root@127.0.0.1', 'root@::1', '@localhost', '@%' ]:\n     50:       ensure  => 'absent',\n     51:       require => Class['mysql::server'],\n     52:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "zend-patterns@ZendServerPuppet-manifests-directive.pp", "content": "# Todo: other types?", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-directive.pp\n\n#  zendserver::directive { 'upload_max_filesize':\n#    directive_value  => '20M',\n#  }\n#\n# Todo: paths\n23: # Todo: other types?\n\ndefine zendserver::directive (\n$directive_value,\n$target             = 'localadmin',\n$downcase_name    = downcase($name),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-directive.pp\n# Target line: 23\n\n     18: #  zendserver::directive { 'upload_max_filesize':\n     19: #    directive_value  => '20M',\n     20: #  }\n     21: #\n     22: # Todo: paths\n>>>  23: # Todo: other types?\n     24: \n     25: define zendserver::directive (\n     26:   $directive_value,\n     27:   $target             = 'localadmin',\n     28:   $downcase_name    = downcase($name),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danofthewired@puppet-bitbucket-manifests-config.pp", "content": "# See issue #16 for more detail", "line": 16, "detection_span": [11, 21], "with_context": "# Puppet file: danofthewired@puppet-bitbucket-manifests-config.pp\n\n$tomcat_port  = $bitbucket::tomcat_port,\n$config_properties = $bitbucket::config_properties,\n) {\n\n# Atlassian changed where files are installed from ver 3.2.0\n16:   # See issue #16 for more detail\nif versioncmp($version, '3.2.0') > 0 {\n$moved = 'shared/'\n$shared_dir = \"${bitbucket::homedir}/${moved}\"\n# Shared directory may be already defined when installing DataCenter instances (NFS mounted)\nif ! defined(File[$shared_dir]) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: danofthewired@puppet-bitbucket-manifests-config.pp\n# Target line: 16\n\n     11:   $tomcat_port  = $bitbucket::tomcat_port,\n     12:   $config_properties = $bitbucket::config_properties,\n     13: ) {\n     14: \n     15:   # Atlassian changed where files are installed from ver 3.2.0\n>>>  16:   # See issue #16 for more detail\n     17:   if versioncmp($version, '3.2.0') > 0 {\n     18:     $moved = 'shared/'\n     19:     $shared_dir = \"${bitbucket::homedir}/${moved}\"\n     20:     # Shared directory may be already defined when installing DataCenter instances (NFS mounted)\n     21:     if ! defined(File[$shared_dir]) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-php-manifests-pecl-module.pp", "content": "#   This can help to debug installation problems (missing packages) during", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-php-manifests-pecl-module.pp\n\n# [*auto_answer*]\n#   The answer(s) to give to pecl prompts for unattended install\n#\n# [*verbose*]\n#   (Optional) - If you want to see verbose pecl output during installation.\n26: #   This can help to debug installation problems (missing packages) during\n#   installation process. Default: false\n#\n# == Examples\n# php::pecl::module { 'intl': }\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-php-manifests-pecl-module.pp\n# Target line: 26\n\n     21: # [*auto_answer*]\n     22: #   The answer(s) to give to pecl prompts for unattended install\n     23: #\n     24: # [*verbose*]\n     25: #   (Optional) - If you want to see verbose pecl output during installation.\n>>>  26: #   This can help to debug installation problems (missing packages) during\n     27: #   installation process. Default: false\n     28: #\n     29: # == Examples\n     30: # php::pecl::module { 'intl': }\n     31: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "lightblue-platform@lightblue-puppet-manifests-service-plugin-graphite.pp", "content": "# $prefix   - (optional) Prefix used for graphite.", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-graphite.pp\n\n#\n# Deploys/Removes lightblue graphite environment variables.\n#\n# === Parameters\n#\n7: # $prefix   - (optional) Prefix used for graphite.\n#             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n# $hostname - Hostname of the graphite server.\n#             If not set, puppet will remove the environment variables.\n# $port     - Port the graphite server is listening on\n#             Defaults to 2003", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-graphite.pp\n# Target line: 7\n\n      2: #\n      3: # Deploys/Removes lightblue graphite environment variables.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # $prefix   - (optional) Prefix used for graphite.\n      8: #             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n      9: # $hostname - Hostname of the graphite server.\n     10: #             If not set, puppet will remove the environment variables.\n     11: # $port     - Port the graphite server is listening on\n     12: #             Defaults to 2003\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp", "content": "# colocated. Later we expand the properties on all nodes where ceph_nfs", "line": 71, "detection_span": [66, 76], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n\nif $step >= 2 {\nif $pacemaker_master {\n# At step2 we only create the node property on master so that\n# both VIP and (later at step5) ceph-nfs service can start on master\n# node only. This way we can guarantee that the VIP and ceph-nfs are\n71:       # colocated. Later we expand the properties on all nodes where ceph_nfs\n# is supposed to run.\npacemaker::property { 'ceph-nfs-role-node-property':\nproperty => 'ceph-nfs-role',\nvalue    => true,\ntries    => $pcs_tries,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-pacemaker-ceph_nfs.pp\n# Target line: 71\n\n     66:   if $step >= 2 {\n     67:     if $pacemaker_master {\n     68:       # At step2 we only create the node property on master so that\n     69:       # both VIP and (later at step5) ceph-nfs service can start on master\n     70:       # node only. This way we can guarantee that the VIP and ceph-nfs are\n>>>  71:       # colocated. Later we expand the properties on all nodes where ceph_nfs\n     72:       # is supposed to run.\n     73:       pacemaker::property { 'ceph-nfs-role-node-property':\n     74:         property => 'ceph-nfs-role',\n     75:         value    => true,\n     76:         tries    => $pcs_tries,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_access.pp", "content": "# TODO(dilyin): but it causes duplicate declaration errors on the controller. Some solution should be found.", "line": 54, "detection_span": [49, 59], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_access.pp\n\nFile[\"${db_host}-mysql-access\"] ->\nFile <| path == $default_file_path |>\n\n# Ensure .my.cnf exists even if mysql on this node is disabled\n# TODO(dilyin): ensuring the default file is present is required for the external db configurations\n54:     # TODO(dilyin): but it causes duplicate declaration errors on the controller. Some solution should be found.\n# TODO(dilyin): https://bugs.launchpad.net/fuel/+bug/1618607\nensure_resource(file, $default_file_path)\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_access.pp\n# Target line: 54\n\n     49:     File[\"${db_host}-mysql-access\"] ->\n     50:     File <| path == $default_file_path |>\n     51: \n     52:     # Ensure .my.cnf exists even if mysql on this node is disabled\n     53:     # TODO(dilyin): ensuring the default file is present is required for the external db configurations\n>>>  54:     # TODO(dilyin): but it causes duplicate declaration errors on the controller. Some solution should be found.\n     55:     # TODO(dilyin): https://bugs.launchpad.net/fuel/+bug/1618607\n     56:     ensure_resource(file, $default_file_path)\n     57:   }\n     58: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "craigwatson@puppet-vmwaretools-manifests-init.pp", "content": "#   we use stdlib's ensure_package resource which should eliminate most issues.", "line": 92, "detection_span": [87, 97], "with_context": "# Puppet file: craigwatson@puppet-vmwaretools-manifests-init.pp\n\n#   Default: true (boolean)\n#\n# [*manage_curl_pkgs*]\n#   Whether to install curl, which is used to download the VMware Tools from an\n#   HTTP location. Useful when other modules are managing the package, although\n92: #   we use stdlib's ensure_package resource which should eliminate most issues.\n#   Default: true (boolean)\n#\n# [*clean_failed_download*]\n#   Whether to remove failed HTTP downloads. This ensures that broken downloads\n#   are automatically retried on the next Puppet run.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: craigwatson@puppet-vmwaretools-manifests-init.pp\n# Target line: 92\n\n     87: #   Default: true (boolean)\n     88: #\n     89: # [*manage_curl_pkgs*]\n     90: #   Whether to install curl, which is used to download the VMware Tools from an\n     91: #   HTTP location. Useful when other modules are managing the package, although\n>>>  92: #   we use stdlib's ensure_package resource which should eliminate most issues.\n     93: #   Default: true (boolean)\n     94: #\n     95: # [*clean_failed_download*]\n     96: #   Whether to remove failed HTTP downloads. This ensures that broken downloads\n     97: #   are automatically retried on the next Puppet run.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp", "content": "# TODO: this should be tested", "line": 60, "detection_span": [55, 65], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n\nkey    => 'AppleEnableMenuBarTransparency',\ntype   => 'bool',\nvalue  => false,\n}\n\n60:   # TODO: this should be tested\npeople::felho::plistbuddy { 'Automatically quit printer app once the print jobs complete':\ndomain   => 'com.apple.print.PrintingPrefs',\nproperty => 'Quit When Finished',\ntype     => 'bool',\nvalue    => true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-miscellaneous.pp\n# Target line: 60\n\n     55:     key    => 'AppleEnableMenuBarTransparency',\n     56:     type   => 'bool',\n     57:     value  => false,\n     58:   }\n     59: \n>>>  60:   # TODO: this should be tested\n     61:   people::felho::plistbuddy { 'Automatically quit printer app once the print jobs complete':\n     62:     domain   => 'com.apple.print.PrintingPrefs',\n     63:     property => 'Quit When Finished',\n     64:     type     => 'bool',\n     65:     value    => true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-ldap.pp", "content": "# == Class: postfix::ldap", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n\n1: # == Class: postfix::ldap\n#\n# Configures postfix for use with LDAP.\n#\n# === Parameters\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-ldap.pp\n# Target line: 1\n\n>>>   1: # == Class: postfix::ldap\n      2: #\n      3: # Configures postfix for use with LDAP.\n      4: #\n      5: # === Parameters\n      6: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_database.pp", "content": "# Debug - Print all variables", "line": 97, "detection_span": [92, 102], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_database.pp\n\ndefault: {\n$contrail_cassandra_dir = \"/etc/cassandra/conf\"\n}\n}\n\n97:     # Debug - Print all variables\nnotify { \"Database - contrail cassandra dir is $contrail_cassandra_dir\":; } ->\nnotify { \"Database - host_control_ip = $host_control_ip\":;} ->\nnotify { \"Database - config_ip = $config_ip\":;} ->\nnotify { \"Database - internal_vip = $internal_vip\":;} ->\nnotify { \"Database - database_ip_list = $database_ip_list\":;} ->", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_database.pp\n# Target line: 97\n\n     92:         default: {\n     93:              $contrail_cassandra_dir = \"/etc/cassandra/conf\"\n     94:         }\n     95:     }\n     96: \n>>>  97:     # Debug - Print all variables\n     98:     notify { \"Database - contrail cassandra dir is $contrail_cassandra_dir\":; } ->\n     99:     notify { \"Database - host_control_ip = $host_control_ip\":;} ->\n    100:     notify { \"Database - config_ip = $config_ip\":;} ->\n    101:     notify { \"Database - internal_vip = $internal_vip\":;} ->\n    102:     notify { \"Database - database_ip_list = $database_ip_list\":;} ->\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-zaqar.pp", "content": "# TODO (bcrochet): At some point, the transports should be split out to", "line": 120, "detection_span": [115, 125], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-zaqar.pp\n\ninclude ::tripleo::profile::base::apache\ninclude ::zaqar::transport::wsgi\ninclude ::zaqar::config\ninclude ::zaqar::logging\n119:\n120:     # TODO (bcrochet): At some point, the transports should be split out to\n# separate services.\nclass { '::zaqar::server':\nservice_name => 'httpd', # TODO cleanup when passed by t-h-t.\n}\nclass { '::zaqar::wsgi::apache':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-zaqar.pp\n# Target line: 120\n\n    115:     include ::tripleo::profile::base::apache\n    116:     include ::zaqar::transport::wsgi\n    117:     include ::zaqar::config\n    118:     include ::zaqar::logging\n    119: \n>>> 120:     # TODO (bcrochet): At some point, the transports should be split out to\n    121:     # separate services.\n    122:     class { '::zaqar::server':\n    123:       service_name => 'httpd', # TODO cleanup when passed by t-h-t.\n    124:     }\n    125:     class { '::zaqar::wsgi::apache':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-server.pp", "content": "recurse => false,\t\t# TODO: eventually...", "line": 89, "detection_span": [84, 94], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n\nensure_resource('class', 'gluster::api', $api_params)\n\n# NOTE: not that we necessarily manage anything in here at the moment...\nfile { '/etc/glusterfs/':\nensure => directory,\t\t# make sure this is a directory\n89: \t\trecurse => false,\t\t# TODO: eventually...\npurge => false,\t\t\t# TODO: eventually...\nforce => false,\t\t\t# TODO: eventually...\nowner => \"${::gluster::params::misc_owner_root}\",\ngroup => \"${::gluster::params::misc_group_root}\",\nmode => 644,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-server.pp\n# Target line: 89\n\n     84: \tensure_resource('class', 'gluster::api', $api_params)\n     85: \n     86: \t# NOTE: not that we necessarily manage anything in here at the moment...\n     87: \tfile { '/etc/glusterfs/':\n     88: \t\tensure => directory,\t\t# make sure this is a directory\n>>>  89: \t\trecurse => false,\t\t# TODO: eventually...\n     90: \t\tpurge => false,\t\t\t# TODO: eventually...\n     91: \t\tforce => false,\t\t\t# TODO: eventually...\n     92: \t\towner => \"${::gluster::params::misc_owner_root}\",\n     93: \t\tgroup => \"${::gluster::params::misc_group_root}\",\n     94: \t\tmode => 644,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alup@puppet-rbenv-manifests-compile.pp", "content": "# This is required for some gems (e.g. debugger)", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n\n$versions    = \"${root_path}/versions\"\n$global_path = \"${root_path}/version\"\n$path        = [ $shims, $bin, '/bin', '/usr/bin' ]\n\n# Keep flag saves source tree after building.\n28:   # This is required for some gems (e.g. debugger)\nif $keep {\n$keep_flag = '--keep '\n}\nelse {\n$keep_flag = ''", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n# Target line: 28\n\n     23:   $versions    = \"${root_path}/versions\"\n     24:   $global_path = \"${root_path}/version\"\n     25:   $path        = [ $shims, $bin, '/bin', '/usr/bin' ]\n     26: \n     27:   # Keep flag saves source tree after building.\n>>>  28:   # This is required for some gems (e.g. debugger)\n     29:   if $keep {\n     30:     $keep_flag = '--keep '\n     31:   }\n     32:   else {\n     33:     $keep_flag = ''\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-large_prefix.pp", "content": "# == Class: mysql::large_prefix", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-large_prefix.pp\n\n1: # == Class: mysql::large_prefix\n#\n# Configures innodb_large_prefix support.\n#\nclass mysql::large_prefix{\ninclude ::mysql", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-large_prefix.pp\n# Target line: 1\n\n>>>   1: # == Class: mysql::large_prefix\n      2: #\n      3: # Configures innodb_large_prefix support.\n      4: #\n      5: class mysql::large_prefix{\n      6:     include ::mysql\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@pltraining-classroom-manifests-virtual.pp", "content": "# fix augeas lens until it's updated in PE", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-virtual.pp\n\n\nif $::osfamily == 'windows' {\ninclude classroom::windows\n}\nelse {\n87:     # fix augeas lens until it's updated in PE\ninclude classroom::agent::augeas\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-virtual.pp\n# Target line: 87\n\n     82: \n     83:   if $::osfamily == 'windows' {\n     84:     include classroom::windows\n     85:   }\n     86:   else {\n>>>  87:     # fix augeas lens until it's updated in PE\n     88:     include classroom::agent::augeas\n     89:   }\n     90: \n     91: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-mongodb-manifests-monitoring.pp", "content": "# git subtree pull --prefix=modules/mongodb/files/nagios-plugin-mongodb \\", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-monitoring.pp\n\n\ninclude mongodb::python\n\n# This plugin is from https://github.com/mzupan/nagios-plugin-mongodb\n# to update to the latest version, run this giant command:\n18:   # git subtree pull --prefix=modules/mongodb/files/nagios-plugin-mongodb \\\n#   https://github.com/mzupan/nagios-plugin-mongodb.git \\\n#   -m 'update to latest nagios-plugin-mongodb from github' master --squash\n@icinga::plugin { 'check_mongodb.py':\nsource  => 'puppet:///modules/mongodb/nagios-plugin-mongodb/check_mongodb.py',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-mongodb-manifests-monitoring.pp\n# Target line: 18\n\n     13: \n     14:   include mongodb::python\n     15: \n     16:   # This plugin is from https://github.com/mzupan/nagios-plugin-mongodb\n     17:   # to update to the latest version, run this giant command:\n>>>  18:   # git subtree pull --prefix=modules/mongodb/files/nagios-plugin-mongodb \\\n     19:   #   https://github.com/mzupan/nagios-plugin-mongodb.git \\\n     20:   #   -m 'update to latest nagios-plugin-mongodb from github' master --squash\n     21:   @icinga::plugin { 'check_mongodb.py':\n     22:     source  => 'puppet:///modules/mongodb/nagios-plugin-mongodb/check_mongodb.py',\n     23:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache.pp", "content": "# LP#1491576 and https://github.com/GrahamDumpleton/mod_wsgi/issues/81", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache.pp\n\nClass['::apache'] ->\nanchor { 'osnailyfacter::apache end' :}\n\n# we need to override the logrotate file provided by apache to work around\n# wsgi issues on the restart caused by logrotate.\n59:   # LP#1491576 and https://github.com/GrahamDumpleton/mod_wsgi/issues/81\nfile { '/etc/logrotate.d/apache2':\nensure  => 'file',\nowner   => 'root',\ngroup   => 'root',\nmode    => '0644',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-apache.pp\n# Target line: 59\n\n     54:   Class['::apache'] ->\n     55:   anchor { 'osnailyfacter::apache end' :}\n     56: \n     57:   # we need to override the logrotate file provided by apache to work around\n     58:   # wsgi issues on the restart caused by logrotate.\n>>>  59:   # LP#1491576 and https://github.com/GrahamDumpleton/mod_wsgi/issues/81\n     60:   file { '/etc/logrotate.d/apache2':\n     61:     ensure  => 'file',\n     62:     owner   => 'root',\n     63:     group   => 'root',\n     64:     mode    => '0644',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "soylent@konstantin-fluentd-manifests-params.pp", "content": "# https://tickets.puppetlabs.com/browse/PUP-5296", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: soylent@konstantin-fluentd-manifests-params.pp\n\n$service_ensure = running\n$service_enable = true\n$service_manage = true\n\n# NOTE: Workaround for the following issue:\n36:   # https://tickets.puppetlabs.com/browse/PUP-5296\nif $facts['osfamily'] == 'redhat' {\n$service_provider = 'redhat'\n} else {\n$service_provider = undef\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: soylent@konstantin-fluentd-manifests-params.pp\n# Target line: 36\n\n     31:   $service_ensure = running\n     32:   $service_enable = true\n     33:   $service_manage = true\n     34: \n     35:   # NOTE: Workaround for the following issue:\n>>>  36:   # https://tickets.puppetlabs.com/browse/PUP-5296\n     37:   if $facts['osfamily'] == 'redhat' {\n     38:     $service_provider = 'redhat'\n     39:   } else {\n     40:     $service_provider = undef\n     41:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-pacemaker-manifests-new-setup-config.pp", "content": "#   * rrp_problem_count_threshold", "line": 56, "detection_span": [51, 61], "with_context": "# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n\n#   * max_network_delay\n#   * window_size\n#   * max_messages\n#   * miss_count_const\n#   * rrp_problem_count_timeout\n56: #   * rrp_problem_count_threshold\n#   * rrp_problem_count_mcast_threshold\n#   * rrp_token_expired_timeout\n#   * rrp_autorecovery_check_timeout\n#   Logging section:\n#   * timestamp", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-pacemaker-manifests-new-setup-config.pp\n# Target line: 56\n\n     51: #   * max_network_delay\n     52: #   * window_size\n     53: #   * max_messages\n     54: #   * miss_count_const\n     55: #   * rrp_problem_count_timeout\n>>>  56: #   * rrp_problem_count_threshold\n     57: #   * rrp_problem_count_mcast_threshold\n     58: #   * rrp_token_expired_timeout\n     59: #   * rrp_autorecovery_check_timeout\n     60: #   Logging section:\n     61: #   * timestamp\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-zabbix-manifests-agent.pp", "content": "#   [*debug_level*] - set debug level of Zabbix Agent", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-zabbix-manifests-agent.pp\n\n# This class configures Zabbix Agent instance.\n#\n# Parameters:\n#   [*allow_root*] - allow the agent to run as 'root' user\n#   [*apply_firewall_rules*] - apply embedded firewall rules\n8: #   [*debug_level*] - set debug level of Zabbix Agent\n#   [*enable_remote_commands*] - allow to run remote commands on host with Agent\n#   [*firewall_allow_sources*] - sources allowed to connect to the service\n#   [*hostname*] - unique, case sensitive hostname\n#   [*hostname_item*] - Zabbix agent item used for getting host name\n#   [*include*] - individual files or all files in a directory in the", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-zabbix-manifests-agent.pp\n# Target line: 8\n\n      3: # This class configures Zabbix Agent instance.\n      4: #\n      5: # Parameters:\n      6: #   [*allow_root*] - allow the agent to run as 'root' user\n      7: #   [*apply_firewall_rules*] - apply embedded firewall rules\n>>>   8: #   [*debug_level*] - set debug level of Zabbix Agent\n      9: #   [*enable_remote_commands*] - allow to run remote commands on host with Agent\n     10: #   [*firewall_allow_sources*] - sources allowed to connect to the service\n     11: #   [*hostname*] - unique, case sensitive hostname\n     12: #   [*hostname_item*] - Zabbix agent item used for getting host name\n     13: #   [*include*] - individual files or all files in a directory in the\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "lightblue-platform@lightblue-puppet-manifests-eap-truststore.pp", "content": "# TODO change this to use new Puppet iteration Syntax", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-eap-truststore.pp\n\ngroup  => 'jboss',\nmode   => '0600',\nnotify => Service['jbossas']\n}\n\n40:     # TODO change this to use new Puppet iteration Syntax\n# when we upgrade to Puppet 4 i.e. $certificates.each\n\n# For each certificate in $certificates:\n# Add it to the keystore used for truststore\ncreate_resources(lightblue::eap::truststore_file, $certificates)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-eap-truststore.pp\n# Target line: 40\n\n     35:         group  => 'jboss',\n     36:         mode   => '0600',\n     37:         notify => Service['jbossas']\n     38:     }\n     39: \n>>>  40:     # TODO change this to use new Puppet iteration Syntax\n     41:     # when we upgrade to Puppet 4 i.e. $certificates.each\n     42: \n     43:     # For each certificate in $certificates:\n     44:     # Add it to the keystore used for truststore\n     45:     create_resources(lightblue::eap::truststore_file, $certificates)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-zabbix-server.pp", "content": "#   [*slack_emoji_problem*] - Slack Emoji PROBLEM icon code", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-zabbix-server.pp\n\n#   [*maintenance_cron*] - maintanance script run Cron entries\n#   [*maintenance_script*] - maintanance script path\n#   [*maintenance_script_config*] - maintanance script MySQL config\n#   [*server_role*] - server mode\n#   [*slack_emoji_ok*] - Slack Emoji OK icon code\n14: #   [*slack_emoji_problem*] - Slack Emoji PROBLEM icon code\n#   [*slack_emoji_unknown*] - Slack Emoji UNKNOWN icon code\n#   [*slack_post_username*] - Slack user name for posting\n#   [*slack_web_hook_url*] - Slack web hook URL\n#\nclass fuel_project::roles::zabbix::server (", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-roles-zabbix-server.pp\n# Target line: 14\n\n      9: #   [*maintenance_cron*] - maintanance script run Cron entries\n     10: #   [*maintenance_script*] - maintanance script path\n     11: #   [*maintenance_script_config*] - maintanance script MySQL config\n     12: #   [*server_role*] - server mode\n     13: #   [*slack_emoji_ok*] - Slack Emoji OK icon code\n>>>  14: #   [*slack_emoji_problem*] - Slack Emoji PROBLEM icon code\n     15: #   [*slack_emoji_unknown*] - Slack Emoji UNKNOWN icon code\n     16: #   [*slack_post_username*] - Slack user name for posting\n     17: #   [*slack_web_hook_url*] - Slack web hook URL\n     18: #\n     19: class fuel_project::roles::zabbix::server (\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@pltraining-bootstrap-manifests-profile-network.pp", "content": "# Remove the udev ethernet naming rules, causes problems when", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-network.pp\n\npath    => '/sbin',\nrequire => Exec['iptables -F'],\n}\n}\n\n23:   # Remove the udev ethernet naming rules, causes problems when\n# moving VMs around. This works for rhel/centos\nfile {'/etc/udev/rules.d/70-persistent-net.rules':\nensure   => absent,\nforce    => true,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-network.pp\n# Target line: 23\n\n     18:       path    => '/sbin',\n     19:       require => Exec['iptables -F'],\n     20:     }\n     21:   }\n     22: \n>>>  23:   # Remove the udev ethernet naming rules, causes problems when\n     24:   # moving VMs around. This works for rhel/centos\n     25:   file {'/etc/udev/rules.d/70-persistent-net.rules':\n     26:     ensure   => absent,\n     27:     force    => true,\n     28:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-tomcat-manifests-instance-install.pp", "content": "# TODO: managed mode with more options ?", "line": 164, "detection_span": [159, 169], "with_context": "# Puppet file: camptocamp@puppet-tomcat-manifests-instance-install.pp\n\n'absent'    => 'absent',\n160:   }\n161:\n162:   # Default rotation of catalina.out\n163:   # Not managed by default\n164:   # TODO: managed mode with more options ?\n165:   if $catalina_logrotate {\nfile{ \"/etc/logrotate.d/catalina-${name}\":\nensure  => $present,\nowner   => 'root',\ngroup   => 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-tomcat-manifests-instance-install.pp\n# Target line: 164\n\n    159:     'absent'    => 'absent',\n    160:   }\n    161: \n    162:   # Default rotation of catalina.out\n    163:   # Not managed by default\n>>> 164:   # TODO: managed mode with more options ?\n    165:   if $catalina_logrotate {\n    166:     file{ \"/etc/logrotate.d/catalina-${name}\":\n    167:       ensure  => $present,\n    168:       owner   => 'root',\n    169:       group   => 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "lightblue-platform@lightblue-puppet-manifests-service-plugin-statsd.pp", "content": "# $prefix   - (optional) Prefix used for statsd.", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-statsd.pp\n\n#\n# Deploys/Removes lightblue graphite environment variables.\n#\n# === Parameters\n#\n7: # $prefix   - (optional) Prefix used for statsd.\n#             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n# $hostname - Hostname of the statsd server.\n#             If not set, puppet will remove the environment variables.\n# $port     - Port the statsd server is listening on\n#             Defaults to 8125", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-service-plugin-statsd.pp\n# Target line: 7\n\n      2: #\n      3: # Deploys/Removes lightblue graphite environment variables.\n      4: #\n      5: # === Parameters\n      6: #\n>>>   7: # $prefix   - (optional) Prefix used for statsd.\n      8: #             Note: If not specified, then lightblue will use other strategies to determine the prefix.\n      9: # $hostname - Hostname of the statsd server.\n     10: #             If not set, puppet will remove the environment variables.\n     11: # $port     - Port the statsd server is listening on\n     12: #             Defaults to 8125\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fraenki@puppet-galera-manifests-repo.pp", "content": "# FIXME: replace hardcoded values, specify includepkgs parameter", "line": 98, "detection_span": [93, 103], "with_context": "# Puppet file: fraenki@puppet-galera-manifests-repo.pp\n\n}\n\nif $epel_needed {\n# Needed for socat package\nyumrepo { \"${module_name}_epel\":\n98:           # FIXME: replace hardcoded values, specify includepkgs parameter\nmirrorlist     => \"https://mirrors.fedoraproject.org/metalink?repo=epel-${facts['os']['release']['major']}&arch=${facts['os']['architecture']}\",\nbaseurl        => 'absent',\nfailovermethod => 'priority',\nenabled        => '1',\ngpgcheck       => '1',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-manifests-repo.pp\n# Target line: 98\n\n     93:       }\n     94: \n     95:       if $epel_needed {\n     96:         # Needed for socat package\n     97:         yumrepo { \"${module_name}_epel\":\n>>>  98:           # FIXME: replace hardcoded values, specify includepkgs parameter\n     99:           mirrorlist     => \"https://mirrors.fedoraproject.org/metalink?repo=epel-${facts['os']['release']['major']}&arch=${facts['os']['architecture']}\",\n    100:           baseurl        => 'absent',\n    101:           failovermethod => 'priority',\n    102:           enabled        => '1',\n    103:           gpgcheck       => '1',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-provision-build_image.pp", "content": "# TODO(vsaienko): Use the same system packages for fuel image and ironic bootstrap, but exclude", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-provision-build_image.pp\n\n$data = loadyaml($data_file)\n}\n$cluster_id = $data['cluster']['id']\n\nif $data['ironic']['enabled'] == true {\n13:     # TODO(vsaienko): Use the same system packages for fuel image and ironic bootstrap, but exclude\n# not needed for ironic like nailgun-agent, etc...\n$ironic_packages = [\n'openssh-server',\n'ntp',\n'fuel-agent',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-provision-build_image.pp\n# Target line: 13\n\n      8:     $data = loadyaml($data_file)\n      9:   }\n     10:   $cluster_id = $data['cluster']['id']\n     11: \n     12:   if $data['ironic']['enabled'] == true {\n>>>  13:     # TODO(vsaienko): Use the same system packages for fuel image and ironic bootstrap, but exclude\n     14:     # not needed for ironic like nailgun-agent, etc...\n     15:     $ironic_packages = [\n     16:       'openssh-server',\n     17:       'ntp',\n     18:       'fuel-agent',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "garethr@garethr-diamond-manifests-init.pp", "content": "#   Define optional path_prefix for storing metrics", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: garethr@garethr-diamond-manifests-init.pp\n\n#\n# [*riemann_host*]\n#   Where to find the riemann server\n#\n# [*path_prefix*]\n46: #   Define optional path_prefix for storing metrics\n#\n# [*path_suffix*]\n#   Define optional path_suffix for storing metrics\n#\n# [*instance_prefix*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: garethr@garethr-diamond-manifests-init.pp\n# Target line: 46\n\n     41: #\n     42: # [*riemann_host*]\n     43: #   Where to find the riemann server\n     44: #\n     45: # [*path_prefix*]\n>>>  46: #   Define optional path_prefix for storing metrics\n     47: #\n     48: # [*path_suffix*]\n     49: #   Define optional path_suffix for storing metrics\n     50: #\n     51: # [*instance_prefix*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "CiscoSystems@puppet-openstack-manifests-compute.pp", "content": "# [fixed_range] Range of ipv4 network for vms.", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n\n#\n# [private_interface] Interface used for vm networking connectivity. Required.\n# [internal_address] Internal address used for management. Required.\n# [public_interface] Public interface used to route public traffic. Optional.\n#   Defaults to false.\n17: # [fixed_range] Range of ipv4 network for vms.\n# [network_manager] Nova network manager to use.\n# [multi_host] Rather node should support multi-host networking mode for HA.\n#   Optional. Defaults to false.\n# [network_config] Hash that can be used to pass implementation specifc\n#   network settings. Optioal. Defaults to {}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n# Target line: 17\n\n     12: #\n     13: # [private_interface] Interface used for vm networking connectivity. Required.\n     14: # [internal_address] Internal address used for management. Required.\n     15: # [public_interface] Public interface used to route public traffic. Optional.\n     16: #   Defaults to false.\n>>>  17: # [fixed_range] Range of ipv4 network for vms.\n     18: # [network_manager] Nova network manager to use.\n     19: # [multi_host] Rather node should support multi-host networking mode for HA.\n     20: #   Optional. Defaults to false.\n     21: # [network_config] Hash that can be used to pass implementation specifc\n     22: #   network settings. Optioal. Defaults to {}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mpm.pp", "content": "# workaround https://bugs.launchpad.net/ubuntu/+source/mpm-itk/+bug/1286882", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mpm.pp\n\n}\n}\n}\n\nif $mpm == 'itk' and $::operatingsystem == 'Ubuntu' and $::operatingsystemrelease == '14.04' {\n77:         # workaround https://bugs.launchpad.net/ubuntu/+source/mpm-itk/+bug/1286882\nexec {\n'/usr/sbin/a2dismod mpm_event':\nonlyif  => '/usr/bin/test -e /etc/apache2/mods-enabled/mpm_event.load',\nrequire => Package['httpd'],\nbefore  => Package['apache2-mpm-itk'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mpm.pp\n# Target line: 77\n\n     72:           }\n     73:         }\n     74:       }\n     75: \n     76:       if $mpm == 'itk' and $::operatingsystem == 'Ubuntu' and $::operatingsystemrelease == '14.04' {\n>>>  77:         # workaround https://bugs.launchpad.net/ubuntu/+source/mpm-itk/+bug/1286882\n     78:         exec {\n     79:           '/usr/sbin/a2dismod mpm_event':\n     80:             onlyif  => '/usr/bin/test -e /etc/apache2/mods-enabled/mpm_event.load',\n     81:             require => Package['httpd'],\n     82:             before  => Package['apache2-mpm-itk'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-conffile.pp", "content": "# Adds a postfix configuration file.", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n\n# = Define: postfix::conffile\n#\n3: # Adds a postfix configuration file.\n# It is mainly a file resource that also restarts postfix\n#\n# == Parameters\n#\n# [*ensure*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-conffile.pp\n# Target line: 3\n\n      1: # = Define: postfix::conffile\n      2: #\n>>>   3: # Adds a postfix configuration file.\n      4: # It is mainly a file resource that also restarts postfix\n      5: #\n      6: # == Parameters\n      7: #\n      8: # [*ensure*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-logstash-manifests-conf.pp", "content": "#   logstash::conf { 'debug':", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-logstash-manifests-conf.pp\n\n# - $priority: Configuration loading priority. Default 10.\n# - $ensure: Whether the config should exist.\n#\n# == Sample usage:\n#\n19: #   logstash::conf { 'debug':\n#     content => 'output { stdout { codec => rubydebug } }'\n#   }\n#\ndefine logstash::conf(\n$ensure   = present,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-logstash-manifests-conf.pp\n# Target line: 19\n\n     14: # - $priority: Configuration loading priority. Default 10.\n     15: # - $ensure: Whether the config should exist.\n     16: #\n     17: # == Sample usage:\n     18: #\n>>>  19: #   logstash::conf { 'debug':\n     20: #     content => 'output { stdout { codec => rubydebug } }'\n     21: #   }\n     22: #\n     23: define logstash::conf(\n     24:     $ensure   = present,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp", "content": "# If we have a prefix, then add the dash to it", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n\n$ensure  = undef,\n) {\n\ninclude sysctl::base\n\n26:   # If we have a prefix, then add the dash to it\nif $prefix {\n$sysctl_d_file = \"${prefix}-${title}.conf\"\n} else {\n$sysctl_d_file = \"${title}.conf\"\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-sysctl-manifests-init.pp\n# Target line: 26\n\n     21:   $ensure  = undef,\n     22: ) {\n     23: \n     24:   include sysctl::base\n     25: \n>>>  26:   # If we have a prefix, then add the dash to it\n     27:   if $prefix {\n     28:     $sysctl_d_file = \"${prefix}-${title}.conf\"\n     29:   } else {\n     30:     $sysctl_d_file = \"${title}.conf\"\n     31:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-canonical.pp", "content": "#- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n\n#- *ensure*: present/absent, defaults to present.\n#\n#Requires:\n#- Class[\"postfix\"]\n#- Postfix::Hash[\"/etc/postfix/canonical\"]\n13: #- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n#- augeas\n#\n#Example usage:\n#\n#  node \"toto.example.com\" {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-canonical.pp\n# Target line: 13\n\n      8: #- *ensure*: present/absent, defaults to present.\n      9: #\n     10: #Requires:\n     11: #- Class[\"postfix\"]\n     12: #- Postfix::Hash[\"/etc/postfix/canonical\"]\n>>>  13: #- Postfix::Config[\"canonical_maps\"] or Postfix::Config[\"sender_canonical_maps\"] or Postfix::Config[\"recipient_canonical_maps\"]\n     14: #- augeas\n     15: #\n     16: #Example usage:\n     17: #\n     18: #  node \"toto.example.com\" {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_control.pp", "content": "#TODO, Is this really needed?", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_control.pp\n\nfile { ['/etc/init/supervisor-control.override',\n'/etc/init/supervisor-dns.override'] :\nensure  => absent,\n} ->\nClass['contrail::delete_vnc_control']\n53:             #TODO, Is this really needed?\n# Below is temporary to work-around in Ubuntu as Service resource fails\n# as upstart is not correctly linked to /etc/init.d/service-name\n}\ndefault: {\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-uninstall_control.pp\n# Target line: 53\n\n     48:                 file { ['/etc/init/supervisor-control.override',\n     49:                         '/etc/init/supervisor-dns.override'] :\n     50:                     ensure  => absent,\n     51:                 } ->\n     52:                 Class['contrail::delete_vnc_control']\n>>>  53:             #TODO, Is this really needed?\n     54:                 # Below is temporary to work-around in Ubuntu as Service resource fails\n     55:                 # as upstart is not correctly linked to /etc/init.d/service-name\n     56:         }\n     57:         default: {\n     58:         }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-openstack-manifests-profile-ceilometer-api.pp", "content": "# https://bugs.launchpad.net/cloud-archive/+bug/1281722", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-ceilometer-api.pp\n\ntime_to_live => '2592000'\n}\n\n# For the time being no upstart script are provided\n# in Ubuntu 12.04 Cloud Archive. Bug report filed\n50:   # https://bugs.launchpad.net/cloud-archive/+bug/1281722\n# https://bugs.launchpad.net/ubuntu/+source/ceilometer/+bug/1250002/comments/5\nif $::osfamily != 'Debian' {\nclass { '::ceilometer::alarm::notifier':\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-ceilometer-api.pp\n# Target line: 50\n\n     45:     time_to_live => '2592000'\n     46:   }\n     47: \n     48:   # For the time being no upstart script are provided\n     49:   # in Ubuntu 12.04 Cloud Archive. Bug report filed\n>>>  50:   # https://bugs.launchpad.net/cloud-archive/+bug/1281722\n     51:   # https://bugs.launchpad.net/ubuntu/+source/ceilometer/+bug/1250002/comments/5\n     52:   if $::osfamily != 'Debian' {\n     53:     class { '::ceilometer::alarm::notifier':\n     54:     }\n     55: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "duritong@puppet-shorewall-manifests-rules-out-razor.pp", "content": "# https://wiki.apache.org/spamassassin/NetTestFirewallIssues", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: duritong@puppet-shorewall-manifests-rules-out-razor.pp\n\n# razor calls out on 2703\n2: # https://wiki.apache.org/spamassassin/NetTestFirewallIssues\nclass shorewall::rules::out::razor {\nshorewall::rule { 'me-net-tcp_razor':\nsource          => '$FW',\ndestination     => 'net',\nproto           => 'tcp',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-shorewall-manifests-rules-out-razor.pp\n# Target line: 2\n\n      1: # razor calls out on 2703\n>>>   2: # https://wiki.apache.org/spamassassin/NetTestFirewallIssues\n      3: class shorewall::rules::out::razor {\n      4:   shorewall::rule { 'me-net-tcp_razor':\n      5:     source          => '$FW',\n      6:     destination     => 'net',\n      7:     proto           => 'tcp',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-mailman.pp", "content": "#   class { 'postfix':", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-mailman.pp\n\n# === Examples\n#\n# /!\\ Do not include this class directly,\n# use mailman => true in the postfix top class!\n#\n11: #   class { 'postfix':\n#     mailman => true,\n#   }\nclass postfix::mailman {\n\npostfix::config {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-mailman.pp\n# Target line: 11\n\n      6: # === Examples\n      7: #\n      8: # /!\\ Do not include this class directly,\n      9: # use mailman => true in the postfix top class!\n     10: #\n>>>  11: #   class { 'postfix':\n     12: #     mailman => true,\n     13: #   }\n     14: class postfix::mailman {\n     15: \n     16:   postfix::config {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "craigwatson@puppet-vmwaretools-manifests-params.pp", "content": "# https://projects.puppetlabs.com/issues/2833", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: craigwatson@puppet-vmwaretools-manifests-params.pp\n\n} else {\n$install_command = \"${vmwaretools::working_dir}/vmware-tools-distrib/vmware-install.pl -d\"\n}\n\n# Workaround for 'purge' bug on RH-based systems\n67:   # https://projects.puppetlabs.com/issues/2833\n# https://projects.puppetlabs.com/issues/11450\n# https://tickets.puppetlabs.com/browse/PUP-1198\n$purge_package_ensure = $facts['os']['family'] ? {\n'RedHat' => absent,\n'Suse'   => absent,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: craigwatson@puppet-vmwaretools-manifests-params.pp\n# Target line: 67\n\n     62:   } else {\n     63:     $install_command = \"${vmwaretools::working_dir}/vmware-tools-distrib/vmware-install.pl -d\"\n     64:   }\n     65: \n     66:   # Workaround for 'purge' bug on RH-based systems\n>>>  67:   # https://projects.puppetlabs.com/issues/2833\n     68:   # https://projects.puppetlabs.com/issues/11450\n     69:   # https://tickets.puppetlabs.com/browse/PUP-1198\n     70:   $purge_package_ensure = $facts['os']['family'] ? {\n     71:     'RedHat' => absent,\n     72:     'Suse'   => absent,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "purpleidea@puppet-gluster-manifests-init.pp", "content": "# FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n\n# XXX: does parted align disks properly ?\n# XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n# XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n\n# FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n57: # FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n# FIXME: can we setup gluster by using templated volume files instead ?\n\n# TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n# TODO: find out when ports are actually necessary for version 3.3\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-init.pp\n# Target line: 57\n\n     52: # XXX: does parted align disks properly ?\n     53: # XXX: mkfs.xfs -ssize=4k /dev/sdc1 ?\t# should \"-s sector_size\" be used ?\thttp://kb.lsi.com/KnowledgebaseArticle16187.aspx ?\n     54: # XXX: setup auth somehow... ip address based for now # XXX: use volume::property...\n     55: \n     56: # FIXME: test this: https://bugzilla.redhat.com/show_bug.cgi?id=GLUSTER-3769\n>>>  57: # FIXME: peering: maybe we can just specify a guid somewhere so that everyone peers together ?\n     58: # FIXME: can we setup gluster by using templated volume files instead ?\n     59: \n     60: # TODO: package { 'xfsdump': ensure => present } is this useful for something ?\n     61: # TODO: find out when ports are actually necessary for version 3.3\n     62: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-virtualenv-manifests-environment.pp", "content": "# This is a nasty hack which does not use package providers", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-virtualenv-manifests-environment.pp\n\n# == Class virtualenv\n# Helper class to install python packages via virtualenv.\n# Will create a virtualenv directory with the given packages.\n#\n5: # This is a nasty hack which does not use package providers\n# as puppet does not suppose using those with virtualenv:\n# https://tickets.puppetlabs.com/browse/PUP-1062\n#\n# === Parameters\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-virtualenv-manifests-environment.pp\n# Target line: 5\n\n      1: # == Class virtualenv\n      2: # Helper class to install python packages via virtualenv.\n      3: # Will create a virtualenv directory with the given packages.\n      4: #\n>>>   5: # This is a nasty hack which does not use package providers\n      6: # as puppet does not suppose using those with virtualenv:\n      7: # https://tickets.puppetlabs.com/browse/PUP-1062\n      8: #\n      9: # === Parameters\n     10: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-nginx-manifests-config-vhost-redirect.pp", "content": "#   Location to redirect to. A 301 permanent redirect will be issued and the", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config-vhost-redirect.pp\n\n# another location.\n#\n# === Parameters\n#\n# [*to*]\n9: #   Location to redirect to. A 301 permanent redirect will be issued and the\n#   query path of the original request will be appended. You probably want\n#   this to be an absolute URL starting with `http://` or `https://`\n#   otherwise you'll generate an infinite loop.\n#\n# [*certtype*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config-vhost-redirect.pp\n# Target line: 9\n\n      4: # another location.\n      5: #\n      6: # === Parameters\n      7: #\n      8: # [*to*]\n>>>   9: #   Location to redirect to. A 301 permanent redirect will be issued and the\n     10: #   query path of the original request will be appended. You probably want\n     11: #   this to be an absolute URL starting with `http://` or `https://`\n     12: #   otherwise you'll generate an infinite loop.\n     13: #\n     14: # [*certtype*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-post_openstack.pp", "content": "## TODO: document function", "line": 1, "detection_span": [1, 6], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-post_openstack.pp\n\n1: ## TODO: document function\ndefine contrail::lib::post_openstack(\n$host_control_ip,\n$openstack_ip_list,\n$internal_vip,\n$password  = $::contrail::params::os_mysql_service_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-lib-post_openstack.pp\n# Target line: 1\n\n>>>   1: ## TODO: document function\n      2: define contrail::lib::post_openstack(\n      3:     $host_control_ip,\n      4:     $openstack_ip_list,\n      5:     $internal_vip,\n      6:     $password  = $::contrail::params::os_mysql_service_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp", "content": "# See <https://github.com/hashicorp/vagrant/issues/351>.", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n\nrefreshonly => true,\nnotify      => Service['apache2'],\n}\n\n# Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n39:     # See <https://github.com/hashicorp/vagrant/issues/351>.\napache::conf { 'disable sendfile':\ncontent => 'EnableSendfile Off',\n}\n\napache::conf { 'errors to syslog':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n# Target line: 39\n\n     34:         refreshonly => true,\n     35:         notify      => Service['apache2'],\n     36:     }\n     37: \n     38:     # Set EnableSendfile to 'Off' to work around a bug with Vagrant.\n>>>  39:     # See <https://github.com/hashicorp/vagrant/issues/351>.\n     40:     apache::conf { 'disable sendfile':\n     41:         content => 'EnableSendfile Off',\n     42:     }\n     43: \n     44:     apache::conf { 'errors to syslog':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "norcams@himlar-profile-manifests-firewall-rule.pp", "content": "if $port { # port is depricated. Use dport. FIXME report $port", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: norcams@himlar-profile-manifests-firewall-rule.pp\n\n$chain       = 'INPUT',\n$provider    = 'iptables',\n$extras      = {},\n) {\n\n30:   if $port { # port is depricated. Use dport. FIXME report $port\nwarning('NORCAMS: Use of $port in firewall rules are depricated! Use $dport.')\n$basic = {\n'dport'       => $port,\n'proto'       => $proto,\n'action'      => $action,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-firewall-rule.pp\n# Target line: 30\n\n     25:   $chain       = 'INPUT',\n     26:   $provider    = 'iptables',\n     27:   $extras      = {},\n     28: ) {\n     29: \n>>>  30:   if $port { # port is depricated. Use dport. FIXME report $port\n     31:     warning('NORCAMS: Use of $port in firewall rules are depricated! Use $dport.')\n     32:     $basic = {\n     33:       'dport'       => $port,\n     34:       'proto'       => $proto,\n     35:       'action'      => $action,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "camptocamp@puppet-postfix-manifests-init.pp", "content": "# [*postfix_ensure*]      - (string) The ensure value of the postfix package", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n\n# [*use_schleuder*]       - (2/boolean) Whether to setup for Schleuder\n#                           (2 -> Schleuder 2, 3 or true -> Schleuder 3)\n#\n# [*use_sympa*]           - (boolean) Whether to setup for Sympa\n#\n77: # [*postfix_ensure*]      - (string) The ensure value of the postfix package\n#\n# [*mailx_ensure*]        - (string) The ensure value of the mailx package\n#\n# === Examples\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-postfix-manifests-init.pp\n# Target line: 77\n\n     72: # [*use_schleuder*]       - (2/boolean) Whether to setup for Schleuder\n     73: #                           (2 -> Schleuder 2, 3 or true -> Schleuder 3)\n     74: #\n     75: # [*use_sympa*]           - (boolean) Whether to setup for Sympa\n     76: #\n>>>  77: # [*postfix_ensure*]      - (string) The ensure value of the postfix package\n     78: #\n     79: # [*mailx_ensure*]        - (string) The ensure value of the mailx package\n     80: #\n     81: # === Examples\n     82: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-puppet-manifests-puppetserver-config.pp", "content": "# https://tickets.puppetlabs.com/browse/PUP-1033", "line": 51, "detection_span": [46, 56], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-puppetserver-config.pp\n\ngroup  => undef,\nmode   => undef,\naudit  => 'content',\n}\n\n51:   # https://tickets.puppetlabs.com/browse/PUP-1033\nfile { [\n'/var/lib/puppet/lib/puppet/type',\n'/var/lib/puppet/lib/puppet/parser',\n]:\nensure  => undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-puppet-manifests-puppetserver-config.pp\n# Target line: 51\n\n     46:     group  => undef,\n     47:     mode   => undef,\n     48:     audit  => 'content',\n     49:   }\n     50: \n>>>  51:   # https://tickets.puppetlabs.com/browse/PUP-1033\n     52:   file { [\n     53:     '/var/lib/puppet/lib/puppet/type',\n     54:     '/var/lib/puppet/lib/puppet/parser',\n     55:     ]:\n     56:     ensure  => undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-haproxy-horizon_endpoint.pp", "content": "# isolation is not enabled. This is not a problem as both options are", "line": 103, "detection_span": [98, 108], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-haproxy-horizon_endpoint.pp\n\n# subjectaltnames set.\n$internal_bind_opts = union($haproxy_listen_bind_param, ['ssl', 'crt', $public_certificate])\n}\n# NOTE(jaosorior): If the internal_ip and the public_virtual_ip are the\n# same, the first option takes precedence. Which is the case when network\n103:     # isolation is not enabled. This is not a problem as both options are\n# identical. If network isolation is enabled, this works correctly and\n# will add a TLS binding to both the internal_ip and the\n# public_virtual_ip.\n# Even though for the public_virtual_ip the port 80 is listening, we\n# redirect to https in the horizon_options below.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-haproxy-horizon_endpoint.pp\n# Target line: 103\n\n     98:       # subjectaltnames set.\n     99:       $internal_bind_opts = union($haproxy_listen_bind_param, ['ssl', 'crt', $public_certificate])\n    100:     }\n    101:     # NOTE(jaosorior): If the internal_ip and the public_virtual_ip are the\n    102:     # same, the first option takes precedence. Which is the case when network\n>>> 103:     # isolation is not enabled. This is not a problem as both options are\n    104:     # identical. If network isolation is enabled, this works correctly and\n    105:     # will add a TLS binding to both the internal_ip and the\n    106:     # public_virtual_ip.\n    107:     # Even though for the public_virtual_ip the port 80 is listening, we\n    108:     # redirect to https in the horizon_options below.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-neutron-dhcp_agent_wrappers.pp", "content": "#   (Optional) Debug messages for the wrapper scripts.", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-dhcp_agent_wrappers.pp\n\n#   (Deprecated) Domain sockets that the wrappers should use for accessing\n#   the docker daemon.\n#   Defaults to hiera('docker_additional_sockets', ['/var/lib/openstack/docker.sock'])\n#\n# [*debug*]\n55: #   (Optional) Debug messages for the wrapper scripts.\n#   Defaults to False.\n#\nclass tripleo::profile::base::neutron::dhcp_agent_wrappers (\n$enable_dnsmasq_wrapper  = false,\n$dnsmasq_process_wrapper = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-neutron-dhcp_agent_wrappers.pp\n# Target line: 55\n\n     50: #   (Deprecated) Domain sockets that the wrappers should use for accessing\n     51: #   the docker daemon.\n     52: #   Defaults to hiera('docker_additional_sockets', ['/var/lib/openstack/docker.sock'])\n     53: #\n     54: # [*debug*]\n>>>  55: #   (Optional) Debug messages for the wrapper scripts.\n     56: #   Defaults to False.\n     57: #\n     58: class tripleo::profile::base::neutron::dhcp_agent_wrappers (\n     59:   $enable_dnsmasq_wrapper  = false,\n     60:   $dnsmasq_process_wrapper = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@puppet-openstack-integration-manifests-ceph.pp", "content": "admin_url    => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",", "line": 139, "detection_span": [134, 144], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n\npassword     => $password,\nuser         => $auth_name,\ntenant       => $project,\nroles        => ['admin', 'member'],\npublic_url   => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n139:         admin_url    => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\ninternal_url => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n}\n# FIXME(Xarses) remove when supported in puppet-ceph\nService<| tag == 'ceph-radosgw' |> -> Service <| tag == 'glance-service' |>\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-ceph.pp\n# Target line: 139\n\n    134:         password     => $password,\n    135:         user         => $auth_name,\n    136:         tenant       => $project,\n    137:         roles        => ['admin', 'member'],\n    138:         public_url   => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n>>> 139:         admin_url    => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n    140:         internal_url => \"http://${::openstack_integration::config::ip_for_url}:8080/swift/v1\",\n    141:       }\n    142:       # FIXME(Xarses) remove when supported in puppet-ceph\n    143:       Service<| tag == 'ceph-radosgw' |> -> Service <| tag == 'glance-service' |>\n    144:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danofthewired@puppet-bitbucket-examples-bitbucket_postgres_java_install.pp", "content": "url             => 'http://download.oracle.com/otn-pub/java/jdk/7u71-b14/',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: danofthewired@puppet-bitbucket-examples-bitbucket_postgres_java_install.pp\n\n}->\nclass { '::postgresql::server': } ->\ndeploy::file { 'jdk-8u161-linux-x64.tar.gz':\ntarget          => '/opt/java',\nfetch_options   => '-q -c --header \"Cookie: oraclelicense=accept-securebackup-cookie\"',\n13:     url             => 'http://download.oracle.com/otn-pub/java/jdk/7u71-b14/',\ndownload_timout => 1800,\nstrip           => true,\n} ->\nclass { '::bitbucket':\nversion  => '5.10.0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: danofthewired@puppet-bitbucket-examples-bitbucket_postgres_java_install.pp\n# Target line: 13\n\n      8:   }->\n      9:   class { '::postgresql::server': } ->\n     10:   deploy::file { 'jdk-8u161-linux-x64.tar.gz':\n     11:     target          => '/opt/java',\n     12:     fetch_options   => '-q -c --header \"Cookie: oraclelicense=accept-securebackup-cookie\"',\n>>>  13:     url             => 'http://download.oracle.com/otn-pub/java/jdk/7u71-b14/',\n     14:     download_timout => 1800,\n     15:     strip           => true,\n     16:   } ->\n     17:   class { '::bitbucket':\n     18:     version  => '5.10.0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-package_source-yum_postgresql_org.pp", "content": "baseurl  => \"http://yum.postgresql.org/${version}/${label1}/${label2}-\\$releasever-\\$basearch\",", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-package_source-yum_postgresql_org.pp\n\n$label2 = 'rhel'\n}\n\nyumrepo { 'yum.postgresql.org':\ndescr    => \"PostgreSQL ${version} \\$releasever - \\$basearch\",\n23:     baseurl  => \"http://yum.postgresql.org/${version}/${label1}/${label2}-\\$releasever-\\$basearch\",\nenabled  => 1,\ngpgcheck => 1,\ngpgkey   => \"file:///etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG-${package_version}\",\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-package_source-yum_postgresql_org.pp\n# Target line: 23\n\n     18:     $label2 = 'rhel'\n     19:   }\n     20: \n     21:   yumrepo { 'yum.postgresql.org':\n     22:     descr    => \"PostgreSQL ${version} \\$releasever - \\$basearch\",\n>>>  23:     baseurl  => \"http://yum.postgresql.org/${version}/${label1}/${label2}-\\$releasever-\\$basearch\",\n     24:     enabled  => 1,\n     25:     gpgcheck => 1,\n     26:     gpgkey   => \"file:///etc/pki/rpm-gpg/RPM-GPG-KEY-PGDG-${package_version}\",\n     27:   }\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"", "line": 69, "detection_span": [64, 74], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$rabbitmq_uid                  = 495\n$rabbitmq_management_port      = 15672\n$rabbitmq_management_bind_ip   = '127.0.0.1'\n\n$cobbler_host                  = $::ipaddress\n69:   $cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n$cobbler_user                  = 'cobbler'\n$cobbler_password              = 'cobbler'\n$centos_repos = [\n{\n'id'   => 'nailgun',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 69\n\n     64:   $rabbitmq_uid                  = 495\n     65:   $rabbitmq_management_port      = 15672\n     66:   $rabbitmq_management_bind_ip   = '127.0.0.1'\n     67: \n     68:   $cobbler_host                  = $::ipaddress\n>>>  69:   $cobbler_url                   = \"http://${::ipaddress}/cobbler_api\"\n     70:   $cobbler_user                  = 'cobbler'\n     71:   $cobbler_password              = 'cobbler'\n     72:   $centos_repos = [\n     73:     {\n     74:     'id'   => 'nailgun',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp", "content": "internal_url => \"http://${gnocchi_keystone_host_url}:8041\",", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n\nclass { '::gnocchi::keystone::auth':\nregion       => hiera('CONFIG_KEYSTONE_REGION'),\npassword     => hiera('CONFIG_GNOCCHI_KS_PW'),\npublic_url   => \"http://${gnocchi_keystone_host_url}:8041\",\nadmin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\n10:       internal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone-gnocchi.pp\n# Target line: 10\n\n      5:     class { '::gnocchi::keystone::auth':\n      6:       region       => hiera('CONFIG_KEYSTONE_REGION'),\n      7:       password     => hiera('CONFIG_GNOCCHI_KS_PW'),\n      8:       public_url   => \"http://${gnocchi_keystone_host_url}:8041\",\n      9:       admin_url    => \"http://${gnocchi_keystone_host_url}:8041\",\n>>>  10:       internal_url => \"http://${gnocchi_keystone_host_url}:8041\",\n     11:     }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-params.pp", "content": "$api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"", "line": 191, "detection_span": [186, 196], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-params.pp\n\n186:   $use_ssl = $ssl[horizon] or $ssl[services]\n187:   if $use_ssl {\nif $ssl[horizon] {\n$api_url = \"https://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n} else {\n191:       $api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n}\n193:   } else {\n$api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n195:   }\n196:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-params.pp\n# Target line: 191\n\n    186:   $use_ssl = $ssl[horizon] or $ssl[services]\n    187:   if $use_ssl {\n    188:     if $ssl[horizon] {\n    189:       $api_url = \"https://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n    190:     } else {\n>>> 191:       $api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n    192:     }\n    193:   } else {\n    194:     $api_url = \"http://${server_public_ip}${frontend_base}/api_jsonrpc.php\"\n    195:   }\n    196: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-neutron.pp", "content": "nova_url            => \"http://${controller_mgmt_address}:8774/v2/\",", "line": 135, "detection_span": [130, 140], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-neutron.pp\n\n}\n}\n132:   }\n133:\n134:   class { '::neutron::server::notifications':\n135:     nova_url            => \"http://${controller_mgmt_address}:8774/v2/\",\nnova_admin_auth_url => \"http://${keystone_ip_to_use}:35357/v2.0/\",\nnova_admin_password => $nova_password,\nnova_region_name    => $region_name,\nnova_admin_tenant_id => 'services'\n140:   }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-neutron.pp\n# Target line: 135\n\n    130:       }\n    131:     }\n    132:   }\n    133: \n    134:   class { '::neutron::server::notifications':\n>>> 135:     nova_url            => \"http://${controller_mgmt_address}:8774/v2/\",\n    136:     nova_admin_auth_url => \"http://${keystone_ip_to_use}:35357/v2.0/\",\n    137:     nova_admin_password => $nova_password,\n    138:     nova_region_name    => $region_name,\n    139:     nova_admin_tenant_id => 'services'\n    140:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@gds-boxen-modules-gds_virtualbox-manifests-init.pp", "content": "'4.3.26':  { $url = 'http://download.virtualbox.org/virtualbox/4.3.26/VirtualBox-4.3.26-98988-OSX.dmg' }", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: alphagov@gds-boxen-modules-gds_virtualbox-manifests-init.pp\n\n#\n#   include gds_virtualbox\n\nclass gds_virtualbox($version = 'recommended') {\ncase $version {\n9:     '4.3.26':  { $url = 'http://download.virtualbox.org/virtualbox/4.3.26/VirtualBox-4.3.26-98988-OSX.dmg' }\n'4.2.22':  { $url = 'http://download.virtualbox.org/virtualbox/4.2.22/VirtualBox-4.2.22-91556-OSX.dmg' }\ndefault:   { $url = 'http://download.virtualbox.org/virtualbox/4.3.14/VirtualBox-4.3.14-95030-OSX.dmg' }\n}\n\npackage { \"VirtualBox\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@gds-boxen-modules-gds_virtualbox-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: #   include gds_virtualbox\n      6: \n      7: class gds_virtualbox($version = 'recommended') {\n      8:   case $version {\n>>>   9:     '4.3.26':  { $url = 'http://download.virtualbox.org/virtualbox/4.3.26/VirtualBox-4.3.26-98988-OSX.dmg' }\n     10:     '4.2.22':  { $url = 'http://download.virtualbox.org/virtualbox/4.2.22/VirtualBox-4.2.22-91556-OSX.dmg' }\n     11:     default:   { $url = 'http://download.virtualbox.org/virtualbox/4.3.14/VirtualBox-4.3.14-95030-OSX.dmg' }\n     12:   }\n     13: \n     14:   package { \"VirtualBox\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp", "content": "location     => \"http://${apt_mirror_hostname}/gof3r\",", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n\n$ensure = 'absent'\n}\n\napt::source { 'gof3r':\nensure       => $ensure,\n28:     location     => \"http://${apt_mirror_hostname}/gof3r\",\nrelease      => $::lsbdistcodename,\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_transition_db_admin.pp\n# Target line: 28\n\n     23:     $ensure = 'absent'\n     24:   }\n     25: \n     26:   apt::source { 'gof3r':\n     27:     ensure       => $ensure,\n>>>  28:     location     => \"http://${apt_mirror_hostname}/gof3r\",\n     29:     release      => $::lsbdistcodename,\n     30:     architecture => $::architecture,\n     31:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     32:   }\n     33: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-nodes-mysql.pp", "content": "$rhel_mysql = 'http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm'", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-mysql.pp\n\n} else {\n$mysql_webserver_restart = false\n}\n\nif $::osfamily == 'redhat' {\n20:     $rhel_mysql = 'http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm'\nexec { 'mysql-community-repo':\ncommand => \"yum -y --nogpgcheck install '${rhel_mysql}' && touch /.puphpet-stuff/mysql-community-release\",\ncreates => '/.puphpet-stuff/mysql-community-release'\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-nodes-mysql.pp\n# Target line: 20\n\n     15:   } else {\n     16:     $mysql_webserver_restart = false\n     17:   }\n     18: \n     19:   if $::osfamily == 'redhat' {\n>>>  20:     $rhel_mysql = 'http://dev.mysql.com/get/mysql-community-release-el6-5.noarch.rpm'\n     21:     exec { 'mysql-community-repo':\n     22:       command => \"yum -y --nogpgcheck install '${rhel_mysql}' && touch /.puphpet-stuff/mysql-community-release\",\n     23:       creates => '/.puphpet-stuff/mysql-community-release'\n     24:     }\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-repoforgeextras.pp", "content": "baseurl  => 'http://apt.sw.be/redhat/el$releasever/en/$basearch/extras',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-repoforgeextras.pp\n\n#\nclass yum::repo::repoforgeextras {\n\nyum::managed_yumrepo { 'repoforgeextras':\ndescr    => 'RepoForge extra packages',\n9:     baseurl  => 'http://apt.sw.be/redhat/el$releasever/en/$basearch/extras',\nenabled  => 1,\ngpgcheck => 1,\ngpgkey   => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rpmforge-dag',\npriority => 1,\nexclude  => 'perl-IO-Compress-* perl-DBD-MySQL',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-repoforgeextras.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::repoforgeextras {\n      6: \n      7:   yum::managed_yumrepo { 'repoforgeextras':\n      8:     descr    => 'RepoForge extra packages',\n>>>   9:     baseurl  => 'http://apt.sw.be/redhat/el$releasever/en/$basearch/extras',\n     10:     enabled  => 1,\n     11:     gpgcheck => 1,\n     12:     gpgkey   => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-rpmforge-dag',\n     13:     priority => 1,\n     14:     exclude  => 'perl-IO-Compress-* perl-DBD-MySQL',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "zend-patterns@ZendServerPuppet-manifests-repo-debian.pp", "content": "$zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n\ncase $::operatingsystem {\n'Ubuntu' : {\nif $::operatingsystemrelease + 0 >= 14.04 {\n$zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_apache2.4\"\n} else {\n28:         $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n}\n}\ndefault  : {\n$zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: zend-patterns@ZendServerPuppet-manifests-repo-debian.pp\n# Target line: 28\n\n     23:   case $::operatingsystem {\n     24:     'Ubuntu' : {\n     25:       if $::operatingsystemrelease + 0 >= 14.04 {\n     26:         $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_apache2.4\"\n     27:       } else {\n>>>  28:         $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n     29:       }\n     30:     }\n     31:     default  : {\n     32:       $zend_repository = \"http://repos.zend.com/zend-server/${zendserver::zend_server_version}/deb_ssl1.0\"\n     33:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-logstash13.pp", "content": "baseurl        => 'http://packages.elasticsearch.org/logstash/1.3/centos',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-logstash13.pp\n\n#\nclass yum::repo::logstash13 {\n\nyum::managed_yumrepo { 'logstash-1.3':\ndescr          => 'logstash repository for 1.3.x packages',\n9:     baseurl        => 'http://packages.elasticsearch.org/logstash/1.3/centos',\nenabled        => 1,\ngpgcheck       => 1,\ngpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-logstash13.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::logstash13 {\n      6: \n      7:   yum::managed_yumrepo { 'logstash-1.3':\n      8:     descr          => 'logstash repository for 1.3.x packages',\n>>>   9:     baseurl        => 'http://packages.elasticsearch.org/logstash/1.3/centos',\n     10:     enabled        => 1,\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     13:   }\n     14: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@ci-puppet-modules-gds_mongodb-manifests-repo-mongodb2.pp", "content": "location    => 'http://downloads-distro.mongodb.org/repo/ubuntu-upstart',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@ci-puppet-modules-gds_mongodb-manifests-repo-mongodb2.pp\n\n# Add the packagree repo for mongodb 2 packages\nclass gds_mongodb::repo::mongodb2 {\n\nif $::lsbdistcodename == 'trusty' {\napt::source { '10gen':\n6:       location    => 'http://downloads-distro.mongodb.org/repo/ubuntu-upstart',\nrelease     => 'dist',\nrepos       => '10gen',\nkey         => '492EAFE8CD016A07919F1D2B9ECBEC467F0CEB10',\nkey_server  => 'hkp://keyserver.ubuntu.com:80',\ninclude_src => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-gds_mongodb-manifests-repo-mongodb2.pp\n# Target line: 6\n\n      1: # Add the packagree repo for mongodb 2 packages\n      2: class gds_mongodb::repo::mongodb2 {\n      3: \n      4:   if $::lsbdistcodename == 'trusty' {\n      5:     apt::source { '10gen':\n>>>   6:       location    => 'http://downloads-distro.mongodb.org/repo/ubuntu-upstart',\n      7:       release     => 'dist',\n      8:       repos       => '10gen',\n      9:       key         => '492EAFE8CD016A07919F1D2B9ECBEC467F0CEB10',\n     10:       key_server  => 'hkp://keyserver.ubuntu.com:80',\n     11:       include_src => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack-infra@puppet-openstackci-manifests-zuul_merger.pp", "content": "$zuul_url = \"http://${::fqdn}/p\",", "line": 27, "detection_span": [22, 32], "with_context": "# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n\n$gerrit_server = '',\n$gerrit_user = '',\n$known_hosts_content = '',\n$zuul_ssh_private_key = '',\n$layout_file_name = 'layout.yaml',\n27:   $zuul_url = \"http://${::fqdn}/p\",\n$git_email = 'zuul@domain.example',\n$git_name = 'Zuul',\n$manage_common_zuul = true,\n$revision = 'master',\n$git_source_repo = 'https://git.openstack.org/openstack-infra/zuul',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack-infra@puppet-openstackci-manifests-zuul_merger.pp\n# Target line: 27\n\n     22:   $gerrit_server = '',\n     23:   $gerrit_user = '',\n     24:   $known_hosts_content = '',\n     25:   $zuul_ssh_private_key = '',\n     26:   $layout_file_name = 'layout.yaml',\n>>>  27:   $zuul_url = \"http://${::fqdn}/p\",\n     28:   $git_email = 'zuul@domain.example',\n     29:   $git_name = 'Zuul',\n     30:   $manage_common_zuul = true,\n     31:   $revision = 'master',\n     32:   $git_source_repo = 'https://git.openstack.org/openstack-infra/zuul',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "jippi@puppet-php-manifests-apt.pp", "content": "$location     = 'http://packages.dotdeb.org',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: jippi@puppet-php-manifests-apt.pp\n\n# === Copyright\n#\n# Copyright 2012-2015 Christian \"Jippi\" Winther, unless otherwise noted.\n#\nclass php::apt(\n26:   $location     = 'http://packages.dotdeb.org',\n$release      = 'wheezy-php55',\n$repos        = 'all',\n$include_src  = false,\n$dotdeb       = true\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: jippi@puppet-php-manifests-apt.pp\n# Target line: 26\n\n     21: # === Copyright\n     22: #\n     23: # Copyright 2012-2015 Christian \"Jippi\" Winther, unless otherwise noted.\n     24: #\n     25: class php::apt(\n>>>  26:   $location     = 'http://packages.dotdeb.org',\n     27:   $release      = 'wheezy-php55',\n     28:   $repos        = 'all',\n     29:   $include_src  = false,\n     30:   $dotdeb       = true\n     31: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@puppet-monasca-manifests-thresh.pp", "content": "$thresh_fetch_url = \"http://${blobmirror}/repos/monasca/monasca_thresh\"", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-thresh.pp\n\n$sql_host     = $::monasca::params::sql_host\n$sql_user     = $::monasca::params::sql_user\n$sql_password = $::monasca::params::sql_password\n$sql_port     = $::monasca::params::sql_port\n\n35:   $thresh_fetch_url = \"http://${blobmirror}/repos/monasca/monasca_thresh\"\n$latest_thresh_deb = \"/tmp/${mon_thresh_deb}\"\n$thresh_cfg_file = '/etc/monasca/thresh-config.yml'\n$startup_script = '/etc/init.d/monasca-thresh'\n$startup_script_src = 'puppet:///modules/monasca/monasca-thresh'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-thresh.pp\n# Target line: 35\n\n     30:   $sql_host     = $::monasca::params::sql_host\n     31:   $sql_user     = $::monasca::params::sql_user\n     32:   $sql_password = $::monasca::params::sql_password\n     33:   $sql_port     = $::monasca::params::sql_port\n     34: \n>>>  35:   $thresh_fetch_url = \"http://${blobmirror}/repos/monasca/monasca_thresh\"\n     36:   $latest_thresh_deb = \"/tmp/${mon_thresh_deb}\"\n     37:   $thresh_cfg_file = '/etc/monasca/thresh-config.yml'\n     38:   $startup_script = '/etc/init.d/monasca-thresh'\n     39:   $startup_script_src = 'puppet:///modules/monasca/monasca-thresh'\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "quintel@boxen-modules-firefox-manifests-aurora.pp", "content": "source   => \"http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-aurora/firefox-26.0a2.${locale}.mac.dmg\",", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: quintel@boxen-modules-firefox-manifests-aurora.pp\n\n# Examples\n#\n#   include firefox::aurora\nclass firefox::aurora ($locale = 'en-US'){\npackage { 'Firefox-Aurora':\n8:     source   => \"http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-aurora/firefox-26.0a2.${locale}.mac.dmg\",\nprovider => 'appdmg'\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-firefox-manifests-aurora.pp\n# Target line: 8\n\n      3: # Examples\n      4: #\n      5: #   include firefox::aurora\n      6: class firefox::aurora ($locale = 'en-US'){\n      7:   package { 'Firefox-Aurora':\n>>>   8:     source   => \"http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla-aurora/firefox-26.0a2.${locale}.mac.dmg\",\n      9:     provider => 'appdmg'\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "voxpupuli@puppet-jira-examples-jira_postgres_nginx_install.pp", "content": "proxy                => 'http://jira',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: voxpupuli@puppet-jira-examples-jira_postgres_nginx_install.pp\n\n\nnginx::resource::vhost { 'jira_vhost':\nensure               => present,\nserver_name          => [ $facts['ipaddress'], $facts['fqdn'], $facts['hostname'] ],\nlisten_port          => '80',\n37:     proxy                => 'http://jira',\nproxy_read_timeout   => '300',\nlocation_cfg_prepend => {\n'proxy_set_header X-Forwarded-Host'   => '$host',\n'proxy_set_header X-Forwarded-Server' => '$host',\n'proxy_set_header X-Forwarded-For'    => '$proxy_add_x_forwarded_for',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-jira-examples-jira_postgres_nginx_install.pp\n# Target line: 37\n\n     32: \n     33:   nginx::resource::vhost { 'jira_vhost':\n     34:     ensure               => present,\n     35:     server_name          => [ $facts['ipaddress'], $facts['fqdn'], $facts['hostname'] ],\n     36:     listen_port          => '80',\n>>>  37:     proxy                => 'http://jira',\n     38:     proxy_read_timeout   => '300',\n     39:     location_cfg_prepend => {\n     40:       'proxy_set_header X-Forwarded-Host'   => '$host',\n     41:       'proxy_set_header X-Forwarded-Server' => '$host',\n     42:       'proxy_set_header X-Forwarded-For'    => '$proxy_add_x_forwarded_for',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-gcloud.pp", "content": "location     => \"http://${apt_mirror_hostname}/google-cloud-sdk-trusty\",", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-gcloud.pp\n\n#\nclass govuk_ci::agent::gcloud (\n$apt_mirror_hostname,\n){\napt::source { 'google-cloud-sdk-trusty':\n14:     location     => \"http://${apt_mirror_hostname}/google-cloud-sdk-trusty\",\nrelease      => 'stable',\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_ci-manifests-agent-gcloud.pp\n# Target line: 14\n\n      9: #\n     10: class govuk_ci::agent::gcloud (\n     11:   $apt_mirror_hostname,\n     12: ){\n     13:   apt::source { 'google-cloud-sdk-trusty':\n>>>  14:     location     => \"http://${apt_mirror_hostname}/google-cloud-sdk-trusty\",\n     15:     release      => 'stable',\n     16:     architecture => $::architecture,\n     17:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     18:   }\n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp", "content": "mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=5.0-updates',", "line": 21, "detection_span": [16, 26], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n\npriority       => 10,\n}\n\nyum::managed_yumrepo { 'jpackage-generic-5.0-updates':\ndescr          => 'JPackage (free), generic updates',\n21:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=5.0-updates',\nfailovermethod => 'priority',\ngpgcheck       => 1,\ngpgkey         => 'http://www.jpackage.org/jpackage.asc',\nenabled        => 1,\npriority       => 10,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n# Target line: 21\n\n     16:     priority       => 10,\n     17:   }\n     18: \n     19:   yum::managed_yumrepo { 'jpackage-generic-5.0-updates':\n     20:     descr          => 'JPackage (free), generic updates',\n>>>  21:     mirrorlist     => 'http://www.jpackage.org/mirrorlist.php?dist=generic&type=free&release=5.0-updates',\n     22:     failovermethod => 'priority',\n     23:     gpgcheck       => 1,\n     24:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     25:     enabled        => 1,\n     26:     priority       => 10,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-base.pp", "content": "location     => 'http://apt.production.alphagov.co.uk/rbenv-ruby',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-base.pp\n\nclass ci_environment::base {\napt::ppa { 'ppa:gds/govuk': }\n\nif $::lsbdistcodename == 'trusty' {\napt::source { 'govuk-rbenv':\n10:       location     => 'http://apt.production.alphagov.co.uk/rbenv-ruby',\nrelease      => $::lsbdistcodename,\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\ninclude_src  => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-base.pp\n# Target line: 10\n\n      5: class ci_environment::base {\n      6:   apt::ppa { 'ppa:gds/govuk': }\n      7: \n      8:   if $::lsbdistcodename == 'trusty' {\n      9:     apt::source { 'govuk-rbenv':\n>>>  10:       location     => 'http://apt.production.alphagov.co.uk/rbenv-ruby',\n     11:       release      => $::lsbdistcodename,\n     12:       architecture => $::architecture,\n     13:       key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     14:       include_src  => false,\n     15:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp", "content": "$jemalloc_url = 'http://files.puphpet.com/centos6/jemalloc-3.6.0-1.el6.x86_64.rpm'", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n\nif $lsbdistcodename in ['lucid', 'precise'] {\napt::ppa { 'ppa:mapnik/boost': require => Apt::Key['5D50B6BA'], options => '' }\n}\n}\n'centos': {\n53:       $jemalloc_url = 'http://files.puphpet.com/centos6/jemalloc-3.6.0-1.el6.x86_64.rpm'\n$jemalloc_download_location = '/.puphpet-stuff/jemalloc-3.6.0-1.el6.x86_64.rpm'\n\n$require = defined(Class['my_fw::post']) ? {\ntrue    => Class['my_fw::post'],\ndefault => [],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-puphpet-manifests-hhvm.pp\n# Target line: 53\n\n     48:       if $lsbdistcodename in ['lucid', 'precise'] {\n     49:         apt::ppa { 'ppa:mapnik/boost': require => Apt::Key['5D50B6BA'], options => '' }\n     50:       }\n     51:     }\n     52:     'centos': {\n>>>  53:       $jemalloc_url = 'http://files.puphpet.com/centos6/jemalloc-3.6.0-1.el6.x86_64.rpm'\n     54:       $jemalloc_download_location = '/.puphpet-stuff/jemalloc-3.6.0-1.el6.x86_64.rpm'\n     55: \n     56:       $require = defined(Class['my_fw::post']) ? {\n     57:         true    => Class['my_fw::post'],\n     58:         default => [],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "norcams@himlar-profile-manifests-monitoring-netdata-haproxy.pp", "content": "$stats_url = \"http://${::ipaddress_public1}:9000/;csv;norefresh\"", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: norcams@himlar-profile-manifests-monitoring-netdata-haproxy.pp\n\n#\nclass profile::monitoring::netdata::haproxy(\n3:   $stats_url = \"http://${::ipaddress_public1}:9000/;csv;norefresh\"\n) {\n\nfile_line { 'netdata-haproxy':\nensure  => present,\npath    => '/opt/netdata/netdata-configs/python.d/haproxy.conf',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-monitoring-netdata-haproxy.pp\n# Target line: 3\n\n      1: #\n      2: class profile::monitoring::netdata::haproxy(\n>>>   3:   $stats_url = \"http://${::ipaddress_public1}:9000/;csv;norefresh\"\n      4:   ) {\n      5: \n      6:   file_line { 'netdata-haproxy':\n      7:     ensure  => present,\n      8:     path    => '/opt/netdata/netdata-configs/python.d/haproxy.conf',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elrepo.pp", "content": "mirrorlist     => \"http://elrepo.org/mirrors-elrepo.${release}\",", "line": 63, "detection_span": [58, 68], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elrepo.pp\n\n}\n\nyum::managed_yumrepo { 'elrepo':\ndescr          => \"ELRepo.org Community Enterprise Linux Repository - ${release}\",\nbaseurl        => $baseurl_elrepo,\n63:     mirrorlist     => \"http://elrepo.org/mirrors-elrepo.${release}\",\nenabled        => 1,\ngpgcheck       => 1,\ngpgkey         => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-elrepo.org',\ngpgkey_source  => 'puppet:///modules/yum/rpm-gpg/RPM-GPG-KEY-elrepo.org',\nfailovermethod => 'priority',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elrepo.pp\n# Target line: 63\n\n     58:   }\n     59: \n     60:   yum::managed_yumrepo { 'elrepo':\n     61:     descr          => \"ELRepo.org Community Enterprise Linux Repository - ${release}\",\n     62:     baseurl        => $baseurl_elrepo,\n>>>  63:     mirrorlist     => \"http://elrepo.org/mirrors-elrepo.${release}\",\n     64:     enabled        => 1,\n     65:     gpgcheck       => 1,\n     66:     gpgkey         => 'file:///etc/pki/rpm-gpg/RPM-GPG-KEY-elrepo.org',\n     67:     gpgkey_source  => 'puppet:///modules/yum/rpm-gpg/RPM-GPG-KEY-elrepo.org',\n     68:     failovermethod => 'priority',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp", "content": "glance_api_servers            => \"http://${nova_common_rabbitmq_cfg_storage_host}:9292\",", "line": 65, "detection_span": [60, 70], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n\nclass { '::nova::logging':\ndebug => hiera('CONFIG_DEBUG_MODE'),\n}\n\nclass { '::nova':\n65:       glance_api_servers            => \"http://${nova_common_rabbitmq_cfg_storage_host}:9292\",\ndefault_transport_url         => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\nrabbit_use_ssl                => hiera('CONFIG_AMQP_SSL_ENABLED'),\nnova_public_key               => $public_key,\nnova_private_key              => $private_key,\nkombu_ssl_ca_certs            => $kombu_ssl_ca_certs,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n# Target line: 65\n\n     60:     class { '::nova::logging':\n     61:       debug => hiera('CONFIG_DEBUG_MODE'),\n     62:     }\n     63: \n     64:     class { '::nova':\n>>>  65:       glance_api_servers            => \"http://${nova_common_rabbitmq_cfg_storage_host}:9292\",\n     66:       default_transport_url         => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\n     67:       rabbit_use_ssl                => hiera('CONFIG_AMQP_SSL_ENABLED'),\n     68:       nova_public_key               => $public_key,\n     69:       nova_private_key              => $private_key,\n     70:       kombu_ssl_ca_certs            => $kombu_ssl_ca_certs,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "voxpupuli@puppet-nginx-examples-location_params.pp", "content": "server        => 'www.test.com',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: voxpupuli@puppet-nginx-examples-location_params.pp\n\ninclude nginx\n\nnginx::resource::location { 'www.test.com-params':\nensure        => present,\nlocation      => '/some/url',\n6:     server        => 'www.test.com',\nfastcgi_param => {\n'APP_ENV'     => 'production',\n'APP_VERSION' => '0.1.10',\n'APP_SECRET'  => 'hisfaihicasagfkjsa',\n},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-nginx-examples-location_params.pp\n# Target line: 6\n\n      1: include nginx\n      2: \n      3: nginx::resource::location { 'www.test.com-params':\n      4:     ensure        => present,\n      5:     location      => '/some/url',\n>>>   6:     server        => 'www.test.com',\n      7:     fastcgi_param => {\n      8:       'APP_ENV'     => 'production',\n      9:       'APP_VERSION' => '0.1.10',\n     10:       'APP_SECRET'  => 'hisfaihicasagfkjsa',\n     11:     },\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-backup-manifests-repo.pp", "content": "location     => \"http://${apt_mirror_hostname}/duplicity\",", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-backup-manifests-repo.pp\n\n#\nclass backup::repo (\n$apt_mirror_hostname,\n) {\napt::source { 'duplicity':\n14:     location     => \"http://${apt_mirror_hostname}/duplicity\",\nrelease      => $::lsbdistcodename,\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-backup-manifests-repo.pp\n# Target line: 14\n\n      9: #\n     10: class backup::repo (\n     11:   $apt_mirror_hostname,\n     12: ) {\n     13:   apt::source { 'duplicity':\n>>>  14:     location     => \"http://${apt_mirror_hostname}/duplicity\",\n     15:     release      => $::lsbdistcodename,\n     16:     architecture => $::architecture,\n     17:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     18:   }\n     19: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp", "content": "location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n\n$config = {},\n$init_defaults_file = 'puppet:///modules/performanceplatform/etc/sysconfig/logstash.dev.defaults',\n) {\n\napt::source { 'logstash':\n7:     location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\nrelease     => 'stable',\nrepos       => 'main',\nkey         => 'D88E42B4',\nkey_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\ninclude_src => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-monitoring-logstash.pp\n# Target line: 7\n\n      2:   $config = {},\n      3:   $init_defaults_file = 'puppet:///modules/performanceplatform/etc/sysconfig/logstash.dev.defaults',\n      4: ) {\n      5: \n      6:   apt::source { 'logstash':\n>>>   7:     location    => 'http://packages.elasticsearch.org/logstash/1.4/debian',\n      8:     release     => 'stable',\n      9:     repos       => 'main',\n     10:     key         => 'D88E42B4',\n     11:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     12:     include_src => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "puppetlabs@puppetlabs-openstack-manifests-profile-keystone.pp", "content": "admin_url    => \"http://${::openstack::config::controller_address_management}:35357\",", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-keystone.pp\n\nadmin_tenant => 'admin',\n}\n\nclass { 'keystone::endpoint':\npublic_url   => \"http://${::openstack::config::controller_address_api}:5000\",\n17:     admin_url    => \"http://${::openstack::config::controller_address_management}:35357\",\ninternal_url => \"http://${::openstack::config::controller_address_management}:5000\",\nregion       => $::openstack::config::region,\n}\n\nif $::openstack::config::keystone_use_httpd == true {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-keystone.pp\n# Target line: 17\n\n     12:     admin_tenant => 'admin',\n     13:   }\n     14: \n     15:   class { 'keystone::endpoint':\n     16:     public_url   => \"http://${::openstack::config::controller_address_api}:5000\",\n>>>  17:     admin_url    => \"http://${::openstack::config::controller_address_management}:35357\",\n     18:     internal_url => \"http://${::openstack::config::controller_address_management}:5000\",\n     19:     region       => $::openstack::config::region,\n     20:   }\n     21: \n     22:   if $::openstack::config::keystone_use_httpd == true {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mattheath@puppet-php-manifests-extension-memcache.pp", "content": "$url = \"http://pecl.php.net/get/memcache-${version}.tgz\"", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: mattheath@puppet-php-manifests-extension-memcache.pp\n\nrequire join(['php', join(split($php, '[.]'), '_')], '::')\n\n\n$extension = 'memcache'\n$package_name = \"memcache-${version}\"\n24:   $url = \"http://pecl.php.net/get/memcache-${version}.tgz\"\n\n# Final module install path\n$module_path = \"${php::config::root}/versions/${php}/modules/${extension}.so\"\n\nphp_extension { $name:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: mattheath@puppet-php-manifests-extension-memcache.pp\n# Target line: 24\n\n     19:   require join(['php', join(split($php, '[.]'), '_')], '::')\n     20: \n     21: \n     22:   $extension = 'memcache'\n     23:   $package_name = \"memcache-${version}\"\n>>>  24:   $url = \"http://pecl.php.net/get/memcache-${version}.tgz\"\n     25: \n     26:   # Final module install path\n     27:   $module_path = \"${php::config::root}/versions/${php}/modules/${extension}.so\"\n     28: \n     29:   php_extension { $name:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",", "line": 116, "detection_span": [111, 121], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\npassword         => $nova_password,\npublic_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\nadmin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\ninternal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\npublic_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\n116:     admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\ninternal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\nregion           => $region_name,\n119:   } ->\n120:   class { '::neutron::keystone::auth':\npassword         => $neutron_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 116\n\n    111:     password         => $nova_password,\n    112:     public_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    113:     admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    114:     internal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    115:     public_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\n>>> 116:     admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\n    117:     internal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\n    118:     region           => $region_name,\n    119:   } ->\n    120:   class { '::neutron::keystone::auth':\n    121:     password         => $neutron_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "admin_url        => \"http://$openstack_ip_to_use:8777\",", "line": 130, "detection_span": [125, 135], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\nregion           => $region_name,\n126:   } ->\n127:   class { '::ceilometer::keystone::auth':\npassword         => $ceilometer_password,\npublic_url       => \"http://$openstack_ip_to_use:8777\",\n130:     admin_url        => \"http://$openstack_ip_to_use:8777\",\ninternal_url     => \"http://$openstack_ip_to_use:8777\",\nregion           => $region_name,\n133:   } ->\n134:   class { '::heat::keystone::auth':\npassword         => $heat_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 130\n\n    125:     region           => $region_name,\n    126:   } ->\n    127:   class { '::ceilometer::keystone::auth':\n    128:     password         => $ceilometer_password,\n    129:     public_url       => \"http://$openstack_ip_to_use:8777\",\n>>> 130:     admin_url        => \"http://$openstack_ip_to_use:8777\",\n    131:     internal_url     => \"http://$openstack_ip_to_use:8777\",\n    132:     region           => $region_name,\n    133:   } ->\n    134:   class { '::heat::keystone::auth':\n    135:     password         => $heat_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "proxy               => \"http://${::fqdn}:9200\",", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\nssl_cache           => 'shared:SSL:10m',\nssl_port            => 9201,\nssl_session_timeout => '10m',\nssl_stapling        => true,\nssl_stapling_verify => true,\n87:       proxy               => \"http://${::fqdn}:9200\",\nproxy_read_timeout  => 120,\naccess_log          => $nginx_elastic_access_log,\nerror_log           => $nginx_elastic_error_log,\nformat_log          => $nginx_log_format,\nlocation_cfg_append => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 87\n\n     82:       ssl_cache           => 'shared:SSL:10m',\n     83:       ssl_port            => 9201,\n     84:       ssl_session_timeout => '10m',\n     85:       ssl_stapling        => true,\n     86:       ssl_stapling_verify => true,\n>>>  87:       proxy               => \"http://${::fqdn}:9200\",\n     88:       proxy_read_timeout  => 120,\n     89:       access_log          => $nginx_elastic_access_log,\n     90:       error_log           => $nginx_elastic_error_log,\n     91:       format_log          => $nginx_log_format,\n     92:       location_cfg_append => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "openstack@puppet-neutron-manifests-plugins-midonet.pp", "content": "'MIDONET/midonet_uri':  value => \"http://${cluster_ip}:${cluster_port}/midonet-api\";", "line": 149, "detection_span": [144, 154], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-midonet.pp\n\nname   => $::neutron::params::midonet_server_package,\ntag    => ['neutron-package', 'openstack'],\n}\n147:\n148:   neutron_plugin_midonet {\n149:     'MIDONET/midonet_uri':  value => \"http://${cluster_ip}:${cluster_port}/midonet-api\";\n'MIDONET/username':     value => $keystone_username;\n'MIDONET/password':     value => $keystone_password, secret =>true;\n'MIDONET/project_id':   value => $keystone_tenant;\n153:   }\n154:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-midonet.pp\n# Target line: 149\n\n    144:     name   => $::neutron::params::midonet_server_package,\n    145:     tag    => ['neutron-package', 'openstack'],\n    146:     }\n    147: \n    148:   neutron_plugin_midonet {\n>>> 149:     'MIDONET/midonet_uri':  value => \"http://${cluster_ip}:${cluster_port}/midonet-api\";\n    150:     'MIDONET/username':     value => $keystone_username;\n    151:     'MIDONET/password':     value => $keystone_password, secret =>true;\n    152:     'MIDONET/project_id':   value => $keystone_tenant;\n    153:   }\n    154: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "puppetlabs@puppetlabs-openstack-manifests-profile-tempest.pp", "content": "'boto/ec2_url':            value => \"http://${api_ip}:8773/services/Cloud\";", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-tempest.pp\n\npath    => $::tempest::tempest_conf,\nrequire => File[$::tempest::tempest_conf],\n}\n\ntempest_config {\n49:     'boto/ec2_url':            value => \"http://${api_ip}:8773/services/Cloud\";\n'boto/s3_url':             value => \"http://${api_ip}:3333\";\n'dashboard/dashboard_url': value => \"http://${api_ip}/\";\n'dashboard/login_url':     value => \"http://${api_ip}/dashboard\";\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-profile-tempest.pp\n# Target line: 49\n\n     44:     path    => $::tempest::tempest_conf,\n     45:     require => File[$::tempest::tempest_conf],\n     46:   }\n     47: \n     48:   tempest_config {\n>>>  49:     'boto/ec2_url':            value => \"http://${api_ip}:8773/services/Cloud\";\n     50:     'boto/s3_url':             value => \"http://${api_ip}:3333\";\n     51:     'dashboard/dashboard_url': value => \"http://${api_ip}/\";\n     52:     'dashboard/login_url':     value => \"http://${api_ip}/dashboard\";\n     53:   }\n     54: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "internal_url_v3 => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",", "line": 87, "detection_span": [82, 92], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\npublic_url_v2   => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\nadmin_url_v2    => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\ninternal_url_v2 => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\npublic_url_v3   => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\nadmin_url_v3    => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n87:       internal_url_v3 => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\nregion          => $region_name,\n}\n} else {\nclass { '::cinder::keystone::auth':\npassword        => $cinder_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 87\n\n     82:       public_url_v2   => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\n     83:       admin_url_v2    => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\n     84:       internal_url_v2 => \"http://${openstack_ip_to_use}:8776/v2/%(tenant_id)s\",\n     85:       public_url_v3   => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n     86:       admin_url_v3    => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n>>>  87:       internal_url_v3 => \"http://${openstack_ip_to_use}:8776/v3/%(tenant_id)s\",\n     88:       region          => $region_name,\n     89:     }\n     90:   } else {\n     91:     class { '::cinder::keystone::auth':\n     92:       password        => $cinder_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch90.pp", "content": "baseurl        => 'http://packages.elasticsearch.org/elasticsearch/0.90/centos',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch90.pp\n\n#\nclass yum::repo::elasticsearch90 {\n\nyum::managed_yumrepo { 'elasticsearch-0.90':\ndescr          => 'Elasticsearch repository for 0.90.x packages',\n9:     baseurl        => 'http://packages.elasticsearch.org/elasticsearch/0.90/centos',\nenabled        => 1,\ngpgcheck       => 1,\ngpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch90.pp\n# Target line: 9\n\n      4: #\n      5: class yum::repo::elasticsearch90 {\n      6: \n      7:   yum::managed_yumrepo { 'elasticsearch-0.90':\n      8:     descr          => 'Elasticsearch repository for 0.90.x packages',\n>>>   9:     baseurl        => 'http://packages.elasticsearch.org/elasticsearch/0.90/centos',\n     10:     enabled        => 1,\n     11:     gpgcheck       => 1,\n     12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     13:   }\n     14: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",", "line": 113, "detection_span": [108, 118], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\nregion       => $region_name,\n109:   } ->\n110:   class { '::nova::keystone::auth':\npassword         => $nova_password,\npublic_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n113:     admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\ninternal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\npublic_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\nadmin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\ninternal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\nregion           => $region_name,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 113\n\n    108:     region       => $region_name,\n    109:   } ->\n    110:   class { '::nova::keystone::auth':\n    111:     password         => $nova_password,\n    112:     public_url       => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n>>> 113:     admin_url        => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    114:     internal_url     => \"http://${openstack_ip_to_use}:8774/${endpoint_version}${tenant_id}\",\n    115:     public_url_v3    => \"http://${openstack_ip_to_use}:8774/v3\",\n    116:     admin_url_v3     => \"http://${openstack_ip_to_use}:8774/v3\",\n    117:     internal_url_v3  => \"http://${openstack_ip_to_use}:8774/v3\",\n    118:     region           => $region_name,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-elasticsearch-manifests-template.pp", "content": "$es_url = \"http://${host}:${port}/_template/${name}\"", "line": 67, "detection_span": [62, 72], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-elasticsearch-manifests-template.pp\n\ntries     => 3,\ntry_sleep => 10\n}\n\n# Build up the url\n67:   $es_url = \"http://${host}:${port}/_template/${name}\"\n\n# Can't do a replace and delete at the same time\n\nif ($ensure == 'present') {\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-elasticsearch-manifests-template.pp\n# Target line: 67\n\n     62:     tries     => 3,\n     63:     try_sleep => 10\n     64:   }\n     65: \n     66:   # Build up the url\n>>>  67:   $es_url = \"http://${host}:${port}/_template/${name}\"\n     68: \n     69:   # Can't do a replace and delete at the same time\n     70: \n     71:   if ($ensure == 'present') {\n     72: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "quintel@boxen-modules-sublime_text_2-manifests-init.pp", "content": "source   => 'http://c758482.r82.cf2.rackcdn.com/Sublime%20Text%202.0.2.dmg';", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: quintel@boxen-modules-sublime_text_2-manifests-init.pp\n\n#\n#     include sublime_text_2\nclass sublime_text_2 {\npackage { 'SublimeText2':\nprovider => 'appdmg',\n9:     source   => 'http://c758482.r82.cf2.rackcdn.com/Sublime%20Text%202.0.2.dmg';\n}\n\nfile { \"${boxen::config::bindir}/subl\":\nensure  => link,\ntarget  => '/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-sublime_text_2-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: #     include sublime_text_2\n      6: class sublime_text_2 {\n      7:   package { 'SublimeText2':\n      8:     provider => 'appdmg',\n>>>   9:     source   => 'http://c758482.r82.cf2.rackcdn.com/Sublime%20Text%202.0.2.dmg';\n     10:   }\n     11: \n     12:   file { \"${boxen::config::bindir}/subl\":\n     13:     ensure  => link,\n     14:     target  => '/Applications/Sublime Text 2.app/Contents/SharedSupport/bin/subl',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-10gen.pp", "content": "baseurl     => \"http://downloads-distro.mongodb.org/repo/redhat/os/${::architecture}\",", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-10gen.pp\n\n# This class installs the 10gen repo for MongoDB\n#\nclass yum::repo::10gen {\nyum::managed_yumrepo { '10gen':\ndescr       => '10gen Repository',\n8:     baseurl     => \"http://downloads-distro.mongodb.org/repo/redhat/os/${::architecture}\",\nenabled     => 1,\ngpgcheck    => 0,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-10gen.pp\n# Target line: 8\n\n      3: # This class installs the 10gen repo for MongoDB\n      4: #\n      5: class yum::repo::10gen {\n      6:   yum::managed_yumrepo { '10gen':\n      7:     descr       => '10gen Repository',\n>>>   8:     baseurl     => \"http://downloads-distro.mongodb.org/repo/redhat/os/${::architecture}\",\n      9:     enabled     => 1,\n     10:     gpgcheck    => 0,\n     11:   }\n     12: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-elasticsearch.pp", "content": "location    => 'http://packages.elasticsearch.org/elasticsearch/1.3/debian',", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-elasticsearch.pp\n\nhandlers => ['default'],\nrequire  => Package['rest-client'],\n}\n\napt::source { 'elasticsearch':\n55:     location    => 'http://packages.elasticsearch.org/elasticsearch/1.3/debian',\nrelease     => 'stable',\nrepos       => 'main',\nkey         => 'D88E42B4',\nkey_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\ninclude_src => false,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-elasticsearch.pp\n# Target line: 55\n\n     50:     handlers => ['default'],\n     51:     require  => Package['rest-client'],\n     52:   }\n     53: \n     54:   apt::source { 'elasticsearch':\n>>>  55:     location    => 'http://packages.elasticsearch.org/elasticsearch/1.3/debian',\n     56:     release     => 'stable',\n     57:     repos       => 'main',\n     58:     key         => 'D88E42B4',\n     59:     key_source  => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     60:     include_src => false,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-scholarships.pp", "content": "callback_url => \"http://${::scholarships::vhost_name}${::port_fragment}/\",", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-scholarships.pp\n\n\nrole::oauth::consumer { 'Wikimania Scholarships':\ndescription  => 'Wikimania Scholarships',\nconsumer_key => $oauth_consumer_key,\nsecret_key   => $oauth_secret_key,\n18:         callback_url => \"http://${::scholarships::vhost_name}${::port_fragment}/\",\ngrants       => ['authonlyprivate'],\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-role-manifests-scholarships.pp\n# Target line: 18\n\n     13: \n     14:     role::oauth::consumer { 'Wikimania Scholarships':\n     15:         description  => 'Wikimania Scholarships',\n     16:         consumer_key => $oauth_consumer_key,\n     17:         secret_key   => $oauth_secret_key,\n>>>  18:         callback_url => \"http://${::scholarships::vhost_name}${::port_fragment}/\",\n     19:         grants       => ['authonlyprivate'],\n     20:     }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-examples-default_install_from_source.pp", "content": "source_url => 'http://mirror.nexcess.net/apache/tomcat/tomcat-8/v8.0.8/bin/apache-tomcat-8.0.8.tar.gz'", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-examples-default_install_from_source.pp\n\n#\nclass { 'tomcat': }\nclass { 'java': }\n\ntomcat::instance { 'test':\n7:   source_url => 'http://mirror.nexcess.net/apache/tomcat/tomcat-8/v8.0.8/bin/apache-tomcat-8.0.8.tar.gz'\n}\n-> tomcat::service { 'default': }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-examples-default_install_from_source.pp\n# Target line: 7\n\n      2: #\n      3: class { 'tomcat': }\n      4: class { 'java': }\n      5: \n      6: tomcat::instance { 'test':\n>>>   7:   source_url => 'http://mirror.nexcess.net/apache/tomcat/tomcat-8/v8.0.8/bin/apache-tomcat-8.0.8.tar.gz'\n      8: }\n      9: -> tomcat::service { 'default': }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@ci-puppet-modules-gds_elasticsearch-manifests-repo.pp", "content": "location     => \"http://apt.production.alphagov.co.uk/elasticsearch-${repo_version}\",", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: alphagov@ci-puppet-modules-gds_elasticsearch-manifests-repo.pp\n\n#\nclass gds_elasticsearch::repo(\n$repo_version,\n) {\napt::source { \"elasticsearch-${repo_version}\":\n15:     location     => \"http://apt.production.alphagov.co.uk/elasticsearch-${repo_version}\",\nrelease      => 'stable',\narchitecture => $::architecture,\nkey          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\ninclude_src  => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-gds_elasticsearch-manifests-repo.pp\n# Target line: 15\n\n     10: #\n     11: class gds_elasticsearch::repo(\n     12:   $repo_version,\n     13: ) {\n     14:   apt::source { \"elasticsearch-${repo_version}\":\n>>>  15:     location     => \"http://apt.production.alphagov.co.uk/elasticsearch-${repo_version}\",\n     16:     release      => 'stable',\n     17:     architecture => $::architecture,\n     18:     key          => '3803E444EB0235822AA36A66EC5FE1A937E3ACBB',\n     19:     include_src  => false,\n     20:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-heat.pp", "content": "$auth_uri = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-heat.pp\n\n$heat_server_ip = $host_control_ip\n$mysql_port_url = \"/heat\"\n$mysql_ip_address  = $host_control_ip\n}\n\n49:   $auth_uri = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n$database_credentials = join([$service_password, \"@\", $mysql_ip_address],'')\n$keystone_db_conn = join([\"mysql://heat:\",$database_credentials,$mysql_port_url],'')\n\nclass {'::heat::db::mysql':\npassword => $service_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-heat.pp\n# Target line: 49\n\n     44:     $heat_server_ip = $host_control_ip\n     45:     $mysql_port_url = \"/heat\"\n     46:     $mysql_ip_address  = $host_control_ip\n     47:   }\n     48: \n>>>  49:   $auth_uri = \"http://${keystone_ip_to_use}:5000/${keystone_version}\"\n     50:   $database_credentials = join([$service_password, \"@\", $mysql_ip_address],'')\n     51:   $keystone_db_conn = join([\"mysql://heat:\",$database_credentials,$mysql_port_url],'')\n     52: \n     53:   class {'::heat::db::mysql':\n     54:     password => $service_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp", "content": "$pwd_md5 = md5(\"${password_hash}${username}\")", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n\n\nif $password_hash {\nif($password_hash =~ /^md5.+/) {\n$pwd_hash_sql = $password_hash\n} else {\n86:       $pwd_md5 = md5(\"${password_hash}${username}\")\n$pwd_hash_sql = \"md5${pwd_md5}\"\n}\npostgresql_psql {\"ALTER ROLE \\\"${username}\\\" ${password_sql}\":\nunless => \"SELECT usename FROM pg_shadow WHERE usename='${username}' and passwd='${pwd_hash_sql}'\",\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-postgresql-manifests-role.pp\n# Target line: 86\n\n     81: \n     82:   if $password_hash {\n     83:     if($password_hash =~ /^md5.+/) {\n     84:       $pwd_hash_sql = $password_hash\n     85:     } else {\n>>>  86:       $pwd_md5 = md5(\"${password_hash}${username}\")\n     87:       $pwd_hash_sql = \"md5${pwd_md5}\"\n     88:     }\n     89:     postgresql_psql {\"ALTER ROLE \\\"${username}\\\" ${password_sql}\":\n     90:       unless => \"SELECT usename FROM pg_shadow WHERE usename='${username}' and passwd='${pwd_hash_sql}'\",\n     91:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "puppetlabs@puppetlabs-postgresql-manifests-server-role.pp", "content": "$pwd_hash_sql = \"md5${pwd_md5}\"", "line": 116, "detection_span": [111, 121], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n\nif $password_hash and $update_password {\nif($password_hash =~ /^md5.+/) {\n$pwd_hash_sql = $password_hash\n} else {\n$pwd_md5 = md5(\"${password_hash}${username}\")\n116:         $pwd_hash_sql = \"md5${pwd_md5}\"\n}\npostgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\ncommand     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\nunless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",\nenvironment => $environment,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-server-role.pp\n# Target line: 116\n\n    111:     if $password_hash and $update_password {\n    112:       if($password_hash =~ /^md5.+/) {\n    113:         $pwd_hash_sql = $password_hash\n    114:       } else {\n    115:         $pwd_md5 = md5(\"${password_hash}${username}\")\n>>> 116:         $pwd_hash_sql = \"md5${pwd_md5}\"\n    117:       }\n    118:       postgresql_psql { \"ALTER ROLE ${username} ENCRYPTED PASSWORD ****\":\n    119:         command     => \"ALTER ROLE \\\"${username}\\\" ${password_sql}\",\n    120:         unless      => \"SELECT 1 FROM pg_shadow WHERE usename = '${username}' AND passwd = '${pwd_hash_sql}'\",\n    121:         environment => $environment,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "wazuh@ossec-puppet-manifests-agentkey.pp", "content": "$agentkey2 = md5(\"${agent_name} ${agent_ip_address} ${agent_seed}\")", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: wazuh@ossec-puppet-manifests-agentkey.pp\n\nrequire ossec::params\n\nif ! $agent_id { fail(\"ossec::agentkey: ${agent_id} is missing\")}\n\n$agentkey1 = md5(\"${agent_id} ${agent_seed}\")\n13:   $agentkey2 = md5(\"${agent_name} ${agent_ip_address} ${agent_seed}\")\n\nconcat::fragment { \"var_ossec_etc_client.keys_${agent_name}_part\":\ntarget  => $ossec::params::keys_file,\norder   => $agent_id,\ncontent => \"${agent_id} ${agent_name} ${agent_ip_address} ${agentkey1}${agentkey2}\\n\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wazuh@ossec-puppet-manifests-agentkey.pp\n# Target line: 13\n\n      8:   require ossec::params\n      9: \n     10:   if ! $agent_id { fail(\"ossec::agentkey: ${agent_id} is missing\")}\n     11: \n     12:   $agentkey1 = md5(\"${agent_id} ${agent_seed}\")\n>>>  13:   $agentkey2 = md5(\"${agent_name} ${agent_ip_address} ${agent_seed}\")\n     14: \n     15:   concat::fragment { \"var_ossec_etc_client.keys_${agent_name}_part\":\n     16:     target  => $ossec::params::keys_file,\n     17:     order   => $agent_id,\n     18:     content => \"${agent_id} ${agent_name} ${agent_ip_address} ${agentkey1}${agentkey2}\\n\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "cargomedia@puppet-packages-modules-github-manifests-knownhost.pp", "content": "key => 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-github-manifests-knownhost.pp\n\nclass github::knownhost {\n\nssh::knownhost { 'github.com':\n4:     key => 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-github-manifests-knownhost.pp\n# Target line: 4\n\n      1: class github::knownhost {\n      2: \n      3:   ssh::knownhost { 'github.com':\n>>>   4:     key => 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ==',\n      5:   }\n      6: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_KEYSTONE_DB_PW'),", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\nclass packstack::mariadb::services ()\n{\nclass { '::keystone::db::mysql':\nuser          => 'keystone_admin',\n5:       password      => hiera('CONFIG_KEYSTONE_DB_PW'),\nallowed_hosts => '%',\ncharset       => 'utf8',\n}\n\nif hiera('CONFIG_CINDER_INSTALL') == 'y' {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 5\n\n      1: class packstack::mariadb::services ()\n      2: {\n      3:     class { '::keystone::db::mysql':\n      4:       user          => 'keystone_admin',\n>>>   5:       password      => hiera('CONFIG_KEYSTONE_DB_PW'),\n      6:       allowed_hosts => '%',\n      7:       charset       => 'utf8',\n      8:     }\n      9: \n     10:     if hiera('CONFIG_CINDER_INSTALL') == 'y' {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp", "content": "password      => hiera('CONFIG_PANKO_DB_PW'),", "line": 114, "detection_span": [109, 119], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n\n}\n110:\nif hiera('CONFIG_PANKO_INSTALL') == 'y' and\nhiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\nclass { '::panko::db::mysql':\n114:           password      => hiera('CONFIG_PANKO_DB_PW'),\nhost          => '%',\nallowed_hosts => '%',\n}\n}\n119:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-mariadb-services.pp\n# Target line: 114\n\n    109:     }\n    110: \n    111:     if hiera('CONFIG_PANKO_INSTALL') == 'y' and\n    112:        hiera('CONFIG_CEILOMETER_INSTALL') == 'y' {\n    113:         class { '::panko::db::mysql':\n>>> 114:           password      => hiera('CONFIG_PANKO_DB_PW'),\n    115:           host          => '%',\n    116:           allowed_hosts => '%',\n    117:         }\n    118:     }\n    119: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp", "content": "key   => 'GATEWAY',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n\n/(?i:redhat|centos|oraclelinux)/: {\nCfg <| name == $gateway |>\nif ! defined(Cfg[$gateway]) {\ncfg { $gateway:\nfile  => '/etc/sysconfig/network',\n26:               key   => 'GATEWAY',\nvalue => $gateway,\n} ->\n# FIXME: we should not nuke the system with 'service network restart'...\n# FIXME: but we should ensure default route will be created somehow\nexec { $exec_name :", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n# Target line: 26\n\n     21:     /(?i:redhat|centos|oraclelinux)/: {\n     22:         Cfg <| name == $gateway |>\n     23:         if ! defined(Cfg[$gateway]) {\n     24:           cfg { $gateway:\n     25:               file  => '/etc/sysconfig/network',\n>>>  26:               key   => 'GATEWAY',\n     27:               value => $gateway,\n     28:           } ->\n     29:           # FIXME: we should not nuke the system with 'service network restart'...\n     30:           # FIXME: but we should ensure default route will be created somehow\n     31:           exec { $exec_name :\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "tsuru@puppet-tsuru-base-manifests-init.pp", "content": "$tsuru_pub_key = '", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: tsuru@puppet-tsuru-base-manifests-init.pp\n\n$docker_source_list    = false,\n$docker_release        = $::lsbdistcodename,\n$docker_repos          = 'main'\n) {\n\n30:   $tsuru_pub_key = '\n-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: SKS 1.1.4\nComment: Hostname: keyserver.ubuntu.com\n\nmI0EUktBQAEEAJwPWcFy1B20SgKkF3QVvMoSJld+3bhrS6AT0fbYwv4RgpwekQGrnO5z4Otg", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: tsuru@puppet-tsuru-base-manifests-init.pp\n# Target line: 30\n\n     25:   $docker_source_list    = false,\n     26:   $docker_release        = $::lsbdistcodename,\n     27:   $docker_repos          = 'main'\n     28: ) {\n     29: \n>>>  30:   $tsuru_pub_key = '\n     31: -----BEGIN PGP PUBLIC KEY BLOCK-----\n     32: Version: SKS 1.1.4\n     33: Comment: Hostname: keyserver.ubuntu.com\n     34: \n     35: mI0EUktBQAEEAJwPWcFy1B20SgKkF3QVvMoSJld+3bhrS6AT0fbYwv4RgpwekQGrnO5z4Otg\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp", "content": "password        => \"password\",", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n\n\nclass aeolus::profiles::conductor {\n\naeolus::conductor::site_admin{\"admin\":\nemail           => 'root@localhost.localdomain',\n19:      password        => \"password\",\nfirst_name      => 'Administrator',\nlast_name       => ''}\n\naeolus::conductor::login{\"admin\": password => \"password\",\nrequire  => Aeolus::Conductor::Site_admin['admin']}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-profiles-conductor.pp\n# Target line: 19\n\n     14: \n     15: class aeolus::profiles::conductor {\n     16: \n     17:   aeolus::conductor::site_admin{\"admin\":\n     18:      email           => 'root@localhost.localdomain',\n>>>  19:      password        => \"password\",\n     20:      first_name      => 'Administrator',\n     21:      last_name       => ''}\n     22: \n     23:   aeolus::conductor::login{\"admin\": password => \"password\",\n     24:      require  => Aeolus::Conductor::Site_admin['admin']}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-qdr.pp", "content": "$qdr_username      = undef,", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-qdr.pp\n\n#   (Optional) The current step in deployment. See tripleo-heat-templates\n#   for more details.\n#   Defaults to hiera('step')\n#\nclass tripleo::profile::base::qdr (\n48:   $qdr_username      = undef,\n$qdr_password      = undef,\n$qdr_listener_port = hiera('tripleo::profile::base::qdr::qdr_listener_port', 5672),\n$qdr_log_enable    = hiera('tripleo::profile::base::qdr::qdr_log_enable', 'info+'),\n$oslomsg_rpc_hosts = hiera('oslo_messaging_rpc_node_names', undef),\n$step              = Integer(hiera('step')),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-qdr.pp\n# Target line: 48\n\n     43: #   (Optional) The current step in deployment. See tripleo-heat-templates\n     44: #   for more details.\n     45: #   Defaults to hiera('step')\n     46: #\n     47: class tripleo::profile::base::qdr (\n>>>  48:   $qdr_username      = undef,\n     49:   $qdr_password      = undef,\n     50:   $qdr_listener_port = hiera('tripleo::profile::base::qdr::qdr_listener_port', 5672),\n     51:   $qdr_log_enable    = hiera('tripleo::profile::base::qdr::qdr_log_enable', 'info+'),\n     52:   $oslomsg_rpc_hosts = hiera('oslo_messaging_rpc_node_names', undef),\n     53:   $step              = Integer(hiera('step')),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$read_database_username            = 'puppetdb'", "line": 57, "detection_span": [52, 62], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n# These settings are for the read database\n$read_database                     = 'postgres'\n$read_database_host                = undef\n$read_database_port                = '5432'\n$read_database_name                = 'puppetdb'\n57:   $read_database_username            = 'puppetdb'\n$read_database_password            = 'puppetdb'\n$read_database_jdbc_ssl_properties = ''\n$read_database_validate            = true\n$read_log_slow_statements          = '10'\n$read_conn_max_age                 = '60'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 57\n\n     52:   # These settings are for the read database\n     53:   $read_database                     = 'postgres'\n     54:   $read_database_host                = undef\n     55:   $read_database_port                = '5432'\n     56:   $read_database_name                = 'puppetdb'\n>>>  57:   $read_database_username            = 'puppetdb'\n     58:   $read_database_password            = 'puppetdb'\n     59:   $read_database_jdbc_ssl_properties = ''\n     60:   $read_database_validate            = true\n     61:   $read_log_slow_statements          = '10'\n     62:   $read_conn_max_age                 = '60'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-filesystem-backed-bricks-example.pp", "content": "uuid => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',", "line": 15, "detection_span": [10, 20], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-filesystem-backed-bricks-example.pp\n\nshorewall => true,\n}\n\ngluster::host { 'annex1.example.com':\n# use uuidgen to make these\n15: \t\tuuid => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n}\n\n# note that this is using a folder on your existing filesystem...\n# this can be useful for prototyping gluster using virtual machines\n# if this isn't a separate partition, remember that your root fs will", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-filesystem-backed-bricks-example.pp\n# Target line: 15\n\n     10: \t\tshorewall => true,\n     11: \t}\n     12: \n     13: \tgluster::host { 'annex1.example.com':\n     14: \t\t# use uuidgen to make these\n>>>  15: \t\tuuid => '1f660ca2-2c78-4aa0-8f4d-21608218c69c',\n     16: \t}\n     17: \n     18: \t# note that this is using a folder on your existing filesystem...\n     19: \t# this can be useful for prototyping gluster using virtual machines\n     20: \t# if this isn't a separate partition, remember that your root fs will\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-storage.pp", "content": "rbd_store_user => 'images',", "line": 83, "detection_span": [78, 88], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-storage.pp\n\n}\ncreate_resources('contrail::lib::storage_os_config', $pool_config, {})\nclass {'cinder::volume':}\n\nclass { 'glance::backend::rbd':\n83:     rbd_store_user => 'images',\nmulti_store    => true\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-storage.pp\n# Target line: 83\n\n     78:   }\n     79:   create_resources('contrail::lib::storage_os_config', $pool_config, {})\n     80:   class {'cinder::volume':}\n     81: \n     82:   class { 'glance::backend::rbd': \n>>>  83:     rbd_store_user => 'images',\n     84:     multi_store    => true\n     85:   }\n     86: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp", "content": "$ssl_key               = '/etc/mysql/server-key.pem'", "line": 112, "detection_span": [107, 117], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n\n$perl_package_name     = 'perl-DBD-mysql'\n$java_package_name     = 'mysql-connector-java'\n$root_group            = 'root'\n$ssl_ca                = '/etc/mysql/cacert.pem'\n$ssl_cert              = '/etc/mysql/server-cert.pem'\n112:       $ssl_key               = '/etc/mysql/server-key.pem'\n}\n114:\n'Debian': {\n$basedir              = '/usr'\n$datadir              = '/var/lib/mysql'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-mysql-manifests-params.pp\n# Target line: 112\n\n    107:       $perl_package_name     = 'perl-DBD-mysql'\n    108:       $java_package_name     = 'mysql-connector-java'\n    109:       $root_group            = 'root'\n    110:       $ssl_ca                = '/etc/mysql/cacert.pem'\n    111:       $ssl_cert              = '/etc/mysql/server-cert.pem'\n>>> 112:       $ssl_key               = '/etc/mysql/server-key.pem'\n    113:     }\n    114: \n    115:     'Debian': {\n    116:       $basedir              = '/usr'\n    117:       $datadir              = '/var/lib/mysql'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-trove-rabbitmq.pp", "content": "nova_proxy_admin_pass        => hiera('CONFIG_TROVE_NOVA_PW'),", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-trove-rabbitmq.pp\n\nrabbit_use_ssl               => hiera('CONFIG_AMQP_SSL_ENABLED'),\ndefault_transport_url        => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\ndatabase_connection          => \"mysql+pymysql://trove:${trove_rabmq_cfg_trove_db_pw}@${trove_rabmq_cfg_mariadb_host}/trove\",\nnova_proxy_admin_user        => hiera('CONFIG_TROVE_NOVA_USER'),\nnova_proxy_admin_tenant_name => hiera('CONFIG_TROVE_NOVA_TENANT'),\n33:       nova_proxy_admin_pass        => hiera('CONFIG_TROVE_NOVA_PW'),\nnova_compute_url             => \"http://${trove_rabmq_cfg_controller_host}:8774/v2\",\ncinder_url                   => \"http://${trove_rabmq_cfg_controller_host}:8776/v1\",\nswift_url                    => \"http://${trove_rabmq_cfg_controller_host}:8080/v1/AUTH_\",\nuse_neutron                  => hiera('CONFIG_NEUTRON_INSTALL'),\nkombu_ssl_ca_certs           => $kombu_ssl_ca_certs,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-trove-rabbitmq.pp\n# Target line: 33\n\n     28:       rabbit_use_ssl               => hiera('CONFIG_AMQP_SSL_ENABLED'),\n     29:       default_transport_url        => \"rabbit://${rabbit_userid}:${rabbit_password}@${rabbit_host}:${rabbit_port}/\",\n     30:       database_connection          => \"mysql+pymysql://trove:${trove_rabmq_cfg_trove_db_pw}@${trove_rabmq_cfg_mariadb_host}/trove\",\n     31:       nova_proxy_admin_user        => hiera('CONFIG_TROVE_NOVA_USER'),\n     32:       nova_proxy_admin_tenant_name => hiera('CONFIG_TROVE_NOVA_TENANT'),\n>>>  33:       nova_proxy_admin_pass        => hiera('CONFIG_TROVE_NOVA_PW'),\n     34:       nova_compute_url             => \"http://${trove_rabmq_cfg_controller_host}:8774/v2\",\n     35:       cinder_url                   => \"http://${trove_rabmq_cfg_controller_host}:8776/v1\",\n     36:       swift_url                    => \"http://${trove_rabmq_cfg_controller_host}:8080/v1/AUTH_\",\n     37:       use_neutron                  => hiera('CONFIG_NEUTRON_INSTALL'),\n     38:       kombu_ssl_ca_certs           => $kombu_ssl_ca_certs,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp", "content": "$qpid_password              = 'qpid_pw',", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n\n$rabbit_password            = 'rabbit_pw',\n$rabbit_host                = false,\n$rabbit_user                = 'nova',\n$rabbit_ha_virtual_ip       = false,\n$queue_provider             = 'rabbitmq',\n48:   $qpid_password              = 'qpid_pw',\n$qpid_user                  = 'nova',\n$qpid_nodes                 = ['127.0.0.1'],\n$log_facility               = 'LOG_LOCAL2',\n$rsync_group                = 'glance',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-swift-parts-storage_node.pp\n# Target line: 48\n\n     43:   $rabbit_password            = 'rabbit_pw',\n     44:   $rabbit_host                = false,\n     45:   $rabbit_user                = 'nova',\n     46:   $rabbit_ha_virtual_ip       = false,\n     47:   $queue_provider             = 'rabbitmq',\n>>>  48:   $qpid_password              = 'qpid_pw',\n     49:   $qpid_user                  = 'nova',\n     50:   $qpid_nodes                 = ['127.0.0.1'],\n     51:   $log_facility               = 'LOG_LOCAL2',\n     52:   $rsync_group                = 'glance',\n     53: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp", "content": "$db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n\n$db_name     = pick($neutron_db['db_name'], 'neutron')\n$db_password = pick($neutron_db['passwd'], $mysql_root_password)\n\n$db_host          = pick($neutron_db['db_host'], $database_vip)\n$db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n22:   $db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n$db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n\n$allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n\nvalidate_string($mysql_root_user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-db.pp\n# Target line: 22\n\n     17:   $db_name     = pick($neutron_db['db_name'], 'neutron')\n     18:   $db_password = pick($neutron_db['passwd'], $mysql_root_password)\n     19: \n     20:   $db_host          = pick($neutron_db['db_host'], $database_vip)\n     21:   $db_create        = pick($neutron_db['db_create'], $mysql_db_create)\n>>>  22:   $db_root_user     = pick($neutron_db['root_user'], $mysql_root_user)\n     23:   $db_root_password = pick($neutron_db['root_password'], $mysql_root_password)\n     24: \n     25:   $allowed_hosts = [ 'localhost', '127.0.0.1', '%' ]\n     26: \n     27:   validate_string($mysql_root_user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-dns-rndc_key.pp", "content": "$rndc_secret_admin         = undef,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n\nclass profile::dns::rndc_key (\n$create_admin_key          = false,\n$create_mdns_key           = false,\n$host_is_bind_server       = false,\n5:   $rndc_secret_admin         = undef,\n$rndc_secret_mdns          = undef\n)\n{\n\nif $create_admin_key {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n# Target line: 5\n\n      1: class profile::dns::rndc_key (\n      2:   $create_admin_key          = false,\n      3:   $create_mdns_key           = false,\n      4:   $host_is_bind_server       = false,\n>>>   5:   $rndc_secret_admin         = undef,\n      6:   $rndc_secret_mdns          = undef\n      7: )\n      8: {\n      9: \n     10:   if $create_admin_key {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp", "content": "key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n\nvalue => 'IsInstalled',\ntype  => dword,\ndata  => '0',\n}\nregistry::value { 'IE_ESC_admin':\n12:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}',\nvalue => 'IsInstalled',\ntype  => dword,\ndata  => '0',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-classroom-manifests-windows-disable_esc.pp\n# Target line: 12\n\n      7:     value => 'IsInstalled',\n      8:     type  => dword,\n      9:     data  => '0',\n     10:   }\n     11:   registry::value { 'IE_ESC_admin':\n>>>  12:     key   => 'hklm\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}',\n     13:     value => 'IsInstalled',\n     14:     type  => dword,\n     15:     data  => '0',\n     16:   }\n     17:   \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "djjudas21@puppet-freeradius-manifests-sql.pp", "content": "$login                       = 'radius',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: djjudas21@puppet-freeradius-manifests-sql.pp\n\n# Configure SQL support for FreeRADIUS\ndefine freeradius::sql (\n$database,\n$password,\n$server                      = 'localhost',\n6:   $login                       = 'radius',\n$radius_db                   = 'radius',\n$num_sql_socks               = '${thread[pool].max_servers}',\n$query_file                  = \"\\${modconfdir}/\\${.:name}/main/\\${dialect}/queries.conf\",\n$custom_query_file           = undef,\n$lifetime                    = '0',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: djjudas21@puppet-freeradius-manifests-sql.pp\n# Target line: 6\n\n      1: # Configure SQL support for FreeRADIUS\n      2: define freeradius::sql (\n      3:   $database,\n      4:   $password,\n      5:   $server                      = 'localhost',\n>>>   6:   $login                       = 'radius',\n      7:   $radius_db                   = 'radius',\n      8:   $num_sql_socks               = '${thread[pool].max_servers}',\n      9:   $query_file                  = \"\\${modconfdir}/\\${.:name}/main/\\${dialect}/queries.conf\",\n     10:   $custom_query_file           = undef,\n     11:   $lifetime                    = '0',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-db-sync.pp", "content": "user        => 'trove',", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: openstack@puppet-trove-manifests-db-sync.pp\n\n\ninclude ::trove::deps\n\nexec { 'trove-manage db_sync':\npath        => '/usr/bin',\n26:     user        => 'trove',\nrefreshonly => true,\ntry_sleep   => 5,\ntries       => 10,\nlogoutput   => on_failure,\nsubscribe   => [", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-db-sync.pp\n# Target line: 26\n\n     21: \n     22:   include ::trove::deps\n     23: \n     24:   exec { 'trove-manage db_sync':\n     25:     path        => '/usr/bin',\n>>>  26:     user        => 'trove',\n     27:     refreshonly => true,\n     28:     try_sleep   => 5,\n     29:     tries       => 10,\n     30:     logoutput   => on_failure,\n     31:     subscribe   => [\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_idomysql.pp", "content": "password => 'supersecret',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql.pp\n\ninclude ::mysql::server\n\nmysql::db { 'icinga2':\nuser     => 'icinga2',\n5:   password => 'supersecret',\nhost     => 'localhost',\ngrant    => ['SELECT', 'INSERT', 'UPDATE', 'DELETE', 'DROP', 'CREATE VIEW', 'CREATE', 'INDEX', 'EXECUTE', 'ALTER'],\n}\n\nclass { '::icinga2':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_idomysql.pp\n# Target line: 5\n\n      1: include ::mysql::server\n      2: \n      3: mysql::db { 'icinga2':\n      4:   user     => 'icinga2',\n>>>   5:   password => 'supersecret',\n      6:   host     => 'localhost',\n      7:   grant    => ['SELECT', 'INSERT', 'UPDATE', 'DELETE', 'DROP', 'CREATE VIEW', 'CREATE', 'INDEX', 'EXECUTE', 'ALTER'],\n      8: }\n      9: \n     10: class { '::icinga2':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan.pp", "content": "$smtp_username                  = undef,", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan.pp\n\n$gunicorn_worker_processes      = '1',\n$priority_worker_processes      = '0',\n$bulk_worker_processes          = '0',\n$enable_harvester_fetch         = false,\n$enable_harvester_gather        = false,\n52:   $smtp_username                  = undef,\n$smtp_password                  = undef,\n$smtp_hostname                  = undef,\n$s3_aws_access_key_id           = undef,\n$s3_aws_secret_access_key       = undef,\n$s3_bucket_name                 = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-ckan.pp\n# Target line: 52\n\n     47:   $gunicorn_worker_processes      = '1',\n     48:   $priority_worker_processes      = '0',\n     49:   $bulk_worker_processes          = '0',\n     50:   $enable_harvester_fetch         = false,\n     51:   $enable_harvester_gather        = false,\n>>>  52:   $smtp_username                  = undef,\n     53:   $smtp_password                  = undef,\n     54:   $smtp_hostname                  = undef,\n     55:   $s3_aws_access_key_id           = undef,\n     56:   $s3_aws_secret_access_key       = undef,\n     57:   $s3_bucket_name                 = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp", "content": "key    => 'openLinksInBackground',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n\n}\n\nboxen::osx_defaults { 'Open links in the background':\nuser   => $::luser,\ndomain => 'com.twitter.twitter-mac',\n13:     key    => 'openLinksInBackground',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Allow closing the \\'new tweet\\' window by pressing \\'Esc\\'':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-twitter.pp\n# Target line: 13\n\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Open links in the background':\n     11:     user   => $::luser,\n     12:     domain => 'com.twitter.twitter-mac',\n>>>  13:     key    => 'openLinksInBackground',\n     14:     type   => 'bool',\n     15:     value  => true,\n     16:   }\n     17: \n     18:   boxen::osx_defaults { 'Allow closing the \\'new tweet\\' window by pressing \\'Esc\\'':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-jeepyb-manifests-openstackwatch.pp", "content": "user    => 'openstackwatch',", "line": 62, "detection_span": [57, 67], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-jeepyb-manifests-openstackwatch.pp\n\ncron { 'openstackwatch':\nensure  => present,\ncommand => '/usr/local/bin/openstackwatch /home/openstackwatch/openstackwatch.ini',\nminute  => $minute,\nhour    => $hour,\n62:       user    => 'openstackwatch',\nrequire => [\nFile['/home/openstackwatch/openstackwatch.ini'],\nUser['openstackwatch'],\nClass['jeepyb'],\n],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-jeepyb-manifests-openstackwatch.pp\n# Target line: 62\n\n     57:     cron { 'openstackwatch':\n     58:       ensure  => present,\n     59:       command => '/usr/local/bin/openstackwatch /home/openstackwatch/openstackwatch.ini',\n     60:       minute  => $minute,\n     61:       hour    => $hour,\n>>>  62:       user    => 'openstackwatch',\n     63:       require => [\n     64:         File['/home/openstackwatch/openstackwatch.ini'],\n     65:         User['openstackwatch'],\n     66:         Class['jeepyb'],\n     67:       ],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-dns-rndc_key.pp", "content": "$create_mdns_key           = false,", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n\nclass profile::dns::rndc_key (\n$create_admin_key          = false,\n3:   $create_mdns_key           = false,\n$host_is_bind_server       = false,\n$rndc_secret_admin         = undef,\n$rndc_secret_mdns          = undef\n)\n{", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-dns-rndc_key.pp\n# Target line: 3\n\n      1: class profile::dns::rndc_key (\n      2:   $create_admin_key          = false,\n>>>   3:   $create_mdns_key           = false,\n      4:   $host_is_bind_server       = false,\n      5:   $rndc_secret_admin         = undef,\n      6:   $rndc_secret_mdns          = undef\n      7: )\n      8: {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-manifests-plugins-plumgrid.pp", "content": "'PLUMgridDirector/password':             value => $password, secret =>true;", "line": 173, "detection_span": [168, 178], "with_context": "# Puppet file: openstack@puppet-neutron-manifests-plugins-plumgrid.pp\n\n168:\n169:   neutron_plugin_plumgrid {\n'PLUMgridDirector/director_server':      value => $director_server;\n'PLUMgridDirector/director_server_port': value => $director_server_port;\n'PLUMgridDirector/username':             value => $username;\n173:     'PLUMgridDirector/password':             value => $password, secret =>true;\n'PLUMgridDirector/servertimeout':        value => $servertimeout;\n'database/connection':                   value => $connection;\n'l2gateway/vendor':                      value => $l2gateway_vendor;\n'l2gateway/sw_username':                 value => $l2gateway_sw_username;\n'l2gateway/sw_password':                 value => $l2gateway_sw_password, secret =>true;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-manifests-plugins-plumgrid.pp\n# Target line: 173\n\n    168: \n    169:   neutron_plugin_plumgrid {\n    170:     'PLUMgridDirector/director_server':      value => $director_server;\n    171:     'PLUMgridDirector/director_server_port': value => $director_server_port;\n    172:     'PLUMgridDirector/username':             value => $username;\n>>> 173:     'PLUMgridDirector/password':             value => $password, secret =>true;\n    174:     'PLUMgridDirector/servertimeout':        value => $servertimeout;\n    175:     'database/connection':                   value => $connection;\n    176:     'l2gateway/vendor':                      value => $l2gateway_vendor;\n    177:     'l2gateway/sw_username':                 value => $l2gateway_sw_username;\n    178:     'l2gateway/sw_password':                 value => $l2gateway_sw_password, secret =>true;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-repo-apt_postgresql_org.pp", "content": "key_source        => 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-repo-apt_postgresql_org.pp\n\napt::source { 'apt.postgresql.org':\nlocation          => 'http://apt.postgresql.org/pub/repos/apt/',\nrelease           => \"${::lsbdistcodename}-pgdg\",\nrepos             => \"main ${version}\",\nkey               => 'ACCC4CF8',\n17:       key_source        => 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc',\ninclude_src       => false,\n}\n\nApt::Source['apt.postgresql.org']->Package<|tag == 'postgresql'|>\n} else {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-repo-apt_postgresql_org.pp\n# Target line: 17\n\n     12:     apt::source { 'apt.postgresql.org':\n     13:       location          => 'http://apt.postgresql.org/pub/repos/apt/',\n     14:       release           => \"${::lsbdistcodename}-pgdg\",\n     15:       repos             => \"main ${version}\",\n     16:       key               => 'ACCC4CF8',\n>>>  17:       key_source        => 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc',\n     18:       include_src       => false,\n     19:     }\n     20: \n     21:     Apt::Source['apt.postgresql.org']->Package<|tag == 'postgresql'|>\n     22:   } else {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-finder.pp", "content": "key    => '_FXShowPosixPathInTitle',", "line": 62, "detection_span": [57, 67], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n\n}\n\nboxen::osx_defaults { 'Display full POSIX path as Finder window title':\nuser   => $::luser,\ndomain => 'com.apple.finder',\n62:     key    => '_FXShowPosixPathInTitle',\ntype   => 'bool',\nvalue  => true,\n}\n\nboxen::osx_defaults { 'Allow quitting via \u2318 + Q; doing so will also hide desktop icons':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n# Target line: 62\n\n     57:   }\n     58: \n     59:   boxen::osx_defaults { 'Display full POSIX path as Finder window title':\n     60:     user   => $::luser,\n     61:     domain => 'com.apple.finder',\n>>>  62:     key    => '_FXShowPosixPathInTitle',\n     63:     type   => 'bool',\n     64:     value  => true,\n     65:   }\n     66: \n     67:   boxen::osx_defaults { 'Allow quitting via \u2318 + Q; doing so will also hide desktop icons':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-mysql-manifests-server-master.pp", "content": "$debian_sys_maint_password = undef", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-mysql-manifests-server-master.pp\n\nclass mysql::server::master (\n$replication_id,\n$server_id,\n$replication_password = undef,\n$root_password = undef,\n6:   $debian_sys_maint_password = undef\n) {\n\n@@mysql::server::instance { $replication_id:\nroot_password             => $root_password,\ndebian_sys_maint_password => $debian_sys_maint_password,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-mysql-manifests-server-master.pp\n# Target line: 6\n\n      1: class mysql::server::master (\n      2:   $replication_id,\n      3:   $server_id,\n      4:   $replication_password = undef,\n      5:   $root_password = undef,\n>>>   6:   $debian_sys_maint_password = undef\n      7: ) {\n      8: \n      9:   @@mysql::server::instance { $replication_id:\n     10:     root_password             => $root_password,\n     11:     debian_sys_maint_password => $debian_sys_maint_password,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-puppetdb-manifests-params.pp", "content": "$ssl_set_cert_paths       = false", "line": 176, "detection_span": [171, 181], "with_context": "# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n\n171:   $automatic_dlo_cleanup    = true\n172:   # any value for a systemd timer is valid: https://www.freedesktop.org/software/systemd/man/systemd.time.html\n173:   $cleanup_timer_interval   = \"*-*-* ${fqdn_rand(24)}:${fqdn_rand(60)}:00\"\n$dlo_max_age              = 90\n175:\n176:   $ssl_set_cert_paths       = false\n$ssl_cert_path            = \"${ssl_dir}/public.pem\"\n$ssl_key_path             = \"${ssl_dir}/private.pem\"\n$ssl_ca_cert_path         = \"${ssl_dir}/ca.pem\"\n$ssl_deploy_certs         = false\n$ssl_key                  = undef", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-puppetdb-manifests-params.pp\n# Target line: 176\n\n    171:   $automatic_dlo_cleanup    = true\n    172:   # any value for a systemd timer is valid: https://www.freedesktop.org/software/systemd/man/systemd.time.html\n    173:   $cleanup_timer_interval   = \"*-*-* ${fqdn_rand(24)}:${fqdn_rand(60)}:00\"\n    174:   $dlo_max_age              = 90\n    175: \n>>> 176:   $ssl_set_cert_paths       = false\n    177:   $ssl_cert_path            = \"${ssl_dir}/public.pem\"\n    178:   $ssl_key_path             = \"${ssl_dir}/private.pem\"\n    179:   $ssl_ca_cert_path         = \"${ssl_dir}/ca.pem\"\n    180:   $ssl_deploy_certs         = false\n    181:   $ssl_key                  = undef\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp", "content": "key    => 'maxHistorySize',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n\nclass people::felho::application_settings::clipmenu {\nboxen::osx_defaults { 'Clipmenu maxHistorySize':\nuser   => $::luser,\ndomain => 'com.naotaka.ClipMenu',\n5:     key    => 'maxHistorySize',\nvalue  => 300,\n}\n\nboxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInline':\nuser   => $::luser,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-clipmenu.pp\n# Target line: 5\n\n      1: class people::felho::application_settings::clipmenu {\n      2:   boxen::osx_defaults { 'Clipmenu maxHistorySize':\n      3:     user   => $::luser,\n      4:     domain => 'com.naotaka.ClipMenu',\n>>>   5:     key    => 'maxHistorySize',\n      6:     value  => 300,\n      7:   }\n      8: \n      9:   boxen::osx_defaults { 'Clipmenu numberOfItemsPlaceInline':\n     10:     user   => $::luser,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-icinga-manifests-plugin-check_rabbitmq_consumers.pp", "content": "class icinga::plugin::check_rabbitmq_consumers ($monitoring_password = ''){", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-plugin-check_rabbitmq_consumers.pp\n\n# == Class: icinga::plugin::check_rabbitmq_consumers\n#\n# Install a Nagios plugin that alerts when a rabbitmq consumer\n# has not recieved a heartbeat within the last 5 minutes\n#\n6: class icinga::plugin::check_rabbitmq_consumers ($monitoring_password = ''){\n\n@icinga::plugin { 'check_rabbitmq_consumers':\nsource  => 'puppet:///modules/icinga/usr/lib/nagios/plugins/check_rabbitmq_consumers',\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-icinga-manifests-plugin-check_rabbitmq_consumers.pp\n# Target line: 6\n\n      1: # == Class: icinga::plugin::check_rabbitmq_consumers\n      2: #\n      3: # Install a Nagios plugin that alerts when a rabbitmq consumer\n      4: # has not recieved a heartbeat within the last 5 minutes\n      5: #\n>>>   6: class icinga::plugin::check_rabbitmq_consumers ($monitoring_password = ''){\n      7: \n      8:   @icinga::plugin { 'check_rabbitmq_consumers':\n      9:     source  => 'puppet:///modules/icinga/usr/lib/nagios/plugins/check_rabbitmq_consumers',\n     10:   }\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp", "content": "$oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n\n$nginx_kibana_service_fqdn    = 'logs.fuel-infra.org',\n$nginx_log_format             = undef,\n$oauth_access_file            = '/etc/nginx/oauth-access.lua',\n$oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n$oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n38:   $oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n$oauth_domain                 = 'domain.com',\n$oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n$ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n$ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n$ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-log_storage-manifests-storage-nginx.pp\n# Target line: 38\n\n     33:   $nginx_kibana_service_fqdn    = 'logs.fuel-infra.org',\n     34:   $nginx_log_format             = undef,\n     35:   $oauth_access_file            = '/etc/nginx/oauth-access.lua',\n     36:   $oauth_body_filter_file       = '/etc/nginx/oauth-body-filter.lua',\n     37:   $oauth_client_id              = '1002312874186-t277tpb8nrlht9f897uri0p8ub9qanep.apps.googleusercontent.com',\n>>>  38:   $oauth_client_secret          = 'F4m3S4YwqJLLNzgXzmHEAFd2',\n     39:   $oauth_domain                 = 'domain.com',\n     40:   $oauth_token_secret           = 'HfihgighoghGFjfodfjOJgEwew9pfjoheughfi2wweifoef',\n     41:   $ssl_elastic_certificate_file = '/etc/nginx/ssl_elastic.crt',\n     42:   $ssl_elastic_certificate      = $log_storage::params::nginx_ssl_elastic_certificate,\n     43:   $ssl_elastic_key_file         = '/etc/nginx/ssl_elastic.key',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-mysql-examples-mysql_db.pp", "content": "password => 'mypass',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n\nclass { 'mysql::server':\nroot_password => 'password'\n}\nmysql::db { 'mydb':\nuser     => 'myuser',\n6:   password => 'mypass',\nhost     => 'localhost',\ngrant    => ['SELECT', 'UPDATE'],\n}\nmysql::db { \"mydb_${fqdn}\":\nuser     => 'myuser',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n# Target line: 6\n\n      1: class { 'mysql::server':\n      2:   root_password => 'password'\n      3: }\n      4: mysql::db { 'mydb':\n      5:   user     => 'myuser',\n>>>   6:   password => 'mypass',\n      7:   host     => 'localhost',\n      8:   grant    => ['SELECT', 'UPDATE'],\n      9: }\n     10: mysql::db { \"mydb_${fqdn}\":\n     11:   user     => 'myuser',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-ci-params.pp", "content": "$ci_user                    = 'gitlab_ci'", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n\n#\n#\nclass gitlab::ci::params {\n\n$ensure                     = 'present'\n7:   $ci_user                    = 'gitlab_ci'\n$ci_home                    = '/home/gitlab_ci'\n$ci_comment                 = 'GitLab CI'\n$ci_email                   = 'gitlab-ci@localhost'\n$ci_support_email           = 'support@localhost'\n$gitlabci_sources           = 'git://github.com/gitlabhq/gitlab-ci.git'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-ci-params.pp\n# Target line: 7\n\n      2: #\n      3: #\n      4: class gitlab::ci::params {\n      5: \n      6:   $ensure                     = 'present'\n>>>   7:   $ci_user                    = 'gitlab_ci'\n      8:   $ci_home                    = '/home/gitlab_ci'\n      9:   $ci_comment                 = 'GitLab CI'\n     10:   $ci_email                   = 'gitlab-ci@localhost'\n     11:   $ci_support_email           = 'support@localhost'\n     12:   $gitlabci_sources           = 'git://github.com/gitlabhq/gitlab-ci.git'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-postgresql-manifests-validate_db_connection.pp", "content": "$database_password = undef,", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-validate_db_connection.pp\n\n#\n# See README.md for more details.\ndefine postgresql::validate_db_connection(\n$database_host     = undef,\n$database_name     = undef,\n9:   $database_password = undef,\n$database_username = undef,\n$database_port     = undef,\n$connect_settings  = undef,\n$run_as            = undef,\n$sleep             = 2,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-postgresql-manifests-validate_db_connection.pp\n# Target line: 9\n\n      4: #\n      5: # See README.md for more details.\n      6: define postgresql::validate_db_connection(\n      7:   $database_host     = undef,\n      8:   $database_name     = undef,\n>>>   9:   $database_password = undef,\n     10:   $database_username = undef,\n     11:   $database_port     = undef,\n     12:   $connect_settings  = undef,\n     13:   $run_as            = undef,\n     14:   $sleep             = 2,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp", "content": "$nailgun_db_user          = 'nailgun'", "line": 22, "detection_span": [17, 27], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n\n$db_port                  = '5432'\n\n$debug                    = false\n\n$nailgun_db_name          = 'nailgun'\n22:   $nailgun_db_user          = 'nailgun'\n$nailgun_db_password      = 'nailgun'\n\n$keystone_db_name         = 'keystone'\n$keystone_db_user         = 'keystone'\n$keystone_db_password     = 'keystone'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-params.pp\n# Target line: 22\n\n     17:   $db_port                  = '5432'\n     18: \n     19:   $debug                    = false\n     20: \n     21:   $nailgun_db_name          = 'nailgun'\n>>>  22:   $nailgun_db_user          = 'nailgun'\n     23:   $nailgun_db_password      = 'nailgun'\n     24: \n     25:   $keystone_db_name         = 'keystone'\n     26:   $keystone_db_user         = 'keystone'\n     27:   $keystone_db_password     = 'keystone'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "biemond@biemond-wildfly-manifests-undertow-https.pp", "content": "$key_password = undef,", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: biemond@biemond-wildfly-manifests-undertow-https.pp\n\n$socket_binding = undef,\n$keystore_path = undef,\n$keystore_relative_to = undef,\n$keystore_password = undef,\n$key_alias = undef,\n10:   $key_password = undef,\n$target_profile = undef,\n$enabled_protocols = undef,\n$enabled_cipher_suites = undef) {\n\nif versioncmp($wildfly::version,'9.0.0') >= 0 {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: biemond@biemond-wildfly-manifests-undertow-https.pp\n# Target line: 10\n\n      5:   $socket_binding = undef,\n      6:   $keystore_path = undef,\n      7:   $keystore_relative_to = undef,\n      8:   $keystore_password = undef,\n      9:   $key_alias = undef,\n>>>  10:   $key_password = undef,\n     11:   $target_profile = undef,\n     12:   $enabled_protocols = undef,\n     13:   $enabled_cipher_suites = undef) {\n     14: \n     15:   if versioncmp($wildfly::version,'9.0.0') >= 0 {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cargomedia@puppet-packages-modules-mms-manifests-agent-backup.pp", "content": "user    => 'mongodb-mms-agent',", "line": 36, "detection_span": [31, 41], "with_context": "# Puppet file: cargomedia@puppet-packages-modules-mms-manifests-agent-backup.pp\n\n->\n\ndaemon { $agent_name:\nbinary  => \"/usr/bin/mongodb-${agent_name}-agent\",\nargs    => \"-c ${config_file}\",\n36:     user    => 'mongodb-mms-agent',\nrequire => File[$config_file],\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: cargomedia@puppet-packages-modules-mms-manifests-agent-backup.pp\n# Target line: 36\n\n     31:   ->\n     32: \n     33:   daemon { $agent_name:\n     34:     binary  => \"/usr/bin/mongodb-${agent_name}-agent\",\n     35:     args    => \"-c ${config_file}\",\n>>>  36:     user    => 'mongodb-mms-agent',\n     37:     require => File[$config_file],\n     38:   }\n     39: \n     40: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-openstack-manifests-resources-user.pp", "content": "$admin   = false,", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-user.pp\n\ndefine openstack::resources::user (\n$password,\n$tenant,\n$email,\n5:   $admin   = false,\n$enabled = true,\n) {\nkeystone_user { $name:\nensure   => present,\nenabled  => $enabled,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-openstack-manifests-resources-user.pp\n# Target line: 5\n\n      1: define openstack::resources::user (\n      2:   $password,\n      3:   $tenant,\n      4:   $email,\n>>>   5:   $admin   = false,\n      6:   $enabled = true,\n      7: ) {\n      8:   keystone_user { $name:\n      9:     ensure   => present,\n     10:     enabled  => $enabled,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-netapp.pp", "content": "netapp_password                 => hiera('cinder::backend::netapp::netapp_password', undef),", "line": 55, "detection_span": [50, 60], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-netapp.pp\n\n$netapp_pool_name_search_pattern_fallback = undef\n}\ncinder::backend::netapp { $backend_name :\nbackend_availability_zone       => hiera('cinder::backend::netapp::backend_availability_zone', undef),\nnetapp_login                    => hiera('cinder::backend::netapp::netapp_login', undef),\n55:       netapp_password                 => hiera('cinder::backend::netapp::netapp_password', undef),\nnetapp_server_hostname          => hiera('cinder::backend::netapp::netapp_server_hostname', undef),\nnetapp_server_port              => hiera('cinder::backend::netapp::netapp_server_port', undef),\nnetapp_size_multiplier          => hiera('cinder::backend::netapp::netapp_size_multiplier', undef),\nnetapp_storage_family           => hiera('cinder::backend::netapp::netapp_storage_family', undef),\nnetapp_storage_protocol         => hiera('cinder::backend::netapp::netapp_storage_protocol', undef),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-netapp.pp\n# Target line: 55\n\n     50:       $netapp_pool_name_search_pattern_fallback = undef\n     51:     }\n     52:     cinder::backend::netapp { $backend_name :\n     53:       backend_availability_zone       => hiera('cinder::backend::netapp::backend_availability_zone', undef),\n     54:       netapp_login                    => hiera('cinder::backend::netapp::netapp_login', undef),\n>>>  55:       netapp_password                 => hiera('cinder::backend::netapp::netapp_password', undef),\n     56:       netapp_server_hostname          => hiera('cinder::backend::netapp::netapp_server_hostname', undef),\n     57:       netapp_server_port              => hiera('cinder::backend::netapp::netapp_server_port', undef),\n     58:       netapp_size_multiplier          => hiera('cinder::backend::netapp::netapp_size_multiplier', undef),\n     59:       netapp_storage_family           => hiera('cinder::backend::netapp::netapp_storage_family', undef),\n     60:       netapp_storage_protocol         => hiera('cinder::backend::netapp::netapp_storage_protocol', undef),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-mysql_mon.pp", "content": "key     => 'mysql.status[*]',", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-mysql_mon.pp\n\napi      => $plugin_zabbix::monitoring::api_hash,\n}\n\nplugin_zabbix::agent::userparameter {\n'mysql.status':\n30:         key     => 'mysql.status[*]',\ncommand => join([\n'echo \"show global status where Variable_name=\\'$1\\';\"',\n' | mysql --defaults-extra-file=/var/lib/zabbix/.my.cnf -N',\n' | awk \\'{print $$2}\\''], '');\n'mysql.ping':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-mysql_mon.pp\n# Target line: 30\n\n     25:       api      => $plugin_zabbix::monitoring::api_hash,\n     26:     }\n     27: \n     28:     plugin_zabbix::agent::userparameter {\n     29:       'mysql.status':\n>>>  30:         key     => 'mysql.status[*]',\n     31:         command => join([\n     32:           'echo \"show global status where Variable_name=\\'$1\\';\"',\n     33:           ' | mysql --defaults-extra-file=/var/lib/zabbix/.my.cnf -N',\n     34:           ' | awk \\'{print $$2}\\''], '');\n     35:       'mysql.ping':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fraenki@puppet-galera-manifests-debian.pp", "content": "user       => 'debian-sys-maint@localhost',", "line": 66, "detection_span": [61, 71], "with_context": "# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n\nmysql_grant { 'debian-sys-maint@localhost/*.*':\nensure     => 'present',\noptions    => ['GRANT'],\nprivileges => ['ALL'],\ntable      => '*.*',\n66:       user       => 'debian-sys-maint@localhost',\n}\n\nfile { '/etc/mysql/debian.cnf':\nensure  => present,\nowner   => 'root',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fraenki@puppet-galera-manifests-debian.pp\n# Target line: 66\n\n     61:     mysql_grant { 'debian-sys-maint@localhost/*.*':\n     62:       ensure     => 'present',\n     63:       options    => ['GRANT'],\n     64:       privileges => ['ALL'],\n     65:       table      => '*.*',\n>>>  66:       user       => 'debian-sys-maint@localhost',\n     67:     }\n     68: \n     69:     file { '/etc/mysql/debian.cnf':\n     70:       ensure  => present,\n     71:       owner   => 'root',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-ssh_key.pp", "content": "$jenkins_user   = 'jenkins',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-ssh_key.pp\n\n#   AWS SSH key config ID (visible in AWS console).\n#\nclass govuk_jenkins::ssh_key (\n$private_key    = undef,\n$public_key     = undef,\n25:   $jenkins_user   = 'jenkins',\n$home_dir       = '/var/lib/jenkins',\n$aws_ssh_key_id = undef,\n) {\n$ssh_dir = \"${home_dir}/.ssh\"\n$private_key_filename = \"${ssh_dir}/id_rsa\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-ssh_key.pp\n# Target line: 25\n\n     20: #   AWS SSH key config ID (visible in AWS console).\n     21: #\n     22: class govuk_jenkins::ssh_key (\n     23:   $private_key    = undef,\n     24:   $public_key     = undef,\n>>>  25:   $jenkins_user   = 'jenkins',\n     26:   $home_dir       = '/var/lib/jenkins',\n     27:   $aws_ssh_key_id = undef,\n     28: ) {\n     29:   $ssh_dir = \"${home_dir}/.ssh\"\n     30:   $private_key_filename = \"${ssh_dir}/id_rsa\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "key      => 'D88E42B4';", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nrepos    => ['stable'],\nkey      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n'elasticsearch-1.4':\nlocation => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\nrelease  => 'stable',\n52:       key      => 'D88E42B4';\n'elasticsearch-1.5':\nlocation => 'http://packages.elastic.co/elasticsearch/1.5/debian',\nrelease  => 'stable',\nkey      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n'elasticsearch-1.7':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 52\n\n     47:       repos    => ['stable'],\n     48:       key      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n     49:     'elasticsearch-1.4':\n     50:       location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\n     51:       release  => 'stable',\n>>>  52:       key      => 'D88E42B4';\n     53:     'elasticsearch-1.5':\n     54:       location => 'http://packages.elastic.co/elasticsearch/1.5/debian',\n     55:       release  => 'stable',\n     56:       key      => '46095ACC8548582C1A2699A9D27D666CD88E42B4';\n     57:     'elasticsearch-1.7':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "bodepd@puppetlabs-openstack-examples-site.pp", "content": "$nova_user_password      = 'nova_pass'", "line": 28, "detection_span": [23, 33], "with_context": "# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n\n$admin_email             = 'root@localhost'\n$admin_password          = 'keystone_admin'\n$keystone_db_password    = 'keystone_db_pass'\n$keystone_admin_token    = 'keystone_admin_token'\n$nova_db_password        = 'nova_pass'\n28: $nova_user_password      = 'nova_pass'\n$glance_db_password      = 'glance_pass'\n$glance_user_password    = 'glance_pass'\n$rabbit_password         = 'openstack_rabbit_password'\n$rabbit_user             = 'openstack_rabbit_user'\n$fixed_network_range     = '10.0.0.0/24'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bodepd@puppetlabs-openstack-examples-site.pp\n# Target line: 28\n\n     23: $admin_email             = 'root@localhost'\n     24: $admin_password          = 'keystone_admin'\n     25: $keystone_db_password    = 'keystone_db_pass'\n     26: $keystone_admin_token    = 'keystone_admin_token'\n     27: $nova_db_password        = 'nova_pass'\n>>>  28: $nova_user_password      = 'nova_pass'\n     29: $glance_db_password      = 'glance_pass'\n     30: $glance_user_password    = 'glance_pass'\n     31: $rabbit_password         = 'openstack_rabbit_password'\n     32: $rabbit_user             = 'openstack_rabbit_user'\n     33: $fixed_network_range     = '10.0.0.0/24'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "CiscoSystems@puppet-openstack-manifests-compute.pp", "content": "$nova_user_password  = 'nova_pass',", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n\n$multi_host          = false,\n$network_config      = {},\n# my address\n# conection information\n$sql_connection      = false,\n59:   $nova_user_password  = 'nova_pass',\n$rabbit_host         = false,\n$rabbit_password     = 'rabbit_pw',\n$rabbit_user         = 'nova',\n$glance_api_servers  = false,\n# nova compute configuration parameters", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: CiscoSystems@puppet-openstack-manifests-compute.pp\n# Target line: 59\n\n     54:   $multi_host          = false,\n     55:   $network_config      = {},\n     56:   # my address\n     57:   # conection information\n     58:   $sql_connection      = false,\n>>>  59:   $nova_user_password  = 'nova_pass',\n     60:   $rabbit_host         = false,\n     61:   $rabbit_password     = 'rabbit_pw',\n     62:   $rabbit_user         = 'nova',\n     63:   $glance_api_servers  = false,\n     64:   # nova compute configuration parameters\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp", "content": "www_root             => '/opt/spotlight/shared/assets',", "line": 31, "detection_span": [26, 36], "with_context": "# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n\nlocation             => '/spotlight/',\nrewrite_rules        => [\n'^/spotlight(.*)$ $1 break'\n],\nvhost                => $::assets_internal_vhost,\n31:     www_root             => '/opt/spotlight/shared/assets',\nlocation_cfg_prepend => {\n'expires' => '30d',\n},\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@pp-puppet-modules-performanceplatform-manifests-assets.pp\n# Target line: 31\n\n     26:     location             => '/spotlight/',\n     27:     rewrite_rules        => [\n     28:       '^/spotlight(.*)$ $1 break'\n     29:     ],\n     30:     vhost                => $::assets_internal_vhost,\n>>>  31:     www_root             => '/opt/spotlight/shared/assets',\n     32:     location_cfg_prepend => {\n     33:       'expires' => '30d',\n     34:     },\n     35:   }\n     36: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "duritong@puppet-tor-manifests-daemon-params.pp", "content": "$manage_user   = false", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n\nclass tor::daemon::params {\ncase $facts['osfamily'] {\n'RedHat': {\n$user          = 'toranon'\n$group         = 'toranon'\n7:       $manage_user   = false\n$data_dir_mode = '0750'\n}\n'Debian': {\n$user          = 'debian-tor'\n$group         = 'debian-tor'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-tor-manifests-daemon-params.pp\n# Target line: 7\n\n      2: class tor::daemon::params {\n      3:   case $facts['osfamily'] {\n      4:     'RedHat': {\n      5:       $user          = 'toranon'\n      6:       $group         = 'toranon'\n>>>   7:       $manage_user   = false\n      8:       $data_dir_mode = '0750'\n      9:     }\n     10:     'Debian': {\n     11:       $user          = 'debian-tor'\n     12:       $group         = 'debian-tor'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-haproxy-manifests-params.pp", "content": "$global_options   = {", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-haproxy-manifests-params.pp\n\n#\nclass haproxy::params {\ncase $::osfamily {\n'Archlinux', 'Debian', 'RedHat': {\n$package_name     = 'haproxy'\n11:       $global_options   = {\n'log'     => \"${::ipaddress} local0\",\n'chroot'  => '/var/lib/haproxy',\n'pidfile' => '/var/run/haproxy.pid',\n'maxconn' => '4000',\n'user'    => 'haproxy',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-haproxy-manifests-params.pp\n# Target line: 11\n\n      6: #\n      7: class haproxy::params {\n      8:   case $::osfamily {\n      9:     'Archlinux', 'Debian', 'RedHat': {\n     10:       $package_name     = 'haproxy'\n>>>  11:       $global_options   = {\n     12:         'log'     => \"${::ipaddress} local0\",\n     13:         'chroot'  => '/var/lib/haproxy',\n     14:         'pidfile' => '/var/run/haproxy.pid',\n     15:         'maxconn' => '4000',\n     16:         'user'    => 'haproxy',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Automattic@vip-quickstart-puppet-manifests-sections-webserver.pp", "content": "docroot    => '/srv/www',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: Automattic@vip-quickstart-puppet-manifests-sections-webserver.pp\n\nclient_max_body_size => '1024m',\ntypes_hash_max_size  => '2048',\n}\n\nnginx::vhost { '_':\n9:   docroot    => '/srv/www',\ntemplate   => 'nginx/vip.dev.erb',\nowner      => 'www-data',\ngroupowner => 'www-data',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Automattic@vip-quickstart-puppet-manifests-sections-webserver.pp\n# Target line: 9\n\n      4:   client_max_body_size => '1024m',\n      5:   types_hash_max_size  => '2048',\n      6: }\n      7: \n      8: nginx::vhost { '_':\n>>>   9:   docroot    => '/srv/www',\n     10:   template   => 'nginx/vip.dev.erb',\n     11:   owner      => 'www-data',\n     12:   groupowner => 'www-data',\n     13: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-vulnerabilities-unix-webapp-onlinestore-manifests-install.pp", "content": "$docroot = '/var/www/onlinestore'", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-webapp-onlinestore-manifests-install.pp\n\n$murderer_id = $secgen_parameters['murderer_id'][0]\n$murdered_on = $secgen_parameters['murdered_on']\n$murdered_ids = $secgen_parameters['murdered_ids']\n$db_password = $secgen_parameters['db_password'][0]\n\n18:   $docroot = '/var/www/onlinestore'\n$db_username = 'csecvm'\n\nExec { path => ['/bin', '/usr/bin', '/usr/local/bin', '/sbin', '/usr/sbin'], }\n\nfile { \"$docroot/index.html\":", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-vulnerabilities-unix-webapp-onlinestore-manifests-install.pp\n# Target line: 18\n\n     13:   $murderer_id = $secgen_parameters['murderer_id'][0]\n     14:   $murdered_on = $secgen_parameters['murdered_on']\n     15:   $murdered_ids = $secgen_parameters['murdered_ids']\n     16:   $db_password = $secgen_parameters['db_password'][0]\n     17: \n>>>  18:   $docroot = '/var/www/onlinestore'\n     19:   $db_username = 'csecvm'\n     20: \n     21:   Exec { path => ['/bin', '/usr/bin', '/usr/local/bin', '/sbin', '/usr/sbin'], }\n     22: \n     23:   file { \"$docroot/index.html\":\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-check_sentry_errors.pp", "content": "$sentry_auth_token = undef,", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-check_sentry_errors.pp\n\n# == Class: govuk_jenkins::jobs::check_sentry_errors\n#\n# Create a file on disk that can be parsed by jenkins-job-builder\n#\nclass govuk_jenkins::jobs::check_sentry_errors (\n6:   $sentry_auth_token = undef,\n) {\nfile { '/etc/jenkins_jobs/jobs/check_sentry_errors.yaml':\nensure  => present,\ncontent => template('govuk_jenkins/jobs/check_sentry_errors.yaml.erb'),\nnotify  => Exec['jenkins_jobs_update'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-check_sentry_errors.pp\n# Target line: 6\n\n      1: # == Class: govuk_jenkins::jobs::check_sentry_errors\n      2: #\n      3: # Create a file on disk that can be parsed by jenkins-job-builder\n      4: #\n      5: class govuk_jenkins::jobs::check_sentry_errors (\n>>>   6:   $sentry_auth_token = undef,\n      7: ) {\n      8:   file { '/etc/jenkins_jobs/jobs/check_sentry_errors.yaml':\n      9:     ensure  => present,\n     10:     content => template('govuk_jenkins/jobs/check_sentry_errors.yaml.erb'),\n     11:     notify  => Exec['jenkins_jobs_update'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-quota.pp", "content": "$max_backups_per_user     = undef,", "line": 52, "detection_span": [47, 57], "with_context": "# Puppet file: openstack@puppet-trove-manifests-quota.pp\n\n$max_backups_per_tenant   = 50,\n$quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n# Deprecated\n$max_instances_per_user   = undef,\n$max_volumes_per_user     = undef,\n52:   $max_backups_per_user     = undef,\n) {\n\ninclude ::trove::deps\n\nif $max_instances_per_user {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-quota.pp\n# Target line: 52\n\n     47:   $max_backups_per_tenant   = 50,\n     48:   $quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n     49:   # Deprecated\n     50:   $max_instances_per_user   = undef,\n     51:   $max_volumes_per_user     = undef,\n>>>  52:   $max_backups_per_user     = undef,\n     53: ) {\n     54: \n     55:   include ::trove::deps\n     56: \n     57:   if $max_instances_per_user {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-user_monitor.pp", "content": "$github_token = undef,", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-user_monitor.pp\n\n#\n# [*github_token*]\n#   A GitHub access token with the `read:org` permissions\n#\nclass govuk_jenkins::jobs::user_monitor (\n11:   $github_token = undef,\n$app_domain = hiera('app_domain'),\n) {\n\n$service_description = 'Check that correct users have access'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-user_monitor.pp\n# Target line: 11\n\n      6: #\n      7: # [*github_token*]\n      8: #   A GitHub access token with the `read:org` permissions\n      9: #\n     10: class govuk_jenkins::jobs::user_monitor (\n>>>  11:   $github_token = undef,\n     12:   $app_domain = hiera('app_domain'),\n     13: ) {\n     14: \n     15:   $service_description = 'Check that correct users have access'\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-integration_deploy.pp", "content": "$jenkins_integration_aws_api_password = undef,", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-integration_deploy.pp\n\nclass govuk_jenkins::jobs::integration_deploy (\n$applications = undef,\n$jenkins_integration_api_user = undef,\n$jenkins_integration_api_password = undef,\n$jenkins_integration_aws_api_user = undef,\n37:   $jenkins_integration_aws_api_password = undef,\n$aws_deploy_url = 'deploy.integration.publishing.service.gov.uk',\n$ci_deploy_url = 'ci-deploy.integration.publishing.service.gov.uk',\n$puppet_auth_token = undef,\n) {\nfile { '/etc/jenkins_jobs/jobs/integration_app_deploy.yaml':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_jenkins-manifests-jobs-integration_deploy.pp\n# Target line: 37\n\n     32: class govuk_jenkins::jobs::integration_deploy (\n     33:   $applications = undef,\n     34:   $jenkins_integration_api_user = undef,\n     35:   $jenkins_integration_api_password = undef,\n     36:   $jenkins_integration_aws_api_user = undef,\n>>>  37:   $jenkins_integration_aws_api_password = undef,\n     38:   $aws_deploy_url = 'deploy.integration.publishing.service.gov.uk',\n     39:   $ci_deploy_url = 'ci-deploy.integration.publishing.service.gov.uk',\n     40:   $puppet_auth_token = undef,\n     41: ) {\n     42:   file { '/etc/jenkins_jobs/jobs/integration_app_deploy.yaml':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-neutron.pp", "content": "neutron_password      => hiera('CONFIG_NEUTRON_KS_PW'),", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-neutron.pp\n\n$nova_neutron_cfg_ctrl_host = hiera('CONFIG_KEYSTONE_HOST_URL')\n$neutron_auth_url = hiera('CONFIG_KEYSTONE_ADMIN_URL')\n\nclass { '::nova::network::neutron':\ndefault_floating_pool => 'public',\n8:       neutron_password      => hiera('CONFIG_NEUTRON_KS_PW'),\nneutron_auth_type     => 'v3password',\nneutron_url           => \"http://${nova_neutron_cfg_ctrl_host}:9696\",\nneutron_project_name  => 'services',\nneutron_auth_url      => \"${neutron_auth_url}/v3\",\nneutron_region_name   => hiera('CONFIG_KEYSTONE_REGION'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-neutron.pp\n# Target line: 8\n\n      3:     $nova_neutron_cfg_ctrl_host = hiera('CONFIG_KEYSTONE_HOST_URL')\n      4:     $neutron_auth_url = hiera('CONFIG_KEYSTONE_ADMIN_URL')\n      5: \n      6:     class { '::nova::network::neutron':\n      7:       default_floating_pool => 'public',\n>>>   8:       neutron_password      => hiera('CONFIG_NEUTRON_KS_PW'),\n      9:       neutron_auth_type     => 'v3password',\n     10:       neutron_url           => \"http://${nova_neutron_cfg_ctrl_host}:9696\",\n     11:       neutron_project_name  => 'services',\n     12:       neutron_auth_url      => \"${neutron_auth_url}/v3\",\n     13:       neutron_region_name   => hiera('CONFIG_KEYSTONE_REGION'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-monasca-manifests-params.pp", "content": "$admin_password     = undef,", "line": 78, "detection_span": [73, 83], "with_context": "# Puppet file: openstack@puppet-monasca-manifests-params.pp\n\n$region             = 'RegionOne',\n$admin_name         = 'monasca-admin',\n$agent_name         = 'monasca-agent',\n$user_name          = 'monasca-user',\n$auth_method        = 'token',\n78:     $admin_password     = undef,\n$admin_project_name = undef,\n$agent_password     = undef,\n$user_password      = undef,\n$sql_host           = undef,\n$sql_user           = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-monasca-manifests-params.pp\n# Target line: 78\n\n     73:     $region             = 'RegionOne',\n     74:     $admin_name         = 'monasca-admin',\n     75:     $agent_name         = 'monasca-agent',\n     76:     $user_name          = 'monasca-user',\n     77:     $auth_method        = 'token',\n>>>  78:     $admin_password     = undef,\n     79:     $admin_project_name = undef,\n     80:     $agent_password     = undef,\n     81:     $user_password      = undef,\n     82:     $sql_host           = undef,\n     83:     $sql_user           = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-manifests-pki-ca.pp", "content": "$_ca_key_mode = '0600'", "line": 60, "detection_span": [55, 65], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-pki-ca.pp\n\nowner => $user,\ngroup => $group,\n}\n\nif $::osfamily != 'windows' {\n60:     $_ca_key_mode = '0600'\n} else {\n$_ca_key_mode = undef\n}\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-pki-ca.pp\n# Target line: 60\n\n     55:     owner => $user,\n     56:     group => $group,\n     57:   }\n     58: \n     59:   if $::osfamily != 'windows' {\n>>>  60:     $_ca_key_mode = '0600'\n     61:   } else {\n     62:     $_ca_key_mode = undef\n     63:   }\n     64: \n     65: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-server-config.pp", "content": "auth_method => 'md5',", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-server-config.pp\n\ncreate_resources('postgresql::server::pg_hba_rule', $ipv4acl_resources)\n\npostgresql::server::pg_hba_rule { 'allow access to all users':\ntype        => 'host',\naddress     => $ip_mask_allow_all_users,\n77:           auth_method => 'md5',\norder       => '100',\n}\npostgresql::server::pg_hba_rule { 'allow access to ipv6 localhost':\ntype        => 'host',\naddress     => '::1/128',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-postgresql-manifests-server-config.pp\n# Target line: 77\n\n     72:         create_resources('postgresql::server::pg_hba_rule', $ipv4acl_resources)\n     73: \n     74:         postgresql::server::pg_hba_rule { 'allow access to all users':\n     75:           type        => 'host',\n     76:           address     => $ip_mask_allow_all_users,\n>>>  77:           auth_method => 'md5',\n     78:           order       => '100',\n     79:         }\n     80:         postgresql::server::pg_hba_rule { 'allow access to ipv6 localhost':\n     81:           type        => 'host',\n     82:           address     => '::1/128',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "camptocamp@puppet-tomcat-manifests-source.pp", "content": "digest_url   => \"${tomcaturl}.md5\",", "line": 49, "detection_span": [44, 54], "with_context": "# Puppet file: camptocamp@puppet-tomcat-manifests-source.pp\n\n\narchive{ $tomcat_name:\nsource       => $tomcaturl,\nextract      => true,\npath         => \"/var/tmp/${tomcat_name}.tar.gz\",\n49:     digest_url   => \"${tomcaturl}.md5\",\ndigest_type  => 'md5',\nextract_path => '/opt',\ncreates      => \"/opt/${tomcat_name}/bin\",\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-tomcat-manifests-source.pp\n# Target line: 49\n\n     44: \n     45:   archive{ $tomcat_name:\n     46:     source       => $tomcaturl,\n     47:     extract      => true,\n     48:     path         => \"/var/tmp/${tomcat_name}.tar.gz\",\n>>>  49:     digest_url   => \"${tomcaturl}.md5\",\n     50:     digest_type  => 'md5',\n     51:     extract_path => '/opt',\n     52:     creates      => \"/opt/${tomcat_name}/bin\",\n     53:   }\n     54: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "camptocamp@puppet-archive-manifests-download.pp", "content": "$digest_type='md5',", "line": 40, "detection_span": [35, 45], "with_context": "# Puppet file: camptocamp@puppet-archive-manifests-download.pp\n\n$url,\n$ensure=present,\n$checksum=true,\n$digest_url=undef,\n$digest_string=undef,\n40:   $digest_type='md5',\n$timeout=120,\n$src_target='/usr/src',\n$allow_insecure=false,\n$follow_redirects=false,\n$verbose=true,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: camptocamp@puppet-archive-manifests-download.pp\n# Target line: 40\n\n     35:   $url,\n     36:   $ensure=present,\n     37:   $checksum=true,\n     38:   $digest_url=undef,\n     39:   $digest_string=undef,\n>>>  40:   $digest_type='md5',\n     41:   $timeout=120,\n     42:   $src_target='/usr/src',\n     43:   $allow_insecure=false,\n     44:   $follow_redirects=false,\n     45:   $verbose=true,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "weak_cryptography_algorithms", "file": "duritong@puppet-shorewall-manifests-rules-torify-reject_non_tor.pp", "content": "$rule = \"reject-non-tor-from-${user}-to=${originaldest_sha1}\"", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: duritong@puppet-shorewall-manifests-rules-torify-reject_non_tor.pp\n\n$allow_rfc1918 = true\n){\n\n# hash the destination as it may contain slashes\n$originaldest_sha1 = sha1($originaldest)\n9:   $rule = \"reject-non-tor-from-${user}-to=${originaldest_sha1}\"\n\nif $originaldest == '-' {\n$originaldest_real = $allow_rfc1918 ? {\nfalse   => '!127.0.0.1',\ndefault => '!127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: duritong@puppet-shorewall-manifests-rules-torify-reject_non_tor.pp\n# Target line: 9\n\n      4:   $allow_rfc1918 = true\n      5: ){\n      6: \n      7:   # hash the destination as it may contain slashes\n      8:   $originaldest_sha1 = sha1($originaldest)\n>>>   9:   $rule = \"reject-non-tor-from-${user}-to=${originaldest_sha1}\"\n     10: \n     11:   if $originaldest == '-' {\n     12:     $originaldest_real = $allow_rfc1918 ? {\n     13:       false   => '!127.0.0.1',\n     14:       default => '!127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
