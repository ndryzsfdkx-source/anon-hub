{"smell": "weak_cryptography_algorithms", "file": "krishus_Chef-recipes-cron.rb", "content": "seed = node['shard_seed'] || Digest::MD5.hexdigest(node.name).to_s.hex", "line": 91, "detection_span": [86, 96], "with_context": "\nend\nend\n\n# Generate a uniformly distributed unique number to sleep.\nif node['chef_client']['splay'].to_i > 0\n91:   seed = node['shard_seed'] || Digest::MD5.hexdigest(node.name).to_s.hex\nsleep_time = seed % node['chef_client']['splay'].to_i\nelse\nsleep_time = nil\nend\nenv        = node['chef_client']['cron']['environment_variables']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: krishus_Chef-recipes-cron.rb\n# Target line: 91\n\n     86:   end\n     87: end\n     88: \n     89: # Generate a uniformly distributed unique number to sleep.\n     90: if node['chef_client']['splay'].to_i > 0\n>>>  91:   seed = node['shard_seed'] || Digest::MD5.hexdigest(node.name).to_s.hex\n     92:   sleep_time = seed % node['chef_client']['splay'].to_i\n     93: else\n     94:   sleep_time = nil\n     95: end\n     96: env        = node['chef_client']['cron']['environment_variables']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-testing-source.rb", "content": "default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'", "line": 10, "detection_span": [5, 15], "with_context": "\nif node['platform_version'].to_i > 2010\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel7&arch=$basearch'\n10:     default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nelse\ndefault['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\ndefault['yum']['epel-testing-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-testing-source.rb\n# Target line: 10\n\n      5:   if node['platform_version'].to_i > 2010\n      6:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\n      7:     default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      8:   else\n      9:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel7&arch=$basearch'\n>>>  10:     default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     11:   end\n     12: else\n     13:   default['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\n     14:   default['yum']['epel-testing-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\n     15: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "rackspace-cookbooks_nodestack-recipes-demo.rb", "content": "node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['source'] = 'monitoring-remote-http.yaml.erb'", "line": 64, "detection_span": [59, 69], "with_context": "\n}\n\n# monitoring. nodestack::nginx also add's monitoring for the nginx site.\nnode.set_unless['platformstack']['cloud_monitoring']['remote_http']['name'] = []\nnode.set['platformstack']['cloud_monitoring']['remote_http']['name'].push('my_nodejs_app')\n64: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['source'] = 'monitoring-remote-http.yaml.erb'\nnode.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['cookbook'] = 'platformstack'\nnode.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['variables'] = {\ndisabled: false,\nperiod: 60,\ntimeout: 15,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-recipes-demo.rb\n# Target line: 64\n\n     59: }\n     60: \n     61: # monitoring. nodestack::nginx also add's monitoring for the nginx site.\n     62: node.set_unless['platformstack']['cloud_monitoring']['remote_http']['name'] = []\n     63: node.set['platformstack']['cloud_monitoring']['remote_http']['name'].push('my_nodejs_app')\n>>>  64: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['source'] = 'monitoring-remote-http.yaml.erb'\n     65: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['cookbook'] = 'platformstack'\n     66: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['variables'] = {\n     67:   disabled: false,\n     68:   period: 60,\n     69:   timeout: 15,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-jenkins-recipes-_server_package.rb", "content": "key 'http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key'", "line": 29, "detection_span": [24, 34], "with_context": "\n\napt_repository 'jenkins' do\nuri 'http://pkg.jenkins-ci.org/debian'\ndistribution 'binary/'\ncomponents ['']\n29:     key 'http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key'\naction :add\nend\n\nwhen 'rhel'\ninclude_recipe 'yum'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-recipes-_server_package.rb\n# Target line: 29\n\n     24: \n     25:   apt_repository 'jenkins' do\n     26:     uri 'http://pkg.jenkins-ci.org/debian'\n     27:     distribution 'binary/'\n     28:     components ['']\n>>>  29:     key 'http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key'\n     30:     action :add\n     31:   end\n     32: \n     33: when 'rhel'\n     34:   include_recipe 'yum'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-prod-deploy-recipes-default.rb", "content": "source 'http://35.163.66.120:8081/artifactory/libs-snapshot-local/com/wakaleo/gameoflife/gameoflife-web/1.0-SNAPSHOT/gameoflife-web-1.0-20161212.084728-1.war'", "line": 11, "detection_span": [6, 16], "with_context": "\n#\n# All rights reserved - Do Not Redistribute\n#\n\nremote_file '/var/lib/tomcat7/webapps/gameoflife-web-1.0-20161212.084728-1.war' do\n11:   source 'http://35.163.66.120:8081/artifactory/libs-snapshot-local/com/wakaleo/gameoflife/gameoflife-web/1.0-SNAPSHOT/gameoflife-web-1.0-20161212.084728-1.war'\naction :create_if_missing\nuser 'root'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-prod-deploy-recipes-default.rb\n# Target line: 11\n\n      6: #\n      7: # All rights reserved - Do Not Redistribute\n      8: #\n      9: \n     10: remote_file '/var/lib/tomcat7/webapps/gameoflife-web-1.0-20161212.084728-1.war' do\n>>>  11:   source 'http://35.163.66.120:8081/artifactory/libs-snapshot-local/com/wakaleo/gameoflife/gameoflife-web/1.0-SNAPSHOT/gameoflife-web-1.0-20161212.084728-1.war'\n     12:   action :create_if_missing\n     13:   user 'root'\n     14: end\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-couchdb-attributes-default.rb", "content": "default['couch_db']['src_mirror']        = \"http://archive.apache.org/dist/couchdb/#{node['couch_db']['src_version']}/apache-couchdb-#{node['couch_db']['src_version']}.tar.gz\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\ndefault['couch_db']['src_checksum']      = \"6ef82a7ba0f132d55af7cc78b30658d5b3a4f7be3f449308c8d7fa2ad473677c\"\ndefault['couch_db']['src_version']       = \"1.0.2\"\n22: default['couch_db']['src_mirror']        = \"http://archive.apache.org/dist/couchdb/#{node['couch_db']['src_version']}/apache-couchdb-#{node['couch_db']['src_version']}.tar.gz\"\ndefault['couch_db']['bind_address']  = nil\ndefault['couch_db']['install_erlang'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-couchdb-attributes-default.rb\n# Target line: 22\n\n     17: # See the License for the specific language governing permissions and\n     18: # limitations under the License.\n     19: \n     20: default['couch_db']['src_checksum']      = \"6ef82a7ba0f132d55af7cc78b30658d5b3a4f7be3f449308c8d7fa2ad473677c\"\n     21: default['couch_db']['src_version']       = \"1.0.2\"\n>>>  22: default['couch_db']['src_mirror']        = \"http://archive.apache.org/dist/couchdb/#{node['couch_db']['src_version']}/apache-couchdb-#{node['couch_db']['src_version']}.tar.gz\"\n     23: default['couch_db']['bind_address']  = nil\n     24: default['couch_db']['install_erlang'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-zookeeper-cookbooks-minidash-libraries-minidash_utils.rb", "content": "url = \"http://#{CGI::escape(url_parts[\"addr\"])}:#{port.to_i}\"", "line": 11, "detection_span": [6, 16], "with_context": "\ndef add_minidash_link(component, url_parts)\nif    url_parts.respond_to?(:each_pair) && url_parts[\"url\"]\nurl = url_parts[\"url\"]\nelsif url_parts.respond_to?(:each_pair) && url_parts[\"addr\"]\nport = url_parts[\"dash_port\"] || url_parts[\"port\"] || 80\n11:         url = \"http://#{CGI::escape(url_parts[\"addr\"])}:#{port.to_i}\"\nelsif url_parts.to_s =~ %r{^https?://}\nurl = url_parts.to_s\nelse\nurl = nil\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-zookeeper-cookbooks-minidash-libraries-minidash_utils.rb\n# Target line: 11\n\n      6:     def add_minidash_link(component, url_parts)\n      7:       if    url_parts.respond_to?(:each_pair) && url_parts[\"url\"]\n      8:         url = url_parts[\"url\"]\n      9:       elsif url_parts.respond_to?(:each_pair) && url_parts[\"addr\"]\n     10:         port = url_parts[\"dash_port\"] || url_parts[\"port\"] || 80\n>>>  11:         url = \"http://#{CGI::escape(url_parts[\"addr\"])}:#{port.to_i}\"\n     12:       elsif url_parts.to_s =~ %r{^https?://}\n     13:         url = url_parts.to_s\n     14:       else\n     15:         url = nil\n     16:       end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-nodejs-recipes-npm.rb", "content": "npm_src_url = \"http://registry.npmjs.org/npm/-/npm-#{node['nodejs']['npm']}.tgz\"", "line": 25, "detection_span": [20, 30], "with_context": "\n\ninclude_recipe \"nodejs\"\n\npackage \"curl\"\n\n25: npm_src_url = \"http://registry.npmjs.org/npm/-/npm-#{node['nodejs']['npm']}.tgz\"\n\nbash \"install npm - package manager for node\" do\ncwd \"/usr/local/src\"\nuser \"root\"\ncode <<-EOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-nodejs-recipes-npm.rb\n# Target line: 25\n\n     20: \n     21: include_recipe \"nodejs\"\n     22: \n     23: package \"curl\"\n     24: \n>>>  25: npm_src_url = \"http://registry.npmjs.org/npm/-/npm-#{node['nodejs']['npm']}.tgz\"\n     26: \n     27: bash \"install npm - package manager for node\" do\n     28:   cwd \"/usr/local/src\"\n     29:   user \"root\"\n     30:   code <<-EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "ubolonton_vagrant-cookbooks-python-recipes-pip.rb", "content": "source \"http://python-distribute.org/distribute_setup.py\"", "line": 26, "detection_span": [21, 31], "with_context": "\n# Ubuntu's python-setuptools, python-pip and python-virtualenv packages\n# are broken...this feels like Rubygems!\n# http://stackoverflow.com/questions/4324558/whats-the-proper-way-to-install-pip-virtualenv-and-distribute-for-python\n# https://bitbucket.org/ianb/pip/issue/104/pip-uninstall-on-ubuntu-linux\nremote_file \"#{Chef::Config[:file_cache_path]}/distribute_setup.py\" do\n26:   source \"http://python-distribute.org/distribute_setup.py\"\nmode \"0644\"\nnot_if \"which pip\"\nend\n\nuse_version = node['python']['distribute_install_py_version']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-python-recipes-pip.rb\n# Target line: 26\n\n     21: # Ubuntu's python-setuptools, python-pip and python-virtualenv packages \n     22: # are broken...this feels like Rubygems!\n     23: # http://stackoverflow.com/questions/4324558/whats-the-proper-way-to-install-pip-virtualenv-and-distribute-for-python\n     24: # https://bitbucket.org/ianb/pip/issue/104/pip-uninstall-on-ubuntu-linux\n     25: remote_file \"#{Chef::Config[:file_cache_path]}/distribute_setup.py\" do\n>>>  26:   source \"http://python-distribute.org/distribute_setup.py\"\n     27:   mode \"0644\"\n     28:   not_if \"which pip\"\n     29: end\n     30: \n     31: use_version = node['python']['distribute_install_py_version']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-recipes-default.rb", "content": "# FIXME: This is only the vaguest of security, very unconfigurable,", "line": 67, "detection_span": [62, 72], "with_context": "\nowner         node[:jenkins][:server][:user]\ngroup         node[:jenkins][:server][:group]\nend\n\n# Lock access down to local user accounts\n67: # FIXME: This is only the vaguest of security, very unconfigurable,\n#   and really should be done over HTTPS to prevent pw hash sniffing.\nif node[:jenkins_integration][:security] == \"local_users\"\ngroup \"shadow\" do\naction :modify\nmembers node[:jenkins][:server][:user]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-recipes-default.rb\n# Target line: 67\n\n     62:   owner         node[:jenkins][:server][:user]\n     63:   group         node[:jenkins][:server][:group]\n     64: end\n     65: \n     66: # Lock access down to local user accounts\n>>>  67: # FIXME: This is only the vaguest of security, very unconfigurable,\n     68: #   and really should be done over HTTPS to prevent pw hash sniffing.\n     69: if node[:jenkins_integration][:security] == \"local_users\"\n     70:   group \"shadow\" do\n     71:     action :modify\n     72:     members node[:jenkins][:server][:user]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "ubolonton_vagrant-cookbooks-nodejs-recipes-install_from_source.rb", "content": "# --no-same-owner required overcome \"Cannot change ownership\" bug", "line": 38, "detection_span": [33, 43], "with_context": "\nsource node['nodejs']['src_url']\nchecksum node['nodejs']['checksum']\nmode 0644\nend\n\n38: # --no-same-owner required overcome \"Cannot change ownership\" bug\n# on NFS-mounted filesystem\nexecute \"tar --no-same-owner -zxf #{nodejs_tar}\" do\ncwd \"/usr/local/src\"\ncreates \"/usr/local/src/node-v#{node['nodejs']['version']}\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-nodejs-recipes-install_from_source.rb\n# Target line: 38\n\n     33:   source node['nodejs']['src_url']\n     34:   checksum node['nodejs']['checksum']\n     35:   mode 0644\n     36: end\n     37: \n>>>  38: # --no-same-owner required overcome \"Cannot change ownership\" bug\n     39: # on NFS-mounted filesystem\n     40: execute \"tar --no-same-owner -zxf #{nodejs_tar}\" do\n     41:   cwd \"/usr/local/src\"\n     42:   creates \"/usr/local/src/node-v#{node['nodejs']['version']}\"\n     43: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-examples~network~legacy.rb", "content": "# using this example. If running from the command line, you can pass this suffix", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\nraise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\nunless ENV.key?('network_id')\n# The environment variable 'network_id' defines a suffix for a network name when\n66: # using this example. If running from the command line, you can pass this suffix\n# in via the command line:\n#\n# network_id=\"some_suffix\" chef-client -z --runlist \\\n#   \"recipe[gcompute::examples~network~auto]\"\nputs 'Creating network in Legacy mode'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-examples~network~legacy.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: raise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\n     64:   unless ENV.key?('network_id')\n     65: # The environment variable 'network_id' defines a suffix for a network name when\n>>>  66: # using this example. If running from the command line, you can pass this suffix\n     67: # in via the command line:\n     68: #\n     69: # network_id=\"some_suffix\" chef-client -z --runlist \\\n     70: #   \"recipe[gcompute::examples~network~auto]\"\n     71: puts 'Creating network in Legacy mode'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-mingw-resources-msys2_package.rb", "content": "# well that's your problem isn't it?  And they don't believe in preserving", "line": 25, "detection_span": [20, 30], "with_context": "\n# Installs msys2 base system and installs/upgrades packages within in.\n#\n# Where's the version flag?  Where's idempotence you say?  Well f*** you\n# for trying to version your product.  This is arch.  They live on the edge.\n# You never get anything but the latest version.  And if that's broken...\n25: # well that's your problem isn't it?  And they don't believe in preserving\n# older versions.  Good luck!\n\nproperty :package, String, name_property: true\nproperty :root, String, required: true\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-mingw-resources-msys2_package.rb\n# Target line: 25\n\n     20: # Installs msys2 base system and installs/upgrades packages within in.\n     21: #\n     22: # Where's the version flag?  Where's idempotence you say?  Well f*** you\n     23: # for trying to version your product.  This is arch.  They live on the edge.\n     24: # You never get anything but the latest version.  And if that's broken...\n>>>  25: # well that's your problem isn't it?  And they don't believe in preserving\n     26: # older versions.  Good luck!\n     27: \n     28: property :package, String, name_property: true\n     29: property :root, String, required: true\n     30: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb", "content": "# working around: http://tickets.opscode.com/browse/CHEF-1848; set to true if you have the CHEF-1848 patch applied", "line": 94, "detection_span": [89, 99], "with_context": "\n\n#\n# Install\n#\n\n94: # working around: http://tickets.opscode.com/browse/CHEF-1848; set to true if you have the CHEF-1848 patch applied\ndefault[:jenkins][:server][:use_head]   = false\n\ndefault[:jenkins][:apt_mirror]          = \"http://pkg.jenkins-ci.org/debian\"\ndefault[:jenkins][:plugins_mirror]      = \"http://updates.jenkins-ci.org\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb\n# Target line: 94\n\n     89: \n     90: #\n     91: # Install\n     92: #\n     93: \n>>>  94: # working around: http://tickets.opscode.com/browse/CHEF-1848; set to true if you have the CHEF-1848 patch applied\n     95: default[:jenkins][:server][:use_head]   = false\n     96: \n     97: default[:jenkins][:apt_mirror]          = \"http://pkg.jenkins-ci.org/debian\"\n     98: default[:jenkins][:plugins_mirror]      = \"http://updates.jenkins-ci.org\"\n     99: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb", "content": "# FIXME: don't set this to reuse the default attribute", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault[:kafka][:user]                              = 'kafka'\ndefault[:users ]['kafka'][:uid]                     = 452\ndefault[:kafka][:group]                             = 'kafka'\ndefault[:groups ]['kafka'][:gid]                    = 452\n\n11:                                                                          # FIXME: don't set this to reuse the default attribute\ndefault[:kafka][:install_dir]                       = \"/usr/local/share/kafka-#{default[:kafka][:version]}\"\ndefault[:kafka][:home_dir]                          = '/usr/local/share/kafka'\ndefault[:kafka][:conf_dir]                          = File.join(default[:kafka][:home_dir], 'config')\n# Set via volume_dirs\ndefault[:kafka][:journal_dir]                       = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb\n# Target line: 11\n\n      6: default[:kafka][:user]                              = 'kafka'\n      7: default[:users ]['kafka'][:uid]                     = 452\n      8: default[:kafka][:group]                             = 'kafka'\n      9: default[:groups ]['kafka'][:gid]                    = 452\n     10: \n>>>  11:                                                                          # FIXME: don't set this to reuse the default attribute\n     12: default[:kafka][:install_dir]                       = \"/usr/local/share/kafka-#{default[:kafka][:version]}\"\n     13: default[:kafka][:home_dir]                          = '/usr/local/share/kafka'\n     14: default[:kafka][:conf_dir]                          = File.join(default[:kafka][:home_dir], 'config')\n     15: # Set via volume_dirs\n     16: default[:kafka][:journal_dir]                       = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-poise-languages-files-halite_gem-poise_languages-scl-mixin.rb", "content": "# TODO: What do I do about Fedora and/or Amazon?", "line": 83, "detection_span": [78, 88], "with_context": "\nend\n\nmodule ClassMethods\ndef provides_auto?(node, resource)\n# They don't build 32-bit versions for these and only for RHEL/CentOS.\n83:           # TODO: What do I do about Fedora and/or Amazon?\nreturn false unless node['kernel']['machine'] == 'x86_64' && node.platform?('redhat', 'centos')\nversion = inversion_options(node, resource)['version']\n!!find_scl_package(node, version)\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-poise-languages-files-halite_gem-poise_languages-scl-mixin.rb\n# Target line: 83\n\n     78:       end\n     79: \n     80:       module ClassMethods\n     81:         def provides_auto?(node, resource)\n     82:           # They don't build 32-bit versions for these and only for RHEL/CentOS.\n>>>  83:           # TODO: What do I do about Fedora and/or Amazon?\n     84:           return false unless node['kernel']['machine'] == 'x86_64' && node.platform?('redhat', 'centos')\n     85:           version = inversion_options(node, resource)['version']\n     86:           !!find_scl_package(node, version)\n     87:         end\n     88: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise-helpers-fused.rb", "content": "# Hack provider_for_action so that the resource is also the provider.", "line": 53, "detection_span": [48, 58], "with_context": "\nelse\nsuper\nend\nend\n\n53:       # Hack provider_for_action so that the resource is also the provider.\n#\n# @api private\n# @param action [Symbol]\n# @return [Chef::Provider]\ndef provider_for_action(action)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise-helpers-fused.rb\n# Target line: 53\n\n     48:         else\n     49:           super\n     50:         end\n     51:       end\n     52: \n>>>  53:       # Hack provider_for_action so that the resource is also the provider.\n     54:       #\n     55:       # @api private\n     56:       # @param action [Symbol]\n     57:       # @return [Chef::Provider]\n     58:       def provider_for_action(action)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rackspace-cookbooks_pythonstack-recipes-nginx.rb", "content": "# Pid is different on Ubuntu 14, causing nginx service to fail https://github.com/miketheman/nginx/issues/248", "line": 47, "detection_span": [42, 52], "with_context": "\n\n# Install Uwsgi\ninclude_recipe 'build-essential'\ninclude_recipe 'uwsgi'\n\n47: # Pid is different on Ubuntu 14, causing nginx service to fail https://github.com/miketheman/nginx/issues/248\nnode.default['nginx']['pid'] = '/run/nginx.pid' if ubuntu_trusty?\n# Uwsgi path is different on Centos\nif rhel?\nnode.default['nginx']['uwsgi']['bin'] = '/usr/bin/uwsgi'\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_pythonstack-recipes-nginx.rb\n# Target line: 47\n\n     42: \n     43: # Install Uwsgi\n     44: include_recipe 'build-essential'\n     45: include_recipe 'uwsgi'\n     46: \n>>>  47: # Pid is different on Ubuntu 14, causing nginx service to fail https://github.com/miketheman/nginx/issues/248\n     48: node.default['nginx']['pid'] = '/run/nginx.pid' if ubuntu_trusty?\n     49: # Uwsgi path is different on Centos\n     50: if rhel?\n     51:   node.default['nginx']['uwsgi']['bin'] = '/usr/bin/uwsgi'\n     52: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "shopping-adventure_chef_mysql-recipes-server.rb", "content": "#resolver = Resolv::DNS.new(:nameserver => [\"#{dns_node['cloud']['local_hostname']}\"])", "line": 132, "detection_span": [127, 137], "with_context": "\n127:   ipv4_address=\"\"\n128:   ipv6_address=\"\"\n129:   dns_node = search(:node, 'role:dns').first\n130:\n131:   #Resolver local n'est pas suffisant\n132:   #resolver = Resolv::DNS.new(:nameserver => [\"#{dns_node['cloud']['local_hostname']}\"])\n133:   resolver = Resolv::DNS.new(:nameserver => \"8.8.8.8\")\n134:   fqdns.each do |fqdn|\nresolver.getaddresses(\"#{fqdn}\").each do |ip|\ncase ip.to_s\nwhen Resolv::IPv4::Regex", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: shopping-adventure_chef_mysql-recipes-server.rb\n# Target line: 132\n\n    127:   ipv4_address=\"\"\n    128:   ipv6_address=\"\"\n    129:   dns_node = search(:node, 'role:dns').first\n    130: \n    131:   #Resolver local n'est pas suffisant\n>>> 132:   #resolver = Resolv::DNS.new(:nameserver => [\"#{dns_node['cloud']['local_hostname']}\"])\n    133:   resolver = Resolv::DNS.new(:nameserver => \"8.8.8.8\")\n    134:   fqdns.each do |fqdn|\n    135:     resolver.getaddresses(\"#{fqdn}\").each do |ip|\n    136:       case ip.to_s\n    137:       when Resolv::IPv4::Regex\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-imgproxy-recipes-nat_workaround.rb", "content": "# Carpathia NAT issues.", "line": 2, "detection_span": [1, 7], "with_context": "\n# This recipe is used to set the hosts file on the imgproxys to get around\n2: # Carpathia NAT issues.\nnode[:imgproxy][:host_entries].each do |ip, host|\nhostsfile_entry ip do\nhostname host\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-imgproxy-recipes-nat_workaround.rb\n# Target line: 2\n\n      1: # This recipe is used to set the hosts file on the imgproxys to get around\n>>>   2: # Carpathia NAT issues.\n      3: node[:imgproxy][:host_entries].each do |ip, host|\n      4:   hostsfile_entry ip do\n      5:     hostname host\n      6:   end\n      7: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "criteo-cookbooks_ms_dotnet-libraries-v4_helper.rb", "content": "# TODO: check 2012R2 Core feature name", "line": 60, "detection_span": [55, 65], "with_context": "\nprotected\n\ndef feature_names\n@feature_names ||= case nt_version\nwhen 6.2, 6.3, 10\n60:           # TODO: check 2012R2 Core feature name\ncore? ? %w[netFx4-Server-Core] : %w[NetFx4]\nelse\n[]\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_ms_dotnet-libraries-v4_helper.rb\n# Target line: 60\n\n     55:     protected\n     56: \n     57:     def feature_names\n     58:       @feature_names ||= case nt_version\n     59:         when 6.2, 6.3, 10\n>>>  60:           # TODO: check 2012R2 Core feature name\n     61:           core? ? %w[netFx4-Server-Core] : %w[NetFx4]\n     62:         else\n     63:           []\n     64:       end\n     65:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SpanningCloudApps_cassandra-chef-cookbook-recipes-datastax.rb", "content": "# Submit an issue if jamm version is not correct for 0.x or 1.x version", "line": 21, "detection_span": [16, 26], "with_context": "\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\ncase node['cassandra']['version']\n21: # Submit an issue if jamm version is not correct for 0.x or 1.x version\nwhen /^0\\./, /^1\\./, /^2\\.0/\n# < 2.1 Versions\nnode.default['cassandra']['setup_jna'] = true\nnode.default['cassandra']['cassandra_old_version_20'] = true\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: SpanningCloudApps_cassandra-chef-cookbook-recipes-datastax.rb\n# Target line: 21\n\n     16: # See the License for the specific language governing permissions and\n     17: # limitations under the License.\n     18: #\n     19: \n     20: case node['cassandra']['version']\n>>>  21: # Submit an issue if jamm version is not correct for 0.x or 1.x version\n     22: when /^0\\./, /^1\\./, /^2\\.0/\n     23:   # < 2.1 Versions\n     24:   node.default['cassandra']['setup_jna'] = true\n     25:   node.default['cassandra']['cassandra_old_version_20'] = true\n     26: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_linux.rb", "content": "# TODO: Figure out how to run as a service account.", "line": 110, "detection_span": [105, 115], "with_context": "\n105:   end\n106:\n107:   # Enable and start the agent as a service on the node with any available\n108:   # CLI options\n109:   poise_service 'newrelic-infra' do\n110:     # TODO: Figure out how to run as a service account.\n# user node['newrelic_infra']['user']['name']\ncommand '/usr/bin/newrelic-infra ' <<\nNewRelicInfra.generate_flags(node['newrelic_infra']['agent']['flags'])\noptions(:systemd,\ntemplate: 'newrelic-infra:default/systemd.service.erb',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_linux.rb\n# Target line: 110\n\n    105:   end\n    106: \n    107:   # Enable and start the agent as a service on the node with any available\n    108:   # CLI options\n    109:   poise_service 'newrelic-infra' do\n>>> 110:     # TODO: Figure out how to run as a service account.\n    111:     # user node['newrelic_infra']['user']['name']\n    112:     command '/usr/bin/newrelic-infra ' <<\n    113:             NewRelicInfra.generate_flags(node['newrelic_infra']['agent']['flags'])\n    114:     options(:systemd,\n    115:             template: 'newrelic-infra:default/systemd.service.erb',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb", "content": "# Monitor postfix", "line": 6, "detection_span": [1, 11], "with_context": "\n#\n# Cookbook Name:: datadog\n# Recipe:: postfix\n#\n\n6: # Monitor postfix\n#\n# Assuming you have 2 instances \"prod\" and \"test\", you will need to set\n# up the following attributes at some point in your Chef run, in either\n# a role or another cookbook.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb\n# Target line: 6\n\n      1: #\n      2: # Cookbook Name:: datadog\n      3: # Recipe:: postfix\n      4: #\n      5: \n>>>   6: # Monitor postfix\n      7: #\n      8: # Assuming you have 2 instances \"prod\" and \"test\", you will need to set\n      9: # up the following attributes at some point in your Chef run, in either\n     10: # a role or another cookbook.\n     11: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danielladd_Chef-Testing-cookbooks-windows-providers-printer_port.rb", "content": "# TODO: Set @current_resource port properties from registry", "line": 53, "detection_span": [48, 58], "with_context": "\n@current_resource.name(@new_resource.name)\n@current_resource.ipv4_address(@new_resource.ipv4_address)\n@current_resource.port_name(@new_resource.port_name || \"IP_#{ @new_resource.ipv4_address }\")\n\nif port_exists?(@current_resource.port_name)\n53:     # TODO: Set @current_resource port properties from registry\n@current_resource.exists = true\nend\nend\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-windows-providers-printer_port.rb\n# Target line: 53\n\n     48:   @current_resource.name(@new_resource.name)\n     49:   @current_resource.ipv4_address(@new_resource.ipv4_address)\n     50:   @current_resource.port_name(@new_resource.port_name || \"IP_#{ @new_resource.ipv4_address }\")\n     51: \n     52:   if port_exists?(@current_resource.port_name)\n>>>  53:     # TODO: Set @current_resource port properties from registry\n     54:     @current_resource.exists = true\n     55:   end\n     56: end\n     57: \n     58: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-otrs-attributes-default.rb", "content": "default[:otrs][:database_password] = \"otrs\"", "line": 7, "detection_span": [2, 12], "with_context": "\ndefault[:otrs][:user] = \"otrs\"\ndefault[:otrs][:group] = nil\ndefault[:otrs][:database_cluster] = \"13/main\"\ndefault[:otrs][:database_name] = \"otrs\"\ndefault[:otrs][:database_user] = \"otrs\"\n7: default[:otrs][:database_password] = \"otrs\"\ndefault[:otrs][:site] = \"otrs\"\n\ndefault[:postgresql][:versions] |= [\"13\"]\n\ndefault[:accounts][:users][:otrs][:status] = :role", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-otrs-attributes-default.rb\n# Target line: 7\n\n      2: default[:otrs][:user] = \"otrs\"\n      3: default[:otrs][:group] = nil\n      4: default[:otrs][:database_cluster] = \"13/main\"\n      5: default[:otrs][:database_name] = \"otrs\"\n      6: default[:otrs][:database_user] = \"otrs\"\n>>>   7: default[:otrs][:database_password] = \"otrs\"\n      8: default[:otrs][:site] = \"otrs\"\n      9: \n     10: default[:postgresql][:versions] |= [\"13\"]\n     11: \n     12: default[:accounts][:users][:otrs][:status] = :role\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-openssh-attributes-bastion.rb", "content": "default['openssh']['server']['pub_key_authentication'] = \"yes\"", "line": 88, "detection_span": [83, 93], "with_context": "\ndefault['openssh']['server']['permit_root_login'] = node[:tags].include?(\"permit-root\") ? \"yes\" : \"no\"\n# default['openssh']['server']['strict_modes'] = \"yes\"\n# default['openssh']['server']['max_auth_tries'] = \"6\"\n# default['openssh']['server']['max_sessions'] = \"10\"\ndefault['openssh']['server']['rsa_authentication'] = \"yes\"\n88: default['openssh']['server']['pub_key_authentication'] = \"yes\"\ndefault['openssh']['server']['authorized_keys_file'] = \"%h/.ssh/authorized_keys\"\ndefault['openssh']['server']['rhosts_rsa_authentication'] = \"no\"\ndefault['openssh']['server']['host_based_authentication'] = \"no\"\n# default['openssh']['server']['ignore_user_known_hosts'] = \"no\"\n# default['openssh']['server']['ignore_rhosts'] = \"yes\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-openssh-attributes-bastion.rb\n# Target line: 88\n\n     83: default['openssh']['server']['permit_root_login'] = node[:tags].include?(\"permit-root\") ? \"yes\" : \"no\"\n     84: # default['openssh']['server']['strict_modes'] = \"yes\"\n     85: # default['openssh']['server']['max_auth_tries'] = \"6\"\n     86: # default['openssh']['server']['max_sessions'] = \"10\"\n     87: default['openssh']['server']['rsa_authentication'] = \"yes\"\n>>>  88: default['openssh']['server']['pub_key_authentication'] = \"yes\"\n     89: default['openssh']['server']['authorized_keys_file'] = \"%h/.ssh/authorized_keys\"\n     90: default['openssh']['server']['rhosts_rsa_authentication'] = \"no\"\n     91: default['openssh']['server']['host_based_authentication'] = \"no\"\n     92: # default['openssh']['server']['ignore_user_known_hosts'] = \"no\"\n     93: # default['openssh']['server']['ignore_rhosts'] = \"yes\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb", "content": "conf_secrets['keystone_authtoken']['password'] =", "line": 87, "detection_span": [82, 92], "with_context": "\nnode.default['openstack']['orchestration']['conf_secrets'].tap do |conf_secrets|\nconf_secrets['DEFAULT']['auth_encryption_key'] =\nget_password 'token', 'orchestration_auth_encryption_key'\nconf_secrets['database']['connection'] =\ndb_uri('orchestration', db_user, db_pass)\n87:   conf_secrets['keystone_authtoken']['password'] =\nget_password 'service', 'openstack-orchestration'\nconf_secrets['trustee']['password'] =\nget_password 'service', 'openstack-orchestration'\nconf_secrets['DEFAULT']['stack_domain_admin_password'] =\nget_password 'user', stack_domain_admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb\n# Target line: 87\n\n     82: node.default['openstack']['orchestration']['conf_secrets'].tap do |conf_secrets|\n     83:   conf_secrets['DEFAULT']['auth_encryption_key'] =\n     84:     get_password 'token', 'orchestration_auth_encryption_key'\n     85:   conf_secrets['database']['connection'] =\n     86:     db_uri('orchestration', db_user, db_pass)\n>>>  87:   conf_secrets['keystone_authtoken']['password'] =\n     88:     get_password 'service', 'openstack-orchestration'\n     89:   conf_secrets['trustee']['password'] =\n     90:     get_password 'service', 'openstack-orchestration'\n     91:   conf_secrets['DEFAULT']['stack_domain_admin_password'] =\n     92:     get_password 'user', stack_domain_admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-kibana-recipes-default.rb", "content": "user \"kibana\"", "line": 70, "detection_span": [65, 75], "with_context": "\nend\n\nsystemd_service \"kibana@\" do\ndescription \"Kibana server\"\nafter \"network.target\"\n70:   user \"kibana\"\nexec_start \"/opt/kibana-#{version}/bin/kibana -c /etc/kibana/%i.yml\"\nprivate_tmp true\nprivate_devices true\nprotect_system \"full\"\nprotect_home true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-kibana-recipes-default.rb\n# Target line: 70\n\n     65: end\n     66: \n     67: systemd_service \"kibana@\" do\n     68:   description \"Kibana server\"\n     69:   after \"network.target\"\n>>>  70:   user \"kibana\"\n     71:   exec_start \"/opt/kibana-#{version}/bin/kibana -c /etc/kibana/%i.yml\"\n     72:   private_tmp true\n     73:   private_devices true\n     74:   protect_system \"full\"\n     75:   protect_home true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-zeus-zxtm-attributes-default.rb", "content": "default[:zeus][:zeus_root] = \"/data/zeus\"", "line": 13, "detection_span": [8, 18], "with_context": "\nwhen /^stage/\ndefault[:zeus][:tarball_url] = \"http://files.ihrdev.com/ZeusTM_95_Linux-x86_64.tgz\"\ndefault[:zeus][:tarball_dir] = \"ZeusTM_95_Linux-x86_64\"\ndefault[:zeus][:checksum] = \"9ae6b3778b9fe07c7d81cfe56095eaecbdbb57f220b07ef82e6a00a00dff7ed5\"\nend\n13: default[:zeus][:zeus_root] = \"/data/zeus\"\ndefault[:zeus][:force_install] = false\ndefault[:zeus][:group] = \"nobody\"\ndefault[:zeus][:user] = \"nobody\"\ndefault[:zeus][:ec2] = \"false\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-zeus-zxtm-attributes-default.rb\n# Target line: 13\n\n      8: when /^stage/\n      9:   default[:zeus][:tarball_url] = \"http://files.ihrdev.com/ZeusTM_95_Linux-x86_64.tgz\"\n     10:   default[:zeus][:tarball_dir] = \"ZeusTM_95_Linux-x86_64\"\n     11:   default[:zeus][:checksum] = \"9ae6b3778b9fe07c7d81cfe56095eaecbdbb57f220b07ef82e6a00a00dff7ed5\"\n     12: end\n>>>  13: default[:zeus][:zeus_root] = \"/data/zeus\"\n     14: default[:zeus][:force_install] = false\n     15: default[:zeus][:group] = \"nobody\"\n     16: default[:zeus][:user] = \"nobody\"\n     17: default[:zeus][:ec2] = \"false\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-proftpd-attributes-proftpd.rb", "content": "default[:proftpd][:key_dir]              = \"/etc/proftpd/authorized_keys\"", "line": 9, "detection_span": [4, 14], "with_context": "\nwhen /^stage/\ndefault[:proftpd][:encoder_export]       = \"iad-stg-nfs101.ihr:/data/export/encoder\"\nend\ndefault[:proftpd][:encoder_mount_point]  = \"/data/encoder\"\ndefault[:proftpd][:dir]                  = \"/etc/proftpd\"\n9: default[:proftpd][:key_dir]              = \"/etc/proftpd/authorized_keys\"\ndefault[:proftpd][:dir_extra_conf]       = \"conf.d\"\ndefault[:proftpd][:nat]                  = \"off\"\ndefault[:proftpd][:server_name]          = \"NULL\"\ndefault[:proftpd][:email_admin]          = node[:admin_email]\ndefault[:proftpd][:ftp_user]             = \"vftp\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-proftpd-attributes-proftpd.rb\n# Target line: 9\n\n      4: when /^stage/\n      5:   default[:proftpd][:encoder_export]       = \"iad-stg-nfs101.ihr:/data/export/encoder\"\n      6: end\n      7: default[:proftpd][:encoder_mount_point]  = \"/data/encoder\"\n      8: default[:proftpd][:dir]                  = \"/etc/proftpd\"\n>>>   9: default[:proftpd][:key_dir]              = \"/etc/proftpd/authorized_keys\"\n     10: default[:proftpd][:dir_extra_conf]       = \"conf.d\"\n     11: default[:proftpd][:nat]                  = \"off\"\n     12: default[:proftpd][:server_name]          = \"NULL\"\n     13: default[:proftpd][:email_admin]          = node[:admin_email]\n     14: default[:proftpd][:ftp_user]             = \"vftp\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_pythonstack-attributes-nginx.rb", "content": "default['nginx']['default_root'] = '/var/www'", "line": 29, "detection_span": [24, 34], "with_context": "\nend\n\n# needed to be like this so it acts like apache\ndefault['nginx']['listen_ports'] = %w(80)\n\n29: default['nginx']['default_root'] = '/var/www'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_pythonstack-attributes-nginx.rb\n# Target line: 29\n\n     24: end\n     25: \n     26: # needed to be like this so it acts like apache\n     27: default['nginx']['listen_ports'] = %w(80)\n     28: \n>>>  29: default['nginx']['default_root'] = '/var/www'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jahumes_RailsChef-vendor-cookbooks-rails-recipes-env_vars.rb", "content": "deploy_user = app_info['deploy_user'] || \"deploy\"", "line": 6, "detection_span": [1, 11], "with_context": "\napplications_root = node[:rails][:applications_root]\n\nif node[:active_applications]\nnode[:active_applications].each do |app, app_info|\n\n6:     deploy_user = app_info['deploy_user'] || \"deploy\"\nenv_vars = app_info[\"env_vars\"] || {}\ntemplate \"#{applications_root}/#{app}/shared/.rbenv-vars\" do\nsource \"app_env_vars.erb\"\nmode 0600\nowner deploy_user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jahumes_RailsChef-vendor-cookbooks-rails-recipes-env_vars.rb\n# Target line: 6\n\n      1: applications_root = node[:rails][:applications_root]\n      2: \n      3: if node[:active_applications]\n      4:   node[:active_applications].each do |app, app_info|\n      5: \n>>>   6:     deploy_user = app_info['deploy_user'] || \"deploy\"\n      7:     env_vars = app_info[\"env_vars\"] || {}\n      8:     template \"#{applications_root}/#{app}/shared/.rbenv-vars\" do\n      9:       source \"app_env_vars.erb\"\n     10:       mode 0600\n     11:       owner deploy_user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb", "content": "database_user \"osmf-wikiuser\"", "line": 35, "detection_span": [30, 40], "with_context": "\nfpm_start_servers 5\nfpm_min_spare_servers 5\nfpm_max_spare_servers 10\nfpm_prometheus_port 11001\ndatabase_name \"osmf-wiki\"\n35:   database_user \"osmf-wikiuser\"\ndatabase_password passwords[\"wiki\"][\"database\"]\nadmin_password passwords[\"wiki\"][\"admin\"]\nskin \"OSMFoundation\"\nlogo \"/w/skins/OSMFoundation/img/logo.png\"\nemail_contact \"webmaster@openstreetmap.org\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb\n# Target line: 35\n\n     30:   fpm_start_servers 5\n     31:   fpm_min_spare_servers 5\n     32:   fpm_max_spare_servers 10\n     33:   fpm_prometheus_port 11001\n     34:   database_name \"osmf-wiki\"\n>>>  35:   database_user \"osmf-wikiuser\"\n     36:   database_password passwords[\"wiki\"][\"database\"]\n     37:   admin_password passwords[\"wiki\"][\"admin\"]\n     38:   skin \"OSMFoundation\"\n     39:   logo \"/w/skins/OSMFoundation/img/logo.png\"\n     40:   email_contact \"webmaster@openstreetmap.org\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-aodh_conf.rb", "content": "conf['service_credentials']['username'] = 'aodh'", "line": 12, "detection_span": [7, 17], "with_context": "\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']\n# [service_credentials] section\n12:   conf['service_credentials']['username'] = 'aodh'\nconf['service_credentials']['project_name'] = 'service'\nconf['service_credentials']['user_domain_name'] = 'Default'\nconf['service_credentials']['project_domain_name'] = 'Default'\nconf['service_credentials']['auth_type'] = 'v3password'\nconf['service_credentials']['interface'] = 'internal'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-aodh_conf.rb\n# Target line: 12\n\n      7:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n      8:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n      9:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     10:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n     11:   # [service_credentials] section\n>>>  12:   conf['service_credentials']['username'] = 'aodh'\n     13:   conf['service_credentials']['project_name'] = 'service'\n     14:   conf['service_credentials']['user_domain_name'] = 'Default'\n     15:   conf['service_credentials']['project_domain_name'] = 'Default'\n     16:   conf['service_credentials']['auth_type'] = 'v3password'\n     17:   conf['service_credentials']['interface'] = 'internal'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-mysql-recipes-server.rb", "content": "node.set_unless['mysql']['server_root_password']   = 'vagrant'", "line": 26, "detection_span": [21, 31], "with_context": "\n\ninclude_recipe \"mysql::client\"\n\n# generate all passwords\nnode.set_unless['mysql']['server_debian_password'] = 'vagrant'\n26: node.set_unless['mysql']['server_root_password']   = 'vagrant'\nnode.set_unless['mysql']['server_repl_password']   = 'vagrant'\n\nif platform?(%w{debian ubuntu})\n\ndirectory \"/var/cache/local/preseeding\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-mysql-recipes-server.rb\n# Target line: 26\n\n     21: \n     22: include_recipe \"mysql::client\"\n     23: \n     24: # generate all passwords\n     25: node.set_unless['mysql']['server_debian_password'] = 'vagrant'\n>>>  26: node.set_unless['mysql']['server_root_password']   = 'vagrant'\n     27: node.set_unless['mysql']['server_repl_password']   = 'vagrant'\n     28: \n     29: if platform?(%w{debian ubuntu})\n     30: \n     31:   directory \"/var/cache/local/preseeding\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-nodejs-cookbooks-jenkins-recipes-user_key.rb", "content": "public_key_filename = \"#{node[:jenkins][:server][:home_dir]}/.ssh/id_rsa\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n22: public_key_filename = \"#{node[:jenkins][:server][:home_dir]}/.ssh/id_rsa\"\n\ndirectory File.dirname(public_key_filename) do\nowner         node[:jenkins][:server][:user]\ngroup         node[:jenkins][:server][:group]\nmode          \"0700\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-nodejs-cookbooks-jenkins-recipes-user_key.rb\n# Target line: 22\n\n     17: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     18: # See the License for the specific language governing permissions and\n     19: # limitations under the License.\n     20: #\n     21: \n>>>  22: public_key_filename = \"#{node[:jenkins][:server][:home_dir]}/.ssh/id_rsa\"\n     23: \n     24: directory File.dirname(public_key_filename) do\n     25:   owner         node[:jenkins][:server][:user]\n     26:   group         node[:jenkins][:server][:group]\n     27:   mode          \"0700\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pzaich_mai-ey-cloud-recipes-cookbooks-eybackup_slave-attributes-default.rb", "content": "default[:public_key] = default[:encrypted_backups] ? components.find {|c| c[:public_key]}[:public_key] : nil", "line": 4, "detection_span": [1, 9], "with_context": "\n# are the backups encrypted\ncomponents = node[:engineyard][:environment][:apps].map {|a| a[:components]}.flatten\ndefault[:encrypted_backups] = components.map {|c| c[:key]}.include?('encrypted_backup')\n4: default[:public_key] = default[:encrypted_backups] ? components.find {|c| c[:public_key]}[:public_key] : nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pzaich_mai-ey-cloud-recipes-cookbooks-eybackup_slave-attributes-default.rb\n# Target line: 4\n\n      1: # are the backups encrypted\n      2: components = node[:engineyard][:environment][:apps].map {|a| a[:components]}.flatten\n      3: default[:encrypted_backups] = components.map {|c| c[:key]}.include?('encrypted_backup')\n>>>   4: default[:public_key] = default[:encrypted_backups] ? components.find {|c| c[:public_key]}[:public_key] : nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-rightscale-attributes-default.rb", "content": "set_unless[:rightscale][:private_ssh_key] = \"\"", "line": 19, "detection_span": [14, 24], "with_context": "\n# Optional attributes\n#\nset_unless[:rightscale][:timezone] = \"UTC\"\nset_unless[:rightscale][:process_list] = \"\"\nset_unless[:rightscale][:process_match_list] = \"\"\n19: set_unless[:rightscale][:private_ssh_key] = \"\"\n\nset_unless[:rightscale][:db_backup_file] = \"/var/run/db-backup\"\n\n#\n# Setup Distro dependent variables", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-rightscale-attributes-default.rb\n# Target line: 19\n\n     14: # Optional attributes\n     15: #\n     16: set_unless[:rightscale][:timezone] = \"UTC\"\n     17: set_unless[:rightscale][:process_list] = \"\"\n     18: set_unless[:rightscale][:process_match_list] = \"\"\n>>>  19: set_unless[:rightscale][:private_ssh_key] = \"\"\n     20: \n     21: set_unless[:rightscale][:db_backup_file] = \"/var/run/db-backup\"\n     22: \n     23: #\n     24: # Setup Distro dependent variables\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-ebs-providers-raid.rb", "content": "pass 0", "line": 66, "detection_span": [61, 71], "with_context": "\n\nmount options[:mount_point] do\nfstype options[:fstype]\ndevice lvm_device\noptions 'noatime'\n66:     pass 0\nnot_if do\n::File.read('/etc/mtab').split(\"\\n\").any? do |line|\nline.match(\" #{options[:mount_point]} \")\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-ebs-providers-raid.rb\n# Target line: 66\n\n     61: \n     62:   mount options[:mount_point] do\n     63:     fstype options[:fstype]\n     64:     device lvm_device\n     65:     options 'noatime'\n>>>  66:     pass 0\n     67:     not_if do\n     68:       ::File.read('/etc/mtab').split(\"\\n\").any? do |line|\n     69:         line.match(\" #{options[:mount_point]} \")\n     70:       end\n     71:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jenkins-attributes-server.rb", "content": "default['jenkins']['http_proxy']['basic_auth_username'] = \"jenkins\"", "line": 56, "detection_span": [51, 61], "with_context": "\ndefault['jenkins']['http_proxy']['www_redirect']         = \"disable\"\ndefault['jenkins']['http_proxy']['listen_ports']         = [ 80 ]\ndefault['jenkins']['http_proxy']['host_name']            = \"build.ihrdev.com\"\ndefault['jenkins']['http_proxy']['host_aliases']         = []\ndefault['jenkins']['http_proxy']['client_max_body_size'] = \"1024m\"\n56: default['jenkins']['http_proxy']['basic_auth_username'] = \"jenkins\"\ndefault['jenkins']['http_proxy']['basic_auth_password'] = \"jenkins\"\ndefault['jenkins']['http_proxy']['cas_validate_server'] = \"off\"\ndefault['jenkins']['http_proxy']['server_auth_method'] = nil\n\ndefault['jenkins']['http_proxy']['ssl']['enabled'] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-attributes-server.rb\n# Target line: 56\n\n     51: default['jenkins']['http_proxy']['www_redirect']         = \"disable\"\n     52: default['jenkins']['http_proxy']['listen_ports']         = [ 80 ]\n     53: default['jenkins']['http_proxy']['host_name']            = \"build.ihrdev.com\"\n     54: default['jenkins']['http_proxy']['host_aliases']         = []\n     55: default['jenkins']['http_proxy']['client_max_body_size'] = \"1024m\"\n>>>  56: default['jenkins']['http_proxy']['basic_auth_username'] = \"jenkins\"\n     57: default['jenkins']['http_proxy']['basic_auth_password'] = \"jenkins\"\n     58: default['jenkins']['http_proxy']['cas_validate_server'] = \"off\"\n     59: default['jenkins']['http_proxy']['server_auth_method'] = nil\n     60: \n     61: default['jenkins']['http_proxy']['ssl']['enabled'] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['proxy_username'] = nil #  /.*/", "line": 82, "detection_span": [77, 87], "with_context": "\ndefault['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['protected_multilib'] = nil # /.*/\ndefault['yum']['main']['protected_packages'] = nil # /.*/\ndefault['yum']['main']['proxy'] = nil #  /.*/\ndefault['yum']['main']['proxy_password'] = nil #  /.*/\n82: default['yum']['main']['proxy_username'] = nil #  /.*/\ndefault['yum']['main']['password'] = nil #  /.*/\ndefault['yum']['main']['recent'] = nil # /^\\d+$/\ndefault['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['reposdir'] = nil #  /.*/\ndefault['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb\n# Target line: 82\n\n     77: default['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]\n     78: default['yum']['main']['protected_multilib'] = nil # /.*/\n     79: default['yum']['main']['protected_packages'] = nil # /.*/\n     80: default['yum']['main']['proxy'] = nil #  /.*/\n     81: default['yum']['main']['proxy_password'] = nil #  /.*/\n>>>  82: default['yum']['main']['proxy_username'] = nil #  /.*/\n     83: default['yum']['main']['password'] = nil #  /.*/\n     84: default['yum']['main']['recent'] = nil # /^\\d+$/\n     85: default['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\n     86: default['yum']['main']['reposdir'] = nil #  /.*/\n     87: default['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-libzmq-recipes-default.rb", "content": "key_server \"keyserver.ubuntu.com\"", "line": 13, "detection_span": [8, 18], "with_context": "\nend\n\nadd_apt_repository \"ppa_zeromq_lucid\" do\nurl \"http://ppa.launchpad.net/bpaquet/zeromq2-lucid/ubuntu\"\nkey \"C4832F92\"\n13:     key_server \"keyserver.ubuntu.com\"\nend\n\nend\n\nif node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-libzmq-recipes-default.rb\n# Target line: 13\n\n      8:   end\n      9: \n     10:   add_apt_repository \"ppa_zeromq_lucid\" do\n     11:     url \"http://ppa.launchpad.net/bpaquet/zeromq2-lucid/ubuntu\"\n     12:     key \"C4832F92\"\n>>>  13:     key_server \"keyserver.ubuntu.com\"\n     14:   end\n     15: \n     16: end\n     17: \n     18: if node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_bg-chef-logstash-attributes-default.rb", "content": "default['logstash']['user'] = 'logstash'", "line": 2, "detection_span": [1, 7], "with_context": "\ndefault['logstash']['basedir'] = '/opt/logstash'\n2: default['logstash']['user'] = 'logstash'\ndefault['logstash']['group'] = 'logstash'\ndefault['logstash']['join_groups'] = []\ndefault['logstash']['log_dir'] = '/var/log/logstash'\ndefault['logstash']['pid_dir'] = '/var/run/logstash'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_bg-chef-logstash-attributes-default.rb\n# Target line: 2\n\n      1: default['logstash']['basedir'] = '/opt/logstash'\n>>>   2: default['logstash']['user'] = 'logstash'\n      3: default['logstash']['group'] = 'logstash'\n      4: default['logstash']['join_groups'] = []\n      5: default['logstash']['log_dir'] = '/var/log/logstash'\n      6: default['logstash']['pid_dir'] = '/var/run/logstash'\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-attributes-zabbix.rb", "content": "default['bcpc']['zabbix']['user'] = \"zabbix\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default['bcpc']['zabbix']['user'] = \"zabbix\"\ndefault['bcpc']['zabbix']['group'] = \"adm\"\ndefault['bcpc']['zabbix']['server_port'] = 10051\ndefault['bcpc']['zabbix']['web_port'] = 7777\ndefault['bcpc']['zabbix']['scripts']['sender'] = \"/usr/local/bin/run_zabbix_sender.sh\"\ndefault['bcpc']['zabbix']['scripts']['mail'] = \"/usr/local/bin/zbx_mail.sh\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-attributes-zabbix.rb\n# Target line: 1\n\n>>>   1: default['bcpc']['zabbix']['user'] = \"zabbix\"\n      2: default['bcpc']['zabbix']['group'] = \"adm\"\n      3: default['bcpc']['zabbix']['server_port'] = 10051\n      4: default['bcpc']['zabbix']['web_port'] = 7777\n      5: default['bcpc']['zabbix']['scripts']['sender'] = \"/usr/local/bin/run_zabbix_sender.sh\"\n      6: default['bcpc']['zabbix']['scripts']['mail'] = \"/usr/local/bin/zbx_mail.sh\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-attributes-default.rb", "content": "default['deployer']['user'] = 'deploy'", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault['chef_client_updater']['post_install_action'] = 'exec'\ndefault['chef_client_updater']['version'] = chef_version.positive? ? chef_version.to_s : 'latest'\nend\n\n# deployer\n11: default['deployer']['user'] = 'deploy'\ndefault['deployer']['group'] = 'deploy'\ndefault['deployer']['home'] = \"/home/#{default['deployer']['user']}\"\n\n# fixes\ndefault['patches']['chef12_ssl_fix'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-attributes-default.rb\n# Target line: 11\n\n      6:   default['chef_client_updater']['post_install_action'] = 'exec'\n      7:   default['chef_client_updater']['version'] = chef_version.positive? ? chef_version.to_s : 'latest'\n      8: end\n      9: \n     10: # deployer\n>>>  11: default['deployer']['user'] = 'deploy'\n     12: default['deployer']['group'] = 'deploy'\n     13: default['deployer']['home'] = \"/home/#{default['deployer']['user']}\"\n     14: \n     15: # fixes\n     16: default['patches']['chef12_ssl_fix'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-web_apache-attributes-default.rb", "content": "set_unless[:web_apache][:ssl_certificate] = nil", "line": 42, "detection_span": [37, 47], "with_context": "\nset[:apache][:config_subdir] = \"httpd\"\nend\n\n# Disabling ssl by default\nset_unless[:web_apache][:ssl_enable] = false\n42: set_unless[:web_apache][:ssl_certificate] = nil\nset_unless[:web_apache][:ssl_certificate_chain] = nil\nset_unless[:web_apache][:ssl_key] = nil\nset_unless[:web_apache][:ssl_passphrase] = nil\n\n# Apache document root", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-web_apache-attributes-default.rb\n# Target line: 42\n\n     37:   set[:apache][:config_subdir] = \"httpd\"\n     38: end\n     39: \n     40: # Disabling ssl by default\n     41: set_unless[:web_apache][:ssl_enable] = false\n>>>  42: set_unless[:web_apache][:ssl_certificate] = nil\n     43: set_unless[:web_apache][:ssl_certificate_chain] = nil\n     44: set_unless[:web_apache][:ssl_key] = nil\n     45: set_unless[:web_apache][:ssl_passphrase] = nil\n     46: \n     47: # Apache document root\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_show_path_bar.rb", "content": "key 'ShowPathbar'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Show path bar in Finder\" do\ndomain 'com.apple.finder'\n3:   key 'ShowPathbar'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_show_path_bar.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Show path bar in Finder\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'ShowPathbar'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-vncproxy.rb", "content": "key_grp = \"root\"", "line": 73, "detection_span": [68, 78], "with_context": "\naction :modify\nmembers \"nova\"\nappend true\nend\nelse\n73:     key_grp = \"root\"\nend\n\ncookbook_file key_file do\nsource node[\"nova\"][\"services\"][\"novnc-proxy\"][\"key_file\"]\nmode 0640", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-vncproxy.rb\n# Target line: 73\n\n     68:       action :modify\n     69:       members \"nova\"\n     70:       append true\n     71:     end\n     72:   else\n>>>  73:     key_grp = \"root\"\n     74:   end\n     75: \n     76:   cookbook_file key_file do\n     77:     source node[\"nova\"][\"services\"][\"novnc-proxy\"][\"key_file\"]\n     78:     mode 0640\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-postgres-attributes-default.rb", "content": "default['postgres']['user']                    = 'postgres'", "line": 2, "detection_span": [1, 7], "with_context": "\n\n2: default['postgres']['user']                    = 'postgres'\ndefault['postgres']['group']                   = 'postgres'\ndefault['postgres']['service']                 = 'postgres'\n# VERSION_ABBR is the major/minor version, ie 92 for 9.2.1\n# Patch version changes in PG are binary swappable\ndefault['postgres']['data_dir']                = '/var/pgsql/data%VERSION_ABBR%'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-postgres-attributes-default.rb\n# Target line: 2\n\n      1: \n>>>   2: default['postgres']['user']                    = 'postgres'\n      3: default['postgres']['group']                   = 'postgres'\n      4: default['postgres']['service']                 = 'postgres'\n      5:                                                # VERSION_ABBR is the major/minor version, ie 92 for 9.2.1\n      6:                                                # Patch version changes in PG are binary swappable\n      7: default['postgres']['data_dir']                = '/var/pgsql/data%VERSION_ABBR%'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-image-recipes-identity_registration.rb", "content": "service_pass = get_password 'service', 'openstack-image'", "line": 40, "detection_span": [35, 45], "with_context": "\nadmin_user = node['openstack']['identity']['admin_user']\nadmin_pass = get_password 'user', admin_user\nadmin_project = node['openstack']['identity']['admin_project']\nadmin_domain = node['openstack']['identity']['admin_domain_name']\n\n40: service_pass = get_password 'service', 'openstack-image'\nservice_project =\nnode['openstack']['image_api']['conf']['keystone_authtoken']['project_name']\nservice_user =\nnode['openstack']['image_api']['conf']['keystone_authtoken']['username']\nservice_role = node['openstack']['image']['service_role']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-image-recipes-identity_registration.rb\n# Target line: 40\n\n     35: admin_user = node['openstack']['identity']['admin_user']\n     36: admin_pass = get_password 'user', admin_user\n     37: admin_project = node['openstack']['identity']['admin_project']\n     38: admin_domain = node['openstack']['identity']['admin_domain_name']\n     39: \n>>>  40: service_pass = get_password 'service', 'openstack-image'\n     41: service_project =\n     42:   node['openstack']['image_api']['conf']['keystone_authtoken']['project_name']\n     43: service_user =\n     44:   node['openstack']['image_api']['conf']['keystone_authtoken']['username']\n     45: service_role = node['openstack']['image']['service_role']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~snapshot.rb", "content": "snapshot_encryption_key(", "line": 76, "detection_span": [71, 81], "with_context": "\ncredential 'mycred'\nend\n\ngcompute_snapshot 'chef-e2e-data-disk-snapshot-1' do\naction :create\n76:   snapshot_encryption_key(\nraw_key: 'VGhpcyBpcyBhbiBlbmNyeXB0ZWQgc25hcHNob3QhISE='\n)\nsource_disk_encryption_key(\nraw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~snapshot.rb\n# Target line: 76\n\n     71:   credential 'mycred'\n     72: end\n     73: \n     74: gcompute_snapshot 'chef-e2e-data-disk-snapshot-1' do\n     75:   action :create\n>>>  76:   snapshot_encryption_key(\n     77:     raw_key: 'VGhpcyBpcyBhbiBlbmNyeXB0ZWQgc25hcHNob3QhISE='\n     78:   )\n     79:   source_disk_encryption_key(\n     80:     raw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n     81:   )\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-common-resources-database.rb", "content": "super_password = get_password 'db', user_key", "line": 38, "detection_span": [33, 43], "with_context": "\naction :create do\nservice_info = db new_resource.service\ndb_name = service_info['db_name']\ndb_type = service_info['service_type']\nuser_key = node['openstack']['db']['root_user_key']\n38:   super_password = get_password 'db', user_key\n\nmariadb_database db_name do\nencoding node['openstack']['db']['charset'][db_type]\npassword super_password\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-common-resources-database.rb\n# Target line: 38\n\n     33: action :create do\n     34:   service_info = db new_resource.service\n     35:   db_name = service_info['db_name']\n     36:   db_type = service_info['service_type']\n     37:   user_key = node['openstack']['db']['root_user_key']\n>>>  38:   super_password = get_password 'db', user_key\n     39: \n     40:   mariadb_database db_name do\n     41:     encoding node['openstack']['db']['charset'][db_type]\n     42:     password super_password\n     43:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "tmzullinger_fedora-ansible-roles-docker-distribution-defaults-main.yml", "content": "key_src: \"ca.key\"", "line": 29, "detection_span": [24, 34], "with_context": "# Ansible file: tmzullinger_fedora-ansible-roles-docker-distribution-defaults-main.yml\n\n# Cert information to place certificate files on system\ncert:\ndest_dir: \"/etc/pki/docker/{{ inventory_hostname }}{{ http.addr }}\"\ncert_src: \"ca.crt\"\ncert_dest: \"ca.crt\"\n29:   key_src: \"ca.key\"\nkey_dest: \"ca.key\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: tmzullinger_fedora-ansible-roles-docker-distribution-defaults-main.yml\n# Target line: 29\n\n     24: # Cert information to place certificate files on system\n     25: cert:\n     26:   dest_dir: \"/etc/pki/docker/{{ inventory_hostname }}{{ http.addr }}\"\n     27:   cert_src: \"ca.crt\"\n     28:   cert_dest: \"ca.crt\"\n>>>  29:   key_src: \"ca.key\"\n     30:   key_dest: \"ca.key\"\n     31: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mdw-at-linuxbox_ceph-ansible-roles-ceph-mon-defaults-main.yml", "content": "- { name: client.gnocchi, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_gnocchi_pool.name }}\", mode: \"0600\", acls: [] }", "line": 102, "detection_span": [97, 107], "with_context": "# Ansible file: mdw-at-linuxbox_ceph-ansible-roles-ceph-mon-defaults-main.yml\n\n# acls: [\"u:nova:r--\", \"u:cinder:r--\", \"u:glance:r--\", \"u:gnocchi:r--\"]\nopenstack_keys:\n- { name: client.glance, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: [] }\n100:   - { name: client.cinder, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: []  }\n101:   - { name: client.cinder-backup, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n102:   - { name: client.gnocchi, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_gnocchi_pool.name }}\", mode: \"0600\", acls: [] }\n103:   - { name: client.openstack, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n104:\n105: ##########\n106: # DOCKER #\n107: ##########", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: mdw-at-linuxbox_ceph-ansible-roles-ceph-mon-defaults-main.yml\n# Target line: 102\n\n     97: # acls: [\"u:nova:r--\", \"u:cinder:r--\", \"u:glance:r--\", \"u:gnocchi:r--\"]\n     98: openstack_keys:\n     99:   - { name: client.glance, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: [] }\n    100:   - { name: client.cinder, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rx pool={{ openstack_glance_pool.name }}\", mode: \"0600\", acls: []  }\n    101:   - { name: client.cinder-backup, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n>>> 102:   - { name: client.gnocchi, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_gnocchi_pool.name }}\", mode: \"0600\", acls: [] }\n    103:   - { name: client.openstack, key: \"$(ceph-authtool --gen-print-key)\", mon_cap: \"allow r\", osd_cap: \"allow class-read object_prefix rbd_children, allow rwx pool={{ openstack_glance_pool.name }}, allow rwx pool={{ openstack_nova_pool.name }}, allow rwx pool={{ openstack_cinder_pool.name }}, allow rwx pool={{ openstack_cinder_backup_pool.name }}\", mode: \"0600\", acls: [] }\n    104: \n    105: ##########\n    106: # DOCKER #\n    107: ##########\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_ceph_client-molecule-default-converge.yml", "content": "key: AQAqFN1fAAAAABAAkHoVtZxSvvRbwYtZ4LwNZA==", "line": 134, "detection_span": [129, 139], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_ceph_client-molecule-default-converge.yml\n\nkeys:\n- caps:\nmgr: allow *\nmon: profile rbd\nosd: profile rbd pool=vms, profile rbd pool=volumes, profile rbd pool=images\n134:                 key: AQAqFN1fAAAAABAAkHoVtZxSvvRbwYtZ4LwNZA==\nmode: '0600'\nname: client.openstack\n- cluster: dcn1\nceph_conf_overrides:\nclient:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_ceph_client-molecule-default-converge.yml\n# Target line: 134\n\n    129:             keys:\n    130:               - caps:\n    131:                   mgr: allow *\n    132:                   mon: profile rbd\n    133:                   osd: profile rbd pool=vms, profile rbd pool=volumes, profile rbd pool=images\n>>> 134:                 key: AQAqFN1fAAAAABAAkHoVtZxSvvRbwYtZ4LwNZA==\n    135:                 mode: '0600'\n    136:                 name: client.openstack\n    137:           - cluster: dcn1\n    138:             ceph_conf_overrides:\n    139:               client:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "litmuschaos_litmus-monitoring-utils-metrics-exporters-kube-state-metrics-deployment.yaml", "content": "runAsUser: 65534", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: litmuschaos_litmus-monitoring-utils-metrics-exporters-kube-state-metrics-deployment.yaml\n\nrelease: prometheus-stack\nspec:\ncontainers:\n- image: k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.0.0-beta\nsecurityContext:\n25:             runAsUser: 65534\nlivenessProbe:\nhttpGet:\npath: /healthz\nport: 8080\ninitialDelaySeconds: 5", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: litmuschaos_litmus-monitoring-utils-metrics-exporters-kube-state-metrics-deployment.yaml\n# Target line: 25\n\n     20:         release: prometheus-stack\n     21:     spec:\n     22:       containers:\n     23:         - image: k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.0.0-beta\n     24:           securityContext:\n>>>  25:             runAsUser: 65534\n     26:           livenessProbe:\n     27:             httpGet:\n     28:               path: /healthz\n     29:               port: 8080\n     30:             initialDelaySeconds: 5\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "davestephens_ansible-nas-roles-gitlab-tasks-main.yml", "content": "update_password: on_create", "line": 25, "detection_span": [20, 30], "with_context": "# Ansible file: davestephens_ansible-nas-roles-gitlab-tasks-main.yml\n\nuser:\nname: gitlab\nuid: 998\nstate: present\nsystem: yes\n25:     update_password: on_create\ncreate_home: no\ngroup: gitlab\n\n- name: Create Gitlab Directories\nfile:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: davestephens_ansible-nas-roles-gitlab-tasks-main.yml\n# Target line: 25\n\n     20:   user:\n     21:     name: gitlab\n     22:     uid: 998\n     23:     state: present\n     24:     system: yes\n>>>  25:     update_password: on_create\n     26:     create_home: no\n     27:     group: gitlab\n     28: \n     29: - name: Create Gitlab Directories\n     30:   file:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ComplianceAsCode_content-products-example-product.yml", "content": "cpes_root: \"../../shared/applicability\"", "line": 14, "detection_span": [9, 19], "with_context": "# Ansible file: ComplianceAsCode_content-products-example-product.yml\n\n\npkg_manager: \"dnf\"\n\ninit_system: \"systemd\"\n\n14: cpes_root: \"../../shared/applicability\"\ncpes:\n- example:\nname: \"cpe:/o:example\"\ntitle: \"Example\"\ncheck_id: installed_OS_is_part_of_Unix_family", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: ComplianceAsCode_content-products-example-product.yml\n# Target line: 14\n\n      9: \n     10: pkg_manager: \"dnf\"\n     11: \n     12: init_system: \"systemd\"\n     13: \n>>>  14: cpes_root: \"../../shared/applicability\"\n     15: cpes:\n     16:   - example:\n     17:       name: \"cpe:/o:example\"\n     18:       title: \"Example\"\n     19:       check_id: installed_OS_is_part_of_Unix_family\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml", "content": "voot_oidcng_checkToken_secret: secret", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n\n\nteams_authz_client_secret: secret\nteams_migration_secret_key: secret\n\nvoot_resource_checking_secret: secret\n44: voot_oidcng_checkToken_secret: secret\n\nexternal_group_provider_secrets:\nteams: secret\n\nteams_api_lifecycle_password: secret", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: OpenConext_OpenConext-deploy-environments-template-secrets-skeleton.yml\n# Target line: 44\n\n     39: \n     40: teams_authz_client_secret: secret\n     41: teams_migration_secret_key: secret\n     42: \n     43: voot_resource_checking_secret: secret\n>>>  44: voot_oidcng_checkToken_secret: secret\n     45: \n     46: external_group_provider_secrets:\n     47:   teams: secret\n     48: \n     49: teams_api_lifecycle_password: secret\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Kishorem05_ansible-lamp-infrastructure-provisioners-aws.yml", "content": "host_key_checking: false", "line": 107, "detection_span": [102, 112], "with_context": "# Ansible file: Kishorem05_ansible-lamp-infrastructure-provisioners-aws.yml\n\nadd_host:\nname: \"{{ item.1.tagged_instances.0.public_ip }}\"\ngroups: \"aws,{{ item.1.item.group }},{{ item.1.item.name }}\"\n# You can dynamically add inventory variables per-host.\nansible_user: centos\n107:         host_key_checking: false\nmysql_replication_role: >-\n{{ 'master' if (item.1.item.name == 'a4d.lamp.db.1')\nelse 'slave' }}\nmysql_server_id: \"{{ item.0 }}\"\nwhen: item.1.instances is defined", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Kishorem05_ansible-lamp-infrastructure-provisioners-aws.yml\n# Target line: 107\n\n    102:       add_host:\n    103:         name: \"{{ item.1.tagged_instances.0.public_ip }}\"\n    104:         groups: \"aws,{{ item.1.item.group }},{{ item.1.item.name }}\"\n    105:         # You can dynamically add inventory variables per-host.\n    106:         ansible_user: centos\n>>> 107:         host_key_checking: false\n    108:         mysql_replication_role: >-\n    109:           {{ 'master' if (item.1.item.name == 'a4d.lamp.db.1')\n    110:           else 'slave' }}\n    111:         mysql_server_id: \"{{ item.0 }}\"\n    112:       when: item.1.instances is defined\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml", "content": "secret: registry-certificates", "line": 84, "detection_span": [79, 89], "with_context": "# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n\nregister: create_registry_certificates_secret_out\n\n- name: Add the secret to the registry's pod service accounts\noc_serviceaccount_secret:\nservice_account: \"{{ item }}\"\n84:     secret: registry-certificates\nnamespace: \"{{ openshift_hosted_registry_namespace }}\"\nwith_items:\n- registry\n- default\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: gloria-sentinella_openshift-ansible-roles-openshift_hosted-tasks-secure.yml\n# Target line: 84\n\n     79:   register: create_registry_certificates_secret_out\n     80: \n     81: - name: Add the secret to the registry's pod service accounts\n     82:   oc_serviceaccount_secret:\n     83:     service_account: \"{{ item }}\"\n>>>  84:     secret: registry-certificates\n     85:     namespace: \"{{ openshift_hosted_registry_namespace }}\"\n     86:   with_items:\n     87:   - registry\n     88:   - default\n     89: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dellhpc_omnia-control_plane-input_params-ethernet_tor_vars.yml", "content": "admin: up", "line": 53, "detection_span": [48, 58], "with_context": "# Ansible file: dellhpc_omnia-control_plane-input_params-ethernet_tor_vars.yml\n\nethernet 1/1/7:\ndesc: \"Port 7\"\nadmin: up\nethernet 1/1/8:\ndesc: \"Port 8\"\n53:       admin: up\nethernet 1/1/9:\ndesc: \"Port 9\"\nadmin: up\nethernet 1/1/10:\ndesc: \"Port 10\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dellhpc_omnia-control_plane-input_params-ethernet_tor_vars.yml\n# Target line: 53\n\n     48:     ethernet 1/1/7:\n     49:       desc: \"Port 7\"\n     50:       admin: up\n     51:     ethernet 1/1/8:\n     52:       desc: \"Port 8\"\n>>>  53:       admin: up\n     54:     ethernet 1/1/9:\n     55:       desc: \"Port 9\"\n     56:       admin: up\n     57:     ethernet 1/1/10:\n     58:       desc: \"Port 10\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml", "content": "- key: \"instance_filter\"", "line": 57, "detection_span": [52, 62], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n\ntags:\n- key: \"AnsibleGroup\"\nvalue: \"bastions\"\n- key: \"ostype\"\nvalue: \"linux\"\n57:       - key: \"instance_filter\"\nvalue: \"{{ env_type }}-{{ email }}\"\n\n- name: \"frontend\"\ncount: \"{{ frontend_instance_count | default(1) }}\"\npublic_dns: false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n# Target line: 57\n\n     52:     tags:\n     53:       - key: \"AnsibleGroup\"\n     54:         value: \"bastions\"\n     55:       - key: \"ostype\"\n     56:         value: \"linux\"\n>>>  57:       - key: \"instance_filter\"\n     58:         value: \"{{ env_type }}-{{ email }}\"\n     59: \n     60:   - name: \"frontend\"\n     61:     count: \"{{ frontend_instance_count | default(1) }}\"\n     62:     public_dns: false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml", "content": "ceilometer_oslomsg_rpc_userid: ceilometer", "line": 21, "detection_span": [16, 26], "with_context": "# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n\nceilometer_service_user_name: \"{{ hostvars['localhost']['ceilometer_service_user_name'] }}\"\nceilometer_service_tenant_name: \"{{ hostvars['localhost']['ceilometer_service_tenant_name'] }}\"\n\n# TODO(ansmith): remove rabbitmq vars once service file is updated\n# to use oslomsg vars\n21: ceilometer_oslomsg_rpc_userid: ceilometer\nceilometer_oslomsg_rpc_vhost: /ceilometer\nceilometer_oslomsg_notify_userid: ceilometer\nceilometer_oslomsg_notify_vhost: /ceilometer\n\n# These are here rather than in ceilometer_all because", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-ceilometer_all.yml\n# Target line: 21\n\n     16: ceilometer_service_user_name: \"{{ hostvars['localhost']['ceilometer_service_user_name'] }}\"\n     17: ceilometer_service_tenant_name: \"{{ hostvars['localhost']['ceilometer_service_tenant_name'] }}\"\n     18: \n     19: # TODO(ansmith): remove rabbitmq vars once service file is updated\n     20: # to use oslomsg vars\n>>>  21: ceilometer_oslomsg_rpc_userid: ceilometer\n     22: ceilometer_oslomsg_rpc_vhost: /ceilometer\n     23: ceilometer_oslomsg_notify_userid: ceilometer\n     24: ceilometer_oslomsg_notify_vhost: /ceilometer\n     25: \n     26: # These are here rather than in ceilometer_all because\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-pntae-jabn-default_vars_osp.yml", "content": "ansible_user: cloud-user", "line": 2, "detection_span": [1, 7], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-pntae-jabn-default_vars_osp.yml\n\n---\n2: ansible_user: cloud-user\nremote_user: cloud-user\n\nchomped_zone_internal_dns: \"example.com\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-pntae-jabn-default_vars_osp.yml\n# Target line: 2\n\n      1: ---\n>>>   2: ansible_user: cloud-user\n      3: remote_user: cloud-user\n      4: \n      5: chomped_zone_internal_dns: \"example.com\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "geerlingguy_drupal-vm-provisioning-roles-geerlingguy.nodejs-molecule-default-playbook-latest.yml", "content": "nodejs_install_npm_user: root", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.nodejs-molecule-default-playbook-latest.yml\n\nhosts: all\nbecome: true\n\nvars:\nnodejs_version: \"13.x\"\n8:     nodejs_install_npm_user: root\nnpm_config_prefix: /root/.npm-global\nnpm_config_unsafe_perm: \"true\"\nnodejs_npm_global_packages:\n- slugify\n- name: jslint", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: geerlingguy_drupal-vm-provisioning-roles-geerlingguy.nodejs-molecule-default-playbook-latest.yml\n# Target line: 8\n\n      3:   hosts: all\n      4:   become: true\n      5: \n      6:   vars:\n      7:     nodejs_version: \"13.x\"\n>>>   8:     nodejs_install_npm_user: root\n      9:     npm_config_prefix: /root/.npm-global\n     10:     npm_config_unsafe_perm: \"true\"\n     11:     nodejs_npm_global_packages:\n     12:       - slugify\n     13:       - name: jslint\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jcalazan_ansible-django-stack-roles-base-defaults-main.yml", "content": "server_user: root", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: jcalazan_ansible-django-stack-roles-base-defaults-main.yml\n\n---\n\nansible_python_interpreter: /usr/bin/python3\n\n5: server_user: root\n\nbase_python_package: \"{{ ansible_python_interpreter | default('/usr/bin/python') | basename }}\"\n\ncreate_swap_file: false\nswap_file_path: /swapfile", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: jcalazan_ansible-django-stack-roles-base-defaults-main.yml\n# Target line: 5\n\n      1: ---\n      2: \n      3: ansible_python_interpreter: /usr/bin/python3\n      4: \n>>>   5: server_user: root\n      6: \n      7: base_python_package: \"{{ ansible_python_interpreter | default('/usr/bin/python') | basename }}\"\n      8: \n      9: create_swap_file: false\n     10: swap_file_path: /swapfile\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cfpb_aurora-deploy-roles-redis-defaults-main.yml", "content": "redis_user:                             redis", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: cfpb_aurora-deploy-roles-redis-defaults-main.yml\n\n---\n\nepel_repo_url:                          \"https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\"\n4: redis_user:                             redis\nredis_user_shell:                       \"/bin/false\"\nredis_group:                            \"{{ redis_user }}\"\nredis_user_groups:                      []\nredis_pidfile:                          /var/run/redis/redis.{{ redis_port }}\nredis_db_dir:                           /var/lib/redis", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: cfpb_aurora-deploy-roles-redis-defaults-main.yml\n# Target line: 4\n\n      1: ---\n      2: \n      3: epel_repo_url:                          \"https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm\" \n>>>   4: redis_user:                             redis\n      5: redis_user_shell:                       \"/bin/false\"\n      6: redis_group:                            \"{{ redis_user }}\"\n      7: redis_user_groups:                      []\n      8: redis_pidfile:                          /var/run/redis/redis.{{ redis_port }}\n      9: redis_db_dir:                           /var/lib/redis\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper_contrail-ansible-playbooks-roles-docker-vars-RedHat.yml", "content": "docker_ssl_key_pki_cert_dir : /etc/pki/tls/certs", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: Juniper_contrail-ansible-playbooks-roles-docker-vars-RedHat.yml\n\n---\ndocker_ssl_key_pki_cacert_dir : /etc/pki/ca-trust/source/anchors\n3: docker_ssl_key_pki_cert_dir : /etc/pki/tls/certs\ndocker_ssl_key_pki_key_dir : /etc/pki/tls/private\n\ndocker_options_var: OPTIONS\ndocker_env_file: \"{{ '/etc/sysconfig/docker' if ansible_distribution != 'RedHat' else '/etc/docker/daemon.json' }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: Juniper_contrail-ansible-playbooks-roles-docker-vars-RedHat.yml\n# Target line: 3\n\n      1: ---\n      2: docker_ssl_key_pki_cacert_dir : /etc/pki/ca-trust/source/anchors\n>>>   3: docker_ssl_key_pki_cert_dir : /etc/pki/tls/certs\n      4: docker_ssl_key_pki_key_dir : /etc/pki/tls/private\n      5: \n      6: docker_options_var: OPTIONS\n      7: docker_env_file: \"{{ '/etc/sysconfig/docker' if ansible_distribution != 'RedHat' else '/etc/docker/daemon.json' }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "social-network_matrix-deployer-roles-matrix-bridge-appservice-webhooks-defaults-main.yml", "content": "matrix_appservice_webhooks_id_token: ''", "line": 46, "detection_span": [41, 51], "with_context": "# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-webhooks-defaults-main.yml\n\n# List of systemd services that matrix-appservice-webhooks.service wants\nmatrix_appservice_webhooks_systemd_wanted_services_list: []\n\nmatrix_appservice_webhooks_appservice_token: ''\nmatrix_appservice_webhooks_homeserver_token: ''\n46: matrix_appservice_webhooks_id_token: ''\nmatrix_appservice_webhooks_api_secret: ''\n\n# Logging information (info and verbose is available) default is: info\nmatrix_appservice_webhooks_log_level: 'info'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: social-network_matrix-deployer-roles-matrix-bridge-appservice-webhooks-defaults-main.yml\n# Target line: 46\n\n     41: # List of systemd services that matrix-appservice-webhooks.service wants\n     42: matrix_appservice_webhooks_systemd_wanted_services_list: []\n     43: \n     44: matrix_appservice_webhooks_appservice_token: ''\n     45: matrix_appservice_webhooks_homeserver_token: ''\n>>>  46: matrix_appservice_webhooks_id_token: ''\n     47: matrix_appservice_webhooks_api_secret: ''\n     48: \n     49: # Logging information (info and verbose is available) default is: info\n     50: matrix_appservice_webhooks_log_level: 'info'\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "AlexPrem_Openstack-Ansible-inventory-group_vars-aodh_all.yml", "content": "aodh_oslomsg_notify_userid: aodh", "line": 26, "detection_span": [21, 31], "with_context": "# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-aodh_all.yml\n\n\n# TODO(ansmith): remove rabbitmq vars once service file is updated\n# to use oslomsg vars\naodh_oslomsg_rpc_userid: aodh\naodh_oslomsg_rpc_vhost: /aodh\n26: aodh_oslomsg_notify_userid: aodh\naodh_oslomsg_notify_vhost: /aodh\n\naodh_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\n\naodh_service_in_ldap: \"{{ service_ldap_backend_enabled }}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: AlexPrem_Openstack-Ansible-inventory-group_vars-aodh_all.yml\n# Target line: 26\n\n     21: \n     22: # TODO(ansmith): remove rabbitmq vars once service file is updated\n     23: # to use oslomsg vars\n     24: aodh_oslomsg_rpc_userid: aodh\n     25: aodh_oslomsg_rpc_vhost: /aodh\n>>>  26: aodh_oslomsg_notify_userid: aodh\n     27: aodh_oslomsg_notify_vhost: /aodh\n     28: \n     29: aodh_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\n     30: \n     31: aodh_service_in_ldap: \"{{ service_ldap_backend_enabled }}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml", "content": "- key: \"ostype\"", "line": 55, "detection_span": [50, 60], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n\nsecurity_groups:\n- BastionSG\ntags:\n- key: \"AnsibleGroup\"\nvalue: \"bastions\"\n55:       - key: \"ostype\"\nvalue: \"linux\"\n- key: \"instance_filter\"\nvalue: \"{{ env_type }}-{{ email }}\"\n\n- name: \"frontend\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-hacluster-pntae-default_vars_osp.yml\n# Target line: 55\n\n     50:     security_groups:\n     51:       - BastionSG\n     52:     tags:\n     53:       - key: \"AnsibleGroup\"\n     54:         value: \"bastions\"\n>>>  55:       - key: \"ostype\"\n     56:         value: \"linux\"\n     57:       - key: \"instance_filter\"\n     58:         value: \"{{ env_type }}-{{ email }}\"\n     59: \n     60:   - name: \"frontend\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "freeipa_ansible-freeipa-playbooks-privilege-privilege-member-present.yml", "content": "ipaadmin_password: SomeADMINpassword", "line": 9, "detection_span": [4, 14], "with_context": "# Ansible file: freeipa_ansible-freeipa-playbooks-privilege-privilege-member-present.yml\n\nbecome: true\n\ntasks:\n- name: Ensure privilege \"Broad Privilege\" permissions are present\nipaprivilege:\n9:       ipaadmin_password: SomeADMINpassword\nname: Broad Privilege\npermission:\n- \"System: Write IPA Configuration\"\n- \"System: Write DNS Configuration\"\n- \"System: Update DNS Entries\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: freeipa_ansible-freeipa-playbooks-privilege-privilege-member-present.yml\n# Target line: 9\n\n      4:   become: true\n      5: \n      6:   tasks:\n      7:   - name: Ensure privilege \"Broad Privilege\" permissions are present\n      8:     ipaprivilege:\n>>>   9:       ipaadmin_password: SomeADMINpassword\n     10:       name: Broad Privilege\n     11:       permission:\n     12:       - \"System: Write IPA Configuration\"\n     13:       - \"System: Write DNS Configuration\"\n     14:       - \"System: Update DNS Entries\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dellhpc_omnia-platforms-roles-polyaxon-files-polyaxon_config.yaml", "content": "cookieSecret: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"", "line": 5, "detection_span": [1, 10], "with_context": "# Ansible file: dellhpc_omnia-platforms-roles-polyaxon-files-polyaxon_config.yaml\n\nproxy:\nsecretToken: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\n\nhub:\n5:   cookieSecret: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\nservice:\ntype: LoadBalancer\ndb:\ntype: sqlite-pvc\nextraConfig:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: dellhpc_omnia-platforms-roles-polyaxon-files-polyaxon_config.yaml\n# Target line: 5\n\n      1: proxy:\n      2:   secretToken: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\n      3: \n      4: hub:\n>>>   5:   cookieSecret: \"1c8572f630701e8792bede122ec9c4179d9087f801e1a85ed32cce69887aec1b\"\n      6:   service:\n      7:     type: LoadBalancer\n      8:   db:\n      9:     type: sqlite-pvc\n     10:   extraConfig:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chz8494_tdlab-openstack-playbooks-inventory-group_vars-barbican_all.yml", "content": "barbican_rabbitmq_userid: barbican", "line": 28, "detection_span": [23, 33], "with_context": "# Ansible file: chz8494_tdlab-openstack-playbooks-inventory-group_vars-barbican_all.yml\n\n\nbarbican_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\nbarbican_rabbitmq_port: \"{{ rabbitmq_port }}\"\nbarbican_rabbitmq_servers: \"{{ rabbitmq_servers }}\"\nbarbican_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n28: barbican_rabbitmq_userid: barbican\nbarbican_rabbitmq_vhost: /barbican\n\n# venv fetch configuration\nbarbican_venv_tag: \"{{ venv_tag }}\"\nbarbican_venv_download_url: \"{{ venv_base_download_url }}/barbican-{{ openstack_release }}-{{ ansible_architecture | lower }}.tgz\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: chz8494_tdlab-openstack-playbooks-inventory-group_vars-barbican_all.yml\n# Target line: 28\n\n     23: \n     24: barbican_rabbitmq_host_group: \"{{ rabbitmq_host_group }}\"\n     25: barbican_rabbitmq_port: \"{{ rabbitmq_port }}\"\n     26: barbican_rabbitmq_servers: \"{{ rabbitmq_servers }}\"\n     27: barbican_rabbitmq_use_ssl: \"{{ rabbitmq_use_ssl }}\"\n>>>  28: barbican_rabbitmq_userid: barbican\n     29: barbican_rabbitmq_vhost: /barbican\n     30: \n     31: # venv fetch configuration\n     32: barbican_venv_tag: \"{{ venv_tag }}\"\n     33: barbican_venv_download_url: \"{{ venv_base_download_url }}/barbican-{{ openstack_release }}-{{ ansible_architecture | lower }}.tgz\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_keystone_resources-tasks-admin.yml", "content": "user: admin", "line": 61, "detection_span": [56, 66], "with_context": "# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_keystone_resources-tasks-admin.yml\n\nrole: admin\n\n- name: Assign _member_ role to admin project for admin user\nopenstack.cloud.role_assignment:\ncloud: \"{{ tripleo_keystone_resources_cloud_name }}\"\n61:     user: admin\nproject: admin\nrole: '_member_'\nwhen:\n- keystone_enable_member | default(tripleo_keystone_resources_member_role_enabled)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_tripleo-ansible-tripleo_ansible-roles-tripleo_keystone_resources-tasks-admin.yml\n# Target line: 61\n\n     56:     role: admin\n     57: \n     58: - name: Assign _member_ role to admin project for admin user\n     59:   openstack.cloud.role_assignment:\n     60:     cloud: \"{{ tripleo_keystone_resources_cloud_name }}\"\n>>>  61:     user: admin\n     62:     project: admin\n     63:     role: '_member_'\n     64:   when:\n     65:     - keystone_enable_member | default(tripleo_keystone_resources_member_role_enabled)\n     66: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml", "content": "helm_charts_url: \"http://{{ controller_floating_address | ipwrap }}:{{ helm_repo_port }}/helm_charts\"", "line": 44, "detection_span": [39, 49], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n\nexecutable: /usr/bin/python\nregister: helm_sql_database_password\n\n- name: Set Armada overrides\nset_fact:\n44:     helm_charts_url: \"http://{{ controller_floating_address | ipwrap }}:{{ helm_repo_port }}/helm_charts\"\nhelm_sql_connection_address: \"postgresql://admin-helmv2:{{ helm_sql_database_password.stdout }}@{{\ncontroller_floating_address | ipwrap }}:5432/helmv2?sslmode=disable\"\nhelm_sql_endpoint_ip: \"{{ controller_floating_address | ipwrap }}\"\n\n- name: Configure and launch containerized Armada", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-roles-common-armada-helm-tasks-main.yml\n# Target line: 44\n\n     39:     executable: /usr/bin/python\n     40:   register: helm_sql_database_password\n     41: \n     42: - name: Set Armada overrides\n     43:   set_fact:\n>>>  44:     helm_charts_url: \"http://{{ controller_floating_address | ipwrap }}:{{ helm_repo_port }}/helm_charts\"\n     45:     helm_sql_connection_address: \"postgresql://admin-helmv2:{{ helm_sql_database_password.stdout }}@{{\n     46:                                   controller_floating_address | ipwrap }}:5432/helmv2?sslmode=disable\"\n     47:     helm_sql_endpoint_ip: \"{{ controller_floating_address | ipwrap }}\"\n     48: \n     49: - name: Configure and launch containerized Armada\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "NationalGenomicsInfrastructure_irma-provision-roles-tarzan-tasks-main.yml", "content": "# FIXME: Couldn't get this to work properly with supervisord because", "line": 57, "detection_span": [52, 62], "with_context": "# Ansible file: NationalGenomicsInfrastructure_irma-provision-roles-tarzan-tasks-main.yml\n\ncopy: src=\"tarzan_cert.pem\" dest=\"{{ tarzan_conf }}/tarzan_cert.pem\"\n\n- name: deploy ssl key for kong\ncopy: src=\"tarzan_key.pem\" dest=\"{{ tarzan_conf }}/tarzan_key.pem\"\n\n57: # FIXME: Couldn't get this to work properly with supervisord because\n# it demands that the program under control doesn't daemonize.\n# (The kong binary itself spawns nginx and self binaries)\n- name: modify uppsala's crontab to start kong\nlineinfile: dest=\"{{ ngi_pipeline_conf }}/crontab_upps\"\nline='# restart kong if it has died for some reason'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: NationalGenomicsInfrastructure_irma-provision-roles-tarzan-tasks-main.yml\n# Target line: 57\n\n     52:   copy: src=\"tarzan_cert.pem\" dest=\"{{ tarzan_conf }}/tarzan_cert.pem\"\n     53: \n     54: - name: deploy ssl key for kong \n     55:   copy: src=\"tarzan_key.pem\" dest=\"{{ tarzan_conf }}/tarzan_key.pem\"\n     56: \n>>>  57: # FIXME: Couldn't get this to work properly with supervisord because \n     58: # it demands that the program under control doesn't daemonize. \n     59: # (The kong binary itself spawns nginx and self binaries)\n     60: - name: modify uppsala's crontab to start kong\n     61:   lineinfile: dest=\"{{ ngi_pipeline_conf }}/crontab_upps\"\n     62:               line='# restart kong if it has died for some reason'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "carlosthe19916_openshift-ansible-roles-openshift_common-vars-main.yml", "content": "# TODO: it might be possible to still use firewalld if we wire up the created", "line": 4, "detection_span": [1, 9], "with_context": "# Ansible file: carlosthe19916_openshift-ansible-roles-openshift_common-vars-main.yml\n\n---\n# TODO: Upstream kubernetes only supports iptables currently, if this changes,\n# then these variable should be moved to defaults\n4: # TODO: it might be possible to still use firewalld if we wire up the created\n# chains with the public zone (or the zone associated with the correct\n# interfaces)\nos_firewall_use_firewalld: False\n\nopenshift_data_dir: /var/lib/openshift", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: carlosthe19916_openshift-ansible-roles-openshift_common-vars-main.yml\n# Target line: 4\n\n      1: ---\n      2: # TODO: Upstream kubernetes only supports iptables currently, if this changes,\n      3: # then these variable should be moved to defaults\n>>>   4: # TODO: it might be possible to still use firewalld if we wire up the created\n      5: # chains with the public zone (or the zone associated with the correct\n      6: # interfaces)\n      7: os_firewall_use_firewalld: False\n      8: \n      9: openshift_data_dir: /var/lib/openshift\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml", "content": "#    storagePrefix: Prefix used when provisioning new volumes in the SVM", "line": 108, "detection_span": [103, 113], "with_context": "# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n\n103: #    dataLIF: IP address of protocol LIF\n104: #    svm: Storage virtual machine to use\n105: #    igroupName:  Name of the igroup for SAN volumes to use\n106: #    username:  Username to connect to the cluster/SVM\n107: #    password:  Password to connect to the cluster/SVM\n108: #    storagePrefix: Prefix used when provisioning new volumes in the SVM\n109: #    limitAggregateUsage: Fail provisioning if usage is above this percentage\n110: #    limitVolumeSize: Fail provisioning if requested volume size is above this value\n111: #    nfsMountOptions\" Comma-separated list of NFS mount options (except ontap-san)\n112: #\n113: # WARNING: It is strongly recommended to store these settings in Ansible vault", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: starlingx_ansible-playbooks-playbookconfig-src-playbooks-host_vars-netapp-default.yml\n# Target line: 108\n\n    103: #    dataLIF: IP address of protocol LIF\n    104: #    svm: Storage virtual machine to use\n    105: #    igroupName:  Name of the igroup for SAN volumes to use\n    106: #    username:  Username to connect to the cluster/SVM\n    107: #    password:  Password to connect to the cluster/SVM\n>>> 108: #    storagePrefix: Prefix used when provisioning new volumes in the SVM\n    109: #    limitAggregateUsage: Fail provisioning if usage is above this percentage\n    110: #    limitVolumeSize: Fail provisioning if requested volume size is above this value\n    111: #    nfsMountOptions\" Comma-separated list of NFS mount options (except ontap-san)\n    112: #\n    113: # WARNING: It is strongly recommended to store these settings in Ansible vault\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "litmuschaos_litmus-.github-stale.yml", "content": "# Number of days of inactivity before a stale issue is closed", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: litmuschaos_litmus-.github-stale.yml\n\n# Number of days of inactivity before an issue becomes stale\ndaysUntilStale: 60\n3: # Number of days of inactivity before a stale issue is closed\ndaysUntilClose: 7\n# Issues with these labels will never be considered stale\nexemptLabels:\n- pinned\n- security", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: litmuschaos_litmus-.github-stale.yml\n# Target line: 3\n\n      1: # Number of days of inactivity before an issue becomes stale\n      2: daysUntilStale: 60\n>>>   3: # Number of days of inactivity before a stale issue is closed\n      4: daysUntilClose: 7\n      5: # Issues with these labels will never be considered stale\n      6: exemptLabels:\n      7:   - pinned\n      8:   - security\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml", "content": "# HostedZoneId must match subdomain_base_suffix", "line": 67, "detection_span": [62, 72], "with_context": "# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n\n\n# AWS Credentials\naws_access_key_id: FROM_SECRET\naws_secret_access_key: FROM_SECRET\n\n67: # HostedZoneId must match subdomain_base_suffix\n#HostedZoneId: FROM_SECRET\nsubdomain_base_suffix: .example.com\n\n# Reserve everything in the same AZ (costs saving)\n# Set to false to spread the instances across multiple zones", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: redhat-cop_agnosticd-ansible-configs-ocp4-cluster-sample_vars-ocp4_cluster_aws_bare_bones.yml\n# Target line: 67\n\n     62: \n     63: # AWS Credentials\n     64: aws_access_key_id: FROM_SECRET\n     65: aws_secret_access_key: FROM_SECRET\n     66: \n>>>  67: # HostedZoneId must match subdomain_base_suffix\n     68: #HostedZoneId: FROM_SECRET\n     69: subdomain_base_suffix: .example.com\n     70: \n     71: # Reserve everything in the same AZ (costs saving)\n     72: # Set to false to spread the instances across multiple zones\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "suspicious_comment", "file": "keylime_keylime-vagrant-ansible-tpm-emulator-roles-ansible-keylime-tpm20-meta-main.yml", "content": "# issue_tracker_url: http://example.com/issue/tracker", "line": 8, "detection_span": [3, 13], "with_context": "# Ansible file: keylime_keylime-vagrant-ansible-tpm-emulator-roles-ansible-keylime-tpm20-meta-main.yml\n\ndescription: Ansible Keylime\ncompany: Red Hat\n\n# If the issue tracker for your role is not on github, uncomment the\n# next line and provide a value\n8:   # issue_tracker_url: http://example.com/issue/tracker\n\n# Some suggested licenses:\n# - BSD (default)\n# - MIT\n# - GPLv2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: keylime_keylime-vagrant-ansible-tpm-emulator-roles-ansible-keylime-tpm20-meta-main.yml\n# Target line: 8\n\n      3:   description: Ansible Keylime\n      4:   company: Red Hat\n      5: \n      6:   # If the issue tracker for your role is not on github, uncomment the\n      7:   # next line and provide a value\n>>>   8:   # issue_tracker_url: http://example.com/issue/tracker\n      9: \n     10:   # Some suggested licenses:\n     11:   # - BSD (default)\n     12:   # - MIT\n     13:   # - GPLv2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "weak_cryptography_algorithms", "file": "openstack_openstack-ansible-os_swift-releasenotes-notes-swift-conf-b8dd5e1199f8e4a8.yaml", "content": "- Previously, the ``ansible_managed`` var was being", "line": 3, "detection_span": [1, 8], "with_context": "# Ansible file: openstack_openstack-ansible-os_swift-releasenotes-notes-swift-conf-b8dd5e1199f8e4a8.yaml\n\n---\nfixes:\n3:   - Previously, the ``ansible_managed`` var was being\nused to insert a header into the ``swift.conf`` that\ncontained date/time information. This meant that\nswift.conf across different nodes did not have the\nsame MD5SUM, causing ``swift-recon --md5`` to break.\nWe now insert a piece of static text instead to", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in ansible.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (ansible)\n\n# Ansible file: openstack_openstack-ansible-os_swift-releasenotes-notes-swift-conf-b8dd5e1199f8e4a8.yaml\n# Target line: 3\n\n      1: ---\n      2: fixes:\n>>>   3:   - Previously, the ``ansible_managed`` var was being\n      4:     used to insert a header into the ``swift.conf`` that\n      5:     contained date/time information. This meant that\n      6:     swift.conf across different nodes did not have the\n      7:     same MD5SUM, causing ``swift-recon --md5`` to break.\n      8:     We now insert a piece of static text instead to\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-heat-keystone.pp", "content": "$configure_user      = pick($heat_hash['configure_user'], true)", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-heat-keystone.pp\n\n$admin_address     = get_ssl_property($ssl_hash, {}, 'heat', 'admin', 'hostname', [hiera('heat_endpoint', ''), $management_vip])\n\n$password            = $heat_hash['user_password']\n$auth_name           = pick($heat_hash['auth_name'], 'heat')\n$configure_endpoint  = pick($heat_hash['configure_endpoint'], true)\n24:   $configure_user      = pick($heat_hash['configure_user'], true)\n$configure_user_role = pick($heat_hash['configure_user_role'], true)\n$service_name        = pick($heat_hash['service_name'], 'heat')\n$tenant              = pick($heat_hash['tenant'], 'services')\n\nClass['::osnailyfacter::wait_for_keystone_backends'] -> Class['::heat::keystone::auth']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-heat-keystone.pp\n# Target line: 24\n\n     19:   $admin_address     = get_ssl_property($ssl_hash, {}, 'heat', 'admin', 'hostname', [hiera('heat_endpoint', ''), $management_vip])\n     20: \n     21:   $password            = $heat_hash['user_password']\n     22:   $auth_name           = pick($heat_hash['auth_name'], 'heat')\n     23:   $configure_endpoint  = pick($heat_hash['configure_endpoint'], true)\n>>>  24:   $configure_user      = pick($heat_hash['configure_user'], true)\n     25:   $configure_user_role = pick($heat_hash['configure_user_role'], true)\n     26:   $service_name        = pick($heat_hash['service_name'], 'heat')\n     27:   $tenant              = pick($heat_hash['tenant'], 'services')\n     28: \n     29:   Class['::osnailyfacter::wait_for_keystone_backends'] -> Class['::heat::keystone::auth']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-glance.pp", "content": "$username                   = 'ironic',", "line": 96, "detection_span": [91, 101], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-glance.pp\n\n#\nclass ironic::glance (\n$auth_type                  = 'password',\n$auth_url                   = $::os_service_default,\n$project_name               = 'services',\n96:   $username                   = 'ironic',\n$password                   = $::os_service_default,\n$user_domain_name           = 'Default',\n$project_domain_name        = 'Default',\n$api_servers                = $::os_service_default,\n$num_retries                = $::os_service_default,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-glance.pp\n# Target line: 96\n\n     91: #\n     92: class ironic::glance (\n     93:   $auth_type                  = 'password',\n     94:   $auth_url                   = $::os_service_default,\n     95:   $project_name               = 'services',\n>>>  96:   $username                   = 'ironic',\n     97:   $password                   = $::os_service_default,\n     98:   $user_domain_name           = 'Default',\n     99:   $project_domain_name        = 'Default',\n    100:   $api_servers                = $::os_service_default,\n    101:   $num_retries                = $::os_service_default,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-neutron-examples-neutron.pp", "content": "auth_password       => 'password',", "line": 13, "detection_span": [8, 18], "with_context": "# Puppet file: openstack@puppet-neutron-examples-neutron.pp\n\nservice_plugins       => ['metering']\n}\n\n# The API server talks to keystone for authorisation\nclass { '::neutron::server':\n13:   auth_password       => 'password',\ndatabase_connection => 'mysql+pymysql://neutron:password@192.168.1.1/neutron',\n}\n\n# Configure nova notifications system\nclass { '::neutron::server::notifications':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-neutron-examples-neutron.pp\n# Target line: 13\n\n      8:   service_plugins       => ['metering']\n      9: }\n     10: \n     11: # The API server talks to keystone for authorisation\n     12: class { '::neutron::server':\n>>>  13:   auth_password       => 'password',\n     14:   database_connection => 'mysql+pymysql://neutron:password@192.168.1.1/neutron',\n     15: }\n     16: \n     17: # Configure nova notifications system\n     18: class { '::neutron::server::notifications':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-init.pp", "content": "password => 'ignored',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-init.pp\n\n}\n\n# Setup password free auth for VM's vagrant user\nmysql::user { 'vagrant':\nensure   => present,\n38:         password => 'ignored',\ngrant    => 'ALL PRIVILEGES ON *.*',\nhostname => 'localhost',\nsocket   => true,\n}\nfile { '/home/vagrant/.my.cnf':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mysql-manifests-init.pp\n# Target line: 38\n\n     33:     }\n     34: \n     35:     # Setup password free auth for VM's vagrant user\n     36:     mysql::user { 'vagrant':\n     37:         ensure   => present,\n>>>  38:         password => 'ignored',\n     39:         grant    => 'ALL PRIVILEGES ON *.*',\n     40:         hostname => 'localhost',\n     41:         socket   => true,\n     42:     }\n     43:     file { '/home/vagrant/.my.cnf':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp", "content": "$config_admin_user = true", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n\n$endpoint_version = \"v2\"\n\nif ($keystone_version == \"v3\" ) {\n$config_admin_user = false\n} else {\n41:     $config_admin_user = true\n}\n\nclass { 'keystone::endpoint':\npublic_url   => \"${keystone_auth_protocol}://${keystone_ip_to_use}:5000\",\nadmin_url    => \"${keystone_auth_protocol}://${keystone_ip_to_use}:35357\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-provision.pp\n# Target line: 41\n\n     36:   $endpoint_version = \"v2\"\n     37: \n     38:   if ($keystone_version == \"v3\" ) {\n     39:     $config_admin_user = false\n     40:   } else {\n>>>  41:     $config_admin_user = true\n     42:   }\n     43: \n     44:   class { 'keystone::endpoint':\n     45:     public_url   => \"${keystone_auth_protocol}://${keystone_ip_to_use}:5000\",\n     46:     admin_url    => \"${keystone_auth_protocol}://${keystone_ip_to_use}:35357\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-examples-distributed-replicate-example.pp", "content": "fsuuid => '4dfa7e50-2315-44d3-909b-8e9423def6e5',", "line": 115, "detection_span": [110, 120], "with_context": "# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n\n110:\n111: \tgluster::brick { 'annex4.example.com:/mnt/storage4d':\n112: \t\tdev => '/dev/disk/by-id/scsi-36003048007e36700174029270d82724d',\t# /dev/sdd\n113: \t\tlabeltype => 'gpt',\n114: \t\tfstype => 'xfs',\n115: \t\tfsuuid => '4dfa7e50-2315-44d3-909b-8e9423def6e5',\n116: \t\txfs_inode64 => true,\n117: \t\txfs_nobarrier => true,\n118: \t\tareyousure => true,\n119: \t}\n120:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-examples-distributed-replicate-example.pp\n# Target line: 115\n\n    110: \n    111: \tgluster::brick { 'annex4.example.com:/mnt/storage4d':\n    112: \t\tdev => '/dev/disk/by-id/scsi-36003048007e36700174029270d82724d',\t# /dev/sdd\n    113: \t\tlabeltype => 'gpt',\n    114: \t\tfstype => 'xfs',\n>>> 115: \t\tfsuuid => '4dfa7e50-2315-44d3-909b-8e9423def6e5',\n    116: \t\txfs_inode64 => true,\n    117: \t\txfs_nobarrier => true,\n    118: \t\tareyousure => true,\n    119: \t}\n    120: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aeolusproject@aeolus-configure-recipes-aeolus-manifests-conductor-site_admin.pp", "content": "user        => 'aeolus',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-conductor-site_admin.pp\n\n# Create a new site admin conductor web user\ndefine aeolus::conductor::site_admin($email=\"\", $password=\"\", $first_name=\"\", $last_name=\"\"){\nexec{\"create_site_admin_user\":\ncwd         => '/usr/share/aeolus-conductor',\nenvironment => \"RAILS_ENV=production\",\n6:          user        => 'aeolus',\ncommand     => \"rake dc:create_user[${name},${password},${email},${first_name},${last_name}]\",\nunless      => 'rake dc:admin_exists',\nrequire     => Aeolus::Rails::Seed::Db[\"seed_aeolus_database\"]}\nexec{\"grant_site_admin_privs\":\ncwd         => '/usr/share/aeolus-conductor',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: aeolusproject@aeolus-configure-recipes-aeolus-manifests-conductor-site_admin.pp\n# Target line: 6\n\n      1: # Create a new site admin conductor web user\n      2: define aeolus::conductor::site_admin($email=\"\", $password=\"\", $first_name=\"\", $last_name=\"\"){\n      3:   exec{\"create_site_admin_user\":\n      4:          cwd         => '/usr/share/aeolus-conductor',\n      5:          environment => \"RAILS_ENV=production\",\n>>>   6:          user        => 'aeolus',\n      7:          command     => \"rake dc:create_user[${name},${password},${email},${first_name},${last_name}]\",\n      8:          unless      => 'rake dc:admin_exists',\n      9:          require     => Aeolus::Rails::Seed::Db[\"seed_aeolus_database\"]}\n     10:   exec{\"grant_site_admin_privs\":\n     11:          cwd         => '/usr/share/aeolus-conductor',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-manifests-mod-ldap.pp", "content": "Optional[String] $ldap_trusted_global_cert_type  = 'CA_BASE64',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-manifests-mod-ldap.pp\n\nclass apache::mod::ldap (\n$apache_version                                  = undef,\n$package_name                                    = undef,\n$ldap_trusted_global_cert_file                   = undef,\n5:   Optional[String] $ldap_trusted_global_cert_type  = 'CA_BASE64',\n$ldap_shared_cache_size                          = undef,\n$ldap_cache_entries                              = undef,\n$ldap_cache_ttl                                  = undef,\n$ldap_opcache_entries                            = undef,\n$ldap_opcache_ttl                                = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-manifests-mod-ldap.pp\n# Target line: 5\n\n      1: class apache::mod::ldap (\n      2:   $apache_version                                  = undef,\n      3:   $package_name                                    = undef,\n      4:   $ldap_trusted_global_cert_file                   = undef,\n>>>   5:   Optional[String] $ldap_trusted_global_cert_type  = 'CA_BASE64',\n      6:   $ldap_shared_cache_size                          = undef,\n      7:   $ldap_cache_entries                              = undef,\n      8:   $ldap_cache_ttl                                  = undef,\n      9:   $ldap_opcache_entries                            = undef,\n     10:   $ldap_opcache_ttl                                = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$password    = undef, #: https or ftp user password or https certificate password", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\ndefine staging::file (\n$source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n$target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n$username    = undef, #: https or ftp username\n$certificate = undef, #: https certificate file\n17:   $password    = undef, #: https or ftp user password or https certificate password\n$environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n$timeout     = undef, #: the the time to wait for the file transfer to complete\n$curl_option = undef, #: options to pass to curl\n$wget_option = undef, #: options to pass to wget\n$subdir      = $caller_module_name", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 17\n\n     12: define staging::file (\n     13:   $source,              #: the source file location, supports local files, puppet://, http://, https://, ftp://\n     14:   $target      = undef, #: the target staging directory, if unspecified ${staging::path}/${caller_module_name}\n     15:   $username    = undef, #: https or ftp username\n     16:   $certificate = undef, #: https certificate file\n>>>  17:   $password    = undef, #: https or ftp user password or https certificate password\n     18:   $environment = undef, #: environment variable for settings such as http_proxy, https_proxy, of ftp_proxy\n     19:   $timeout     = undef, #: the the time to wait for the file transfer to complete\n     20:   $curl_option = undef, #: options to pass to curl\n     21:   $wget_option = undef, #: options to pass to wget\n     22:   $subdir      = $caller_module_name\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-auth_file.pp", "content": "$admin_user               = 'admin',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-auth_file.pp\n\n# The profile to install an OpenStack specific mysql server\nclass contrail::profile::openstack::auth_file(\n$admin_password           = $::contrail::params::keystone_admin_password,\n$keystone_admin_token     = $::contrail::params::os_keystone_admin_token,\n$internal_vip             = $::contrail::params::internal_vip,\n6:   $admin_user               = 'admin',\n$admin_tenant             = 'admin',\n$region_name              = $::contrail::params::os_region,\n$keystone_version         = $::contrail::params::keystone_version,\n$use_no_cache             = true,\n$cinder_endpoint_type     = 'publicURL',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-profile-openstack-auth_file.pp\n# Target line: 6\n\n      1: # The profile to install an OpenStack specific mysql server\n      2: class contrail::profile::openstack::auth_file(\n      3:   $admin_password           = $::contrail::params::keystone_admin_password,\n      4:   $keystone_admin_token     = $::contrail::params::os_keystone_admin_token,\n      5:   $internal_vip             = $::contrail::params::internal_vip,\n>>>   6:   $admin_user               = 'admin',\n      7:   $admin_tenant             = 'admin',\n      8:   $region_name              = $::contrail::params::os_region,\n      9:   $keystone_version         = $::contrail::params::keystone_version,\n     10:   $use_no_cache             = true,\n     11:   $cinder_endpoint_type     = 'publicURL',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@ci-puppet-modules-gds_rabbitmq-manifests-init.pp", "content": "admin    => true,", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: alphagov@ci-puppet-modules-gds_rabbitmq-manifests-init.pp\n\nclass { '::rabbitmq':\nmanage_repos => false,\n}\n\nrabbitmq_user { 'root':\n14:     admin    => true,\npassword => $root_password,\n}\n\nrabbitmq_user_permissions { 'root@/':\nconfigure_permission => '.*',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-gds_rabbitmq-manifests-init.pp\n# Target line: 14\n\n      9:   class { '::rabbitmq':\n     10:     manage_repos => false,\n     11:   }\n     12: \n     13:   rabbitmq_user { 'root':\n>>>  14:     admin    => true,\n     15:     password => $root_password,\n     16:   }\n     17: \n     18:   rabbitmq_user_permissions { 'root@/':\n     19:     configure_permission => '.*',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_grant.pp", "content": "$user          = 'root',", "line": 45, "detection_span": [40, 50], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_grant.pp\n\n#    password_hash => mysql_password('apassword')\n#  }\n#\ndefine osnailyfacter::mysql_grant (\n$network       = $title,\n45:   $user          = 'root',\n$password_hash = '',\n$database      = '*',\n$table         = '*',\n$options       = ['GRANT'],\n$privileges    = ['ALL']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-osnailyfacter-manifests-mysql_grant.pp\n# Target line: 45\n\n     40: #    password_hash => mysql_password('apassword')\n     41: #  }\n     42: #\n     43: define osnailyfacter::mysql_grant (\n     44:   $network       = $title,\n>>>  45:   $user          = 'root',\n     46:   $password_hash = '',\n     47:   $database      = '*',\n     48:   $table         = '*',\n     49:   $options       = ['GRANT'],\n     50:   $privileges    = ['ALL']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wesleytodd@YeoPress-puppet-modules-apache-manifests-mod-userdir.pp", "content": "$disable_root = true,", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod-userdir.pp\n\nclass apache::mod::userdir (\n$home = '/home',\n$dir = 'public_html',\n4:   $disable_root = true,\n) {\n::apache::mod { 'userdir': }\n\n# Template uses $home, $dir, $disable_root\nfile { 'userdir.conf':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wesleytodd@YeoPress-puppet-modules-apache-manifests-mod-userdir.pp\n# Target line: 4\n\n      1: class apache::mod::userdir (\n      2:   $home = '/home',\n      3:   $dir = 'public_html',\n>>>   4:   $disable_root = true,\n      5: ) {\n      6:   ::apache::mod { 'userdir': }\n      7: \n      8:   # Template uses $home, $dir, $disable_root\n      9:   file { 'userdir.conf':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-iso_build.pp", "content": "www_root    => '/var/www',", "line": 142, "detection_span": [137, 147], "with_context": "# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-iso_build.pp\n\n137:   })\n138:\n139:   ::nginx::resource::vhost { 'share':\nserver_name => ['_'],\nautoindex   => 'on',\n142:     www_root    => '/var/www',\nrequire     => [\nFile['/var/www'],\n],\n146:   }\n147: }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: fuel-infra@puppet-manifests-modules-fuel_project-manifests-jenkins-slave-iso_build.pp\n# Target line: 142\n\n    137:   })\n    138: \n    139:   ::nginx::resource::vhost { 'share':\n    140:     server_name => ['_'],\n    141:     autoindex   => 'on',\n>>> 142:     www_root    => '/var/www',\n    143:     require     => [\n    144:       File['/var/www'],\n    145:     ],\n    146:   }\n    147: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wikimedia@puppet-cdh-manifests-hive.pp", "content": "$jdbc_username               = 'hive',", "line": 74, "detection_span": [69, 79], "with_context": "# Puppet file: wikimedia@puppet-cdh-manifests-hive.pp\n\nclass cdh::hive(\n$metastore_host,\n$zookeeper_hosts             = undef,\n$support_concurrency         = false,\n$jdbc_database               = 'hive_metastore',\n74:     $jdbc_username               = 'hive',\n$jdbc_password               = 'hive',\n$jdbc_host                   = 'localhost',\n$jdbc_port                   = 3306,\n$jdbc_driver                 = 'com.mysql.jdbc.Driver',\n$jdbc_protocol               = 'mysql',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@puppet-cdh-manifests-hive.pp\n# Target line: 74\n\n     69: class cdh::hive(\n     70:     $metastore_host,\n     71:     $zookeeper_hosts             = undef,\n     72:     $support_concurrency         = false,\n     73:     $jdbc_database               = 'hive_metastore',\n>>>  74:     $jdbc_username               = 'hive',\n     75:     $jdbc_password               = 'hive',\n     76:     $jdbc_host                   = 'localhost',\n     77:     $jdbc_port                   = 3306,\n     78:     $jdbc_driver                 = 'com.mysql.jdbc.Driver',\n     79:     $jdbc_protocol               = 'mysql',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-ceph_mon.pp", "content": "key     => 'ceph.health',", "line": 34, "detection_span": [29, 39], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-ceph_mon.pp\n\ntemplate => 'Template App OpenStack Ceph',\napi      => $plugin_zabbix::monitoring::api_hash,\n}\nplugin_zabbix::agent::userparameter {\n'ceph_health':\n34:         key     => 'ceph.health',\ncommand => '/etc/zabbix/scripts/ceph_health.sh'\n}\n\nplugin_zabbix_template_link { \"${plugin_zabbix::params::host_name} Template App OpenStack Ceph MON\":\nhost     => $plugin_zabbix::params::host_name,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-ceph_mon.pp\n# Target line: 34\n\n     29:       template => 'Template App OpenStack Ceph',\n     30:       api      => $plugin_zabbix::monitoring::api_hash,\n     31:     }\n     32:     plugin_zabbix::agent::userparameter {\n     33:       'ceph_health':\n>>>  34:         key     => 'ceph.health',\n     35:         command => '/etc/zabbix/scripts/ceph_health.sh'\n     36:     }\n     37: \n     38:     plugin_zabbix_template_link { \"${plugin_zabbix::params::host_name} Template App OpenStack Ceph MON\":\n     39:       host     => $plugin_zabbix::params::host_name,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp", "content": "$client_cert_keys = keys($client_certificates)", "line": 91, "detection_span": [86, 96], "with_context": "# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n\nmode   => '0440',\nowner  => 'jboss',\ngroup  => 'jboss',\n}\n\n91:     $client_cert_keys = keys($client_certificates)\n\nconcat::fragment { $clients_config_file_path:\ntarget  => $clients_config_file_path,\ncontent => join($client_cert_keys, \".properties\\n\"),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: lightblue-platform@lightblue-puppet-manifests-application-healthcheck.pp\n# Target line: 91\n\n     86:         mode   => '0440',\n     87:         owner  => 'jboss',\n     88:         group  => 'jboss',\n     89:     }\n     90: \n>>>  91:     $client_cert_keys = keys($client_certificates)\n     92: \n     93:     concat::fragment { $clients_config_file_path:\n     94:         target  => $clients_config_file_path,\n     95:         content => join($client_cert_keys, \".properties\\n\"),\n     96:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@pltraining-bootstrap-manifests-profile-ciab_web_interface.pp", "content": "$docroot = '/usr/share/nginx/html'", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-ciab_web_interface.pp\n\n# Contain here because ordering dependencies are set on the\n# ciab_web_interface class so these resources are applied after\n# the bootstrap::profile::vagrant class\ncontain nginx\n\n19:     $docroot = '/usr/share/nginx/html'\n\nfile { \"${docroot}/index.html\":\ncontent => epp('bootstrap/ciab_web_interface/index.html.epp',\n{ ciab_ip => $ciab_ip } ),\nrequire => Class['nginx'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@pltraining-bootstrap-manifests-profile-ciab_web_interface.pp\n# Target line: 19\n\n     14:     # Contain here because ordering dependencies are set on the\n     15:     # ciab_web_interface class so these resources are applied after\n     16:     # the bootstrap::profile::vagrant class\n     17:     contain nginx\n     18: \n>>>  19:     $docroot = '/usr/share/nginx/html'\n     20: \n     21:     file { \"${docroot}/index.html\":\n     22:       content => epp('bootstrap/ciab_web_interface/index.html.epp',\n     23:                      { ciab_ip => $ciab_ip } ),\n     24:       require => Class['nginx'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp", "content": "$password             = hiera('CONFIG_PROVISION_TEMPEST_USER_PW')", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n\n$password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n$tenant_name          = 'demo'\n$floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n} else {\n$username             = hiera('CONFIG_PROVISION_TEMPEST_USER')\n11:       $password             = hiera('CONFIG_PROVISION_TEMPEST_USER_PW')\n$tenant_name          = 'tempest'\n$floating_range       = hiera('CONFIG_PROVISION_TEMPEST_FLOATRANGE')\n}\n\n# Authentication/Keystone", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-provision-tempest.pp\n# Target line: 11\n\n      6:       $password             = hiera('CONFIG_KEYSTONE_DEMO_PW')\n      7:       $tenant_name          = 'demo'\n      8:       $floating_range       = hiera('CONFIG_PROVISION_DEMO_FLOATRANGE')\n      9:     } else {\n     10:       $username             = hiera('CONFIG_PROVISION_TEMPEST_USER')\n>>>  11:       $password             = hiera('CONFIG_PROVISION_TEMPEST_USER_PW')\n     12:       $tenant_name          = 'tempest'\n     13:       $floating_range       = hiera('CONFIG_PROVISION_TEMPEST_FLOATRANGE')\n     14:     }\n     15: \n     16:     # Authentication/Keystone\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp", "content": "$rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n\n$nova_mariadb_host = hiera('CONFIG_MARIADB_HOST_URL')\n\n$rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n$rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n$rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n9:     $rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n\n$private_key = {\n'type' => hiera('NOVA_MIGRATION_KEY_TYPE'),\nkey  => hiera('NOVA_MIGRATION_KEY_SECRET'),\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova.pp\n# Target line: 9\n\n      4:     $nova_mariadb_host = hiera('CONFIG_MARIADB_HOST_URL')\n      5: \n      6:     $rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n      7:     $rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n      8:     $rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n>>>   9:     $rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n     10: \n     11:     $private_key = {\n     12:       'type' => hiera('NOVA_MIGRATION_KEY_TYPE'),\n     13:       key  => hiera('NOVA_MIGRATION_KEY_SECRET'),\n     14:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-users-manifests-christopherashton.pp", "content": "ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC9li9eNlp+KvuOpkBvkuKgTx16RLmGC6Qogc7O7A/aT7Q6m4EBOU5pb1+jv2TmybTzNXP8TGWhqGa9WJuOkUCR9K1Z/CFdu+hMPHpzw32P5yv0uDaJJCoOzYIrM0EQ7QWq7e9oIhJ+rW+66f//Ux7urifnBEwum3DMPLqsFaGCwxhD8Ydn6inYtF4IaY125YuLH5Pyq9Bx6/wj2MsZPxjMRM7kIoZrCUh6gKvt1OGTwRTHAnMFp5QVhS2s/Y7M0fmIuhnQ8s1UGeTAQoHX9ZahrG/hJd+tqsMk8NogQSHVAcdqZKbHdIAaEG0o72NTh8vUqIGPTVZ75ZhFEzppUcpCfcvWCmKWhDtm7AZnB3WZbV5fHHT3q2eB6nbMzzHHRzvrYDQR4DK8YIuj4fwLVV+I/XErthWos3tLn/99ME/h7+aKqCunNix7EWa8zJpOp2H8CBB5RVvHI44hgdsyXUdbT1BG/InpJpGYmNFMSF8DOutS3FC4yl0PM5OqAE51uF9znLF35gJyoavN77RD5ykQskTZsUtV73zFWNF3Dl5fbOj+VW2VbORMa8GgQNNKaVX00u8aqa28jTsDZ2ZIyucl2Fm7FvFHl8lJg9q5D8wxixGhwYMgskaumDGI+e3LP9SiGrYOyC0B+Mhn4Eiw3aO+n84ibQIbfHeEPYUoJXpiyQ== christopher.ashton@digital.cabinet-office.gov.uk',", "line": 6, "detection_span": [1, 11], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-users-manifests-christopherashton.pp\n\n# Creates the christopherashton user\nclass users::christopherashton {\ngovuk_user { 'christopherashton':\nfullname => 'Christopher Ashton',\nemail    => 'christopher.ashton@digital.cabinet-office.gov.uk',\n6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC9li9eNlp+KvuOpkBvkuKgTx16RLmGC6Qogc7O7A/aT7Q6m4EBOU5pb1+jv2TmybTzNXP8TGWhqGa9WJuOkUCR9K1Z/CFdu+hMPHpzw32P5yv0uDaJJCoOzYIrM0EQ7QWq7e9oIhJ+rW+66f//Ux7urifnBEwum3DMPLqsFaGCwxhD8Ydn6inYtF4IaY125YuLH5Pyq9Bx6/wj2MsZPxjMRM7kIoZrCUh6gKvt1OGTwRTHAnMFp5QVhS2s/Y7M0fmIuhnQ8s1UGeTAQoHX9ZahrG/hJd+tqsMk8NogQSHVAcdqZKbHdIAaEG0o72NTh8vUqIGPTVZ75ZhFEzppUcpCfcvWCmKWhDtm7AZnB3WZbV5fHHT3q2eB6nbMzzHHRzvrYDQR4DK8YIuj4fwLVV+I/XErthWos3tLn/99ME/h7+aKqCunNix7EWa8zJpOp2H8CBB5RVvHI44hgdsyXUdbT1BG/InpJpGYmNFMSF8DOutS3FC4yl0PM5OqAE51uF9znLF35gJyoavN77RD5ykQskTZsUtV73zFWNF3Dl5fbOj+VW2VbORMa8GgQNNKaVX00u8aqa28jTsDZ2ZIyucl2Fm7FvFHl8lJg9q5D8wxixGhwYMgskaumDGI+e3LP9SiGrYOyC0B+Mhn4Eiw3aO+n84ibQIbfHeEPYUoJXpiyQ== christopher.ashton@digital.cabinet-office.gov.uk',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-users-manifests-christopherashton.pp\n# Target line: 6\n\n      1: # Creates the christopherashton user\n      2: class users::christopherashton {\n      3:   govuk_user { 'christopherashton':\n      4:     fullname => 'Christopher Ashton',\n      5:     email    => 'christopher.ashton@digital.cabinet-office.gov.uk',\n>>>   6:     ssh_key  => 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC9li9eNlp+KvuOpkBvkuKgTx16RLmGC6Qogc7O7A/aT7Q6m4EBOU5pb1+jv2TmybTzNXP8TGWhqGa9WJuOkUCR9K1Z/CFdu+hMPHpzw32P5yv0uDaJJCoOzYIrM0EQ7QWq7e9oIhJ+rW+66f//Ux7urifnBEwum3DMPLqsFaGCwxhD8Ydn6inYtF4IaY125YuLH5Pyq9Bx6/wj2MsZPxjMRM7kIoZrCUh6gKvt1OGTwRTHAnMFp5QVhS2s/Y7M0fmIuhnQ8s1UGeTAQoHX9ZahrG/hJd+tqsMk8NogQSHVAcdqZKbHdIAaEG0o72NTh8vUqIGPTVZ75ZhFEzppUcpCfcvWCmKWhDtm7AZnB3WZbV5fHHT3q2eB6nbMzzHHRzvrYDQR4DK8YIuj4fwLVV+I/XErthWos3tLn/99ME/h7+aKqCunNix7EWa8zJpOp2H8CBB5RVvHI44hgdsyXUdbT1BG/InpJpGYmNFMSF8DOutS3FC4yl0PM5OqAE51uF9znLF35gJyoavN77RD5ykQskTZsUtV73zFWNF3Dl5fbOj+VW2VbORMa8GgQNNKaVX00u8aqa28jTsDZ2ZIyucl2Fm7FvFHl8lJg9q5D8wxixGhwYMgskaumDGI+e3LP9SiGrYOyC0B+Mhn4Eiw3aO+n84ibQIbfHeEPYUoJXpiyQ== christopher.ashton@digital.cabinet-office.gov.uk',\n      7:   }\n      8: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxen@puppet-boxen-manifests-security.pp", "content": "key    => 'askForPasswordDelay',", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: boxen@puppet-boxen-manifests-security.pp\n\n}\n\nboxen::osx_defaults { 'short delay for password dialog on screensaver':\nensure => present,\ndomain => 'com.apple.screensaver',\n19:     key    => 'askForPasswordDelay',\nvalue  => $screensaver_delay_sec,\ntype   => 'float',\nuser   => $::boxen_user\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxen@puppet-boxen-manifests-security.pp\n# Target line: 19\n\n     14:   }\n     15: \n     16:   boxen::osx_defaults { 'short delay for password dialog on screensaver':\n     17:     ensure => present,\n     18:     domain => 'com.apple.screensaver',\n>>>  19:     key    => 'askForPasswordDelay',\n     20:     value  => $screensaver_delay_sec,\n     21:     type   => 'float',\n     22:     user   => $::boxen_user\n     23:   }\n     24: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Mirantis@solar-resources-cinder_puppet-actions-remove.pp", "content": "rabbit_password    => 'not important as removed',", "line": 3, "detection_span": [1, 8], "with_context": "# Puppet file: Mirantis@solar-resources-cinder_puppet-actions-remove.pp\n\nclass {'cinder':\npackage_ensure     => 'absent',\n3:   rabbit_password    => 'not important as removed',\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Mirantis@solar-resources-cinder_puppet-actions-remove.pp\n# Target line: 3\n\n      1: class {'cinder':\n      2:   package_ensure     => 'absent',\n>>>   3:   rabbit_password    => 'not important as removed',\n      4: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-policy.pp", "content": "file_user  => 'root',", "line": 38, "detection_span": [33, 43], "with_context": "# Puppet file: openstack@puppet-trove-manifests-policy.pp\n\n\nvalidate_legacy(Hash, 'validate_hash', $policies)\n\nOpenstacklib::Policy::Base {\nfile_path  => $policy_path,\n38:     file_user  => 'root',\nfile_group => $::trove::params::group,\n}\n\ncreate_resources('openstacklib::policy::base', $policies)\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-policy.pp\n# Target line: 38\n\n     33: \n     34:   validate_legacy(Hash, 'validate_hash', $policies)\n     35: \n     36:   Openstacklib::Policy::Base {\n     37:     file_path  => $policy_path,\n>>>  38:     file_user  => 'root',\n     39:     file_group => $::trove::params::group,\n     40:   }\n     41: \n     42:   create_resources('openstacklib::policy::base', $policies)\n     43: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-webserver-apache-status.pp", "content": "$vhost = {", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: norcams@himlar-profile-manifests-webserver-apache-status.pp\n\nif $manage_status {\n\ninclude ::apache::mod::status\ninclude ::profile::webserver::apache\n\n14:     $vhost = {\n'status' => {\n'ip'             => '127.0.0.1',\n'port'           => 80,\n'manage_docroot' => false,\n'docroot'        => '/var/www/html'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-webserver-apache-status.pp\n# Target line: 14\n\n      9:   if $manage_status {\n     10: \n     11:     include ::apache::mod::status\n     12:     include ::profile::webserver::apache\n     13: \n>>>  14:     $vhost = {\n     15:       'status' => {\n     16:         'ip'             => '127.0.0.1',\n     17:         'port'           => 80,\n     18:         'manage_docroot' => false,\n     19:         'docroot'        => '/var/www/html'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "puppetlabs@puppetlabs-mysql-examples-mysql_db.pp", "content": "user     => 'myuser',", "line": 11, "detection_span": [6, 16], "with_context": "# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n\npassword => 'mypass',\nhost     => 'localhost',\ngrant    => ['SELECT', 'UPDATE'],\n}\nmysql::db { \"mydb_${fqdn}\":\n11:   user     => 'myuser',\npassword => 'mypass',\ndbname   => 'mydb',\nhost     => $::fqdn,\ngrant    => ['SELECT', 'UPDATE'],\ntag      => $domain,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-mysql-examples-mysql_db.pp\n# Target line: 11\n\n      6:   password => 'mypass',\n      7:   host     => 'localhost',\n      8:   grant    => ['SELECT', 'UPDATE'],\n      9: }\n     10: mysql::db { \"mydb_${fqdn}\":\n>>>  11:   user     => 'myuser',\n     12:   password => 'mypass',\n     13:   dbname   => 'mydb',\n     14:   host     => $::fqdn,\n     15:   grant    => ['SELECT', 'UPDATE'],\n     16:   tag      => $domain,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp", "content": "$zendesk_client_username = undef,", "line": 104, "detection_span": [99, 109], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n\n$redis_host = undef,\n100:   $redis_port = undef,\n101:   $secret_key_base = undef,\n102:   $zendesk_anonymous_ticket_email = undef,\n103:   $zendesk_client_password = undef,\n104:   $zendesk_client_username = undef,\n105:   $aws_access_key_id = undef,\n106:   $aws_secret_access_key = undef,\n107:   $aws_region = 'eu-west-1',\n108:   $aws_s3_bucket_name = undef,\n109: ) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-support_api.pp\n# Target line: 104\n\n     99:   $redis_host = undef,\n    100:   $redis_port = undef,\n    101:   $secret_key_base = undef,\n    102:   $zendesk_anonymous_ticket_email = undef,\n    103:   $zendesk_client_password = undef,\n>>> 104:   $zendesk_client_username = undef,\n    105:   $aws_access_key_id = undef,\n    106:   $aws_secret_access_key = undef,\n    107:   $aws_region = 'eu-west-1',\n    108:   $aws_s3_bucket_name = undef,\n    109: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp", "content": "key     => 'haproxy.fe[*]',", "line": 37, "detection_span": [32, 42], "with_context": "# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.fe.discovery':\nkey     => 'haproxy.fe.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -f';\n'haproxy.fe':\n37:         key     => 'haproxy.fe[*]',\ncommand => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n'haproxy.sv.discovery':\nkey     => 'haproxy.sv.discovery',\ncommand => '/etc/zabbix/scripts/haproxy.sh -s';\n'haproxy.sv':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-plugin-external-zabbix-deployment_scripts-puppet-modules-plugin_zabbix-manifests-monitoring-haproxy_mon.pp\n# Target line: 37\n\n     32:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     33:       'haproxy.fe.discovery':\n     34:         key     => 'haproxy.fe.discovery',\n     35:         command => '/etc/zabbix/scripts/haproxy.sh -f';\n     36:       'haproxy.fe':\n>>>  37:         key     => 'haproxy.fe[*]',\n     38:         command => '/etc/zabbix/scripts/haproxy.sh -v $1 $2 $3';\n     39:       'haproxy.sv.discovery':\n     40:         key     => 'haproxy.sv.discovery',\n     41:         command => '/etc/zabbix/scripts/haproxy.sh -s';\n     42:       'haproxy.sv':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk_containers-manifests-terraboard.pp", "content": "$db_password = undef,", "line": 44, "detection_span": [39, 49], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_containers-manifests-terraboard.pp\n\nclass govuk_containers::terraboard(\n$aws_region = 'eu-west-1',\n$aws_access_key_id = undef,\n$aws_secret_access_key = undef,\n$aws_bucket = undef,\n44:   $db_password = undef,\n$github_oauth_client_id = undef,\n$github_oauth_client_secret = undef,\n$oauth2_proxy_base_url = undef,\n$oauth2_proxy_cookie_secret = undef,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_containers-manifests-terraboard.pp\n# Target line: 44\n\n     39: class govuk_containers::terraboard(\n     40:   $aws_region = 'eu-west-1',\n     41:   $aws_access_key_id = undef,\n     42:   $aws_secret_access_key = undef,\n     43:   $aws_bucket = undef,\n>>>  44:   $db_password = undef,\n     45:   $github_oauth_client_id = undef,\n     46:   $github_oauth_client_secret = undef,\n     47:   $oauth2_proxy_base_url = undef,\n     48:   $oauth2_proxy_cookie_secret = undef,\n     49: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp", "content": "key    => 'tilesize',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n\nclass people::felho::osx_settings::dock {\nboxen::osx_defaults { 'Set the icon size of Dock items to 48 pixels':\nuser   => $::luser,\ndomain => 'com.apple.dock',\n5:     key    => 'tilesize',\ntype   => 'int',\nvalue  => 48,\n}\n\nboxen::osx_defaults { 'Activating Dock auto-hide':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-osx_settings-dock.pp\n# Target line: 5\n\n      1: class people::felho::osx_settings::dock {\n      2:   boxen::osx_defaults { 'Set the icon size of Dock items to 48 pixels':\n      3:     user   => $::luser,\n      4:     domain => 'com.apple.dock',\n>>>   5:     key    => 'tilesize',\n      6:     type   => 'int',\n      7:     value  => 48,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Activating Dock auto-hide':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "KrisBuytaert@puppet-graphite-manifests-params.pp", "content": "$relay_user                                = 'carbon',", "line": 102, "detection_span": [97, 107], "with_context": "# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n\n$relay_pickle_receiver_port                = '2004',\n$relay_replication_factor                  = '1',\n$relay_service_enable                      = 'running',\n$relay_service_name                        = 'carbon-relay',\n$relay_use_flow_control                    = 'True',\n102:   $relay_user                                = 'carbon',\n$web_basic_http_auth                       = false,\n$web_conf_dir                              = '/etc/graphite-web',\n$web_content_dir                           = '/usr/share/graphite/webapp/content',\n$web_data_dirs                             = '[WHISPER_DIR, RRD_DIR]',\n$web_dir                                   = '/etc/graphite-web/',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: KrisBuytaert@puppet-graphite-manifests-params.pp\n# Target line: 102\n\n     97:   $relay_pickle_receiver_port                = '2004',\n     98:   $relay_replication_factor                  = '1',\n     99:   $relay_service_enable                      = 'running',\n    100:   $relay_service_name                        = 'carbon-relay',\n    101:   $relay_use_flow_control                    = 'True',\n>>> 102:   $relay_user                                = 'carbon',\n    103:   $web_basic_http_auth                       = false,\n    104:   $web_conf_dir                              = '/etc/graphite-web',\n    105:   $web_content_dir                           = '/usr/share/graphite/webapp/content',\n    106:   $web_data_dirs                             = '[WHISPER_DIR, RRD_DIR]',\n    107:   $web_dir                                   = '/etc/graphite-web/',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp", "content": "cinder_admin_password    => hiera('CONFIG_CINDER_KS_PW'),", "line": 47, "detection_span": [42, 52], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n\nnova_admin_password    => hiera('CONFIG_NOVA_KS_PW'),\nnova_admin_tenant_name => 'services',\n}\n\nclass { '::manila::volume::cinder':\n47:       cinder_admin_password    => hiera('CONFIG_CINDER_KS_PW'),\ncinder_admin_tenant_name => 'services',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-manila-backend-generic.pp\n# Target line: 47\n\n     42:       nova_admin_password    => hiera('CONFIG_NOVA_KS_PW'),\n     43:       nova_admin_tenant_name => 'services',\n     44:     }\n     45: \n     46:     class { '::manila::volume::cinder':\n>>>  47:       cinder_admin_password    => hiera('CONFIG_CINDER_KS_PW'),\n     48:       cinder_admin_tenant_name => 'services',\n     49:     }\n     50: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "norcams@himlar-profile-manifests-openstack-identity.pp", "content": "$manage_ssl_cert          = false,", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: norcams@himlar-profile-manifests-openstack-identity.pp\n\n$gnocchi_enabled          = false,\n$roles_extra              = [],\n$manage_firewall          = true,\n$firewall_extras          = {},\n$firewall_extras_a        = {},\n17:   $manage_ssl_cert          = false,\n$manage_openidc           = false,\n$disable_admin_token_auth = false,\n$token_rotation_sync      = false,\n$manage_token_rotate      = false,\n$token_db                 = 'token_keys',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: norcams@himlar-profile-manifests-openstack-identity.pp\n# Target line: 17\n\n     12:   $gnocchi_enabled          = false,\n     13:   $roles_extra              = [],\n     14:   $manage_firewall          = true,\n     15:   $firewall_extras          = {},\n     16:   $firewall_extras_a        = {},\n>>>  17:   $manage_ssl_cert          = false,\n     18:   $manage_openidc           = false,\n     19:   $disable_admin_token_auth = false,\n     20:   $token_rotation_sync      = false,\n     21:   $manage_token_rotate      = false,\n     22:   $token_db                 = 'token_keys',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-tomcat-manifests-install.pp", "content": "$user                   = undef,", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-install.pp\n\n\n# source options\n$source_url             = undef,\n$source_strip_first_dir = true,\n$environment            = undef,\n10:   $user                   = undef,\n$group                  = undef,\n$manage_user            = undef,\n$manage_group           = undef,\n$manage_home            = undef,\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-tomcat-manifests-install.pp\n# Target line: 10\n\n      5: \n      6:   # source options\n      7:   $source_url             = undef,\n      8:   $source_strip_first_dir = true,\n      9:   $environment            = undef,\n>>>  10:   $user                   = undef,\n     11:   $group                  = undef,\n     12:   $manage_user            = undef,\n     13:   $manage_group           = undef,\n     14:   $manage_home            = undef,\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "felho@boxen-modules-people-manifests-felho-application_settings-finder.pp", "content": "key    => 'FXDefaultSearchScope',", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n\n}\n\nboxen::osx_defaults { 'When performing a search, search the current folder by default':\nuser   => $::luser,\ndomain => 'com.apple.finder',\n86:     key    => 'FXDefaultSearchScope',\ntype   => 'string',\nvalue  => 'SCcf',\n}\n\n$new_window_folder = \"/Users/${::luser}/Downloads\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-application_settings-finder.pp\n# Target line: 86\n\n     81:   }\n     82: \n     83:   boxen::osx_defaults { 'When performing a search, search the current folder by default':\n     84:     user   => $::luser,\n     85:     domain => 'com.apple.finder',\n>>>  86:     key    => 'FXDefaultSearchScope',\n     87:     type   => 'string',\n     88:     value  => 'SCcf',\n     89:   }\n     90: \n     91:   $new_window_folder = \"/Users/${::luser}/Downloads\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "basho-labs@puppet-riak-manifests-repository-debian.pp", "content": "key        => '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB',", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: basho-labs@puppet-riak-manifests-repository-debian.pp\n\nclass riak::repository::debian {\nensure_packages('apt-transport-https') # packagecloud is https-only\ninclude ::apt\napt::source { 'riak':\nlocation   => 'https://packagecloud.io/basho/riak/debian/',\n10:     key        => '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB',\npin        => '550',\nrepos      => 'main',\nrelease    => $::lsbdistcodename,\nbefore     => Package[$::riak::package_name],\nrequire    => Package['apt-transport-https'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: basho-labs@puppet-riak-manifests-repository-debian.pp\n# Target line: 10\n\n      5: class riak::repository::debian {\n      6:   ensure_packages('apt-transport-https') # packagecloud is https-only\n      7:   include ::apt\n      8:   apt::source { 'riak':\n      9:     location   => 'https://packagecloud.io/basho/riak/debian/',\n>>>  10:     key        => '418A7F2FB0E1E6E7EABF6FE8C2E73424D59097AB',\n     11:     pin        => '550',\n     12:     repos      => 'main',\n     13:     release    => $::lsbdistcodename,\n     14:     before     => Package[$::riak::package_name],\n     15:     require    => Package['apt-transport-https'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Vizir@carnival-vagrant-modules-apt-manifests-debian-testing.pp", "content": "key               => '55BE302B',", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-debian-testing.pp\n\napt::source { 'debian_testing':\nlocation          => 'http://debian.mirror.iweb.ca/debian/',\nrelease           => 'testing',\nrepos             => 'main contrib non-free',\nrequired_packages => 'debian-keyring debian-archive-keyring',\n17:     key               => '55BE302B',\nkey_server        => 'subkeys.pgp.net',\npin               => '-10',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Vizir@carnival-vagrant-modules-apt-manifests-debian-testing.pp\n# Target line: 17\n\n     12:   apt::source { 'debian_testing':\n     13:     location          => 'http://debian.mirror.iweb.ca/debian/',\n     14:     release           => 'testing',\n     15:     repos             => 'main contrib non-free',\n     16:     required_packages => 'debian-keyring debian-archive-keyring',\n>>>  17:     key               => '55BE302B',\n     18:     key_server        => 'subkeys.pgp.net',\n     19:     pin               => '-10',\n     20:   }\n     21: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp", "content": "$http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"", "line": 62, "detection_span": [57, 67], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n\n$ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n$ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n}\n'wget': {\n$http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n62:       $http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n$http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"\n$ftp_get         = $http_get\n$ftp_get_passwd  = $http_get_passwd\n}\n'powershell':{", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-staging-manifests-file.pp\n# Target line: 62\n\n     57:       $ftp_get         = \"curl ${curl_option} -o ${name} ${quoted_source}\"\n     58:       $ftp_get_passwd  = \"curl ${curl_option} -o ${name} -u ${username}:${password} ${quoted_source}\"\n     59:     }\n     60:     'wget': {\n     61:       $http_get        = \"wget ${wget_option} -O ${name} ${quoted_source}\"\n>>>  62:       $http_get_passwd = \"wget ${wget_option} -O ${name} --user=${username} --password=${password} ${quoted_source}\"\n     63:       $http_get_cert   = \"wget ${wget_option} -O ${name} --user=${username} --certificate=${certificate} ${quoted_source}\"\n     64:       $ftp_get         = $http_get\n     65:       $ftp_get_passwd  = $http_get_passwd\n     66:     }\n     67:     'powershell':{\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp", "content": "$amqp_pass  = 'email_alert_service_test',", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n\n#   Must be vhost-unique.\n#   (default: 'email_alert_service_published_documents_test_queue')\n#\nclass govuk::apps::email_alert_service::rabbitmq_test_permissions (\n$amqp_user  = 'email_alert_service_test',\n29:   $amqp_pass  = 'email_alert_service_test',\n$amqp_exchange = 'email_alert_service_published_documents_test_exchange',\n$amqp_major_change_queue = 'email_alert_service_published_documents_test_queue',\n$amqp_unpublishing_queue = 'email_alert_service_unpublishing_documents_test_queue',\n$amqp_workflow_queue = 'email_alert_service_workflow_test_queue',\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-email_alert_service-rabbitmq_test_permissions.pp\n# Target line: 29\n\n     24: #   Must be vhost-unique.\n     25: #   (default: 'email_alert_service_published_documents_test_queue')\n     26: #\n     27: class govuk::apps::email_alert_service::rabbitmq_test_permissions (\n     28:   $amqp_user  = 'email_alert_service_test',\n>>>  29:   $amqp_pass  = 'email_alert_service_test',\n     30:   $amqp_exchange = 'email_alert_service_published_documents_test_exchange',\n     31:   $amqp_major_change_queue = 'email_alert_service_published_documents_test_queue',\n     32:   $amqp_unpublishing_queue = 'email_alert_service_unpublishing_documents_test_queue',\n     33:   $amqp_workflow_queue = 'email_alert_service_workflow_test_queue',\n     34: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp", "content": "admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),", "line": 35, "detection_span": [30, 40], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n\nclass { '::keystone::logging':\ndebug => hiera('CONFIG_DEBUG_MODE'),\n}\n\nclass { '::keystone':\n35:       admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\nadmin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\ndatabase_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\ntoken_provider      => \"${keystone_token_provider_str}\",\nenable_fernet_setup => true,\nservice_name        => 'httpd',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-keystone.pp\n# Target line: 35\n\n     30:     class { '::keystone::logging':\n     31:       debug => hiera('CONFIG_DEBUG_MODE'),\n     32:     }\n     33: \n     34:     class { '::keystone':\n>>>  35:       admin_token         => hiera('CONFIG_KEYSTONE_ADMIN_TOKEN'),\n     36:       admin_password      => hiera('CONFIG_KEYSTONE_ADMIN_PW'),\n     37:       database_connection => \"mysql+pymysql://keystone_admin:${keystone_cfg_ks_db_pw}@${keystone_cfg_mariadb_host}/keystone\",\n     38:       token_provider      => \"${keystone_token_provider_str}\",\n     39:       enable_fernet_setup => true,\n     40:       service_name        => 'httpd',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_mysql_master.pp", "content": "$root_password = hiera('mysql_root', '')", "line": 26, "detection_span": [21, 31], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_mysql_master.pp\n\n$aws_secret_access_key = undef,\n$s3_bucket_name = undef,\n$encryption_key = undef,\n) inherits govuk::node::s_base {\n$replica_password = hiera('mysql_replica_password', '')\n26:   $root_password = hiera('mysql_root', '')\n\nclass { 'govuk_mysql::server':\nroot_password => $root_password,\n}\nclass { 'govuk_mysql::server::master':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_mysql_master.pp\n# Target line: 26\n\n     21:   $aws_secret_access_key = undef,\n     22:   $s3_bucket_name = undef,\n     23:   $encryption_key = undef,\n     24: ) inherits govuk::node::s_base {\n     25:   $replica_password = hiera('mysql_replica_password', '')\n>>>  26:   $root_password = hiera('mysql_root', '')\n     27: \n     28:   class { 'govuk_mysql::server':\n     29:     root_password => $root_password,\n     30:   }\n     31:   class { 'govuk_mysql::server::master':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "nrako@my-boxen-modules-application_settings-manifests-iterm2.pp", "content": "key    => 'PromptOnQuit',", "line": 5, "detection_span": [1, 10], "with_context": "# Puppet file: nrako@my-boxen-modules-application_settings-manifests-iterm2.pp\n\nclass application_settings::iterm2 {\nboxen::osx_defaults { 'Turn off prompt on quit':\nuser   => $::luser,\ndomain => 'com.googlecode.iterm2',\n5:     key    => 'PromptOnQuit',\ntype   => 'bool',\nvalue  => false,\n}\n\nboxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: nrako@my-boxen-modules-application_settings-manifests-iterm2.pp\n# Target line: 5\n\n      1: class application_settings::iterm2 {\n      2:   boxen::osx_defaults { 'Turn off prompt on quit':\n      3:     user   => $::luser,\n      4:     domain => 'com.googlecode.iterm2',\n>>>   5:     key    => 'PromptOnQuit',\n      6:     type   => 'bool',\n      7:     value  => false,\n      8:   }\n      9: \n     10:   boxen::osx_defaults { 'Turn off prompt on quit when more tabs are open':\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-trove-manifests-quota.pp", "content": "$max_instances_per_user   = undef,", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: openstack@puppet-trove-manifests-quota.pp\n\n$max_accepted_volume_size = 5,\n$max_volumes_per_tenant   = 20,\n$max_backups_per_tenant   = 50,\n$quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n# Deprecated\n50:   $max_instances_per_user   = undef,\n$max_volumes_per_user     = undef,\n$max_backups_per_user     = undef,\n) {\n\ninclude ::trove::deps", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-quota.pp\n# Target line: 50\n\n     45:   $max_accepted_volume_size = 5,\n     46:   $max_volumes_per_tenant   = 20,\n     47:   $max_backups_per_tenant   = 50,\n     48:   $quota_driver             = 'trove.quota.quota.DbQuotaDriver',\n     49:   # Deprecated\n>>>  50:   $max_instances_per_user   = undef,\n     51:   $max_volumes_per_user     = undef,\n     52:   $max_backups_per_user     = undef,\n     53: ) {\n     54: \n     55:   include ::trove::deps\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga@puppet-icinga2-examples-init_idopgsql.pp", "content": "password      => \"supersecret\",", "line": 14, "detection_span": [9, 19], "with_context": "# Puppet file: Icinga@puppet-icinga2-examples-init_idopgsql.pp\n\nmanage_repo => true,\n}\n\nclass{ 'icinga2::feature::idopgsql':\nuser          => \"icinga2\",\n14:   password      => \"supersecret\",\ndatabase      => \"icinga2\",\nimport_schema => true,\nrequire       => Postgresql::Server::Db['icinga2'],\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-examples-init_idopgsql.pp\n# Target line: 14\n\n      9:   manage_repo => true,\n     10: }\n     11: \n     12: class{ 'icinga2::feature::idopgsql':\n     13:   user          => \"icinga2\",\n>>>  14:   password      => \"supersecret\",\n     15:   database      => \"icinga2\",\n     16:   import_schema => true,\n     17:   require       => Postgresql::Server::Db['icinga2'],\n     18: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp", "content": "key_source => 'http://172.18.66.213/gpg.pub',", "line": 24, "detection_span": [19, 29], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n\nstage => 'openstack-ci-repo'\n}->\nclass { '::openstack::repo::apt':\nkey        => '420851BC',\nlocation   => 'http://172.18.66.213/deb',\n24:       key_source => 'http://172.18.66.213/gpg.pub',\norigin     => '172.18.66.213',\nstage      => 'openstack-ci-repo'\n}\n}\n'RedHat': {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-cobbler-examples-server_site.pp\n# Target line: 24\n\n     19:       stage => 'openstack-ci-repo'\n     20:     }->\n     21:     class { '::openstack::repo::apt':\n     22:       key        => '420851BC',\n     23:       location   => 'http://172.18.66.213/deb',\n>>>  24:       key_source => 'http://172.18.66.213/gpg.pub',\n     25:       origin     => '172.18.66.213',\n     26:       stage      => 'openstack-ci-repo'\n     27:     }\n     28:   }\n     29:   'RedHat': {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-tripleo-manifests-profile-base-octavia.pp", "content": "$oslomsg_rpc_password = hiera('oslo_messaging_rpc_password'),", "line": 53, "detection_span": [48, 58], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-octavia.pp\n\n\nclass tripleo::profile::base::octavia (\n$step                 = Integer(hiera('step')),\n$oslomsg_rpc_proto    = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n$oslomsg_rpc_hosts    = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n53:   $oslomsg_rpc_password = hiera('oslo_messaging_rpc_password'),\n$oslomsg_rpc_port     = hiera('oslo_messaging_rpc_port', '5672'),\n$oslomsg_rpc_username = hiera('oslo_messaging_rpc_user_name', 'guest'),\n$oslomsg_rpc_use_ssl  = hiera('oslo_messaging_rpc_use_ssl', '0'),\n) {\nif $step >= 3 {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-octavia.pp\n# Target line: 53\n\n     48: \n     49: class tripleo::profile::base::octavia (\n     50:   $step                 = Integer(hiera('step')),\n     51:   $oslomsg_rpc_proto    = hiera('oslo_messaging_rpc_scheme', 'rabbit'),\n     52:   $oslomsg_rpc_hosts    = any2array(hiera('oslo_messaging_rpc_node_names', undef)),\n>>>  53:   $oslomsg_rpc_password = hiera('oslo_messaging_rpc_password'),\n     54:   $oslomsg_rpc_port     = hiera('oslo_messaging_rpc_port', '5672'),\n     55:   $oslomsg_rpc_username = hiera('oslo_messaging_rpc_user_name', 'guest'),\n     56:   $oslomsg_rpc_use_ssl  = hiera('oslo_messaging_rpc_use_ssl', '0'),\n     57: ) {\n     58:   if $step >= 3 {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "purpleidea@puppet-gluster-manifests-params.pp", "content": "$program_xfsadmin = '/usr/sbin/xfs_admin',", "line": 48, "detection_span": [43, 53], "with_context": "# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n\n$program_vgs = '/sbin/vgs',\n$program_lvs = '/sbin/lvs',\n$program_pvdisplay = '/sbin/pvdisplay',\n$program_vgdisplay = '/sbin/vgdisplay',\n#$program_lvdisplay = '/sbin/lvdisplay',\n48: \t$program_xfsadmin = '/usr/sbin/xfs_admin',\n$program_mkfs_xfs = '/sbin/mkfs.xfs',\n$program_mkfs_ext4 = '/sbin/mkfs.ext4',\n$program_mkfs_btrfs = '/sbin/mkfs.btrfs',\n\n$program_fping = '/usr/sbin/fping',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: purpleidea@puppet-gluster-manifests-params.pp\n# Target line: 48\n\n     43: \t$program_vgs = '/sbin/vgs',\n     44: \t$program_lvs = '/sbin/lvs',\n     45: \t$program_pvdisplay = '/sbin/pvdisplay',\n     46: \t$program_vgdisplay = '/sbin/vgdisplay',\n     47: \t#$program_lvdisplay = '/sbin/lvdisplay',\n>>>  48: \t$program_xfsadmin = '/usr/sbin/xfs_admin',\n     49: \t$program_mkfs_xfs = '/sbin/mkfs.xfs',\n     50: \t$program_mkfs_ext4 = '/sbin/mkfs.ext4',\n     51: \t$program_mkfs_btrfs = '/sbin/mkfs.btrfs',\n     52: \n     53: \t$program_fping = '/usr/sbin/fping',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp", "content": "docroot    => '/var/www/second',", "line": 25, "detection_span": [20, 30], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n\n}\n\n# vhost with proxy_pass and parameters\napache::vhost { 'second.example.com':\nport       => 80,\n25:   docroot    => '/var/www/second',\nproxy_pass => [\n{\n'path'   => '/second',\n'url'    => 'http://localhost:8080/second',\n'params' => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_kali_compatible-apache-examples-vhost_proxypass.pp\n# Target line: 25\n\n     20: }\n     21: \n     22: # vhost with proxy_pass and parameters\n     23: apache::vhost { 'second.example.com':\n     24:   port       => 80,\n>>>  25:   docroot    => '/var/www/second',\n     26:   proxy_pass => [\n     27:     {\n     28:       'path'   => '/second',\n     29:       'url'    => 'http://localhost:8080/second',\n     30:       'params' => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bfraser@puppet-grafana-manifests-install.pp", "content": "user            => 'grafana',", "line": 143, "detection_span": [138, 148], "with_context": "# Puppet file: bfraser@puppet-grafana-manifests-install.pp\n\nensure          => present,\nextract         => true,\nextract_command => 'tar xfz %s --strip-components=1',\nextract_path    => $::grafana::install_dir,\nsource          => $real_archive_source,\n143:         user            => 'grafana',\ngroup           => 'grafana',\ncleanup         => true,\nrequire         => File[$::grafana::install_dir]\n}\n148:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: bfraser@puppet-grafana-manifests-install.pp\n# Target line: 143\n\n    138:         ensure          => present,\n    139:         extract         => true,\n    140:         extract_command => 'tar xfz %s --strip-components=1',\n    141:         extract_path    => $::grafana::install_dir,\n    142:         source          => $real_archive_source,\n>>> 143:         user            => 'grafana',\n    144:         group           => 'grafana',\n    145:         cleanup         => true,\n    146:         require         => File[$::grafana::install_dir]\n    147:       }\n    148: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sbadia@puppet-gitlab-manifests-config-unicorn.pp", "content": "$relative_url_root = false", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: sbadia@puppet-gitlab-manifests-config-unicorn.pp\n\n$owner,\n$path,\n$unicorn_listen,\n$unicorn_port,\n$unicorn_worker,\n39:   $relative_url_root = false\n){\n\nfile { $path:\nensure  => file,\ncontent => template('gitlab/unicorn.rb.erb'),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: sbadia@puppet-gitlab-manifests-config-unicorn.pp\n# Target line: 39\n\n     34:   $owner,\n     35:   $path,\n     36:   $unicorn_listen,\n     37:   $unicorn_port,\n     38:   $unicorn_worker,\n>>>  39:   $relative_url_root = false\n     40: ){\n     41: \n     42:   file { $path:\n     43:     ensure  => file,\n     44:     content => template('gitlab/unicorn.rb.erb'),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "vamsee@puppet-solr-manifests-params.pp", "content": "$jetty_user     = 'jetty'", "line": 19, "detection_span": [14, 24], "with_context": "# Puppet file: vamsee@puppet-solr-manifests-params.pp\n\n$mirror_site    = 'http://www.us.apache.org/dist/lucene/solr'\n$data_dir       = '/var/lib/solr'\n$cores          = ['default']\n$dist_root      = '/tmp'\n\n19:   $jetty_user     = 'jetty'\n$jetty_group    = 'jetty'\n\ncase $::operatingsystem {\n'Debian': {\ncase $::operatingsystemmajrelease {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: vamsee@puppet-solr-manifests-params.pp\n# Target line: 19\n\n     14:   $mirror_site    = 'http://www.us.apache.org/dist/lucene/solr'\n     15:   $data_dir       = '/var/lib/solr'\n     16:   $cores          = ['default']\n     17:   $dist_root      = '/tmp'\n     18: \n>>>  19:   $jetty_user     = 'jetty'\n     20:   $jetty_group    = 'jetty'\n     21: \n     22:   case $::operatingsystem {\n     23:     'Debian': {\n     24:       case $::operatingsystemmajrelease {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "SecGen@SecGen-modules-services-unix-database-mysql-examples-mysql_plugin.pp", "content": "root_password => 'password'", "line": 2, "detection_span": [1, 7], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-mysql_plugin.pp\n\nclass { 'mysql::server':\n2:   root_password => 'password'\n}\n\n$validate_password_soname = $::osfamily ? {\nwindows => 'validate_password.dll',\ndefault => 'validate_password.so'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-database-mysql-examples-mysql_plugin.pp\n# Target line: 2\n\n      1: class { 'mysql::server':\n>>>   2:   root_password => 'password'\n      3: }\n      4: \n      5: $validate_password_soname = $::osfamily ? {\n      6:   windows => 'validate_password.dll',\n      7:   default => 'validate_password.so'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp", "content": "$publishing_api_bearer_token = undef,", "line": 77, "detection_span": [72, 82], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n\n$mongodb_name = undef,\n$mongodb_nodes = undef,\n$oauth_id = undef,\n$oauth_secret = undef,\n$port = '3035',\n77:   $publishing_api_bearer_token = undef,\n$redis_host = undef,\n$redis_port = undef,\n$secret_key_base = undef,\n$show_historical_edition_link = false,\n$email_alert_api_bearer_token = undef,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-travel_advice_publisher.pp\n# Target line: 77\n\n     72:   $mongodb_name = undef,\n     73:   $mongodb_nodes = undef,\n     74:   $oauth_id = undef,\n     75:   $oauth_secret = undef,\n     76:   $port = '3035',\n>>>  77:   $publishing_api_bearer_token = undef,\n     78:   $redis_host = undef,\n     79:   $redis_port = undef,\n     80:   $secret_key_base = undef,\n     81:   $show_historical_edition_link = false,\n     82:   $email_alert_api_bearer_token = undef,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write.pp", "content": "$stagecraft_collection_endpoint_token = undef,", "line": 32, "detection_span": [27, 37], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write.pp\n\n#\nclass govuk::apps::backdrop_write (\n$enabled = true,\n$enable_procfile_worker = true,\n$signon_api_user_token = undef,\n32:   $stagecraft_collection_endpoint_token = undef,\n$transformer_rabbitmq_password = undef,\n$transformer_stagecraft_oauth_token = undef,\n) {\nif $enabled {\n$app_name = 'backdrop-write'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-apps-backdrop_write.pp\n# Target line: 32\n\n     27: #\n     28: class govuk::apps::backdrop_write (\n     29:   $enabled = true,\n     30:   $enable_procfile_worker = true,\n     31:   $signon_api_user_token = undef,\n>>>  32:   $stagecraft_collection_endpoint_token = undef,\n     33:   $transformer_rabbitmq_password = undef,\n     34:   $transformer_stagecraft_oauth_token = undef,\n     35: ) {\n     36:   if $enabled {\n     37:     $app_name = 'backdrop-write'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp", "content": "$middleware_password       = 'mcollective',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n\nclass mco_profile::params (\n$main_collective           = 'mcollective',\n$collectives               = undef,\n$middleware_hosts          = undef,\n$middleware_user           = 'mcollective',\n9:   $middleware_password       = 'mcollective',\n$middleware_ssl_port       = '61613',\n$ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n$ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n$ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",\n$ssl_ca_cert               = \"${::settings::ssldir}/certs/ca.pem\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-mcollective-examples-ssl_example-mco_profile-manifests-params.pp\n# Target line: 9\n\n      4: class mco_profile::params (\n      5:   $main_collective           = 'mcollective',\n      6:   $collectives               = undef,\n      7:   $middleware_hosts          = undef,\n      8:   $middleware_user           = 'mcollective',\n>>>   9:   $middleware_password       = 'mcollective',\n     10:   $middleware_ssl_port       = '61613',\n     11:   $ssl_server_public         = \"${::settings::ssldir}/public_keys/${::clientcert}.pem\",\n     12:   $ssl_server_private        = \"${::settings::ssldir}/private_keys/${::clientcert}.pem\",\n     13:   $ssl_server_cert           = \"${::settings::ssldir}/certs/${::clientcert}.pem\",\n     14:   $ssl_ca_cert               = \"${::settings::ssldir}/certs/ca.pem\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_development.pp", "content": "password => 'search_admin';", "line": 113, "detection_span": [108, 118], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_development.pp\n\nuser     => 'release',\npassword => 'release';\n110:\n['search_admin_development', 'search_admin_test']:\nuser     => 'search_admin',\n113:       password => 'search_admin';\n114:\n[\n'signonotron2_development',\n'signonotron2_test',\n'signonotron2_integration_test',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_development.pp\n# Target line: 113\n\n    108:       user     => 'release',\n    109:       password => 'release';\n    110: \n    111:     ['search_admin_development', 'search_admin_test']:\n    112:       user     => 'search_admin',\n>>> 113:       password => 'search_admin';\n    114: \n    115:     [\n    116:       'signonotron2_development',\n    117:       'signonotron2_test',\n    118:       'signonotron2_integration_test',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-sahara-rabbitmq.pp", "content": "$rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-sahara-rabbitmq.pp\n\n$kombu_ssl_keyfile = hiera('CONFIG_SAHARA_SSL_KEY', $::os_service_default)\n$kombu_ssl_certfile = hiera('CONFIG_SAHARA_SSL_CERT', $::os_service_default)\n\n$rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n$rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n12:     $rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n$rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n\nif ! is_service_default($kombu_ssl_keyfile) {\n$files_to_set_owner = [ $kombu_ssl_keyfile, $kombu_ssl_certfile ]\nfile { $files_to_set_owner:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-sahara-rabbitmq.pp\n# Target line: 12\n\n      7:     $kombu_ssl_keyfile = hiera('CONFIG_SAHARA_SSL_KEY', $::os_service_default)\n      8:     $kombu_ssl_certfile = hiera('CONFIG_SAHARA_SSL_CERT', $::os_service_default)\n      9: \n     10:     $rabbit_host = hiera('CONFIG_AMQP_HOST_URL')\n     11:     $rabbit_port = hiera('CONFIG_AMQP_CLIENTS_PORT')\n>>>  12:     $rabbit_userid = hiera('CONFIG_AMQP_AUTH_USER')\n     13:     $rabbit_password = hiera('CONFIG_AMQP_AUTH_PASSWORD')\n     14: \n     15:     if ! is_service_default($kombu_ssl_keyfile) {\n     16:       $files_to_set_owner = [ $kombu_ssl_keyfile, $kombu_ssl_certfile ]\n     17:       file { $files_to_set_owner:\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-ironic-manifests-drivers-inspector.pp", "content": "'inspector/password':            value => $password, secret => true;", "line": 86, "detection_span": [81, 91], "with_context": "# Puppet file: openstack@puppet-ironic-manifests-drivers-inspector.pp\n\n\nironic_config {\n'inspector/service_url':         value => $service_url;\n'inspector/auth_type':           value => $auth_type;\n'inspector/username':            value => $username;\n86:     'inspector/password':            value => $password, secret => true;\n'inspector/auth_url':            value => $auth_url;\n'inspector/project_name':        value => $project_name;\n'inspector/user_domain_name':    value => $user_domain_name;\n'inspector/project_domain_name': value => $project_domain_name;\n'inspector/endpoint_override':   value => $endpoint_override;", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-ironic-manifests-drivers-inspector.pp\n# Target line: 86\n\n     81: \n     82:   ironic_config {\n     83:     'inspector/service_url':         value => $service_url;\n     84:     'inspector/auth_type':           value => $auth_type;\n     85:     'inspector/username':            value => $username;\n>>>  86:     'inspector/password':            value => $password, secret => true;\n     87:     'inspector/auth_url':            value => $auth_url;\n     88:     'inspector/project_name':        value => $project_name;\n     89:     'inspector/user_domain_name':    value => $user_domain_name;\n     90:     'inspector/project_domain_name': value => $project_domain_name;\n     91:     'inspector/endpoint_override':   value => $endpoint_override;\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack@puppet-openstack-integration-manifests-murano.pp", "content": "rabbit_own_password   => 'an_even_bigger_secret',", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-murano.pp\n\n'username'  => 'murano',\n'password'  => 'an_even_bigger_secret',\n}),\nrabbit_os_use_ssl     => $::openstack_integration::config::ssl,\nrabbit_own_user       => 'murano_private',\n59:     rabbit_own_password   => 'an_even_bigger_secret',\nrabbit_own_vhost      => '/murano',\nrabbit_own_host       => $::openstack_integration::config::host,\nrabbit_own_port       => $::openstack_integration::config::rabbit_port,\nrabbit_own_use_ssl    => $::openstack_integration::config::ssl,\ndatabase_connection   => 'mysql+pymysql://murano:a_big_secret@127.0.0.1/murano?charset=utf8',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-murano.pp\n# Target line: 59\n\n     54:       'username'  => 'murano',\n     55:       'password'  => 'an_even_bigger_secret',\n     56:     }),\n     57:     rabbit_os_use_ssl     => $::openstack_integration::config::ssl,\n     58:     rabbit_own_user       => 'murano_private',\n>>>  59:     rabbit_own_password   => 'an_even_bigger_secret',\n     60:     rabbit_own_vhost      => '/murano',\n     61:     rabbit_own_host       => $::openstack_integration::config::host,\n     62:     rabbit_own_port       => $::openstack_integration::config::rabbit_port,\n     63:     rabbit_own_use_ssl    => $::openstack_integration::config::ssl,\n     64:     database_connection   => 'mysql+pymysql://murano:a_big_secret@127.0.0.1/murano?charset=utf8',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp", "content": "# make sure all PHP files are available from the host machine so they can be debugged", "line": 95, "detection_span": [90, 100], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n\nensure => 'link',\ntarget => $docroot,\n}\n}\n\n95:     # make sure all PHP files are available from the host machine so they can be debugged\nfile { '/vagrant/srv/docroot':\nensure             => present,\nsource             => $docroot,\nsource_permissions => ignore,\nrecurse            => remote,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-apache-manifests-init.pp\n# Target line: 95\n\n     90:             ensure => 'link',\n     91:             target => $docroot,\n     92:         }\n     93:     }\n     94: \n>>>  95:     # make sure all PHP files are available from the host machine so they can be debugged\n     96:     file { '/vagrant/srv/docroot':\n     97:         ensure             => present,\n     98:         source             => $docroot,\n     99:         source_permissions => ignore,\n    100:         recurse            => remote,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-common_config.pp", "content": "# TODO(aschultz): LP#1499620 - neutron in UCA liberty fails to start with", "line": 30, "detection_span": [25, 35], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-common_config.pp\n\n$rabbit_hash      = hiera_hash('rabbit', {})\n$ceilometer_hash  = hiera_hash('ceilometer', {})\n$network_scheme   = hiera_hash('network_scheme', {})\n\n$debug        = pick($openstack_network_hash['debug'], hiera('debug', true))\n30:   # TODO(aschultz): LP#1499620 - neutron in UCA liberty fails to start with\n# syslog enabled.\n$use_syslog = $::os_package_type ? {\n'ubuntu' => false,\ndefault  => hiera('use_syslog', true)\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-openstack_tasks-manifests-openstack_network-common_config.pp\n# Target line: 30\n\n     25:   $rabbit_hash      = hiera_hash('rabbit', {})\n     26:   $ceilometer_hash  = hiera_hash('ceilometer', {})\n     27:   $network_scheme   = hiera_hash('network_scheme', {})\n     28: \n     29:   $debug        = pick($openstack_network_hash['debug'], hiera('debug', true))\n>>>  30:   # TODO(aschultz): LP#1499620 - neutron in UCA liberty fails to start with\n     31:   # syslog enabled.\n     32:   $use_syslog = $::os_package_type ? {\n     33:     'ubuntu' => false,\n     34:     default  => hiera('use_syslog', true)\n     35:   }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-fuel-manifests-nailgun-server.pp", "content": "# FIXME(kozhukalov): fuel-nailgun package should provide nailgun group", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-nailgun-server.pp\n\n'oswl_volume_collectord',\n'receiverd',\n'statsenderd',\n]\n\n68:   # FIXME(kozhukalov): fuel-nailgun package should provide nailgun group\ngroup { 'nailgun' :\nprovider => \"groupadd\",\nensure   => \"present\",\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-fuel-manifests-nailgun-server.pp\n# Target line: 68\n\n     63:     'oswl_volume_collectord',\n     64:     'receiverd',\n     65:     'statsenderd',\n     66:   ]\n     67: \n>>>  68:   # FIXME(kozhukalov): fuel-nailgun package should provide nailgun group\n     69:   group { 'nailgun' :\n     70:     provider => \"groupadd\",\n     71:     ensure   => \"present\",\n     72:   }\n     73: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "voxpupuli@puppet-gluster-manifests-peer.pp", "content": "#       peering attempt only resolves a cosmetic issue, not a functional one.", "line": 42, "detection_span": [37, 47], "with_context": "# Puppet file: voxpupuli@puppet-gluster-manifests-peer.pp\n\n# Note: http://www.gluster.org/pipermail/gluster-users/2013-December/038354.html\n#       When server-a probes server-b, server-b will only record the IP address\n#       for server-a.  When server-b next runs Puppet, it will probe server-a\n#       because server-a's fqdn is not in the list of peers. The peering will\n#       have been successfully established the first time, so this second\n42: #       peering attempt only resolves a cosmetic issue, not a functional one.\n#\ndefine gluster::peer (\n$pool = 'default',\n$fqdn = $::fqdn,\n) {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: voxpupuli@puppet-gluster-manifests-peer.pp\n# Target line: 42\n\n     37: # Note: http://www.gluster.org/pipermail/gluster-users/2013-December/038354.html\n     38: #       When server-a probes server-b, server-b will only record the IP address\n     39: #       for server-a.  When server-b next runs Puppet, it will probe server-a\n     40: #       because server-a's fqdn is not in the list of peers. The peering will\n     41: #       have been successfully established the first time, so this second\n>>>  42: #       peering attempt only resolves a cosmetic issue, not a functional one.\n     43: #\n     44: define gluster::peer (\n     45:   $pool = 'default',\n     46:   $fqdn = $::fqdn,\n     47: ) {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-govuk_postgresql-manifests-rds_sql.pp", "content": "# This defined type attempts to solve this issue.", "line": 7, "detection_span": [2, 12], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-rds_sql.pp\n\n#\n# In Amazon RDS, an admin role is created to manage databases and roles. To create\n# a database owned by a specified role, the admin role must have membership of the\n# role you're trying to assign.\n#\n7: # This defined type attempts to solve this issue.\n#\n# === Parameters\n#\n# [*title*]\n#   The title of the defined type is the role that must be assigned to the admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk_postgresql-manifests-rds_sql.pp\n# Target line: 7\n\n      2: #\n      3: # In Amazon RDS, an admin role is created to manage databases and roles. To create\n      4: # a database owned by a specified role, the admin role must have membership of the\n      5: # role you're trying to assign.\n      6: #\n>>>   7: # This defined type attempts to solve this issue.\n      8: #\n      9: # === Parameters\n     10: #\n     11: # [*title*]\n     12: #   The title of the defined type is the role that must be assigned to the admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Icinga@puppet-icinga2-manifests-object-scheduleddowntime.pp", "content": "#   Set scheduleddowntime_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.", "line": 39, "detection_span": [34, 44], "with_context": "# Puppet file: Icinga@puppet-icinga2-manifests-object-scheduleddowntime.pp\n\n# [*apply*]\n#   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n#   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n#\n# [*prefix*]\n39: #   Set scheduleddowntime_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n#\n# [*apply_target*]\n#   An object type on which to target the apply rule. Valid values are `Host` and `Service`. Defaults to `Host`.\n#\n# [*assign*]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Icinga@puppet-icinga2-manifests-object-scheduleddowntime.pp\n# Target line: 39\n\n     34: # [*apply*]\n     35: #   Dispose an apply instead an object if set to 'true'. Value is taken as statement,\n     36: #   i.e. 'vhost => config in host.vars.vhosts'. Defaults to false.\n     37: #\n     38: # [*prefix*]\n>>>  39: #   Set scheduleddowntime_name as prefix in front of 'apply for'. Only effects if apply is a string. Defaults to false.\n     40: #\n     41: # [*apply_target*]\n     42: #   An object type on which to target the apply rule. Valid values are `Host` and `Service`. Defaults to `Host`.\n     43: #\n     44: # [*assign*]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp", "content": "# FIXME: we should not nuke the system with 'service network restart'...", "line": 29, "detection_span": [24, 34], "with_context": "# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n\ncfg { $gateway:\nfile  => '/etc/sysconfig/network',\nkey   => 'GATEWAY',\nvalue => $gateway,\n} ->\n29:           # FIXME: we should not nuke the system with 'service network restart'...\n# FIXME: but we should ensure default route will be created somehow\nexec { $exec_name :\npath    => '/bin:/usr/bin:/sbin:/usr/sbin',\ncommand => \"ip route replace default via ${gateway} || true\",\nunless  => \"netstat -r | grep -q 'default.*${gateway}'\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@fuel-library-deployment-puppet-l23network-manifests-l3-defaultroute.pp\n# Target line: 29\n\n     24:           cfg { $gateway:\n     25:               file  => '/etc/sysconfig/network',\n     26:               key   => 'GATEWAY',\n     27:               value => $gateway,\n     28:           } ->\n>>>  29:           # FIXME: we should not nuke the system with 'service network restart'...\n     30:           # FIXME: but we should ensure default route will be created somehow\n     31:           exec { $exec_name :\n     32:               path    => '/bin:/usr/bin:/sbin:/usr/sbin',\n     33:               command => \"ip route replace default via ${gateway} || true\",\n     34:               unless  => \"netstat -r | grep -q 'default.*${gateway}'\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-tripleo-manifests-profile-base-cinder-volume-nvmeof.pp", "content": "# [*target_prefix*]", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-nvmeof.pp\n\n#   (Required) Target user-land tool to use\n#\n# [*target_protocol*]\n#   (Required) Target rotocol to use\n#\n20: # [*target_prefix*]\n#   (Optional) Prefix for LVM volumes\n#   Defaults to 'nvme-subsystem'\n#\n# [*nvmet_port_id*]\n#   (Optional) Port id of the NVMe target", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-cinder-volume-nvmeof.pp\n# Target line: 20\n\n     15: #   (Required) Target user-land tool to use\n     16: #\n     17: # [*target_protocol*]\n     18: #   (Required) Target rotocol to use\n     19: #\n>>>  20: # [*target_prefix*]\n     21: #   (Optional) Prefix for LVM volumes\n     22: #   Defaults to 'nvme-subsystem'\n     23: #\n     24: # [*nvmet_port_id*]\n     25: #   (Optional) Port id of the NVMe target\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp", "content": "# FIXME: We don't manage the version of Puppet in the Vagrant box and", "line": 118, "detection_span": [113, 123], "with_context": "# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n\nrun_user        => 'syslog',\nrun_group       => 'syslog',\npurge_rsyslog_d => true,\n}\n117:\n118:     # FIXME: We don't manage the version of Puppet in the Vagrant box and\n# 3.0.2 doesn't lookup the correct boolean for `log_remote` from hiera.\nclass { 'rsyslog::client':\nlog_local  => true,\nlog_remote => false,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@ci-puppet-modules-ci_environment-manifests-transition_logs.pp\n# Target line: 118\n\n    113:       run_user        => 'syslog',\n    114:       run_group       => 'syslog',\n    115:       purge_rsyslog_d => true,\n    116:     }\n    117: \n>>> 118:     # FIXME: We don't manage the version of Puppet in the Vagrant box and\n    119:     # 3.0.2 doesn't lookup the correct boolean for `log_remote` from hiera.\n    120:     class { 'rsyslog::client':\n    121:       log_local  => true,\n    122:       log_remote => false,\n    123:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "puppetlabs@puppetlabs-apache-manifests-mod.pp", "content": "} elsif has_key($mod_libs, $mod) { # 2.6 compatibility hack", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod.pp\n\n\n# Determine if we have special lib\n$mod_libs = $::apache::mod_libs\nif $lib {\n$_lib = $lib\n23:   } elsif has_key($mod_libs, $mod) { # 2.6 compatibility hack\n$_lib = $mod_libs[$mod]\n} else {\n$_lib = \"mod_${mod}.so\"\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: puppetlabs@puppetlabs-apache-manifests-mod.pp\n# Target line: 23\n\n     18: \n     19:   # Determine if we have special lib\n     20:   $mod_libs = $::apache::mod_libs\n     21:   if $lib {\n     22:     $_lib = $lib\n>>>  23:   } elsif has_key($mod_libs, $mod) { # 2.6 compatibility hack\n     24:     $_lib = $mod_libs[$mod]\n     25:   } else {\n     26:     $_lib = \"mod_${mod}.so\"\n     27:   }\n     28: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mathoid-manifests-init.pp", "content": "#   Whether to provide extended information on the tex input and potential problems with it.", "line": 20, "detection_span": [15, 25], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mathoid-manifests-init.pp\n\n#\n# [*png*]\n#   Whether to generate PNGs. Default: true\n#\n# [*texvcinfo*]\n20: #   Whether to provide extended information on the tex input and potential problems with it.\n#   Default: true\n#\n# [*speak_text*]\n#   Whether to generate speakText representation. Default: true\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mathoid-manifests-init.pp\n# Target line: 20\n\n     15: #\n     16: # [*png*]\n     17: #   Whether to generate PNGs. Default: true\n     18: #\n     19: # [*texvcinfo*]\n>>>  20: #   Whether to provide extended information on the tex input and potential problems with it.\n     21: #   Default: true\n     22: #\n     23: # [*speak_text*]\n     24: #   Whether to generate speakText representation. Default: true\n     25: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alphagov@govuk-puppet-modules-nginx-manifests-config.pp", "content": "#   from DNS if an upstream lookup fails. This is the prefix address defined for a VPC.", "line": 18, "detection_span": [13, 23], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config.pp\n\n# [*denied_ip_addresses*]\n#   An array of IP addresses that Nginx should prevent from accessing this machine.\n#\n# [*stack_network_prefix*]\n#   This is only used in AWS. This adds a resolver so that nginx refreshes resolved addresses\n18: #   from DNS if an upstream lookup fails. This is the prefix address defined for a VPC.\n#\nclass nginx::config (\n$server_names_hash_max_size,\n$variables_hash_max_size = 1024,\n$denied_ip_addresses,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-nginx-manifests-config.pp\n# Target line: 18\n\n     13: # [*denied_ip_addresses*]\n     14: #   An array of IP addresses that Nginx should prevent from accessing this machine.\n     15: #\n     16: # [*stack_network_prefix*]\n     17: #   This is only used in AWS. This adds a resolver so that nginx refreshes resolved addresses\n>>>  18: #   from DNS if an upstream lookup fails. This is the prefix address defined for a VPC.\n     19: #\n     20: class nginx::config (\n     21:   $server_names_hash_max_size,\n     22:   $variables_hash_max_size = 1024,\n     23:   $denied_ip_addresses,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-libvirt.pp", "content": "# We have to fix the permissions after the installation has been done", "line": 23, "detection_span": [18, 28], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-libvirt.pp\n\nowner  => 'root',\ngroup  => 'kvm',\nmode   => '666',\n}\n\n23:         # We have to fix the permissions after the installation has been done\n# and before the service is started.\nPackage <| title == 'libvirt' |> ->\nFile['/dev/kvm'] ->\nService <| title == 'libvirt' |>\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-compute-libvirt.pp\n# Target line: 23\n\n     18:           owner  => 'root',\n     19:           group  => 'kvm',\n     20:           mode   => '666',\n     21:         }\n     22: \n>>>  23:         # We have to fix the permissions after the installation has been done\n     24:         # and before the service is started.\n     25:         Package <| title == 'libvirt' |> ->\n     26:         File['/dev/kvm'] ->\n     27:         Service <| title == 'libvirt' |>\n     28:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-settings.pp", "content": "#     values => template('db_debug/settings.php.erb'),", "line": 68, "detection_span": [63, 73], "with_context": "# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-settings.pp\n\n# Finally, 'settings' can also be specified as a string value. This can be\n# especially powerful when used in combination with Puppet's template()\n# function, as the following example illustrates:\n#\n#   mediawiki::settings { 'database debug':\n68: #     values => template('db_debug/settings.php.erb'),\n#   }\n#\n# If you have configured multiple wikis, settings can be applied to a particular\n# wiki by either providing a value for the 'wiki' parameter:\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: wikimedia@mediawiki-vagrant-puppet-modules-mediawiki-manifests-settings.pp\n# Target line: 68\n\n     63: # Finally, 'settings' can also be specified as a string value. This can be\n     64: # especially powerful when used in combination with Puppet's template()\n     65: # function, as the following example illustrates:\n     66: #\n     67: #   mediawiki::settings { 'database debug':\n>>>  68: #     values => template('db_debug/settings.php.erb'),\n     69: #   }\n     70: #\n     71: # If you have configured multiple wikis, settings can be applied to a particular\n     72: # wiki by either providing a value for the 'wiki' parameter:\n     73: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-php.pp", "content": "} elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack", "line": 46, "detection_span": [41, 51], "with_context": "# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-php.pp\n\n$mod_packages = $::apache::params::mod_packages\nif $package_name {\n$_package_name = $package_name\n} elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n$_package_name = $mod_packages[$mod]\n46:   } elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n$_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n} else {\n$_package_name = undef\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: SecGen@SecGen-modules-services-unix-http-apache_wheezy_compatible-apache-manifests-mod-php.pp\n# Target line: 46\n\n     41:   $mod_packages = $::apache::params::mod_packages\n     42:   if $package_name {\n     43:     $_package_name = $package_name\n     44:   } elsif has_key($mod_packages, $mod) { # 2.6 compatibility hack\n     45:     $_package_name = $mod_packages[$mod]\n>>>  46:   } elsif has_key($mod_packages, 'phpXXX') { # 2.6 compatibility hack\n     47:     $_package_name = regsubst($mod_packages['phpXXX'], 'XXX', $php_version)\n     48:   } else {\n     49:     $_package_name = undef\n     50:   }\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp", "content": "# TO-DO(mmagr): Add IPv6 support when hostnames are used", "line": 8, "detection_span": [3, 13], "with_context": "# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n\ncreate_resources(packstack::firewall, hiera('FIREWALL_NOVA_API_RULES', {}))\n\n$bind_host = hiera('CONFIG_IP_VERSION') ? {\n'ipv6'  => '::0',\ndefault => '0.0.0.0',\n8:       # TO-DO(mmagr): Add IPv6 support when hostnames are used\n}\n\n$www_authenticate_uri = hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS')\n$admin_password = hiera('CONFIG_NOVA_KS_PW')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@packstack-packstack-puppet-modules-packstack-manifests-nova-api.pp\n# Target line: 8\n\n      3:     create_resources(packstack::firewall, hiera('FIREWALL_NOVA_API_RULES', {}))\n      4: \n      5:     $bind_host = hiera('CONFIG_IP_VERSION') ? {\n      6:       'ipv6'  => '::0',\n      7:       default => '0.0.0.0',\n>>>   8:       # TO-DO(mmagr): Add IPv6 support when hostnames are used\n      9:     }\n     10: \n     11:     $www_authenticate_uri = hiera('CONFIG_KEYSTONE_PUBLIC_URL_VERSIONLESS')\n     12:     $admin_password = hiera('CONFIG_NOVA_KS_PW')\n     13: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "willdurand@puppet-nodejs-manifests-init.pp", "content": "# TODO remove!", "line": 85, "detection_span": [80, 90], "with_context": "# Puppet file: willdurand@puppet-nodejs-manifests-init.pp\n\nnodejs_default_path => $nodejs_default_path,\ndownload_timeout    => $download_timeout,\ninstall_dir         => $install_dir,\nsource              => $source,\n} ->\n85:     # TODO remove!\nfile { '/etc/profile.d/nodejs.sh':\nensure  => file,\nowner   => 'root',\ngroup   => 'root',\nmode    => '0644',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: willdurand@puppet-nodejs-manifests-init.pp\n# Target line: 85\n\n     80:       nodejs_default_path => $nodejs_default_path,\n     81:       download_timeout    => $download_timeout,\n     82:       install_dir         => $install_dir,\n     83:       source              => $source,\n     84:     } ->\n>>>  85:     # TODO remove!\n     86:     file { '/etc/profile.d/nodejs.sh':\n     87:       ensure  => file,\n     88:       owner   => 'root',\n     89:       group   => 'root',\n     90:       mode    => '0644',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-openstack-integration-manifests-repos.pp", "content": "# NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors", "line": 112, "detection_span": [107, 117], "with_context": "# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n\n107:   if $::osfamily == 'RedHat' {\npackage { 'python2-chardet':\nensure => 'latest',\n}\nYumrepo<||> -> Package<| title == 'python2-chardet' |>\n112:     # NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n# that causes the puppet-openvswitch module to fail parsing the output.\n# This issue does not occur in integration testing but only beaker tests since some\n# other package (probably nova) causes this package to be installed, or the yum upgrade\n# part in integration catches it.\n# Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-openstack-integration-manifests-repos.pp\n# Target line: 112\n\n    107:   if $::osfamily == 'RedHat' {\n    108:     package { 'python2-chardet':\n    109:       ensure => 'latest',\n    110:     }\n    111:     Yumrepo<||> -> Package<| title == 'python2-chardet' |>\n>>> 112:     # NOTE(tobias-urdin): Install libibverbs to fix an issue where OVS outputs errors\n    113:     # that causes the puppet-openvswitch module to fail parsing the output.\n    114:     # This issue does not occur in integration testing but only beaker tests since some\n    115:     # other package (probably nova) causes this package to be installed, or the yum upgrade\n    116:     # part in integration catches it.\n    117:     # Reported upstream: https://bugzilla.redhat.com/show_bug.cgi?id=1658141\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-install.pp", "content": "# Below code is not required when keepalive dependency is fixed.", "line": 10, "detection_span": [5, 15], "with_context": "# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-install.pp\n\n$upgrade_needed        = $::contrail::params::upgrade_needed,\n$manage_neutron        = $::contrail::params::manage_neutron\n) {\n# Install a specific version of keepalived in non-ha\n# case also, to support upgrade of contrail software.\n10:   # Below code is not required when keepalive dependency is fixed.\n#\nif ($contrail_internal_vip == \"\" and ($internal_vip == \"\" or !('openstack' in $contrail_host_roles))) {\n\nif ($::operatingsystem == 'Ubuntu') {\ncase $lsbdistrelease {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: Juniper@contrail-puppet-contrail-environment-modules-contrail-manifests-config-install.pp\n# Target line: 10\n\n      5:  $upgrade_needed        = $::contrail::params::upgrade_needed,\n      6:  $manage_neutron        = $::contrail::params::manage_neutron\n      7: ) {\n      8:   # Install a specific version of keepalived in non-ha\n      9:   # case also, to support upgrade of contrail software.\n>>>  10:   # Below code is not required when keepalive dependency is fixed.\n     11:   #\n     12:   if ($contrail_internal_vip == \"\" and ($internal_vip == \"\" or !('openstack' in $contrail_host_roles))) {\n     13: \n     14:       if ($::operatingsystem == 'Ubuntu') {\n     15:           case $lsbdistrelease {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "alup@puppet-rbenv-manifests-compile.pp", "content": "# Workaround http://projects.puppetlabs.com/issues/9848", "line": 17, "detection_span": [12, 22], "with_context": "# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n\n$keep           = false,\n$configure_opts = '--disable-install-doc',\n$bundler        = present,\n) {\n\n17:   # Workaround http://projects.puppetlabs.com/issues/9848\n$home_path = $home ? { '' => \"/home/${user}\", default => $home }\n$root_path = $root ? { '' => \"${home_path}/.rbenv\", default => $root }\n\n$bin         = \"${root_path}/bin\"\n$shims       = \"${root_path}/shims\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alup@puppet-rbenv-manifests-compile.pp\n# Target line: 17\n\n     12:   $keep           = false,\n     13:   $configure_opts = '--disable-install-doc',\n     14:   $bundler        = present,\n     15: ) {\n     16: \n>>>  17:   # Workaround http://projects.puppetlabs.com/issues/9848\n     18:   $home_path = $home ? { '' => \"/home/${user}\", default => $home }\n     19:   $root_path = $root ? { '' => \"${home_path}/.rbenv\", default => $root }\n     20: \n     21:   $bin         = \"${root_path}/bin\"\n     22:   $shims       = \"${root_path}/shims\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack@puppet-trove-manifests-logging.pp", "content": "#   (Optional) Prefix each line of exception output with this format.", "line": 59, "detection_span": [54, 64], "with_context": "# Puppet file: openstack@puppet-trove-manifests-logging.pp\n\n#   (Optional) Formatted data to append to log format when level is DEBUG.\n#   Defaults to $::os_service_default\n#   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n#\n# [*logging_exception_prefix*]\n59: #   (Optional) Prefix each line of exception output with this format.\n#   Defaults to $::os_service_default\n#   Example: '%(asctime)s.%(msecs)03d %(process)d TRACE %(name)s %(instance)s'\n#\n# [*log_config_append*]\n#   (Optional) The name of an additional logging configuration file.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-trove-manifests-logging.pp\n# Target line: 59\n\n     54: #   (Optional) Formatted data to append to log format when level is DEBUG.\n     55: #   Defaults to $::os_service_default\n     56: #   Example: '%(funcName)s %(pathname)s:%(lineno)d'\n     57: #\n     58: # [*logging_exception_prefix*]\n>>>  59: #   (Optional) Prefix each line of exception output with this format.\n     60: #   Defaults to $::os_service_default\n     61: #   Example: '%(asctime)s.%(msecs)03d %(process)d TRACE %(name)s %(instance)s'\n     62: #\n     63: # [*log_config_append*]\n     64: #   (Optional) The name of an additional logging configuration file.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "felho@boxen-modules-people-manifests-felho-applications-bettertouchtool.pp", "content": "source   => 'http://www.boastr.de/BetterTouchTool.zip',", "line": 4, "detection_span": [1, 9], "with_context": "# Puppet file: felho@boxen-modules-people-manifests-felho-applications-bettertouchtool.pp\n\nclass people::felho::applications::bettertouchtool {\npackage { 'BetterTouchTool':\nprovider => 'compressed_app',\n4:     source   => 'http://www.boastr.de/BetterTouchTool.zip',\nensure   => present,\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: felho@boxen-modules-people-manifests-felho-applications-bettertouchtool.pp\n# Target line: 4\n\n      1: class people::felho::applications::bettertouchtool {\n      2:   package { 'BetterTouchTool':\n      3:     provider => 'compressed_app',\n>>>   4:     source   => 'http://www.boastr.de/BetterTouchTool.zip',\n      5:     ensure   => present,\n      6:   }\n      7: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp", "content": "location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',", "line": 50, "detection_span": [45, 55], "with_context": "# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n\nlocation => 'https://download.docker.com/linux/ubuntu',\nrelease  => 'trusty',\nrepos    => ['stable'],\nkey      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n'elasticsearch-1.4':\n50:       location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\nrelease  => 'stable',\nkey      => 'D88E42B4';\n'elasticsearch-1.5':\nlocation => 'http://packages.elastic.co/elasticsearch/1.5/debian',\nrelease  => 'stable',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: alphagov@govuk-puppet-modules-govuk-manifests-node-s_apt.pp\n# Target line: 50\n\n     45:       location => 'https://download.docker.com/linux/ubuntu',\n     46:       release  => 'trusty',\n     47:       repos    => ['stable'],\n     48:       key      => '9DC858229FC7DD38854AE2D88D81803C0EBFCD88';\n     49:     'elasticsearch-1.4':\n>>>  50:       location => 'http://packages.elasticsearch.org/elasticsearch/1.4/debian',\n     51:       release  => 'stable',\n     52:       key      => 'D88E42B4';\n     53:     'elasticsearch-1.5':\n     54:       location => 'http://packages.elastic.co/elasticsearch/1.5/debian',\n     55:       release  => 'stable',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "quintel@boxen-modules-skype-manifests-init.pp", "content": "source   => 'http://download.skype.com/macosx/Skype_6.7.60.373.dmg',", "line": 9, "detection_span": [4, 14], "with_context": "# Puppet file: quintel@boxen-modules-skype-manifests-init.pp\n\n#\n#   include skype\nclass skype {\npackage { 'Skype':\nprovider => 'appdmg',\n9:     source   => 'http://download.skype.com/macosx/Skype_6.7.60.373.dmg',\n}\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: quintel@boxen-modules-skype-manifests-init.pp\n# Target line: 9\n\n      4: #\n      5: #   include skype\n      6: class skype {\n      7:   package { 'Skype':\n      8:     provider => 'appdmg',\n>>>   9:     source   => 'http://download.skype.com/macosx/Skype_6.7.60.373.dmg',\n     10:   }\n     11: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "use_of_http", "file": "danofthewired@puppet-bitbucket-manifests-facts.pp", "content": "$http = 'http://'", "line": 33, "detection_span": [28, 38], "with_context": "# Puppet file: danofthewired@puppet-bitbucket-manifests-facts.pp\n\n}\n\nif $is_https {\n$http = 'https://'\n}else{\n33:     $http = 'http://'\n}\n\nfile{'/etc/bitbucket_url.txt':\nensure  => $ensure,\ncontent => \"${http}${uri}:${port}${context_path}/rest/api/1.0/\\", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: danofthewired@puppet-bitbucket-manifests-facts.pp\n# Target line: 33\n\n     28:   }\n     29: \n     30:   if $is_https {\n     31:     $http = 'https://'\n     32:   }else{\n>>>  33:     $http = 'http://'\n     34:   }\n     35: \n     36:   file{'/etc/bitbucket_url.txt':\n     37:     ensure  => $ensure,\n     38:     content => \"${http}${uri}:${port}${context_path}/rest/api/1.0/\\\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp", "content": "baseurl        => 'http://mirrors.dotsrc.org/jpackage/5.0/generic/devel',", "line": 41, "detection_span": [36, 46], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n\npriority       => 10,\n}\n\nyum::managed_yumrepo { 'jpackage-generic-5.0-devel':\ndescr          => 'JPackage (free), generic',\n41:     baseurl        => 'http://mirrors.dotsrc.org/jpackage/5.0/generic/devel',\nfailovermethod => 'priority',\ngpgcheck       => 1,\ngpgkey         => 'http://www.jpackage.org/jpackage.asc',\nenabled        => 0,\npriority       => 10,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-jpackage5.pp\n# Target line: 41\n\n     36:     priority       => 10,\n     37:   }\n     38: \n     39:   yum::managed_yumrepo { 'jpackage-generic-5.0-devel':\n     40:     descr          => 'JPackage (free), generic',\n>>>  41:     baseurl        => 'http://mirrors.dotsrc.org/jpackage/5.0/generic/devel',\n     42:     failovermethod => 'priority',\n     43:     gpgcheck       => 1,\n     44:     gpgkey         => 'http://www.jpackage.org/jpackage.asc',\n     45:     enabled        => 0,\n     46:     priority       => 10,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "use_of_http", "file": "boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch10.pp", "content": "gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',", "line": 12, "detection_span": [7, 17], "with_context": "# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch10.pp\n\nyum::managed_yumrepo { 'elasticsearch-1.0':\ndescr          => 'Elasticsearch repository for 1.0.x packages',\nbaseurl        => 'http://packages.elasticsearch.org/elasticsearch/1.0/centos',\nenabled        => 1,\ngpgcheck       => 1,\n12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n}\n\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: boxbilling@boxbilling-puphpet-puppet-modules-yum-manifests-repo-elasticsearch10.pp\n# Target line: 12\n\n      7:   yum::managed_yumrepo { 'elasticsearch-1.0':\n      8:     descr          => 'Elasticsearch repository for 1.0.x packages',\n      9:     baseurl        => 'http://packages.elasticsearch.org/elasticsearch/1.0/centos',\n     10:     enabled        => 1,\n     11:     gpgcheck       => 1,\n>>>  12:     gpgkey         => 'http://packages.elasticsearch.org/GPG-KEY-elasticsearch',\n     13:   }\n     14: \n     15: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "weak_cryptography_algorithms", "file": "openstack@puppet-tripleo-manifests-profile-base-swift-ringbuilder.pp", "content": "unless  => 'swift-recon --md5 | grep -q \"doesn\\'t match\"',", "line": 155, "detection_span": [150, 160], "with_context": "# Puppet file: openstack@puppet-tripleo-manifests-profile-base-swift-ringbuilder.pp\n\n}\n} else {\nexec{'create_swift_ring_tarball':\npath    => ['/bin', '/usr/bin'],\ncommand => 'tar cvzf /tmp/swift-rings.tar.gz /etc/swift/*.builder /etc/swift/*.ring.gz /etc/swift/backups/',\n155:         unless  => 'swift-recon --md5 | grep -q \"doesn\\'t match\"',\n}\n}\nexec{'upload_swift_ring_tarball':\npath        => ['/usr/bin'],\ncommand     => \"curl -g --insecure --silent --retry 3 -X PUT '${$swift_ring_put_tempurl}' --data-binary @/tmp/swift-rings.tar.gz\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in puppet.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (puppet)\n\n# Puppet file: openstack@puppet-tripleo-manifests-profile-base-swift-ringbuilder.pp\n# Target line: 155\n\n    150:       }\n    151:     } else {\n    152:       exec{'create_swift_ring_tarball':\n    153:         path    => ['/bin', '/usr/bin'],\n    154:         command => 'tar cvzf /tmp/swift-rings.tar.gz /etc/swift/*.builder /etc/swift/*.ring.gz /etc/swift/backups/',\n>>> 155:         unless  => 'swift-recon --md5 | grep -q \"doesn\\'t match\"',\n    156:       }\n    157:     }\n    158:     exec{'upload_swift_ring_tarball':\n    159:       path        => ['/usr/bin'],\n    160:       command     => \"curl -g --insecure --silent --retry 3 -X PUT '${$swift_ring_put_tempurl}' --data-binary @/tmp/swift-rings.tar.gz\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
