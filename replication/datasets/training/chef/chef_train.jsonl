{"smell": "weak_cryptography_algorithms", "file": "gwalbran_chef-cookbooks-imos_artifacts-libraries-fetcher_jenkins.rb", "content": "tmpfile = Tempfile.new('jenkins-artifact-md5')", "line": 128, "detection_span": [123, 133], "with_context": "\ndef version(filename)\nVersion.new(filename)\nend\n126:\ndef get_artifact_md5_from_md5_file(artifact_md5_url)\n128:       tmpfile = Tempfile.new('jenkins-artifact-md5')\nif Fetcher.download_file(artifact_md5_url, tmpfile.path, @username, @password)\nremote_checksum = checksum_from_file(tmpfile.path)\nelse\nChef::Log.warn(\"Could not obtain md5 via md5 file at '#{artifact_md5_url}'\")\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_artifacts-libraries-fetcher_jenkins.rb\n# Target line: 128\n\n    123:     def version(filename)\n    124:       Version.new(filename)\n    125:     end\n    126: \n    127:     def get_artifact_md5_from_md5_file(artifact_md5_url)\n>>> 128:       tmpfile = Tempfile.new('jenkins-artifact-md5')\n    129:       if Fetcher.download_file(artifact_md5_url, tmpfile.path, @username, @password)\n    130:         remote_checksum = checksum_from_file(tmpfile.path)\n    131:       else\n    132:         Chef::Log.warn(\"Could not obtain md5 via md5 file at '#{artifact_md5_url}'\")\n    133:       end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "guymatz_chef-cookbooks-gitpaste-recipes-default.rb", "content": "variables(", "line": 56, "detection_span": [51, 61], "with_context": "\nend\n\ntemplate su_fixture do\nsource 'superuser.json.erb'\naction :nothing\n56:   variables(\n:username => node[:gitpaste][:superuser][:username],\n:email => node[:gitpaste][:superuser][:email],\n:password => \"sha1$00000$#{Digest::SHA1.hexdigest(\"00000#{node[:gitpaste][:superuser][:password]}\")}\"\n)\nowner 'nobody'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-gitpaste-recipes-default.rb\n# Target line: 56\n\n     51: end\n     52: \n     53: template su_fixture do\n     54:   source 'superuser.json.erb'\n     55:   action :nothing\n>>>  56:   variables(\n     57:     :username => node[:gitpaste][:superuser][:username],\n     58:     :email => node[:gitpaste][:superuser][:email],\n     59:     :password => \"sha1$00000$#{Digest::SHA1.hexdigest(\"00000#{node[:gitpaste][:superuser][:password]}\")}\"\n     60:   )\n     61:   owner 'nobody'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "AYCHIT_Asf-chef-cookbooks-psf-loadbalancer-recipes-stud.rb", "content": "ciphers 'ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AES:RSA+3DES:!ADH:!AECDH:!MD5'", "line": 25, "detection_span": [20, 30], "with_context": "\nversion '0.3-2-ef1745'\npem_file domains.map{|domain| \"/etc/ssl/private/#{domain}.pem\" }\nfrontend '[*]:443'\ntls false\nssl true\n25:   ciphers 'ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AES:RSA+3DES:!ADH:!AECDH:!MD5'\nprefer_server_ciphers true\nuser 'nobody'\ngroup 'nogroup'\nchroot '/var/lib/stud'\nsyslog true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: AYCHIT_Asf-chef-cookbooks-psf-loadbalancer-recipes-stud.rb\n# Target line: 25\n\n     20:   version '0.3-2-ef1745'\n     21:   pem_file domains.map{|domain| \"/etc/ssl/private/#{domain}.pem\" }\n     22:   frontend '[*]:443'\n     23:   tls false\n     24:   ssl true\n>>>  25:   ciphers 'ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AES:RSA+3DES:!ADH:!AECDH:!MD5'\n     26:   prefer_server_ciphers true\n     27:   user 'nobody'\n     28:   group 'nogroup'\n     29:   chroot '/var/lib/stud'\n     30:   syslog true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "weak_cryptography_algorithms", "file": "guymatz_chef-cookbooks-chef-server-recipes-apache-proxy.rb", "content": "code <<-EOH", "line": 49, "detection_span": [44, 54], "with_context": "\nmode 00700\nend\n\nbash \"Create SSL Certificates\" do\ncwd \"/etc/chef/certificates\"\n49:   code <<-EOH\numask 077\nopenssl genrsa 2048 > chef-server-proxy.key\nopenssl req -subj \"#{node['chef_server']['ssl_req']}\" -new -x509 -nodes -sha1 -days 3650 -key chef-server-proxy.key > chef-server-proxy.crt\ncat chef-server-proxy.key chef-server-proxy.crt > chef-server-proxy.pem\nEOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-chef-server-recipes-apache-proxy.rb\n# Target line: 49\n\n     44:   mode 00700\n     45: end\n     46: \n     47: bash \"Create SSL Certificates\" do\n     48:   cwd \"/etc/chef/certificates\"\n>>>  49:   code <<-EOH\n     50:   umask 077\n     51:   openssl genrsa 2048 > chef-server-proxy.key\n     52:   openssl req -subj \"#{node['chef_server']['ssl_req']}\" -new -x509 -nodes -sha1 -days 3650 -key chef-server-proxy.key > chef-server-proxy.crt\n     53:   cat chef-server-proxy.key chef-server-proxy.crt > chef-server-proxy.pem\n     54:   EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb", "content": "uri \"http://www.rabbitmq.com/debian/\"", "line": 46, "detection_span": [41, 51], "with_context": "\ncase node[:platform]\nwhen \"debian\", \"ubuntu\"\n# use the RabbitMQ repository instead of Ubuntu or Debian's\n# because there are very useful features in the newer versions\napt_repository \"rabbitmq\" do\n46:     uri \"http://www.rabbitmq.com/debian/\"\ndistribution \"testing\"\ncomponents [\"main\"]\nkey \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\naction :add\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb\n# Target line: 46\n\n     41: case node[:platform]\n     42: when \"debian\", \"ubuntu\"\n     43:   # use the RabbitMQ repository instead of Ubuntu or Debian's\n     44:   # because there are very useful features in the newer versions\n     45:   apt_repository \"rabbitmq\" do\n>>>  46:     uri \"http://www.rabbitmq.com/debian/\"\n     47:     distribution \"testing\"\n     48:     components [\"main\"]\n     49:     key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\n     50:     action :add\n     51:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-source.rb", "content": "default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'", "line": 9, "detection_span": [4, 14], "with_context": "\nif platform?('amazon')\nif node['platform_version'].to_i > 2010\ndefault['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\ndefault['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\n9:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\ndefault['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nelse\ndefault['yum']['epel-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-#{node['platform_version'].to_i}&arch=$basearch\"\ndefault['yum']['epel-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-source.rb\n# Target line: 9\n\n      4: if platform?('amazon')\n      5:   if node['platform_version'].to_i > 2010\n      6:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\n      7:     default['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      8:   else\n>>>   9:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\n     10:     default['yum']['epel-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     11:   end\n     12: else\n     13:   default['yum']['epel-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-#{node['platform_version'].to_i}&arch=$basearch\"\n     14:   default['yum']['epel-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kitchenware_master-chef-cookbooks-nginx-recipes-default.rb", "content": "url \"http://nginx.org/packages/debian/\"", "line": 14, "detection_span": [9, 19], "with_context": "\nend\n\nif node.lsb.codename == \"squeeze\"  && node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"nginx\" do\n14:     url \"http://nginx.org/packages/debian/\"\ncomponents [\"nginx\"]\nkey \"7BD9BF62\"\nkey_server \"keyserver.ubuntu.com\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-nginx-recipes-default.rb\n# Target line: 14\n\n      9: end\n     10: \n     11: if node.lsb.codename == \"squeeze\"  && node.apt.master_chef_add_apt_repo\n     12: \n     13:   add_apt_repository \"nginx\" do\n>>>  14:     url \"http://nginx.org/packages/debian/\"\n     15:     components [\"nginx\"]\n     16:     key \"7BD9BF62\"\n     17:     key_server \"keyserver.ubuntu.com\"\n     18:   end\n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-zabbix-attributes-default.rb", "content": "default[:zabbix][:agent][:prebuild_url]           = \"http://www.zabbix.com/downloads/:version:/zabbix_agents_:version:.:kernel:.:arch:.tar.gz\"", "line": 78, "detection_span": [73, 83], "with_context": "\ndefault[:zabbix][:agent][:log_dir]                = '/var/log/zabbix_agent'\ndefault[:zabbix][:agent][:create_host]            = true\ndefault[:zabbix][:agent][:unmonitor_on_shutdown]  = false\ndefault[:zabbix][:agent][:unsafe_user_parameters] = true\ndefault[:zabbix][:agent][:enable_remote_commands] = true\n78: default[:zabbix][:agent][:prebuild_url]           = \"http://www.zabbix.com/downloads/:version:/zabbix_agents_:version:.:kernel:.:arch:.tar.gz\"\ndefault[:zabbix][:agent][:prebuild_kernel]        = \"linux2_6\"\n\n# Web frontend\ncase platform\nwhen \"redhat\", \"centos\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-zabbix-attributes-default.rb\n# Target line: 78\n\n     73: default[:zabbix][:agent][:log_dir]                = '/var/log/zabbix_agent'\n     74: default[:zabbix][:agent][:create_host]            = true\n     75: default[:zabbix][:agent][:unmonitor_on_shutdown]  = false\n     76: default[:zabbix][:agent][:unsafe_user_parameters] = true\n     77: default[:zabbix][:agent][:enable_remote_commands] = true\n>>>  78: default[:zabbix][:agent][:prebuild_url]           = \"http://www.zabbix.com/downloads/:version:/zabbix_agents_:version:.:kernel:.:arch:.tar.gz\"\n     79: default[:zabbix][:agent][:prebuild_kernel]        = \"linux2_6\"\n     80: \n     81: # Web frontend\n     82: case platform\n     83: when \"redhat\", \"centos\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_oc-chef-client-attributes-default.rb", "content": "default[\"chef_client\"][\"winsw_url\"]   = \"http://repo1.maven.org/maven2/com/sun/winsw/winsw/1.9/winsw-1.9-bin.exe\"", "line": 90, "detection_span": [85, 95], "with_context": "\ndefault[\"chef_client\"][\"backup_path\"] = \"#{node[\"chef_client\"][\"conf_dir\"]}/backup\"\ndefault[\"chef_client\"][\"log_dir\"]     = \"#{node[\"chef_client\"][\"conf_dir\"]}/log\"\ndefault[\"chef_client\"][\"bin\"]         = \"C:/opscode/chef/bin/chef-client\"\n#Required for minsw wrapper\ndefault[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n90:   default[\"chef_client\"][\"winsw_url\"]   = \"http://repo1.maven.org/maven2/com/sun/winsw/winsw/1.9/winsw-1.9-bin.exe\"\ndefault[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\ndefault[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\nelse\ndefault[\"chef_client\"][\"init_style\"]  = \"none\"\ndefault[\"chef_client\"][\"run_path\"]    = \"/var/run\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_oc-chef-client-attributes-default.rb\n# Target line: 90\n\n     85:   default[\"chef_client\"][\"backup_path\"] = \"#{node[\"chef_client\"][\"conf_dir\"]}/backup\"\n     86:   default[\"chef_client\"][\"log_dir\"]     = \"#{node[\"chef_client\"][\"conf_dir\"]}/log\"\n     87:   default[\"chef_client\"][\"bin\"]         = \"C:/opscode/chef/bin/chef-client\"\n     88:   #Required for minsw wrapper\n     89:   default[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n>>>  90:   default[\"chef_client\"][\"winsw_url\"]   = \"http://repo1.maven.org/maven2/com/sun/winsw/winsw/1.9/winsw-1.9-bin.exe\"\n     91:   default[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\n     92:   default[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\n     93: else\n     94:   default[\"chef_client\"][\"init_style\"]  = \"none\"\n     95:   default[\"chef_client\"][\"run_path\"]    = \"/var/run\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aws_opsworks-cookbooks-opsworks_rubygems-recipes-default.rb", "content": "source \"http://rubygems.org/rubygems/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\"", "line": 2, "detection_span": [1, 7], "with_context": "\nrubygems_download = remote_file \"/tmp/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\" do\n2:   source \"http://rubygems.org/rubygems/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\"\nnot_if do\n::File.exists?('/usr/local/bin/gem') && `/usr/local/bin/gem -v`.strip == node[:opsworks_rubygems][:version]\nend\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-opsworks_rubygems-recipes-default.rb\n# Target line: 2\n\n      1: rubygems_download = remote_file \"/tmp/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\" do\n>>>   2:   source \"http://rubygems.org/rubygems/rubygems-#{node[:opsworks_rubygems][:version]}.tgz\"\n      3:   not_if do\n      4:     ::File.exists?('/usr/local/bin/gem') && `/usr/local/bin/gem -v`.strip == node[:opsworks_rubygems][:version]\n      5:   end\n      6: end\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_hw-java-attributes-default.rb", "content": "default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-i586.tar.gz'", "line": 59, "detection_span": [54, 64], "with_context": "\n# x86_64\ndefault['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-x64.tar.gz'\ndefault['java']['jdk']['7']['x86_64']['checksum'] = 'aaf0296f08007cb178ff45dea61125aedb8af0450f82e0f2fd51df5391c9e837'\n\n# i586\n59: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-i586.tar.gz'\ndefault['java']['jdk']['7']['i586']['checksum'] = '422dfe67a4885d47c0053b97f4a56fb4dced60799a1bb82f8266b0745a7149f7'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_hw-java-attributes-default.rb\n# Target line: 59\n\n     54: # x86_64\n     55: default['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-x64.tar.gz'\n     56: default['java']['jdk']['7']['x86_64']['checksum'] = 'aaf0296f08007cb178ff45dea61125aedb8af0450f82e0f2fd51df5391c9e837'\n     57: \n     58: # i586\n>>>  59: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u5-b06/jdk-7u5-linux-i586.tar.gz'\n     60: default['java']['jdk']['7']['i586']['checksum'] = '422dfe67a4885d47c0053b97f4a56fb4dced60799a1bb82f8266b0745a7149f7'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "enterstudio_ey-cloud-recipes-cookbooks-sunspot-recipes-default.rb", "content": "source \"http://gemcutter.org\"", "line": 64, "detection_span": [59, 69], "with_context": "\nsource \"http://gemcutter.org\"\naction :install\nend\n\ngem_package \"nokogiri\" do\n64:     source \"http://gemcutter.org\"\naction :install\nend\n\nexecute \"install-sunspot-solr\" do\nuser node[:owner_name]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: enterstudio_ey-cloud-recipes-cookbooks-sunspot-recipes-default.rb\n# Target line: 64\n\n     59:     source \"http://gemcutter.org\"\n     60:     action :install\n     61:   end\n     62:   \n     63:   gem_package \"nokogiri\" do\n>>>  64:     source \"http://gemcutter.org\"\n     65:     action :install\n     66:   end\n     67:  \n     68:   execute \"install-sunspot-solr\" do\n     69:     user node[:owner_name]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aligent_chef-aligent-magento-dev-recipes-yum-nexcess.rb", "content": "baseurl \"http://rpms.nexcess.net/el/$releasever/scl/$basearch/\"", "line": 40, "detection_span": [35, 45], "with_context": "\nexclude \"mysql* varnish*\"\nend\n\nyum_repository \"nexcess_scl\" do\ndescription \"Nexcess Repo SCL\"\n40:     baseurl \"http://rpms.nexcess.net/el/$releasever/scl/$basearch/\"\ngpgcheck true\ngpgkey \"http://rpms.nexcess.net/RPM-GPG-KEY-NEXCESS\"\nenabled true\nexclude \"mysql* varnish*\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aligent_chef-aligent-magento-dev-recipes-yum-nexcess.rb\n# Target line: 40\n\n     35:     exclude \"mysql* varnish*\"\n     36: end\n     37: \n     38: yum_repository \"nexcess_scl\" do\n     39:     description \"Nexcess Repo SCL\"\n>>>  40:     baseurl \"http://rpms.nexcess.net/el/$releasever/scl/$basearch/\"\n     41:     gpgcheck true\n     42:     gpgkey \"http://rpms.nexcess.net/RPM-GPG-KEY-NEXCESS\"\n     43:     enabled true\n     44:     exclude \"mysql* varnish*\"\n     45: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb", "content": "baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"", "line": 31, "detection_span": [26, 36], "with_context": "\n#\n\n# Configure the Nexcess yum repo so we can match their php versions\nyum_repository \"iworx\" do\ndescription \"Interworx Repo\"\n31:     baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\ngpgcheck true\ngpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\nenabled true\nincludepkgs \"mod_fastcgi*\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb\n# Target line: 31\n\n     26: #\n     27: \n     28: # Configure the Nexcess yum repo so we can match their php versions\n     29: yum_repository \"iworx\" do\n     30:     description \"Interworx Repo\"\n>>>  31:     baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\n     32:     gpgcheck true\n     33:     gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\n     34:     enabled true\n     35:     includepkgs \"mod_fastcgi*\"\n     36: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-yum-attributes-remi.rb", "content": "default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"", "line": 24, "detection_span": [19, 29], "with_context": "\n\ncase node['platform']\nwhen \"fedora\"\ndefault['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\nelse\n24:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\nend\n\ndefault['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"\ndefault['yum']['remi']['key_url'] = \"http://rpms.famillecollet.com/#{node['yum']['remi']['key']}\"\ndefault['yum']['remi']['includepkgs'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-yum-attributes-remi.rb\n# Target line: 24\n\n     19: \n     20: case node['platform']\n     21: when \"fedora\"\n     22:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\n     23: else\n>>>  24:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\n     25: end\n     26: \n     27: default['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"\n     28: default['yum']['remi']['key_url'] = \"http://rpms.famillecollet.com/#{node['yum']['remi']['key']}\"\n     29: default['yum']['remi']['includepkgs'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-yum-epel-attributes-epel-testing-source.rb", "content": "default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault['yum']['epel-testing-source']['repositoryid'] = 'epel-testing-source'\ndefault['yum']['epel-testing-source']['description'] = \"Extra Packages for #{node['platform_version'].to_i} - $basearch - Testing Source\"\ncase node['platform']\nwhen 'amazon'\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\n6:   default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\ndefault['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\ndefault['yum']['epel-testing-source']['gpgkey'] = \"https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\nend\ndefault['yum']['epel-testing-source']['failovermethod'] = 'priority'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-yum-epel-attributes-epel-testing-source.rb\n# Target line: 6\n\n      1: default['yum']['epel-testing-source']['repositoryid'] = 'epel-testing-source'\n      2: default['yum']['epel-testing-source']['description'] = \"Extra Packages for #{node['platform_version'].to_i} - $basearch - Testing Source\"\n      3: case node['platform']\n      4: when 'amazon'\n      5:   default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\n>>>   6:   default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      7: else\n      8:   default['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\n      9:   default['yum']['epel-testing-source']['gpgkey'] = \"https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\n     10: end\n     11: default['yum']['epel-testing-source']['failovermethod'] = 'priority'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-phpapp-definitions-wordpress_site.rb", "content": "source 'http://wordpress.org/latest.tar.gz'", "line": 5, "detection_span": [1, 10], "with_context": "\ndefine :wordpress_site, :path => \"/var/www/phpapp\",:database => \"phpapp\", :db_username => \"phpapp\",:db_password => \"phpapp\", :db_host => \"localhost\",  :template => \"site.conf.erb\" do\nwordpress_latest = Chef::Config[:file_cache_path] + '/wordpress-latest.tar.gz'\n\nremote_file wordpress_latest do\n5:     source 'http://wordpress.org/latest.tar.gz'\nmode 0644\nend\n\ndirectory params[:path] do\nowner 'root'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-phpapp-definitions-wordpress_site.rb\n# Target line: 5\n\n      1: define :wordpress_site, :path => \"/var/www/phpapp\",:database => \"phpapp\", :db_username => \"phpapp\",:db_password => \"phpapp\", :db_host => \"localhost\",  :template => \"site.conf.erb\" do\n      2:   wordpress_latest = Chef::Config[:file_cache_path] + '/wordpress-latest.tar.gz'\n      3: \n      4:   remote_file wordpress_latest do\n>>>   5:     source 'http://wordpress.org/latest.tar.gz'\n      6:     mode 0644\n      7:   end\n      8: \n      9:   directory params[:path] do\n     10:     owner 'root'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-redis-cookbooks-snappy-attributes-default.rb", "content": "default[:snappy][:release_url]       = \"http://snappy.googlecode.com/files/snappy-:version:.tar.gz\"", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault[:snappy][:home_dir]          = '/usr/local/share/snappy'\n\ndefault[:snappy][:version]           = \"1.0.4\"\n4: default[:snappy][:release_url]       = \"http://snappy.googlecode.com/files/snappy-:version:.tar.gz\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-snappy-attributes-default.rb\n# Target line: 4\n\n      1: default[:snappy][:home_dir]          = '/usr/local/share/snappy'\n      2: \n      3: default[:snappy][:version]           = \"1.0.4\"\n>>>   4: default[:snappy][:release_url]       = \"http://snappy.googlecode.com/files/snappy-:version:.tar.gz\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Soluciones_ey-cloud-recipes-cookbooks-php55-providers-default.rb", "content": "source \"http://download.newrelic.com/php_agent/archive/#{node[:newrelic][:php_rpm_version]}/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\"", "line": 29, "detection_span": [24, 34], "with_context": "\naction :create\nrecursive true\nend\n\nremote_file \"/opt/php_rpm/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\" do\n29:     source \"http://download.newrelic.com/php_agent/archive/#{node[:newrelic][:php_rpm_version]}/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\"\naction :create_if_missing\nend\n\n# Install newrelic PHP as 'root' user using silent install\nbash \"install_newrelic_php\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-php55-providers-default.rb\n# Target line: 29\n\n     24:     action :create\n     25:     recursive true\n     26:   end\n     27: \n     28:   remote_file \"/opt/php_rpm/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\" do\n>>>  29:     source \"http://download.newrelic.com/php_agent/archive/#{node[:newrelic][:php_rpm_version]}/newrelic-php5-#{node[:newrelic][:php_rpm_version]}-linux.tar.gz\"\n     30:     action :create_if_missing\n     31:   end\n     32: \n     33:   # Install newrelic PHP as 'root' user using silent install\n     34:   bash \"install_newrelic_php\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "redu_ey-cloud-recipes-cookbooks-riak-recipes-install_riak.rb", "content": "source \"http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/CURRENT/riak-#{node[:riak][:version]}.tar.gz\"", "line": 10, "detection_span": [5, 15], "with_context": "\nversion '1.7.0'\naction :install\nend\n\nremote_file \"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\" do\n10:   source \"http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/CURRENT/riak-#{node[:riak][:version]}.tar.gz\"\nbackup 0\nnot_if { FileTest.exists?(\"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\") }\nend\n\nexecute \"untar riak\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: redu_ey-cloud-recipes-cookbooks-riak-recipes-install_riak.rb\n# Target line: 10\n\n      5:   version '1.7.0'\n      6:   action :install\n      7: end\n      8: \n      9: remote_file \"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\" do\n>>>  10:   source \"http://downloads.basho.com.s3-website-us-east-1.amazonaws.com/riak/CURRENT/riak-#{node[:riak][:version]}.tar.gz\"\n     11:   backup 0\n     12:   not_if { FileTest.exists?(\"/mnt/src/riak-#{node[:riak][:version]}.tar.gz\") }\n     13: end\n     14: \n     15: execute \"untar riak\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-mongodb-attributes-default.rb", "content": "default[:mongodb][:x86_64][:release_url]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.2.1.tgz\"", "line": 36, "detection_span": [31, 41], "with_context": "\n\ndefault[:mongodb][:version]                         = \"2.2.1\"\ndefault[:mongodb][:i686][:release_file_md5]         = \"21153b201cad912c273d754b02eba19b\"\ndefault[:mongodb][:i686][:release_url]              = \"http://fastdl.mongodb.org/linux/mongodb-linux-i686-2.2.1.tgz\"\ndefault[:mongodb][:x86_64][:release_file_md5]       = \"6b2cce94194113ebfe2a14bdb84ccd7e\"\n36: default[:mongodb][:x86_64][:release_url]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.2.1.tgz\"\n\n#\n# Services\n#\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-mongodb-attributes-default.rb\n# Target line: 36\n\n     31: \n     32: default[:mongodb][:version]                         = \"2.2.1\"\n     33: default[:mongodb][:i686][:release_file_md5]         = \"21153b201cad912c273d754b02eba19b\"\n     34: default[:mongodb][:i686][:release_url]              = \"http://fastdl.mongodb.org/linux/mongodb-linux-i686-2.2.1.tgz\"\n     35: default[:mongodb][:x86_64][:release_file_md5]       = \"6b2cce94194113ebfe2a14bdb84ccd7e\"\n>>>  36: default[:mongodb][:x86_64][:release_url]            = \"http://fastdl.mongodb.org/linux/mongodb-linux-x86_64-2.2.1.tgz\"\n     37: \n     38: #\n     39: # Services\n     40: #\n     41: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-yum-epel-attributes-epel-testing-source.rb", "content": "default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel5&arch=$basearch'", "line": 12, "detection_span": [7, 17], "with_context": "\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\ncase node['platform_version'].to_i\nwhen 5\ndefault['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 5 - Testing - $basearch Source'\n12:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel5&arch=$basearch'\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\nwhen 6\ndefault['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 6 - Testing - $basearch Source'\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'https://mirrors.fedoraproject.org/metalink?repo=testing-source-epel6&arch=$basearch'\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-yum-epel-attributes-epel-testing-source.rb\n# Target line: 12\n\n      7:   default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      8: else\n      9:   case node['platform_version'].to_i\n     10:   when 5\n     11:     default['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 5 - Testing - $basearch Source'\n>>>  12:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel5&arch=$basearch'\n     13:     default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\n     14:   when 6\n     15:     default['yum']['epel-testing-source']['description'] = 'Extra Packages for Enterprise Linux 6 - Testing - $basearch Source'\n     16:     default['yum']['epel-testing-source']['mirrorlist'] = 'https://mirrors.fedoraproject.org/metalink?repo=testing-source-epel6&arch=$basearch'\n     17:     default['yum']['epel-testing-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "DrRayWang_Chef-Base-cookbooks-bach_spark-attributes-default.rb", "content": "default[:spark][:download][:url] = \"http://d3kbcqa49mib13.cloudfront.net\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:spark][:download][:url] = \"http://d3kbcqa49mib13.cloudfront.net\"\ndefault[:spark][:download][:file][:name] = \"spark-1.4.0-bin-hadoop2.6\"\ndefault[:spark][:download][:file][:type] = \"tgz\"\ndefault[:spark][:download][:dir] = \"/home/vagrant/chef-bcpc/bins\"\ndefault[:spark][:package][:base] = \"/usr/spark\"\ndefault[:spark][:package][:prefix] = \"spark\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bach_spark-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:spark][:download][:url] = \"http://d3kbcqa49mib13.cloudfront.net\"\n      2: default[:spark][:download][:file][:name] = \"spark-1.4.0-bin-hadoop2.6\"\n      3: default[:spark][:download][:file][:type] = \"tgz\"\n      4: default[:spark][:download][:dir] = \"/home/vagrant/chef-bcpc/bins\"\n      5: default[:spark][:package][:base] = \"/usr/spark\"\n      6: default[:spark][:package][:prefix] = \"spark\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_nd-sensu-community-plugins-plugins-newrelic-newrelic-metrics.rb", "content": "rpm = \"http://rpm.newrelic.com\"", "line": 43, "detection_span": [38, 48], "with_context": "\n:short => \"-s SCHEME\",\n:long => \"--scheme SCHEME\",\n:default => \"#{Socket.gethostname}.newrelic\"\n\ndef run\n43:     rpm = \"http://rpm.newrelic.com\"\n\nurl = URI.parse(rpm)\n\nres = Net::HTTP.start(url.host, url.port) do |http|\nreq = Net::HTTP::Get.new(\"/accounts.xml?include=application_health\")", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_nd-sensu-community-plugins-plugins-newrelic-newrelic-metrics.rb\n# Target line: 43\n\n     38:     :short => \"-s SCHEME\",\n     39:     :long => \"--scheme SCHEME\",\n     40:     :default => \"#{Socket.gethostname}.newrelic\"\n     41: \n     42:   def run\n>>>  43:     rpm = \"http://rpm.newrelic.com\"\n     44: \n     45:     url = URI.parse(rpm)\n     46: \n     47:     res = Net::HTTP.start(url.host, url.port) do |http|\n     48:       req = Net::HTTP::Get.new(\"/accounts.xml?include=application_health\")\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-nagios-attributes-server.rb", "content": "default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'", "line": 34, "detection_span": [29, 39], "with_context": "\nwhen /^hls/\ndefault['nagios']['pagerduty_key'] = String.new\ndefault['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\nwhen /^staging-hls/\ndefault['nagios']['pagerduty_key'] = String.new\n34:   default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\nwhen /^stage/\ndefault['nagios']['pagerduty_key'] = String.new\ndefault['nagios']['server']['url'] = 'http://yum.ihr/files'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nagios-attributes-server.rb\n# Target line: 34\n\n     29: when /^hls/\n     30:   default['nagios']['pagerduty_key'] = String.new\n     31:   default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n     32: when /^staging-hls/\n     33:   default['nagios']['pagerduty_key'] = String.new\n>>>  34:   default['nagios']['server']['url'] = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n     35: when /^stage/\n     36:   default['nagios']['pagerduty_key'] = String.new\n     37:   default['nagios']['server']['url'] = 'http://yum.ihr/files'\n     38: end\n     39: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "shortdudey123_chef-gluster-recipes-repository.rb", "content": "repo_url = \"http://#{subdomain}.centos.org/centos/$releasever/storage/$basearch/gluster-#{node['gluster']['version']}/\"", "line": 58, "detection_span": [53, 63], "with_context": "\nelse\nsubdomain = 'mirror'\ngpg_url = 'https://raw.githubusercontent.com/CentOS-Storage-SIG/centos-release-storage-common/master/RPM-GPG-KEY-CentOS-SIG-Storage'\nend\n\n58:     repo_url = \"http://#{subdomain}.centos.org/centos/$releasever/storage/$basearch/gluster-#{node['gluster']['version']}/\"\nelse\nurl = \"https://download.gluster.org/pub/gluster/glusterfs/#{node['gluster']['version']}/LATEST/EPEL.repo\"\nrepo_url = \"#{url}/epel-$releasever/$basearch/\"\ngpg_url = \"#{url}/dsa.pub\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: shortdudey123_chef-gluster-recipes-repository.rb\n# Target line: 58\n\n     53:     else\n     54:       subdomain = 'mirror'\n     55:       gpg_url = 'https://raw.githubusercontent.com/CentOS-Storage-SIG/centos-release-storage-common/master/RPM-GPG-KEY-CentOS-SIG-Storage'\n     56:     end\n     57: \n>>>  58:     repo_url = \"http://#{subdomain}.centos.org/centos/$releasever/storage/$basearch/gluster-#{node['gluster']['version']}/\"\n     59:   else\n     60:     url = \"https://download.gluster.org/pub/gluster/glusterfs/#{node['gluster']['version']}/LATEST/EPEL.repo\"\n     61:     repo_url = \"#{url}/epel-$releasever/$basearch/\"\n     62:     gpg_url = \"#{url}/dsa.pub\"\n     63:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb", "content": "default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'", "line": 20, "detection_span": [15, 25], "with_context": "\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nend\n\ndefault['yum']['epel']['failovermethod'] = 'priority'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb\n# Target line: 20\n\n     15:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n     16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n     17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n>>>  20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\n     21:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     22:   end\n     23: end\n     24: \n     25: default['yum']['epel']['failovermethod'] = 'priority'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Soluciones_ey-cloud-recipes-cookbooks-jenkins-recipes-jetty_install.rb", "content": "source \"http://download.eclipse.org/jetty/8.1.17.v20150415/dist/jetty-distribution-8.1.17.v20150415.tar.gz\"", "line": 2, "detection_span": [1, 7], "with_context": "\nremote_file \"/tmp/jetty.tar.gz\" do\n2:   source \"http://download.eclipse.org/jetty/8.1.17.v20150415/dist/jetty-distribution-8.1.17.v20150415.tar.gz\"\naction :create_if_missing\nmode 0644\nend\n\nremote_file \"/etc/monit.d/jetty.monitrc\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-jenkins-recipes-jetty_install.rb\n# Target line: 2\n\n      1: remote_file \"/tmp/jetty.tar.gz\" do\n>>>   2:   source \"http://download.eclipse.org/jetty/8.1.17.v20150415/dist/jetty-distribution-8.1.17.v20150415.tar.gz\"\n      3:   action :create_if_missing\n      4:   mode 0644\n      5: end\n      6: \n      7: remote_file \"/etc/monit.d/jetty.monitrc\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-attivio-recipes-backups.rb", "content": "source \"http://yum.ihr/files/nagios/check_attivio_backup_freshness.sh\"", "line": 68, "detection_span": [63, 73], "with_context": "\ngroup \"root\"\nmode \"0755\"\nend\n\nremote_file \"/root/scripts/check_attivio_backup_freshness.sh\" do\n68:   source \"http://yum.ihr/files/nagios/check_attivio_backup_freshness.sh\"\naction :create_if_missing\nowner \"root\"\ngroup \"root\"\nmode \"0755\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-attivio-recipes-backups.rb\n# Target line: 68\n\n     63:   group \"root\"\n     64:   mode \"0755\"\n     65: end\n     66: \n     67: remote_file \"/root/scripts/check_attivio_backup_freshness.sh\" do\n>>>  68:   source \"http://yum.ihr/files/nagios/check_attivio_backup_freshness.sh\"\n     69:   action :create_if_missing\n     70:   owner \"root\"\n     71:   group \"root\"\n     72:   mode \"0755\"\n     73: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_oc-mysql-attributes-server.rb", "content": "default['mysql']['url']                     = \"http://www.mysql.com/get/Downloads/MySQL-5.5/#{mysql['package_file']}/from/http://mysql.mirrors.pair.com/\"", "line": 61, "detection_span": [56, 66], "with_context": "\nwhen \"windows\"\ndefault['mysql']['server']['packages']      = [\"MySQL Server 5.5\"]\ndefault['mysql']['version']                 = '5.5.21'\ndefault['mysql']['arch']                    = 'win32'\ndefault['mysql']['package_file']            = \"mysql-#{mysql['version']}-#{mysql['arch']}.msi\"\n61:   default['mysql']['url']                     = \"http://www.mysql.com/get/Downloads/MySQL-5.5/#{mysql['package_file']}/from/http://mysql.mirrors.pair.com/\"\n\ndefault['mysql']['service_name']            = \"mysql\"\ndefault['mysql']['basedir']                 = \"#{ENV['SYSTEMDRIVE']}\\\\Program Files (x86)\\\\MySQL\\\\#{mysql['server']['packages'].first}\"\ndefault['mysql']['data_dir']                = \"#{mysql['basedir']}\\\\Data\"\ndefault['mysql']['bin_dir']                 = \"#{mysql['basedir']}\\\\bin\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_oc-mysql-attributes-server.rb\n# Target line: 61\n\n     56: when \"windows\"\n     57:   default['mysql']['server']['packages']      = [\"MySQL Server 5.5\"]\n     58:   default['mysql']['version']                 = '5.5.21'\n     59:   default['mysql']['arch']                    = 'win32'\n     60:   default['mysql']['package_file']            = \"mysql-#{mysql['version']}-#{mysql['arch']}.msi\"\n>>>  61:   default['mysql']['url']                     = \"http://www.mysql.com/get/Downloads/MySQL-5.5/#{mysql['package_file']}/from/http://mysql.mirrors.pair.com/\"\n     62: \n     63:   default['mysql']['service_name']            = \"mysql\"\n     64:   default['mysql']['basedir']                 = \"#{ENV['SYSTEMDRIVE']}\\\\Program Files (x86)\\\\MySQL\\\\#{mysql['server']['packages'].first}\"\n     65:   default['mysql']['data_dir']                = \"#{mysql['basedir']}\\\\Data\"\n     66:   default['mysql']['bin_dir']                 = \"#{mysql['basedir']}\\\\bin\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-ntp-attributes-default.rb", "content": "default['ntp']['vs_runtime_url'] = 'http://download.microsoft.com/download/1/1/1/1116b75a-9ec3-481a-a3c8-1777b5381140/vcredist_x86.exe'", "line": 62, "detection_span": [57, 67], "with_context": "\ndefault['ntp']['driftfile'] = 'C:\\\\NTP\\\\ntp.drift'\ndefault['ntp']['conffile'] = 'C:\\\\NTP\\\\etc\\\\ntp.conf'\ndefault['ntp']['conf_owner'] = 'Administrators'\ndefault['ntp']['conf_group'] = 'Administrators'\ndefault['ntp']['package_url'] = 'http://www.meinbergglobal.com/download/ntp/windows/ntp-4.2.6p5@london-o-lpv-win32-setup.exe'\n62:   default['ntp']['vs_runtime_url'] = 'http://download.microsoft.com/download/1/1/1/1116b75a-9ec3-481a-a3c8-1777b5381140/vcredist_x86.exe'\ndefault['ntp']['vs_runtime_productname'] = 'Microsoft Visual C++ 2008 Redistributable - x86 9.0.21022'\nwhen 'freebsd'\ndefault['ntp']['packages'] = %w(ntp)\ndefault['ntp']['varlibdir'] = '/var/db'\ndefault['ntp']['driftfile'] = \"#{node['ntp']['varlibdir']}/ntpd.drift\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-ntp-attributes-default.rb\n# Target line: 62\n\n     57:   default['ntp']['driftfile'] = 'C:\\\\NTP\\\\ntp.drift'\n     58:   default['ntp']['conffile'] = 'C:\\\\NTP\\\\etc\\\\ntp.conf'\n     59:   default['ntp']['conf_owner'] = 'Administrators'\n     60:   default['ntp']['conf_group'] = 'Administrators'\n     61:   default['ntp']['package_url'] = 'http://www.meinbergglobal.com/download/ntp/windows/ntp-4.2.6p5@london-o-lpv-win32-setup.exe'\n>>>  62:   default['ntp']['vs_runtime_url'] = 'http://download.microsoft.com/download/1/1/1/1116b75a-9ec3-481a-a3c8-1777b5381140/vcredist_x86.exe'\n     63:   default['ntp']['vs_runtime_productname'] = 'Microsoft Visual C++ 2008 Redistributable - x86 9.0.21022'\n     64: when 'freebsd'\n     65:   default['ntp']['packages'] = %w(ntp)\n     66:   default['ntp']['varlibdir'] = '/var/db'\n     67:   default['ntp']['driftfile'] = \"#{node['ntp']['varlibdir']}/ntpd.drift\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "thomasmeeus_chef-apache2-recipes-mod_auth_openid.rb", "content": "source   'http://kin.klever.net/dist/libopkele-2.0.4.tar.gz'", "line": 50, "detection_span": [45, 55], "with_context": "\nend\n\ncase node['platform_family']\nwhen 'rhel', 'fedora'\nremote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n50:     source   'http://kin.klever.net/dist/libopkele-2.0.4.tar.gz'\nmode     '0644'\nchecksum '57a5bc753b7e80c5ece1e5968b2051b0ce7ed9ce4329d17122c61575a9ea7648'\nend\n\nbash 'install libopkele' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: thomasmeeus_chef-apache2-recipes-mod_auth_openid.rb\n# Target line: 50\n\n     45: end\n     46: \n     47: case node['platform_family']\n     48: when 'rhel', 'fedora'\n     49:   remote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n>>>  50:     source   'http://kin.klever.net/dist/libopkele-2.0.4.tar.gz'\n     51:     mode     '0644'\n     52:     checksum '57a5bc753b7e80c5ece1e5968b2051b0ce7ed9ce4329d17122c61575a9ea7648'\n     53:   end\n     54: \n     55:   bash 'install libopkele' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_nd-chef-sensu-recipes-rabbitmq.rb", "content": "key \"http://binaries.erlang-solutions.com/debian/erlang_solutions.asc\"", "line": 53, "detection_span": [48, 58], "with_context": "\n\napt_repository \"esl\" do\nuri \"http://binaries.erlang-solutions.com/debian\"\ndistribution node.lsb.codename\ncomponents [\"contrib\"]\n53:     key \"http://binaries.erlang-solutions.com/debian/erlang_solutions.asc\"\naction :add\nend\n\npackage \"esl-erlang\"\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_nd-chef-sensu-recipes-rabbitmq.rb\n# Target line: 53\n\n     48: \n     49:   apt_repository \"esl\" do\n     50:     uri \"http://binaries.erlang-solutions.com/debian\"\n     51:     distribution node.lsb.codename\n     52:     components [\"contrib\"]\n>>>  53:     key \"http://binaries.erlang-solutions.com/debian/erlang_solutions.asc\"\n     54:     action :add\n     55:   end\n     56: \n     57:   package \"esl-erlang\"\n     58: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-basejump-attributes-default.rb", "content": "default[:basejump][:kickstarter][:syslinux_url] = \"http://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-5.01.tar.gz\"", "line": 21, "detection_span": [16, 26], "with_context": "\ndefault['basejump']['packages'] = %w[ python-mysqldb libmysqlclient-dev xinetd tftpd syslinux ]\nwhen \"redhat\",\"centos\",\"scientific\",\"amazon\"\ndefault['basejump']['packages'] = %w[ MySQL-python mysql-devel syslinux ]\nend\n\n21: default[:basejump][:kickstarter][:syslinux_url] = \"http://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-5.01.tar.gz\"\ndefault[:basejump][:kickstarter][:syslinux_links] = ({\n\"ldlinux.c32\" => \"syslinux-5.01/com32/elflink/ldlinux/ldlinux.c32\",\n\"libutil.c32\" => \"syslinux-5.01/com32/libutil/libutil.c32\",\n\"modules/reboot.c32\" => \"syslinux-5.01/com32/modules/reboot.c32\",\n\"libcom32.c32\" => \"syslinux-5.01/com32/lib/libcom32.c32\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-basejump-attributes-default.rb\n# Target line: 21\n\n     16:   default['basejump']['packages'] = %w[ python-mysqldb libmysqlclient-dev xinetd tftpd syslinux ]\n     17: when \"redhat\",\"centos\",\"scientific\",\"amazon\"\n     18:   default['basejump']['packages'] = %w[ MySQL-python mysql-devel syslinux ]\n     19: end\n     20: \n>>>  21: default[:basejump][:kickstarter][:syslinux_url] = \"http://www.kernel.org/pub/linux/utils/boot/syslinux/syslinux-5.01.tar.gz\"\n     22: default[:basejump][:kickstarter][:syslinux_links] = ({\n     23:                                                        \"ldlinux.c32\" => \"syslinux-5.01/com32/elflink/ldlinux/ldlinux.c32\",\n     24:                                                        \"libutil.c32\" => \"syslinux-5.01/com32/libutil/libutil.c32\",\n     25:                                                        \"modules/reboot.c32\" => \"syslinux-5.01/com32/modules/reboot.c32\",\n     26:                                                        \"libcom32.c32\" => \"syslinux-5.01/com32/lib/libcom32.c32\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mackerelio_cookbook-mackerel-agent-recipes-default.rb", "content": "uri 'http://apt.mackerel.io/v2/'", "line": 65, "detection_span": [60, 70], "with_context": "\npackage_options = '--yes -o Dpkg::Options::=\"--force-confdef\" -o Dpkg::Options::=\"--force-confold\"'\ninclude_recipe 'apt'\n\nif supports_v2_repository\napt_repository \"mackerel\" do\n65:       uri 'http://apt.mackerel.io/v2/'\nkey gpgkey_url_v2\ndistribution 'mackerel'\ncomponents ['contrib']\narch 'amd64,arm64'\naction :add", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mackerelio_cookbook-mackerel-agent-recipes-default.rb\n# Target line: 65\n\n     60:   package_options = '--yes -o Dpkg::Options::=\"--force-confdef\" -o Dpkg::Options::=\"--force-confold\"'\n     61:   include_recipe 'apt'\n     62: \n     63:   if supports_v2_repository\n     64:     apt_repository \"mackerel\" do\n>>>  65:       uri 'http://apt.mackerel.io/v2/'\n     66:       key gpgkey_url_v2\n     67:       distribution 'mackerel'\n     68:       components ['contrib']\n     69:       arch 'amd64,arm64'\n     70:       action :add\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "EEDARIT_opsworks-cookbooks-ms_dotnet45-attributes-default.rb", "content": "default['ms_dotnet45']['http_url'] = 'http://download.microsoft.com/download/E/2/1/E21644B5-2DF2-47C2-91BD-63C560427900/NDP452-KB2901907-x86-x64-AllOS-ENU.exe'", "line": 21, "detection_span": [16, 26], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n21: default['ms_dotnet45']['http_url'] = 'http://download.microsoft.com/download/E/2/1/E21644B5-2DF2-47C2-91BD-63C560427900/NDP452-KB2901907-x86-x64-AllOS-ENU.exe'\ndefault['ms_dotnet45']['timeout'] = 600", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: EEDARIT_opsworks-cookbooks-ms_dotnet45-attributes-default.rb\n# Target line: 21\n\n     16: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     17: # See the License for the specific language governing permissions and\n     18: # limitations under the License.\n     19: #\n     20: \n>>>  21: default['ms_dotnet45']['http_url'] = 'http://download.microsoft.com/download/E/2/1/E21644B5-2DF2-47C2-91BD-63C560427900/NDP452-KB2901907-x86-x64-AllOS-ENU.exe'\n     22: default['ms_dotnet45']['timeout'] = 600\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_nd-chef-client-attributes-default.rb", "content": "default[\"chef_client\"][\"winsw_url\"]   = \"http://maven.dyndns.org/2/com/sun/winsw/winsw/1.8/winsw-1.8-bin.exe\"", "line": 62, "detection_span": [57, 67], "with_context": "\ndefault[\"chef_client\"][\"backup_path\"] = \"C:/var/chef/backup\"\ndefault[\"chef_client\"][\"conf_dir\"]    = \"C:/chef\"\ndefault[\"chef_client\"][\"bin\"]         = File.join(Gem.bindir, \"chef-client\")\n#Required for minsw wrapper\ndefault[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n62:   default[\"chef_client\"][\"winsw_url\"]   = \"http://maven.dyndns.org/2/com/sun/winsw/winsw/1.8/winsw-1.8-bin.exe\"\ndefault[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\ndefault[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\nelse\ndefault[\"chef_client\"][\"init_style\"]  = \"none\"\ndefault[\"chef_client\"][\"run_path\"]    = \"/var/run\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_nd-chef-client-attributes-default.rb\n# Target line: 62\n\n     57:   default[\"chef_client\"][\"backup_path\"] = \"C:/var/chef/backup\"\n     58:   default[\"chef_client\"][\"conf_dir\"]    = \"C:/chef\"\n     59:   default[\"chef_client\"][\"bin\"]         = File.join(Gem.bindir, \"chef-client\")\n     60:   #Required for minsw wrapper\n     61:   default[\"chef_client\"][\"ruby_bin\"]    = File.join(RbConfig::CONFIG['bindir'], \"ruby.exe\")\n>>>  62:   default[\"chef_client\"][\"winsw_url\"]   = \"http://maven.dyndns.org/2/com/sun/winsw/winsw/1.8/winsw-1.8-bin.exe\"\n     63:   default[\"chef_client\"][\"winsw_dir\"]   = \"C:/chef/bin\"\n     64:   default[\"chef_client\"][\"winsw_exe\"]   = \"chef-client.exe\"\n     65: else\n     66:   default[\"chef_client\"][\"init_style\"]  = \"none\"\n     67:   default[\"chef_client\"][\"run_path\"]    = \"/var/run\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_hw-nginx-attributes-geoip.rb", "content": "default['nginx']['geoip']['lib_url']              = \"http://geolite.maxmind.com/download/geoip/api/c/GeoIP-#{node['nginx']['geoip']['lib_version']}.tar.gz\"", "line": 29, "detection_span": [24, 34], "with_context": "\ndefault['nginx']['geoip']['country_dat_url']      = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz\"\ndefault['nginx']['geoip']['country_dat_checksum'] = \"bbd5ea2bf1de800237a56ea0600f3d8ede2e2956937a8e632118f397af75adfa\",\ndefault['nginx']['geoip']['city_dat_url']         = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz\"\ndefault['nginx']['geoip']['city_dat_checksum']    = \"097f74d8295f82ca256d522497c3a105aaa6a353260c5d2c084156b29a54d431\"\ndefault['nginx']['geoip']['lib_version']          = \"1.4.8\"\n29: default['nginx']['geoip']['lib_url']              = \"http://geolite.maxmind.com/download/geoip/api/c/GeoIP-#{node['nginx']['geoip']['lib_version']}.tar.gz\"\ndefault['nginx']['geoip']['lib_checksum']         = \"cf0f6b2bac1153e34d6ef55ee3851479b347d2b5c191fda8ff6a51fab5291ff4\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_hw-nginx-attributes-geoip.rb\n# Target line: 29\n\n     24: default['nginx']['geoip']['country_dat_url']      = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz\"\n     25: default['nginx']['geoip']['country_dat_checksum'] = \"bbd5ea2bf1de800237a56ea0600f3d8ede2e2956937a8e632118f397af75adfa\",\n     26: default['nginx']['geoip']['city_dat_url']         = \"http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz\"\n     27: default['nginx']['geoip']['city_dat_checksum']    = \"097f74d8295f82ca256d522497c3a105aaa6a353260c5d2c084156b29a54d431\"\n     28: default['nginx']['geoip']['lib_version']          = \"1.4.8\"\n>>>  29: default['nginx']['geoip']['lib_url']              = \"http://geolite.maxmind.com/download/geoip/api/c/GeoIP-#{node['nginx']['geoip']['lib_version']}.tar.gz\"\n     30: default['nginx']['geoip']['lib_checksum']         = \"cf0f6b2bac1153e34d6ef55ee3851479b347d2b5c191fda8ff6a51fab5291ff4\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-java-attributes-default.rb", "content": "default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-i586.tar.gz'", "line": 76, "detection_span": [71, 81], "with_context": "\n# x86_64\ndefault['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-x64.tar.gz'\ndefault['java']['jdk']['7']['x86_64']['checksum'] = '8611ce31e0b7ecb99d34703ad89b29a545a3fb30356553be3674366cbe722782'\n\n# i586\n76: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-i586.tar.gz'\ndefault['java']['jdk']['7']['i586']['checksum'] = '4046e941e05717538dd4deb1b1f55cb8bb6bd38793c7317034d1f5019086d956'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-java-attributes-default.rb\n# Target line: 76\n\n     71: # x86_64\n     72: default['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-x64.tar.gz'\n     73: default['java']['jdk']['7']['x86_64']['checksum'] = '8611ce31e0b7ecb99d34703ad89b29a545a3fb30356553be3674366cbe722782'\n     74: \n     75: # i586\n>>>  76: default['java']['jdk']['7']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u17-b02/jdk-7u17-linux-i586.tar.gz'\n     77: default['java']['jdk']['7']['i586']['checksum'] = '4046e941e05717538dd4deb1b1f55cb8bb6bd38793c7317034d1f5019086d956'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "AYCHIT_Asf-chef-cookbooks-psf-pypi-recipes-warehouse.rb", "content": "uri \"http://ppa.launchpad.net/pypy/ppa/ubuntu\"", "line": 22, "detection_span": [17, 27], "with_context": "\n\"WAREHOUSE_CONF\" => \"/opt/warehouse/etc/config.yml\",\n\"SENTRY_DSN\" => secrets[\"sentry\"][\"dsn\"],\n}\n\napt_repository \"pypy\" do\n22:     uri \"http://ppa.launchpad.net/pypy/ppa/ubuntu\"\ndistribution node['lsb']['codename']\ncomponents [\"main\"]\nkeyserver \"keyserver.ubuntu.com\"\nkey \"2862D0785AFACD8C65B23DB0251104D968854915\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: AYCHIT_Asf-chef-cookbooks-psf-pypi-recipes-warehouse.rb\n# Target line: 22\n\n     17:   \"WAREHOUSE_CONF\" => \"/opt/warehouse/etc/config.yml\",\n     18:   \"SENTRY_DSN\" => secrets[\"sentry\"][\"dsn\"],\n     19: }\n     20: \n     21: apt_repository \"pypy\" do\n>>>  22:     uri \"http://ppa.launchpad.net/pypy/ppa/ubuntu\"\n     23:     distribution node['lsb']['codename']\n     24:     components [\"main\"]\n     25:     keyserver \"keyserver.ubuntu.com\"\n     26:     key \"2862D0785AFACD8C65B23DB0251104D968854915\"\n     27: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-attributes-default.rb", "content": "default['bcpc']['repos']['ceph'] = \"http://www.ceph.com/debian-dumpling\"", "line": 102, "detection_span": [97, 107], "with_context": "\n###########################################\n#\n#  Repos for things we rely on\n100: #\n101: ###########################################\n102: default['bcpc']['repos']['ceph'] = \"http://www.ceph.com/debian-dumpling\"\n103: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n104: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n105: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n106: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n107: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-attributes-default.rb\n# Target line: 102\n\n     97: ###########################################\n     98: #\n     99: #  Repos for things we rely on\n    100: #\n    101: ###########################################\n>>> 102: default['bcpc']['repos']['ceph'] = \"http://www.ceph.com/debian-dumpling\"\n    103: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n    104: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n    105: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n    106: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n    107: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-hadoop_cluster-cookbooks-jruby-attributes-default.rb", "content": "default[:jruby][:release_url]       = \"http://jruby.org.s3.amazonaws.com/downloads/:version:/jruby-bin-:version:.tar.gz\"", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault[:jruby][:home_dir]          = '/usr/local/share/jruby'\n\ndefault[:jruby][:version]           = \"1.6.7.2\"\n4: default[:jruby][:release_url]       = \"http://jruby.org.s3.amazonaws.com/downloads/:version:/jruby-bin-:version:.tar.gz\"\n\n# what version of ruby to behave like\ndefault[:jruby][:ruby_version]      = \"1.9\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-hadoop_cluster-cookbooks-jruby-attributes-default.rb\n# Target line: 4\n\n      1: default[:jruby][:home_dir]          = '/usr/local/share/jruby'\n      2: \n      3: default[:jruby][:version]           = \"1.6.7.2\"\n>>>   4: default[:jruby][:release_url]       = \"http://jruby.org.s3.amazonaws.com/downloads/:version:/jruby-bin-:version:.tar.gz\"\n      5: \n      6: # what version of ruby to behave like\n      7: default[:jruby][:ruby_version]      = \"1.9\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-mysql-attributes-server_windows.rb", "content": "default['mysql']['windows']['url']                = \"http://dev.mysql.com/get/Downloads/MySQL-5.5/#{node['mysql']['windows']['package_file']}\"", "line": 7, "detection_span": [2, 12], "with_context": "\nwhen 'windows'\ndefault['mysql']['windows']['version']            = '5.5.34'\ndefault['mysql']['windows']['arch']               = node['kernel']['machine'] == 'x86_64' ? 'winx64' : 'win32'\ndefault['mysql']['windows']['package_file']       = \"mysql-#{node['mysql']['windows']['version']}-#{node['mysql']['windows']['arch']}.msi\"\ndefault['mysql']['windows']['packages']           = ['MySQL Server 5.5']\n7:   default['mysql']['windows']['url']                = \"http://dev.mysql.com/get/Downloads/MySQL-5.5/#{node['mysql']['windows']['package_file']}\"\n\ndefault['mysql']['windows']['programdir']         = node['kernel']['machine'] == 'x86_64' ? 'Program Files' : 'Program Files (x86)'\ndefault['mysql']['windows']['basedir']            = \"#{ENV['SYSTEMDRIVE']}\\\\#{node['mysql']['windows']['programdir']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\"\ndefault['mysql']['windows']['data_dir']           = \"#{ENV['ProgramData']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\\\\Data\"\ndefault['mysql']['windows']['bin_dir']            = \"#{node['mysql']['windows']['basedir']}\\\\bin\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-mysql-attributes-server_windows.rb\n# Target line: 7\n\n      2: when 'windows'\n      3:   default['mysql']['windows']['version']            = '5.5.34'\n      4:   default['mysql']['windows']['arch']               = node['kernel']['machine'] == 'x86_64' ? 'winx64' : 'win32'\n      5:   default['mysql']['windows']['package_file']       = \"mysql-#{node['mysql']['windows']['version']}-#{node['mysql']['windows']['arch']}.msi\"\n      6:   default['mysql']['windows']['packages']           = ['MySQL Server 5.5']\n>>>   7:   default['mysql']['windows']['url']                = \"http://dev.mysql.com/get/Downloads/MySQL-5.5/#{node['mysql']['windows']['package_file']}\"\n      8: \n      9:   default['mysql']['windows']['programdir']         = node['kernel']['machine'] == 'x86_64' ? 'Program Files' : 'Program Files (x86)'\n     10:   default['mysql']['windows']['basedir']            = \"#{ENV['SYSTEMDRIVE']}\\\\#{node['mysql']['windows']['programdir']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\"\n     11:   default['mysql']['windows']['data_dir']           = \"#{ENV['ProgramData']}\\\\MySQL\\\\#{node['mysql']['windows']['packages'].first}\\\\Data\"\n     12:   default['mysql']['windows']['bin_dir']            = \"#{node['mysql']['windows']['basedir']}\\\\bin\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-apache2-recipes-mod_auth_openid.rb", "content": "source \"http://kin.klever.net/dist/libopkele-2.0.4.tar.gz\"", "line": 52, "detection_span": [47, 57], "with_context": "\nend\n\ncase node['platform_family']\nwhen \"rhel\", \"fedora\"\nremote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n52:     source \"http://kin.klever.net/dist/libopkele-2.0.4.tar.gz\"\nmode 00644\nend\n\nbash \"install libopkele\" do\ncwd Chef::Config['file_cache_path']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-apache2-recipes-mod_auth_openid.rb\n# Target line: 52\n\n     47: end\n     48: \n     49: case node['platform_family']\n     50: when \"rhel\", \"fedora\"\n     51:   remote_file \"#{Chef::Config['file_cache_path']}/libopkele-2.0.4.tar.gz\" do\n>>>  52:     source \"http://kin.klever.net/dist/libopkele-2.0.4.tar.gz\"\n     53:     mode 00644\n     54:   end\n     55: \n     56:   bash \"install libopkele\" do\n     57:     cwd Chef::Config['file_cache_path']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kitchenware_master-chef-cookbooks-redis-recipes-default.rb", "content": "url \"http://backports.debian.org/debian-backports\"", "line": 13, "detection_span": [8, 18], "with_context": "\nredis_config_file = \"redis.conf.erb\"\n\nif node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"squeeze-backports\" do\n13:     url \"http://backports.debian.org/debian-backports\"\ndistrib \"squeeze-backports\"\nend\n\nnode.set[:redis][:redis_version] = \"2:2.4.15-1~bpo60+2\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-redis-recipes-default.rb\n# Target line: 13\n\n      8: redis_config_file = \"redis.conf.erb\"\n      9: \n     10: if node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo\n     11: \n     12:   add_apt_repository \"squeeze-backports\" do\n>>>  13:     url \"http://backports.debian.org/debian-backports\"\n     14:     distrib \"squeeze-backports\"\n     15:   end\n     16: \n     17:   node.set[:redis][:redis_version] = \"2:2.4.15-1~bpo60+2\"\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-geoip.rb", "content": "default['nginx']['geoip']['country_dat_url']      = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz'", "line": 24, "detection_span": [19, 29], "with_context": "\n# limitations under the License.\n#\n\ndefault['nginx']['geoip']['path']                 = '/srv/geoip'\ndefault['nginx']['geoip']['enable_city']          = true\n24: default['nginx']['geoip']['country_dat_url']      = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz'\ndefault['nginx']['geoip']['country_dat_checksum'] = '79ff1099e96c2dc1c2539c9a18aaa13a9afd085cae477df60d95f1644d42bc07'\ndefault['nginx']['geoip']['city_dat_url']         = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz'\ndefault['nginx']['geoip']['city_dat_checksum']    = '8a6467033a528f68b1a97de24d9d0ce86c8e8e83683820e16e433ddbd3f712f7'\ndefault['nginx']['geoip']['lib_version']          = '1.6.3'\nlib_version = node['nginx']['geoip']['lib_version'] # convenience variable for line length", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-attributes-geoip.rb\n# Target line: 24\n\n     19: # limitations under the License.\n     20: #\n     21: \n     22: default['nginx']['geoip']['path']                 = '/srv/geoip'\n     23: default['nginx']['geoip']['enable_city']          = true\n>>>  24: default['nginx']['geoip']['country_dat_url']      = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz'\n     25: default['nginx']['geoip']['country_dat_checksum'] = '79ff1099e96c2dc1c2539c9a18aaa13a9afd085cae477df60d95f1644d42bc07'\n     26: default['nginx']['geoip']['city_dat_url']         = 'http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz'\n     27: default['nginx']['geoip']['city_dat_checksum']    = '8a6467033a528f68b1a97de24d9d0ce86c8e8e83683820e16e433ddbd3f712f7'\n     28: default['nginx']['geoip']['lib_version']          = '1.6.3'\n     29: lib_version = node['nginx']['geoip']['lib_version'] # convenience variable for line length\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "caiush_bos-cookbooks-bcpc-attributes-default.rb", "content": "default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"", "line": 134, "detection_span": [129, 139], "with_context": "\n129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"\n135: default['bcpc']['repos']['gridcentric'] = \"http://downloads.gridcentric.com/packages/%s/%s/ubuntu\"\n136:\n137: ###########################################\n138: #\n139: # [Optional] If using apt-mirror to pull down repos, we use these settings.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: caiush_bos-cookbooks-bcpc-attributes-default.rb\n# Target line: 134\n\n    129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n    130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n    131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n    132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n    133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n>>> 134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"\n    135: default['bcpc']['repos']['gridcentric'] = \"http://downloads.gridcentric.com/packages/%s/%s/ubuntu\"\n    136: \n    137: ###########################################\n    138: #\n    139: # [Optional] If using apt-mirror to pull down repos, we use these settings.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql55-community.rb", "content": "default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/$releasever/$basearch/'", "line": 33, "detection_span": [28, 38], "with_context": "\ndefault['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/6/$basearch/'\nwhen 7\ndefault['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/7/$basearch/'\nend\nelse # other rhel. only 6 and 7 for now\n33:     default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/$releasever/$basearch/'\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql55-community.rb\n# Target line: 33\n\n     28:       default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/6/$basearch/'\n     29:     when 7\n     30:       default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/7/$basearch/'\n     31:     end\n     32:   else # other rhel. only 6 and 7 for now\n>>>  33:     default['yum']['mysql55-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.5-community/el/$releasever/$basearch/'\n     34:   end\n     35: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "rackspace-cookbooks_nodestack-recipes-mysql_holland.rb", "content": "gpgkey 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/repodata/repomd.xml.key'", "line": 36, "detection_span": [31, 41], "with_context": "\nwhen 'centos'\ninclude_recipe 'yum'\nyum_repository 'Holland' do\ndescription 'Holland backup repo'\nbaseurl 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/'\n36:     gpgkey 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/repodata/repomd.xml.key'\naction :create\nend\nend\n\n# install needed packages", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-recipes-mysql_holland.rb\n# Target line: 36\n\n     31: when 'centos'\n     32:   include_recipe 'yum'\n     33:   yum_repository 'Holland' do\n     34:     description 'Holland backup repo'\n     35:     baseurl 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/'\n>>>  36:     gpgkey 'http://download.opensuse.org/repositories/home:/holland-backup/CentOS_CentOS-6/repodata/repomd.xml.key'\n     37:     action :create\n     38:   end\n     39: end\n     40: \n     41: # install needed packages\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb", "content": "default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-i586.bin'", "line": 106, "detection_span": [101, 111], "with_context": "\n101: # x86_64\n102: default['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-x64.bin'\n103: default['java']['jdk']['6']['x86_64']['checksum'] = '6b493aeab16c940cae9e3d07ad2a5c5684fb49cf06c5d44c400c7993db0d12e8'\n104:\n105: # i586\n106: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-i586.bin'\n107: default['java']['jdk']['6']['i586']['checksum'] = 'd53b5a2518d80e1d95565f0adda54eee229dc5f4a1d1a3c2f7bf5045b168a357'\n108:\n109: # jdk7 attributes\n110:\n111: default['java']['jdk']['7']['bin_cmds'] = %w(appletviewer apt ControlPanel extcheck idlj jar jarsigner java javac", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb\n# Target line: 106\n\n    101: # x86_64\n    102: default['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-x64.bin'\n    103: default['java']['jdk']['6']['x86_64']['checksum'] = '6b493aeab16c940cae9e3d07ad2a5c5684fb49cf06c5d44c400c7993db0d12e8'\n    104: \n    105: # i586\n>>> 106: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u45-b06/jdk-6u45-linux-i586.bin'\n    107: default['java']['jdk']['6']['i586']['checksum'] = 'd53b5a2518d80e1d95565f0adda54eee229dc5f4a1d1a3c2f7bf5045b168a357'\n    108: \n    109: # jdk7 attributes\n    110: \n    111: default['java']['jdk']['7']['bin_cmds'] = %w(appletviewer apt ControlPanel extcheck idlj jar jarsigner java javac\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "TaxiOS_zabbix-recipes-agent_registration.rb", "content": ":url => \"http://#{zabbix_server['zabbix']['web']['fqdn']}/api_jsonrpc.php\",", "line": 21, "detection_span": [16, 26], "with_context": "\nreturn\nend\nend\n\nconnection_info = {\n21:   :url => \"http://#{zabbix_server['zabbix']['web']['fqdn']}/api_jsonrpc.php\",\n:user => zabbix_server['zabbix']['web']['login'],\n:password => zabbix_server['zabbix']['web']['password']\n}\n\ninterface_definitions = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: TaxiOS_zabbix-recipes-agent_registration.rb\n# Target line: 21\n\n     16:     return\n     17:   end\n     18: end\n     19: \n     20: connection_info = {\n>>>  21:   :url => \"http://#{zabbix_server['zabbix']['web']['fqdn']}/api_jsonrpc.php\",\n     22:   :user => zabbix_server['zabbix']['web']['login'],\n     23:   :password => zabbix_server['zabbix']['web']['password']\n     24: }\n     25: \n     26: interface_definitions = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mackerelio_cookbook-mackerel-agent-recipes-default.rb", "content": "repo_url = \"http://yum.mackerel.io/v2/$basearch\"", "line": 46, "detection_span": [41, 51], "with_context": "\n\nif supports_v2_repository\nif platform?('amazon')\nrepo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\nelse\n46:       repo_url = \"http://yum.mackerel.io/v2/$basearch\"\nend\ngpgkey_url = gpgkey_url_v2\nyum_key_name = 'RPM-GPG-KEY-mackerel-v2'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mackerelio_cookbook-mackerel-agent-recipes-default.rb\n# Target line: 46\n\n     41: \n     42:   if supports_v2_repository\n     43:     if platform?('amazon')\n     44:       repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\n     45:     else\n>>>  46:       repo_url = \"http://yum.mackerel.io/v2/$basearch\"\n     47:     end\n     48:     gpgkey_url = gpgkey_url_v2\n     49:     yum_key_name = 'RPM-GPG-KEY-mackerel-v2'\n     50:   end\n     51: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-yum-attributes-elrepo.rb", "content": "default['yum']['elrepo']['key_url'] = \"http://elrepo.org/#{node['yum']['elrepo']['key']}\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n#\n\ndefault['yum']['elrepo']['url'] = \"http://elrepo.org/mirrors-elrepo.el#{node['platform_version'].to_i}\"\ndefault['yum']['elrepo']['key'] = \"RPM-GPG-KEY-elrepo.org\"\n22: default['yum']['elrepo']['key_url'] = \"http://elrepo.org/#{node['yum']['elrepo']['key']}\"\ndefault['yum']['elrepo']['includepkgs'] = nil\ndefault['yum']['elrepo']['exclude'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-yum-attributes-elrepo.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: #\n     19: \n     20: default['yum']['elrepo']['url'] = \"http://elrepo.org/mirrors-elrepo.el#{node['platform_version'].to_i}\"\n     21: default['yum']['elrepo']['key'] = \"RPM-GPG-KEY-elrepo.org\"\n>>>  22: default['yum']['elrepo']['key_url'] = \"http://elrepo.org/#{node['yum']['elrepo']['key']}\"\n     23: default['yum']['elrepo']['includepkgs'] = nil\n     24: default['yum']['elrepo']['exclude'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-memcached-recipes-src-memcached-install.rb", "content": "source \"http://yum.ihr/files/libmemcached-0.51.tar.gz\"", "line": 11, "detection_span": [6, 16], "with_context": "\ngroup \"root\"\naction :create\nend\n\nremote_file \"/root/build/libmemcached-0.51.tar.gz\" do\n11:   source \"http://yum.ihr/files/libmemcached-0.51.tar.gz\"\nnotifies :run, \"bash[install_libmemcached]\", :immediately\nend\n\nbash \"install_libmemcached\" do\nuser \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-memcached-recipes-src-memcached-install.rb\n# Target line: 11\n\n      6:   group \"root\"\n      7:   action :create\n      8: end\n      9: \n     10: remote_file \"/root/build/libmemcached-0.51.tar.gz\" do\n>>>  11:   source \"http://yum.ihr/files/libmemcached-0.51.tar.gz\"\n     12:   notifies :run, \"bash[install_libmemcached]\", :immediately\n     13: end\n     14: \n     15: bash \"install_libmemcached\" do\n     16:   user \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql56-community.rb", "content": "default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'", "line": 18, "detection_span": [13, 23], "with_context": "\nwhen 2013\ndefault['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nwhen 2014\ndefault['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nwhen 2015\n18:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nwhen 2016\ndefault['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\nend\nwhen 'redhat', 'oracle' # ~FC024\ncase node['platform_version'].to_i", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-yum-mysql-community-attributes-mysql56-community.rb\n# Target line: 18\n\n     13:     when 2013\n     14:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     15:     when 2014\n     16:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     17:     when 2015\n>>>  18:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     19:     when 2016\n     20:       default['yum']['mysql56-community']['baseurl'] = 'http://repo.mysql.com/yum/mysql-5.6-community/el/6/$basearch/'\n     21:     end\n     22:   when 'redhat', 'oracle' # ~FC024\n     23:     case node['platform_version'].to_i\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb", "content": "default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'", "line": 17, "detection_span": [12, 22], "with_context": "\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\nwhen 6\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb\n# Target line: 17\n\n     12:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\n     13:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\n     14:   when 6\n     15:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n     16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n>>>  17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n     20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\n     21:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     22:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb", "content": "default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'", "line": 16, "detection_span": [11, 21], "with_context": "\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 5 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\nwhen 6\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\ndefault['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\ndefault['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel.rb\n# Target line: 16\n\n     11:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 5 - $basearch'\n     12:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-5&arch=$basearch'\n     13:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL'\n     14:   when 6\n     15:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 6 - $basearch'\n>>>  16:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-6&arch=$basearch'\n     17:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch'\n     20:     default['yum']['epel']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-7&arch=$basearch'\n     21:     default['yum']['epel']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb", "content": "gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"", "line": 33, "detection_span": [28, 38], "with_context": "\n# Configure the Nexcess yum repo so we can match their php versions\nyum_repository \"iworx\" do\ndescription \"Interworx Repo\"\nbaseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\ngpgcheck true\n33:     gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\nenabled true\nincludepkgs \"mod_fastcgi*\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aligent_chef-aligent-magento-dev-recipes-yum-iworx.rb\n# Target line: 33\n\n     28: # Configure the Nexcess yum repo so we can match their php versions\n     29: yum_repository \"iworx\" do\n     30:     description \"Interworx Repo\"\n     31:     baseurl \"http://updates.interworx.com/iworx-release/RPMS/latest/$basearch/\"\n     32:     gpgcheck true\n>>>  33:     gpgkey \"http://updates.interworx.com/iworx-release/RPM-GPG-KEY-INTERWORX\"\n     34:     enabled true\n     35:     includepkgs \"mod_fastcgi*\"\n     36: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-zabbix-cookbooks-hadoop_cluster-recipes-add_cloudera_repo.rb", "content": "source \"http://archive.cloudera.com/redhat/6/x86_64/cdh/cloudera-cdh3.repo\"", "line": 29, "detection_span": [24, 34], "with_context": "\nexecute \"yum clean all\" do\naction :nothing\nend\n\nremote_file \"/etc/yum.repos.d/cloudera-cdh3.repo\" do\n29:     source \"http://archive.cloudera.com/redhat/6/x86_64/cdh/cloudera-cdh3.repo\"\nmode \"0644\"\nnotifies :run, resources(:execute => \"yum clean all\"), :immediately\nend\n\nwhen 'ubuntu'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-zabbix-cookbooks-hadoop_cluster-recipes-add_cloudera_repo.rb\n# Target line: 29\n\n     24:   execute \"yum clean all\" do\n     25:     action :nothing\n     26:   end\n     27: \n     28:   remote_file \"/etc/yum.repos.d/cloudera-cdh3.repo\" do\n>>>  29:     source \"http://archive.cloudera.com/redhat/6/x86_64/cdh/cloudera-cdh3.repo\"\n     30:     mode \"0644\"\n     31:     notifies :run, resources(:execute => \"yum clean all\"), :immediately\n     32:   end\n     33: \n     34: when 'ubuntu'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_oc-java-attributes-default.rb", "content": "default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin'", "line": 50, "detection_span": [45, 55], "with_context": "\n# x86_64\ndefault['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-x64.bin'\ndefault['java']['jdk']['6']['x86_64']['checksum'] = '51d594cec29948bdf58918ba802a872826bc7caae3f0aada42b65eacdc14a7f4'\n\n# i586\n50: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin'\ndefault['java']['jdk']['6']['i586']['checksum'] = '44cc51ed452a08a3e0b4e397922832607161642e5a6e206f256af86f8fbaae90'\n\n# jdk7 attributes\n# x86_64\ndefault['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u9-b05/jdk-7u9-linux-x64.tar.gz'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_oc-java-attributes-default.rb\n# Target line: 50\n\n     45: # x86_64\n     46: default['java']['jdk']['6']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-x64.bin'\n     47: default['java']['jdk']['6']['x86_64']['checksum'] = '51d594cec29948bdf58918ba802a872826bc7caae3f0aada42b65eacdc14a7f4'\n     48: \n     49: # i586\n>>>  50: default['java']['jdk']['6']['i586']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/6u37-b06/jdk-6u37-linux-i586.bin'\n     51: default['java']['jdk']['6']['i586']['checksum'] = '44cc51ed452a08a3e0b4e397922832607161642e5a6e206f256af86f8fbaae90'\n     52: \n     53: # jdk7 attributes\n     54: # x86_64\n     55: default['java']['jdk']['7']['x86_64']['url'] = 'http://download.oracle.com/otn-pub/java/jdk/7u9-b05/jdk-7u9-linux-x64.tar.gz'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-couchbase-attributes-moxi.rb", "content": "default['couchbase']['moxi']['package_base_url'] = \"http://packages.couchbase.com/releases/#{node['couchbase']['moxi']['version']}\"", "line": 35, "detection_span": [30, 40], "with_context": "\ndefault['couchbase']['moxi']['package_file'] = \"moxi-server_#{package_machine}_#{node['couchbase']['moxi']['version']}.rpm\"\nelse\nChef::Log.error(\"Moxi Server is not supported on #{platform}\")\nend\n\n35: default['couchbase']['moxi']['package_base_url'] = \"http://packages.couchbase.com/releases/#{node['couchbase']['moxi']['version']}\"\ndefault['couchbase']['moxi']['package_full_url'] = \"#{node['couchbase']['moxi']['package_base_url']}/#{node['couchbase']['moxi']['package_file']}\"\n\ndefault['couchbase']['moxi']['cluster_server'] = 'couchbase01'\ndefault['couchbase']['moxi']['cluster_rest_url'] = \"http://#{node['couchbase']['moxi']['cluster_server']}:8091/pools/default/bucketsStreaming/default\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-couchbase-attributes-moxi.rb\n# Target line: 35\n\n     30:   default['couchbase']['moxi']['package_file'] = \"moxi-server_#{package_machine}_#{node['couchbase']['moxi']['version']}.rpm\"\n     31: else\n     32:   Chef::Log.error(\"Moxi Server is not supported on #{platform}\")\n     33: end\n     34: \n>>>  35: default['couchbase']['moxi']['package_base_url'] = \"http://packages.couchbase.com/releases/#{node['couchbase']['moxi']['version']}\"\n     36: default['couchbase']['moxi']['package_full_url'] = \"#{node['couchbase']['moxi']['package_base_url']}/#{node['couchbase']['moxi']['package_file']}\"\n     37: \n     38: default['couchbase']['moxi']['cluster_server'] = 'couchbase01'\n     39: default['couchbase']['moxi']['cluster_rest_url'] = \"http://#{node['couchbase']['moxi']['cluster_server']}:8091/pools/default/bucketsStreaming/default\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "mackerelio_cookbook-mackerel-agent-recipes-default.rb", "content": "repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"", "line": 44, "detection_span": [39, 49], "with_context": "\nrepo_url = \"http://yum.mackerel.io/amznlinux/$releasever/$basearch\"\nend\n\nif supports_v2_repository\nif platform?('amazon')\n44:       repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\nelse\nrepo_url = \"http://yum.mackerel.io/v2/$basearch\"\nend\ngpgkey_url = gpgkey_url_v2\nyum_key_name = 'RPM-GPG-KEY-mackerel-v2'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mackerelio_cookbook-mackerel-agent-recipes-default.rb\n# Target line: 44\n\n     39:     repo_url = \"http://yum.mackerel.io/amznlinux/$releasever/$basearch\"\n     40:   end\n     41: \n     42:   if supports_v2_repository\n     43:     if platform?('amazon')\n>>>  44:       repo_url = \"http://yum.mackerel.io/amznlinux/v2/$releasever/$basearch\"\n     45:     else\n     46:       repo_url = \"http://yum.mackerel.io/v2/$basearch\"\n     47:     end\n     48:     gpgkey_url = gpgkey_url_v2\n     49:     yum_key_name = 'RPM-GPG-KEY-mackerel-v2'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb", "content": "default['java']['oracle']['jce']['7']['url'] = 'http://download.oracle.com/otn-pub/java/jce/7/UnlimitedJCEPolicyJDK7.zip'", "line": 151, "detection_span": [146, 156], "with_context": "\n146: default['java']['jdk']['8']['i586']['checksum'] = '2012d1c82f74bf830a80dfb5462f555b22271f74e4fc4a5779c7f459dcd0cabf'\n147:\n148: default['java']['oracle']['jce']['enabled'] = false\n149: default['java']['oracle']['jce']['8']['url'] = 'http://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip'\n150: default['java']['oracle']['jce']['8']['checksum'] = 'f3020a3922efd6626c2fff45695d527f34a8020e938a49292561f18ad1320b59'\n151: default['java']['oracle']['jce']['7']['url'] = 'http://download.oracle.com/otn-pub/java/jce/7/UnlimitedJCEPolicyJDK7.zip'\n152: default['java']['oracle']['jce']['7']['checksum'] = '7a8d790e7bd9c2f82a83baddfae765797a4a56ea603c9150c87b7cdb7800194d'\n153: default['java']['oracle']['jce']['6']['url'] = 'http://download.oracle.com/otn-pub/java/jce_policy/6/jce_policy-6.zip'\n154: default['java']['oracle']['jce']['6']['checksum'] = 'd0c2258c3364120b4dbf7dd1655c967eee7057ac6ae6334b5ea8ceb8bafb9262'\n155: default['java']['oracle']['jce']['home'] = '/opt/java_jce'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-java-attributes-default.rb\n# Target line: 151\n\n    146: default['java']['jdk']['8']['i586']['checksum'] = '2012d1c82f74bf830a80dfb5462f555b22271f74e4fc4a5779c7f459dcd0cabf'\n    147: \n    148: default['java']['oracle']['jce']['enabled'] = false\n    149: default['java']['oracle']['jce']['8']['url'] = 'http://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip'\n    150: default['java']['oracle']['jce']['8']['checksum'] = 'f3020a3922efd6626c2fff45695d527f34a8020e938a49292561f18ad1320b59'\n>>> 151: default['java']['oracle']['jce']['7']['url'] = 'http://download.oracle.com/otn-pub/java/jce/7/UnlimitedJCEPolicyJDK7.zip'\n    152: default['java']['oracle']['jce']['7']['checksum'] = '7a8d790e7bd9c2f82a83baddfae765797a4a56ea603c9150c87b7cdb7800194d'\n    153: default['java']['oracle']['jce']['6']['url'] = 'http://download.oracle.com/otn-pub/java/jce_policy/6/jce_policy-6.zip'\n    154: default['java']['oracle']['jce']['6']['checksum'] = 'd0c2258c3364120b4dbf7dd1655c967eee7057ac6ae6334b5ea8ceb8bafb9262'\n    155: default['java']['oracle']['jce']['home'] = '/opt/java_jce'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kitchenplan_chef-applications-recipes-hhvm.rb", "content": "uri          'http://dl.hhvm.com/ubuntu'", "line": 9, "detection_span": [4, 14], "with_context": "\nhomebrew_tap \"homebrew/dupes\"\nhomebrew_tap \"homebrew/versions\"\nhomebrew_tap \"mcuadros/homebrew-hhvm\"\nwhen 'debian'\napt_repository 'hhvm' do\n9:           uri          'http://dl.hhvm.com/ubuntu'\ndistribution node['lsb']['codename']\ncomponents   ['main']\nkey          'http://dl.hhvm.com/conf/hhvm.gpg.key'\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-applications-recipes-hhvm.rb\n# Target line: 9\n\n      4:         homebrew_tap \"homebrew/dupes\"\n      5:         homebrew_tap \"homebrew/versions\"\n      6:         homebrew_tap \"mcuadros/homebrew-hhvm\"\n      7:     when 'debian'\n      8:         apt_repository 'hhvm' do\n>>>   9:           uri          'http://dl.hhvm.com/ubuntu'\n     10:           distribution node['lsb']['codename']\n     11:           components   ['main']\n     12:           key          'http://dl.hhvm.com/conf/hhvm.gpg.key'\n     13:         end\n     14: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-nagios-attributes-client.rb", "content": "default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'", "line": 68, "detection_span": [63, 73], "with_context": "\n]\n\n# for nsca from source installation\ncase chef_environment\nwhen /^hls/\n68:   default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\ndefault['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\ndefault['nagios']['plugins']['url'] = 'https://www.nagios-plugins.org/download'\nwhen /^staging-hls/\ndefault['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\ndefault['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nagios-attributes-client.rb\n# Target line: 68\n\n     63:                                             ]\n     64: \n     65: # for nsca from source installation\n     66: case chef_environment\n     67: when /^hls/\n>>>  68:   default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios' \n     69:   default['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n     70:   default['nagios']['plugins']['url'] = 'https://www.nagios-plugins.org/download'\n     71: when /^staging-hls/\n     72:   default['nagios']['nsca']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios' \n     73:   default['nagios']['nrpe']['url']    = 'http://prdownloads.sourceforge.net/sourceforge/nagios'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "SpanningCloudApps_cassandra-chef-cookbook-recipes-tarball.rb", "content": "node.default['cassandra']['tarball']['url'] = \"http://archive.apache.org/dist/cassandra/#{node['cassandra']['version']}/apache-cassandra-#{node['cassandra']['version']}-bin.tar.gz\"", "line": 51, "detection_span": [46, 56], "with_context": "\ntarball_dir = ::File.join(td, \"apache-cassandra-#{node['cassandra']['version']}\")\n\n# if tarball url set to 'auto' use default url\n# according to node cassandra version\nif node['cassandra']['tarball']['url'] == 'auto'\n51:   node.default['cassandra']['tarball']['url'] = \"http://archive.apache.org/dist/cassandra/#{node['cassandra']['version']}/apache-cassandra-#{node['cassandra']['version']}-bin.tar.gz\"\nend\n\n# stop C* service during upgrades\nservice 'cassandra' do\nservice_name node['cassandra']['service_name']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: SpanningCloudApps_cassandra-chef-cookbook-recipes-tarball.rb\n# Target line: 51\n\n     46: tarball_dir = ::File.join(td, \"apache-cassandra-#{node['cassandra']['version']}\")\n     47: \n     48: # if tarball url set to 'auto' use default url\n     49: # according to node cassandra version\n     50: if node['cassandra']['tarball']['url'] == 'auto'\n>>>  51:   node.default['cassandra']['tarball']['url'] = \"http://archive.apache.org/dist/cassandra/#{node['cassandra']['version']}/apache-cassandra-#{node['cassandra']['version']}-bin.tar.gz\"\n     52: end\n     53: \n     54: # stop C* service during upgrades\n     55: service 'cassandra' do\n     56:   service_name node['cassandra']['service_name']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "rcbops-cookbooks_swift-recipes-management-server.rb", "content": "keystone_auth_url = \"http://#{ks_admin_endpoint[\"host\"]}:#{ks_service_endpoint[\"port\"]}/v2.0/\"", "line": 42, "detection_span": [37, 47], "with_context": "\nend\n\nks_admin_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\", \"admin-api\")\nks_service_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\",\"service-api\")\nkeystone = get_settings_by_role(\"keystone-setup\", \"keystone\")\n42: keystone_auth_url = \"http://#{ks_admin_endpoint[\"host\"]}:#{ks_service_endpoint[\"port\"]}/v2.0/\"\n\n# Register Service Tenant\nkeystone_tenant \"Create Service Tenant\" do\nauth_host ks_admin_endpoint[\"host\"]\nauth_port ks_admin_endpoint[\"port\"]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-recipes-management-server.rb\n# Target line: 42\n\n     37: end\n     38: \n     39: ks_admin_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\", \"admin-api\")\n     40: ks_service_endpoint = get_access_endpoint(\"keystone-api\", \"keystone\",\"service-api\")\n     41: keystone = get_settings_by_role(\"keystone-setup\", \"keystone\")\n>>>  42: keystone_auth_url = \"http://#{ks_admin_endpoint[\"host\"]}:#{ks_service_endpoint[\"port\"]}/v2.0/\"\n     43: \n     44: # Register Service Tenant\n     45: keystone_tenant \"Create Service Tenant\" do\n     46:   auth_host ks_admin_endpoint[\"host\"]\n     47:   auth_port ks_admin_endpoint[\"port\"]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel-source.rb", "content": "default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'", "line": 21, "detection_span": [16, 26], "with_context": "\ndefault['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\ndefault['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nwhen 7\ndefault['yum']['epel-source']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch - Source'\ndefault['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\n21:     default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nend\n\ndefault['yum']['epel-source']['failovermethod'] = 'priority'\ndefault['yum']['epel-source']['gpgcheck'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-yum-epel-attributes-epel-source.rb\n# Target line: 21\n\n     16:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-6&arch=$basearch'\n     17:     default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n     18:   when 7\n     19:     default['yum']['epel-source']['description'] = 'Extra Packages for Enterprise Linux 7 - $basearch - Source'\n     20:     default['yum']['epel-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=epel-source-7&arch=$basearch'\n>>>  21:     default['yum']['epel-source']['gpgkey'] = 'http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     22:   end\n     23: end\n     24: \n     25: default['yum']['epel-source']['failovermethod'] = 'priority'\n     26: default['yum']['epel-source']['gpgcheck'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "caiush_bos-cookbooks-bcpc-attributes-default.rb", "content": "default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"", "line": 129, "detection_span": [124, 134], "with_context": "\n124: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n125: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n126: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n127: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n128: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"\n129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: caiush_bos-cookbooks-bcpc-attributes-default.rb\n# Target line: 129\n\n    124: default['bcpc']['repos']['ceph-extras'] = \"http://www.ceph.com/packages/ceph-extras/debian\"\n    125: default['bcpc']['repos']['ceph-el6-x86_64'] = \"http://ceph.com/rpm-dumpling/el6/x86_64\"\n    126: default['bcpc']['repos']['ceph-el6-noarch'] = \"http://ceph.com/rpm-dumpling/el6/noarch\"\n    127: default['bcpc']['repos']['rabbitmq'] = \"http://www.rabbitmq.com/debian\"\n    128: default['bcpc']['repos']['mysql'] = \"http://repo.percona.com/apt\"\n>>> 129: default['bcpc']['repos']['haproxy'] = \"http://ppa.launchpad.net/vbernat/haproxy-1.5/ubuntu\"\n    130: default['bcpc']['repos']['openstack'] = \"http://ubuntu-cloud.archive.canonical.com/ubuntu\"\n    131: default['bcpc']['repos']['hwraid'] = \"http://hwraid.le-vert.net/ubuntu\"\n    132: default['bcpc']['repos']['fluentd'] = \"http://packages.treasure-data.com/precise\"\n    133: default['bcpc']['repos']['ceph-apache'] = \"http://gitbuilder.ceph.com/apache2-deb-precise-x86_64-basic/ref/master\"\n    134: default['bcpc']['repos']['ceph-fcgi'] = \"http://gitbuilder.ceph.com/libapache-mod-fastcgi-deb-precise-x86_64-basic/ref/master\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-yum-attributes-remi.rb", "content": "default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n#\n\ncase node['platform']\nwhen \"fedora\"\n22:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\nelse\ndefault['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\nend\n\ndefault['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-yum-attributes-remi.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: #\n     19: \n     20: case node['platform']\n     21: when \"fedora\"\n>>>  22:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/fedora/#{node['platform_version'].to_i}/remi/mirror\"\n     23: else\n     24:   default['yum']['remi']['url'] = \"http://rpms.famillecollet.com/enterprise/#{node['platform_version'].to_i}/remi/mirror\"\n     25: end\n     26: \n     27: default['yum']['remi']['key'] = \"RPM-GPG-KEY-remi\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-bind-chroot-recipes-zones-openldap.rb", "content": "source \"http://bind9-ldap.bayour.com/zone2ldif.pl\"", "line": 42, "detection_span": [37, 47], "with_context": "\nend\nend\n\n# Download zone2ldif.pl to /usr/local/bin\nremote_file \"/usr/local/bin/zone2ldif.pl\" do\n42:   source \"http://bind9-ldap.bayour.com/zone2ldif.pl\"\nmode \"0744\"\nowner \"root\"\ngroup \"root\"\nchecksum \"b1f6fed631ba22ebeef390a691cbaf3d\"\nnot_if \"test -f /usr/local/bin/zone2ldif.pl\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-bind-chroot-recipes-zones-openldap.rb\n# Target line: 42\n\n     37:   end\n     38: end\n     39: \n     40: # Download zone2ldif.pl to /usr/local/bin\n     41: remote_file \"/usr/local/bin/zone2ldif.pl\" do\n>>>  42:   source \"http://bind9-ldap.bayour.com/zone2ldif.pl\"\n     43:   mode \"0744\"\n     44:   owner \"root\"\n     45:   group \"root\"\n     46:   checksum \"b1f6fed631ba22ebeef390a691cbaf3d\"\n     47:   not_if \"test -f /usr/local/bin/zone2ldif.pl\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-resources-release.rb", "content": "# Prefix directory -- other _dir attributes hang off this by default", "line": 47, "detection_span": [42, 52], "with_context": "\n#   :version:       -- value of resource's version\n#   :apache_mirror: -- node[:install_from][:apache_mirror]\n#\nattribute :release_url,   :kind_of => String, :required => true\n\n47: # Prefix directory -- other _dir attributes hang off this by default\nattribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n\n# version slug, appended to the name to get the install_dir\nattribute :version,       :kind_of => String, :required => true\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-resources-release.rb\n# Target line: 47\n\n     42: #   :version:       -- value of resource's version\n     43: #   :apache_mirror: -- node[:install_from][:apache_mirror]\n     44: #\n     45: attribute :release_url,   :kind_of => String, :required => true\n     46: \n>>>  47: # Prefix directory -- other _dir attributes hang off this by default\n     48: attribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n     49: \n     50: # version slug, appended to the name to get the install_dir\n     51: attribute :version,       :kind_of => String, :required => true\n     52: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Soluciones_ey-cloud-recipes-cookbooks-php55-recipes-install.rb", "content": "# Fix for Archive_Tar bug in PHP 5.5.8", "line": 99, "detection_span": [94, 104], "with_context": "\nexecute \"install-php55\" do\ncwd \"/root\"\ncommand \"emerge -g -n --color n --nospinner =dev-lang/php-#{node[:php][:version]}\"\nend\n\n99: # Fix for Archive_Tar bug in PHP 5.5.8\n100: remote_file '/usr/share/php/Archive/Tar.php' do\n101:   source \"Archive_Tar.php\"\n102:   backup 0\n103:   owner \"root\"\n104:   group \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-php55-recipes-install.rb\n# Target line: 99\n\n     94: execute \"install-php55\" do\n     95:   cwd \"/root\"\n     96:   command \"emerge -g -n --color n --nospinner =dev-lang/php-#{node[:php][:version]}\"\n     97: end\n     98: \n>>>  99: # Fix for Archive_Tar bug in PHP 5.5.8\n    100: remote_file '/usr/share/php/Archive/Tar.php' do\n    101:   source \"Archive_Tar.php\"\n    102:   backup 0\n    103:   owner \"root\"\n    104:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb", "content": "# Determines if a tag matches a given wildcard expression or prefix.", "line": 14, "detection_span": [9, 19], "with_context": "\nmodule Utils\nmodule Helper\nNAMESPACE_REGEX = '[a-z](?:[a-z0-9_]*)'\nPREDICATE_REGEX = '[a-zA-Z0-9%_\\+\\.-](?:[a-zA-Z0-9%_\\+\\.-]*)'\n\n14:       # Determines if a tag matches a given wildcard expression or prefix.\n#\n# @param [String] wildcard expression or prefix\n# @param [String] tag\n#\n# @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb\n# Target line: 14\n\n      9:   module Utils\n     10:     module Helper\n     11:       NAMESPACE_REGEX = '[a-z](?:[a-z0-9_]*)'\n     12:       PREDICATE_REGEX = '[a-zA-Z0-9%_\\+\\.-](?:[a-zA-Z0-9%_\\+\\.-]*)'\n     13: \n>>>  14:       # Determines if a tag matches a given wildcard expression or prefix.\n     15:       #\n     16:       # @param [String] wildcard expression or prefix\n     17:       # @param [String] tag\n     18:       #\n     19:       # @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_qa-chef-server-cluster-recipes-frontend.rb", "content": "# ruby_block 'ensure node can resolve API FQDN' do", "line": 45, "detection_span": [40, 50], "with_context": "\nexecute 'add hosts entry' do\ncommand \"echo '#{node['ipaddress']} #{node['fqdn']} #{node['qa-chef-server-cluster']['chef-server']['api_fqdn']}' >> /etc/hosts\"\nend\n\n# TODO: check this out from chef-server cookbook\n45: # ruby_block 'ensure node can resolve API FQDN' do\n#   extend ChefServerCoobook::Helpers\n#   block { repair_api_fqdn }\n#   only_if { api_fqdn_node_attr }\n#   not_if { api_fqdn_resolves }\n# end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_qa-chef-server-cluster-recipes-frontend.rb\n# Target line: 45\n\n     40: execute 'add hosts entry' do\n     41:   command \"echo '#{node['ipaddress']} #{node['fqdn']} #{node['qa-chef-server-cluster']['chef-server']['api_fqdn']}' >> /etc/hosts\"\n     42: end\n     43: \n     44: # TODO: check this out from chef-server cookbook\n>>>  45: # ruby_block 'ensure node can resolve API FQDN' do\n     46: #   extend ChefServerCoobook::Helpers\n     47: #   block { repair_api_fqdn }\n     48: #   only_if { api_fqdn_node_attr }\n     49: #   not_if { api_fqdn_resolves }\n     50: # end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-nodejs-recipes-nodejs_from_binary.rb", "content": "# FIXME: This should really check the version of node we're looking for", "line": 24, "detection_span": [19, 29], "with_context": "\nChef::Recipe.send(:include, NodeJs::Helper)\n\n# Shamelessly borrowed from http://docs.chef.io/dsl_recipe_method_platform.html\n# Surely there's a more canonical way to get arch?\narch = if node['kernel']['machine'] =~ /armv6l/\n24:          # FIXME: This should really check the version of node we're looking for\n# as it seems that they haven't build an `arm-pi` version in a while...\n# if it's old, return this, otherwise just return `node['kernel']['machine']`\n'arm-pi' # assume a raspberry pi\nelsif node['kernel']['machine'] =~ /aarch64/\n'arm64'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-nodejs-recipes-nodejs_from_binary.rb\n# Target line: 24\n\n     19: Chef::Recipe.send(:include, NodeJs::Helper)\n     20: \n     21: # Shamelessly borrowed from http://docs.chef.io/dsl_recipe_method_platform.html\n     22: # Surely there's a more canonical way to get arch?\n     23: arch = if node['kernel']['machine'] =~ /armv6l/\n>>>  24:          # FIXME: This should really check the version of node we're looking for\n     25:          # as it seems that they haven't build an `arm-pi` version in a while...\n     26:          # if it's old, return this, otherwise just return `node['kernel']['machine']`\n     27:          'arm-pi' # assume a raspberry pi\n     28:        elsif node['kernel']['machine'] =~ /aarch64/\n     29:          'arm64'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-provider.rb", "content": "# fix the use_inline_resources LWRPBase wrapper that creates a sub-resource collection with the ugpraded code", "line": 47, "detection_span": [42, 52], "with_context": "\nclass Provider\nclass LWRPBase < Provider\nif defined?(InlineResources)\nmodule InlineResources\n# since we upgrade the Chef::Runner and Chef::RunContext globally to >= 12.14 style classes, we need to also\n47:           # fix the use_inline_resources LWRPBase wrapper that creates a sub-resource collection with the ugpraded code\n# from the Chef::Provider subclasses that do similar things in post-12.5 chef.\ndef recipe_eval_with_update_check(&block)\nold_run_context = run_context\n@run_context = run_context.create_child\nreturn_value = instance_eval(&block)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-provider.rb\n# Target line: 47\n\n     42:   class Provider\n     43:     class LWRPBase < Provider\n     44:       if defined?(InlineResources)\n     45:         module InlineResources\n     46:           # since we upgrade the Chef::Runner and Chef::RunContext globally to >= 12.14 style classes, we need to also\n>>>  47:           # fix the use_inline_resources LWRPBase wrapper that creates a sub-resource collection with the ugpraded code\n     48:           # from the Chef::Provider subclasses that do similar things in post-12.5 chef.\n     49:           def recipe_eval_with_update_check(&block)\n     50:             old_run_context = run_context\n     51:             @run_context = run_context.create_child\n     52:             return_value = instance_eval(&block)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "laradji_zabbix-recipes-agent_source.rb", "content": "# --prefix is controlled by install_dir", "line": 29, "detection_span": [24, 34], "with_context": "\naction :install\nend\nend\nend\n\n29: # --prefix is controlled by install_dir\nconfigure_options = node['zabbix']['agent']['configure_options'].dup\nconfigure_options = (configure_options || Array.new).delete_if do |option|\noption.match(/\\s*--prefix(\\s|=).+/)\nend\nnode.normal['zabbix']['agent']['configure_options'] = configure_options", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: laradji_zabbix-recipes-agent_source.rb\n# Target line: 29\n\n     24:       action :install\n     25:     end\n     26:   end\n     27: end\n     28: \n>>>  29: # --prefix is controlled by install_dir\n     30: configure_options = node['zabbix']['agent']['configure_options'].dup\n     31: configure_options = (configure_options || Array.new).delete_if do |option|\n     32:   option.match(/\\s*--prefix(\\s|=).+/)\n     33: end\n     34: node.normal['zabbix']['agent']['configure_options'] = configure_options\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "amitjain1975_custom-rightscale-cookbooks-db_postgres-definitions-db_postgres_restore.rb", "content": "repo_params = params # see http://tickets.opscode.com/browse/CHEF-422", "line": 10, "detection_span": [5, 15], "with_context": "\n# RightScale Terms of Service available at http://www.rightscale.com/terms.php and,\n# if applicable, other agreements such as a RightScale Master Subscription Agreement.\n\ndefine :db_postgres_restore,  :url => nil, :branch => 'master', :user => nil, :credentials => nil, :file_path => nil, :schema_name => nil, :tmp_dir => '/tmp' do\n\n10:   repo_params = params # see http://tickets.opscode.com/browse/CHEF-422\n\ndir = \"#{params[:tmp_dir]}/db_postgres_restore\"\ndumpfile = \"#{dir}/#{params[:file_path]}\"\nschema_name = params[:schema_name]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-db_postgres-definitions-db_postgres_restore.rb\n# Target line: 10\n\n      5: # RightScale Terms of Service available at http://www.rightscale.com/terms.php and,\n      6: # if applicable, other agreements such as a RightScale Master Subscription Agreement.\n      7: \n      8: define :db_postgres_restore,  :url => nil, :branch => 'master', :user => nil, :credentials => nil, :file_path => nil, :schema_name => nil, :tmp_dir => '/tmp' do\n      9: \n>>>  10:   repo_params = params # see http://tickets.opscode.com/browse/CHEF-422\n     11: \n     12:   dir = \"#{params[:tmp_dir]}/db_postgres_restore\"\n     13:   dumpfile = \"#{dir}/#{params[:file_path]}\"\n     14:   schema_name = params[:schema_name]\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-sudo-resources-default.rb", "content": "# `Cmnd_Alias`. This should help people more easily catch issues", "line": 86, "detection_span": [81, 91], "with_context": "\nend\n\n# Validates if each element in an array starts with `/` or is in\n# ALL_CAPS. This is helpful for ensuring that the commands\n# passing into the sudoers resource as they need a full path or a\n86: # `Cmnd_Alias`. This should help people more easily catch issues\n# where the user requested `tail SOME_ARGS SOME_FILE` where they\n# need to use `/usr/bin/tail SOME_ARGS SOME_FILE`.\n# return [TrueClass, FalseClass]\ndef validate_commands_path(commands)\ncommands.each do |command|", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-sudo-resources-default.rb\n# Target line: 86\n\n     81: end\n     82: \n     83: # Validates if each element in an array starts with `/` or is in\n     84: # ALL_CAPS. This is helpful for ensuring that the commands\n     85: # passing into the sudoers resource as they need a full path or a\n>>>  86: # `Cmnd_Alias`. This should help people more easily catch issues\n     87: # where the user requested `tail SOME_ARGS SOME_FILE` where they\n     88: # need to use `/usr/bin/tail SOME_ARGS SOME_FILE`.\n     89: # return [TrueClass, FalseClass]\n     90: def validate_commands_path(commands)\n     91:   commands.each do |command|\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-go_expvar.rb", "content": "#     'expvar_url' => 'http://localhost:8080/debug/vars',", "line": 6, "detection_span": [1, 11], "with_context": "\ninclude_recipe '::dd-agent'\n\n# Monitor Go metrics exported via expvar\n#  node['datadog']['go_expvar']['instances'] = [\n#   {\n6: #     'expvar_url' => 'http://localhost:8080/debug/vars',\n#     'tags' => [\n#        'application:my_go_app'\n#      ],\n#     'metrics' => [\n#       {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-recipes-go_expvar.rb\n# Target line: 6\n\n      1: include_recipe '::dd-agent'\n      2: \n      3: # Monitor Go metrics exported via expvar\n      4: #  node['datadog']['go_expvar']['instances'] = [\n      5: #   {\n>>>   6: #     'expvar_url' => 'http://localhost:8080/debug/vars',\n      7: #     'tags' => [\n      8: #        'application:my_go_app'\n      9: #      ],\n     10: #     'metrics' => [\n     11: #       {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "redu_ey-cloud-recipes-cookbooks-varnish_frontend-recipes-default.rb", "content": "# Install MOTD to ensure support is aware of iptables hackery.", "line": 95, "detection_span": [90, 100], "with_context": "\n:cache => CACHE,\n:varnish_port => 882\n})\nend\n\n95:   # Install MOTD to ensure support is aware of iptables hackery.\ntemplate '/etc/motd' do\nmode 655\nsource 'motd.erb'\nvariables({ :interface => INTERFACE })\n100:   end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: redu_ey-cloud-recipes-cookbooks-varnish_frontend-recipes-default.rb\n# Target line: 95\n\n     90:       :cache => CACHE,\n     91:       :varnish_port => 882\n     92:     })\n     93:   end\n     94: \n>>>  95:   # Install MOTD to ensure support is aware of iptables hackery.\n     96:   template '/etc/motd' do\n     97:     mode 655\n     98:     source 'motd.erb'\n     99:     variables({ :interface => INTERFACE })\n    100:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-snappy-cookbooks-rvm-recipes-system.rb", "content": "# collision with later processes which may set a guid explicitly", "line": 64, "detection_span": [59, 69], "with_context": "\nend\np.run_action(:install) if gem_package_included\nend\n\n# Build the rvm group ahead of time, if it is set. This allows avoiding\n64: # collision with later processes which may set a guid explicitly\nrvm_group_id = (node['rvm']['group_id'] == 'default') ? nil : node['rvm']['group_id']\ng = group 'rvm' do\ngroup_name 'rvm'\ngid        rvm_group_id\naction     :nothing", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-snappy-cookbooks-rvm-recipes-system.rb\n# Target line: 64\n\n     59:   end\n     60:   p.run_action(:install) if gem_package_included\n     61: end\n     62: \n     63: # Build the rvm group ahead of time, if it is set. This allows avoiding\n>>>  64: # collision with later processes which may set a guid explicitly\n     65: rvm_group_id = (node['rvm']['group_id'] == 'default') ? nil : node['rvm']['group_id']\n     66: g = group 'rvm' do\n     67:   group_name 'rvm'\n     68:   gid        rvm_group_id\n     69:   action     :nothing\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-work.rb", "content": "# https://bugs.launchpad.net/neutron/+bug/1915480", "line": 54, "detection_span": [49, 59], "with_context": "\naction %i(disable stop)\nend\nend\n\n# install patched dhcp.py for calico-dhcp-agent\n54: # https://bugs.launchpad.net/neutron/+bug/1915480\ncookbook_file '/usr/lib/python3/dist-packages/neutron/agent/linux/dhcp.py' do\nsource 'neutron/dhcp.py'\nnotifies :restart, 'service[calico-dhcp-agent]', :delayed\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-work.rb\n# Target line: 54\n\n     49:     action %i(disable stop)\n     50:   end\n     51: end\n     52: \n     53: # install patched dhcp.py for calico-dhcp-agent\n>>>  54: # https://bugs.launchpad.net/neutron/+bug/1915480\n     55: cookbook_file '/usr/lib/python3/dist-packages/neutron/agent/linux/dhcp.py' do\n     56:   source 'neutron/dhcp.py'\n     57:   notifies :restart, 'service[calico-dhcp-agent]', :delayed\n     58: end\n     59: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-helper.rb", "content": "# @todo: Is there a more robust way to determine this, i.e., based", "line": 95, "detection_span": [90, 100], "with_context": "\nend\n\n# Use the presence of a sentinel file as an indicator for whether\n# the server has already had initial bootstrapping performed.\n#\n95:   # @todo: Is there a more robust way to determine this, i.e., based\n#   on some functional aspect of the system?\ndef self.has_been_bootstrapped?\nFile.exists?(bootstrap_sentinel_file)\nend\n100:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-helper.rb\n# Target line: 95\n\n     90:   end\n     91: \n     92:   # Use the presence of a sentinel file as an indicator for whether\n     93:   # the server has already had initial bootstrapping performed.\n     94:   #\n>>>  95:   # @todo: Is there a more robust way to determine this, i.e., based\n     96:   #   on some functional aspect of the system?\n     97:   def self.has_been_bootstrapped?\n     98:     File.exists?(bootstrap_sentinel_file)\n     99:   end\n    100: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_nova-recipes-nova-scheduler-patch.rb", "content": "# lp:bug https://bugs.launchpad.net/nova/+bug/1007573", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n#\n\ninclude_recipe \"osops-utils\"\n\n22: # lp:bug https://bugs.launchpad.net/nova/+bug/1007573\n# affinity filters don't work if scheduler_hints is None\ntemplate \"/usr/share/pyshared/nova/scheduler/filters/affinity_filter.py\" do\nsource \"patches/affinity_filter.py.2012.1+stable~20120612-3ee026e-0ubuntu1.2.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-scheduler-patch.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: #\n     19: \n     20: include_recipe \"osops-utils\"\n     21: \n>>>  22: # lp:bug https://bugs.launchpad.net/nova/+bug/1007573\n     23: # affinity filters don't work if scheduler_hints is None\n     24: template \"/usr/share/pyshared/nova/scheduler/filters/affinity_filter.py\" do\n     25:   source \"patches/affinity_filter.py.2012.1+stable~20120612-3ee026e-0ubuntu1.2.erb\"\n     26:   owner \"root\"\n     27:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_delivery-truck-recipes-lint.rb", "content": "# workaround for https://github.com/bbatsov/rubocop/issues/2407", "line": 31, "detection_span": [26, 36], "with_context": "\n# modified cookbooks, if the cookbook contains a .rubocop.yml file\nif cookstyle_enabled?\nexecute \"lint_cookstyle_#{cookbook.name}\" do\ncommand \"cookstyle #{cookbook.path}\"\nenvironment(\n31:         # workaround for https://github.com/bbatsov/rubocop/issues/2407\n'USER' => (ENV['USER'] || 'dbuild')\n)\nlive_stream true\nonly_if 'cookstyle -v'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_delivery-truck-recipes-lint.rb\n# Target line: 31\n\n     26:   # modified cookbooks, if the cookbook contains a .rubocop.yml file\n     27:   if cookstyle_enabled?\n     28:     execute \"lint_cookstyle_#{cookbook.name}\" do\n     29:       command \"cookstyle #{cookbook.path}\"\n     30:       environment(\n>>>  31:         # workaround for https://github.com/bbatsov/rubocop/issues/2407\n     32:         'USER' => (ENV['USER'] || 'dbuild')\n     33:       )\n     34:       live_stream true\n     35:       only_if 'cookstyle -v'\n     36:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb", "content": "# Install service in debug mode", "line": 40, "detection_span": [35, 45], "with_context": "\n# documentation purpose only):\n#\n# Additional ssh key that should be added to deployment service user\n# default['cloudify']['properties']['ssh_key'] = ''\n#\n40: # Install service in debug mode\n# default['cloudify']['properties']['debug_mode'] = true\n#\n# Source tarball for service files\n# default['cloudify']['properties']['sources'] =\n#   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb\n# Target line: 40\n\n     35: # documentation purpose only):\n     36: #\n     37: # Additional ssh key that should be added to deployment service user\n     38: # default['cloudify']['properties']['ssh_key'] = ''\n     39: #\n>>>  40: # Install service in debug mode\n     41: # default['cloudify']['properties']['debug_mode'] = true\n     42: #\n     43: # Source tarball for service files\n     44: # default['cloudify']['properties']['sources'] =\n     45: #   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-snappy-cookbooks-statsd-recipes-server.rb", "content": "# FIXME: this interface could use some help", "line": 48, "detection_span": [43, 53], "with_context": "\nend\n\nannounce(:statsd, :server,\n:port => node[:statsd][:port])\n\n48: # FIXME: this interface could use some help\nbegin\ngraphite_carbon = discover(:graphite, :carbon).info[:info]\nrescue StandardError => err\ngraphite_carbon = { :port => '2003', :addr => '127.0.0.1' }\nLog.error(\"\\n  !!!!\\n  Could not find graphite carbon server. If it's on this machine, make sure its role preceded the statds server role.\\n #{err}\\n  !!!!\")", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-snappy-cookbooks-statsd-recipes-server.rb\n# Target line: 48\n\n     43: end\n     44: \n     45: announce(:statsd, :server,\n     46:   :port => node[:statsd][:port])\n     47: \n>>>  48: # FIXME: this interface could use some help\n     49: begin\n     50:   graphite_carbon = discover(:graphite, :carbon).info[:info]\n     51: rescue StandardError => err\n     52:   graphite_carbon = { :port => '2003', :addr => '127.0.0.1' }\n     53:   Log.error(\"\\n  !!!!\\n  Could not find graphite carbon server. If it's on this machine, make sure its role preceded the statds server role.\\n #{err}\\n  !!!!\")\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "hw-cookbooks_lxc-recipes-rhel_bridge.rb", "content": "# @todo this is temp! don't leave this mess", "line": 36, "detection_span": [31, 41], "with_context": "\nexecute 'enable lxcbr0' do\ncommand 'ifup lxcbr0'\naction :nothing\nend\n\n36: # @todo this is temp! don't leave this mess\n\nfile '/etc/sysconfig/iptables' do\ncontent [\n'# Chef managed to enable LXC',\n'*filter',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: hw-cookbooks_lxc-recipes-rhel_bridge.rb\n# Target line: 36\n\n     31: execute 'enable lxcbr0' do\n     32:   command 'ifup lxcbr0'\n     33:   action :nothing\n     34: end\n     35: \n>>>  36: # @todo this is temp! don't leave this mess\n     37: \n     38: file '/etc/sysconfig/iptables' do\n     39:   content [\n     40:     '# Chef managed to enable LXC',\n     41:     '*filter',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-rundeck-recipes-client.rb", "content": "# FIXME: perms must be set right on /var/lib/rundeck and .ssh", "line": 2, "detection_span": [1, 7], "with_context": "\n# FIXME: home should be /var/lib/rundeck not :home_dir\n2: # FIXME: perms must be set right on /var/lib/rundeck and .ssh\n\nunless system \"id -u rundeck\" #if the rundeck user has running processes, daemon_user will fail\ndaemon_user :rundeck do\nhome         node[:rundeck][:home_dir]\nmanage_home  true             # rundeck owns this so it can manage its own SSH credentials", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-rundeck-recipes-client.rb\n# Target line: 2\n\n      1: # FIXME: home should be /var/lib/rundeck not :home_dir\n>>>   2: # FIXME: perms must be set right on /var/lib/rundeck and .ssh\n      3: \n      4: unless system \"id -u rundeck\" #if the rundeck user has running processes, daemon_user will fail\n      5:   daemon_user :rundeck do\n      6:     home         node[:rundeck][:home_dir]\n      7:     manage_home  true             # rundeck owns this so it can manage its own SSH credentials\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "xdv-staging_chef-os-hardening-recipes-apt.rb", "content": "# TODO: could check apt.conf to make sure this hasn't been disabled.", "line": 24, "detection_span": [19, 29], "with_context": "\n#\n\ninclude_recipe 'apt'\n\n# apt-get and aptitude check package signatures by default.\n24: # TODO: could check apt.conf to make sure this hasn't been disabled.\n\nif node['security']['packages']['clean']\n\n# remove packages and handle virtual packages correctly.\n# this is the same package list as used for the redhat distro family", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: xdv-staging_chef-os-hardening-recipes-apt.rb\n# Target line: 24\n\n     19: #\n     20: \n     21: include_recipe 'apt'\n     22: \n     23: # apt-get and aptitude check package signatures by default.\n>>>  24: # TODO: could check apt.conf to make sure this hasn't been disabled.\n     25: \n     26: if node['security']['packages']['clean']\n     27: \n     28:   # remove packages and handle virtual packages correctly.\n     29:   # this is the same package list as used for the redhat distro family\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb", "content": "# @see #debug?", "line": 57, "detection_span": [52, 62], "with_context": "\n)\nend\n\n# Log a message only if Poise's extra debugging output is enabled.\n#\n57:   # @see #debug?\n# @param msg [String] Log message.\n# @return [void]\ndef self.debug(msg)\nChef::Log.debug(msg) if debug?\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb\n# Target line: 57\n\n     52:     )\n     53:   end\n     54: \n     55:   # Log a message only if Poise's extra debugging output is enabled.\n     56:   #\n>>>  57:   # @see #debug?\n     58:   # @param msg [String] Log message.\n     59:   # @return [void]\n     60:   def self.debug(msg)\n     61:     Chef::Log.debug(msg) if debug?\n     62:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-logrotate-attributes-default.rb", "content": "# TODO: remove provider option in next major release", "line": 26, "detection_span": [21, 31], "with_context": "\n\ndefault['logrotate']['package'] = {\n'name' => 'logrotate',\n'source' => nil,\n'version' => nil,\n26:   # TODO: remove provider option in next major release\n'provider' => nil,\n'action' => :upgrade,\n}\n\ndefault['logrotate']['directory'] = '/etc/logrotate.d'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-logrotate-attributes-default.rb\n# Target line: 26\n\n     21: \n     22: default['logrotate']['package'] = {\n     23:   'name' => 'logrotate',\n     24:   'source' => nil,\n     25:   'version' => nil,\n>>>  26:   # TODO: remove provider option in next major release\n     27:   'provider' => nil,\n     28:   'action' => :upgrade,\n     29: }\n     30: \n     31: default['logrotate']['directory'] = '/etc/logrotate.d'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-hivemq.rb", "content": "#     # service_check_prefix - required: false  - string", "line": 15, "detection_span": [10, 20], "with_context": "\n#     \"is_jmx\" => true,\n#     # collect_default_metrics - required: true  - boolean\n#     \"collect_default_metrics\" => true,\n#     # new_gc_metrics - required: false  - boolean\n#     \"new_gc_metrics\" => false,\n15: #     # service_check_prefix - required: false  - string\n#     \"service_check_prefix\" => nil,\n#     # conf - required: false  - array of object\n#     \"conf\" => [\n#       {\n#         \"include\" => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-recipes-hivemq.rb\n# Target line: 15\n\n     10: #     \"is_jmx\" => true,\n     11: #     # collect_default_metrics - required: true  - boolean\n     12: #     \"collect_default_metrics\" => true,\n     13: #     # new_gc_metrics - required: false  - boolean\n     14: #     \"new_gc_metrics\" => false,\n>>>  15: #     # service_check_prefix - required: false  - string\n     16: #     \"service_check_prefix\" => nil,\n     17: #     # conf - required: false  - array of object\n     18: #     \"conf\" => [\n     19: #       {\n     20: #         \"include\" => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-resources-release.rb", "content": "# Chef::Log.info( [environment, install_dir, home_dir, release_file, release_basename, release_ext, release_url, prefix_root ].inspect )", "line": 109, "detection_span": [104, 114], "with_context": "\nwhen 'tar.bz2' then untar_cmd('xjf', release_file, install_dir)\nwhen 'zip'     then \"unzip -q -u -o '#{release_file}'\"\nelse raise \"Don't know how to expand #{release_url} which has extension '#{release_ext}'\"\nend\n108:\n109:   # Chef::Log.info( [environment, install_dir, home_dir, release_file, release_basename, release_ext, release_url, prefix_root ].inspect )\n110: end\n111:\n112: def untar_cmd(sub_cmd, release_file, install_dir)\n113:   %Q{mkdir -p '#{install_dir}' ; tar #{sub_cmd} '#{release_file}' --strip-components=1 -C '#{install_dir}'}\n114: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-resources-release.rb\n# Target line: 109\n\n    104:     when 'tar.bz2' then untar_cmd('xjf', release_file, install_dir)\n    105:     when 'zip'     then \"unzip -q -u -o '#{release_file}'\"\n    106:     else raise \"Don't know how to expand #{release_url} which has extension '#{release_ext}'\"\n    107:     end\n    108: \n>>> 109:   # Chef::Log.info( [environment, install_dir, home_dir, release_file, release_basename, release_ext, release_url, prefix_root ].inspect )\n    110: end\n    111: \n    112: def untar_cmd(sub_cmd, release_file, install_dir)\n    113:   %Q{mkdir -p '#{install_dir}' ; tar #{sub_cmd} '#{release_file}' --strip-components=1 -C '#{install_dir}'}\n    114: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danielladd_Chef-Testing-cookbooks-php-resources-pear_channel.rb", "content": "# TODO: add authenticated channel support!", "line": 27, "detection_span": [22, 32], "with_context": "\nactions :discover, :add, :update, :remove\n\nattribute :channel_name, :kind_of => String, :name_attribute => true\nattribute :channel_xml, :kind_of => String\n\n27: # TODO: add authenticated channel support!\n# attribute :username, :kind_of => String\n# attribute :password, :kind_of => String", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-php-resources-pear_channel.rb\n# Target line: 27\n\n     22: actions :discover, :add, :update, :remove\n     23: \n     24: attribute :channel_name, :kind_of => String, :name_attribute => true\n     25: attribute :channel_xml, :kind_of => String\n     26: \n>>>  27: # TODO: add authenticated channel support!\n     28: # attribute :username, :kind_of => String\n     29: # attribute :password, :kind_of => String\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb", "content": "# Check if Poise's extra debugging output is enabled. This produces a *lot*", "line": 34, "detection_span": [29, 39], "with_context": "\nautoload :Resource, 'poise/resource'\nautoload :Subcontext, 'poise/subcontext'\nautoload :Utils, 'poise/utils'\nautoload :VERSION, 'poise/version'\n\n34:   # Check if Poise's extra debugging output is enabled. This produces a *lot*\n# of logging.\n#\n# @param node [Chef::Node, Chef::RunContext] Optional node to check for\n#   attributes. If not given, Chef.node is used instead.\n# @return [Boolean]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise.rb\n# Target line: 34\n\n     29:   autoload :Resource, 'poise/resource'\n     30:   autoload :Subcontext, 'poise/subcontext'\n     31:   autoload :Utils, 'poise/utils'\n     32:   autoload :VERSION, 'poise/version'\n     33: \n>>>  34:   # Check if Poise's extra debugging output is enabled. This produces a *lot*\n     35:   # of logging.\n     36:   #\n     37:   # @param node [Chef::Node, Chef::RunContext] Optional node to check for\n     38:   #   attributes. If not given, Chef.node is used instead.\n     39:   # @return [Boolean]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice-h2020-recipes-conf-optim.rb", "content": "# TODO temporary step before the utilities are packaged in the release", "line": 95, "detection_span": [90, 100], "with_context": "\ncp bin/ubuntu64/run_main.sh #{co_install_path}\nEOH\naction :run\nend\n\n95: # TODO temporary step before the utilities are packaged in the release\nbash 'install-co-ext' do\ncwd \"/tmp\"\ncode <<-EOH\n[[ -d co-src ]] && rm -rf co-src\n100: \t\tmkdir -p co-src", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice-h2020-recipes-conf-optim.rb\n# Target line: 95\n\n     90: \t\tcp bin/ubuntu64/run_main.sh #{co_install_path}\n     91: \t\tEOH\n     92: \taction :run\n     93: end\n     94: \n>>>  95: # TODO temporary step before the utilities are packaged in the release\n     96: bash 'install-co-ext' do\n     97: \tcwd \"/tmp\"\n     98: \tcode <<-EOH\n     99: \t\t[[ -d co-src ]] && rm -rf co-src\n    100: \t\tmkdir -p co-src\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-snmp.rb", "content": "# TODO: for now the defaultMonitors are turned off, they produce bogus error", "line": 121, "detection_span": [116, 126], "with_context": "\n:sys_location  => node['sys']['snmp']['sys_location']\n117:   )\n118: end\n119:\n120:\n121: # TODO: for now the defaultMonitors are turned off, they produce bogus error\n#       messages  service startup  MIBs are available\n#       (package 'snmp-mibs-downloader')\n#       and configured in /etc/default/snmpd ('export MIBS=/usr/share/mibs')\n125:\n126: service 'snmpd' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-snmp.rb\n# Target line: 121\n\n    116:     :sys_location  => node['sys']['snmp']['sys_location']\n    117:   )\n    118: end\n    119: \n    120: \n>>> 121: # TODO: for now the defaultMonitors are turned off, they produce bogus error\n    122: #       messages  service startup  MIBs are available\n    123: #       (package 'snmp-mibs-downloader')\n    124: #       and configured in /etc/default/snmpd ('export MIBS=/usr/share/mibs')\n    125: \n    126: service 'snmpd' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-radioedit-providers-node.rb", "content": "# TODO", "line": 30, "detection_span": [25, 35], "with_context": "\n\n\n\n\n# Create service init script for application.\n30: # TODO\n\naction :init do\n\nnew_resource = @new_resource\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-radioedit-providers-node.rb\n# Target line: 30\n\n     25: \n     26: \n     27: \n     28: \n     29: # Create service init script for application.\n>>>  30: # TODO\n     31: \n     32: action :init do \n     33: \n     34:   new_resource = @new_resource\n     35: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-recipes-default.rb", "content": "# FIXME -- these need to be done immediately", "line": 22, "detection_span": [17, 27], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n22: # FIXME -- these need to be done immediately\n\npackage \"unzip\"\n\npackage \"tar\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-recipes-default.rb\n# Target line: 22\n\n     17: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     18: # See the License for the specific language governing permissions and\n     19: # limitations under the License.\n     20: #\n     21: \n>>>  22: # FIXME -- these need to be done immediately\n     23: \n     24: package \"unzip\"\n     25: \n     26: package \"tar\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-openstack-network-recipes-dhcp_agent.rb", "content": "# TODO: (jklare) this should be refactored and probably pull in the some dnsmasq", "line": 51, "detection_span": [46, 56], "with_context": "\nvariables(\nservice_config: service_config\n)\nend\n\n51: # TODO: (jklare) this should be refactored and probably pull in the some dnsmasq\n# cookbook to do the proper configuration\npackage 'dnsmasq' do\naction :upgrade\nend if platform_family?('rhel')\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-network-recipes-dhcp_agent.rb\n# Target line: 51\n\n     46:   variables(\n     47:     service_config: service_config\n     48:   )\n     49: end\n     50: \n>>>  51: # TODO: (jklare) this should be refactored and probably pull in the some dnsmasq\n     52: # cookbook to do the proper configuration\n     53: package 'dnsmasq' do\n     54:   action :upgrade\n     55: end if platform_family?('rhel')\n     56: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "circlebuilder_CircleBuilder-Chef-cookbooks-mysql_replication_check-recipes-default.rb", "content": "# the number of seconds delay at which a warning alert is issued; default 30 minutes (1800 seconds)", "line": 15, "detection_span": [10, 20], "with_context": "\n# installation path for monitoring tool\ninstall_path = '/data/monitoring'\n\n# configuration of replication check script\ncheck_vars = {\n15:   # the number of seconds delay at which a warning alert is issued; default 30 minutes (1800 seconds)\n:warn_level => 1800,\n# the number of seconds delay at which a critical alert is issued; default 2 hours (7200 seconds)\n:crit_level => 7200,\n# valid email address to receive alerts\n:mail_recipient => '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: circlebuilder_CircleBuilder-Chef-cookbooks-mysql_replication_check-recipes-default.rb\n# Target line: 15\n\n     10: # installation path for monitoring tool\n     11: install_path = '/data/monitoring'\n     12: \n     13: # configuration of replication check script\n     14: check_vars = {\n>>>  15:   # the number of seconds delay at which a warning alert is issued; default 30 minutes (1800 seconds)\n     16:   :warn_level => 1800,\n     17:   # the number of seconds delay at which a critical alert is issued; default 2 hours (7200 seconds)\n     18:   :crit_level => 7200,\n     19:   # valid email address to receive alerts\n     20:   :mail_recipient => '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "brijeshakbari_chefrepo-recipes-install.rb", "content": "# necessary until upstream fixes ENABLE_MONGOD/DB flag", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\ncase node['platform_family']\nwhen 'debian'\n# this options lets us bypass complaint of pre-existing init file\n66:   # necessary until upstream fixes ENABLE_MONGOD/DB flag\npackager_opts = '-o Dpkg::Options::=\"--force-confold\" --force-yes'\nwhen 'rhel'\n# Add --nogpgcheck option when package is signed\n# see: https://jira.mongodb.org/browse/SERVER-8770\npackager_opts = '--nogpgcheck'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: brijeshakbari_chefrepo-recipes-install.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: case node['platform_family']\n     64: when 'debian'\n     65:   # this options lets us bypass complaint of pre-existing init file\n>>>  66:   # necessary until upstream fixes ENABLE_MONGOD/DB flag\n     67:   packager_opts = '-o Dpkg::Options::=\"--force-confold\" --force-yes'\n     68: when 'rhel'\n     69:   # Add --nogpgcheck option when package is signed\n     70:   # see: https://jira.mongodb.org/browse/SERVER-8770\n     71:   packager_opts = '--nogpgcheck'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb", "content": "# restart service for solaris on chef-client has a bug", "line": 133, "detection_span": [128, 138], "with_context": "\n128:   template \"#{node['postfix']['conf_dir']}/#{cfg}.cf\" do\nsource \"#{cfg}.cf.erb\"\nowner 'root'\ngroup node['root_group']\nmode '0644'\n133:     # restart service for solaris on chef-client has a bug\n# unless condition can be removed after\n# https://github.com/chef/chef/pull/6596 merge/release\nnotifies :restart, 'service[postfix]' unless platform_family?('solaris2')\nvariables(\nlazy { { settings: node['postfix'][cfg] } }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb\n# Target line: 133\n\n    128:   template \"#{node['postfix']['conf_dir']}/#{cfg}.cf\" do\n    129:     source \"#{cfg}.cf.erb\"\n    130:     owner 'root'\n    131:     group node['root_group']\n    132:     mode '0644'\n>>> 133:     # restart service for solaris on chef-client has a bug\n    134:     # unless condition can be removed after\n    135:     # https://github.com/chef/chef/pull/6596 merge/release\n    136:     notifies :restart, 'service[postfix]' unless platform_family?('solaris2')\n    137:     variables(\n    138:       lazy { { settings: node['postfix'][cfg] } }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb", "content": "default[:elasticsearch][:index_cache_field_type]  = 'resident'   # Another option is soft, which will increase cache performance but be wary because this will make it crash if the \"wrong\" query is issued. The field cache can OOM your machine in a moment when too large, but when you have the RAM field values are one of the most important things to cache. Consider setting this to a very high value to be safe; certainly, set it on indexes that are very large.", "line": 73, "detection_span": [68, 78], "with_context": "\ndefault[:elasticsearch][:flush_threshold_ops]     = 5000\ndefault[:elasticsearch][:flush_threshold_size]    = \"200mb\"\ndefault[:elasticsearch][:flush_threshold_period]  = \"60s\"\ndefault[:elasticsearch][:cache_filter_size]       = \"20%\"  # can be a percent (\"10%\") or a number (\"128m\")\ndefault[:elasticsearch][:index_buffer_size]       = \"10%\"  # can be a percent (\"10%\") or a number (\"128m\") (changed 2012-10 to default 10%, same as es default)\n73: default[:elasticsearch][:index_cache_field_type]  = 'resident'   # Another option is soft, which will increase cache performance but be wary because this will make it crash if the \"wrong\" query is issued. The field cache can OOM your machine in a moment when too large, but when you have the RAM field values are one of the most important things to cache. Consider setting this to a very high value to be safe; certainly, set it on indexes that are very large.\ndefault[:elasticsearch][:merge_factor]            = 10\ndefault[:elasticsearch][:floor_segment]           = \"2.7mb\"\n\ndefault[:elasticsearch][:max_thread_count]        = nil    # Maximum value given that max_thread_count must be < max_merge_count (changed 2012-10 to default nil)\ndefault[:elasticsearch][:term_index_interval]     = 1024", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb\n# Target line: 73\n\n     68: default[:elasticsearch][:flush_threshold_ops]     = 5000\n     69: default[:elasticsearch][:flush_threshold_size]    = \"200mb\"\n     70: default[:elasticsearch][:flush_threshold_period]  = \"60s\"\n     71: default[:elasticsearch][:cache_filter_size]       = \"20%\"  # can be a percent (\"10%\") or a number (\"128m\")\n     72: default[:elasticsearch][:index_buffer_size]       = \"10%\"  # can be a percent (\"10%\") or a number (\"128m\") (changed 2012-10 to default 10%, same as es default)\n>>>  73: default[:elasticsearch][:index_cache_field_type]  = 'resident'   # Another option is soft, which will increase cache performance but be wary because this will make it crash if the \"wrong\" query is issued. The field cache can OOM your machine in a moment when too large, but when you have the RAM field values are one of the most important things to cache. Consider setting this to a very high value to be safe; certainly, set it on indexes that are very large.\n     74: default[:elasticsearch][:merge_factor]            = 10\n     75: default[:elasticsearch][:floor_segment]           = \"2.7mb\"\n     76: \n     77: default[:elasticsearch][:max_thread_count]        = nil    # Maximum value given that max_thread_count must be < max_merge_count (changed 2012-10 to default nil)\n     78: default[:elasticsearch][:term_index_interval]     = 1024\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-poise-files-halite_gem-poise.rb", "content": "# Display a message if poise_debug is enabled. Off in ChefSpec so I don't get", "line": 106, "detection_span": [101, 111], "with_context": "\n101:   end\n102:\n103:   mod\n104: end\n105:\n106: # Display a message if poise_debug is enabled. Off in ChefSpec so I don't get\n107: # extra logging stuff that I don't care about.\n108: Poise.debug('[Poise] Extra verbose logging enabled') unless defined?(ChefSpec)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-poise-files-halite_gem-poise.rb\n# Target line: 106\n\n    101:   end\n    102: \n    103:   mod\n    104: end\n    105: \n>>> 106: # Display a message if poise_debug is enabled. Off in ChefSpec so I don't get\n    107: # extra logging stuff that I don't care about.\n    108: Poise.debug('[Poise] Extra verbose logging enabled') unless defined?(ChefSpec)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-apt-recipes-cacher-ng.rb", "content": "# Reopen resource w/ start in case config issue causes startup to fail", "line": 38, "detection_span": [33, 43], "with_context": "\ngroup \"root\"\nmode 00644\nnotifies :restart, \"service[apt-cacher-ng]\"\nend\n\n38:   # Reopen resource w/ start in case config issue causes startup to fail\nservice \"apt-cacher-ng\" do\naction :start\nend\n\n#this will help seed the proxy", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-apt-recipes-cacher-ng.rb\n# Target line: 38\n\n     33:     group \"root\"\n     34:     mode 00644\n     35:     notifies :restart, \"service[apt-cacher-ng]\"\n     36:   end\n     37:   \n>>>  38:   # Reopen resource w/ start in case config issue causes startup to fail\n     39:   service \"apt-cacher-ng\" do\n     40:     action :start\n     41:   end\n     42:   \n     43:   #this will help seed the proxy\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-radioedit-providers-node.rb", "content": "## TODO: TREY:  need the following packages added to package.json", "line": 14, "detection_span": [9, 19], "with_context": "\n## jderagon\n##\n## major refactor for han releaseo\n\n\n14: ## TODO: TREY:  need the following packages added to package.json\n## 'jsdom'\n## 'jquery'\n## 'xmlhttprequest'\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-radioedit-providers-node.rb\n# Target line: 14\n\n      9: ## jderagon\n     10: ##\n     11: ## major refactor for han releaseo\n     12: \n     13: \n>>>  14: ## TODO: TREY:  need the following packages added to package.json\n     15: ## 'jsdom'\n     16: ## 'jquery'\n     17: ## 'xmlhttprequest'\n     18: \n     19: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-mailman-recipes-default.rb", "content": "#TODO: set preseed for language options", "line": 55, "detection_span": [50, 60], "with_context": "\n# enable false\n#end\n\n######## Mailman configuration\n\n55: #TODO: set preseed for language options\npackage \"mailman\"\n\nservice \"mailman\" do\naction [:enable, :start]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-mailman-recipes-default.rb\n# Target line: 55\n\n     50: # enable false\n     51: #end\n     52: \n     53: ######## Mailman configuration\n     54: \n>>>  55: #TODO: set preseed for language options\n     56: package \"mailman\"\n     57: \n     58: service \"mailman\" do\n     59:   action [:enable, :start]\n     60: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "aws_opsworks-cookbooks-php-attributes-default.rb", "content": "# would completely override this file and might cause upgrade issues.", "line": 12, "detection_span": [7, 17], "with_context": "\n# However, you should not edit customize.rb directly. Instead, create\n# \"php/attributes/customize.rb\" in your cookbook repository and\n# put the overrides in YOUR customize.rb file.\n#\n# Do NOT create an 'php/attributes/default.rb' in your cookbooks. Doing so\n12: # would completely override this file and might cause upgrade issues.\n#\n# See also: http://docs.aws.amazon.com/opsworks/latest/userguide/customizing.html\n###\n\ninclude_attribute 'deploy'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-php-attributes-default.rb\n# Target line: 12\n\n      7: # However, you should not edit customize.rb directly. Instead, create\n      8: # \"php/attributes/customize.rb\" in your cookbook repository and\n      9: # put the overrides in YOUR customize.rb file.\n     10: #\n     11: # Do NOT create an 'php/attributes/default.rb' in your cookbooks. Doing so\n>>>  12: # would completely override this file and might cause upgrade issues.\n     13: #\n     14: # See also: http://docs.aws.amazon.com/opsworks/latest/userguide/customizing.html\n     15: ###\n     16: \n     17: include_attribute 'deploy'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fzylogic_nova-recipes-libvirt.rb", "content": "# TODO(breu): this section needs to be rewritten to support key privisioning", "line": 46, "detection_span": [41, 51], "with_context": "\nsupports :status => true, :restart => true\naction :enable\nend\n\n#\n46: # TODO(breu): this section needs to be rewritten to support key privisioning\n#\ntemplate \"/etc/libvirt/libvirtd.conf\" do\nsource \"libvirtd.conf.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fzylogic_nova-recipes-libvirt.rb\n# Target line: 46\n\n     41:   supports :status => true, :restart => true\n     42:   action :enable\n     43: end\n     44: \n     45: #\n>>>  46: # TODO(breu): this section needs to be rewritten to support key privisioning\n     47: #\n     48: template \"/etc/libvirt/libvirtd.conf\" do\n     49:   source \"libvirtd.conf.erb\"\n     50:   owner \"root\"\n     51:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-kafka-recipes-server.rb", "content": "# TODO symlink /var/log/kafka/kafka.log or whatever (CLEANUP)", "line": 12, "detection_span": [7, 17], "with_context": "\n\n# create the runit service\nrunit_service \"kafka\" do\nrun_state node[:kafka][:server][:run_state]\noptions({\n12:     # TODO symlink /var/log/kafka/kafka.log or whatever (CLEANUP)\n:log_dir => node[:kafka][:log_dir],\n:home_dir => node[:kafka][:home_dir],\n:journal_dir => node[:kafka][:journal_dir],\n:install_dir => node[:kafka][:install_dir],\n:java_home => node[:java][:java_home],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-kafka-recipes-server.rb\n# Target line: 12\n\n      7: \n      8: # create the runit service\n      9: runit_service \"kafka\" do\n     10:   run_state node[:kafka][:server][:run_state]\n     11:   options({\n>>>  12:     # TODO symlink /var/log/kafka/kafka.log or whatever (CLEANUP)\n     13:     :log_dir => node[:kafka][:log_dir],\n     14:     :home_dir => node[:kafka][:home_dir],\n     15:     :journal_dir => node[:kafka][:journal_dir],\n     16:     :install_dir => node[:kafka][:install_dir],\n     17:     :java_home => node[:java][:java_home],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb", "content": "# network_id=\"some_suffix\" chef-client -z --runlist \\", "line": 70, "detection_span": [65, 75], "with_context": "\n\n# The environment variable 'network_id' defines a suffix for a network name when\n# using this example. If running from the command line, you can pass this suffix\n# in via the command line:\n#\n70: # network_id=\"some_suffix\" chef-client -z --runlist \\\n#   \"recipe[gcompute::examples~network~auto]\"\nputs 'Converting network to Custom'\ngcompute_network \"chef-e2e-mynetwork-#{ENV['network_id']}\" do\naction :create\nauto_create_subnetworks false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb\n# Target line: 70\n\n     65: \n     66: # The environment variable 'network_id' defines a suffix for a network name when\n     67: # using this example. If running from the command line, you can pass this suffix\n     68: # in via the command line:\n     69: #\n>>>  70: # network_id=\"some_suffix\" chef-client -z --runlist \\\n     71: #   \"recipe[gcompute::examples~network~auto]\"\n     72: puts 'Converting network to Custom'\n     73: gcompute_network \"chef-e2e-mynetwork-#{ENV['network_id']}\" do\n     74:   action :create\n     75:   auto_create_subnetworks false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "davestarling_chef-features-data-cookbooks-delayed_notifications-recipes-forward_references.rb", "content": "# expected behavior is for the reference to be resolved later", "line": 3, "detection_span": [1, 8], "with_context": "\nexecute(\"echo foo\") do\n# refers to the resource below, which isn't defined yet.\n3:   # expected behavior is for the reference to be resolved later\n# and the notification to work correctly\nnotifies(:create, \"file[#{node[:tmpdir]}/notified_file.txt]\")\nend\n\nfile \"#{node[:tmpdir]}/notified_file.txt\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: davestarling_chef-features-data-cookbooks-delayed_notifications-recipes-forward_references.rb\n# Target line: 3\n\n      1: execute(\"echo foo\") do\n      2:   # refers to the resource below, which isn't defined yet.\n>>>   3:   # expected behavior is for the reference to be resolved later\n      4:   # and the notification to work correctly\n      5:   notifies(:create, \"file[#{node[:tmpdir]}/notified_file.txt]\")\n      6: end\n      7: \n      8: file \"#{node[:tmpdir]}/notified_file.txt\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-ark-libraries-default.rb", "content": "# TODO: what happens when the path is already set --", "line": 54, "detection_span": [49, 59], "with_context": "\nnew_resource.prefix_root = defaults.prefix_root\nnew_resource.home_dir = defaults.home_dir\nnew_resource.version = defaults.version\nnew_resource.owner = defaults.owner\n\n54:       # TODO: what happens when the path is already set --\n#   with the current logic we overwrite it\n#   if you are in windows we overwrite it\n#   otherwise we overwrite it with the root/name-version\nnew_resource.path = defaults.path\nnew_resource.release_file = defaults.release_file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-ark-libraries-default.rb\n# Target line: 54\n\n     49:       new_resource.prefix_root = defaults.prefix_root\n     50:       new_resource.home_dir = defaults.home_dir\n     51:       new_resource.version = defaults.version\n     52:       new_resource.owner = defaults.owner\n     53: \n>>>  54:       # TODO: what happens when the path is already set --\n     55:       #   with the current logic we overwrite it\n     56:       #   if you are in windows we overwrite it\n     57:       #   otherwise we overwrite it with the root/name-version\n     58:       new_resource.path = defaults.path\n     59:       new_resource.release_file = defaults.release_file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_glance-recipes-replicator.rb", "content": "# TODO(breu): remove this stanza sometime in the future", "line": 39, "detection_span": [34, 44], "with_context": "\npackage \"glance-image-sync\" do\naction node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\noptions platform_options[\"package_options\"]\nend\n\n39:   # TODO(breu): remove this stanza sometime in the future\nfile \"/var/lib/glance/glance-image-sync.py\" do\naction :delete\nonly_if { ::File.exists?(\"/var/lib/glance/glance-image-sync.py\") }\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_glance-recipes-replicator.rb\n# Target line: 39\n\n     34:   package \"glance-image-sync\" do\n     35:     action node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\n     36:     options platform_options[\"package_options\"]\n     37:   end\n     38: \n>>>  39:   # TODO(breu): remove this stanza sometime in the future\n     40:   file \"/var/lib/glance/glance-image-sync.py\" do\n     41:     action :delete\n     42:     only_if { ::File.exists?(\"/var/lib/glance/glance-image-sync.py\") }\n     43:   end\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-hue.rb", "content": "privs = \"ALL\" # todo node[:bcpc][:hadoop][:hue_db_privs].join(\",\")", "line": 8, "detection_span": [3, 13], "with_context": "\n\nmake_config('mysql-hue-password', secure_password)\nmake_config('hue-session-key', secure_password)\n\nbash \"hue-database-creation\" do\n8:   privs = \"ALL\" # todo node[:bcpc][:hadoop][:hue_db_privs].join(\",\")\ncode <<-EOH\nmysql -u root -p#{get_config('mysql-root-password')} -e \"CREATE DATABASE desktop;\nGRANT #{privs} ON desktop.* TO 'hue'@'%' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\nGRANT #{privs} ON desktop.* TO 'hue'@'localhost' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\nFLUSH PRIVILEGES;\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-hue.rb\n# Target line: 8\n\n      3: \n      4: make_config('mysql-hue-password', secure_password)\n      5: make_config('hue-session-key', secure_password)\n      6: \n      7: bash \"hue-database-creation\" do\n>>>   8:   privs = \"ALL\" # todo node[:bcpc][:hadoop][:hue_db_privs].join(\",\")\n      9:   code <<-EOH\n     10:     mysql -u root -p#{get_config('mysql-root-password')} -e \"CREATE DATABASE desktop;\n     11:                                                              GRANT #{privs} ON desktop.* TO 'hue'@'%' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\n     12:                                                              GRANT #{privs} ON desktop.* TO 'hue'@'localhost' IDENTIFIED BY '#{get_config('mysql-hue-password')}';\n     13:                                                              FLUSH PRIVILEGES;\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-php-resources-pear_channel.rb", "content": "# TODO add authenticated channel support!", "line": 26, "detection_span": [21, 31], "with_context": "\nactions :discover, :add, :update, :remove\n\nattribute :channel_name, :kind_of => String, :name_attribute => true\nattribute :channel_xml, :kind_of => String\n\n26: # TODO add authenticated channel support!\n# attribute :username, :kind_of => String\n# attribute :password, :kind_of => String", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-php-resources-pear_channel.rb\n# Target line: 26\n\n     21: actions :discover, :add, :update, :remove\n     22: \n     23: attribute :channel_name, :kind_of => String, :name_attribute => true\n     24: attribute :channel_xml, :kind_of => String\n     25: \n>>>  26: # TODO add authenticated channel support!\n     27: # attribute :username, :kind_of => String\n     28: # attribute :password, :kind_of => String\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "FriendsOfCake_vagrant-chef-cookbooks-system-libraries-sane_logger.rb", "content": "# Previous|Cloning|Current... messages should go in the debug level", "line": 16, "detection_span": [11, 21], "with_context": "\nelse\nsuper\nend\nend\n\n16:     # Previous|Cloning|Current... messages should go in the debug level\ndef self.warn(msg=nil, &block)\nif msg =~ /^(Previous|Cloning|Current)/\ndebug(msg, &block)\nelse\nsuper", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: FriendsOfCake_vagrant-chef-cookbooks-system-libraries-sane_logger.rb\n# Target line: 16\n\n     11:       else\n     12:         super\n     13:       end\n     14:     end\n     15: \n>>>  16:     # Previous|Cloning|Current... messages should go in the debug level\n     17:     def self.warn(msg=nil, &block)\n     18:       if msg =~ /^(Previous|Cloning|Current)/\n     19:         debug(msg, &block)\n     20:       else\n     21:         super\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "gwalbran_chef-cookbooks-imos_jenkins-recipes-managed_master.rb", "content": "# Give jenkins permission to run sudo commands - TODO: remove the need for sudo in jobs", "line": 26, "detection_span": [21, 31], "with_context": "\nnode.set['jenkins']['master']['jvm_options'] = node['imos_jenkins']['master']['jvm_options']\n\ninclude_recipe 'jenkins::master'\ninclude_recipe 'imos_jenkins::keys'\n\n26: # Give jenkins permission to run sudo commands - TODO: remove the need for sudo in jobs\nsudo 'jenkins' do\ngroup 'jenkins'\nrunas    'ALL'\ncommands ['ALL']\nhost     'ALL'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_jenkins-recipes-managed_master.rb\n# Target line: 26\n\n     21: node.set['jenkins']['master']['jvm_options'] = node['imos_jenkins']['master']['jvm_options']\n     22: \n     23: include_recipe 'jenkins::master'\n     24: include_recipe 'imos_jenkins::keys'\n     25: \n>>>  26: # Give jenkins permission to run sudo commands - TODO: remove the need for sudo in jobs\n     27: sudo 'jenkins' do\n     28:   group 'jenkins'\n     29:   runas    'ALL'\n     30:   commands ['ALL']\n     31:   host     'ALL'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "logicalclocks_hops-hadoop-chef-recipes-format.rb", "content": "# it is ok if all namenodes format the fs. Unless you add a new one later..", "line": 4, "detection_span": [1, 9], "with_context": "\ninclude_recipe \"hops::default\"\nexec=node['ndb']['scripts_dir'] + \"/mysql-client.sh\"\n\n4: # it is ok if all namenodes format the fs. Unless you add a new one later..\n# if the nn has already been formatted, re-formatting it returns error\n# TODO: test if the NameNode is running\nif \"#{node['hops']['format']}\" === \"true\"\nif ::File.exist?(\"#{node['hops']['base_dir']}/.nn_formatted\") === false || \"#{node['hops']['reformat']}\" === \"true\"\nhops_ndb \"format-nn\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: logicalclocks_hops-hadoop-chef-recipes-format.rb\n# Target line: 4\n\n      1: include_recipe \"hops::default\"\n      2: exec=node['ndb']['scripts_dir'] + \"/mysql-client.sh\"\n      3: \n>>>   4: # it is ok if all namenodes format the fs. Unless you add a new one later..\n      5: # if the nn has already been formatted, re-formatting it returns error\n      6: # TODO: test if the NameNode is running\n      7: if \"#{node['hops']['format']}\" === \"true\"\n      8:   if ::File.exist?(\"#{node['hops']['base_dir']}/.nn_formatted\") === false || \"#{node['hops']['reformat']}\" === \"true\"\n      9:     hops_ndb \"format-nn\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb", "content": "# The environment variable 'network_id' defines a suffix for a network name when", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\nraise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\nunless ENV.key?('network_id')\n\n66: # The environment variable 'network_id' defines a suffix for a network name when\n# using this example. If running from the command line, you can pass this suffix\n# in via the command line:\n#\n# network_id=\"some_suffix\" chef-client -z --runlist \\\n#   \"recipe[gcompute::examples~network~auto]\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~network~convert_to_custom.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: raise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\n     64:   unless ENV.key?('network_id')\n     65: \n>>>  66: # The environment variable 'network_id' defines a suffix for a network name when\n     67: # using this example. If running from the command line, you can pass this suffix\n     68: # in via the command line:\n     69: #\n     70: # network_id=\"some_suffix\" chef-client -z --runlist \\\n     71: #   \"recipe[gcompute::examples~network~auto]\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-default.rb", "content": "# and a hack to use rubygems to find the current Ruby binary;", "line": 36, "detection_span": [31, 41], "with_context": "\n'docopy' => false\n}\n\n# ensure the Zookeeper Gem is available for use in later recipes\n# it seems chef_gem fails to use the embedded gem(1) binary so use gem_package\n36: # and a hack to use rubygems to find the current Ruby binary;\n# assume gem is in the same dir (valid for Chef 10, Chef 11 dpkg and Chef 11 Omnibus)\nrequire 'pathname'\nrequire 'rubygems'\ngem_path = Pathname.new(Gem.ruby).dirname.join(\"gem\").to_s\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-default.rb\n# Target line: 36\n\n     31:     'docopy' => false\n     32: }\n     33: \n     34: # ensure the Zookeeper Gem is available for use in later recipes\n     35: # it seems chef_gem fails to use the embedded gem(1) binary so use gem_package\n>>>  36: # and a hack to use rubygems to find the current Ruby binary;\n     37: # assume gem is in the same dir (valid for Chef 10, Chef 11 dpkg and Chef 11 Omnibus)\n     38: require 'pathname'\n     39: require 'rubygems'\n     40: gem_path = Pathname.new(Gem.ruby).dirname.join(\"gem\").to_s\n     41: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb", "content": "# Later roles can use the \"!merge:\" feature to knock it out", "line": 49, "detection_span": [44, 54], "with_context": "\n#       :package_set => {\n#         :install => %w[ base dev sysadmin ],\n#       }\n#     })\n#\n49: # Later roles can use the \"!merge:\" feature to knock it out\n#\ndefault[:package_set][:install]          = %w[ ]\n\n# --------------------------------------------------------------------------\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb\n# Target line: 49\n\n     44: #       :package_set => {\n     45: #         :install => %w[ base dev sysadmin ],\n     46: #       }\n     47: #     })\n     48: #\n>>>  49: # Later roles can use the \"!merge:\" feature to knock it out\n     50: #\n     51: default[:package_set][:install]          = %w[ ]\n     52: \n     53: # --------------------------------------------------------------------------\n     54: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-papertrail-cookbooks-mongodb-recipes-mongos.rb", "content": "# FIXME: Don't depend on EC2 (GH-10)", "line": 46, "detection_span": [41, 51], "with_context": "\nmode 0644\nbackup false\nend\n\nconfigdb_servers = search(:node, 'recipes:mongodb\\:\\:config_server')\n46: # FIXME: Don't depend on EC2 (GH-10)\nconfigdb_server_list = configdb_servers.collect { |x| x.ec2.local_hostname }.join(',')\n\ncase init_system\nwhen \"upstart\"\ntemplate \"/etc/init/mongos.conf\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-papertrail-cookbooks-mongodb-recipes-mongos.rb\n# Target line: 46\n\n     41:   mode 0644\n     42:   backup false\n     43: end\n     44: \n     45: configdb_servers = search(:node, 'recipes:mongodb\\:\\:config_server')\n>>>  46: # FIXME: Don't depend on EC2 (GH-10)\n     47: configdb_server_list = configdb_servers.collect { |x| x.ec2.local_hostname }.join(',')\n     48: \n     49: case init_system\n     50: when \"upstart\"\n     51:   template \"/etc/init/mongos.conf\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sensu_sensu-chef-recipes-_linux.rb", "content": "# As of 0.27 we need to suffix the version string with the platform major", "line": 56, "detection_span": [51, 61], "with_context": "\nuri \"#{node['sensu']['yum_repo_url']}/#{repo}/7/x86_64/\"\ngpgkey node['sensu']['yum_key_url']\nend\nrepo.gpgcheck(true) if repo.respond_to?(:gpgcheck)\n\n56:   # As of 0.27 we need to suffix the version string with the platform major\n# version, e.g. \".el7\". Override default via node[\"sensu\"][\"version_suffix\"]\n# attribute.\nzypper_package \"sensu\" do\nversion lazy { \"1:\" + Sensu::Helpers.redhat_version_string(\nnode[\"sensu\"][\"version\"],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sensu_sensu-chef-recipes-_linux.rb\n# Target line: 56\n\n     51:     uri \"#{node['sensu']['yum_repo_url']}/#{repo}/7/x86_64/\"\n     52:     gpgkey node['sensu']['yum_key_url']\n     53:   end\n     54:   repo.gpgcheck(true) if repo.respond_to?(:gpgcheck)\n     55: \n>>>  56:   # As of 0.27 we need to suffix the version string with the platform major\n     57:   # version, e.g. \".el7\". Override default via node[\"sensu\"][\"version_suffix\"]\n     58:   # attribute.\n     59:   zypper_package \"sensu\" do\n     60:     version lazy { \"1:\" + Sensu::Helpers.redhat_version_string(\n     61:       node[\"sensu\"][\"version\"],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_swap-recipes-before_fb_fstab.rb", "content": "# T39598868 Disabled until workaround or bug fix", "line": 100, "detection_span": [95, 105], "with_context": "\n'PartOf' => manage_unit,\n},\n# Stopping swap is pathologically slow on Linux today. The general\n# default for stopping units in systemd is 90s. Here we'll use\n# 100s per GiB as a heuristic on top of the default.\n100:               # T39598868 Disabled until workaround or bug fix\n# 'Service' => {\n#   'TimeoutStopSec' => 90 + 100 *\n#   (node['fb_swap']['_calculated'][\"#{@type}_size_bytes\"]\n#    / 2 ** 30),\n# }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_swap-recipes-before_fb_fstab.rb\n# Target line: 100\n\n     95:                 'PartOf' => manage_unit,\n     96:               },\n     97:               # Stopping swap is pathologically slow on Linux today. The general\n     98:               # default for stopping units in systemd is 90s. Here we'll use\n     99:               # 100s per GiB as a heuristic on top of the default.\n>>> 100:               # T39598868 Disabled until workaround or bug fix\n    101:               # 'Service' => {\n    102:               #   'TimeoutStopSec' => 90 + 100 *\n    103:               #   (node['fb_swap']['_calculated'][\"#{@type}_size_bytes\"]\n    104:               #    / 2 ** 30),\n    105:               # }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-cookbooks_aix-files-default-vendor-gems-aix-wpar-0.2.0-lib-wpars-network.rb", "content": "# <WPAR::Network name=\"kitchenwpar\", interface=\"en0\", address=\"10.10.10.100\", mask_prefix=\"255.255.255.0\", broadcast=\"10.10.10.255\">", "line": 4, "detection_span": [1, 9], "with_context": "\nrequire 'ostruct'\n\n#example of a WPAR network object\n4: # <WPAR::Network name=\"kitchenwpar\", interface=\"en0\", address=\"10.10.10.100\", mask_prefix=\"255.255.255.0\", broadcast=\"10.10.10.255\">\nmodule WPAR\nclass Network\nattr_reader :name\nattr_accessor :interface, :address, :mask_prefix, :broadcast\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_aix-files-default-vendor-gems-aix-wpar-0.2.0-lib-wpars-network.rb\n# Target line: 4\n\n      1: require 'ostruct'\n      2: \n      3: #example of a WPAR network object\n>>>   4: # <WPAR::Network name=\"kitchenwpar\", interface=\"en0\", address=\"10.10.10.100\", mask_prefix=\"255.255.255.0\", broadcast=\"10.10.10.255\">\n      5: module WPAR\n      6:   class Network\n      7:     attr_reader :name\n      8:     attr_accessor :interface, :address, :mask_prefix, :broadcast\n      9: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rackspace-cookbooks_phpstack-recipes-application_php.rb", "content": "# openssl devel packages are required for the mongo pecl module, issue #299", "line": 23, "detection_span": [18, 28], "with_context": "\n# limitations under the License.\n#\n\nstackname = 'phpstack'\n\n23: # openssl devel packages are required for the mongo pecl module, issue #299\n# plugin depends\nif platform_family?('rhel')\ninclude_recipe 'yum'\ninclude_recipe 'yum-epel'\ninclude_recipe 'yum-ius'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_phpstack-recipes-application_php.rb\n# Target line: 23\n\n     18: # limitations under the License.\n     19: #\n     20: \n     21: stackname = 'phpstack'\n     22: \n>>>  23: # openssl devel packages are required for the mongo pecl module, issue #299\n     24: # plugin depends\n     25: if platform_family?('rhel')\n     26:   include_recipe 'yum'\n     27:   include_recipe 'yum-epel'\n     28:   include_recipe 'yum-ius'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-openstack-common-libraries-cli.rb", "content": "# TODO: update openstack-identity register provider to use these functions.", "line": 109, "detection_span": [104, 114], "with_context": "\n104:   # @param [Hash] environment to use.\n105:   # @param [Hash] optional command argument/values pairs\n106:   # @param [String] optional uuid field to match\n107:   # @return [String] uuid or nil\n108:   #\n109:   # TODO: update openstack-identity register provider to use these functions.\n110:   #\n111:   def identity_uuid(*args)\nget_uuid('openstack', *args)\n113:   end\n114:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-common-libraries-cli.rb\n# Target line: 109\n\n    104:   # @param [Hash] environment to use.\n    105:   # @param [Hash] optional command argument/values pairs\n    106:   # @param [String] optional uuid field to match\n    107:   # @return [String] uuid or nil\n    108:   #\n>>> 109:   # TODO: update openstack-identity register provider to use these functions.\n    110:   #\n    111:   def identity_uuid(*args)\n    112:     get_uuid('openstack', *args)\n    113:   end\n    114: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb", "content": "# stub resolver. According to upstream this should replace the glibc \"dns\"", "line": 34, "detection_span": [29, 39], "with_context": "\n)\nnotifies :restart, 'service[systemd-resolved]'\nend\n\n# nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n34: # stub resolver. According to upstream this should replace the glibc \"dns\"\n# resolver and is required for systemd-resolved to work. This block attempts\n# to place the resolver between mymachines and myhostname as recommended by\n# upstream.\nruby_block 'enable nss-resolve' do\nonly_if { node['fb_systemd']['resolved']['enable'] }", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb\n# Target line: 34\n\n     29:   )\n     30:   notifies :restart, 'service[systemd-resolved]'\n     31: end\n     32: \n     33: # nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n>>>  34: # stub resolver. According to upstream this should replace the glibc \"dns\"\n     35: # resolver and is required for systemd-resolved to work. This block attempts\n     36: # to place the resolver between mymachines and myhostname as recommended by\n     37: # upstream.\n     38: ruby_block 'enable nss-resolve' do\n     39:   only_if { node['fb_systemd']['resolved']['enable'] }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb", "content": "# - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as", "line": 84, "detection_span": [79, 89], "with_context": "\nexecute 'install rally in virtualenv' do\nenvironment env\nretries 3\nuser 'rally'\n# Installation notes:\n84:   # - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n#     part of `pycryptodome` etc.\n# - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n# - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n#     templates containing macros. This change breaks rally tasks used\n#     internally by Bloomberg, which likely need to be fixed.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb\n# Target line: 84\n\n     79: execute 'install rally in virtualenv' do\n     80:   environment env\n     81:   retries 3\n     82:   user 'rally'\n     83:   # Installation notes:\n>>>  84:   # - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n     85:   #     part of `pycryptodome` etc.\n     86:   # - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n     87:   # - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n     88:   #     templates containing macros. This change breaks rally tasks used\n     89:   #     internally by Bloomberg, which likely need to be fixed.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb", "content": "# @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise", "line": 19, "detection_span": [14, 24], "with_context": "\n# Determines if a tag matches a given wildcard expression or prefix.\n#\n# @param [String] wildcard expression or prefix\n# @param [String] tag\n#\n19:       # @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise\ndef self.matches_tag_wildcard?(wildcard, tag)\nif wildcard =~ /^(#{NAMESPACE_REGEX}):$/\nwildcard = \"#{$1}:*\"\nelsif wildcard =~ /^(#{NAMESPACE_REGEX}):(#{PREDICATE_REGEX})=?$/\nwildcard = \"#{$1}:#{$2}=*\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-rightscale-libraries-helper.rb\n# Target line: 19\n\n     14:       # Determines if a tag matches a given wildcard expression or prefix.\n     15:       #\n     16:       # @param [String] wildcard expression or prefix\n     17:       # @param [String] tag\n     18:       #\n>>>  19:       # @return [Boolean] True if the tag matches the wildcard expression or prefix, false otherwise\n     20:       def self.matches_tag_wildcard?(wildcard, tag)\n     21:         if wildcard =~ /^(#{NAMESPACE_REGEX}):$/\n     22:           wildcard = \"#{$1}:*\"\n     23:         elsif wildcard =~ /^(#{NAMESPACE_REGEX}):(#{PREDICATE_REGEX})=?$/\n     24:           wildcard = \"#{$1}:#{$2}=*\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cdapio_hadoop_cookbook-recipes-spark2.rb", "content": "# TODO: /etc/spark2/conf.dist/fairscheduler.xml.template", "line": 60, "detection_span": [55, 65], "with_context": "\nmode '0755'\nrecursive true\naction :create\nend\n\n60: # TODO: /etc/spark2/conf.dist/fairscheduler.xml.template\n\nspark2_log_dir =\nif node['spark2'].key?('spark_env') && node['spark2']['spark_env'].key?('spark_log_dir')\nnode['spark2']['spark_env']['spark_log_dir']\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cdapio_hadoop_cookbook-recipes-spark2.rb\n# Target line: 60\n\n     55:   mode '0755'\n     56:   recursive true\n     57:   action :create\n     58: end\n     59: \n>>>  60: # TODO: /etc/spark2/conf.dist/fairscheduler.xml.template\n     61: \n     62: spark2_log_dir =\n     63:   if node['spark2'].key?('spark_env') && node['spark2']['spark_env'].key?('spark_log_dir')\n     64:     node['spark2']['spark_env']['spark_log_dir']\n     65:   else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb", "content": "# postdrop group and adds postfix user to it.", "line": 52, "detection_span": [47, 57], "with_context": "\nwhen 'omnios'\nmanifest_path = ::File.join(Chef::Config[:file_cache_path], 'manifest-postfix.xml')\n\n# we need to manage the postfix group and user\n# and then subscribe to the package install because it creates a\n52:   # postdrop group and adds postfix user to it.\ngroup 'postfix' do\nappend true\nend\n\nuser 'postfix' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-postfix-recipes-_common.rb\n# Target line: 52\n\n     47: when 'omnios'\n     48:   manifest_path = ::File.join(Chef::Config[:file_cache_path], 'manifest-postfix.xml')\n     49: \n     50:   # we need to manage the postfix group and user\n     51:   # and then subscribe to the package install because it creates a\n>>>  52:   # postdrop group and adds postfix user to it.\n     53:   group 'postfix' do\n     54:     append true\n     55:   end\n     56: \n     57:   user 'postfix' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-accounts.rb", "content": "# TODO: we might want to create groups only implictly defined", "line": 39, "detection_span": [34, 44], "with_context": "\nnode['chef_packages']['chef']['chef_root'] ==\n'/usr/lib/ruby/vendor_ruby'\nend\nend\n\n39:   # TODO: we might want to create groups only implictly defined\n#       from accounts...gid attributes but described in a databag\nbag = data_bag('localgroups') unless Chef::Config[:solo]\nnode['sys']['groups'].each do |name, grp|\nunless Chef::Config[:solo]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-accounts.rb\n# Target line: 39\n\n     34:       node['chef_packages']['chef']['chef_root'] ==\n     35:         '/usr/lib/ruby/vendor_ruby'\n     36:     end\n     37:   end\n     38: \n>>>  39:   # TODO: we might want to create groups only implictly defined\n     40:   #       from accounts...gid attributes but described in a databag\n     41:   bag = data_bag('localgroups') unless Chef::Config[:solo]\n     42:   node['sys']['groups'].each do |name, grp|\n     43:     unless Chef::Config[:solo]\n     44: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_swift-recipes-rsync.rb", "content": "# FIXME: chicken and egg", "line": 49, "detection_span": [44, 54], "with_context": "\nsource \"rsync.init\"\naction :create\nonly_if { platform?(%w{centos redhat scientific}) }\nend\n\n49: # FIXME: chicken and egg\ncase node[\"platform\"]\nwhen \"centos\",\"redhat\",\"fedora\"\n# enable rsyncd\nrsync_servicename = \"rsyncd\"\nservice \"rsyncd\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-recipes-rsync.rb\n# Target line: 49\n\n     44:   source \"rsync.init\"\n     45:   action :create\n     46:   only_if { platform?(%w{centos redhat scientific}) }\n     47: end\n     48: \n>>>  49: # FIXME: chicken and egg\n     50: case node[\"platform\"]\n     51: when \"centos\",\"redhat\",\"fedora\"\n     52:   # enable rsyncd\n     53:   rsync_servicename = \"rsyncd\"\n     54:   service \"rsyncd\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dedeepyaboyapati_chef-cookbooks-cookbooks-fb_swap-recipes-default.rb", "content": "# TODO(yangxia): Fix this (t20145202).", "line": 27, "detection_span": [22, 32], "with_context": "\nChef::Log.debug(\"fb_swap: Found swap device: #{base_swap_device}\")\n\nfstab_swap_uuid = FB::FbSwap.get_swap_uuid_from_fstab(node)\n\nif fstab_swap_uuid.nil? && node['fb_swap']['enable_encryption']\n27:   # TODO(yangxia): Fix this (t20145202).\nChef::Log.warn(\n'fb_swap: Encryption cannot be enabled for machines where /etc/fstab ' +\n'does not specify the UUID of the swap device. Proceeding without ' +\n'encrypting swap.',\n)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dedeepyaboyapati_chef-cookbooks-cookbooks-fb_swap-recipes-default.rb\n# Target line: 27\n\n     22: Chef::Log.debug(\"fb_swap: Found swap device: #{base_swap_device}\")\n     23: \n     24: fstab_swap_uuid = FB::FbSwap.get_swap_uuid_from_fstab(node)\n     25: \n     26: if fstab_swap_uuid.nil? && node['fb_swap']['enable_encryption']\n>>>  27:   # TODO(yangxia): Fix this (t20145202).\n     28:   Chef::Log.warn(\n     29:     'fb_swap: Encryption cannot be enabled for machines where /etc/fstab ' +\n     30:     'does not specify the UUID of the swap device. Proceeding without ' +\n     31:     'encrypting swap.',\n     32:   )\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_omnibus-recipes-_libffi.rb", "content": "# be required. https://github.com/ffi/ffi/pull/424#issuecomment-83935000", "line": 24, "detection_span": [19, 29], "with_context": "\n\n# We need libffi 3.2.1 on ppc64/ppc64le systems in order\n# for ruby ffi gem to get installed. Someday when ruby ffi\n# updates embedded libffi 3.2.1 and fixes its extension\n# build process to consume embedded libffi properly this wont\n24: # be required. https://github.com/ffi/ffi/pull/424#issuecomment-83935000\n\n# Include the common recipe\ninclude_recipe 'omnibus::_common'\n\nreturn unless ppc64? || ppc64le?", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_omnibus-recipes-_libffi.rb\n# Target line: 24\n\n     19: \n     20: # We need libffi 3.2.1 on ppc64/ppc64le systems in order\n     21: # for ruby ffi gem to get installed. Someday when ruby ffi\n     22: # updates embedded libffi 3.2.1 and fixes its extension\n     23: # build process to consume embedded libffi properly this wont\n>>>  24: # be required. https://github.com/ffi/ffi/pull/424#issuecomment-83935000\n     25: \n     26: # Include the common recipe\n     27: include_recipe 'omnibus::_common'\n     28: \n     29: return unless ppc64? || ppc64le?\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-nfs-cookbooks-elasticsearch-recipes-server.rb", "content": "## FIXME: Cannot use this syntax currently, see http://tickets.opscode.com/browse/CHEF-1994", "line": 58, "detection_span": [53, 63], "with_context": "\nrun_restart   false   # don't automatically start or restart daemons\nrun_state     node[:elasticsearch][:server][:run_state]\noptions       node[:elasticsearch]\nend\n\n58: ## FIXME: Cannot use this syntax currently, see http://tickets.opscode.com/browse/CHEF-1994\n# service \"elasticsearch\" do\n#   subscribes    \"template[/etc/elasticsearch/elasticsearch.yml]\"\n# end\n\n# TODO: split httpnode and datanode into separate components", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-nfs-cookbooks-elasticsearch-recipes-server.rb\n# Target line: 58\n\n     53:   run_restart   false   # don't automatically start or restart daemons\n     54:   run_state     node[:elasticsearch][:server][:run_state]\n     55:   options       node[:elasticsearch]\n     56: end\n     57: \n>>>  58: ## FIXME: Cannot use this syntax currently, see http://tickets.opscode.com/browse/CHEF-1994\n     59: # service \"elasticsearch\" do\n     60: #   subscribes    \"template[/etc/elasticsearch/elasticsearch.yml]\"\n     61: # end\n     62: \n     63: # TODO: split httpnode and datanode into separate components\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb", "content": "default[:elasticsearch][:java_heap_newgen]        = nil  # JVM MaxNewSize (expert-level) a NUMBER -- will be suffixed with 'm'", "line": 63, "detection_span": [58, 68], "with_context": "\n# Tunables\n#\n\ndefault[:elasticsearch][:java_home]               = \"/usr/lib/jvm/java-6-sun/jre\"     # sun java works way better for ES\ndefault[:elasticsearch][:java_heap_size_max]      = 1000 # a NUMBER -- will be suffixed with 'm'\n63: default[:elasticsearch][:java_heap_newgen]        = nil  # JVM MaxNewSize (expert-level) a NUMBER -- will be suffixed with 'm'\ndefault[:elasticsearch][:ulimit_mlock]            = nil  # locked memory limit -- set to unlimited to lock heap into memory on linux machines\n\ndefault[:elasticsearch][:default_replicas]        = 1    # replicas are in addition to the original, so 1 replica means 2 copies of each shard\ndefault[:elasticsearch][:default_shards]          = 12   # 12 shards per index * 2 replicas distributes evenly across 2, 3, 4, 6, 8, 12 or 24 nodes\ndefault[:elasticsearch][:flush_threshold_ops]     = 5000", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-elasticsearch-attributes-default.rb\n# Target line: 63\n\n     58: # Tunables\n     59: #\n     60: \n     61: default[:elasticsearch][:java_home]               = \"/usr/lib/jvm/java-6-sun/jre\"     # sun java works way better for ES\n     62: default[:elasticsearch][:java_heap_size_max]      = 1000 # a NUMBER -- will be suffixed with 'm'\n>>>  63: default[:elasticsearch][:java_heap_newgen]        = nil  # JVM MaxNewSize (expert-level) a NUMBER -- will be suffixed with 'm'\n     64: default[:elasticsearch][:ulimit_mlock]            = nil  # locked memory limit -- set to unlimited to lock heap into memory on linux machines\n     65: \n     66: default[:elasticsearch][:default_replicas]        = 1    # replicas are in addition to the original, so 1 replica means 2 copies of each shard\n     67: default[:elasticsearch][:default_shards]          = 12   # 12 shards per index * 2 replicas distributes evenly across 2, 3, 4, 6, 8, 12 or 24 nodes\n     68: default[:elasticsearch][:flush_threshold_ops]     = 5000\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_delivery-truck-recipes-provision.rb", "content": "# TODO: This is a temporary workaround; ultimately, this should be", "line": 18, "detection_span": [13, 23], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n18: # TODO: This is a temporary workaround; ultimately, this should be\n# handled either by delivery_build or (preferably) the server itself.\nruby_block 'copy env from prior to current' do\nblock do\nwith_server_config do\nstage_name = node['delivery']['change']['stage']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_delivery-truck-recipes-provision.rb\n# Target line: 18\n\n     13: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     14: # See the License for the specific language governing permissions and\n     15: # limitations under the License.\n     16: #\n     17: \n>>>  18: # TODO: This is a temporary workaround; ultimately, this should be\n     19: # handled either by delivery_build or (preferably) the server itself.\n     20: ruby_block 'copy env from prior to current' do\n     21:   block do\n     22:     with_server_config do\n     23:       stage_name = node['delivery']['change']['stage']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb", "content": "# default['cloudify']['properties']['debug_mode'] = true", "line": 41, "detection_span": [36, 46], "with_context": "\n#\n# Additional ssh key that should be added to deployment service user\n# default['cloudify']['properties']['ssh_key'] = ''\n#\n# Install service in debug mode\n41: # default['cloudify']['properties']['debug_mode'] = true\n#\n# Source tarball for service files\n# default['cloudify']['properties']['sources'] =\n#   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-attributes-default.rb\n# Target line: 41\n\n     36: #\n     37: # Additional ssh key that should be added to deployment service user\n     38: # default['cloudify']['properties']['ssh_key'] = ''\n     39: #\n     40: # Install service in debug mode\n>>>  41: # default['cloudify']['properties']['debug_mode'] = true\n     42: #\n     43: # Source tarball for service files\n     44: # default['cloudify']['properties']['sources'] =\n     45: #   'https://github.com/dice-project/DICE-Deployment-Service/archive/develop.tar.gz'\n     46: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Nikhil424_chef-repo-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-resource.rb", "content": "# if !Chef::ResourceResolver.includes_handler?(name, self)", "line": 141, "detection_span": [136, 146], "with_context": "\nif name\nname = name.to_sym\n# If our class is not already providing this name, provide it.\n# Commented out: use of resource_name and provides will need to be\n# mutually exclusive in this world, generally.\n141:             # if !Chef::ResourceResolver.includes_handler?(name, self)\nprovides name#, canonical: true\n# end\n@resource_name = name\nelse\n@resource_name = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-resource.rb\n# Target line: 141\n\n    136:           if name\n    137:             name = name.to_sym\n    138:             # If our class is not already providing this name, provide it.\n    139:             # Commented out: use of resource_name and provides will need to be\n    140:             # mutually exclusive in this world, generally.\n>>> 141:             # if !Chef::ResourceResolver.includes_handler?(name, self)\n    142:               provides name#, canonical: true\n    143:             # end\n    144:             @resource_name = name\n    145:           else\n    146:             @resource_name = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_nova-recipes-nova-volume-multipath-patches.rb", "content": "# lp: https://bugs.launchpad.net/nova/+bug/1180497", "line": 32, "detection_span": [27, 37], "with_context": "\ngroup \"root\"\nmode \"0644\"\nnotifies :restart, \"service[nova-compute]\", :delayed\nend\n\n32: # lp: https://bugs.launchpad.net/nova/+bug/1180497\n# FC attach code doesn't discover multipath service\ntemplate \"/usr/share/pyshared/nova/storage/linuxscsi.py\" do\nsource \"patches/linuxscsi.py.multipath_missing_device_name.4933c15575589ea5877694b6fd874c9893f54d75.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-volume-multipath-patches.rb\n# Target line: 32\n\n     27:   group \"root\"\n     28:   mode \"0644\"\n     29:   notifies :restart, \"service[nova-compute]\", :delayed\n     30: end\n     31: \n>>>  32: # lp: https://bugs.launchpad.net/nova/+bug/1180497\n     33: # FC attach code doesn't discover multipath service\n     34: template \"/usr/share/pyshared/nova/storage/linuxscsi.py\" do\n     35:   source \"patches/linuxscsi.py.multipath_missing_device_name.4933c15575589ea5877694b6fd874c9893f54d75.erb\"\n     36:   owner \"root\"\n     37:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb", "content": "#     part of `pycryptodome` etc.", "line": 85, "detection_span": [80, 90], "with_context": "\nenvironment env\nretries 3\nuser 'rally'\n# Installation notes:\n# - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n85:   #     part of `pycryptodome` etc.\n# - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n# - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n#     templates containing macros. This change breaks rally tasks used\n#     internally by Bloomberg, which likely need to be fixed.\ncommand <<-EOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-rally.rb\n# Target line: 85\n\n     80:   environment env\n     81:   retries 3\n     82:   user 'rally'\n     83:   # Installation notes:\n     84:   # - 'pip' is pinned to avoid issues when installing `cryptography>3.4` as\n>>>  85:   #     part of `pycryptodome` etc.\n     86:   # - 'decorator' is pinned due to https://bugs.launchpad.net/rally/+bug/1922707\n     87:   # - 'jinja2' is pinned due to a change in how 3.0.0+ handles variables set in\n     88:   #     templates containing macros. This change breaks rally tasks used\n     89:   #     internally by Bloomberg, which likely need to be fixed.\n     90:   command <<-EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-dds.rb", "content": "# Ugly fix for npm stupidity (https://github.com/npm/npm/issues/20191)", "line": 50, "detection_span": [45, 55], "with_context": "\nlink '/usr/bin/node' do\nto '/usr/bin/nodejs'\nnot_if { ::File.file?('/usr/bin/node') }\nend\n\n50: # Ugly fix for npm stupidity (https://github.com/npm/npm/issues/20191)\nexecute 'Disable strict ssl checking in npm' do\ncommand 'npm config set strict-ssl false'\nend\n\n# Install dice deployment service files", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-dds.rb\n# Target line: 50\n\n     45: link '/usr/bin/node' do\n     46:   to '/usr/bin/nodejs'\n     47:   not_if { ::File.file?('/usr/bin/node') }\n     48: end\n     49: \n>>>  50: # Ugly fix for npm stupidity (https://github.com/npm/npm/issues/20191)\n     51: execute 'Disable strict ssl checking in npm' do\n     52:   command 'npm config set strict-ssl false'\n     53: end\n     54: \n     55: # Install dice deployment service files\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-archive-files-halite_gem-poise_archive-archive_providers-base.rb", "content": "# TODO handle cookbook:// for cookbook_file \"downloads\".", "line": 83, "detection_span": [78, 88], "with_context": "\n# @return [Chef::Resource]\ndef download_file\n# resource_state used for closure breaking on the notifying block.\nresource_state = []\nnotifying_block do\n83:           # TODO handle cookbook:// for cookbook_file \"downloads\".\nresource_state << remote_file(new_resource.absolute_path) do\nsource new_resource.path\nretries 5 # As a default, could be overridden by source_properties.\nnew_resource.merged_source_properties.each do |key, value|\nsend(key, value)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-archive-files-halite_gem-poise_archive-archive_providers-base.rb\n# Target line: 83\n\n     78:       # @return [Chef::Resource]\n     79:       def download_file\n     80:         # resource_state used for closure breaking on the notifying block.\n     81:         resource_state = []\n     82:         notifying_block do\n>>>  83:           # TODO handle cookbook:// for cookbook_file \"downloads\".\n     84:           resource_state << remote_file(new_resource.absolute_path) do\n     85:             source new_resource.path\n     86:             retries 5 # As a default, could be overridden by source_properties.\n     87:             new_resource.merged_source_properties.each do |key, value|\n     88:               send(key, value)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-ingestion-ng-recipes-default.rb", "content": "# FIXME brittle and inelegant check for web.db", "line": 122, "detection_span": [117, 127], "with_context": "\nend\nexecute \"setup-web-db\" do\nuser node[:ingestion_ng][:user]\ngroup node[:ingestion_ng][:group]\ncwd \"#{node[:ingestion_ng][:deploy_path]}/current/#{node[:ingestion_ng][:apps]}\"\n122:           # FIXME brittle and inelegant check for web.db\ncommand <<-EOH\n. #{venv_activate}\nexport INGESTION_PROJECT_ROOT=#{ingestion_root} && export CELERY_CONFIG=#{celery_config}\n[ -s #{node[:ingestion_ng][:var]}/web.db ] || init_web_db\nEOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-ingestion-ng-recipes-default.rb\n# Target line: 122\n\n    117:         end\n    118:         execute \"setup-web-db\" do\n    119:           user node[:ingestion_ng][:user]\n    120:           group node[:ingestion_ng][:group]\n    121:           cwd \"#{node[:ingestion_ng][:deploy_path]}/current/#{node[:ingestion_ng][:apps]}\"\n>>> 122:           # FIXME brittle and inelegant check for web.db\n    123:           command <<-EOH\n    124:           . #{venv_activate}\n    125:           export INGESTION_PROJECT_ROOT=#{ingestion_root} && export CELERY_CONFIG=#{celery_config}\n    126:           [ -s #{node[:ingestion_ng][:var]}/web.db ] || init_web_db\n    127:           EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danielladd_Chef-Testing-cookbooks-php-recipes-package.rb", "content": "# http://pear.php.net/bugs/bug.php?id=16644", "line": 39, "detection_span": [34, 44], "with_context": "\nADDLOCAL=#{node['php']['packages'].join(',')}\n].join(' ')\nend\n\n# WARNING: This is not the out-of-the-box go-pear.phar. It's been modified to patch this bug:\n39:   # http://pear.php.net/bugs/bug.php?id=16644\ncookbook_file \"#{node['php']['conf_dir']}/PEAR/go-pear.phar\" do\nsource 'go-pear.phar'\nend\n\ntemplate \"#{node['php']['conf_dir']}/pear-options\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-php-recipes-package.rb\n# Target line: 39\n\n     34:           ADDLOCAL=#{node['php']['packages'].join(',')}\n     35:     ].join(' ')\n     36:   end\n     37: \n     38:   # WARNING: This is not the out-of-the-box go-pear.phar. It's been modified to patch this bug:\n>>>  39:   # http://pear.php.net/bugs/bug.php?id=16644\n     40:   cookbook_file \"#{node['php']['conf_dir']}/PEAR/go-pear.phar\" do\n     41:     source 'go-pear.phar'\n     42:   end\n     43: \n     44:   template \"#{node['php']['conf_dir']}/pear-options\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "xdv-staging_chef-os-hardening-recipes-sysctl.rb", "content": "# TODO: This is deprecated. Remove after sysctl >= 0.6.0", "line": 94, "detection_span": [89, 99], "with_context": "\nend\nend\nend\n\n# Conditional handling of procps reload\n94: # TODO: This is deprecated. Remove after sysctl >= 0.6.0\n# ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\nif cookbook_version('sysctl', '< 0.6.0') # ~FC023\ncase node['platform_family']\nwhen 'debian'\nservice_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: xdv-staging_chef-os-hardening-recipes-sysctl.rb\n# Target line: 94\n\n     89:     end\n     90:   end\n     91: end\n     92: \n     93: # Conditional handling of procps reload\n>>>  94: # TODO: This is deprecated. Remove after sysctl >= 0.6.0\n     95: # ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\n     96: if cookbook_version('sysctl', '< 0.6.0') # ~FC023\n     97:   case node['platform_family']\n     98:   when 'debian'\n     99:     service_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-default.rb", "content": "# debugging process crashes", "line": 32, "detection_span": [27, 37], "with_context": "\n\n###############################################################################\n# misc settings\n###############################################################################\n\n32: # debugging process crashes\ndefault['bcpc']['apport']['enabled'] = true\n\n# enable/disable trusted platform module\ndefault['bcpc']['tpm']['enabled'] = true\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-default.rb\n# Target line: 32\n\n     27: \n     28: ###############################################################################\n     29: # misc settings\n     30: ###############################################################################\n     31: \n>>>  32: # debugging process crashes\n     33: default['bcpc']['apport']['enabled'] = true\n     34: \n     35: # enable/disable trusted platform module\n     36: default['bcpc']['tpm']['enabled'] = true\n     37: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['rpmverbosity'] = nil # %w{ info critical# emergency error warn debug }", "line": 88, "detection_span": [83, 93], "with_context": "\ndefault['yum']['main']['password'] = nil #  /.*/\ndefault['yum']['main']['recent'] = nil # /^\\d+$/\ndefault['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['reposdir'] = nil #  /.*/\ndefault['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]\n88: default['yum']['main']['rpmverbosity'] = nil # %w{ info critical# emergency error warn debug }\ndefault['yum']['main']['showdupesfromrepos'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['skip_broken'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['ssl_check_cert_permissions'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['sslcacert'] = nil # /.*/\ndefault['yum']['main']['sslclientcert'] = nil # /.*/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb\n# Target line: 88\n\n     83: default['yum']['main']['password'] = nil #  /.*/\n     84: default['yum']['main']['recent'] = nil # /^\\d+$/\n     85: default['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\n     86: default['yum']['main']['reposdir'] = nil #  /.*/\n     87: default['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]\n>>>  88: default['yum']['main']['rpmverbosity'] = nil # %w{ info critical# emergency error warn debug }\n     89: default['yum']['main']['showdupesfromrepos'] = nil # [TrueClass, FalseClass]\n     90: default['yum']['main']['skip_broken'] = nil # [TrueClass, FalseClass]\n     91: default['yum']['main']['ssl_check_cert_permissions'] = nil # [TrueClass, FalseClass]\n     92: default['yum']['main']['sslcacert'] = nil # /.*/\n     93: default['yum']['main']['sslclientcert'] = nil # /.*/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dedeepyaboyapati_chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb", "content": "# nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching", "line": 27, "detection_span": [22, 32], "with_context": "\n:section => 'Resolve',\n)\nnotifies :restart, 'service[systemd-resolved]'\nend\n\n27: # nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n# stub resolver. According to upstream this should replace the glibc \"dns\"\n# resolver and is required for systemd-resolved to work. This block attempts\n# to place the resolver between mymachines and myhostname as recommended by\n# upstream.\nruby_block 'enable nss-resolve' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dedeepyaboyapati_chef-cookbooks-cookbooks-fb_systemd-recipes-resolved.rb\n# Target line: 27\n\n     22:     :section => 'Resolve',\n     23:   )\n     24:   notifies :restart, 'service[systemd-resolved]'\n     25: end\n     26: \n>>>  27: # nss-resolve enables DNS resolution via the systemd-resolved DNS/LLMNR caching\n     28: # stub resolver. According to upstream this should replace the glibc \"dns\"\n     29: # resolver and is required for systemd-resolved to work. This block attempts\n     30: # to place the resolver between mymachines and myhostname as recommended by\n     31: # upstream.\n     32: ruby_block 'enable nss-resolve' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-install_from-resources-release.rb", "content": "# Directory for the unreleased contents,   eg /usr/local/share/pig-0.8.0. default: {prefix_root}/share/{name}-#{version}", "line": 53, "detection_span": [48, 58], "with_context": "\nattribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n\n# version slug, appended to the name to get the install_dir\nattribute :version,       :kind_of => String, :required => true\n\n53: # Directory for the unreleased contents,   eg /usr/local/share/pig-0.8.0. default: {prefix_root}/share/{name}-#{version}\nattribute :install_dir,   :kind_of => String\n\n# Directory as the project is referred to, eg /usr/local/share/pig. default: {prefix_root}/share/{name}\nattribute :home_dir,      :kind_of => String\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-install_from-resources-release.rb\n# Target line: 53\n\n     48: attribute :prefix_root,   :kind_of => String, :default  => '/usr/local'\n     49: \n     50: # version slug, appended to the name to get the install_dir\n     51: attribute :version,       :kind_of => String, :required => true\n     52: \n>>>  53: # Directory for the unreleased contents,   eg /usr/local/share/pig-0.8.0. default: {prefix_root}/share/{name}-#{version}\n     54: attribute :install_dir,   :kind_of => String\n     55: \n     56: # Directory as the project is referred to, eg /usr/local/share/pig. default: {prefix_root}/share/{name}\n     57: attribute :home_dir,      :kind_of => String\n     58: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_omnibus-recipes-_git.rb", "content": "# ca bundle that ships in the package. This can most likely be fixed by", "line": 58, "detection_span": [53, 63], "with_context": "\n\n# Provided by the omnibus-toolchain package\nunless windows?\n\n# We need to configure the omnibus-toolchain's embedded git to use\n58:   # ca bundle that ships in the package. This can most likely be fixed by\n# a well placed `./configure` option when compiling git.\n#\nexecute \"/opt/#{node['omnibus']['toolchain_name']}/bin/git config --global http.sslCAinfo /opt/#{node['omnibus']['toolchain_name']}/embedded/ssl/certs/cacert.pem\" do\nenvironment(\n'HOME' => build_user_home", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_omnibus-recipes-_git.rb\n# Target line: 58\n\n     53: \n     54: # Provided by the omnibus-toolchain package\n     55: unless windows?\n     56: \n     57:   # We need to configure the omnibus-toolchain's embedded git to use\n>>>  58:   # ca bundle that ships in the package. This can most likely be fixed by\n     59:   # a well placed `./configure` option when compiling git.\n     60:   #\n     61:   execute \"/opt/#{node['omnibus']['toolchain_name']}/bin/git config --global http.sslCAinfo /opt/#{node['omnibus']['toolchain_name']}/embedded/ssl/certs/cacert.pem\" do\n     62:     environment(\n     63:       'HOME' => build_user_home\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sabarisankar27_chef-acceptance-top-cookbooks-.acceptance-acceptance-cookbook-libraries-cookbook_kitchen.rb", "content": "# TODO Grab the source URL from supermarket", "line": 34, "detection_span": [29, 39], "with_context": "\ndirectory ::File.expand_path(\"..\", repository_root) do\nrecursive true\nend\n\n# Grab the cookbook\n34:     # TODO Grab the source URL from supermarket\n# TODO get git to include its kitchen tests in the cookbook.\ngit repository_root do\nrepository new_resource.repository\nbranch new_resource.branch\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sabarisankar27_chef-acceptance-top-cookbooks-.acceptance-acceptance-cookbook-libraries-cookbook_kitchen.rb\n# Target line: 34\n\n     29:     directory ::File.expand_path(\"..\", repository_root) do\n     30:       recursive true\n     31:     end\n     32: \n     33:     # Grab the cookbook\n>>>  34:     # TODO Grab the source URL from supermarket\n     35:     # TODO get git to include its kitchen tests in the cookbook.\n     36:     git repository_root do\n     37:       repository new_resource.repository\n     38:       branch new_resource.branch\n     39:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sous-chefs_postfix-recipes-default.rb", "content": "# Cookbook:: postfix", "line": 2, "detection_span": [1, 7], "with_context": "\n# Author:: Joshua Timberman(<joshua@chef.io>)\n2: # Cookbook:: postfix\n# Recipe:: default\n#\n# Copyright:: 2009-2019, Chef Software, Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sous-chefs_postfix-recipes-default.rb\n# Target line: 2\n\n      1: # Author:: Joshua Timberman(<joshua@chef.io>)\n>>>   2: # Cookbook:: postfix\n      3: # Recipe:: default\n      4: #\n      5: # Copyright:: 2009-2019, Chef Software, Inc.\n      6: #\n      7: # Licensed under the Apache License, Version 2.0 (the \"License\");\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "eaton_vagrant-chef-dlamp-cookbooks-drupal-cookbooks-drupal-recipes-example.rb", "content": "# TODO: Break this out into a vagrant only cookbook? (name: \"drupal-vagrant\")", "line": 16, "detection_span": [11, 21], "with_context": "\n\"GRANT ALL PRIVILEGES ON *.* TO 'myadmin'@'%' IDENTIFIED BY 'myadmin' WITH GRANT OPTION;\\\" \" +\n\"mysql\"\naction :run\nend\n\n16: # TODO: Break this out into a vagrant only cookbook? (name: \"drupal-vagrant\")\n# create a drupal db\nexecute \"add-drupal-db\" do\ncommand \"/usr/bin/mysql -u root -p#{node[:mysql][:server_root_password]} -e \\\"\" +\n\"CREATE DATABASE drupal;\\\"\"\naction :run", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: eaton_vagrant-chef-dlamp-cookbooks-drupal-cookbooks-drupal-recipes-example.rb\n# Target line: 16\n\n     11:       \"GRANT ALL PRIVILEGES ON *.* TO 'myadmin'@'%' IDENTIFIED BY 'myadmin' WITH GRANT OPTION;\\\" \" +\n     12:       \"mysql\"\n     13:   action :run\n     14: end\n     15: \n>>>  16: # TODO: Break this out into a vagrant only cookbook? (name: \"drupal-vagrant\")\n     17: # create a drupal db\n     18: execute \"add-drupal-db\" do\n     19:   command \"/usr/bin/mysql -u root -p#{node[:mysql][:server_root_password]} -e \\\"\" +\n     20:       \"CREATE DATABASE drupal;\\\"\"\n     21:   action :run\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-cookbooks_chef-ingredient-resources-automatev2.rb", "content": "## TODO: add dependancy on sysctl cookbook unless chef-client v14.0+", "line": 35, "detection_span": [30, 40], "with_context": "\ncwd '/usr/local/bin'\ncreates '/usr/local/bin/chef-automate'\nnot_if { FileTest.file?('/usr/bin/chef-automate') }\nend\n\n35:   ## TODO: add dependancy on sysctl cookbook unless chef-client v14.0+\nsysctl 'vm.max_map_count' do\nvalue 262144\nend\n\nsysctl 'vm.dirty_expire_centisecs' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_chef-ingredient-resources-automatev2.rb\n# Target line: 35\n\n     30:     cwd '/usr/local/bin'\n     31:     creates '/usr/local/bin/chef-automate'\n     32:     not_if { FileTest.file?('/usr/bin/chef-automate') }\n     33:   end\n     34: \n>>>  35:   ## TODO: add dependancy on sysctl cookbook unless chef-client v14.0+\n     36:   sysctl 'vm.max_map_count' do\n     37:     value 262144\n     38:   end\n     39: \n     40:   sysctl 'vm.dirty_expire_centisecs' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "xdv-staging_chef-os-hardening-recipes-sysctl.rb", "content": "# ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151", "line": 95, "detection_span": [90, 100], "with_context": "\nend\nend\n\n# Conditional handling of procps reload\n# TODO: This is deprecated. Remove after sysctl >= 0.6.0\n95: # ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\nif cookbook_version('sysctl', '< 0.6.0') # ~FC023\ncase node['platform_family']\nwhen 'debian'\nservice_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil\nservice 'procps' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: xdv-staging_chef-os-hardening-recipes-sysctl.rb\n# Target line: 95\n\n     90:   end\n     91: end\n     92: \n     93: # Conditional handling of procps reload\n     94: # TODO: This is deprecated. Remove after sysctl >= 0.6.0\n>>>  95: # ignore FC023: @see https://github.com/acrmp/foodcritic/issues/151\n     96: if cookbook_version('sysctl', '< 0.6.0') # ~FC023\n     97:   case node['platform_family']\n     98:   when 'debian'\n     99:     service_provider = node['platform'] == 'ubuntu' ? Chef::Provider::Service::Upstart : nil\n    100:     service 'procps' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_windows.rb", "content": "# TODO: make install location configurable", "line": 16, "detection_span": [11, 21], "with_context": "\n# and on OS X did 'shasum -a 256 newrelic-infra.msi' YMMV on other\n# platforms. It'd be *really* cool if NewRelic could provide an API\n# that you could ask for checksum values, or have checksums published\n# and available in some other way.\n#\n16: # TODO: make install location configurable\n\nwindows_package 'newrelic-infra' do\naction :install\nchecksum node['newrelic-infra']['windows_checksum']\ninstaller_type :msi", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_windows.rb\n# Target line: 16\n\n     11: # and on OS X did 'shasum -a 256 newrelic-infra.msi' YMMV on other\n     12: # platforms. It'd be *really* cool if NewRelic could provide an API\n     13: # that you could ask for checksum values, or have checksums published\n     14: # and available in some other way.\n     15: #\n>>>  16: # TODO: make install location configurable\n     17: \n     18: windows_package 'newrelic-infra' do\n     19:   action :install\n     20:   checksum node['newrelic-infra']['windows_checksum']\n     21:   installer_type :msi\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fzylogic_nova-recipes-nova-common.rb", "content": "# TODO: need to re-evaluate this for accuracy", "line": 69, "detection_span": [64, 74], "with_context": "\nChef::Log.debug(\"nova::nova-common:novnc_proxy_endpoint|#{novnc_proxy_endpoint}\")\nChef::Log.debug(\"nova::nova-common:glance_endpoint|#{glance_endpoint}\")\nChef::Log.debug(\"nova::nova-common:nova_api_endpoint|#{nova_api_endpoint}\")\nChef::Log.debug(\"nova::nova-common:ec2_public_endpoint|#{ec2_public_endpoint}\")\n\n69: # TODO: need to re-evaluate this for accuracy\ntemplate \"/etc/nova/nova.conf\" do\nsource \"nova.conf.erb\"\nowner \"root\"\ngroup \"root\"\nmode \"0644\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fzylogic_nova-recipes-nova-common.rb\n# Target line: 69\n\n     64: Chef::Log.debug(\"nova::nova-common:novnc_proxy_endpoint|#{novnc_proxy_endpoint}\")\n     65: Chef::Log.debug(\"nova::nova-common:glance_endpoint|#{glance_endpoint}\")\n     66: Chef::Log.debug(\"nova::nova-common:nova_api_endpoint|#{nova_api_endpoint}\")\n     67: Chef::Log.debug(\"nova::nova-common:ec2_public_endpoint|#{ec2_public_endpoint}\")\n     68: \n>>>  69: # TODO: need to re-evaluate this for accuracy\n     70: template \"/etc/nova/nova.conf\" do\n     71:   source \"nova.conf.erb\"\n     72:   owner \"root\"\n     73:   group \"root\"\n     74:   mode \"0644\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-recipe.rb", "content": "# TODO: Duplicates functionality of RunListItem", "line": 52, "detection_span": [47, 57], "with_context": "\n# For example:\n#   \"aws::elastic_ip\" returns [:aws, \"elastic_ip\"]\n#   \"aws\" returns [:aws, \"default\"]\n#   \"::elastic_ip\" returns [ current_cookbook, \"elastic_ip\" ]\n#--\n52:     # TODO: Duplicates functionality of RunListItem\ndef self.parse_recipe_name(recipe_name, current_cookbook: nil)\ncase recipe_name\nwhen /(.+?)::(.+)/\n[ $1.to_sym, $2 ]\nwhen /^::(.+)/", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-compat_resource-files-lib-chef_compat-monkeypatches-chef-recipe.rb\n# Target line: 52\n\n     47:     # For example:\n     48:     #   \"aws::elastic_ip\" returns [:aws, \"elastic_ip\"]\n     49:     #   \"aws\" returns [:aws, \"default\"]\n     50:     #   \"::elastic_ip\" returns [ current_cookbook, \"elastic_ip\" ]\n     51:     #--\n>>>  52:     # TODO: Duplicates functionality of RunListItem\n     53:     def self.parse_recipe_name(recipe_name, current_cookbook: nil)\n     54:       case recipe_name\n     55:       when /(.+?)::(.+)/\n     56:         [ $1.to_sym, $2 ]\n     57:       when /^::(.+)/\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "krishnajadhav_chef-apache2-recipes-mod_log_debug.rb", "content": "# Recipe:: mod_log_debug", "line": 3, "detection_span": [1, 8], "with_context": "\n#\n# Cookbook:: apache2\n3: # Recipe:: mod_log_debug\n#\n# Copyright:: 2013, OneHealth Solutions, Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: krishnajadhav_chef-apache2-recipes-mod_log_debug.rb\n# Target line: 3\n\n      1: #\n      2: # Cookbook:: apache2\n>>>   3: # Recipe:: mod_log_debug\n      4: #\n      5: # Copyright:: 2013, OneHealth Solutions, Inc.\n      6: #\n      7: # Licensed under the Apache License, Version 2.0 (the \"License\");\n      8: # you may not use this file except in compliance with the License.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Nikhil424_chef-repo-cookbooks-compat_resource-libraries-autoload.rb", "content": "# on any chef client later than the one we were based off of we just turn into a no-op", "line": 16, "detection_span": [11, 21], "with_context": "\nend\n\n# we want to not pollute the libpath with our files until after we've done the version check\nrequire_relative '../files/lib/chef_upstream_version'\n\n16: # on any chef client later than the one we were based off of we just turn into a no-op\nif Gem::Requirement.new(\"< #{ChefCompat::CHEF_UPSTREAM_VERSION}\").satisfied_by?(Gem::Version.new(Chef::VERSION))\nChef::Log.debug \"loading compat_resource based on chef-version #{ChefCompat::CHEF_UPSTREAM_VERSION} over chef version #{Gem::Version.new(Chef::VERSION)}\"\n$LOAD_PATH.unshift(File.expand_path(\"../files/lib\", File.dirname(__FILE__)))\nrequire 'compat_resource'\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-compat_resource-libraries-autoload.rb\n# Target line: 16\n\n     11: end\n     12: \n     13: # we want to not pollute the libpath with our files until after we've done the version check\n     14: require_relative '../files/lib/chef_upstream_version'\n     15: \n>>>  16: # on any chef client later than the one we were based off of we just turn into a no-op\n     17: if Gem::Requirement.new(\"< #{ChefCompat::CHEF_UPSTREAM_VERSION}\").satisfied_by?(Gem::Version.new(Chef::VERSION))\n     18:   Chef::Log.debug \"loading compat_resource based on chef-version #{ChefCompat::CHEF_UPSTREAM_VERSION} over chef version #{Gem::Version.new(Chef::VERSION)}\"\n     19:   $LOAD_PATH.unshift(File.expand_path(\"../files/lib\", File.dirname(__FILE__)))\n     20:   require 'compat_resource'\n     21: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-chef-server-2.0-recipes-default.rb", "content": "not_if { Resolv.getaddress(node['chef-server']['api_fqdn']) rescue false } # host resolves", "line": 96, "detection_span": [91, 101], "with_context": "\nfe = Chef::Util::FileEdit.new(\"/etc/hosts\")\nfe.insert_line_if_no_match(/#{node['chef-server']['api_fqdn']}/,\n\"127.0.0.1 #{node['chef-server']['api_fqdn']}\")\nfe.write_file\nend\n96:   not_if { Resolv.getaddress(node['chef-server']['api_fqdn']) rescue false } # host resolves\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-chef-server-2.0-recipes-default.rb\n# Target line: 96\n\n     91:     fe = Chef::Util::FileEdit.new(\"/etc/hosts\")\n     92:     fe.insert_line_if_no_match(/#{node['chef-server']['api_fqdn']}/,\n     93:                                \"127.0.0.1 #{node['chef-server']['api_fqdn']}\")\n     94:     fe.write_file\n     95:   end\n>>>  96:   not_if { Resolv.getaddress(node['chef-server']['api_fqdn']) rescue false } # host resolves\n     97: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-config.rb", "content": "# TODO: Provide an API for getting this information", "line": 36, "detection_span": [31, 41], "with_context": "\n# ['previous_run']['foo']['bar'].\n#\n# Take care to check that ['previous_run'] exists, though, otherwise\n# you'll run into trouble doing the initial Chef run.\n#\n36:   # TODO: Provide an API for getting this information\nnode.consume_attributes({\"previous_run\" => old_config['private_chef']})\nend\n\nif File.exists?(\"/etc/opscode/chef-server.json\") &&\n!(File.exist?(\"/etc/opscode/private-chef.rb\") || File.exist?(\"/etc/opscode/chef-server.rb\"))", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-config.rb\n# Target line: 36\n\n     31:   # ['previous_run']['foo']['bar'].\n     32:   #\n     33:   # Take care to check that ['previous_run'] exists, though, otherwise\n     34:   # you'll run into trouble doing the initial Chef run.\n     35:   #\n>>>  36:   # TODO: Provide an API for getting this information\n     37:   node.consume_attributes({\"previous_run\" => old_config['private_chef']})\n     38: end\n     39: \n     40: if File.exists?(\"/etc/opscode/chef-server.json\") &&\n     41:     !(File.exist?(\"/etc/opscode/private-chef.rb\") || File.exist?(\"/etc/opscode/chef-server.rb\"))\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-resolver-recipes-default.rb", "content": "# This syntax makes the resolver sub-keys available directly", "line": 32, "detection_span": [27, 37], "with_context": "\ntemplate \"/etc/resolv.conf\" do\nsource \"resolv.conf.erb\"\nowner \"root\"\ngroup \"root\"\nmode 0644\n32:     # This syntax makes the resolver sub-keys available directly\nvariables node['resolver']\nend\nend\n\ncase node.chef_environment", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-resolver-recipes-default.rb\n# Target line: 32\n\n     27:   template \"/etc/resolv.conf\" do\n     28:     source \"resolv.conf.erb\"\n     29:     owner \"root\"\n     30:     group \"root\"\n     31:     mode 0644\n>>>  32:     # This syntax makes the resolver sub-keys available directly\n     33:     variables node['resolver']\n     34:   end\n     35: end\n     36: \n     37: case node.chef_environment\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-dhcprelay.rb", "content": "#  FIXME: not really suitable for sys - should go to a separate dhcp recipe", "line": 21, "detection_span": [16, 26], "with_context": "\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n# recipe for DHCP relay setup\n21: #  FIXME: not really suitable for sys - should go to a separate dhcp recipe\n\nif node['sys']['dhcprelay']\n\n# 'dhcp-helper' is a valid alternative here\npkg = node['sys']['dhcprelay']['package'] || 'isc-dhcp-relay'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-dhcprelay.rb\n# Target line: 21\n\n     16: # See the License for the specific language governing permissions and\n     17: # limitations under the License.\n     18: #\n     19: \n     20: # recipe for DHCP relay setup\n>>>  21: #  FIXME: not really suitable for sys - should go to a separate dhcp recipe\n     22: \n     23: if node['sys']['dhcprelay']\n     24: \n     25:   # 'dhcp-helper' is a valid alternative here\n     26:   pkg = node['sys']['dhcprelay']['package'] || 'isc-dhcp-relay'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-hadoop_cluster-cookbooks-elasticsearch-recipes-basic_auth.rb", "content": "# FIXME: nginx should be run after this recipe, but we need to ensure", "line": 35, "detection_span": [30, 40], "with_context": "\nend\n$passwords.flush\nend\nend\n\n35: # FIXME: nginx should be run after this recipe, but we need to ensure\n# that the nginx directory exists in order to place a template\n# there.\ndirectory node[:nginx][:dir] do\nmode 0755\naction :create", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-hadoop_cluster-cookbooks-elasticsearch-recipes-basic_auth.rb\n# Target line: 35\n\n     30:     end\n     31:     $passwords.flush\n     32:   end\n     33: end\n     34: \n>>>  35: # FIXME: nginx should be run after this recipe, but we need to ensure\n     36: # that the nginx directory exists in order to place a template\n     37: # there.\n     38: directory node[:nginx][:dir] do\n     39:   mode 0755\n     40:   action :create\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-rabbitmq-recipes-default.rb", "content": "## is because there is a problem with the stock init script in the RabbitMQ", "line": 125, "detection_span": [120, 130], "with_context": "\nhostname node['rabbitmq']['vip']\n121:   end\n122: end\n123:\n124: ## You'll see setsid used in all the init statements in this cookbook. This\n125: ## is because there is a problem with the stock init script in the RabbitMQ\n126: ## debian package (at least in 2.8.2) that makes it not daemonize properly\n127: ## when called from chef. The setsid command forces the subprocess into a state\n128: ## where it can daemonize properly. -Kevin (thanks to Daniel DeLeo for the help)\n129:\n130: service \"rabbitmq-server\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-rabbitmq-recipes-default.rb\n# Target line: 125\n\n    120:     hostname node['rabbitmq']['vip']\n    121:   end\n    122: end\n    123: \n    124: ## You'll see setsid used in all the init statements in this cookbook. This\n>>> 125: ## is because there is a problem with the stock init script in the RabbitMQ\n    126: ## debian package (at least in 2.8.2) that makes it not daemonize properly\n    127: ## when called from chef. The setsid command forces the subprocess into a state\n    128: ## where it can daemonize properly. -Kevin (thanks to Daniel DeLeo for the help)\n    129: \n    130: service \"rabbitmq-server\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-ceph.rb", "content": "# https://tracker.ceph.com/issues/50778", "line": 113, "detection_span": [108, 118], "with_context": "\n108: default['bcpc']['ceph']['mon']['enabled'] = true\n109: default['bcpc']['ceph']['osd']['enabled'] = true\n110:\n111: # ceph mgr module configuration\n112:\n113: # https://tracker.ceph.com/issues/50778\n114: # Mons may become unstable when the progress module is enabled.\n115: default['bcpc']['ceph']['module']['progress']['enabled'] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-ceph.rb\n# Target line: 113\n\n    108: default['bcpc']['ceph']['mon']['enabled'] = true\n    109: default['bcpc']['ceph']['osd']['enabled'] = true\n    110: \n    111: # ceph mgr module configuration\n    112: \n>>> 113: # https://tracker.ceph.com/issues/50778\n    114: # Mons may become unstable when the progress module is enabled.\n    115: default['bcpc']['ceph']['module']['progress']['enabled'] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-service-files-halite_gem-poise_service-service_mixin.rb", "content": "# @todo Add reload once poise-service supports it.", "line": 138, "detection_span": [133, 143], "with_context": "\nnotify_if_service do\nservice_resource.run_action(:reload)\nend\nend\n137:\n138:       # @todo Add reload once poise-service supports it.\n139:\nprivate\n141:\n# Set the current resource as notified if the provided block updates the\n# service resource.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-service-files-halite_gem-poise_service-service_mixin.rb\n# Target line: 138\n\n    133:         notify_if_service do\n    134:           service_resource.run_action(:reload)\n    135:         end\n    136:       end\n    137: \n>>> 138:       # @todo Add reload once poise-service supports it.\n    139: \n    140:       private\n    141: \n    142:       # Set the current resource as notified if the provided block updates the\n    143:       # service resource.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_opscode-omnibus-files-private-chef-cookbooks-private-chef-recipes-postgresql.rb", "content": "# TODO: Currently this is set up to be a parent directory of", "line": 33, "detection_span": [28, 38], "with_context": "\nsystem true\nshell node['private_chef']['postgresql']['shell']\nhome node['private_chef']['postgresql']['home']\nend\n\n33: # TODO: Currently this is set up to be a parent directory of\n# node['private_chef']['postgresql']['dir'].  Is it necessary that\n# this is exposed as a settable attribute, or can we make some\n# simplifying assumptions about our directory structure?\ndirectory node['private_chef']['postgresql']['home'] do\nowner node['private_chef']['postgresql']['username']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_opscode-omnibus-files-private-chef-cookbooks-private-chef-recipes-postgresql.rb\n# Target line: 33\n\n     28:   system true\n     29:   shell node['private_chef']['postgresql']['shell']\n     30:   home node['private_chef']['postgresql']['home']\n     31: end\n     32: \n>>>  33: # TODO: Currently this is set up to be a parent directory of\n     34: # node['private_chef']['postgresql']['dir'].  Is it necessary that\n     35: # this is exposed as a settable attribute, or can we make some\n     36: # simplifying assumptions about our directory structure?\n     37: directory node['private_chef']['postgresql']['home'] do\n     38:   owner node['private_chef']['postgresql']['username']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_fstab-attributes-default.rb", "content": "'tracefs', # kernel debugging", "line": 63, "detection_span": [58, 68], "with_context": "\n'hugetlbfs', # hugepages\n'mqueue', # POSIX queues\n'proc',\n'swap',\n'sysfs',\n63:       'tracefs', # kernel debugging\n'usbfs',\n],\n'mount_points' => [\n# Core OS stuff to never umount...\n'/dev/shm',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_facebook-repo-chef-cookbooks-cookbooks-fb_fstab-attributes-default.rb\n# Target line: 63\n\n     58:       'hugetlbfs', # hugepages\n     59:       'mqueue', # POSIX queues\n     60:       'proc',\n     61:       'swap',\n     62:       'sysfs',\n>>>  63:       'tracefs', # kernel debugging\n     64:       'usbfs',\n     65:     ],\n     66:     'mount_points' => [\n     67:       # Core OS stuff to never umount...\n     68:       '/dev/shm',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-windows-resources-path.rb", "content": "# This is a temporary fix for that.", "line": 38, "detection_span": [33, 43], "with_context": "\nnotifies :run, \"ruby_block[fix ruby ENV['PATH']]\", :immediately\nend\n\n# The windows Env provider does not correctly expand variables in\n# the PATH environment variable. Ruby expects these to be expanded.\n38:   # This is a temporary fix for that.\n#\n# Follow at https://github.com/chef/chef/pull/1876\n#\nruby_block \"fix ruby ENV['PATH']\" do\nblock do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-windows-resources-path.rb\n# Target line: 38\n\n     33:     notifies :run, \"ruby_block[fix ruby ENV['PATH']]\", :immediately\n     34:   end\n     35: \n     36:   # The windows Env provider does not correctly expand variables in\n     37:   # the PATH environment variable. Ruby expects these to be expanded.\n>>>  38:   # This is a temporary fix for that.\n     39:   #\n     40:   # Follow at https://github.com/chef/chef/pull/1876\n     41:   #\n     42:   ruby_block \"fix ruby ENV['PATH']\" do\n     43:     block do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-mongodb-cookbooks-redis-attributes-default.rb", "content": "# TODO: replace with discovery", "line": 43, "detection_span": [38, 48], "with_context": "\n\ndefault[:redis][:saves]             = [[\"900\", \"1\"], [\"300\", \"10\"], [\"60\", \"10000\"]]\n\ndefault[:redis][:slave]             = \"no\"\nif (node[:redis][:slave] == \"yes\")\n43:   # TODO: replace with discovery\ndefault[:redis][:master_server]   = \"redis-master.\" + domain\ndefault[:redis][:master_port]     = \"6379\"\nend\n\ndefault[:redis][:shareobjects]      = \"no\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-mongodb-cookbooks-redis-attributes-default.rb\n# Target line: 43\n\n     38: \n     39: default[:redis][:saves]             = [[\"900\", \"1\"], [\"300\", \"10\"], [\"60\", \"10000\"]]\n     40: \n     41: default[:redis][:slave]             = \"no\"\n     42: if (node[:redis][:slave] == \"yes\")\n>>>  43:   # TODO: replace with discovery\n     44:   default[:redis][:master_server]   = \"redis-master.\" + domain\n     45:   default[:redis][:master_port]     = \"6379\"\n     46: end\n     47: \n     48: default[:redis][:shareobjects]      = \"no\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rcbops-cookbooks_nova-recipes-nova-osapi-patch.rb", "content": "# lp:bug https://bugs.launchpad.net/ubuntu/+bug/1235220", "line": 24, "detection_span": [19, 29], "with_context": "\n\ninclude_recipe \"osops-utils\"\n\nnova_api_endpoint = get_bind_endpoint(\"nova\", \"api\")\n\n24: # lp:bug https://bugs.launchpad.net/ubuntu/+bug/1235220\n# incorrect headers delivered by nova osapi\ntemplate \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\" do\nsource \"patches/servers.py.2013.1.3-0ubuntu1~cloud0.erb\"\nowner \"root\"\ngroup \"root\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-osapi-patch.rb\n# Target line: 24\n\n     19: \n     20: include_recipe \"osops-utils\"\n     21: \n     22: nova_api_endpoint = get_bind_endpoint(\"nova\", \"api\")\n     23: \n>>>  24: # lp:bug https://bugs.launchpad.net/ubuntu/+bug/1235220\n     25: # incorrect headers delivered by nova osapi\n     26: template \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\" do\n     27:   source \"patches/servers.py.2013.1.3-0ubuntu1~cloud0.erb\"\n     28:   owner \"root\"\n     29:   group \"root\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-motd-example_clusters-hb.rb", "content": "# #   to overcome https://issues.apache.org/jira/browse/HBASE-4684 in HBase 0.90.4", "line": 84, "detection_span": [79, 89], "with_context": "\n# #   large heaps.\n# cluster_overrides[:hbase][:memstore] ||= {}\n# cluster_overrides[:hbase][:memstore][:mslab_enabled]          = true\n#\n# # Setting this to 0 entirely removes the limit on concurrent connections. This is necessary\n84:   # #   to overcome https://issues.apache.org/jira/browse/HBASE-4684 in HBase 0.90.4\n# cluster_overrides[:zookeeper][:max_client_connections]        = 0\n\nrole                  :systemwide\ncloud(:ec2).security_group :systemwide\nrole                  :chef_client", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-motd-example_clusters-hb.rb\n# Target line: 84\n\n     79:   # #   large heaps.\n     80:   # cluster_overrides[:hbase][:memstore] ||= {}\n     81:   # cluster_overrides[:hbase][:memstore][:mslab_enabled]          = true\n     82:   #\n     83:   # # Setting this to 0 entirely removes the limit on concurrent connections. This is necessary\n>>>  84:   # #   to overcome https://issues.apache.org/jira/browse/HBASE-4684 in HBase 0.90.4\n     85:   # cluster_overrides[:zookeeper][:max_client_connections]        = 0\n     86: \n     87:   role                  :systemwide\n     88:   cloud(:ec2).security_group :systemwide\n     89:   role                  :chef_client\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "enterstudio_ey-cloud-recipes-cookbooks-main-recipes-default.rb", "content": "#uncomment to use the ntp recipes for fixing clock issues", "line": 46, "detection_span": [41, 51], "with_context": "\n#require_recipe \"exim::auth\"\n\n#uncomment to run the resque recipe\n#require_recipe \"resque\"\n\n46: #uncomment to use the ntp recipes for fixing clock issues\n#require_recipe \"ntp\"\n#\n#require_recipe \"logrotate\"\n#\n#uncomment to use the solr recipe", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: enterstudio_ey-cloud-recipes-cookbooks-main-recipes-default.rb\n# Target line: 46\n\n     41: #require_recipe \"exim::auth\"\n     42: \n     43: #uncomment to run the resque recipe\n     44: #require_recipe \"resque\"\n     45: \n>>>  46: #uncomment to use the ntp recipes for fixing clock issues\n     47: #require_recipe \"ntp\"\n     48: #\n     49: #require_recipe \"logrotate\"\n     50: #\n     51: #uncomment to use the solr recipe\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-datadog-recipes-elasticsearch.rb", "content": "# 'elasticsearch.primary' prefix. It is particularly useful if you want to", "line": 25, "detection_span": [20, 30], "with_context": "\n#\n# Additional flags:\n#\n# If you enable the \"pshard_stats\" flag, statistics over primary shards\n# will be collected by the check and sent to the backend with the\n25: # 'elasticsearch.primary' prefix. It is particularly useful if you want to\n# get certain metrics without taking replicas into account. For instance,\n# 'elasticsearch.primaries.docs.count` will give you the total number of\n# documents in your indexes WITHOUT counting duplicates due to the existence\n# of replica shards in your ES cluster\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-recipes-elasticsearch.rb\n# Target line: 25\n\n     20: #\n     21: # Additional flags:\n     22: #\n     23: # If you enable the \"pshard_stats\" flag, statistics over primary shards\n     24: # will be collected by the check and sent to the backend with the\n>>>  25: # 'elasticsearch.primary' prefix. It is particularly useful if you want to\n     26: # get certain metrics without taking replicas into account. For instance,\n     27: # 'elasticsearch.primaries.docs.count` will give you the total number of\n     28: # documents in your indexes WITHOUT counting duplicates due to the existence\n     29: # of replica shards in your ES cluster\n     30: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-vayacondios-recipes-install_from_git.rb", "content": "#   https://github.com/carlhuda/bundler/issues/1570", "line": 20, "detection_span": [15, 25], "with_context": "\n# gemspecs (lookin' at you devise) have UTF chars in them\n# even though the OS thinks they are ASCII.  Ruby trusts the\n# OS unless you let it know via this variable to trust you\n# instead.  See\n#\n20:   #   https://github.com/carlhuda/bundler/issues/1570\n#\n\"LANG\" => \"en_US.UTF-8\",\n\"LC_ALL\" => \"en_US.UTF-8\"\n}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-vayacondios-recipes-install_from_git.rb\n# Target line: 20\n\n     15:   # gemspecs (lookin' at you devise) have UTF chars in them\n     16:   # even though the OS thinks they are ASCII.  Ruby trusts the\n     17:   # OS unless you let it know via this variable to trust you\n     18:   # instead.  See\n     19:   #\n>>>  20:   #   https://github.com/carlhuda/bundler/issues/1570\n     21:   #\n     22:   \"LANG\" => \"en_US.UTF-8\",\n     23:   \"LC_ALL\" => \"en_US.UTF-8\"\n     24: }\n     25: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "openstack_cookbook-openstack-block-storage-recipes-volume_driver_lvm.rb", "content": "# TODO: (jklare) this whole section should be refactored and probably include an", "line": 26, "detection_span": [21, 31], "with_context": "\npackage platform_options['cinder_lvm_packages'] do\noptions platform_options['package_overrides']\naction :upgrade\nend\n\n26: # TODO: (jklare) this whole section should be refactored and probably include an\n# external cookbook for managing lvm stuff\n\nvg_name = node['openstack']['block-storage']['conf']['DEFAULT']['volume_group']\ncase node['openstack']['block-storage']['volume']['create_volume_group_type']\nwhen 'file'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-block-storage-recipes-volume_driver_lvm.rb\n# Target line: 26\n\n     21: package platform_options['cinder_lvm_packages'] do\n     22:   options platform_options['package_overrides']\n     23:   action :upgrade\n     24: end\n     25: \n>>>  26: # TODO: (jklare) this whole section should be refactored and probably include an\n     27: # external cookbook for managing lvm stuff\n     28: \n     29: vg_name = node['openstack']['block-storage']['conf']['DEFAULT']['volume_group']\n     30: case node['openstack']['block-storage']['volume']['create_volume_group_type']\n     31: when 'file'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-keys.rb", "content": "# @options [Fixnum] :timeout specify http timeout", "line": 71, "detection_span": [66, 76], "with_context": "\n#\n# This method takes the following parameters as arguments\n# @ key   - key to be watched\n# @options [Hash] additional options for watching a key\n# @options [Fixnum] :index watch the specified key from given index\n71:     # @options [Fixnum] :timeout specify http timeout\ndef watch(key, opts = {})\nparams = { wait: true }\nfail ArgumentError, 'Second argument must be a hash' unless opts.is_a?(Hash)\ntimeout = opts[:timeout] || @read_timeout\nindex = opts[:waitIndex] || opts[:index]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-keys.rb\n# Target line: 71\n\n     66:     #\n     67:     # This method takes the following parameters as arguments\n     68:     # @ key   - key to be watched\n     69:     # @options [Hash] additional options for watching a key\n     70:     # @options [Fixnum] :index watch the specified key from given index\n>>>  71:     # @options [Fixnum] :timeout specify http timeout\n     72:     def watch(key, opts = {})\n     73:       params = { wait: true }\n     74:       fail ArgumentError, 'Second argument must be a hash' unless opts.is_a?(Hash)\n     75:       timeout = opts[:timeout] || @read_timeout\n     76:       index = opts[:waitIndex] || opts[:index]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "chef-boneyard_delivery_build-recipes-chefdk.rb", "content": "# Needed by the delivery-cli to resolve build-cookbooks from", "line": 62, "detection_span": [57, 67], "with_context": "\n\"/opt/chefdk/bin:/opt/chefdk/embedded/bin:#{ENV['PATH']}\"\nend\n\n# Install knife-supermarket Gem\n#\n62: # Needed by the delivery-cli to resolve build-cookbooks from\n# both public/private Supermarket\ngem_package 'knife-supermarket' do\nversion '0.2.2'\ngem_binary windows? ? 'C:\\opscode\\chefdk\\embedded\\bin\\gem' : '/opt/chefdk/embedded/bin/gem'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-boneyard_delivery_build-recipes-chefdk.rb\n# Target line: 62\n\n     57:                 \"/opt/chefdk/bin:/opt/chefdk/embedded/bin:#{ENV['PATH']}\"\n     58:               end\n     59: \n     60: # Install knife-supermarket Gem\n     61: #\n>>>  62: # Needed by the delivery-cli to resolve build-cookbooks from\n     63: # both public/private Supermarket\n     64: gem_package 'knife-supermarket' do\n     65:   version '0.2.2'\n     66:   gem_binary windows? ? 'C:\\opscode\\chefdk\\embedded\\bin\\gem' : '/opt/chefdk/embedded/bin/gem'\n     67: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-rightscale-libraries-helper.rb", "content": "# Get the value portion of a tag with a given prefix from a list of tags.", "line": 63, "detection_span": [58, 68], "with_context": "\n# @return [Hash] A filtered server collection\ndef self.filter_tags!(collection, name, tags)\ncollection[name] = filter_tags(collection, name, tags)\nend\n\n63:       # Get the value portion of a tag with a given prefix from a list of tags.\n#\n# @param [String] prefix the prefix of tag to retrieve\n# @param [Array] tags list of tags to search\n# @param [String] capture optional Regexp portion to validate the value\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-rightscale-libraries-helper.rb\n# Target line: 63\n\n     58:       # @return [Hash] A filtered server collection\n     59:       def self.filter_tags!(collection, name, tags)\n     60:         collection[name] = filter_tags(collection, name, tags)\n     61:       end\n     62: \n>>>  63:       # Get the value portion of a tag with a given prefix from a list of tags.\n     64:       #\n     65:       # @param [String] prefix the prefix of tag to retrieve\n     66:       # @param [Array] tags list of tags to search\n     67:       # @param [String] capture optional Regexp portion to validate the value\n     68:       #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "paulmccallick_chef-logstash-recipes-source.rb", "content": "# command \"make clean && make VERSION=#{logstash_version} --debug > /tmp/make.log 2>&1\"", "line": 33, "detection_span": [28, 38], "with_context": "\nenvironment(\nJAVA_HOME: node['logstash']['source']['java_home']\n)\nuser 'root'\n# This variant is useful for troubleshooting stupid environment problems\n33:   # command \"make clean && make VERSION=#{logstash_version} --debug > /tmp/make.log 2>&1\"\ncommand \"make clean && make VERSION=#{logstash_version} jar\"\naction :run\ncreates \"#{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\nnot_if \"test -f #{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: paulmccallick_chef-logstash-recipes-source.rb\n# Target line: 33\n\n     28:   environment(\n     29:     JAVA_HOME: node['logstash']['source']['java_home']\n     30:   )\n     31:   user 'root'\n     32:   # This variant is useful for troubleshooting stupid environment problems\n>>>  33:   # command \"make clean && make VERSION=#{logstash_version} --debug > /tmp/make.log 2>&1\"\n     34:   command \"make clean && make VERSION=#{logstash_version} jar\"\n     35:   action :run\n     36:   creates \"#{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\n     37:   not_if \"test -f #{node['logstash']['basedir']}/source/build/logstash-#{logstash_version}-monolithic.jar\"\n     38: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "Soluciones_ey-cloud-recipes-cookbooks-env_motd-recipes-motd.rb", "content": "# IP address will be resolved internally from Amazon, which", "line": 16, "detection_span": [11, 21], "with_context": "\npublic_hostname = ''\npublic_ip = ''\n\n# Grab the public hostname for this instance. This recipe\n# will be run *from* the instance, which means that the following\n16: # IP address will be resolved internally from Amazon, which\n# is good because it's an Amazon-specific, internal IP\n# that they use for instance metadata.\n# ########\n# This two lines can take some time, so sometimes it's better to comment it!\n# ########", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-env_motd-recipes-motd.rb\n# Target line: 16\n\n     11: public_hostname = ''\n     12: public_ip = ''\n     13: \n     14: # Grab the public hostname for this instance. This recipe\n     15: # will be run *from* the instance, which means that the following\n>>>  16: # IP address will be resolved internally from Amazon, which\n     17: # is good because it's an Amazon-specific, internal IP\n     18: # that they use for instance metadata.\n     19: # ########\n     20: # This two lines can take some time, so sometimes it's better to comment it!\n     21: # ########\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~backend_bucket.rb", "content": "# TODO(nelsonjr): http://b/63088154 Google Cloud Platform API is returning", "line": 64, "detection_span": [59, 69], "with_context": "\n'https://www.googleapis.com/auth/cloud-platform'\n]\nend\n\n# *** WARNING ***\n64: # TODO(nelsonjr): http://b/63088154 Google Cloud Platform API is returning\n# access denied if we use a more restricted scope such as\n# https://www.googleapis.com/auth/compute. For the time being use an all mighty\n# scope instead: https://www.googleapis.com/auth/cloud-platform.\n\ngcompute_backend_bucket 'chef-e2e-be-bucket-connection' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~backend_bucket.rb\n# Target line: 64\n\n     59:     'https://www.googleapis.com/auth/cloud-platform'\n     60:   ]\n     61: end\n     62: \n     63: # *** WARNING ***\n>>>  64: # TODO(nelsonjr): http://b/63088154 Google Cloud Platform API is returning\n     65: # access denied if we use a more restricted scope such as\n     66: # https://www.googleapis.com/auth/compute. For the time being use an all mighty\n     67: # scope instead: https://www.googleapis.com/auth/cloud-platform.\n     68: \n     69: gcompute_backend_bucket 'chef-e2e-be-bucket-connection' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-docker-libraries-docker_service_manager_execute.rb", "content": "# https://github.com/docker/docker/issues/2758", "line": 24, "detection_span": [19, 29], "with_context": "\naction :run\nend\n\n# Go doesn't support detaching processes natively, so we have\n# to manually fork it from the shell with &\n24:       # https://github.com/docker/docker/issues/2758\nbash \"start docker #{name}\" do\ncode \"#{docker_daemon_cmd} >> #{logfile} 2>&1 &\"\nenvironment 'HTTP_PROXY' => http_proxy,\n'HTTPS_PROXY' => https_proxy,\n'NO_PROXY' => no_proxy,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-docker-libraries-docker_service_manager_execute.rb\n# Target line: 24\n\n     19:         action :run\n     20:       end\n     21: \n     22:       # Go doesn't support detaching processes natively, so we have\n     23:       # to manually fork it from the shell with &\n>>>  24:       # https://github.com/docker/docker/issues/2758\n     25:       bash \"start docker #{name}\" do\n     26:         code \"#{docker_daemon_cmd} >> #{logfile} 2>&1 &\"\n     27:         environment 'HTTP_PROXY' => http_proxy,\n     28:                     'HTTPS_PROXY' => https_proxy,\n     29:                     'NO_PROXY' => no_proxy,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-docker-recipes-default.rb", "content": "# file. This hack replaces official service file with the one that comes with", "line": 37, "detection_span": [32, 42], "with_context": "\nversion node['docker']['apt']['version']\nend\n\n# Ugly hack for Ubuntu 16.04 docker service. By default, service does not\n# allow us to override hosts setting, because it is hardcoded in the service\n37: # file. This hack replaces official service file with the one that comes with\n# Fedora packages and has no hardcoded hosts.\n#\n# Just for reference, this is the error that we get in system logs:\n#   unable to configure the Docker daemon with file /etc/docker/daemon.json:\n#   the following directives are specified both as a flag and in the", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-docker-recipes-default.rb\n# Target line: 37\n\n     32:   version node['docker']['apt']['version']\n     33: end\n     34: \n     35: # Ugly hack for Ubuntu 16.04 docker service. By default, service does not\n     36: # allow us to override hosts setting, because it is hardcoded in the service\n>>>  37: # file. This hack replaces official service file with the one that comes with\n     38: # Fedora packages and has no hardcoded hosts.\n     39: #\n     40: # Just for reference, this is the error that we get in system logs:\n     41: #   unable to configure the Docker daemon with file /etc/docker/daemon.json:\n     42: #   the following directives are specified both as a flag and in the\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "criteo-cookbooks_nexus3-libraries-api.rb", "content": "# Little hack with custom client to get read of the API prefix.", "line": 99, "detection_span": [94, 104], "with_context": "\nend\nend\n\n# exists? check if asset at the given path exists\ndef exists?(repo, path)\n99:       # Little hack with custom client to get read of the API prefix.\n# TODO: Provide more data to the Api init / pass the api prefix in each method\nu = URI.parse(@endpoint)\nu.path = ::File.join('/repository', repo, path) # Replace api prefix by the path to the asset\nres = ::HTTPClient.new.head(u)\nres.ok?", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_nexus3-libraries-api.rb\n# Target line: 99\n\n     94:       end\n     95:     end\n     96: \n     97:     # exists? check if asset at the given path exists\n     98:     def exists?(repo, path)\n>>>  99:       # Little hack with custom client to get read of the API prefix.\n    100:       # TODO: Provide more data to the Api init / pass the api prefix in each method\n    101:       u = URI.parse(@endpoint)\n    102:       u.path = ::File.join('/repository', repo, path) # Replace api prefix by the path to the asset\n    103:       res = ::HTTPClient.new.head(u)\n    104:       res.ok?\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_django-attributes-default.rb", "content": "# Django application debug mode - https://docs.djangoproject.com/en/dev/ref/settings/#debug", "line": 12, "detection_span": [7, 17], "with_context": "\n\n\n# Setting Django version\nset[:app_django][:version] = \"1.4\"\n\n12: # Django application debug mode - https://docs.djangoproject.com/en/dev/ref/settings/#debug\nset_unless[:app_django][:app][:debug_mode] = \"False\"\n\n# By default apache will serve any existing local files directly (except actionable ones)\nset_unless[:app_django][:apache][:serve_local_files] = \"true\"\n# List of required apache modules", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_django-attributes-default.rb\n# Target line: 12\n\n      7: \n      8: \n      9: # Setting Django version\n     10: set[:app_django][:version] = \"1.4\"\n     11: \n>>>  12: # Django application debug mode - https://docs.djangoproject.com/en/dev/ref/settings/#debug\n     13: set_unless[:app_django][:app][:debug_mode] = \"False\"\n     14: \n     15: # By default apache will serve any existing local files directly (except actionable ones)\n     16: set_unless[:app_django][:apache][:serve_local_files] = \"true\"\n     17: # List of required apache modules\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GSI-HPC_sys-chef-cookbook-recipes-mail.rb", "content": "# check if /etc/postfix/<map>.db exists and", "line": 76, "detection_span": [71, 81], "with_context": "\nend\n\nexecute \"update-#{map}\" do\naction :run\ncommand \"postmap /etc/postfix/#{map}\"\n76:     # check if /etc/postfix/<map>.db exists and\n#  run if it doesn't or is outdated:\nnot_if \"/usr/bin/test /etc/postfix/#{map}.db -nt /etc/postfix/#{map}\"\nnotifies :reload, 'service[postfix]'\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GSI-HPC_sys-chef-cookbook-recipes-mail.rb\n# Target line: 76\n\n     71:   end\n     72: \n     73:   execute \"update-#{map}\" do\n     74:     action :run\n     75:     command \"postmap /etc/postfix/#{map}\"\n>>>  76:     # check if /etc/postfix/<map>.db exists and\n     77:     #  run if it doesn't or is outdated:\n     78:     not_if \"/usr/bin/test /etc/postfix/#{map}.db -nt /etc/postfix/#{map}\"\n     79:     notifies :reload, 'service[postfix]'\n     80:   end\n     81: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-redis-recipes-default.rb", "content": "key \"5862E31D\"", "line": 27, "detection_span": [22, 32], "with_context": "\n\nif node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"ppa_redis\" do\nurl \"http://ppa.launchpad.net/rwky/redis/ubuntu\"\n27:       key \"5862E31D\"\nkey_server \"keyserver.ubuntu.com\"\nend\n\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-redis-recipes-default.rb\n# Target line: 27\n\n     22: \n     23:   if node.apt.master_chef_add_apt_repo\n     24: \n     25:     add_apt_repository \"ppa_redis\" do\n     26:       url \"http://ppa.launchpad.net/rwky/redis/ubuntu\"\n>>>  27:       key \"5862E31D\"\n     28:       key_server \"keyserver.ubuntu.com\"\n     29:     end\n     30: \n     31:   end\n     32: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_source_scm_base.rb", "content": "scm_key = :repository if scm_key == :url", "line": 11, "detection_span": [6, 16], "with_context": "\nclass Base < Drivers::Source::Base\ndef fetch(deploy_context)\ndeploy_context.scm_provider(adapter.constantize)\n\nout.each do |scm_key, scm_value|\n11:             scm_key = :repository if scm_key == :url\ndeploy_context.send(scm_key, scm_value) if deploy_context.respond_to?(scm_key)\nend\nend\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_source_scm_base.rb\n# Target line: 11\n\n      6:       class Base < Drivers::Source::Base\n      7:         def fetch(deploy_context)\n      8:           deploy_context.scm_provider(adapter.constantize)\n      9: \n     10:           out.each do |scm_key, scm_value|\n>>>  11:             scm_key = :repository if scm_key == :url\n     12:             deploy_context.send(scm_key, scm_value) if deploy_context.respond_to?(scm_key)\n     13:           end\n     14:         end\n     15:       end\n     16:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-nova-setup.rb", "content": "user \"nova\"", "line": 56, "detection_span": [51, 61], "with_context": "\nnode[\"nova\"][\"db\"][\"username\"],\nnode[\"nova\"][\"db\"][\"password\"])\n\nexecute \"nova-manage db sync\" do\ncommand \"nova-manage db sync\"\n56:   user \"nova\"\ngroup \"nova\"\naction :run\n#  not_if \"nova-manage db version && test $(nova-manage db version) -gt 0\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-setup.rb\n# Target line: 56\n\n     51:   node[\"nova\"][\"db\"][\"username\"],\n     52:   node[\"nova\"][\"db\"][\"password\"])\n     53: \n     54: execute \"nova-manage db sync\" do\n     55:   command \"nova-manage db sync\"\n>>>  56:   user \"nova\"\n     57:   group \"nova\"\n     58:   action :run\n     59:   #  not_if \"nova-manage db version && test $(nova-manage db version) -gt 0\"\n     60: end\n     61: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-postgres.rb", "content": "user 'postgres'", "line": 28, "detection_span": [23, 33], "with_context": "\npackage %w(libpq-dev postgresql postgresql-contrib)\n\n# Next few lines are ugly as hell, but Chef and PostgreSQL is not the best\n# match ever to exist.\nbash 'Prepare database' do\n28:   user 'postgres'\ncode <<-EOC\npsql -c \"CREATE DATABASE #{db_name};\"\npsql -c \"CREATE USER #{dice_user};\"\npsql -c \"ALTER ROLE #{dice_user} SET client_encoding TO 'utf8';\"\npsql -c \"ALTER ROLE #{dice_user} SET default_transaction_isolation TO 'read committed';\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-dice_deployment_service-recipes-postgres.rb\n# Target line: 28\n\n     23: package %w(libpq-dev postgresql postgresql-contrib)\n     24: \n     25: # Next few lines are ugly as hell, but Chef and PostgreSQL is not the best\n     26: # match ever to exist.\n     27: bash 'Prepare database' do\n>>>  28:   user 'postgres'\n     29:   code <<-EOC\n     30:     psql -c \"CREATE DATABASE #{db_name};\"\n     31:     psql -c \"CREATE USER #{dice_user};\"\n     32:     psql -c \"ALTER ROLE #{dice_user} SET client_encoding TO 'utf8';\"\n     33:     psql -c \"ALTER ROLE #{dice_user} SET default_transaction_isolation TO 'read committed';\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_osl-openstack-recipes-upgrade.rb", "content": "nova_api_pass = get_password 'db', 'nova_api'", "line": 39, "detection_span": [34, 44], "with_context": "\nend\n\n### Stein Upgrade\n# TODO: Remove after Stein\n\n39: nova_api_pass = get_password 'db', 'nova_api'\nplacement_user = node['openstack']['db']['placement']['username']\nplacement_pass = get_password 'db', 'placement'\nplacement_db_uri = db_uri('placement', placement_user, placement_pass)\n\ntemplate '/root/migrate-db.rc' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_osl-openstack-recipes-upgrade.rb\n# Target line: 39\n\n     34: end\n     35: \n     36: ### Stein Upgrade\n     37: # TODO: Remove after Stein\n     38: \n>>>  39: nova_api_pass = get_password 'db', 'nova_api'\n     40: placement_user = node['openstack']['db']['placement']['username']\n     41: placement_pass = get_password 'db', 'placement'\n     42: placement_db_uri = db_uri('placement', placement_user, placement_pass)\n     43: \n     44: template '/root/migrate-db.rc' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-partners_omnibus-marketplace-files-chef-marketplace-cookbooks-chef-marketplace-attributes-default.rb", "content": "m[\"runit\"][\"user\"][\"username\"] = \"opscode\"", "line": 35, "detection_span": [30, 40], "with_context": "\nm[\"manage\"][\"ssl_port\"] = 443\nm[\"manage\"][\"sign_up\"][\"enabled\"] = true\nm[\"manage\"][\"org_creation\"][\"enabled\"] = true\nm[\"manage\"][\"marketplace\"][\"sign_up\"][\"enabled\"] = true\nm[\"manage\"][\"marketplace\"][\"sign_up\"][\"timeout\"] = 3600\n35:   m[\"runit\"][\"user\"][\"username\"] = \"opscode\"\nm[\"runit\"][\"user\"][\"shell\"] = \"/bin/sh\"\nm[\"runit\"][\"user\"][\"home\"] = \"/opt/opscode/embedded\"\n# These are used by the enterprise-chef-common cookbook\nm[\"sysvinit_id\"] = \"MP\"\nm[\"install_path\"] = \"/opt/chef-marketplace\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-partners_omnibus-marketplace-files-chef-marketplace-cookbooks-chef-marketplace-attributes-default.rb\n# Target line: 35\n\n     30:   m[\"manage\"][\"ssl_port\"] = 443\n     31:   m[\"manage\"][\"sign_up\"][\"enabled\"] = true\n     32:   m[\"manage\"][\"org_creation\"][\"enabled\"] = true\n     33:   m[\"manage\"][\"marketplace\"][\"sign_up\"][\"enabled\"] = true\n     34:   m[\"manage\"][\"marketplace\"][\"sign_up\"][\"timeout\"] = 3600\n>>>  35:   m[\"runit\"][\"user\"][\"username\"] = \"opscode\"\n     36:   m[\"runit\"][\"user\"][\"shell\"] = \"/bin/sh\"\n     37:   m[\"runit\"][\"user\"][\"home\"] = \"/opt/opscode/embedded\"\n     38:   # These are used by the enterprise-chef-common cookbook\n     39:   m[\"sysvinit_id\"] = \"MP\"\n     40:   m[\"install_path\"] = \"/opt/chef-marketplace\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-keystone.rb", "content": "default['bcpc']['ldap']['admin_pass'] = nil", "line": 64, "detection_span": [59, 69], "with_context": "\n\ndefault['bcpc']['keystone']['default_domain'] = 'default'\n\n# LDAP credentials used by Keystone\ndefault['bcpc']['ldap']['admin_user'] = nil\n64: default['bcpc']['ldap']['admin_pass'] = nil\ndefault['bcpc']['ldap']['admin_user_domain'] = nil\ndefault['bcpc']['ldap']['admin_project_domain'] = nil\ndefault['bcpc']['ldap']['admin_project_name'] = nil\ndefault['bcpc']['ldap']['config'] = {}\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-keystone.rb\n# Target line: 64\n\n     59: \n     60: default['bcpc']['keystone']['default_domain'] = 'default'\n     61: \n     62: # LDAP credentials used by Keystone\n     63: default['bcpc']['ldap']['admin_user'] = nil\n>>>  64: default['bcpc']['ldap']['admin_pass'] = nil\n     65: default['bcpc']['ldap']['admin_user_domain'] = nil\n     66: default['bcpc']['ldap']['admin_project_domain'] = nil\n     67: default['bcpc']['ldap']['admin_project_name'] = nil\n     68: default['bcpc']['ldap']['config'] = {}\n     69: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-recipes-ceph-apt.rb", "content": "key \"ceph-autobuild.key\"", "line": 38, "detection_span": [33, 43], "with_context": "\n\napt_repository \"ceph-fcgi\" do\nuri node['bcpc']['repos']['ceph-fcgi']\ndistribution node['lsb']['codename']\ncomponents [\"main\"]\n38:     key \"ceph-autobuild.key\"\nend\n\napt_repository \"ceph-apache\" do\nuri node['bcpc']['repos']['ceph-apache']\ndistribution node['lsb']['codename']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-ceph-apt.rb\n# Target line: 38\n\n     33: \n     34: apt_repository \"ceph-fcgi\" do\n     35:     uri node['bcpc']['repos']['ceph-fcgi']\n     36:     distribution node['lsb']['codename']\n     37:     components [\"main\"]\n>>>  38:     key \"ceph-autobuild.key\"\n     39: end\n     40: \n     41: apt_repository \"ceph-apache\" do\n     42:     uri node['bcpc']['repos']['ceph-apache']\n     43:     distribution node['lsb']['codename']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "amitjain1975_custom-rightscale-cookbooks-repo-recipes-default.rb", "content": "svn_username = entry[:svn_username] || \"\"", "line": 16, "detection_span": [11, 21], "with_context": "\nlog \"  Setup all resources that have attributes in the node\"\nnode[:repo].each do |resource_name, entry|\n\nurl = entry[:repository] || \"\"\nbranch = entry[:revision] || \"\"\n16:   svn_username = entry[:svn_username] || \"\"\nsvn_password = entry[:svn_password] || \"\"\nkey = entry[:git_ssh_key] || \"\"\nstorage_account_provider = entry[:storage_account_provider] || \"\"\nstorage_account_id = entry[:storage_account_id] || \"\"\nstorage_account_secret = entry[:storage_account_secret] || \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-repo-recipes-default.rb\n# Target line: 16\n\n     11: log \"  Setup all resources that have attributes in the node\"\n     12: node[:repo].each do |resource_name, entry|\n     13: \n     14:   url = entry[:repository] || \"\"\n     15:   branch = entry[:revision] || \"\"\n>>>  16:   svn_username = entry[:svn_username] || \"\"\n     17:   svn_password = entry[:svn_password] || \"\"\n     18:   key = entry[:git_ssh_key] || \"\"\n     19:   storage_account_provider = entry[:storage_account_provider] || \"\"\n     20:   storage_account_id = entry[:storage_account_id] || \"\"\n     21:   storage_account_secret = entry[:storage_account_secret] || \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"https://download.docker.com/linux/ubuntu/gpg\"", "line": 159, "detection_span": [154, 164], "with_context": "\n154: apt_repository \"docker\" do\n155:   action repository_actions[\"docker\"]\n156:   uri \"https://download.docker.com/linux/ubuntu\"\n157:   arch \"amd64\"\n158:   components [\"stable\"]\n159:   key \"https://download.docker.com/linux/ubuntu/gpg\"\n160: end\n161:\n162: apt_repository \"grafana\" do\n163:   action repository_actions[\"grafana\"]\n164:   uri \"https://packages.grafana.com/enterprise/deb\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 159\n\n    154: apt_repository \"docker\" do\n    155:   action repository_actions[\"docker\"]\n    156:   uri \"https://download.docker.com/linux/ubuntu\"\n    157:   arch \"amd64\"\n    158:   components [\"stable\"]\n>>> 159:   key \"https://download.docker.com/linux/ubuntu/gpg\"\n    160: end\n    161: \n    162: apt_repository \"grafana\" do\n    163:   action repository_actions[\"grafana\"]\n    164:   uri \"https://packages.grafana.com/enterprise/deb\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-journalnode.rb", "content": "user 0644", "line": 17, "detection_span": [12, 22], "with_context": "\n\nif get_config(\"namenode_txn_fmt\") then\nfile \"#{Chef::Config[:file_cache_path]}/nn_fmt.tgz\" do\nuser \"hdfs\"\ngroup \"hdfs\"\n17:     user 0644\ncontent Base64.decode64(get_config(\"namenode_txn_fmt\"))\nnot_if { node[:bcpc][:hadoop][:mounts].all? { |d| File.exists?(\"/disk/#{d}/dfs/jn/#{node.chef_environment}/current/VERSION\") } }\nend\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-journalnode.rb\n# Target line: 17\n\n     12: \n     13: if get_config(\"namenode_txn_fmt\") then\n     14:   file \"#{Chef::Config[:file_cache_path]}/nn_fmt.tgz\" do\n     15:     user \"hdfs\"\n     16:     group \"hdfs\"\n>>>  17:     user 0644\n     18:     content Base64.decode64(get_config(\"namenode_txn_fmt\"))\n     19:     not_if { node[:bcpc][:hadoop][:mounts].all? { |d| File.exists?(\"/disk/#{d}/dfs/jn/#{node.chef_environment}/current/VERSION\") } }\n     20:   end\n     21: end\n     22: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"ABF5BD827BD9BF62\"", "line": 112, "detection_span": [107, 117], "with_context": "\n107: apt_repository \"nginx\" do\n108:   action repository_actions[\"nginx\"]\n109:   arch \"amd64\"\n110:   uri \"https://nginx.org/packages/ubuntu\"\n111:   components [\"nginx\"]\n112:   key \"ABF5BD827BD9BF62\"\n113: end\n114:\n115: apt_repository \"elasticsearch5.x\" do\n116:   action repository_actions[\"elasticsearch5.x\"]\n117:   uri \"https://artifacts.elastic.co/packages/5.x/apt\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 112\n\n    107: apt_repository \"nginx\" do\n    108:   action repository_actions[\"nginx\"]\n    109:   arch \"amd64\"\n    110:   uri \"https://nginx.org/packages/ubuntu\"\n    111:   components [\"nginx\"]\n>>> 112:   key \"ABF5BD827BD9BF62\"\n    113: end\n    114: \n    115: apt_repository \"elasticsearch5.x\" do\n    116:   action repository_actions[\"elasticsearch5.x\"]\n    117:   uri \"https://artifacts.elastic.co/packages/5.x/apt\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_core-recipes-cronjob.rb", "content": "user    job['user']    || \"root\"", "line": 22, "detection_span": [17, 27], "with_context": "\nhour    job['hour']    || \"*\"\nday     job['day']     || \"*\"\nmonth   job['month']   || \"*\"\nweekday job['weekday'] || \"*\"\ncommand job['command']\n22:     user    job['user']    || \"root\"\nmailto  job['mailto']  || node[:imos_core][:cronjob][:email_address]\npath    job['path']\nhome    job['home']\nshell   job['shell']\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_core-recipes-cronjob.rb\n# Target line: 22\n\n     17:     hour    job['hour']    || \"*\"\n     18:     day     job['day']     || \"*\"\n     19:     month   job['month']   || \"*\"\n     20:     weekday job['weekday'] || \"*\"\n     21:     command job['command']\n>>>  22:     user    job['user']    || \"root\"\n     23:     mailto  job['mailto']  || node[:imos_core][:cronjob][:email_address]\n     24:     path    job['path']\n     25:     home    job['home']\n     26:     shell   job['shell']\n     27:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']        = 'nginx'", "line": 47, "detection_span": [42, 52], "with_context": "\ndefault['nginx']['init_style'] = 'runit'\nif platform == 'ubuntu' && platform_version == '14.04'\ndefault['nginx']['pid'] = '/run/nginx.pid'\nend\nwhen 'rhel', 'fedora'\n47:   default['nginx']['user']        = 'nginx'\ndefault['nginx']['init_style']  = 'init'\ndefault['nginx']['repo_source'] = 'epel'\nwhen 'gentoo'\ndefault['nginx']['user']       = 'nginx'\ndefault['nginx']['init_style'] = 'init'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb\n# Target line: 47\n\n     42:   default['nginx']['init_style'] = 'runit'\n     43:   if platform == 'ubuntu' && platform_version == '14.04'\n     44:     default['nginx']['pid'] = '/run/nginx.pid'\n     45:   end\n     46: when 'rhel', 'fedora'\n>>>  47:   default['nginx']['user']        = 'nginx'\n     48:   default['nginx']['init_style']  = 'init'\n     49:   default['nginx']['repo_source'] = 'epel'\n     50: when 'gentoo'\n     51:   default['nginx']['user']       = 'nginx'\n     52:   default['nginx']['init_style'] = 'init'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-check_for_software_updates_daily.rb", "content": "key 'ScheduleFrequency'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Check for software updates daily, not just once per week\" do\ndomain 'com.apple.SoftwareUpdate'\n3:   key 'ScheduleFrequency'\ninteger 1\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-check_for_software_updates_daily.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Check for software updates daily, not just once per week\" do\n      2:   domain 'com.apple.SoftwareUpdate'\n>>>   3:   key 'ScheduleFrequency'\n      4:   integer 1\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "johnfitzpatrick_apache2-chefconf-recipes-mod_cloudflare.rb", "content": "key          'http://pkg.cloudflare.com/pubkey.gpg'", "line": 24, "detection_span": [19, 29], "with_context": "\n\napt_repository 'cloudflare' do\nuri          'http://pkg.cloudflare.com'\ndistribution node['lsb']['codename']\ncomponents   ['main']\n24:   key          'http://pkg.cloudflare.com/pubkey.gpg'\naction       :add\nend\n\npackage 'libapache2-mod-cloudflare' do\nnotifies :restart, 'service[apache2]'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: johnfitzpatrick_apache2-chefconf-recipes-mod_cloudflare.rb\n# Target line: 24\n\n     19: \n     20: apt_repository 'cloudflare' do\n     21:   uri          'http://pkg.cloudflare.com'\n     22:   distribution node['lsb']['codename']\n     23:   components   ['main']\n>>>  24:   key          'http://pkg.cloudflare.com/pubkey.gpg'\n     25:   action       :add\n     26: end\n     27: \n     28: package 'libapache2-mod-cloudflare' do\n     29:   notifies :restart, 'service[apache2]'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_hcatalog.rb", "content": "user \"hive\"", "line": 106, "detection_span": [101, 111], "with_context": "\n101: end\n102:\n103: directory \"/var/log/hive/gc\" do\n104:   action :create\n105:   mode 0755\n106:   user \"hive\"\n107: end\n108:\n109: service \"hive-metastore\" do\n110:   action [:enable, :start]\n111:   subscribes :restart, \"template[/etc/hive/conf/hive-site.xml]\", :delayed", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_hcatalog.rb\n# Target line: 106\n\n    101: end\n    102: \n    103: directory \"/var/log/hive/gc\" do\n    104:   action :create\n    105:   mode 0755\n>>> 106:   user \"hive\"\n    107: end\n    108: \n    109: service \"hive-metastore\" do\n    110:   action [:enable, :start]\n    111:   subscribes :restart, \"template[/etc/hive/conf/hive-site.xml]\", :delayed\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_glance-recipes-replicator.rb", "content": "admin_user \"glance\"", "line": 31, "detection_span": [26, 36], "with_context": "\ncommand \"usermod -s /bin/sh glance\"\nend\n\ndsh_group \"glance\" do\nuser \"glance\"\n31:     admin_user \"glance\"\nend\n\npackage \"glance-image-sync\" do\naction node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\noptions platform_options[\"package_options\"]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_glance-recipes-replicator.rb\n# Target line: 31\n\n     26:     command \"usermod -s /bin/sh glance\"\n     27:   end\n     28:  \n     29:   dsh_group \"glance\" do\n     30:     user \"glance\"\n>>>  31:     admin_user \"glance\"\n     32:   end\n     33: \n     34:   package \"glance-image-sync\" do\n     35:     action node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\n     36:     options platform_options[\"package_options\"]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_allow_text_selection_in_quick_look.rb", "content": "key 'QLEnableTextSelection'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Finder: allow text selection in Quick Look\" do\ndomain 'com.apple.finder'\n3:   key 'QLEnableTextSelection'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_allow_text_selection_in_quick_look.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Finder: allow text selection in Quick Look\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'QLEnableTextSelection'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"D27D666CD88E42B4\"", "line": 128, "detection_span": [123, 133], "with_context": "\n123: apt_repository \"elasticsearch6.x\" do\n124:   action repository_actions[\"elasticsearch6.x\"]\n125:   uri \"https://artifacts.elastic.co/packages/6.x/apt\"\n126:   distribution \"stable\"\n127:   components [\"main\"]\n128:   key \"D27D666CD88E42B4\"\n129: end\n130:\n131: apt_repository \"passenger\" do\n132:   action repository_actions[\"passenger\"]\n133:   uri \"https://oss-binaries.phusionpassenger.com/apt/passenger\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 128\n\n    123: apt_repository \"elasticsearch6.x\" do\n    124:   action repository_actions[\"elasticsearch6.x\"]\n    125:   uri \"https://artifacts.elastic.co/packages/6.x/apt\"\n    126:   distribution \"stable\"\n    127:   components [\"main\"]\n>>> 128:   key \"D27D666CD88E42B4\"\n    129: end\n    130: \n    131: apt_repository \"passenger\" do\n    132:   action repository_actions[\"passenger\"]\n    133:   uri \"https://oss-binaries.phusionpassenger.com/apt/passenger\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "criteo-cookbooks_nexus3-attributes-api.rb", "content": "default['nexus3']['api']['username'] = 'admin'", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault['nexus3']['api']['script_cookbook'] = 'nexus3'\ndefault['nexus3']['api']['type'] = 'groovy'\ndefault['nexus3']['api']['endpoint'] = 'http://localhost:8081/service/rest/v1/script/'\n4: default['nexus3']['api']['username'] = 'admin'\ndefault['nexus3']['api']['password'] = 'admin123'\ndefault['nexus3']['api']['ignore_failure'] = true\ndefault['nexus3']['api']['live_stream'] = false\ndefault['nexus3']['api']['wait'] = 600 # 10 minutes\ndefault['nexus3']['api']['sensitive'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_nexus3-attributes-api.rb\n# Target line: 4\n\n      1: default['nexus3']['api']['script_cookbook'] = 'nexus3'\n      2: default['nexus3']['api']['type'] = 'groovy'\n      3: default['nexus3']['api']['endpoint'] = 'http://localhost:8081/service/rest/v1/script/'\n>>>   4: default['nexus3']['api']['username'] = 'admin'\n      5: default['nexus3']['api']['password'] = 'admin123'\n      6: default['nexus3']['api']['ignore_failure'] = true\n      7: default['nexus3']['api']['live_stream'] = false\n      8: default['nexus3']['api']['wait'] = 600 # 10 minutes\n      9: default['nexus3']['api']['sensitive'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-nginx-attributes-default.rb", "content": "set[:nginx][:user]    = \"vagrant\"", "line": 12, "detection_span": [7, 17], "with_context": "\nset[:nginx][:user]    = \"vagrant\"\nset[:nginx][:binary]  = \"/usr/sbin/nginx\"\nelse\nset[:nginx][:dir]     = \"/etc/nginx\"\nset[:nginx][:log_dir] = \"/var/log/nginx\"\n12:   set[:nginx][:user]    = \"vagrant\"\nset[:nginx][:binary]  = \"/usr/sbin/nginx\"\nend\n\ndefault[:nginx][:gzip] = \"on\"\ndefault[:nginx][:gzip_http_version] = \"1.0\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-nginx-attributes-default.rb\n# Target line: 12\n\n      7:   set[:nginx][:user]    = \"vagrant\"\n      8:   set[:nginx][:binary]  = \"/usr/sbin/nginx\"\n      9: else\n     10:   set[:nginx][:dir]     = \"/etc/nginx\"\n     11:   set[:nginx][:log_dir] = \"/var/log/nginx\"\n>>>  12:   set[:nginx][:user]    = \"vagrant\"\n     13:   set[:nginx][:binary]  = \"/usr/sbin/nginx\"\n     14: end\n     15: \n     16: default[:nginx][:gzip] = \"on\"\n     17: default[:nginx][:gzip_http_version] = \"1.0\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-repo-attributes-default.rb", "content": "default[:repo][:root]      = \"/var/packages\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:repo][:root]      = \"/var/packages\"\n\n#\n# Keys\n#\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-repo-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:repo][:root]      = \"/var/packages\"\n      2: \n      3: #\n      4: # Keys\n      5: #\n      6: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-default.rb", "content": "default['openstack']['orchestration']['user'] = 'heat'", "line": 76, "detection_span": [71, 81], "with_context": "\n'heat_engine_service' => 'openstack-heat-engine',\n'heat_api_process_name' => 'heat-api',\n'package_overrides' => '',\n}\nwhen 'debian'\n76:   default['openstack']['orchestration']['user'] = 'heat'\ndefault['openstack']['orchestration']['group'] = 'heat'\ndefault['openstack']['orchestration']['platform'] = {\n'heat_common_packages' => %w(heat-common python3-heat),\n'heat_api_packages' => %w(heat-api),\n'heat_dashboard_packages' => %w(python3-heat-dashboard),", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-default.rb\n# Target line: 76\n\n     71:     'heat_engine_service' => 'openstack-heat-engine',\n     72:     'heat_api_process_name' => 'heat-api',\n     73:     'package_overrides' => '',\n     74:   }\n     75: when 'debian'\n>>>  76:   default['openstack']['orchestration']['user'] = 'heat'\n     77:   default['openstack']['orchestration']['group'] = 'heat'\n     78:   default['openstack']['orchestration']['platform'] = {\n     79:     'heat_common_packages' => %w(heat-common python3-heat),\n     80:     'heat_api_packages' => %w(heat-api),\n     81:     'heat_dashboard_packages' => %w(python3-heat-dashboard),\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef_supermarket-omnibus-cookbooks-omnibus-supermarket-recipes-ssl.rb", "content": "key_length 2048", "line": 39, "detection_span": [34, 44], "with_context": "\nsupermarket_ca_dir = File.join(node['supermarket']['ssl']['directory'], 'ca')\nssl_dhparam = File.join(supermarket_ca_dir, 'dhparams.pem')\n\n# Generate dhparams.pem for perfect forward secrecy\nopenssl_dhparam ssl_dhparam do\n39:     key_length 2048\ngenerator 2\nowner 'root'\ngroup 'root'\nmode '0644'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef_supermarket-omnibus-cookbooks-omnibus-supermarket-recipes-ssl.rb\n# Target line: 39\n\n     34:   supermarket_ca_dir = File.join(node['supermarket']['ssl']['directory'], 'ca')\n     35:   ssl_dhparam = File.join(supermarket_ca_dir, 'dhparams.pem')\n     36: \n     37:   # Generate dhparams.pem for perfect forward secrecy\n     38:   openssl_dhparam ssl_dhparam do\n>>>  39:     key_length 2048\n     40:     generator 2\n     41:     owner 'root'\n     42:     group 'root'\n     43:     mode '0644'\n     44:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-nova-common.rb", "content": "admin_user \"nova\"", "line": 103, "detection_span": [98, 108], "with_context": "\nnot_if 'test $(getent passwd nova |cut -f7 -d:) = /bin/sh'\nend\n100:\n101: dsh_group \"nova\" do\n102:   user \"nova\"\n103:   admin_user \"nova\"\n104:   group \"nova\"\n105: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-common.rb\n# Target line: 103\n\n     98:   not_if 'test $(getent passwd nova |cut -f7 -d:) = /bin/sh'\n     99: end\n    100: \n    101: dsh_group \"nova\" do\n    102:   user \"nova\"\n>>> 103:   admin_user \"nova\"\n    104:   group \"nova\"\n    105: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb", "content": "recaptcha_public_key \"6LflIQATAAAAAMXyDWpba-FgipVzE-aGF4HIR59N\"", "line": 44, "detection_span": [39, 49], "with_context": "\nlogo \"/w/skins/OSMFoundation/img/logo.png\"\nemail_contact \"webmaster@openstreetmap.org\"\nemail_sender \"webmaster@openstreetmap.org\"\nemail_sender_name \"OSMF Wiki\"\nprivate_accounts true\n44:   recaptcha_public_key \"6LflIQATAAAAAMXyDWpba-FgipVzE-aGF4HIR59N\"\nrecaptcha_private_key passwords[\"wiki\"][\"recaptcha\"]\nextra_file_extensions [\"mp3\"]\nversion \"1.37\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb\n# Target line: 44\n\n     39:   logo \"/w/skins/OSMFoundation/img/logo.png\"\n     40:   email_contact \"webmaster@openstreetmap.org\"\n     41:   email_sender \"webmaster@openstreetmap.org\"\n     42:   email_sender_name \"OSMF Wiki\"\n     43:   private_accounts true\n>>>  44:   recaptcha_public_key \"6LflIQATAAAAAMXyDWpba-FgipVzE-aGF4HIR59N\"\n     45:   recaptcha_private_key passwords[\"wiki\"][\"recaptcha\"]\n     46:   extra_file_extensions [\"mp3\"]\n     47:   version \"1.37\"\n     48: end\n     49: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_tomcat-recipes-setup_server_6.rb", "content": "node[:app][:user] = \"tomcat6\"", "line": 19, "detection_span": [14, 24], "with_context": "\nlog \"  Setting tomcat version to #{version}\"\n\n# Defining appplication user and group attributes depending on platform\ncase node[:platform]\nwhen \"ubuntu\"\n19:   node[:app][:user] = \"tomcat6\"\nnode[:app][:group] = \"tomcat6\"\nnode[:app_tomcat][:configuration_file_path] = \"/etc/default/tomcat#{version}\"\nif node[:platform_version] == \"10.04\"\nnode[:app_tomcat][:jkworkersfile] = \"/etc/tomcat#{version}/workers.properties\"\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-app_tomcat-recipes-setup_server_6.rb\n# Target line: 19\n\n     14: log \"  Setting tomcat version to #{version}\"\n     15: \n     16: # Defining appplication user and group attributes depending on platform\n     17: case node[:platform]\n     18: when \"ubuntu\"\n>>>  19:   node[:app][:user] = \"tomcat6\"\n     20:   node[:app][:group] = \"tomcat6\"\n     21:   node[:app_tomcat][:configuration_file_path] = \"/etc/default/tomcat#{version}\"\n     22:   if node[:platform_version] == \"10.04\"\n     23:     node[:app_tomcat][:jkworkersfile] = \"/etc/tomcat#{version}/workers.properties\"\n     24:   else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-diamond-attributes-default.rb", "content": "default['diamond']['mysqlhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 3306, \"username\" => nil, \"password\" => nil, \"database\" => \"diamond\", \"table\" => \"metrics\", \"col_time\" => \"timestamp\", \"col_metric\" => \"metric\", \"col_value\" => \"value\" }", "line": 28, "detection_span": [23, 33], "with_context": "\ndefault['diamond']['graphite_handler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2003, \"batch\" => 256, \"timeout\" => 15 }\ndefault['diamond']['graphite_picklehandler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2004, \"batch\" => 256, \"timeout\" => 15 }\ndefault['diamond']['statsdhandler'][0] = { \"host\" => \"iad-statsd101.ihr\", \"port\" => 8125 }\ndefault['diamond']['statsdhandler'][1] = { \"host\" => \"iad-statsd102.ihr\", \"port\" => 8125 }\ndefault['diamond']['tsdbhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 4242, \"timeout\" => 15 }\n28: default['diamond']['mysqlhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 3306, \"username\" => nil, \"password\" => nil, \"database\" => \"diamond\", \"table\" => \"metrics\", \"col_time\" => \"timestamp\", \"col_metric\" => \"metric\", \"col_value\" => \"value\" }\ndefault['diamond']['collectors'] = { \"hostname_method\" => \"smart\", \"hostname\" => nil, \"path_prefix\" => nil, \"path_suffix\" => nil, \"interval\" => 60 }\n\ndefault['diamond']['force_install'] = false\ndefault['diamond']['add_collectors'] = ['cpu', 'diskspace', 'diskusage', 'loadavg', 'memory', 'sockstat', 'vmstat', 'network']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-diamond-attributes-default.rb\n# Target line: 28\n\n     23: default['diamond']['graphite_handler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2003, \"batch\" => 256, \"timeout\" => 15 }\n     24: default['diamond']['graphite_picklehandler'] = { \"host\" => \"iad-graphite101.ihr\", \"port\" => 2004, \"batch\" => 256, \"timeout\" => 15 }\n     25: default['diamond']['statsdhandler'][0] = { \"host\" => \"iad-statsd101.ihr\", \"port\" => 8125 }\n     26: default['diamond']['statsdhandler'][1] = { \"host\" => \"iad-statsd102.ihr\", \"port\" => 8125 }\n     27: default['diamond']['tsdbhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 4242, \"timeout\" => 15 }\n>>>  28: default['diamond']['mysqlhandler'] = { \"host\" => \"127.0.0.1\", \"port\" => 3306, \"username\" => nil, \"password\" => nil, \"database\" => \"diamond\", \"table\" => \"metrics\", \"col_time\" => \"timestamp\", \"col_metric\" => \"metric\", \"col_value\" => \"value\" }\n     29: default['diamond']['collectors'] = { \"hostname_method\" => \"smart\", \"hostname\" => nil, \"path_prefix\" => nil, \"path_suffix\" => nil, \"interval\" => 60 }\n     30: \n     31: default['diamond']['force_install'] = false\n     32: default['diamond']['add_collectors'] = ['cpu', 'diskspace', 'diskusage', 'loadavg', 'memory', 'sockstat', 'vmstat', 'network']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~delete_target_ssl_proxy.rb", "content": "certificate '-----BEGIN CERTIFICATE-----", "line": 106, "detection_span": [101, 111], "with_context": "\n101: gcompute_ssl_certificate 'chef-e2e-sample-certificate' do\n102:   action :create\n103:   description 'A certificate for test purposes only.'\n104:   project ENV['PROJECT'] # ex: 'my-test-project'\n105:   credential 'mycred'\n106:   certificate '-----BEGIN CERTIFICATE-----\n107: MIICqjCCAk+gAwIBAgIJAIuJ+0352Kq4MAoGCCqGSM49BAMCMIGwMQswCQYDVQQG\n108: EwJVUzETMBEGA1UECAwKV2FzaGluZ3RvbjERMA8GA1UEBwwIS2lya2xhbmQxFTAT\n109: BgNVBAoMDEdvb2dsZSwgSW5jLjEeMBwGA1UECwwVR29vZ2xlIENsb3VkIFBsYXRm\n110: b3JtMR8wHQYDVQQDDBZ3d3cubXktc2VjdXJlLXNpdGUuY29tMSEwHwYJKoZIhvcN\n111: AQkBFhJuZWxzb25hQGdvb2dsZS5jb20wHhcNMTcwNjI4MDQ1NjI2WhcNMjcwNjI2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~delete_target_ssl_proxy.rb\n# Target line: 106\n\n    101: gcompute_ssl_certificate 'chef-e2e-sample-certificate' do\n    102:   action :create\n    103:   description 'A certificate for test purposes only.'\n    104:   project ENV['PROJECT'] # ex: 'my-test-project'\n    105:   credential 'mycred'\n>>> 106:   certificate '-----BEGIN CERTIFICATE-----\n    107: MIICqjCCAk+gAwIBAgIJAIuJ+0352Kq4MAoGCCqGSM49BAMCMIGwMQswCQYDVQQG\n    108: EwJVUzETMBEGA1UECAwKV2FzaGluZ3RvbjERMA8GA1UEBwwIS2lya2xhbmQxFTAT\n    109: BgNVBAoMDEdvb2dsZSwgSW5jLjEeMBwGA1UECwwVR29vZ2xlIENsb3VkIFBsYXRm\n    110: b3JtMR8wHQYDVQQDDBZ3d3cubXktc2VjdXJlLXNpdGUuY29tMSEwHwYJKoZIhvcN\n    111: AQkBFhJuZWxzb25hQGdvb2dsZS5jb20wHhcNMTcwNjI4MDQ1NjI2WhcNMjcwNjI2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-postgresql-resources-user.rb", "content": "password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"", "line": 35, "detection_span": [30, 40], "with_context": "\nproperty :createdb, :kind_of => [TrueClass, FalseClass], :default => false\nproperty :createrole, :kind_of => [TrueClass, FalseClass], :default => false\nproperty :replication, :kind_of => [TrueClass, FalseClass], :default => false\n\naction :create do\n35:   password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\nsuperuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\ncreatedb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\ncreaterole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\nreplication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-postgresql-resources-user.rb\n# Target line: 35\n\n     30: property :createdb, :kind_of => [TrueClass, FalseClass], :default => false\n     31: property :createrole, :kind_of => [TrueClass, FalseClass], :default => false\n     32: property :replication, :kind_of => [TrueClass, FalseClass], :default => false\n     33: \n     34: action :create do\n>>>  35:   password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\n     36:   superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\n     37:   createdb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\n     38:   createrole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\n     39:   replication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n     40: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sensu_sensu-chef-recipes-_windows.rb", "content": "password Sensu::Helpers.random_password(20, true, true, true, true)", "line": 41, "detection_span": [36, 46], "with_context": "\nelsif node['platform_version'].to_f == 10.0\nversion = '2016'\nend\n\nuser node[\"sensu\"][\"user\"] do\n41:   password Sensu::Helpers.random_password(20, true, true, true, true)\nnot_if { Sensu::Helpers.windows_user_exists?(node[\"sensu\"][\"user\"]) }\nend\n\ngroup node[\"sensu\"][\"group\"] do\nmembers node[\"sensu\"][\"user\"]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sensu_sensu-chef-recipes-_windows.rb\n# Target line: 41\n\n     36: elsif node['platform_version'].to_f == 10.0\n     37:   version = '2016'\n     38: end\n     39: \n     40: user node[\"sensu\"][\"user\"] do\n>>>  41:   password Sensu::Helpers.random_password(20, true, true, true, true)\n     42:   not_if { Sensu::Helpers.windows_user_exists?(node[\"sensu\"][\"user\"]) }\n     43: end\n     44: \n     45: group node[\"sensu\"][\"group\"] do\n     46:   members node[\"sensu\"][\"user\"]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-base-recipes-ssh_keys.rb", "content": "node.set[:resolved_ssh_keys][user] = [] unless node.resolved_ssh_keys[user]", "line": 22, "detection_span": [17, 27], "with_context": "\nconfig[\"optional_users\"].each do |user|\nusers << user if get_home(user, true) && !users.include?(user)\nend\nend\nusers.each do |user|\n22:           node.set[:resolved_ssh_keys][user] = [] unless node.resolved_ssh_keys[user]\nnode.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + config[\"keys\"] if config[\"keys\"]\nif config[\"ref\"]\nconfig[\"ref\"].each do |k|\nnode.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + node.ssh_keys[k][\"keys\"]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-base-recipes-ssh_keys.rb\n# Target line: 22\n\n     17:           config[\"optional_users\"].each do |user|\n     18:             users << user if get_home(user, true) && !users.include?(user)\n     19:           end\n     20:         end\n     21:         users.each do |user|\n>>>  22:           node.set[:resolved_ssh_keys][user] = [] unless node.resolved_ssh_keys[user]\n     23:           node.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + config[\"keys\"] if config[\"keys\"]\n     24:           if config[\"ref\"]\n     25:             config[\"ref\"].each do |k|\n     26:               node.set[:resolved_ssh_keys][user] = node.resolved_ssh_keys[user] + node.ssh_keys[k][\"keys\"]\n     27:             end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_rsync-attributes-default.rb", "content": "default['imos_rsync']['user'] = 'rsync'", "line": 13, "detection_span": [8, 18], "with_context": "\n# Logging directory\ndefault['imos_rsync']['log_dir']      = \"/var/log/rsyncd\"\ndefault['imos_rsync']['incoming_dir'] = \"/var/lib/incoming\"\n\n# User for chroot rsync uploads\n13: default['imos_rsync']['user'] = 'rsync'\n# Be part of 'users' group so you rsync_chroot can share directories with FTP\ndefault['imos_rsync']['group'] = 'users'\n\n# Create or not destination directories for imos_rsync::chroot. Usually\n# ftp_dir_tree will create them", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_rsync-attributes-default.rb\n# Target line: 13\n\n      8: # Logging directory\n      9: default['imos_rsync']['log_dir']      = \"/var/log/rsyncd\"\n     10: default['imos_rsync']['incoming_dir'] = \"/var/lib/incoming\"\n     11: \n     12: # User for chroot rsync uploads\n>>>  13: default['imos_rsync']['user'] = 'rsync'\n     14: # Be part of 'users' group so you rsync_chroot can share directories with FTP\n     15: default['imos_rsync']['group'] = 'users'\n     16: \n     17: # Create or not destination directories for imos_rsync::chroot. Usually\n     18: # ftp_dir_tree will create them\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb", "content": "params[:svn_password] = nil", "line": 61, "detection_span": [56, 66], "with_context": "\nenable_submodules = false\nelse\nscm_prov = Chef::Provider::Git\nsvn_args = nil\nparams[:svn_username] = nil\n61:     params[:svn_password] = nil\nenable_submodules = true\nend\n\nlog \"  Capistrano deployment will use #{scm_prov} for initialization\"\n# Creating capistrano deployment", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb\n# Target line: 61\n\n     56:     enable_submodules = false\n     57:   else\n     58:     scm_prov = Chef::Provider::Git\n     59:     svn_args = nil\n     60:     params[:svn_username] = nil\n>>>  61:     params[:svn_password] = nil\n     62:     enable_submodules = true\n     63:   end\n     64: \n     65:   log \"  Capistrano deployment will use #{scm_prov} for initialization\"\n     66:   # Creating capistrano deployment\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_keystone-providers-service.rb", "content": "service_key = \"type\"", "line": 102, "detection_span": [97, 107], "with_context": "\n# Construct the extension path\npath = \"/#{api_ver}/OS-KSADM/services\"\n\n100:   # lookup service_uuid\n101:   service_container = \"OS-KSADM:services\"\n102:   service_key = \"type\"\n103:   service_path = \"/#{api_ver}/OS-KSADM/services\"\n104:   service_uuid, service_error = find_value(http, service_path, headers, service_container, service_key, svc_type, 'id')\n105:   Chef::Log.error(\"There was an error looking up Service '#{svc_type}'\") if service_error\n106:\n107:   # See if the service exists yet", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_keystone-providers-service.rb\n# Target line: 102\n\n     97:   # Construct the extension path\n     98:   path = \"/#{api_ver}/OS-KSADM/services\"\n     99: \n    100:   # lookup service_uuid\n    101:   service_container = \"OS-KSADM:services\"\n>>> 102:   service_key = \"type\"\n    103:   service_path = \"/#{api_ver}/OS-KSADM/services\"\n    104:   service_uuid, service_error = find_value(http, service_path, headers, service_container, service_key, svc_type, 'id')\n    105:   Chef::Log.error(\"There was an error looking up Service '#{svc_type}'\") if service_error\n    106: \n    107:   # See if the service exists yet\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-resource_manager.rb", "content": "user \"mapred\"", "line": 85, "detection_span": [80, 90], "with_context": "\nsubscribes :restart, \"template[/etc/hadoop/conf/yarn-site.xml]\", :delayed\nend\n\nbash \"reload mapreduce nodes\" do\ncode \"yarn rmadmin -refreshNodes\"\n85:   user \"mapred\"\naction :nothing\nsubscribes :run, \"template[/etc/hadoop/conf/yarn.exclude]\", :delayed\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-hadoop-recipes-resource_manager.rb\n# Target line: 85\n\n     80:   subscribes :restart, \"template[/etc/hadoop/conf/yarn-site.xml]\", :delayed\n     81: end\n     82: \n     83: bash \"reload mapreduce nodes\" do\n     84:   code \"yarn rmadmin -refreshNodes\"\n>>>  85:   user \"mapred\"\n     86:   action :nothing\n     87:   subscribes :run, \"template[/etc/hadoop/conf/yarn.exclude]\", :delayed\n     88: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-recipes-undeploy.rb", "content": "user node['deployer']['user'] || 'root'", "line": 21, "detection_span": [16, 26], "with_context": "\n\nfire_hook(:before_undeploy, items: databases + [source, framework, appserver, worker, webserver])\n\ndeploy application['shortname'] do\ndeploy_to deploy_dir(application)\n21:     user node['deployer']['user'] || 'root'\ngroup www_group\n\n[appserver, webserver].each do |server|\nserver.notifies[:undeploy].each do |config|\nnotifies config[:action],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-recipes-undeploy.rb\n# Target line: 21\n\n     16: \n     17:   fire_hook(:before_undeploy, items: databases + [source, framework, appserver, worker, webserver])\n     18: \n     19:   deploy application['shortname'] do\n     20:     deploy_to deploy_dir(application)\n>>>  21:     user node['deployer']['user'] || 'root'\n     22:     group www_group\n     23: \n     24:     [appserver, webserver].each do |server|\n     25:       server.notifies[:undeploy].each do |config|\n     26:         notifies config[:action],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-recipes-bootstrap.rb", "content": "user  'vagrant'", "line": 61, "detection_span": [56, 66], "with_context": "\nbash 'Update chef-bcpc-repo rights' do\ncode 'setfacl -R -m g:vagrant:rwX /home/vagrant/chef-bcpc-repo; find /home/vagrant/chef-bcpc-repo -type d | xargs setfacl -R -m d:g:vagrant:rwX'\nend\n\ncron 'synchronize chef' do\n61:   user  'vagrant'\nhome '/home/vagrant'\ncommand \"cd ~/chef-bcpc; git pull local master; knife role from file roles/*.json; knife cookbook upload -a; knife environment from file environments/#{node.chef_environment}.json\"\nend\n\npackage 'sshpass'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-recipes-bootstrap.rb\n# Target line: 61\n\n     56: bash 'Update chef-bcpc-repo rights' do\n     57:   code 'setfacl -R -m g:vagrant:rwX /home/vagrant/chef-bcpc-repo; find /home/vagrant/chef-bcpc-repo -type d | xargs setfacl -R -m d:g:vagrant:rwX'\n     58: end\n     59: \n     60: cron 'synchronize chef' do\n>>>  61:   user  'vagrant'\n     62:   home '/home/vagrant'\n     63:   command \"cd ~/chef-bcpc; git pull local master; knife role from file roles/*.json; knife cookbook upload -a; knife environment from file environments/#{node.chef_environment}.json\"\n     64: end\n     65: \n     66: package 'sshpass'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-pig-cookbooks-flume-attributes-default.rb", "content": "default[:flume][:user]                = 'flume'", "line": 27, "detection_span": [22, 32], "with_context": "\ndefault[:flume][:agent ][:file_limit] = 65536\ndefault[:flume][:master][:file_limit] = 65536\n\ndefault[:flume][:zk]                  = Mash.new\ndefault[:flume][:collector]           = Mash.new\n27: default[:flume][:user]                = 'flume'\n\ndefault[:users ]['flume'][:uid]       = 325\ndefault[:groups]['flume'][:gid]       = 325\n\n# these are set by the recipes", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-pig-cookbooks-flume-attributes-default.rb\n# Target line: 27\n\n     22: default[:flume][:agent ][:file_limit] = 65536\n     23: default[:flume][:master][:file_limit] = 65536\n     24: \n     25: default[:flume][:zk]                  = Mash.new\n     26: default[:flume][:collector]           = Mash.new\n>>>  27: default[:flume][:user]                = 'flume'\n     28: \n     29: default[:users ]['flume'][:uid]       = 325\n     30: default[:groups]['flume'][:gid]       = 325\n     31: \n     32: # these are set by the recipes\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-users.rb", "content": "password '$1$gkl9sSWg$U9aIhckrcXwr08PLbx7NG1'", "line": 27, "detection_span": [22, 32], "with_context": "\ncomment 'osm data'\nuid '1201'\ngid 'osmdata'\nshell '/bin/bash'\nhome '/home/osmdata'\n27:   password '$1$gkl9sSWg$U9aIhckrcXwr08PLbx7NG1'\nsystem false\naction :create\nnot_if \"getent passwd osmdata\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-users.rb\n# Target line: 27\n\n     22:   comment 'osm data'\n     23:   uid '1201'\n     24:   gid 'osmdata'\n     25:   shell '/bin/bash'\n     26:   home '/home/osmdata'\n>>>  27:   password '$1$gkl9sSWg$U9aIhckrcXwr08PLbx7NG1'\n     28:   system false\n     29:   action :create\n     30:   not_if \"getent passwd osmdata\"\n     31: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-bootstrap.rb", "content": "pivotal_key_path = \"/etc/opscode/pivotal.pem\"", "line": 26, "detection_span": [21, 31], "with_context": "\nnode['private_chef']['topology'] == \"standalone\" &&\nnode['private_chef']['addons']['install'])\ninclude_recipe \"private-chef::add_ons_wrapper\"\nend\n\n26: pivotal_key_path = \"/etc/opscode/pivotal.pem\"\nif File.exists?(pivotal_key_path)\npivotal_key = OpenSSL::PKey::RSA.new(File.read(pivotal_key_path))\nelse\npivotal_key = OpenSSL::PKey::RSA.generate(2048)\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-bootstrap.rb\n# Target line: 26\n\n     21:     node['private_chef']['topology'] == \"standalone\" &&\n     22:     node['private_chef']['addons']['install'])\n     23:   include_recipe \"private-chef::add_ons_wrapper\"\n     24: end\n     25: \n>>>  26: pivotal_key_path = \"/etc/opscode/pivotal.pem\"\n     27: if File.exists?(pivotal_key_path)\n     28:   pivotal_key = OpenSSL::PKey::RSA.new(File.read(pivotal_key_path))\n     29: else\n     30:   pivotal_key = OpenSSL::PKey::RSA.generate(2048)\n     31: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-elasticsearchnew-attributes-default.rb", "content": "default[:elasticsearchnew][:user] = \"elasticsearch\"", "line": 18, "detection_span": [13, 23], "with_context": "\ndefault[:elasticsearchnew][:deploy_path] = \"/data/apps/elasticsearch\"\ndefault[:elasticsearchnew][:ihrsearch_path] = \"/data/apps/ihr-search\"\ndefault[:elasticsearchnew][:input_path] = \"/data/apps/ihr-search/input\"\ndefault[:elasticsearchnew][:config_path] = \"/data/apps/ihr-search/configs\"\ndefault[:elasticsearchnew][:ihrsearch][:files] = \"configs.tar.gz\"\n18: default[:elasticsearchnew][:user] = \"elasticsearch\"\ndefault[:elasticsearchnew][:group] = \"elasticsearch\"\n# For NFS server\ndefault[:elasticsearchnew][:backup_server] = \"iad-nfs101.ihr\"\ndefault[:elasticsearchnew][:backup_target] = \"/data/backups/elasticsearch\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-elasticsearchnew-attributes-default.rb\n# Target line: 18\n\n     13: default[:elasticsearchnew][:deploy_path] = \"/data/apps/elasticsearch\"\n     14: default[:elasticsearchnew][:ihrsearch_path] = \"/data/apps/ihr-search\"\n     15: default[:elasticsearchnew][:input_path] = \"/data/apps/ihr-search/input\"\n     16: default[:elasticsearchnew][:config_path] = \"/data/apps/ihr-search/configs\"\n     17: default[:elasticsearchnew][:ihrsearch][:files] = \"configs.tar.gz\"\n>>>  18: default[:elasticsearchnew][:user] = \"elasticsearch\"\n     19: default[:elasticsearchnew][:group] = \"elasticsearch\"\n     20: # For NFS server\n     21: default[:elasticsearchnew][:backup_server] = \"iad-nfs101.ihr\"\n     22: default[:elasticsearchnew][:backup_target] = \"/data/backups/elasticsearch\"\n     23: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jboss-attributes-default.rb", "content": "default['jboss']['jdbc']['user'] = 'sa'", "line": 22, "detection_span": [17, 27], "with_context": "\ndefault['jboss']['application'] = 'jboss'\ndefault['jboss']['config'] = 'standalone'\ndefault['jboss']['script'] = 'standalone.sh'\ndefault['jboss']['manage_config_file'] = true\n\n22: default['jboss']['jdbc']['user'] = 'sa'\ndefault['jboss']['jdbc']['passwd'] = ''\ndefault['jboss']['jdbc']['schema'] = ''\ndefault['jboss']['jdbc']['host'] = 'localhost'\ndefault['jboss']['jdbc']['transaction_isolation'] = nil\ndefault['jboss']['jdbc']['driver']['name'] = 'h2'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jboss-attributes-default.rb\n# Target line: 22\n\n     17: default['jboss']['application'] = 'jboss'\n     18: default['jboss']['config'] = 'standalone'\n     19: default['jboss']['script'] = 'standalone.sh'\n     20: default['jboss']['manage_config_file'] = true\n     21: \n>>>  22: default['jboss']['jdbc']['user'] = 'sa'\n     23: default['jboss']['jdbc']['passwd'] = ''\n     24: default['jboss']['jdbc']['schema'] = ''\n     25: default['jboss']['jdbc']['host'] = 'localhost'\n     26: default['jboss']['jdbc']['transaction_isolation'] = nil\n     27: default['jboss']['jdbc']['driver']['name'] = 'h2'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jenkins-attributes-node.rb", "content": "default['jenkins']['node']['user'] = \"jenkins-node\"", "line": 37, "detection_span": [32, 42], "with_context": "\nelse\ndefault['jenkins']['node']['home'] = \"/data/jenkins\"\ndefault['jenkins']['node']['log_dir']  = \"/var/log/jenkins\"\nend\n\n37: default['jenkins']['node']['user'] = \"jenkins-node\"\ndefault['jenkins']['node']['group'] = \"jenkins-node\"\ndefault['jenkins']['node']['name'] = node['fqdn']\ndefault['jenkins']['node']['description'] =\n\"#{node['platform']} #{node['platform_version']} \" <<\n\"[#{node['kernel']['os']} #{node['kernel']['release']} #{node['kernel']['machine']}] \" <<", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-attributes-node.rb\n# Target line: 37\n\n     32: else\n     33:   default['jenkins']['node']['home'] = \"/data/jenkins\"\n     34:   default['jenkins']['node']['log_dir']  = \"/var/log/jenkins\"\n     35: end\n     36: \n>>>  37: default['jenkins']['node']['user'] = \"jenkins-node\"\n     38: default['jenkins']['node']['group'] = \"jenkins-node\"\n     39: default['jenkins']['node']['name'] = node['fqdn']\n     40: default['jenkins']['node']['description'] =\n     41:   \"#{node['platform']} #{node['platform_version']} \" <<\n     42:   \"[#{node['kernel']['os']} #{node['kernel']['release']} #{node['kernel']['machine']}] \" <<\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb", "content": "key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"", "line": 49, "detection_span": [44, 54], "with_context": "\n# because there are very useful features in the newer versions\napt_repository \"rabbitmq\" do\nuri \"http://www.rabbitmq.com/debian/\"\ndistribution \"testing\"\ncomponents [\"main\"]\n49:     key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\naction :add\nend\npackage \"rabbitmq-server\"\nwhen \"redhat\", \"centos\", \"scientific\"\nremote_file \"/tmp/rabbitmq-server-2.6.1-1.noarch.rpm\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-rabbitmq-recipes-default.rb\n# Target line: 49\n\n     44:   # because there are very useful features in the newer versions\n     45:   apt_repository \"rabbitmq\" do\n     46:     uri \"http://www.rabbitmq.com/debian/\"\n     47:     distribution \"testing\"\n     48:     components [\"main\"]\n>>>  49:     key \"http://www.rabbitmq.com/rabbitmq-signing-key-public.asc\"\n     50:     action :add\n     51:   end\n     52:   package \"rabbitmq-server\"\n     53: when \"redhat\", \"centos\", \"scientific\"\n     54:   remote_file \"/tmp/rabbitmq-server-2.6.1-1.noarch.rpm\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jahumes_RailsChef-vendor-cookbooks-backups-recipes-default.rb", "content": "deploy_user = backup_node[:deploy_user] || \"deploy\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# limitations under the License.\n\nbackup_node = node[:backups]\n\nif backup_node\n22:   deploy_user = backup_node[:deploy_user] || \"deploy\"\n\npackage \"ruby1.9.1-dev\"\npackage \"libxml2-dev\"\npackage \"libxslt-dev\"\ngem_package \"backup\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jahumes_RailsChef-vendor-cookbooks-backups-recipes-default.rb\n# Target line: 22\n\n     17: # limitations under the License.\n     18: \n     19: backup_node = node[:backups]\n     20: \n     21: if backup_node\n>>>  22:   deploy_user = backup_node[:deploy_user] || \"deploy\"\n     23: \n     24:   package \"ruby1.9.1-dev\"\n     25:   package \"libxml2-dev\"\n     26:   package \"libxslt-dev\"\n     27:   gem_package \"backup\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_webserver_base.rb", "content": "extensions = { private_key: 'key', certificate: 'crt', chain: 'ca' }", "line": 54, "detection_span": [49, 59], "with_context": "\n\ndef add_ssl_item(name)\nkey_data = app[:ssl_configuration].try(:[], name)\nreturn if key_data.blank?\n\n54:         extensions = { private_key: 'key', certificate: 'crt', chain: 'ca' }\n\nnotifying_template \"#{ssl_cert_dir}/#{app[:domains].first}.#{extensions[name]}\" do\nowner 'root'\ngroup 'root'\nmode name == :private_key ? '0600' : '0644'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-opsworks_ruby-libraries-drivers_webserver_base.rb\n# Target line: 54\n\n     49: \n     50:       def add_ssl_item(name)\n     51:         key_data = app[:ssl_configuration].try(:[], name)\n     52:         return if key_data.blank?\n     53: \n>>>  54:         extensions = { private_key: 'key', certificate: 'crt', chain: 'ca' }\n     55: \n     56:         notifying_template \"#{ssl_cert_dir}/#{app[:domains].first}.#{extensions[name]}\" do\n     57:           owner 'root'\n     58:           group 'root'\n     59:           mode name == :private_key ? '0600' : '0644'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_set_preferred_view_style.rb", "content": "key 'FXPreferredViewStyle'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Update Finder windows to use by default\" do\ndomain 'com.apple.finder'\n3:   key 'FXPreferredViewStyle'\nstring node['osxdefaults']['finder']['preferred_view_style']\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_set_preferred_view_style.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Update Finder windows to use by default\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'FXPreferredViewStyle'\n      4:   string node['osxdefaults']['finder']['preferred_view_style']\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-supervisor-attributes-default.rb", "content": "default['supervisor']['inet_username'] = nil", "line": 23, "detection_span": [18, 28], "with_context": "\n#\n\ndefault['supervisor']['unix_http_server']['chmod'] = '700'\ndefault['supervisor']['unix_http_server']['chown'] = 'root:root'\ndefault['supervisor']['inet_port'] = nil\n23: default['supervisor']['inet_username'] = nil\ndefault['supervisor']['inet_password'] = nil\ncase node['platform_family']\nwhen 'smartos'\ndefault['supervisor']['dir'] = '/opt/local/etc/supervisor.d'\ndefault['supervisor']['conffile'] = '/opt/local/etc/supervisord.conf'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-supervisor-attributes-default.rb\n# Target line: 23\n\n     18: #\n     19: \n     20: default['supervisor']['unix_http_server']['chmod'] = '700'\n     21: default['supervisor']['unix_http_server']['chown'] = 'root:root'\n     22: default['supervisor']['inet_port'] = nil\n>>>  23: default['supervisor']['inet_username'] = nil\n     24: default['supervisor']['inet_password'] = nil\n     25: case node['platform_family']\n     26: when 'smartos'\n     27:   default['supervisor']['dir'] = '/opt/local/etc/supervisor.d'\n     28:   default['supervisor']['conffile'] = '/opt/local/etc/supervisord.conf'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-chef-server-attributes-default.rb", "content": "default['chef_server']['amqp_pass']       = 'testing'", "line": 80, "detection_span": [75, 85], "with_context": "\ndefault['chef_server']['webui_port']      = \"4040\"\ndefault['chef_server']['webui_enabled']   = false\ndefault['chef_server']['solr_heap_size']  = \"256M\"\ndefault['chef_server']['validation_client_name'] = \"chef-validator\"\ndefault['chef_server']['expander_nodes']  = 1\n80: default['chef_server']['amqp_pass']       = 'testing'\ndefault['chef_server']['user']            = 'chef'\ndefault['chef_server']['user_manage_action'] = 'create'\ndefault['chef_server']['user_shell']      = '/bin/sh'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-chef-server-attributes-default.rb\n# Target line: 80\n\n     75: default['chef_server']['webui_port']      = \"4040\"\n     76: default['chef_server']['webui_enabled']   = false\n     77: default['chef_server']['solr_heap_size']  = \"256M\"\n     78: default['chef_server']['validation_client_name'] = \"chef-validator\"\n     79: default['chef_server']['expander_nodes']  = 1\n>>>  80: default['chef_server']['amqp_pass']       = 'testing'\n     81: default['chef_server']['user']            = 'chef'\n     82: default['chef_server']['user_manage_action'] = 'create'\n     83: default['chef_server']['user_shell']      = '/bin/sh'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-etl_jobs-attributes-default.rb", "content": "default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"", "line": 36, "detection_span": [31, 41], "with_context": "\ndefault[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\ndefault[:etl][:event_job][:log_directory] = \"/data/log/event\"\nelse\ndefault[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://iad-dwh.prod.ihr:1433;databaseName=IHRDWH\"\ndefault[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\n36:   default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\ndefault[:etl][:event_job][:archive_directory] = \"/isilon/event/processed\"\ndefault[:etl][:event_job][:source_directory] = \"/isilon/event/\"\ndefault[:etl][:event_job][:log_directory] = \"/isilon/event/\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-etl_jobs-attributes-default.rb\n# Target line: 36\n\n     31:   default[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\n     32:   default[:etl][:event_job][:log_directory] = \"/data/log/event\"\n     33: else\n     34:   default[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://iad-dwh.prod.ihr:1433;databaseName=IHRDWH\"\n     35:   default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\n>>>  36:   default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\n     37:   default[:etl][:event_job][:archive_directory] = \"/isilon/event/processed\"\n     38:   default[:etl][:event_job][:source_directory] = \"/isilon/event/\"\n     39:   default[:etl][:event_job][:log_directory] = \"/isilon/event/\"\n     40: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-zookeeper-attributes-default.rb", "content": "default['zookeeper']['user'] = 'zookeeper'", "line": 25, "detection_span": [20, 30], "with_context": "\n# General settings\ndefault['zookeeper']['install_dir'] = '/usr/share/zookeeper'\ndefault['zookeeper']['conf_dir'] = '/etc/zookeeper'\ndefault['zookeeper']['data_dir'] = '/var/lib/zookeeper'\ndefault['zookeeper']['log_dir'] = '/var/log/zookeeper'\n25: default['zookeeper']['user'] = 'zookeeper'\ndefault['zookeeper']['tarball'] =\n'http://www.apache.si/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz'\ndefault['zookeeper']['checksum'] =\n'7f7f5414e044ac11fee2a1e0bc225469f51fb0cdf821e67df762a43098223f27'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-zookeeper-attributes-default.rb\n# Target line: 25\n\n     20: # General settings\n     21: default['zookeeper']['install_dir'] = '/usr/share/zookeeper'\n     22: default['zookeeper']['conf_dir'] = '/etc/zookeeper'\n     23: default['zookeeper']['data_dir'] = '/var/lib/zookeeper'\n     24: default['zookeeper']['log_dir'] = '/var/log/zookeeper'\n>>>  25: default['zookeeper']['user'] = 'zookeeper'\n     26: default['zookeeper']['tarball'] =\n     27:   'http://www.apache.si/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz'\n     28: default['zookeeper']['checksum'] =\n     29:   '7f7f5414e044ac11fee2a1e0bc225469f51fb0cdf821e67df762a43098223f27'\n     30: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-lb-recipes-do_attach_all.rb", "content": "node[:lb][:threshold][pool_name][uuid] = nil # Sets to nil since chef does not delete the key so we can only alter it.", "line": 84, "detection_span": [79, 89], "with_context": "\n# See cookbooks/lb_<provider>/providers/default.rb for the \"detach\" action.\nlb pool_name do\nbackend_id uuid\naction :detach\nend\n84:       node[:lb][:threshold][pool_name][uuid] = nil # Sets to nil since chef does not delete the key so we can only alter it.\napp_servers_detached += 1\nelse\nlog \"  Threshold not reached for #{uuid} : #{node[:lb][:threshold][pool_name][uuid]}\"\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-lb-recipes-do_attach_all.rb\n# Target line: 84\n\n     79:       # See cookbooks/lb_<provider>/providers/default.rb for the \"detach\" action.\n     80:       lb pool_name do\n     81:         backend_id uuid\n     82:         action :detach\n     83:       end\n>>>  84:       node[:lb][:threshold][pool_name][uuid] = nil # Sets to nil since chef does not delete the key so we can only alter it.\n     85:       app_servers_detached += 1\n     86:     else\n     87:       log \"  Threshold not reached for #{uuid} : #{node[:lb][:threshold][pool_name][uuid]}\"\n     88:     end\n     89:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['proxy_password'] = nil", "line": 75, "detection_span": [70, 80], "with_context": "\ndefault['yum']['main']['pluginpath'] = nil\ndefault['yum']['main']['plugins'] = nil # [true, false]\ndefault['yum']['main']['protected_multilib'] = nil\ndefault['yum']['main']['protected_packages'] = nil\ndefault['yum']['main']['proxy'] = nil\n75: default['yum']['main']['proxy_password'] = nil\ndefault['yum']['main']['proxy_username'] = nil\ndefault['yum']['main']['password'] = nil\ndefault['yum']['main']['recent'] = nil # /^\\d+$/\ndefault['yum']['main']['repo_gpgcheck'] = nil # [true, false]\ndefault['yum']['main']['reposdir'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-yum-attributes-main.rb\n# Target line: 75\n\n     70: default['yum']['main']['pluginpath'] = nil\n     71: default['yum']['main']['plugins'] = nil # [true, false]\n     72: default['yum']['main']['protected_multilib'] = nil\n     73: default['yum']['main']['protected_packages'] = nil\n     74: default['yum']['main']['proxy'] = nil\n>>>  75: default['yum']['main']['proxy_password'] = nil\n     76: default['yum']['main']['proxy_username'] = nil\n     77: default['yum']['main']['password'] = nil\n     78: default['yum']['main']['recent'] = nil # /^\\d+$/\n     79: default['yum']['main']['repo_gpgcheck'] = nil # [true, false]\n     80: default['yum']['main']['reposdir'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Icinga_chef-icinga2-examples-icinga2_server-recipes-client.rb", "content": "cert_path \"\\\"#{client_crt}\\\"\"", "line": 83, "detection_span": [78, 88], "with_context": "\nendpoints [node.fqdn]\nparent 'master'\nend\n\nicinga2_apilistener node.fqdn do\n83:   cert_path \"\\\"#{client_crt}\\\"\"\nkey_path \"\\\"#{client_key}\\\"\"\nca_path \"\\\"#{master_ca}\\\"\"\nbind_port 5665\naccept_commands true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Icinga_chef-icinga2-examples-icinga2_server-recipes-client.rb\n# Target line: 83\n\n     78:   endpoints [node.fqdn]\n     79:   parent 'master'\n     80: end\n     81: \n     82: icinga2_apilistener node.fqdn do\n>>>  83:   cert_path \"\\\"#{client_crt}\\\"\"\n     84:   key_path \"\\\"#{client_key}\\\"\"\n     85:   ca_path \"\\\"#{master_ca}\\\"\"\n     86:   bind_port 5665\n     87:   accept_commands true\n     88: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "TaxiOS_zabbix-recipes-database.rb", "content": "root_username       = \"postgres\"", "line": 37, "detection_span": [32, 42], "with_context": "\nprovider = Chef::Provider::ZabbixDatabaseMySql\nwhen 'postgres'\nunless node['postgresql']['password']['postgres']\nnode.normal['postgresql']['password']['postgres'] = secure_password\nend\n37:   root_username       = \"postgres\"\nroot_password       = node['postgresql']['password']['postgres']\nprovider = Chef::Provider::ZabbixDatabasePostgres\nend\n\nzabbix_database node['zabbix']['database']['dbname'] do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: TaxiOS_zabbix-recipes-database.rb\n# Target line: 37\n\n     32:   provider = Chef::Provider::ZabbixDatabaseMySql\n     33: when 'postgres'\n     34:   unless node['postgresql']['password']['postgres']\n     35:     node.normal['postgresql']['password']['postgres'] = secure_password\n     36:   end\n>>>  37:   root_username       = \"postgres\"\n     38:   root_password       = node['postgresql']['password']['postgres'] \n     39:   provider = Chef::Provider::ZabbixDatabasePostgres\n     40: end\n     41: \n     42: zabbix_database node['zabbix']['database']['dbname'] do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-cookbooks_chef-ingredient-resources-chef_user.rb", "content": "password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))", "line": 48, "detection_span": [43, 53], "with_context": "\nmode '0700'\nrecursive true\nend\n\nkey = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\n48:   password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n\nexecute \"create-user-#{new_resource.username}\" do\nsensitive true\nretries 3\ncommand \"chef-server-ctl user-create #{new_resource.username} #{new_resource.first_name} #{new_resource.last_name} #{new_resource.email} #{password} -f #{key}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_chef-ingredient-resources-chef_user.rb\n# Target line: 48\n\n     43:     mode '0700'\n     44:     recursive true\n     45:   end\n     46: \n     47:   key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\n>>>  48:   password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n     49: \n     50:   execute \"create-user-#{new_resource.username}\" do\n     51:     sensitive true\n     52:     retries 3\n     53:     command \"chef-server-ctl user-create #{new_resource.username} #{new_resource.first_name} #{new_resource.last_name} #{new_resource.email} #{password} -f #{key}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "amitjain1975_custom-rightscale-cookbooks-app_php-attributes-default.rb", "content": "set[:app_php][:user] = \"www-data\"", "line": 23, "detection_span": [18, 28], "with_context": "\n# Calculated attributes\n# Defining apache user, module dependencies, and database adapter parameters depending on platform.\ncase platform\nwhen \"ubuntu\"\nset[:app_php][:module_dependencies] = [ \"proxy_http\", \"php5\" ]\n23:   set[:app_php][:user] = \"www-data\"\nset[:app_php][:group] = \"www-data\"\nif app_php[:db_adapter] == \"mysql\"\nset[:db][:socket] = \"/var/run/mysqld/mysqld.sock\"\nelsif app_php[:db_adapter] == \"postgresql\"\nset[:db][:socket] = \"/var/run/postgresql\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-app_php-attributes-default.rb\n# Target line: 23\n\n     18: # Calculated attributes\n     19: # Defining apache user, module dependencies, and database adapter parameters depending on platform.\n     20: case platform\n     21: when \"ubuntu\"\n     22:   set[:app_php][:module_dependencies] = [ \"proxy_http\", \"php5\" ]\n>>>  23:   set[:app_php][:user] = \"www-data\"\n     24:   set[:app_php][:group] = \"www-data\"\n     25:   if app_php[:db_adapter] == \"mysql\"\n     26:     set[:db][:socket] = \"/var/run/mysqld/mysqld.sock\"\n     27:   elsif app_php[:db_adapter] == \"postgresql\"\n     28:     set[:db][:socket] = \"/var/run/postgresql\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_cookbook-openstack-compute-recipes-placement_api.rb", "content": "db_pass = get_password 'db', 'placement'", "line": 44, "detection_span": [39, 49], "with_context": "\nsupports status: true, restart: true\naction [:disable, :stop]\nend\n\ndb_user = node['openstack']['db']['placement']['username']\n44: db_pass = get_password 'db', 'placement'\nidentity_endpoint = internal_endpoint 'identity'\nauth_url = identity_endpoint.to_s\n\nnode.default['openstack']['placement']['conf_secrets']\n.[]('placement_database')['connection'] =", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-compute-recipes-placement_api.rb\n# Target line: 44\n\n     39:   supports status: true, restart: true\n     40:   action [:disable, :stop]\n     41: end\n     42: \n     43: db_user = node['openstack']['db']['placement']['username']\n>>>  44: db_pass = get_password 'db', 'placement'\n     45: identity_endpoint = internal_endpoint 'identity'\n     46: auth_url = identity_endpoint.to_s\n     47: \n     48: node.default['openstack']['placement']['conf_secrets']\n     49:   .[]('placement_database')['connection'] =\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-heat_conf.rb", "content": "default['openstack']['orchestration']['conf']['keystone_authtoken']['username'] = 'heat'", "line": 27, "detection_span": [22, 32], "with_context": "\ndefault['openstack']['orchestration']['conf']['DEFAULT']['stack_domain_admin'] = 'heat_domain_admin'\ndefault['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name'] = 'heat'\ndefault['openstack']['orchestration']['conf']['oslo_messaging_notifications']['driver'] =\n'heat.openstack.common.notifier.rpc_notifier'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['auth_type'] = 'v3password'\n27: default['openstack']['orchestration']['conf']['keystone_authtoken']['username'] = 'heat'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['project_name'] = 'service'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['project_domain_name'] = 'Default'\ndefault['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name'] = 'Default'\ndefault['openstack']['orchestration']['conf']['trustee']['auth_type'] = 'v3password'\ndefault['openstack']['orchestration']['conf']['trustee']['username'] = 'heat'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-attributes-heat_conf.rb\n# Target line: 27\n\n     22: default['openstack']['orchestration']['conf']['DEFAULT']['stack_domain_admin'] = 'heat_domain_admin'\n     23: default['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name'] = 'heat'\n     24: default['openstack']['orchestration']['conf']['oslo_messaging_notifications']['driver'] =\n     25:   'heat.openstack.common.notifier.rpc_notifier'\n     26: default['openstack']['orchestration']['conf']['keystone_authtoken']['auth_type'] = 'v3password'\n>>>  27: default['openstack']['orchestration']['conf']['keystone_authtoken']['username'] = 'heat'\n     28: default['openstack']['orchestration']['conf']['keystone_authtoken']['project_name'] = 'service'\n     29: default['openstack']['orchestration']['conf']['keystone_authtoken']['project_domain_name'] = 'Default'\n     30: default['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name'] = 'Default'\n     31: default['openstack']['orchestration']['conf']['trustee']['auth_type'] = 'v3password'\n     32: default['openstack']['orchestration']['conf']['trustee']['username'] = 'heat'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-lb-recipes-do_attach_all.rb", "content": "node[:lb][:threshold][vhost_name][uuid] = nil", "line": 62, "detection_span": [57, 67], "with_context": "\n\n# Set threshold counters to nil to those not incremented, thus assuming app server now accessable.\n# Set to nil since chef does not delete the key, can only alter it.\n(Set.new(node[:lb][:threshold][vhost_name].keys) - servers_missing).each do |uuid|\nif node[:lb][:threshold][vhost_name][uuid]\n62:       node[:lb][:threshold][vhost_name][uuid] = nil\nlog \"  Resetting threshold for #{uuid}\"\nend\nend\n\n# Delete servers that hit threshold.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-lb-recipes-do_attach_all.rb\n# Target line: 62\n\n     57: \n     58:   # Set threshold counters to nil to those not incremented, thus assuming app server now accessable.\n     59:   # Set to nil since chef does not delete the key, can only alter it.\n     60:   (Set.new(node[:lb][:threshold][vhost_name].keys) - servers_missing).each do |uuid|\n     61:     if node[:lb][:threshold][vhost_name][uuid]\n>>>  62:       node[:lb][:threshold][vhost_name][uuid] = nil\n     63:       log \"  Resetting threshold for #{uuid}\"\n     64:     end\n     65:   end\n     66: \n     67:   # Delete servers that hit threshold.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-diamond-attributes-mysql.rb", "content": "default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"", "line": 5, "detection_span": [1, 10], "with_context": "\ndefault['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\ndefault['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\ndefault['diamond']['collectors']['MySQLCollector']['port'] = 3306\ndefault['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\n5: default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\ndefault['diamond']['collectors']['MySQLCollector']['password'] = \"password\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-diamond-attributes-mysql.rb\n# Target line: 5\n\n      1: default['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\n      2: default['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\n      3: default['diamond']['collectors']['MySQLCollector']['port'] = 3306\n      4: default['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\n>>>   5: default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\n      6: default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-mailman-recipes-default.rb", "content": "user \"list\"", "line": 76, "detection_span": [71, 81], "with_context": "\nmode \"755\"\nend\n\nprometheus_exporter \"mailman\" do\nport 8083\n76:   user \"list\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-mailman-recipes-default.rb\n# Target line: 76\n\n     71:   mode \"755\"\n     72: end\n     73: \n     74: prometheus_exporter \"mailman\" do\n     75:   port 8083\n>>>  76:   user \"list\"\n     77: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb", "content": "ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"", "line": 119, "detection_span": [114, 124], "with_context": "\n114:   end\n115:\n116:   pam_services = %w(sudo su sshd)\n117:   pam_config_dir = \"/etc/pam.d\"\n118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\n119:   ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\ntemplate generate_ssh_key_path do\nsource 'directory_service/generate_ssh_key.sh.erb'\nowner 'root'\ngroup 'root'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb\n# Target line: 119\n\n    114:   end\n    115: \n    116:   pam_services = %w(sudo su sshd)\n    117:   pam_config_dir = \"/etc/pam.d\"\n    118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\n>>> 119:   ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n    120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\n    121:     template generate_ssh_key_path do\n    122:       source 'directory_service/generate_ssh_key.sh.erb'\n    123:       owner 'root'\n    124:       group 'root'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb", "content": "'key_path' => '/etc/opscode/webui_priv.pem'", "line": 31, "detection_span": [26, 36], "with_context": "\n\napp_settings = {\n'chef' => {\n'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n'superuser' => 'pivotal',\n31:     'key_path' => '/etc/opscode/webui_priv.pem'\n},\n'doorkeeper' => {\n'administrators' => node['private_chef']['oc_id']['administrators'] || []\n},\n'sentry_dsn' => node['private_chef']['oc_id']['sentry_dsn'],", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb\n# Target line: 31\n\n     26: \n     27: app_settings = {\n     28:   'chef' => {\n     29:     'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n     30:     'superuser' => 'pivotal',\n>>>  31:     'key_path' => '/etc/opscode/webui_priv.pem'\n     32:   },\n     33:   'doorkeeper' => {\n     34:     'administrators' => node['private_chef']['oc_id']['administrators'] || []\n     35:   },\n     36:   'sentry_dsn' => node['private_chef']['oc_id']['sentry_dsn'],\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "amitjain1975_custom-rightscale-cookbooks-db-definitions-db_do_backup.rb", "content": "secondary_user get_device_or_default(node, :device1, :backup, :secondary, :cred, :user)", "line": 81, "detection_span": [76, 86], "with_context": "\n\n# Secondary arguments\nsecondary_cloud get_device_or_default(node, :device1, :backup, :secondary, :cloud)\nsecondary_endpoint get_device_or_default(node, :device1, :backup, :secondary, :endpoint) || \"\"\nsecondary_container get_device_or_default(node, :device1, :backup, :secondary, :container)\n81:     secondary_user get_device_or_default(node, :device1, :backup, :secondary, :cred, :user)\nsecondary_secret get_device_or_default(node, :device1, :backup, :secondary, :cred, :secret)\n\naction do_backup_type == 'primary' ? :primary_backup : :secondary_backup\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: amitjain1975_custom-rightscale-cookbooks-db-definitions-db_do_backup.rb\n# Target line: 81\n\n     76: \n     77:     # Secondary arguments\n     78:     secondary_cloud get_device_or_default(node, :device1, :backup, :secondary, :cloud)\n     79:     secondary_endpoint get_device_or_default(node, :device1, :backup, :secondary, :endpoint) || \"\"\n     80:     secondary_container get_device_or_default(node, :device1, :backup, :secondary, :container)\n>>>  81:     secondary_user get_device_or_default(node, :device1, :backup, :secondary, :cred, :user)\n     82:     secondary_secret get_device_or_default(node, :device1, :backup, :secondary, :cred, :secret)\n     83: \n     84:     action do_backup_type == 'primary' ? :primary_backup : :secondary_backup\n     85:   end\n     86: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Nikhil424_chef-repo-cookbooks-solr_6-attributes-install.rb", "content": "default['solr']['solr_ssl_client_key_store_password'] = ''", "line": 46, "detection_span": [41, 51], "with_context": "\ndefault['solr']['solr_ssl_trust_store_password'] = ''\ndefault['solr']['solr_ssl_need_client_auth'] = ''\ndefault['solr']['solr_ssl_want_client_auth'] = ''\n\ndefault['solr']['solr_ssl_client_key_store'] = ''\n46: default['solr']['solr_ssl_client_key_store_password'] = ''\ndefault['solr']['solr_ssl_client_trust_store'] = ''\ndefault['solr']['solr_ssl_client_trust_store_password'] = ''\n\ndefault['solr']['gc_log_opts'] = \"-verbose:gc \\\n-XX:+PrintHeapAtGC \\", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-solr_6-attributes-install.rb\n# Target line: 46\n\n     41: default['solr']['solr_ssl_trust_store_password'] = ''\n     42: default['solr']['solr_ssl_need_client_auth'] = ''\n     43: default['solr']['solr_ssl_want_client_auth'] = ''\n     44: \n     45: default['solr']['solr_ssl_client_key_store'] = ''\n>>>  46: default['solr']['solr_ssl_client_key_store_password'] = ''\n     47: default['solr']['solr_ssl_client_trust_store'] = ''\n     48: default['solr']['solr_ssl_client_trust_store_password'] = ''\n     49: \n     50: default['solr']['gc_log_opts'] = \"-verbose:gc \\\n     51: -XX:+PrintHeapAtGC \\\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-lvm-libraries-provider_lvm_volume_group.rb", "content": "pv_vg_uuid = pv.nil? ? nil : pv.vg_uuid", "line": 85, "detection_span": [80, 90], "with_context": "\npv = lvm.physical_volumes[pv_name]\n\n# get the uuid of the VG the PV belongs to if it exists\n# if we get \"nil\" then the PV does not belong to a VG\n# per the vgextend man page the pv will be initalized if it isn't already pv\n85:           pv_vg_uuid = pv.nil? ? nil : pv.vg_uuid\nif pv_vg_uuid.nil?\npvs_to_add.push pv_name\nelse\n# raise an error if we attempt to add a PV that is already a member of a VG\nraise(\"PV #{pv} is already a member of another volume group. Cannot add to #{name}\") unless pv_vg_uuid == vg_uuid", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-lvm-libraries-provider_lvm_volume_group.rb\n# Target line: 85\n\n     80:           pv = lvm.physical_volumes[pv_name]\n     81: \n     82:           # get the uuid of the VG the PV belongs to if it exists\n     83:           # if we get \"nil\" then the PV does not belong to a VG\n     84:           # per the vgextend man page the pv will be initalized if it isn't already pv\n>>>  85:           pv_vg_uuid = pv.nil? ? nil : pv.vg_uuid\n     86:           if pv_vg_uuid.nil?\n     87:             pvs_to_add.push pv_name\n     88:           else\n     89:             # raise an error if we attempt to add a PV that is already a member of a VG\n     90:             raise(\"PV #{pv} is already a member of another volume group. Cannot add to #{name}\") unless pv_vg_uuid == vg_uuid\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_platformstack-recipes-iptables.rb", "content": "user 'rackconnect'", "line": 26, "detection_span": [21, 31], "with_context": "\ninclude_recipe 'chef-sugar'\n\nunless lxc?\nif node['platformstack']['rackconnect'] == true\nsudo 'rackconnect' do\n26:       user 'rackconnect'\nnopasswd true\nend\nnode.default['openssh']['server']['password_authentication'] = 'yes'\nelse\ninclude_recipe 'rackspace_iptables::default'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_platformstack-recipes-iptables.rb\n# Target line: 26\n\n     21: include_recipe 'chef-sugar'\n     22: \n     23: unless lxc?\n     24:   if node['platformstack']['rackconnect'] == true\n     25:     sudo 'rackconnect' do\n>>>  26:       user 'rackconnect'\n     27:       nopasswd true\n     28:     end\n     29:     node.default['openssh']['server']['password_authentication'] = 'yes'\n     30:   else\n     31:     include_recipe 'rackspace_iptables::default'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-opsworks_ganglia-attributes-default.rb", "content": "default[:ganglia][:user] = 'ganglia'", "line": 28, "detection_span": [23, 33], "with_context": "\ndefault[:ganglia][:original_datadir] = '/var/lib/ganglia'\ndefault[:ganglia][:conf_dir] = \"#{node[:ganglia][:original_datadir]}/conf\"\ndefault[:ganglia][:events_dir] = \"#{node[:ganglia][:original_datadir]}/conf/events.json.d/\"\ndefault[:ganglia][:tcp_client_port] = 8649\ndefault[:ganglia][:udp_client_port] = 8666\n28: default[:ganglia][:user] = 'ganglia'\ndefault[:ganglia][:rrds_user] = 'nobody'\n\nif infrastructure_class?('ec2')\ndefault[:ganglia][:autofs_options] = \"-fstype=none,bind,rw\"\ndefault[:ganglia][:autofs_entry] = \"#{node[:ganglia][:original_datadir]} #{node[:ganglia][:autofs_options]} :#{node[:ganglia][:datadir]}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-opsworks_ganglia-attributes-default.rb\n# Target line: 28\n\n     23: default[:ganglia][:original_datadir] = '/var/lib/ganglia'\n     24: default[:ganglia][:conf_dir] = \"#{node[:ganglia][:original_datadir]}/conf\"\n     25: default[:ganglia][:events_dir] = \"#{node[:ganglia][:original_datadir]}/conf/events.json.d/\"\n     26: default[:ganglia][:tcp_client_port] = 8649\n     27: default[:ganglia][:udp_client_port] = 8666\n>>>  28: default[:ganglia][:user] = 'ganglia'\n     29: default[:ganglia][:rrds_user] = 'nobody'\n     30: \n     31: if infrastructure_class?('ec2')\n     32:   default[:ganglia][:autofs_options] = \"-fstype=none,bind,rw\"\n     33:   default[:ganglia][:autofs_entry] = \"#{node[:ganglia][:original_datadir]} #{node[:ganglia][:autofs_options]} :#{node[:ganglia][:datadir]}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-nginx-attributes-nginx.rb", "content": "default[:nginx][:user]       = \"nginx\"", "line": 31, "detection_span": [26, 36], "with_context": "\ndefault[:nginx][:pid_file] = \"/var/run/nginx.pid\"\nend\nwhen \"rhel\"\ndefault[:nginx][:dir]        = \"/etc/nginx\"\ndefault[:nginx][:log_dir]    = \"/var/log/nginx\"\n31:   default[:nginx][:user]       = \"nginx\"\ndefault[:nginx][:binary]     = \"/usr/sbin/nginx\"\ndefault[:nginx][:pid_file]   = \"/var/run/nginx.pid\"\nelse\nChef::Log.error \"Cannot configure nginx, platform unknown\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-nginx-attributes-nginx.rb\n# Target line: 31\n\n     26:     default[:nginx][:pid_file] = \"/var/run/nginx.pid\"\n     27:   end\n     28: when \"rhel\"\n     29:   default[:nginx][:dir]        = \"/etc/nginx\"\n     30:   default[:nginx][:log_dir]    = \"/var/log/nginx\"\n>>>  31:   default[:nginx][:user]       = \"nginx\"\n     32:   default[:nginx][:binary]     = \"/usr/sbin/nginx\"\n     33:   default[:nginx][:pid_file]   = \"/var/run/nginx.pid\"\n     34: else\n     35:   Chef::Log.error \"Cannot configure nginx, platform unknown\"\n     36: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-otrs-attributes-default.rb", "content": "default[:otrs][:database_user] = \"otrs\"", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault[:otrs][:version] = \"6.0.30\"\ndefault[:otrs][:user] = \"otrs\"\ndefault[:otrs][:group] = nil\ndefault[:otrs][:database_cluster] = \"13/main\"\ndefault[:otrs][:database_name] = \"otrs\"\n6: default[:otrs][:database_user] = \"otrs\"\ndefault[:otrs][:database_password] = \"otrs\"\ndefault[:otrs][:site] = \"otrs\"\n\ndefault[:postgresql][:versions] |= [\"13\"]\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-otrs-attributes-default.rb\n# Target line: 6\n\n      1: default[:otrs][:version] = \"6.0.30\"\n      2: default[:otrs][:user] = \"otrs\"\n      3: default[:otrs][:group] = nil\n      4: default[:otrs][:database_cluster] = \"13/main\"\n      5: default[:otrs][:database_name] = \"otrs\"\n>>>   6: default[:otrs][:database_user] = \"otrs\"\n      7: default[:otrs][:database_password] = \"otrs\"\n      8: default[:otrs][:site] = \"otrs\"\n      9: \n     10: default[:postgresql][:versions] |= [\"13\"]\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb", "content": "'admin' => 'v3/%(project_id)s',", "line": 67, "detection_span": [62, 72], "with_context": "\n'admin' => 8776,\n'internal' => 8776,\n'public' => 8776,\n},\n'uris' => {\n67:       'admin' => 'v3/%(project_id)s',\n'internal' => 'v3/%(project_id)s',\n'public' => 'v3/%(project_id)s',\n},\n},\n'image' => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb\n# Target line: 67\n\n     62:       'admin' => 8776,\n     63:       'internal' => 8776,\n     64:       'public' => 8776,\n     65:     },\n     66:     'uris' => {\n>>>  67:       'admin' => 'v3/%(project_id)s',\n     68:       'internal' => 'v3/%(project_id)s',\n     69:       'public' => 'v3/%(project_id)s',\n     70:     },\n     71:   },\n     72:   'image' => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-attributes-default.rb", "content": "set_unless[:repo][:default][:git_ssh_key] = \"\"", "line": 13, "detection_span": [8, 18], "with_context": "\nset_unless[:repo][:default][:repository] = \"\"\nset_unless[:repo][:default][:revision] = \"HEAD\"\nset_unless[:repo][:default][:provider] = \"repo_git\"\nset_unless[:repo][:default][:svn_username] = \"\"\nset_unless[:repo][:default][:svn_password] = \"\"\n13: set_unless[:repo][:default][:git_ssh_key] = \"\"\nset_unless[:repo][:default][:storage_account_provider] = \"S3\"\nset_unless[:repo][:default][:storage_account_id] = \"\"\nset_unless[:repo][:default][:storage_account_secret] = \"\"\nset_unless[:repo][:default][:container] = \"\"\nset_unless[:repo][:default][:prefix] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-attributes-default.rb\n# Target line: 13\n\n      8: set_unless[:repo][:default][:repository] = \"\"\n      9: set_unless[:repo][:default][:revision] = \"HEAD\"\n     10: set_unless[:repo][:default][:provider] = \"repo_git\"\n     11: set_unless[:repo][:default][:svn_username] = \"\"\n     12: set_unless[:repo][:default][:svn_password] = \"\"\n>>>  13: set_unless[:repo][:default][:git_ssh_key] = \"\"\n     14: set_unless[:repo][:default][:storage_account_provider] = \"S3\"\n     15: set_unless[:repo][:default][:storage_account_id] = \"\"\n     16: set_unless[:repo][:default][:storage_account_secret] = \"\"\n     17: set_unless[:repo][:default][:container] = \"\"\n     18: set_unless[:repo][:default][:prefix] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-nova-setup.rb", "content": "node.set_unless[\"nova\"][\"db\"][\"password\"] = \"nova\"", "line": 24, "detection_span": [19, 29], "with_context": "\n\n::Chef::Recipe.send(:include, Opscode::OpenSSL::Password)\n\n# Allow for using a well known db password\nif node[\"developer_mode\"] == true\n24:   node.set_unless[\"nova\"][\"db\"][\"password\"] = \"nova\"\nnode.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = \"nova\"\nelse\nnode.set_unless[\"nova\"][\"db\"][\"password\"] = secure_password\nnode.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = secure_password\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-nova-setup.rb\n# Target line: 24\n\n     19: \n     20: ::Chef::Recipe.send(:include, Opscode::OpenSSL::Password)\n     21: \n     22: # Allow for using a well known db password\n     23: if node[\"developer_mode\"] == true\n>>>  24:   node.set_unless[\"nova\"][\"db\"][\"password\"] = \"nova\"\n     25:   node.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = \"nova\"\n     26: else\n     27:   node.set_unless[\"nova\"][\"db\"][\"password\"] = secure_password\n     28:   node.set_unless[\"nova\"][\"libvirt\"][\"vnc_password\"] = secure_password\n     29: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cdapio_hadoop_cookbook-recipes-spark_historyserver.rb", "content": "user 'hdfs'", "line": 42, "detection_span": [37, 47], "with_context": "\n'hdfs:///user/spark/applicationHistory'\nend\n\nexecute 'hdfs-spark-eventlog-dir' do\ncommand \"hdfs dfs -mkdir -p #{eventlog_dir} && hdfs dfs -chown -R spark:spark #{eventlog_dir} && hdfs dfs -chmod 1777 #{eventlog_dir}\"\n42:   user 'hdfs'\ngroup 'hdfs'\ntimeout 300\naction :nothing\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cdapio_hadoop_cookbook-recipes-spark_historyserver.rb\n# Target line: 42\n\n     37:     'hdfs:///user/spark/applicationHistory'\n     38:   end\n     39: \n     40: execute 'hdfs-spark-eventlog-dir' do\n     41:   command \"hdfs dfs -mkdir -p #{eventlog_dir} && hdfs dfs -chown -R spark:spark #{eventlog_dir} && hdfs dfs -chmod 1777 #{eventlog_dir}\"\n>>>  42:   user 'hdfs'\n     43:   group 'hdfs'\n     44:   timeout 300\n     45:   action :nothing\n     46: end\n     47: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-php-attributes-default.rb", "content": "default['php']['fpm_user']      = 'www-data'", "line": 41, "detection_span": [36, 46], "with_context": "\ndefault['php']['fpm_user']      = 'www-data'\ndefault['php']['fpm_group']     = 'www-data'\nelse\ndefault['php']['conf_dir']      = '/etc/php5/cli'\ndefault['php']['ext_conf_dir']  = '/etc/php5/conf.d'\n41:   default['php']['fpm_user']      = 'www-data'\ndefault['php']['fpm_group']     = 'www-data'\nend\n\n\ndefault['php']['url'] = 'http://us.php.net/distributions'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-php-attributes-default.rb\n# Target line: 41\n\n     36:   default['php']['fpm_user']      = 'www-data'\n     37:   default['php']['fpm_group']     = 'www-data'\n     38: else\n     39:   default['php']['conf_dir']      = '/etc/php5/cli'\n     40:   default['php']['ext_conf_dir']  = '/etc/php5/conf.d'\n>>>  41:   default['php']['fpm_user']      = 'www-data'\n     42:   default['php']['fpm_group']     = 'www-data'\n     43: end\n     44: \n     45: \n     46: default['php']['url'] = 'http://us.php.net/distributions'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "msquitieri_craigslistpoetry-api-chef-vendor-cookbooks-the_bard-recipes-backup.rb", "content": "user 'deploy'", "line": 39, "detection_span": [34, 44], "with_context": "\naction :create\nminute '0'\n# 2AM EST\nhour '6'\nweekday '*'\n39:     user 'deploy'\ncommand '/home/deploy/scripts/backup_database.sh >> /home/deploy/scripts/backup.log 2>&1'\nend\n\nlogrotate_app \"craigslistpoetry-backups\" do\ncookbook \"logrotate\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: msquitieri_craigslistpoetry-api-chef-vendor-cookbooks-the_bard-recipes-backup.rb\n# Target line: 39\n\n     34:     action :create\n     35:     minute '0'\n     36:     # 2AM EST\n     37:     hour '6'\n     38:     weekday '*'\n>>>  39:     user 'deploy'\n     40:     command '/home/deploy/scripts/backup_database.sh >> /home/deploy/scripts/backup.log 2>&1'\n     41:   end\n     42: \n     43:   logrotate_app \"craigslistpoetry-backups\" do\n     44:     cookbook \"logrotate\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-cookbooks_chef-ingredient-resources-chef_user.rb", "content": "key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")", "line": 47, "detection_span": [42, 52], "with_context": "\ngroup 'root'\nmode '0700'\nrecursive true\nend\n\n47:   key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\npassword = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n\nexecute \"create-user-#{new_resource.username}\" do\nsensitive true\nretries 3", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-cookbooks_chef-ingredient-resources-chef_user.rb\n# Target line: 47\n\n     42:     group 'root'\n     43:     mode '0700'\n     44:     recursive true\n     45:   end\n     46: \n>>>  47:   key = (property_is_set?(:key_path) ? new_resource.key_path : \"/etc/opscode/users/#{new_resource.username}.pem\")\n     48:   password = (property_is_set?(:password) ? new_resource.password : SecureRandom.base64(36))\n     49: \n     50:   execute \"create-user-#{new_resource.username}\" do\n     51:     sensitive true\n     52:     retries 3\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-openstack.rb", "content": "default['bcpc']['openstack']['admin']['username'] = 'admin'", "line": 12, "detection_span": [7, 17], "with_context": "\n\ndefault['bcpc']['openstack']['repo']['release'] = 'ussuri'\ndefault['bcpc']['openstack']['repo']['branch'] = 'updates'\ndefault['bcpc']['openstack']['repo']['key'] = 'openstack/release.key'\n\n12: default['bcpc']['openstack']['admin']['username'] = 'admin'\ndefault['bcpc']['openstack']['admin']['project'] = 'admin'\n\ndefault['bcpc']['openstack']['services']['workers'] = 1\n\n###############################################################################", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-openstack.rb\n# Target line: 12\n\n      7: \n      8: default['bcpc']['openstack']['repo']['release'] = 'ussuri'\n      9: default['bcpc']['openstack']['repo']['branch'] = 'updates'\n     10: default['bcpc']['openstack']['repo']['key'] = 'openstack/release.key'\n     11: \n>>>  12: default['bcpc']['openstack']['admin']['username'] = 'admin'\n     13: default['bcpc']['openstack']['admin']['project'] = 'admin'\n     14: \n     15: default['bcpc']['openstack']['services']['workers'] = 1\n     16: \n     17: ###############################################################################\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-elasticsearch-cookbooks-zabbix-providers-user.rb", "content": "self.zabbix_user           = (Rubix::User.find(:username => new_resource.name) || Rubix::User.new(:username => new_resource.name))", "line": 16, "detection_span": [11, 21], "with_context": "\nattr_accessor :zabbix_user\n\ndef load_current_resource\nreturn unless connect_to_zabbix_server(new_resource.server)\nbegin\n16:     self.zabbix_user           = (Rubix::User.find(:username => new_resource.name) || Rubix::User.new(:username => new_resource.name))\nself.zabbix_user.first_name         = new_resource.first_name\nself.zabbix_user.last_name          = new_resource.last_name\nself.zabbix_user.url                = new_resource.url\nself.zabbix_user.auto_login         = new_resource.auto_login\nself.zabbix_user.type               = new_resource.type", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-elasticsearch-cookbooks-zabbix-providers-user.rb\n# Target line: 16\n\n     11: attr_accessor :zabbix_user\n     12: \n     13: def load_current_resource\n     14:   return unless connect_to_zabbix_server(new_resource.server)\n     15:   begin\n>>>  16:     self.zabbix_user           = (Rubix::User.find(:username => new_resource.name) || Rubix::User.new(:username => new_resource.name))\n     17:     self.zabbix_user.first_name         = new_resource.first_name\n     18:     self.zabbix_user.last_name          = new_resource.last_name\n     19:     self.zabbix_user.url                = new_resource.url\n     20:     self.zabbix_user.auto_login         = new_resource.auto_login\n     21:     self.zabbix_user.type               = new_resource.type\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sous-chefs_php-recipes-community_package.rb", "content": "key 'https://packages.sury.org/php/apt.gpg'", "line": 29, "detection_span": [24, 34], "with_context": "\ninclude_recipe 'ondrej_ppa_ubuntu'\nelsif platform?('debian')\n# use sury repo for debian (https://deb.sury.org/)\napt_repository 'sury-php' do\nuri 'https://packages.sury.org/php/'\n29:     key 'https://packages.sury.org/php/apt.gpg'\ncomponents %w(main)\nend\nend\n\ninclude_recipe 'php::package'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sous-chefs_php-recipes-community_package.rb\n# Target line: 29\n\n     24:   include_recipe 'ondrej_ppa_ubuntu'\n     25: elsif platform?('debian')\n     26:   # use sury repo for debian (https://deb.sury.org/)\n     27:   apt_repository 'sury-php' do\n     28:     uri 'https://packages.sury.org/php/'\n>>>  29:     key 'https://packages.sury.org/php/apt.gpg'\n     30:     components %w(main)\n     31:   end\n     32: end\n     33: \n     34: include_recipe 'php::package'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-nova.rb", "content": "default['bcpc']['nova']['ceph']['user'] = 'nova'", "line": 14, "detection_span": [9, 19], "with_context": "\n\n# Nova debug toggle\ndefault['bcpc']['nova']['debug'] = false\n\n# ceph (rbd)\n14: default['bcpc']['nova']['ceph']['user'] = 'nova'\ndefault['bcpc']['nova']['ceph']['pool']['name'] = 'vms'\ndefault['bcpc']['nova']['ceph']['pool']['size'] = 1\n\n# Allow destination machine to match source for resize\ndefault['bcpc']['nova']['allow_resize_to_same_host'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-nova.rb\n# Target line: 14\n\n      9: \n     10: # Nova debug toggle\n     11: default['bcpc']['nova']['debug'] = false\n     12: \n     13: # ceph (rbd)\n>>>  14: default['bcpc']['nova']['ceph']['user'] = 'nova'\n     15: default['bcpc']['nova']['ceph']['pool']['name'] = 'vms'\n     16: default['bcpc']['nova']['ceph']['pool']['size'] = 1\n     17: \n     18: # Allow destination machine to match source for resize\n     19: default['bcpc']['nova']['allow_resize_to_same_host'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-dock_automatically_hide_and_show_the_dock.rb", "content": "key 'autohide'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Automatically hide and show the dock\" do\ndomain 'com.apple.dock'\n3:   key 'autohide'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-dock_automatically_hide_and_show_the_dock.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Automatically hide and show the dock\" do\n      2:   domain 'com.apple.dock'\n>>>   3:   key 'autohide'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-recipes-repo_passenger.rb", "content": "key '561F9B9CAC40B2F7'", "line": 35, "detection_span": [30, 40], "with_context": "\nuri 'https://oss-binaries.phusionpassenger.com/apt/passenger'\ndistribution node['lsb']['codename']\ncomponents %w(main)\ndeb_src true\nkeyserver 'keyserver.ubuntu.com'\n35:     key '561F9B9CAC40B2F7'\nend\n\ninclude_recipe 'nginx::passenger'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-recipes-repo_passenger.rb\n# Target line: 35\n\n     30:     uri 'https://oss-binaries.phusionpassenger.com/apt/passenger'\n     31:     distribution node['lsb']['codename']\n     32:     components %w(main)\n     33:     deb_src true\n     34:     keyserver 'keyserver.ubuntu.com'\n>>>  35:     key '561F9B9CAC40B2F7'\n     36:   end\n     37: \n     38:   include_recipe 'nginx::passenger'\n     39: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-chef-recipes-repository.rb", "content": "user \"chefrepo\"", "line": 42, "detection_span": [37, 47], "with_context": "\n\ngit \"/var/lib/chef/#{repository}\" do\naction :checkout\nrepository repository_directory\nrevision \"master\"\n42:     user \"chefrepo\"\ngroup \"chefrepo\"\nend\n\ndirectory \"/var/lib/chef/#{repository}/.chef\" do\nowner \"chefrepo\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-chef-recipes-repository.rb\n# Target line: 42\n\n     37: \n     38:   git \"/var/lib/chef/#{repository}\" do\n     39:     action :checkout\n     40:     repository repository_directory\n     41:     revision \"master\"\n>>>  42:     user \"chefrepo\"\n     43:     group \"chefrepo\"\n     44:   end\n     45: \n     46:   directory \"/var/lib/chef/#{repository}/.chef\" do\n     47:     owner \"chefrepo\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Nikhil424_chef-repo-cookbooks-chef-client-attributes-default.rb", "content": "default['chef_client']['task']['password'] = '' # SYSTEM user does not need a password, but windows_task LWRP wants one", "line": 64, "detection_span": [59, 69], "with_context": "\n\n# Configuration for Windows scheduled task\ndefault['chef_client']['task']['frequency'] = 'minute'\ndefault['chef_client']['task']['frequency_modifier'] = node['chef_client']['interval'].to_i / 60\ndefault['chef_client']['task']['user'] = 'SYSTEM'\n64: default['chef_client']['task']['password'] = '' # SYSTEM user does not need a password, but windows_task LWRP wants one\n\ndefault['chef_client']['load_gems'] = {}\n\n# If set to false, changes in the `client.rb` template won't trigger a reload\n# of those configs in the current Chef run.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-chef-client-attributes-default.rb\n# Target line: 64\n\n     59: \n     60: # Configuration for Windows scheduled task\n     61: default['chef_client']['task']['frequency'] = 'minute'\n     62: default['chef_client']['task']['frequency_modifier'] = node['chef_client']['interval'].to_i / 60\n     63: default['chef_client']['task']['user'] = 'SYSTEM'\n>>>  64: default['chef_client']['task']['password'] = '' # SYSTEM user does not need a password, but windows_task LWRP wants one\n     65: \n     66: default['chef_client']['load_gems'] = {}\n     67: \n     68: # If set to false, changes in the `client.rb` template won't trigger a reload\n     69: # of those configs in the current Chef run.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_cookbook-openstack-identity-recipes-cloud_config.rb", "content": "ksadmin_pass = get_password 'user', ksadmin_user", "line": 31, "detection_span": [26, 36], "with_context": "\nksadmin_project = node['openstack']['identity']['admin_project']\nproject_domain_name = node['openstack']['identity']['admin_project_domain']\nksadmin_user = node['openstack']['identity']['admin_user']\nadmin_domain_name = node['openstack']['identity']['admin_domain_name']\n\n31: ksadmin_pass = get_password 'user', ksadmin_user\n\nidentity_endpoint = public_endpoint 'identity'\nauth_url = identity_endpoint.to_s\n\ncloud_config = node['openstack']['identity']['cloud_config']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-identity-recipes-cloud_config.rb\n# Target line: 31\n\n     26: ksadmin_project = node['openstack']['identity']['admin_project']\n     27: project_domain_name = node['openstack']['identity']['admin_project_domain']\n     28: ksadmin_user = node['openstack']['identity']['admin_user']\n     29: admin_domain_name = node['openstack']['identity']['admin_domain_name']\n     30: \n>>>  31: ksadmin_pass = get_password 'user', ksadmin_user\n     32: \n     33: identity_endpoint = public_endpoint 'identity'\n     34: auth_url = identity_endpoint.to_s\n     35: \n     36: cloud_config = node['openstack']['identity']['cloud_config']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-examples~snapshot.rb", "content": "disk_encryption_key(", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\ngcompute_disk 'data-disk-1' do\naction :create\nsize_gb 50\n66:   disk_encryption_key(\nraw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n)\nzone 'us-central1-a'\nproject ENV['PROJECT'] # ex: 'my-test-project'\ncredential 'mycred'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-examples~snapshot.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: gcompute_disk 'data-disk-1' do\n     64:   action :create\n     65:   size_gb 50\n>>>  66:   disk_encryption_key(\n     67:     raw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n     68:   )\n     69:   zone 'us-central1-a'\n     70:   project ENV['PROJECT'] # ex: 'my-test-project'\n     71:   credential 'mycred'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-basejump-attributes-default.rb", "content": "default[:basejump][:user] = \"ihr-deployer\"", "line": 36, "detection_span": [31, 41], "with_context": "\n})\ndefault[:basejump][:kickstarter][:mirrors] = ({\n\"centos\" => \"http://mirror.stanford.edu/yum/pub/\"\n})\n\n36: default[:basejump][:user] = \"ihr-deployer\"\ncase node['platform']\nwhen \"debian\"\ndefault[:basejump][:group] = \"ihr-deployer\"\nwhen \"centos\"\ndefault[:basejump][:group] = \"ihr-deployer\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-basejump-attributes-default.rb\n# Target line: 36\n\n     31:                                               })\n     32: default[:basejump][:kickstarter][:mirrors] = ({\n     33:                                                 \"centos\" => \"http://mirror.stanford.edu/yum/pub/\"\n     34:                                               })\n     35: \n>>>  36: default[:basejump][:user] = \"ihr-deployer\"\n     37: case node['platform']\n     38: when \"debian\"\n     39:   default[:basejump][:group] = \"ihr-deployer\"\n     40: when \"centos\"\n     41:   default[:basejump][:group] = \"ihr-deployer\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-block_device-attributes-default.rb", "content": "set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:user] = \"\"", "line": 19, "detection_span": [14, 24], "with_context": "\nset_unless[:block_device][:devices][:default][:backup][:primary][:cloud] = 'cloudfiles' if cloud[:provider] == 'rackspace'\n\nset_unless[:block_device][:devices][:default][:backup][:primary][:cred][:user] = \"\"\nset_unless[:block_device][:devices][:default][:backup][:primary][:cred][:secret] = \"\"\n\n19: set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:user] = \"\"\nset_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:secret] = \"\"\n\nset_unless[:block_device][:devices_to_use] = 'device1'\n\n# Defining initial backup parameters for all block devices", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-block_device-attributes-default.rb\n# Target line: 19\n\n     14: set_unless[:block_device][:devices][:default][:backup][:primary][:cloud] = 'cloudfiles' if cloud[:provider] == 'rackspace'\n     15: \n     16: set_unless[:block_device][:devices][:default][:backup][:primary][:cred][:user] = \"\"\n     17: set_unless[:block_device][:devices][:default][:backup][:primary][:cred][:secret] = \"\"\n     18: \n>>>  19: set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:user] = \"\"\n     20: set_unless[:block_device][:devices][:default][:backup][:secondary][:cred][:secret] = \"\"\n     21: \n     22: set_unless[:block_device][:devices_to_use] = 'device1'\n     23: \n     24: # Defining initial backup parameters for all block devices\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-varnish-recipes-apt_repo.rb", "content": "key \"http://repo.varnish-cache.org/#{node['platform']}/GPG-key.txt\"", "line": 22, "detection_span": [17, 27], "with_context": "\n\napt_repository \"varnish-cache\" do\nuri \"http://repo.varnish-cache.org/#{node['platform']}\"\ndistribution node['lsb']['codename']\ncomponents [\"varnish-#{node['varnish']['version']}\"]\n22:   key \"http://repo.varnish-cache.org/#{node['platform']}/GPG-key.txt\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-varnish-recipes-apt_repo.rb\n# Target line: 22\n\n     17: \n     18: apt_repository \"varnish-cache\" do\n     19:   uri \"http://repo.varnish-cache.org/#{node['platform']}\"\n     20:   distribution node['lsb']['codename']\n     21:   components [\"varnish-#{node['varnish']['version']}\"]\n>>>  22:   key \"http://repo.varnish-cache.org/#{node['platform']}/GPG-key.txt\"\n     23: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-partners.iheart.com-attributes-default.rb", "content": "default[:partners][:user] = 'partners'", "line": 4, "detection_span": [1, 9], "with_context": "\ndefault[:partners][:repo] = 'git@github.com:iheartradio/partners.iheart.com.git'\ndefault[:partners][:rev] = 'release'\ndefault[:partners][:deploy_path] = '/data/apps/partners'\n4: default[:partners][:user] = 'partners'\ndefault[:partners][:group] = 'partners'\ndefault[:partners][:deployer] = 'ihr-deployer'\ndefault[:partners][:nginx_port] = \"8080\"\ndefault[:partners][:gunicorn_port] = \"8000\"\ndefault[:partners][:sqlite_path] = \"/var/partners\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-partners.iheart.com-attributes-default.rb\n# Target line: 4\n\n      1: default[:partners][:repo] = 'git@github.com:iheartradio/partners.iheart.com.git'\n      2: default[:partners][:rev] = 'release'\n      3: default[:partners][:deploy_path] = '/data/apps/partners'\n>>>   4: default[:partners][:user] = 'partners'\n      5: default[:partners][:group] = 'partners'\n      6: default[:partners][:deployer] = 'ihr-deployer'\n      7: default[:partners][:nginx_port] = \"8080\"\n      8: default[:partners][:gunicorn_port] = \"8000\"\n      9: default[:partners][:sqlite_path] = \"/var/partners\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "caiush_bos-cookbooks-bcpc-recipes-ceph-apt.rb", "content": "key \"ceph-release.key\"", "line": 31, "detection_span": [26, 36], "with_context": "\n\napt_repository \"ceph-extras\" do\nuri node['bcpc']['repos']['ceph-extras']\ndistribution node['lsb']['codename']\ncomponents [\"main\"]\n31:     key \"ceph-release.key\"\nend\n\napt_repository \"ceph-fcgi\" do\nuri node['bcpc']['repos']['ceph-fcgi']\ndistribution node['lsb']['codename']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: caiush_bos-cookbooks-bcpc-recipes-ceph-apt.rb\n# Target line: 31\n\n     26: \n     27: apt_repository \"ceph-extras\" do\n     28:     uri node['bcpc']['repos']['ceph-extras']\n     29:     distribution node['lsb']['codename']\n     30:     components [\"main\"]\n>>>  31:     key \"ceph-release.key\"\n     32: end\n     33: \n     34: apt_repository \"ceph-fcgi\" do\n     35:     uri node['bcpc']['repos']['ceph-fcgi']\n     36:     distribution node['lsb']['codename']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_osl-openstack-attributes-default.rb", "content": "default['osl-openstack']['image']['rbd_store_user'] = 'glance'", "line": 40, "detection_span": [35, 45], "with_context": "\ndefault['osl-openstack']['block']['rbd_store_user'] = 'cinder'\ndefault['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\ndefault['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\ndefault['osl-openstack']['image']['glance_vol'] = nil\ndefault['osl-openstack']['image']['rbd_store_pool'] = 'images'\n40: default['osl-openstack']['image']['rbd_store_user'] = 'glance'\ndefault['osl-openstack']['endpoint_hostname'] = nil\ndefault['osl-openstack']['network_hostname'] = nil\ndefault['osl-openstack']['db_hostname'] = nil\ndefault['osl-openstack']['bind_service'] = node['ipaddress']\ndefault['osl-openstack']['seperate_network_node'] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_osl-openstack-attributes-default.rb\n# Target line: 40\n\n     35: default['osl-openstack']['block']['rbd_store_user'] = 'cinder'\n     36: default['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\n     37: default['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\n     38: default['osl-openstack']['image']['glance_vol'] = nil\n     39: default['osl-openstack']['image']['rbd_store_pool'] = 'images'\n>>>  40: default['osl-openstack']['image']['rbd_store_user'] = 'glance'\n     41: default['osl-openstack']['endpoint_hostname'] = nil\n     42: default['osl-openstack']['network_hostname'] = nil\n     43: default['osl-openstack']['db_hostname'] = nil\n     44: default['osl-openstack']['bind_service'] = node['ipaddress']\n     45: default['osl-openstack']['seperate_network_node'] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-mongodb-recipes-server.rb", "content": "key \"7F0CEB10\"", "line": 7, "detection_span": [2, 12], "with_context": "\n\nadd_apt_repository \"ubuntu_10gen\" do\nurl \"http://downloads-distro.mongodb.org/repo/ubuntu-upstart\"\ndistrib \"dist\"\ncomponents ['10gen']\n7: \t\tkey \"7F0CEB10\"\nkey_server \"keyserver.ubuntu.com\"\nrun_apt_get_update true\nend\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-mongodb-recipes-server.rb\n# Target line: 7\n\n      2: \n      3: \tadd_apt_repository \"ubuntu_10gen\" do\n      4: \t\turl \"http://downloads-distro.mongodb.org/repo/ubuntu-upstart\"\n      5: \t\tdistrib \"dist\"\n      6: \t\tcomponents ['10gen']\n>>>   7: \t\tkey \"7F0CEB10\"\n      8: \t\tkey_server \"keyserver.ubuntu.com\"\n      9: \t\trun_apt_get_update true\n     10: \tend\n     11: end\n     12: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "polew_chef-logstash-recipes-zero_mq_repo.rb", "content": "key 'C7917B12'", "line": 33, "detection_span": [28, 38], "with_context": "\napt_repository 'libpgm-ppa' do\nuri 'http://ppa.launchpad.net/chris-lea/libpgm/ubuntu'\ndistribution  node['lsb']['codename']\ncomponents ['main']\nkeyserver 'keyserver.ubuntu.com'\n33:     key 'C7917B12'\naction :add\nnotifies :run, 'execute[apt-get update]', :immediately\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: polew_chef-logstash-recipes-zero_mq_repo.rb\n# Target line: 33\n\n     28:   apt_repository 'libpgm-ppa' do\n     29:     uri 'http://ppa.launchpad.net/chris-lea/libpgm/ubuntu'\n     30:     distribution  node['lsb']['codename']\n     31:     components ['main']\n     32:     keyserver 'keyserver.ubuntu.com'\n>>>  33:     key 'C7917B12'\n     34:     action :add\n     35:     notifies :run, 'execute[apt-get update]', :immediately\n     36:   end\n     37: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-recipes-common.rb", "content": "conf_secrets['service_credentials']['password'] =", "line": 56, "detection_span": [51, 61], "with_context": "\n\n# define secrets that are needed in the ceilometer.conf\nnode.default['openstack']['telemetry']['conf_secrets'].tap do |conf_secrets|\nconf_secrets['database']['connection'] =\ndb_uri('telemetry', db_user, db_pass)\n56:   conf_secrets['service_credentials']['password'] =\nget_password 'service', 'openstack-telemetry'\nconf_secrets['keystone_authtoken']['password'] =\nget_password 'service', 'openstack-telemetry'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-recipes-common.rb\n# Target line: 56\n\n     51: \n     52: # define secrets that are needed in the ceilometer.conf\n     53: node.default['openstack']['telemetry']['conf_secrets'].tap do |conf_secrets|\n     54:   conf_secrets['database']['connection'] =\n     55:     db_uri('telemetry', db_user, db_pass)\n>>>  56:   conf_secrets['service_credentials']['password'] =\n     57:     get_password 'service', 'openstack-telemetry'\n     58:   conf_secrets['keystone_authtoken']['password'] =\n     59:     get_password 'service', 'openstack-telemetry'\n     60: end\n     61: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-datadog-resources-integration.rb", "content": "user      'dd-agent' unless platform_family?('windows')", "line": 50, "detection_span": [45, 55], "with_context": "\n\nChef::Log.debug(\"Removing integration #{new_resource.property_name}\")\n\nexecute 'integration remove' do\ncommand   \"\\\"#{agent_exe_filepath}\\\" integration remove #{new_resource.property_name}\"\n50:     user      'dd-agent' unless platform_family?('windows')\n\nnot_if {\noutput = shell_out(\"#{agent_exe_filepath} integration show -q #{new_resource.property_name}\").stdout\noutput.strip.empty?\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-datadog-resources-integration.rb\n# Target line: 50\n\n     45: \n     46:   Chef::Log.debug(\"Removing integration #{new_resource.property_name}\")\n     47: \n     48:   execute 'integration remove' do\n     49:     command   \"\\\"#{agent_exe_filepath}\\\" integration remove #{new_resource.property_name}\"\n>>>  50:     user      'dd-agent' unless platform_family?('windows')\n     51: \n     52:     not_if {\n     53:       output = shell_out(\"#{agent_exe_filepath} integration show -q #{new_resource.property_name}\").stdout\n     54:       output.strip.empty?\n     55:     }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_nodestack-attributes-mysql.rb", "content": "default['mysql-multi']['slave_user'] = 'replicant'", "line": 4, "detection_span": [1, 9], "with_context": "\n# Encoding: utf-8\ndefault['mysql-multi']['master'] = ''\ndefault['mysql-multi']['slaves'] = []\n4: default['mysql-multi']['slave_user'] = 'replicant'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-attributes-mysql.rb\n# Target line: 4\n\n      1: # Encoding: utf-8\n      2: default['mysql-multi']['master'] = ''\n      3: default['mysql-multi']['slaves'] = []\n>>>   4: default['mysql-multi']['slave_user'] = 'replicant'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-identity_registration.rb", "content": "admin_pass = get_password 'user', node['openstack']['identity']['admin_user']", "line": 43, "detection_span": [38, 48], "with_context": "\nservice_type = 'orchestration'\nservice_name = 'heat'\nservice_domain_name = node['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name']\nheat_domain_name = node['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name']\nadmin_user = node['openstack']['identity']['admin_user']\n43: admin_pass = get_password 'user', node['openstack']['identity']['admin_user']\nadmin_project = node['openstack']['identity']['admin_project']\nadmin_domain = node['openstack']['identity']['admin_domain_name']\nregion = node['openstack']['region']\n\nconnection_params = {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-identity_registration.rb\n# Target line: 43\n\n     38: service_type = 'orchestration'\n     39: service_name = 'heat'\n     40: service_domain_name = node['openstack']['orchestration']['conf']['keystone_authtoken']['user_domain_name']\n     41: heat_domain_name = node['openstack']['orchestration']['conf']['DEFAULT']['stack_user_domain_name']\n     42: admin_user = node['openstack']['identity']['admin_user']\n>>>  43: admin_pass = get_password 'user', node['openstack']['identity']['admin_user']\n     44: admin_project = node['openstack']['identity']['admin_project']\n     45: admin_domain = node['openstack']['identity']['admin_domain_name']\n     46: region = node['openstack']['region']\n     47: \n     48: connection_params = {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-save_screenshots_in_png_format.rb", "content": "key 'type'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Save screenshots in PNG format\" do\ndomain 'com.apple.screencapture'\n3:   key 'type'\nstring 'png'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-save_screenshots_in_png_format.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Save screenshots in PNG format\" do\n      2:   domain 'com.apple.screencapture'\n>>>   3:   key 'type'\n      4:   string 'png'\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-menu_show_clock_with_date.rb", "content": "key 'DateFormat'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Add date in menubar clock\" do\ndomain 'com.apple.menuextra.clock'\n3:   key 'DateFormat'\nstring \"\\\"EEE MMM d  HH:mm\\\"\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-menu_show_clock_with_date.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Add date in menubar clock\" do\n      2:   domain 'com.apple.menuextra.clock'\n>>>   3:   key 'DateFormat'\n      4:   string \"\\\"EEE MMM d  HH:mm\\\"\"\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstack_cookbook-openstack-network-recipes-identity_registration.rb", "content": "service_pass = get_password 'service', 'openstack-network'", "line": 35, "detection_span": [30, 40], "with_context": "\ninterfaces = {\npublic: { url: public_endpoint('network') },\ninternal: { url: internal_endpoint('network') },\n}\n\n35: service_pass = get_password 'service', 'openstack-network'\nservice_tenant_name = node['openstack']['network']['conf']['keystone_authtoken']['project_name']\n\nservice_user = node['openstack']['network']['conf']['keystone_authtoken']['username']\nservice_role = node['openstack']['network']['service_role']\nservice_domain_name = node['openstack']['network']['conf']['keystone_authtoken']['user_domain_name']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstack_cookbook-openstack-network-recipes-identity_registration.rb\n# Target line: 35\n\n     30: interfaces = {\n     31:   public: { url: public_endpoint('network') },\n     32:   internal: { url: internal_endpoint('network') },\n     33: }\n     34: \n>>>  35: service_pass = get_password 'service', 'openstack-network'\n     36: service_tenant_name = node['openstack']['network']['conf']['keystone_authtoken']['project_name']\n     37: \n     38: service_user = node['openstack']['network']['conf']['keystone_authtoken']['username']\n     39: service_role = node['openstack']['network']['service_role']\n     40: service_domain_name = node['openstack']['network']['conf']['keystone_authtoken']['user_domain_name']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb", "content": "server_username = \"_jenkins\"", "line": 47, "detection_span": [42, 52], "with_context": "\nwhen /mac_os_x/\ndefault[:jenkins][:server][:home_dir] = \"/Users/Shared/Jenkins\"\ndefault[:jenkins][:worker][:home_dir] = \"/Users/Shared/Jenkins\"\ndefault[:jenkins][:install_dir]       = \"/usr/local/lib\"\n\n47:   server_username = \"_jenkins\"\nworker_username = \"_jenkins\"\ngroup_name      = \"_jenkins\"\n\ndefault[:rbenv][:default_ruby]        = '1.9.3-p0'\ndefault[:rbenv][:rubies]['1.9.3-p0']  = ''", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb\n# Target line: 47\n\n     42: when /mac_os_x/\n     43:   default[:jenkins][:server][:home_dir] = \"/Users/Shared/Jenkins\"\n     44:   default[:jenkins][:worker][:home_dir] = \"/Users/Shared/Jenkins\"\n     45:   default[:jenkins][:install_dir]       = \"/usr/local/lib\"\n     46: \n>>>  47:   server_username = \"_jenkins\"\n     48:   worker_username = \"_jenkins\"\n     49:   group_name      = \"_jenkins\"\n     50: \n     51:   default[:rbenv][:default_ruby]        = '1.9.3-p0'\n     52:   default[:rbenv][:rubies]['1.9.3-p0']  = ''\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb", "content": "'admin' => 9696,", "line": 118, "detection_span": [113, 123], "with_context": "\n113:   },\n114:   'network' => {\n'name' => 'neutron',\n'description' => 'OpenStack Networking',\n'ports' => {\n118:       'admin' => 9696,\n'internal' => 9696,\n'public' => 9696,\n},\n'uris' => {\n'admin' => '',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb\n# Target line: 118\n\n    113:   },\n    114:   'network' => {\n    115:     'name' => 'neutron',\n    116:     'description' => 'OpenStack Networking',\n    117:     'ports' => {\n>>> 118:       'admin' => 9696,\n    119:       'internal' => 9696,\n    120:       'public' => 9696,\n    121:     },\n    122:     'uris' => {\n    123:       'admin' => '',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sous-chefs_sc-mongodb-recipes-mongodb_org_repo.rb", "content": "key \"https://www.mongodb.org/static/pgp/server-#{package_version_major}.asc\"", "line": 47, "detection_span": [42, 52], "with_context": "\n# Debian: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-debian/\napt_repository 'mongodb' do\nuri node['mongodb']['repo']\ndistribution \"#{node['lsb']['codename']}/mongodb-org/#{package_version_major}\"\ncomponents platform?('ubuntu') ? ['multiverse'] : ['main']\n47:     key \"https://www.mongodb.org/static/pgp/server-#{package_version_major}.asc\"\nend\nwhen 'amazon', 'fedora', 'rhel'\n# RHEL: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\n# Amazon: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-amazon/\nyum_repository 'mongodb' do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sous-chefs_sc-mongodb-recipes-mongodb_org_repo.rb\n# Target line: 47\n\n     42:   # Debian: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-debian/\n     43:   apt_repository 'mongodb' do\n     44:     uri node['mongodb']['repo']\n     45:     distribution \"#{node['lsb']['codename']}/mongodb-org/#{package_version_major}\"\n     46:     components platform?('ubuntu') ? ['multiverse'] : ['main']\n>>>  47:     key \"https://www.mongodb.org/static/pgp/server-#{package_version_major}.asc\"\n     48:   end\n     49: when 'amazon', 'fedora', 'rhel'\n     50:   # RHEL: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\n     51:   # Amazon: https://docs.mongodb.com/manual/tutorial/install-mongodb-on-amazon/\n     52:   yum_repository 'mongodb' do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Soluciones_ey-cloud-recipes-cookbooks-eybackup_slave-recipes-default.rb", "content": "key = `gpg --list-keys --with-colon | awk -F: '$1==\"pub\"{print $5}'`", "line": 52, "detection_span": [47, 57], "with_context": "\n\n# import key\nexecute \"gpg --import /root/backup_pgp_key\" if node[:public_key]\n\n# add the -k flag to the command\n52:       key = `gpg --list-keys --with-colon | awk -F: '$1==\"pub\"{print $5}'`\nbackup_command << \" -k #{key}\".rstrip unless key.empty?\nend\n\nbackup_command << \" >> /var/log/eybackup.log\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-eybackup_slave-recipes-default.rb\n# Target line: 52\n\n     47:     \n     48:       # import key\n     49:       execute \"gpg --import /root/backup_pgp_key\" if node[:public_key]\n     50:     \n     51:       # add the -k flag to the command\n>>>  52:       key = `gpg --list-keys --with-colon | awk -F: '$1==\"pub\"{print $5}'`\n     53:       backup_command << \" -k #{key}\".rstrip unless key.empty?\n     54:     end\n     55: \n     56:     backup_command << \" >> /var/log/eybackup.log\"\n     57: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guntukukamal_chef-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']       = 'www-data'", "line": 60, "detection_span": [55, 65], "with_context": "\ndefault['nginx']['default_root'] = '/usr/local/www/nginx-dist'\nwhen 'suse'\ndefault['nginx']['user']       = 'wwwrun'\ndefault['nginx']['group']      = 'www'\nelse # debian probably\n60:   default['nginx']['user']       = 'www-data'\nend\n\ndefault['nginx']['upstart']['runlevels']     = '2345'\ndefault['nginx']['upstart']['respawn_limit'] = nil\ndefault['nginx']['upstart']['foreground']    = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guntukukamal_chef-cookbooks-nginx-attributes-default.rb\n# Target line: 60\n\n     55:   default['nginx']['default_root'] = '/usr/local/www/nginx-dist'\n     56: when 'suse'\n     57:   default['nginx']['user']       = 'wwwrun'\n     58:   default['nginx']['group']      = 'www'\n     59: else # debian probably\n>>>  60:   default['nginx']['user']       = 'www-data'\n     61: end\n     62: \n     63: default['nginx']['upstart']['runlevels']     = '2345'\n     64: default['nginx']['upstart']['respawn_limit'] = nil\n     65: default['nginx']['upstart']['foreground']    = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-etl_jobs-attributes-default.rb", "content": "default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"", "line": 28, "detection_span": [23, 33], "with_context": "\ndefault[:etl][:event_job][:log_directory] = \"/isilon/event/\"\nwhen /^stage/\ndefault[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://10.5.50.101;databaseName=IHRDWH\"\ndefault[:etl][:data_warehouse][:host] = \"iad-dwh.prod.ihr\"\ndefault[:etl][:data_warehouse][:port] = \"1433\"\n28:   default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\ndefault[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\ndefault[:etl][:event_job][:archive_directory] = \"/data/log/event/processed\"\ndefault[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\ndefault[:etl][:event_job][:log_directory] = \"/data/log/event\"\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-etl_jobs-attributes-default.rb\n# Target line: 28\n\n     23:   default[:etl][:event_job][:log_directory] = \"/isilon/event/\"\n     24: when /^stage/\n     25:   default[:etl][:data_warehouse][:jdbc_url] = \"jdbc:jtds:sqlserver://10.5.50.101;databaseName=IHRDWH\"\n     26:   default[:etl][:data_warehouse][:host] = \"iad-dwh.prod.ihr\"\n     27:   default[:etl][:data_warehouse][:port] = \"1433\"\n>>>  28:   default[:etl][:data_warehouse][:batch_user_name] = \"appBatch\"\n     29:   default[:etl][:data_warehouse][:batch_user_password] = \"i8piZZa4u\"\n     30:   default[:etl][:event_job][:archive_directory] = \"/data/log/event/processed\"\n     31:   default[:etl][:event_job][:source_directory] = \"/data/log/event/input\"\n     32:   default[:etl][:event_job][:log_directory] = \"/data/log/event\"\n     33: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-compute-attributes-nova_conf.rb", "content": "conf['keystone_authtoken']['username'] = 'nova'", "line": 18, "detection_span": [13, 23], "with_context": "\nend\n\n# [keystone_authtoken]\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']\n18:   conf['keystone_authtoken']['username'] = 'nova'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_name'] = 'service'\nconf['keystone_authtoken']['auth_version'] = 'v3'\nconf['keystone_authtoken']['service_token_roles_required'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-compute-attributes-nova_conf.rb\n# Target line: 18\n\n     13:   end\n     14: \n     15:   # [keystone_authtoken]\n     16:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n     17:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n>>>  18:   conf['keystone_authtoken']['username'] = 'nova'\n     19:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n     20:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     21:   conf['keystone_authtoken']['project_name'] = 'service'\n     22:   conf['keystone_authtoken']['auth_version'] = 'v3'\n     23:   conf['keystone_authtoken']['service_token_roles_required'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-ops-database-recipes-mariadb-server.rb", "content": "username ''", "line": 77, "detection_span": [72, 82], "with_context": "\nnotifies :restart, 'service[mysql]', :immediately\nend\n\n# Remove anonymous localhost user\nmariadb_user 'anonymous' do\n77:   username ''\nhost 'localhost'\nctrl_password super_password\naction :drop\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-ops-database-recipes-mariadb-server.rb\n# Target line: 77\n\n     72:   notifies :restart, 'service[mysql]', :immediately\n     73: end\n     74: \n     75: # Remove anonymous localhost user\n     76: mariadb_user 'anonymous' do\n>>>  77:   username ''\n     78:   host 'localhost'\n     79:   ctrl_password super_password\n     80:   action :drop\n     81: end\n     82: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sharmamukesh76_chef-kibana-recipes-examples.rb", "content": "user 'kibana'", "line": 37, "detection_span": [32, 42], "with_context": "\ninstall_type 'file'\nend\n\nkibana_install 'git' do\nname 'kibana-git'\n37:   user 'kibana'\ngroup 'kibana'\ninstall_dir '/opt/kibana-git'\ninstall_type 'git'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sharmamukesh76_chef-kibana-recipes-examples.rb\n# Target line: 37\n\n     32:   install_type 'file'\n     33: end\n     34: \n     35: kibana_install 'git' do\n     36:   name 'kibana-git'\n>>>  37:   user 'kibana'\n     38:   group 'kibana'\n     39:   install_dir '/opt/kibana-git'\n     40:   install_type 'git'\n     41: end\n     42: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb", "content": "default[\"bcpc\"][\"hadoop\"][\"restart_lock\"][\"root\"] = \"/\"", "line": 52, "detection_span": [47, 57], "with_context": "\n#\n# Number of tries to acquire the lock required to restart the process\ndefault[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"max_tries\"] = 5\n# The path in ZK where the restart locks (znodes)  need to be created\n# The path should exist in ZooKeeper e.g. \"/lock\" and the default is \"/\"\n52: default[\"bcpc\"][\"hadoop\"][\"restart_lock\"][\"root\"] = \"/\"\n# Sleep time in seconds between tries to acquire the lock for restart\ndefault[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"sleep_time\"] = 2\n# Flag to set whether the restart process was successful or not\ndefault[\"bcpc\"][\"hadoop\"][\"datanode\"][\"restart_failed\"] = false\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb\n# Target line: 52\n\n     47: #\n     48: # Number of tries to acquire the lock required to restart the process\n     49: default[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"max_tries\"] = 5\n     50: # The path in ZK where the restart locks (znodes)  need to be created\n     51: # The path should exist in ZooKeeper e.g. \"/lock\" and the default is \"/\"\n>>>  52: default[\"bcpc\"][\"hadoop\"][\"restart_lock\"][\"root\"] = \"/\"\n     53: # Sleep time in seconds between tries to acquire the lock for restart\n     54: default[\"bcpc\"][\"hadoop\"][\"restart_lock_acquire\"][\"sleep_time\"] = 2\n     55: # Flag to set whether the restart process was successful or not\n     56: default[\"bcpc\"][\"hadoop\"][\"datanode\"][\"restart_failed\"] = false\n     57: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb", "content": "default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN", "line": 123, "detection_span": [118, 128], "with_context": "\n118: default[:bcpc][:hadoop][:os][:group][:hadoop][:members]=[\"hdfs\",\"yarn\"]\n119: default[:bcpc][:hadoop][:os][:group][:hdfs][:members]=[\"hdfs\"]\n120: default[:bcpc][:hadoop][:os][:group][:mapred][:members]=[\"yarn\"]\n121:\n122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb\n# Target line: 123\n\n    118: default[:bcpc][:hadoop][:os][:group][:hadoop][:members]=[\"hdfs\",\"yarn\"]\n    119: default[:bcpc][:hadoop][:os][:group][:hdfs][:members]=[\"hdfs\"]\n    120: default[:bcpc][:hadoop][:os][:group][:mapred][:members]=[\"yarn\"]\n    121: \n    122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n>>> 123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n    124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n    125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n    126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n    127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n    128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb", "content": "'admin' => 'v2/%(project_id)s',", "line": 53, "detection_span": [48, 58], "with_context": "\n'admin' => 8776,\n'internal' => 8776,\n'public' => 8776,\n},\n'uris' => {\n53:       'admin' => 'v2/%(project_id)s',\n'internal' => 'v2/%(project_id)s',\n'public' => 'v2/%(project_id)s',\n},\n},\n'volumev3' => {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-attributes-catalog.rb\n# Target line: 53\n\n     48:       'admin' => 8776,\n     49:       'internal' => 8776,\n     50:       'public' => 8776,\n     51:     },\n     52:     'uris' => {\n>>>  53:       'admin' => 'v2/%(project_id)s',\n     54:       'internal' => 'v2/%(project_id)s',\n     55:       'public' => 'v2/%(project_id)s',\n     56:     },\n     57:   },\n     58:   'volumev3' => {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-trackpad_double_tap_to_drag_with_drag_lock.rb", "content": "key 'Dragging'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Double-tap to drag with drag lock 1/2\" do\ndomain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'\n3:   key 'Dragging'\nboolean true\nend\n\nosxdefaults_defaults \"Double-tap to drag with drag lock 2/2\" do\ndomain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-trackpad_double_tap_to_drag_with_drag_lock.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Double-tap to drag with drag lock 1/2\" do\n      2:   domain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'\n>>>   3:   key 'Dragging'\n      4:   boolean true\n      5: end\n      6: \n      7: osxdefaults_defaults \"Double-tap to drag with drag lock 2/2\" do\n      8:   domain 'com.apple.driver.AppleBluetoothMultitouch.trackpad'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "Nikhil424_chef-repo-cookbooks-mysql-attributes-default.rb", "content": "default['mysql']['server_debian_password'] = nil", "line": 6, "detection_span": [1, 11], "with_context": "\n#\ndefault['mysql']['service_name'] = 'default'\n\n# passwords\ndefault['mysql']['server_root_password'] = 'ilikerandompasswords'\n6: default['mysql']['server_debian_password'] = nil\ndefault['mysql']['server_repl_password'] = nil\n\n# used in grants.sql\ndefault['mysql']['allow_remote_root'] = false\ndefault['mysql']['remove_anonymous_users'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-mysql-attributes-default.rb\n# Target line: 6\n\n      1: #\n      2: default['mysql']['service_name'] = 'default'\n      3: \n      4: # passwords\n      5: default['mysql']['server_root_password'] = 'ilikerandompasswords'\n>>>   6: default['mysql']['server_debian_password'] = nil\n      7: default['mysql']['server_repl_password'] = nil\n      8: \n      9: # used in grants.sql\n     10: default['mysql']['allow_remote_root'] = false\n     11: default['mysql']['remove_anonymous_users'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-rsyslog-attributes-default.rb", "content": "default[\"rsyslog\"][\"user\"] = \"syslog\"", "line": 42, "detection_span": [37, 47], "with_context": "\nif  node['platform_version'].to_f >= 10.10 then\ndefault[\"rsyslog\"][\"user\"] = \"root\"\ndefault[\"rsyslog\"][\"group\"] = \"adm\"\ndefault[\"rsyslog\"][\"priv_seperation\"] = false\nelse\n42:     default[\"rsyslog\"][\"user\"] = \"syslog\"\ndefault[\"rsyslog\"][\"group\"] = \"adm\"\ndefault[\"rsyslog\"][\"priv_seperation\"] = true\nend\nelse\n#values for fedora at least", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-rsyslog-attributes-default.rb\n# Target line: 42\n\n     37:   if  node['platform_version'].to_f >= 10.10 then\n     38:     default[\"rsyslog\"][\"user\"] = \"root\"\n     39:     default[\"rsyslog\"][\"group\"] = \"adm\"\n     40:     default[\"rsyslog\"][\"priv_seperation\"] = false\n     41:   else\n>>>  42:     default[\"rsyslog\"][\"user\"] = \"syslog\"\n     43:     default[\"rsyslog\"][\"group\"] = \"adm\"\n     44:     default[\"rsyslog\"][\"priv_seperation\"] = true\n     45:   end\n     46: else\n     47:   #values for fedora at least\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-nagios-attributes-server.rb", "content": "default['nagios']['ssl_cert_key']    = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"", "line": 57, "detection_span": [52, 62], "with_context": "\ndefault['nagios']['docroot']    = '/usr/share/nagios3/htdocs'\ndefault['nagios']['enable_ssl'] = false\ndefault['nagios']['http_port']  = node['nagios']['enable_ssl'] ? '443' : '80'\ndefault['nagios']['server_name'] = node.has_key?(:domain) ? \"nagios.#{domain}\" : 'nagios'\ndefault['nagios']['ssl_cert_file']   = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\n57: default['nagios']['ssl_cert_key']    = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\ndefault['nagios']['ssl_cert_chain']  = \"\"\ndefault['nagios']['ssl_req'] = '/C=US/ST=Several/L=Locality/O=Example/OU=Operations/' +\n\"CN=#{node['nagios']['server_name']}/emailAddress=ops@#{node['nagios']['server_name']}\"\n\n# for server from source installation", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-nagios-attributes-server.rb\n# Target line: 57\n\n     52: default['nagios']['docroot']    = '/usr/share/nagios3/htdocs'\n     53: default['nagios']['enable_ssl'] = false\n     54: default['nagios']['http_port']  = node['nagios']['enable_ssl'] ? '443' : '80'\n     55: default['nagios']['server_name'] = node.has_key?(:domain) ? \"nagios.#{domain}\" : 'nagios'\n     56: default['nagios']['ssl_cert_file']   = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\n>>>  57: default['nagios']['ssl_cert_key']    = \"#{node['nagios']['conf_dir']}/certificates/nagios-server.pem\"\n     58: default['nagios']['ssl_cert_chain']  = \"\"\n     59: default['nagios']['ssl_req'] = '/C=US/ST=Several/L=Locality/O=Example/OU=Operations/' +\n     60:   \"CN=#{node['nagios']['server_name']}/emailAddress=ops@#{node['nagios']['server_name']}\"\n     61: \n     62: # for server from source installation\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "wazuh_wazuh-chef-cookbooks-filebeat-oss-recipes-repository.rb", "content": "key 'https://packages.wazuh.com/key/GPG-KEY-WAZUH'", "line": 15, "detection_span": [10, 20], "with_context": "\nplugin 'lsb'\nsubscribes :reload, 'package[lsb-release]', :immediately\nend\n\napt_repository 'wazuh' do\n15:     key 'https://packages.wazuh.com/key/GPG-KEY-WAZUH'\nuri \"https://packages.wazuh.com/#{node['wazuh']['major_version']}/apt/\"\ncomponents ['main']\ndistribution 'stable'\naction :add\nnot_if {", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: wazuh_wazuh-chef-cookbooks-filebeat-oss-recipes-repository.rb\n# Target line: 15\n\n     10:     plugin 'lsb'\n     11:     subscribes :reload, 'package[lsb-release]', :immediately\n     12:   end\n     13: \n     14:   apt_repository 'wazuh' do\n>>>  15:     key 'https://packages.wazuh.com/key/GPG-KEY-WAZUH'\n     16:     uri \"https://packages.wazuh.com/#{node['wazuh']['major_version']}/apt/\"\n     17:     components ['main']\n     18:     distribution 'stable'\n     19:     action :add\n     20:     not_if {\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-attributes-default.rb", "content": "set_unless[:repo][:default][:svn_username] = \"\"", "line": 11, "detection_span": [6, 16], "with_context": "\n# if applicable, other agreements such as a RightScale Master Subscription Agreement.\n\nset_unless[:repo][:default][:repository] = \"\"\nset_unless[:repo][:default][:revision] = \"HEAD\"\nset_unless[:repo][:default][:provider] = \"repo_git\"\n11: set_unless[:repo][:default][:svn_username] = \"\"\nset_unless[:repo][:default][:svn_password] = \"\"\nset_unless[:repo][:default][:git_ssh_key] = \"\"\nset_unless[:repo][:default][:storage_account_provider] = \"S3\"\nset_unless[:repo][:default][:storage_account_id] = \"\"\nset_unless[:repo][:default][:storage_account_secret] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-attributes-default.rb\n# Target line: 11\n\n      6: # if applicable, other agreements such as a RightScale Master Subscription Agreement.\n      7: \n      8: set_unless[:repo][:default][:repository] = \"\"\n      9: set_unless[:repo][:default][:revision] = \"HEAD\"\n     10: set_unless[:repo][:default][:provider] = \"repo_git\"\n>>>  11: set_unless[:repo][:default][:svn_username] = \"\"\n     12: set_unless[:repo][:default][:svn_password] = \"\"\n     13: set_unless[:repo][:default][:git_ssh_key] = \"\"\n     14: set_unless[:repo][:default][:storage_account_provider] = \"S3\"\n     15: set_unless[:repo][:default][:storage_account_id] = \"\"\n     16: set_unless[:repo][:default][:storage_account_secret] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-db-attributes-default.rb", "content": "set_unless[:db][:current_master_uuid] = nil", "line": 42, "detection_span": [37, 47], "with_context": "\n\n# Default value for DB master/slave check\nset_unless[:db][:this_is_master] = false\n\n# Instance UUID and ip default values\n42: set_unless[:db][:current_master_uuid] = nil\nset_unless[:db][:current_master_ip] = nil\n\n\n# Calculate recommended backup times for master/slave\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-db-attributes-default.rb\n# Target line: 42\n\n     37: \n     38: # Default value for DB master/slave check\n     39: set_unless[:db][:this_is_master] = false\n     40: \n     41: # Instance UUID and ip default values\n>>>  42: set_unless[:db][:current_master_uuid] = nil\n     43: set_unless[:db][:current_master_ip] = nil\n     44: \n     45: \n     46: # Calculate recommended backup times for master/slave\n     47: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-mariadb-resources-server_install.rb", "content": "mariadb_root_password = (new_resource.password == 'generate' || new_resource.password.nil?) ? secure_random : new_resource.password", "line": 65, "detection_span": [60, 70], "with_context": "\nend\n\n# here we want to generate a new password if: 1- the user passed 'generate' to the password argument\n#                                             2- the user did not pass anything to the password argument OR\n#                                                the user did not define node['mariadb']['server_root_password'] attribute\n65:   mariadb_root_password = (new_resource.password == 'generate' || new_resource.password.nil?) ? secure_random : new_resource.password\n\n# Here we make sure to escape all \\ ' and \" characters so that they will be preserved in the final password\nmariadb_root_password = mariadb_root_password.gsub('\\\\', '\\\\\\\\\\\\').gsub('\\'', '\\\\\\\\\\'').gsub('\"', '\\\\\\\\\"')\n\n# Store the password in the run state for any other resources that may need it.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-mariadb-resources-server_install.rb\n# Target line: 65\n\n     60:   end\n     61: \n     62:   # here we want to generate a new password if: 1- the user passed 'generate' to the password argument\n     63:   #                                             2- the user did not pass anything to the password argument OR\n     64:   #                                                the user did not define node['mariadb']['server_root_password'] attribute\n>>>  65:   mariadb_root_password = (new_resource.password == 'generate' || new_resource.password.nil?) ? secure_random : new_resource.password\n     66: \n     67:   # Here we make sure to escape all \\ ' and \" characters so that they will be preserved in the final password\n     68:   mariadb_root_password = mariadb_root_password.gsub('\\\\', '\\\\\\\\\\\\').gsub('\\'', '\\\\\\\\\\'').gsub('\"', '\\\\\\\\\"')\n     69: \n     70:   # Store the password in the run state for any other resources that may need it.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_devel-attributes-talend.rb", "content": "default['imos_devel']['talend']['user'] = \"root\"", "line": 4, "detection_span": [1, 9], "with_context": "\n# Target installation directory for talend\ndefault['imos_devel']['talend']['install_dir'] = \"/var/lib/talend\"\n# Chown talend installation to this user\n4: default['imos_devel']['talend']['user'] = \"root\"\n\ndefault['imos_devel']['talend']['packages'] = [\n{\n\"source_url\" => \"https://s3-ap-southeast-2.amazonaws.com/imos-binary/static/talend/TOS_DI-r96646-V5.1.3.zip\",\n\"unzip_filter\" => \"TOS_DI-r96646-V5.1.3/*\",", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_devel-attributes-talend.rb\n# Target line: 4\n\n      1: # Target installation directory for talend\n      2: default['imos_devel']['talend']['install_dir'] = \"/var/lib/talend\"\n      3: # Chown talend installation to this user\n>>>   4: default['imos_devel']['talend']['user'] = \"root\"\n      5: \n      6: default['imos_devel']['talend']['packages'] = [\n      7:     {\n      8:         \"source_url\" => \"https://s3-ap-southeast-2.amazonaws.com/imos-binary/static/talend/TOS_DI-r96646-V5.1.3.zip\",\n      9:         \"unzip_filter\" => \"TOS_DI-r96646-V5.1.3/*\",\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-postgresql-libraries-postgresql.rb", "content": "config[:password] = postgresql_password config[:username] unless config[:password]", "line": 9, "detection_span": [4, 14], "with_context": "\nlocal_storage_read \"postgresql_password:#{user}\"\nend\n\ndef postgresql_config key\nconfig = extract_config key\n9:     config[:password] = postgresql_password config[:username] unless config[:password]\nconfig\nend\n\ndef postgresql_compute_host key\nconfig = extract_config key", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-postgresql-libraries-postgresql.rb\n# Target line: 9\n\n      4:     local_storage_read \"postgresql_password:#{user}\"\n      5:   end\n      6: \n      7:   def postgresql_config key\n      8:     config = extract_config key\n>>>   9:     config[:password] = postgresql_password config[:username] unless config[:password]\n     10:     config\n     11:   end\n     12: \n     13:   def postgresql_compute_host key\n     14:     config = extract_config key\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb", "content": "generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"", "line": 118, "detection_span": [113, 123], "with_context": "\nsensitive true\n114:   end\n115:\n116:   pam_services = %w(sudo su sshd)\n117:   pam_config_dir = \"/etc/pam.d\"\n118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\nssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\ntemplate generate_ssh_key_path do\nsource 'directory_service/generate_ssh_key.sh.erb'\nowner 'root'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_aws-parallelcluster-cookbook-cookbooks-aws-parallelcluster-config-recipes-directory_service.rb\n# Target line: 118\n\n    113:     sensitive true\n    114:   end\n    115: \n    116:   pam_services = %w(sudo su sshd)\n    117:   pam_config_dir = \"/etc/pam.d\"\n>>> 118:   generate_ssh_key_path = \"#{node['cluster']['scripts_dir']}/generate_ssh_key.sh\"\n    119:   ssh_key_generator_pam_config_line = \"session    optional     pam_exec.so log=/var/log/parallelcluster/pam_ssh_key_generator.log #{generate_ssh_key_path}\"\n    120:   if node['cluster'][\"directory_service\"][\"generate_ssh_keys_for_users\"] == 'true'\n    121:     template generate_ssh_key_path do\n    122:       source 'directory_service/generate_ssh_key.sh.erb'\n    123:       owner 'root'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-ceilometer_conf.rb", "content": "conf['service_credentials']['username'] = 'ceilometer'", "line": 12, "detection_span": [7, 17], "with_context": "\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']\n# [service_credentials] section\n12:   conf['service_credentials']['username'] = 'ceilometer'\nconf['service_credentials']['project_name'] = 'service'\nconf['service_credentials']['user_domain_name'] = 'Default'\nconf['service_credentials']['project_domain_name'] = 'Default'\nconf['service_credentials']['auth_type'] = 'v3password'\nconf['service_credentials']['interface'] = 'internal'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-ceilometer_conf.rb\n# Target line: 12\n\n      7:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n      8:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n      9:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     10:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n     11:   # [service_credentials] section\n>>>  12:   conf['service_credentials']['username'] = 'ceilometer'\n     13:   conf['service_credentials']['project_name'] = 'service'\n     14:   conf['service_credentials']['user_domain_name'] = 'Default'\n     15:   conf['service_credentials']['project_domain_name'] = 'Default'\n     16:   conf['service_credentials']['auth_type'] = 'v3password'\n     17:   conf['service_credentials']['interface'] = 'internal'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb", "content": "default[:hadoop][:namenode    ][:user]  = 'hdfs'", "line": 96, "detection_span": [91, 101], "with_context": "\n\ndefault[:users ]['mapred'     ][:uid]   = 303\ndefault[:groups]['mapred'     ][:gid]   = 303\n\ndefault[:hadoop][:user]                 = 'hdfs'\n96: default[:hadoop][:namenode    ][:user]  = 'hdfs'\ndefault[:hadoop][:secondarynn ][:user]  = 'hdfs'\ndefault[:hadoop][:jobtracker  ][:user]  = 'mapred'\ndefault[:hadoop][:datanode    ][:user]  = 'hdfs'\n100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n101:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb\n# Target line: 96\n\n     91: \n     92: default[:users ]['mapred'     ][:uid]   = 303\n     93: default[:groups]['mapred'     ][:gid]   = 303\n     94: \n     95: default[:hadoop][:user]                 = 'hdfs'\n>>>  96: default[:hadoop][:namenode    ][:user]  = 'hdfs'\n     97: default[:hadoop][:secondarynn ][:user]  = 'hdfs'\n     98: default[:hadoop][:jobtracker  ][:user]  = 'mapred'\n     99: default[:hadoop][:datanode    ][:user]  = 'hdfs'\n    100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n    101: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb", "content": "server_username = \"jenkins\"", "line": 61, "detection_span": [56, 66], "with_context": "\ndefault[:jenkins][:server][:home_dir] = \"/var/lib/jenkins\"\ndefault[:jenkins][:worker][:home_dir] = \"/var/lib/jenkins_worker\"\ndefault[:jenkins][:install_dir]       = \"/usr/share/jenkins\"\ndefault[:jenkins][:worker][:shell]    = \"/bin/bash\"\n\n61:   server_username = \"jenkins\"\nworker_username = \"jenkins_worker\"\ngroup_name      = \"jenkins\"\nend\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb\n# Target line: 61\n\n     56:   default[:jenkins][:server][:home_dir] = \"/var/lib/jenkins\"\n     57:   default[:jenkins][:worker][:home_dir] = \"/var/lib/jenkins_worker\"\n     58:   default[:jenkins][:install_dir]       = \"/usr/share/jenkins\"\n     59:   default[:jenkins][:worker][:shell]    = \"/bin/bash\"\n     60: \n>>>  61:   server_username = \"jenkins\"\n     62:   worker_username = \"jenkins_worker\"\n     63:   group_name      = \"jenkins\"\n     64: end\n     65: \n     66: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_swift-attributes-default.rb", "content": "default[\"swift\"][\"service_user\"] = \"swift\"                                  # node_attribute", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault[\"swift\"][\"disk_enum_expr\"] = \"node[:block_device]\"                  # cluster_attribute\ndefault[\"swift\"][\"auto_rebuild_rings\"] = false                              # cluster_attribute\ndefault[\"swift\"][\"autozone\"] = false                                        # cluster_attribute\n\ndefault[\"swift\"][\"service_tenant_name\"] = \"service\"                         # node_attribute\n11: default[\"swift\"][\"service_user\"] = \"swift\"                                  # node_attribute\ndefault[\"swift\"][\"dispersion_service_user\"] = \"dispersion\"                  # node_attribute\n# Replacing with OpenSSL::Password in recipes/proxy-server.rb\n#default[\"swift\"][\"service_pass\"] = \"tYPvpd5F\"\ndefault[\"swift\"][\"service_role\"] = \"admin\"                                  # node_attribute\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-attributes-default.rb\n# Target line: 11\n\n      6: default[\"swift\"][\"disk_enum_expr\"] = \"node[:block_device]\"                  # cluster_attribute\n      7: default[\"swift\"][\"auto_rebuild_rings\"] = false                              # cluster_attribute\n      8: default[\"swift\"][\"autozone\"] = false                                        # cluster_attribute\n      9: \n     10: default[\"swift\"][\"service_tenant_name\"] = \"service\"                         # node_attribute\n>>>  11: default[\"swift\"][\"service_user\"] = \"swift\"                                  # node_attribute\n     12: default[\"swift\"][\"dispersion_service_user\"] = \"dispersion\"                  # node_attribute\n     13: # Replacing with OpenSSL::Password in recipes/proxy-server.rb\n     14: #default[\"swift\"][\"service_pass\"] = \"tYPvpd5F\"\n     15: default[\"swift\"][\"service_role\"] = \"admin\"                                  # node_attribute\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-postgresql-definitions-postgresql_database.rb", "content": "config[:password] = local_storage_read(\"postgresql_password:#{config[:username]}\") do", "line": 11, "detection_span": [6, 16], "with_context": "\nconfig = extract_config postgresql_database_params[:name]\n\nif config[:host] == \"localhost\"\n\nunless config[:password]\n11:       config[:password] = local_storage_read(\"postgresql_password:#{config[:username]}\") do\nPasswordGenerator.generate 32\nend\nend\n\nexecute \"create user #{config[:username]}\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-postgresql-definitions-postgresql_database.rb\n# Target line: 11\n\n      6:   config = extract_config postgresql_database_params[:name]\n      7: \n      8:   if config[:host] == \"localhost\"\n      9: \n     10:     unless config[:password]\n>>>  11:       config[:password] = local_storage_read(\"postgresql_password:#{config[:username]}\") do\n     12:         PasswordGenerator.generate 32\n     13:       end\n     14:     end\n     15: \n     16:     execute \"create user #{config[:username]}\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['username'] = nil", "line": 97, "detection_span": [92, 102], "with_context": "\ndefault['yum']['main']['syslog_ident'] = nil\ndefault['yum']['main']['throttle'] = nil # [/\\d+k/, /\\d+M/, /\\d+G/]\ndefault['yum']['main']['timeout'] = nil # /\\d+/\ndefault['yum']['main']['tolerant'] = false\ndefault['yum']['main']['tsflags'] = nil\n97: default['yum']['main']['username'] = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-yum-attributes-main.rb\n# Target line: 97\n\n     92: default['yum']['main']['syslog_ident'] = nil\n     93: default['yum']['main']['throttle'] = nil # [/\\d+k/, /\\d+M/, /\\d+G/]\n     94: default['yum']['main']['timeout'] = nil # /\\d+/\n     95: default['yum']['main']['tolerant'] = false\n     96: default['yum']['main']['tsflags'] = nil\n>>>  97: default['yum']['main']['username'] = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb", "content": "default[:package_set][:pkgs][:sysadmin] = %w[ tree chkconfig dstat sysstat nmap ]", "line": 89, "detection_span": [84, 94], "with_context": "\n\ncase node.platform\nwhen 'centos', 'redhat'\ndefault[:package_set][:pkgs][:base]     = %w[ tree git zip openssl wget curl runit libxslt-devel ]\ndefault[:package_set][:pkgs][:dev]      = %w[ elinks w3m ctags-etags emacs-nox zsh thrift nc ]\n89:   default[:package_set][:pkgs][:sysadmin] = %w[ tree chkconfig dstat sysstat nmap ]\ndefault[:package_set][:pkgs][:text]     = %w[ libidn-devel libxml2-devel libxslt-devel tidy ]\ndefault[:package_set][:pkgs][:python]   = %w[ python-devel python-setuptools python-simplejson ]\ndefault[:package_set][:pkgs][:emacs]    = %w[ emacs-nox emacs-el ctags-etags ]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-package_set-attributes-default.rb\n# Target line: 89\n\n     84: \n     85: case node.platform\n     86: when 'centos', 'redhat'\n     87:   default[:package_set][:pkgs][:base]     = %w[ tree git zip openssl wget curl runit libxslt-devel ]\n     88:   default[:package_set][:pkgs][:dev]      = %w[ elinks w3m ctags-etags emacs-nox zsh thrift nc ]\n>>>  89:   default[:package_set][:pkgs][:sysadmin] = %w[ tree chkconfig dstat sysstat nmap ]\n     90:   default[:package_set][:pkgs][:text]     = %w[ libidn-devel libxml2-devel libxslt-devel tidy ]\n     91:   default[:package_set][:pkgs][:python]   = %w[ python-devel python-setuptools python-simplejson ]\n     92:   default[:package_set][:pkgs][:emacs]    = %w[ emacs-nox emacs-el ctags-etags ]\n     93: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_magentostack-attributes-magento.rb", "content": "normal['magentostack']['mysql']['databases']['magento_database']['mysql_user'] = 'magento_user'", "line": 47, "detection_span": [42, 52], "with_context": "\ndefault['magentostack']['git_deploykey'] = nil\ndefault['magentostack']['git_submodules'] = false\ndefault['magentostack']['git_ssh_args'] = ['StrictHostKeyChecking=no']\n\n# Database creation by the mysql cookbook\n47: normal['magentostack']['mysql']['databases']['magento_database']['mysql_user'] = 'magento_user'\nnormal['magentostack']['mysql']['databases']['magento_database']['mysql_password'] = 'magento_password'\nnormal['magentostack']['mysql']['databases']['magento_database']['privileges'] = ['all']\nnormal['magentostack']['mysql']['databases']['magento_database']['global_privileges'] = [:usage, :select, :'lock tables', :'show view', :reload, :super]\n\n# Magento configuration", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_magentostack-attributes-magento.rb\n# Target line: 47\n\n     42: default['magentostack']['git_deploykey'] = nil\n     43: default['magentostack']['git_submodules'] = false\n     44: default['magentostack']['git_ssh_args'] = ['StrictHostKeyChecking=no']\n     45: \n     46: # Database creation by the mysql cookbook\n>>>  47: normal['magentostack']['mysql']['databases']['magento_database']['mysql_user'] = 'magento_user'\n     48: normal['magentostack']['mysql']['databases']['magento_database']['mysql_password'] = 'magento_password'\n     49: normal['magentostack']['mysql']['databases']['magento_database']['privileges'] = ['all']\n     50: normal['magentostack']['mysql']['databases']['magento_database']['global_privileges'] = [:usage, :select, :'lock tables', :'show view', :reload, :super]\n     51: \n     52: # Magento configuration\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-felix.rb", "content": "cert_type = headnode? ? 'client-rw' : 'client-ro'", "line": 31, "detection_span": [26, 36], "with_context": "\nfile '/etc/calico/felix.cfg.example' do\naction :delete\nend\n\n# determine cert type\n31: cert_type = headnode? ? 'client-rw' : 'client-ro'\n\ntemplate '/etc/calico/calicoctl.cfg' do\nsource 'calico/calicoctl.cfg.erb'\nvariables(\ncert_type: cert_type", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: bloomberg_chef-bcpc-chef-cookbooks-bcpc-recipes-calico-felix.rb\n# Target line: 31\n\n     26: file '/etc/calico/felix.cfg.example' do\n     27:   action :delete\n     28: end\n     29: \n     30: # determine cert type\n>>>  31: cert_type = headnode? ? 'client-rw' : 'client-ro'\n     32: \n     33: template '/etc/calico/calicoctl.cfg' do\n     34:   source 'calico/calicoctl.cfg.erb'\n     35:   variables(\n     36:     cert_type: cert_type\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-db_create.rb", "content": "user \"postgres\"", "line": 14, "detection_span": [9, 19], "with_context": "\ncommand \"psql -c \\\"create database #{node['db_name']} owner #{node['db_admin_name']};\\\"\"\nnot_if { `sudo -u postgres psql -tAc \\\"SELECT * FROM pg_database WHERE datname='#{node['db_name']}';\\\" | wc -l`.chomp == \"1\" }\nend\n\nexecute \"create adminpack extension\" do\n14:    user \"postgres\"\ncommand \"psql -d #{node['db_name']} -c \\\"create extension adminpack;\\\"\"\nnot_if { `sudo -u postgres psql -d '#{node['db_name']}' -tAc \\\"SELECT * FROM pg_extension where extname = 'adminpack';\\\" | wc -l`.chomp == \"1\" }\nend\n\nexecute \"create hstore extension\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-db_create.rb\n# Target line: 14\n\n      9:    command \"psql -c \\\"create database #{node['db_name']} owner #{node['db_admin_name']};\\\"\"\n     10:    not_if { `sudo -u postgres psql -tAc \\\"SELECT * FROM pg_database WHERE datname='#{node['db_name']}';\\\" | wc -l`.chomp == \"1\" }\n     11: end\n     12: \n     13: execute \"create adminpack extension\" do\n>>>  14:    user \"postgres\"\n     15:    command \"psql -d #{node['db_name']} -c \\\"create extension adminpack;\\\"\"\n     16:    not_if { `sudo -u postgres psql -d '#{node['db_name']}' -tAc \\\"SELECT * FROM pg_extension where extname = 'adminpack';\\\" | wc -l`.chomp == \"1\" }\n     17: end\n     18: \n     19: execute \"create hstore extension\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-web_apache-attributes-default.rb", "content": "set[:web_apache][:docroot] = \"/home/webapp/#{web_apache[:application_name]}\"", "line": 48, "detection_span": [43, 53], "with_context": "\nset_unless[:web_apache][:ssl_certificate_chain] = nil\nset_unless[:web_apache][:ssl_key] = nil\nset_unless[:web_apache][:ssl_passphrase] = nil\n\n# Apache document root\n48: set[:web_apache][:docroot] = \"/home/webapp/#{web_apache[:application_name]}\"\n\n# Default servername for web_apache vhost file\nset[:web_apache][:server_name] = \"localhost\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-web_apache-attributes-default.rb\n# Target line: 48\n\n     43: set_unless[:web_apache][:ssl_certificate_chain] = nil\n     44: set_unless[:web_apache][:ssl_key] = nil\n     45: set_unless[:web_apache][:ssl_passphrase] = nil\n     46: \n     47: # Apache document root\n>>>  48: set[:web_apache][:docroot] = \"/home/webapp/#{web_apache[:application_name]}\"\n     49: \n     50: # Default servername for web_apache vhost file\n     51: set[:web_apache][:server_name] = \"localhost\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb", "content": "default[:hadoop][:tasktracker ][:user]  = 'mapred'", "line": 100, "detection_span": [95, 105], "with_context": "\ndefault[:hadoop][:user]                 = 'hdfs'\ndefault[:hadoop][:namenode    ][:user]  = 'hdfs'\ndefault[:hadoop][:secondarynn ][:user]  = 'hdfs'\ndefault[:hadoop][:jobtracker  ][:user]  = 'mapred'\ndefault[:hadoop][:datanode    ][:user]  = 'hdfs'\n100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n101:\n102: #\n103: # Install\n104: #\n105:", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-hadoop_cluster-attributes-default.rb\n# Target line: 100\n\n     95: default[:hadoop][:user]                 = 'hdfs'\n     96: default[:hadoop][:namenode    ][:user]  = 'hdfs'\n     97: default[:hadoop][:secondarynn ][:user]  = 'hdfs'\n     98: default[:hadoop][:jobtracker  ][:user]  = 'mapred'\n     99: default[:hadoop][:datanode    ][:user]  = 'hdfs'\n>>> 100: default[:hadoop][:tasktracker ][:user]  = 'mapred'\n    101: \n    102: #\n    103: # Install\n    104: #\n    105: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb", "content": "default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"", "line": 127, "detection_span": [122, 132], "with_context": "\n122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"\n129:\n130: default[\"bcpc\"][\"hadoop\"][\"java\"] = \"/usr/lib/jvm/java-7-oracle-amd64\"\n131:\n132: default['java']['install_flavor'] = \"oracle\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-attributes-default.rb\n# Target line: 127\n\n    122: default[:bcpc][:hadoop][:hdfs][:ldap][:integration] = false\n    123: default[:bcpc][:hadoop][:hdfs][:ldap][:user] = \"\" #must be LDAP DN\n    124: default[:bcpc][:hadoop][:hdfs][:ldap][:domain] = \"BCPC.EXAMPLE.COM\"\n    125: default[:bcpc][:hadoop][:hdfs][:ldap][:port] = 389\n    126: default[:bcpc][:hadoop][:hdfs][:ldap][:password] =  nil\n>>> 127: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:user]=\"(&(objectclass=user)(sAMAccountName={0}))\"\n    128: default[:bcpc][:hadoop][:hdfs][:ldap][:search][:filter][:group]=\"(objectClass=group)\"\n    129: \n    130: default[\"bcpc\"][\"hadoop\"][\"java\"] = \"/usr/lib/jvm/java-7-oracle-amd64\"\n    131: \n    132: default['java']['install_flavor'] = \"oracle\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-master_chef-libraries-local_storage.rb", "content": "result[key] = symbolize_keys v", "line": 68, "detection_span": [63, 73], "with_context": "\nreturn nil unless hash\nreturn hash unless hash.is_a? Hash\nresult = {}\nhash.each do |k, v|\nkey = k.is_a?(String) ? k.to_sym : k\n68:         result[key] = symbolize_keys v\nend\nresult\nend\n\ndef read_file", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-master_chef-libraries-local_storage.rb\n# Target line: 68\n\n     63:       return nil unless hash\n     64:       return hash unless hash.is_a? Hash\n     65:       result = {}\n     66:       hash.each do |k, v|\n     67:         key = k.is_a?(String) ? k.to_sym : k\n>>>  68:         result[key] = symbolize_keys v\n     69:       end\n     70:       result\n     71:     end\n     72: \n     73:     def read_file\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']       = \"www-data\"", "line": 40, "detection_span": [35, 45], "with_context": "\ndefault['nginx']['init_style'] = \"runit\"\nwhen \"redhat\",\"centos\",\"scientific\",\"amazon\",\"oracle\",\"fedora\"\ndefault['nginx']['user']       = \"nginx\"\ndefault['nginx']['init_style'] = \"init\"\nelse\n40:   default['nginx']['user']       = \"www-data\"\ndefault['nginx']['init_style'] = \"init\"\nend\n\ndefault['nginx']['group'] = node['nginx']['user']\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nginx-attributes-default.rb\n# Target line: 40\n\n     35:   default['nginx']['init_style'] = \"runit\"\n     36: when \"redhat\",\"centos\",\"scientific\",\"amazon\",\"oracle\",\"fedora\"\n     37:   default['nginx']['user']       = \"nginx\"\n     38:   default['nginx']['init_style'] = \"init\"\n     39: else\n>>>  40:   default['nginx']['user']       = \"www-data\"\n     41:   default['nginx']['init_style'] = \"init\"\n     42: end\n     43: \n     44: default['nginx']['group'] = node['nginx']['user']\n     45: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "criteo-cookbooks_nexus3-api_examples-admin.rb", "content": "password 'admin456'", "line": 17, "detection_span": [12, 22], "with_context": "\n# Update admin's email address using the new admin password\nnexus3_api 'admin_update_email' do\ncontent \"def user = security.securitySystem.getUser('admin');\" \\\n\"user.setEmailAddress('admin@mycompany.com');\" \\\n'security.securitySystem.updateUser(user);'\n17:   password 'admin456'\naction :run\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_nexus3-api_examples-admin.rb\n# Target line: 17\n\n     12: # Update admin's email address using the new admin password\n     13: nexus3_api 'admin_update_email' do\n     14:   content \"def user = security.securitySystem.getUser('admin');\" \\\n     15:     \"user.setEmailAddress('admin@mycompany.com');\" \\\n     16:     'security.securitySystem.updateUser(user);'\n>>>  17:   password 'admin456'\n     18:   action :run\n     19: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-git-attributes-default.rb", "content": "default[:git][:user]        = 'root'", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:git][:user]        = 'root'\ndefault[:git][:deploy_root] = '/etc/deploy'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-git-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:git][:user]        = 'root'\n      2: default[:git][:deploy_root] = '/etc/deploy'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-block-storage-attributes-cinder_conf.rb", "content": "conf['nova']['username'] = 'nova'", "line": 20, "detection_span": [15, 25], "with_context": "\nconf['keystone_authtoken']['project_name'] = 'service'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['nova']['auth_type'] = 'password'\nconf['nova']['region_name'] = node['openstack']['region']\n20:   conf['nova']['username'] = 'nova'\nconf['nova']['project_name'] = 'service'\nconf['nova']['user_domain_name'] = 'Default'\nconf['nova']['project_domain_name'] = 'Default'\n\nconf['oslo_concurrency']['lock_path'] = '/var/lib/cinder/tmp'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-block-storage-attributes-cinder_conf.rb\n# Target line: 20\n\n     15:   conf['keystone_authtoken']['project_name'] = 'service'\n     16:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n     17:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     18:   conf['nova']['auth_type'] = 'password'\n     19:   conf['nova']['region_name'] = node['openstack']['region']\n>>>  20:   conf['nova']['username'] = 'nova'\n     21:   conf['nova']['project_name'] = 'service'\n     22:   conf['nova']['user_domain_name'] = 'Default'\n     23:   conf['nova']['project_domain_name'] = 'Default'\n     24: \n     25:   conf['oslo_concurrency']['lock_path'] = '/var/lib/cinder/tmp'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "thomas-stern_rsed-chef-training-cookbooks-db-attributes-default.rb", "content": "set_unless[:db][:replication][:user] = nil", "line": 23, "detection_span": [18, 28], "with_context": "\n# Default settings for database administrator user and password\nset_unless[:db][:admin][:user] = \"root\"\nset_unless[:db][:admin][:password] = \"\"\n\n# Default settings for database replication user and password\n23: set_unless[:db][:replication][:user] = nil\nset_unless[:db][:replication][:password] = nil\n\n# Default settings for backup lineage\nset_unless[:db][:backup][:lineage] = \"\"\nset_unless[:db][:backup][:lineage_override] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: thomas-stern_rsed-chef-training-cookbooks-db-attributes-default.rb\n# Target line: 23\n\n     18: # Default settings for database administrator user and password\n     19: set_unless[:db][:admin][:user] = \"root\"\n     20: set_unless[:db][:admin][:password] = \"\"\n     21: \n     22: # Default settings for database replication user and password\n>>>  23: set_unless[:db][:replication][:user] = nil\n     24: set_unless[:db][:replication][:password] = nil\n     25: \n     26: # Default settings for backup lineage\n     27: set_unless[:db][:backup][:lineage] = \"\"\n     28: set_unless[:db][:backup][:lineage_override] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb", "content": "key 'NewWindowTargetPath'", "line": 9, "detection_span": [4, 14], "with_context": "\nstring \"PfHm\"\nend\n\nosxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\ndomain 'com.apple.finder'\n9:   key 'NewWindowTargetPath'\nstring \"file://localhost/Users/#{node['current_user']}/\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb\n# Target line: 9\n\n      4:   string \"PfHm\"\n      5: end\n      6: \n      7: osxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\n      8:   domain 'com.apple.finder'\n>>>   9:   key 'NewWindowTargetPath'\n     10:   string \"file://localhost/Users/#{node['current_user']}/\"\n     11: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "logicalclocks_hopsmonitor-chef-recipes-prometheus.rb", "content": "key = \"#{crypto_dir}/#{x509_helper.get_private_key_pkcs8_name(node['hopsmonitor']['user'])}\"", "line": 79, "detection_span": [74, 84], "with_context": "\nto node['prometheus']['home']\nend\n\ncrypto_dir = x509_helper.get_crypto_dir(node['hopsmonitor']['user'])\ncertificate = \"#{crypto_dir}/#{x509_helper.get_certificate_bundle_name(node['hopsmonitor']['user'])}\"\n79: key = \"#{crypto_dir}/#{x509_helper.get_private_key_pkcs8_name(node['hopsmonitor']['user'])}\"\nhops_ca = \"#{crypto_dir}/#{x509_helper.get_hops_ca_bundle_name()}\"\n#check if installation for managed cloud, aka: enterprise installation and installing the cloud recipe\nmanaged_cloud = (node['install']['enterprise']['install'].casecmp? \"true\" and exists_local(\"cloud\", \"default\"))\ntemplate \"#{node['prometheus']['base_dir']}/prometheus.yml\" do\nsource \"prometheus.yml.erb\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: logicalclocks_hopsmonitor-chef-recipes-prometheus.rb\n# Target line: 79\n\n     74:   to node['prometheus']['home']\n     75: end\n     76: \n     77: crypto_dir = x509_helper.get_crypto_dir(node['hopsmonitor']['user'])\n     78: certificate = \"#{crypto_dir}/#{x509_helper.get_certificate_bundle_name(node['hopsmonitor']['user'])}\"\n>>>  79: key = \"#{crypto_dir}/#{x509_helper.get_private_key_pkcs8_name(node['hopsmonitor']['user'])}\"\n     80: hops_ca = \"#{crypto_dir}/#{x509_helper.get_hops_ca_bundle_name()}\"\n     81: #check if installation for managed cloud, aka: enterprise installation and installing the cloud recipe \n     82: managed_cloud = (node['install']['enterprise']['install'].casecmp? \"true\" and exists_local(\"cloud\", \"default\"))\n     83: template \"#{node['prometheus']['base_dir']}/prometheus.yml\" do\n     84:   source \"prometheus.yml.erb\" \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb", "content": "default['hadoop']['yarn_user'] = 'yarn'", "line": 34, "detection_span": [29, 39], "with_context": "\ndefault['hadoop']['data_dir'] = '/var/lib/hadoop'\ndefault['hadoop']['log_dir'] = '/var/log/hadoop'\ndefault['hadoop']['pid_dir'] = '/var/run/hadoop'\ndefault['hadoop']['group'] = 'hadoop'\ndefault['hadoop']['hdfs_user'] = 'hdfs'\n34: default['hadoop']['yarn_user'] = 'yarn'\n\n# Per service settings\ndefault['hadoop']['hdfs-site']\\\n['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'\ndefault['hadoop']['hdfs-site']['dfs.namenode.name.dir'] =", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb\n# Target line: 34\n\n     29: default['hadoop']['data_dir'] = '/var/lib/hadoop'\n     30: default['hadoop']['log_dir'] = '/var/log/hadoop'\n     31: default['hadoop']['pid_dir'] = '/var/run/hadoop'\n     32: default['hadoop']['group'] = 'hadoop'\n     33: default['hadoop']['hdfs_user'] = 'hdfs'\n>>>  34: default['hadoop']['yarn_user'] = 'yarn'\n     35: \n     36: # Per service settings\n     37: default['hadoop']['hdfs-site']\\\n     38:        ['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'\n     39: default['hadoop']['hdfs-site']['dfs.namenode.name.dir'] =\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-diamond-attributes-mysql.rb", "content": "default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\ndefault['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\ndefault['diamond']['collectors']['MySQLCollector']['port'] = 3306\ndefault['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\ndefault['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\n6: default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-diamond-attributes-mysql.rb\n# Target line: 6\n\n      1: default['diamond']['collectors']['MySQLCollector']['path'] = \"mysql\"\n      2: default['diamond']['collectors']['MySQLCollector']['host'] = \"localhost\"\n      3: default['diamond']['collectors']['MySQLCollector']['port'] = 3306\n      4: default['diamond']['collectors']['MySQLCollector']['db'] = \"information_schema\"\n      5: default['diamond']['collectors']['MySQLCollector']['user'] = \"user\"\n>>>   6: default['diamond']['collectors']['MySQLCollector']['password'] = \"password\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_osl-openstack-attributes-default.rb", "content": "default['osl-openstack']['block']['rbd_store_user'] = 'cinder'", "line": 35, "detection_span": [30, 40], "with_context": "\ndefault['osl-openstack']['database_suffix'] = nil\ndefault['osl-openstack']['databag_prefix'] = nil\ndefault['osl-openstack']['compute']['rbd_store_pool'] = 'vms'\ndefault['osl-openstack']['block']['rbd_store_pool'] = 'volumes'\ndefault['osl-openstack']['block']['rbd_ssd_pool'] = 'volumes_ssd'\n35: default['osl-openstack']['block']['rbd_store_user'] = 'cinder'\ndefault['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\ndefault['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\ndefault['osl-openstack']['image']['glance_vol'] = nil\ndefault['osl-openstack']['image']['rbd_store_pool'] = 'images'\ndefault['osl-openstack']['image']['rbd_store_user'] = 'glance'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_osl-openstack-attributes-default.rb\n# Target line: 35\n\n     30: default['osl-openstack']['database_suffix'] = nil\n     31: default['osl-openstack']['databag_prefix'] = nil\n     32: default['osl-openstack']['compute']['rbd_store_pool'] = 'vms'\n     33: default['osl-openstack']['block']['rbd_store_pool'] = 'volumes'\n     34: default['osl-openstack']['block']['rbd_ssd_pool'] = 'volumes_ssd'\n>>>  35: default['osl-openstack']['block']['rbd_store_user'] = 'cinder'\n     36: default['osl-openstack']['block_backup']['rbd_store_pool'] = 'backups'\n     37: default['osl-openstack']['block_backup']['rbd_store_user'] = 'cinder-backup'\n     38: default['osl-openstack']['image']['glance_vol'] = nil\n     39: default['osl-openstack']['image']['rbd_store_pool'] = 'images'\n     40: default['osl-openstack']['image']['rbd_store_user'] = 'glance'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jonmthomson_cookbooks-windows-providers-certificate.rb", "content": "password = \", \\\"#{@new_resource.pfx_password}\\\"\" if file.downcase.end_with?('pfx')", "line": 67, "detection_span": [62, 72], "with_context": "\nhash = nil\n\nif ::File.exists?(@new_resource.source)\n# source is a file so get hash from that\nfile = win_friendly_path(@new_resource.source)\n67:     password = \", \\\"#{@new_resource.pfx_password}\\\"\" if file.downcase.end_with?('pfx')\nhash = \"(New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \\\"#{file}\\\"#{password}).GetCertHashString()\"\nelse\n# make sure we have no spaces in the hash string\nhash = \"\\\"#{@new_resource.source.gsub(/\\s/, '')}\\\"\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jonmthomson_cookbooks-windows-providers-certificate.rb\n# Target line: 67\n\n     62:   hash = nil\n     63: \n     64:   if ::File.exists?(@new_resource.source)\n     65:     # source is a file so get hash from that\n     66:     file = win_friendly_path(@new_resource.source)\n>>>  67:     password = \", \\\"#{@new_resource.pfx_password}\\\"\" if file.downcase.end_with?('pfx')\n     68:     hash = \"(New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \\\"#{file}\\\"#{password}).GetCertHashString()\"\n     69:   else\n     70:     # make sure we have no spaces in the hash string\n     71:     hash = \"\\\"#{@new_resource.source.gsub(/\\s/, '')}\\\"\"\n     72:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb", "content": "public_key_format :openssh", "line": 7, "detection_span": [2, 12], "with_context": "\n\n# Create a key that we'll use for org, admin user, and client.\nprivate_key '/shared/keys/test.pem' do\ncipher            'DES-EDE3-CBC'\nformat            :pem\n7:   public_key_format :openssh\npublic_key_path   '/shared/keys/test.pub'\nsize              2048\ntype              :rsa\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb\n# Target line: 7\n\n      2: \n      3: # Create a key that we'll use for org, admin user, and client.\n      4: private_key '/shared/keys/test.pem' do\n      5:   cipher            'DES-EDE3-CBC'\n      6:   format            :pem\n>>>   7:   public_key_format :openssh\n      8:   public_key_path   '/shared/keys/test.pub'\n      9:   size              2048\n     10:   type              :rsa\n     11: end\n     12: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-osm_renderd.rb", "content": "user 'osmdata'", "line": 2, "detection_span": [1, 7], "with_context": "\nbash 'install_mod_tile' do\n2:    user 'osmdata'\ncwd '/home/osmdata/src'\ncode <<-EOH\ncd /home/osmdata/src\ngit clone git://github.com/openstreetmap/mod_tile.git\ncd /home/osmdata/src/mod_tile", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ROGUE-JCTD_osm-tileset-chef-repo-cookbooks-geoshapeosm-recipes-osm_renderd.rb\n# Target line: 2\n\n      1: bash 'install_mod_tile' do\n>>>   2:    user 'osmdata'\n      3:    cwd '/home/osmdata/src'\n      4:    code <<-EOH\n      5: \tcd /home/osmdata/src\n      6: \tgit clone git://github.com/openstreetmap/mod_tile.git\n      7: \tcd /home/osmdata/src/mod_tile\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-snappy-cookbooks-hbase-attributes-default.rb", "content": "node[:hbase][:user] = 'hbase'", "line": 48, "detection_span": [43, 53], "with_context": "\n#\n# Users\n#\n\n# hbase user\n48: node[:hbase][:user] = 'hbase'\ndefault[:users ]['hbase'     ][:uid]    = 304\ndefault[:groups]['hbase'     ][:gid]    = 304\n\n#\n# Run state of daemons", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-snappy-cookbooks-hbase-attributes-default.rb\n# Target line: 48\n\n     43: #\n     44: # Users\n     45: #\n     46: \n     47: # hbase user\n>>>  48: node[:hbase][:user] = 'hbase'\n     49: default[:users ]['hbase'     ][:uid]    = 304\n     50: default[:groups]['hbase'     ][:gid]    = 304\n     51: \n     52: #\n     53: # Run state of daemons\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-cookbooks-ruby-ng-recipes-default.rb", "content": "key 'C3173AA6'", "line": 10, "detection_span": [5, 15], "with_context": "\napt_repository \"brightbox-#{name}\" do\nuri \"http://ppa.launchpad.net/brightbox/#{name}/ubuntu\"\ndistribution node['lsb']['codename']\ncomponents [ 'main' ]\nkeyserver 'keyserver.ubuntu.com'\n10:   key 'C3173AA6'\nend\n\napt_preference 'ruby-ng-01-disable_by_default' do\nglob '*'\npin \"release o=LP-PPA-brightbox-#{name}\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-ruby-ng-recipes-default.rb\n# Target line: 10\n\n      5: apt_repository \"brightbox-#{name}\" do\n      6:   uri \"http://ppa.launchpad.net/brightbox/#{name}/ubuntu\"\n      7:   distribution node['lsb']['codename']\n      8:   components [ 'main' ]\n      9:   keyserver 'keyserver.ubuntu.com'\n>>>  10:   key 'C3173AA6'\n     11: end\n     12: \n     13: apt_preference 'ruby-ng-01-disable_by_default' do\n     14:   glob '*'\n     15:   pin \"release o=LP-PPA-brightbox-#{name}\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-storm-attributes-default.rb", "content": "default[:storm][:user]                     = 'storm'", "line": 12, "detection_span": [7, 17], "with_context": "\ndefault[:storm][:jzmq][:release_url]       = 'https://github.com/zeromq/jzmq/archive/v2.1.0.tar.gz'\n\n#\n# Users\n#\n12: default[:storm][:user]                     = 'storm'\ndefault[:users ]['storm'][:uid]            = 370\ndefault[:groups]['storm'][:gid]            = 370\n\n#\n# Directories", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-storm-attributes-default.rb\n# Target line: 12\n\n      7: default[:storm][:jzmq][:release_url]       = 'https://github.com/zeromq/jzmq/archive/v2.1.0.tar.gz'\n      8: \n      9: #\n     10: # Users\n     11: #\n>>>  12: default[:storm][:user]                     = 'storm'\n     13: default[:users ]['storm'][:uid]            = 370\n     14: default[:groups]['storm'][:gid]            = 370\n     15: \n     16: #\n     17: # Directories\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-rvm-cookbooks-zookeeper-attributes-default.rb", "content": "default[:zookeeper][:user]                   = 'zookeeper'", "line": 25, "detection_span": [20, 30], "with_context": "\n\n#\n# User\n#\n\n25: default[:zookeeper][:user]                   = 'zookeeper'\ndefault[:users ]['zookeeper' ][:uid]         = 305\ndefault[:groups]['zookeeper' ][:gid]         = 305\n\n#\n# Install", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-rvm-cookbooks-zookeeper-attributes-default.rb\n# Target line: 25\n\n     20: \n     21: #\n     22: # User\n     23: #\n     24: \n>>>  25: default[:zookeeper][:user]                   = 'zookeeper'\n     26: default[:users ]['zookeeper' ][:uid]         = 305\n     27: default[:groups]['zookeeper' ][:gid]         = 305\n     28: \n     29: #\n     30: # Install\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jenkins-attributes-server.rb", "content": "default['jenkins']['http_proxy']['ssl']['key_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.key\"", "line": 66, "detection_span": [61, 71], "with_context": "\ndefault['jenkins']['http_proxy']['ssl']['enabled'] = false\ndefault['jenkins']['http_proxy']['ssl']['redirect_http'] = false\ndefault['jenkins']['http_proxy']['ssl']['ssl_listen_ports'] = [ 443 ]\ndefault['jenkins']['http_proxy']['ssl']['dir'] = \"#{default['jenkins']['server']['home']}/ssl\"\ndefault['jenkins']['http_proxy']['ssl']['cert_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.cert\"\n66: default['jenkins']['http_proxy']['ssl']['key_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.key\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-attributes-server.rb\n# Target line: 66\n\n     61: default['jenkins']['http_proxy']['ssl']['enabled'] = false\n     62: default['jenkins']['http_proxy']['ssl']['redirect_http'] = false\n     63: default['jenkins']['http_proxy']['ssl']['ssl_listen_ports'] = [ 443 ]\n     64: default['jenkins']['http_proxy']['ssl']['dir'] = \"#{default['jenkins']['server']['home']}/ssl\"\n     65: default['jenkins']['http_proxy']['ssl']['cert_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.cert\"\n>>>  66: default['jenkins']['http_proxy']['ssl']['key_path'] = \"#{default['jenkins']['http_proxy']['ssl']['dir']}/jenkins.key\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-dock_position_the_dock_on_the_right_side.rb", "content": "key 'orientation'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Move the Dock to the right side of the screen\" do\ndomain 'com.apple.dock'\n3:   key 'orientation'\nstring 'right'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-dock_position_the_dock_on_the_right_side.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Move the Dock to the right side of the screen\" do\n      2:   domain 'com.apple.dock'\n>>>   3:   key 'orientation'\n      4:   string 'right'\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-wiki-recipes-default.rb", "content": "database_user \"wiki-user\"", "line": 43, "detection_span": [38, 48], "with_context": "\nfpm_min_spare_servers 10\nfpm_max_spare_servers 20\nfpm_prometheus_port 9253\n\ndatabase_name \"wiki\"\n43:   database_user \"wiki-user\"\ndatabase_password passwords[\"database\"]\n\nadmin_password passwords[\"admin\"]\n\nlogo \"/osm_logo_wiki.png\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-wiki-recipes-default.rb\n# Target line: 43\n\n     38:   fpm_min_spare_servers 10\n     39:   fpm_max_spare_servers 20\n     40:   fpm_prometheus_port 9253\n     41: \n     42:   database_name \"wiki\"\n>>>  43:   database_user \"wiki-user\"\n     44:   database_password passwords[\"database\"]\n     45: \n     46:   admin_password passwords[\"admin\"]\n     47: \n     48:   logo \"/osm_logo_wiki.png\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-apt-recipes-default.rb", "content": "key \"6005210E23B3D3B4\"", "line": 104, "detection_span": [99, 109], "with_context": "\napt_repository \"hwraid\" do\n100:   action repository_actions[\"hwraid\"]\n101:   uri \"https://hwraid.le-vert.net/ubuntu\"\n102:   distribution \"precise\"\n103:   components [\"main\"]\n104:   key \"6005210E23B3D3B4\"\n105: end\n106:\n107: apt_repository \"nginx\" do\n108:   action repository_actions[\"nginx\"]\n109:   arch \"amd64\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-apt-recipes-default.rb\n# Target line: 104\n\n     99: apt_repository \"hwraid\" do\n    100:   action repository_actions[\"hwraid\"]\n    101:   uri \"https://hwraid.le-vert.net/ubuntu\"\n    102:   distribution \"precise\"\n    103:   components [\"main\"]\n>>> 104:   key \"6005210E23B3D3B4\"\n    105: end\n    106: \n    107: apt_repository \"nginx\" do\n    108:   action repository_actions[\"nginx\"]\n    109:   arch \"amd64\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-warp-attributes-default.rb", "content": "default[:warp][:user] = \"vagrant\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[:warp][:user] = \"vagrant\"\ndefault[:warp][:group] = \"vagrant\"\ndefault[:warp][:pid_file] = \"/home/vagrant/twistd.pid\"\ndefault[:warp][:log_file] = \"/home/vagrant/twistd.log\"\ndefault[:warp][:version] = \"\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-warp-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[:warp][:user] = \"vagrant\"\n      2: default[:warp][:group] = \"vagrant\"\n      3: default[:warp][:pid_file] = \"/home/vagrant/twistd.pid\"\n      4: default[:warp][:log_file] = \"/home/vagrant/twistd.log\"\n      5: default[:warp][:version] = \"\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-nodejs-cookbooks-package_set-attributes-default.rb", "content": "default[:package_set][:pkgs][:sysadmin]  = \\", "line": 84, "detection_span": [79, 89], "with_context": "\n] + [\n{ :name => 'activesupport', :version => '3.1.0', },\n{ :name => 'activemodel',   :version => '3.1.0', },\n]\n\n84: default[:package_set][:pkgs][:sysadmin]  = \\\ncase node.platform\nwhen 'centos'\n%w[ dstat tree chkconfig sysstat nmap ]\nelse\n%w[ ifstat htop tree chkconfig sysstat nmap python-software-properties ]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-nodejs-cookbooks-package_set-attributes-default.rb\n# Target line: 84\n\n     79:   ] + [\n     80:     { :name => 'activesupport', :version => '3.1.0', },\n     81:     { :name => 'activemodel',   :version => '3.1.0', },\n     82:   ]\n     83: \n>>>  84: default[:package_set][:pkgs][:sysadmin]  = \\\n     85:     case node.platform\n     86:       when 'centos'\n     87:         %w[ dstat tree chkconfig sysstat nmap ]\n     88:       else\n     89:         %w[ ifstat htop tree chkconfig sysstat nmap python-software-properties ]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-database-libraries-provider_database_postgresql.rb", "content": "user = @new_resource.connection[:username] || 'postgres'", "line": 111, "detection_span": [106, 116], "with_context": "\ndef db(dbname = nil)\nclose if @db\ndbname = @new_resource.connection[:database] if @new_resource.connection[:database]\nhost = @new_resource.connection[:host]\nport = @new_resource.connection[:port] || 5432\n111:           user = @new_resource.connection[:username] || 'postgres'\nChef::Log.debug(\"#{@new_resource}: connecting to database #{dbname} on #{host}:#{port} as #{user}\")\npassword = @new_resource.connection[:password] || node[:postgresql][:password][:postgres]\n@db = ::PGconn.new(\n:host => host,\n:port => port,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-database-libraries-provider_database_postgresql.rb\n# Target line: 111\n\n    106:         def db(dbname = nil)\n    107:           close if @db\n    108:           dbname = @new_resource.connection[:database] if @new_resource.connection[:database]\n    109:           host = @new_resource.connection[:host]\n    110:           port = @new_resource.connection[:port] || 5432\n>>> 111:           user = @new_resource.connection[:username] || 'postgres'\n    112:           Chef::Log.debug(\"#{@new_resource}: connecting to database #{dbname} on #{host}:#{port} as #{user}\")\n    113:           password = @new_resource.connection[:password] || node[:postgresql][:password][:postgres]\n    114:           @db = ::PGconn.new(\n    115:             :host => host,\n    116:             :port => port,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "mindis_Keenginx-Cookbook-recipes-repo.rb", "content": "key    'RPM-GPG-KEY-Nginx'", "line": 27, "detection_span": [22, 32], "with_context": "\nwhen 'rhel', 'fedora'\ninclude_recipe 'yum::default'\n\nyum_key 'nginx' do\nurl    'http://nginx.org/keys/nginx_signing.key'\n27:     key    'RPM-GPG-KEY-Nginx'\naction :add\nend\n\nyum_repository 'nginx' do\ndescription 'Nginx.org Repository'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: mindis_Keenginx-Cookbook-recipes-repo.rb\n# Target line: 27\n\n     22: when 'rhel', 'fedora'\n     23:   include_recipe 'yum::default'\n     24: \n     25:   yum_key 'nginx' do\n     26:     url    'http://nginx.org/keys/nginx_signing.key'\n>>>  27:     key    'RPM-GPG-KEY-Nginx'\n     28:     action :add\n     29:   end\n     30: \n     31:   yum_repository 'nginx' do\n     32:     description 'Nginx.org Repository'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_hw-nginx-recipes-passenger.rb", "content": "node.default[\"nginx\"][\"passenger\"][\"root\"] = \"/usr/lib/ruby/gems/1.8/gems/passenger-3.0.12\"", "line": 29, "detection_span": [24, 34], "with_context": "\naction :install\nversion node[\"nginx\"][\"passenger\"][\"version\"]\nend\n\nnode.default[\"nginx\"][\"passenger\"][\"version\"] = \"3.0.12\"\n29: node.default[\"nginx\"][\"passenger\"][\"root\"] = \"/usr/lib/ruby/gems/1.8/gems/passenger-3.0.12\"\nnode.default[\"nginx\"][\"passenger\"][\"ruby\"] = %x{which ruby}.chomp\nnode.default[\"nginx\"][\"passenger\"][\"max_pool_size\"] = 10\n\nservice \"nginx\" do\nsupports :status => true, :restart => true, :reload => true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_hw-nginx-recipes-passenger.rb\n# Target line: 29\n\n     24:   action :install\n     25:   version node[\"nginx\"][\"passenger\"][\"version\"]\n     26: end\n     27: \n     28: node.default[\"nginx\"][\"passenger\"][\"version\"] = \"3.0.12\"\n>>>  29: node.default[\"nginx\"][\"passenger\"][\"root\"] = \"/usr/lib/ruby/gems/1.8/gems/passenger-3.0.12\"\n     30: node.default[\"nginx\"][\"passenger\"][\"ruby\"] = %x{which ruby}.chomp\n     31: node.default[\"nginx\"][\"passenger\"][\"max_pool_size\"] = 10\n     32: \n     33: service \"nginx\" do\n     34:   supports :status => true, :restart => true, :reload => true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jahumes_RailsChef-vendor-cookbooks-rails-attributes-default.rb", "content": "default[\"rails\"][\"applications_root\"] = \"/home/vagrant/Code\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default[\"rails\"][\"applications_root\"] = \"/home/vagrant/Code\"\ndefault[\"rbenv\"][\"binaries_url\"] = \"https://intercityup.com/binaries/ruby/ubuntu\"\ndefault[\"rbenv\"][\"available_binaries\"] = %w(2.0.0-p481)\n\ncase node[\"platform_family\"]\nwhen \"debian\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jahumes_RailsChef-vendor-cookbooks-rails-attributes-default.rb\n# Target line: 1\n\n>>>   1: default[\"rails\"][\"applications_root\"] = \"/home/vagrant/Code\"\n      2: default[\"rbenv\"][\"binaries_url\"] = \"https://intercityup.com/binaries/ruby/ubuntu\"\n      3: default[\"rbenv\"][\"available_binaries\"] = %w(2.0.0-p481)\n      4: \n      5: case node[\"platform_family\"]\n      6: when \"debian\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-postgresql-recipes-apt_pgdg_postgresql.rb", "content": "key 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc'", "line": 16, "detection_span": [11, 21], "with_context": "\n\napt_repository 'apt.postgresql.org' do\nuri 'http://apt.postgresql.org/pub/repos/apt'\ndistribution \"#{node['postgresql']['pgdg']['release_apt_codename']}-pgdg\"\ncomponents ['main', node['postgresql']['version']]\n16:   key 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc'\naction :add\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-postgresql-recipes-apt_pgdg_postgresql.rb\n# Target line: 16\n\n     11: \n     12: apt_repository 'apt.postgresql.org' do\n     13:   uri 'http://apt.postgresql.org/pub/repos/apt'\n     14:   distribution \"#{node['postgresql']['pgdg']['release_apt_codename']}-pgdg\"\n     15:   components ['main', node['postgresql']['version']]\n>>>  16:   key 'http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc'\n     17:   action :add\n     18: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb", "content": "default['hadoop']['hdfs_user'] = 'hdfs'", "line": 33, "detection_span": [28, 38], "with_context": "\ndefault['hadoop']['conf_dir'] = '/etc/hadoop'\ndefault['hadoop']['data_dir'] = '/var/lib/hadoop'\ndefault['hadoop']['log_dir'] = '/var/log/hadoop'\ndefault['hadoop']['pid_dir'] = '/var/run/hadoop'\ndefault['hadoop']['group'] = 'hadoop'\n33: default['hadoop']['hdfs_user'] = 'hdfs'\ndefault['hadoop']['yarn_user'] = 'yarn'\n\n# Per service settings\ndefault['hadoop']['hdfs-site']\\\n['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-hadoop-attributes-default.rb\n# Target line: 33\n\n     28: default['hadoop']['conf_dir'] = '/etc/hadoop'\n     29: default['hadoop']['data_dir'] = '/var/lib/hadoop'\n     30: default['hadoop']['log_dir'] = '/var/log/hadoop'\n     31: default['hadoop']['pid_dir'] = '/var/run/hadoop'\n     32: default['hadoop']['group'] = 'hadoop'\n>>>  33: default['hadoop']['hdfs_user'] = 'hdfs'\n     34: default['hadoop']['yarn_user'] = 'yarn'\n     35: \n     36: # Per service settings\n     37: default['hadoop']['hdfs-site']\\\n     38:        ['dfs.namenode.datanode.registration.ip-hostname-check'] = 'false'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-client.rb", "content": "@config.ssl_key = opts.key?(:ssl_key) ? opts[:ssl_key] : nil", "line": 65, "detection_span": [60, 70], "with_context": "\n@config.password = opts[:password] || nil\n@config.ca_file = opts.key?(:ca_file) ? opts[:ca_file] : nil\n# Provide a OpenSSL X509 cert here and not the path. See README\n@config.ssl_cert = opts.key?(:ssl_cert) ? opts[:ssl_cert] : nil\n# Provide the key (content) and not just the filename here.\n65:       @config.ssl_key = opts.key?(:ssl_key) ? opts[:ssl_key] : nil\nyield @config if block_given?\nend\n# rubocop:enable CyclomaticComplexity\n\n# Returns the etcd api version that will be used for across API methods", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-etcd-files-default-vendor-gems-etcd-0.3.0-lib-etcd-client.rb\n# Target line: 65\n\n     60:       @config.password = opts[:password] || nil\n     61:       @config.ca_file = opts.key?(:ca_file) ? opts[:ca_file] : nil\n     62:       # Provide a OpenSSL X509 cert here and not the path. See README\n     63:       @config.ssl_cert = opts.key?(:ssl_cert) ? opts[:ssl_cert] : nil\n     64:       # Provide the key (content) and not just the filename here.\n>>>  65:       @config.ssl_key = opts.key?(:ssl_key) ? opts[:ssl_key] : nil\n     66:       yield @config if block_given?\n     67:     end\n     68:     # rubocop:enable CyclomaticComplexity\n     69: \n     70:     # Returns the etcd api version that will be used for across API methods\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_config.rb", "content": "hive_site_vars[:stats_sql_password] = \\", "line": 73, "detection_span": [68, 78], "with_context": "\nhive_password\nelse\n\"\"\nend\n\n73: hive_site_vars[:stats_sql_password] = \\\nif node.run_list.expand(node.chef_environment).recipes.include?(\"bcpc-hadoop::hive_hcatalog\") then\nstats_password\nelse\n\"\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pu239ppy_chef-bach-code-bcpc-hadoop-recipes-hive_config.rb\n# Target line: 73\n\n     68:   hive_password\n     69: else\n     70:   \"\"\n     71: end\n     72: \n>>>  73: hive_site_vars[:stats_sql_password] = \\\n     74: if node.run_list.expand(node.chef_environment).recipes.include?(\"bcpc-hadoop::hive_hcatalog\") then\n     75:   stats_password\n     76: else\n     77:   \"\"\n     78: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-hbase_master.rb", "content": "user \"hbase\"", "line": 82, "detection_span": [77, 87], "with_context": "\n\nbash \"create_phoenix_trace_table\" do\ncode <<-EOH\nHBASE_CONF_PATH=/etc/hadoop/conf:/etc/hbase/conf /usr/hdp/current/phoenix-client/bin/sqlline.py \"#{node[:bcpc][:hadoop][:zookeeper][:servers].map{ |s| float_host(s[:hostname])}.join(\",\")}:#{node[:bcpc][:hadoop][:zookeeper][:port]}:/hbase\" /tmp/trace_table.sql\nEOH\n82:     user \"hbase\"\nend\n\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-hadoop-recipes-hbase_master.rb\n# Target line: 82\n\n     77: \n     78:   bash \"create_phoenix_trace_table\" do\n     79:     code <<-EOH\n     80:     HBASE_CONF_PATH=/etc/hadoop/conf:/etc/hbase/conf /usr/hdp/current/phoenix-client/bin/sqlline.py \"#{node[:bcpc][:hadoop][:zookeeper][:servers].map{ |s| float_host(s[:hostname])}.join(\",\")}:#{node[:bcpc][:hadoop][:zookeeper][:port]}:/hbase\" /tmp/trace_table.sql\n     81:     EOH\n>>>  82:     user \"hbase\"\n     83:   end\n     84: \n     85: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-ark-recipes-test.rb", "content": "prefix_root '/usr/local'", "line": 24, "detection_span": [19, 29], "with_context": "\n\nark 'foo' do\nurl 'https://github.com/opscode-cookbooks/ark/raw/master/files/default/foo.tar.gz'\nchecksum '5996e676f17457c823d86f1605eaa44ca8a81e70d6a0e5f8e45b51e62e0c52e8'\nversion '2'\n24:   prefix_root '/usr/local'\nowner 'foobarbaz'\ngroup 'foobarbaz'\nhas_binaries ['bin/do_foo', 'bin/do_more_foo']\naction :install\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-ark-recipes-test.rb\n# Target line: 24\n\n     19: \n     20: ark 'foo' do\n     21:   url 'https://github.com/opscode-cookbooks/ark/raw/master/files/default/foo.tar.gz'\n     22:   checksum '5996e676f17457c823d86f1605eaa44ca8a81e70d6a0e5f8e45b51e62e0c52e8'\n     23:   version '2'\n>>>  24:   prefix_root '/usr/local'\n     25:   owner 'foobarbaz'\n     26:   group 'foobarbaz'\n     27:   has_binaries ['bin/do_foo', 'bin/do_more_foo']\n     28:   action :install\n     29: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "osuosl-cookbooks_rdiff-backup-attributes-client.rb", "content": "node.default['rdiff-backup']['client']['user'] = 'rdiff-backup-client'", "line": 4, "detection_span": [1, 9], "with_context": "\n# Default attributes.\nnode.default['rdiff-backup']['client']['ssh-port'] = '22'\nnode.default['rdiff-backup']['client']['ssh_keys'] = []\n4: node.default['rdiff-backup']['client']['user'] = 'rdiff-backup-client'\nnode.default['rdiff-backup']['client']['sudo'] = true\nnode.default['rdiff-backup']['client']['jobs'] = {}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: osuosl-cookbooks_rdiff-backup-attributes-client.rb\n# Target line: 4\n\n      1: # Default attributes.\n      2: node.default['rdiff-backup']['client']['ssh-port'] = '22'\n      3: node.default['rdiff-backup']['client']['ssh_keys'] = []\n>>>   4: node.default['rdiff-backup']['client']['user'] = 'rdiff-backup-client'\n      5: node.default['rdiff-backup']['client']['sudo'] = true\n      6: node.default['rdiff-backup']['client']['jobs'] = {}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-preflight_checks.rb", "content": "user = 'chef_server_conn_test'", "line": 78, "detection_span": [73, 83], "with_context": "\noptions.merge! opts\n\nport = cs_pg_attr.has_key?('port') ? cs_pg_attr['port'] : node_pg_attr['port']\nhost = cs_pg_attr['vip']\nif type == :invalid_user\n78:       user = 'chef_server_conn_test'\npassword = 'invalid'\nelse\nuser = cs_pg_attr['db_superuser']\npassword = cs_pg_attr['db_superuser_password']\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-libraries-preflight_checks.rb\n# Target line: 78\n\n     73:     options.merge! opts\n     74: \n     75:     port = cs_pg_attr.has_key?('port') ? cs_pg_attr['port'] : node_pg_attr['port']\n     76:     host = cs_pg_attr['vip']\n     77:     if type == :invalid_user\n>>>  78:       user = 'chef_server_conn_test'\n     79:       password = 'invalid'\n     80:     else\n     81:       user = cs_pg_attr['db_superuser']\n     82:       password = cs_pg_attr['db_superuser_password']\n     83:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~target_ssl_proxy.rb", "content": "private_key '-----BEGIN EC PRIVATE KEY-----", "line": 123, "detection_span": [118, 128], "with_context": "\n118: BBYEFKIQC3A2SDpxcdfn0YLKineDNq/BMB8GA1UdIwQYMBaAFKIQC3A2SDpxcdfn\n119: 0YLKineDNq/BMAwGA1UdEwQFMAMBAf8wCgYIKoZIzj0EAwIDSQAwRgIhALs4vy+O\n120: M3jcqgA4fSW/oKw6UJxp+M6a+nGMX+UJR3YgAiEAvvl39QRVAiv84hdoCuyON0lJ\n121: zqGNhIPGq2ULqXKK8BY=\n122: -----END CERTIFICATE-----'\n123:   private_key '-----BEGIN EC PRIVATE KEY-----\n124: MHcCAQEEIObtRo8tkUqoMjeHhsOh2ouPpXCgBcP+EDxZCB/tws15oAoGCCqGSM49\n125: AwEHoUQDQgAEHGzpcRJ4XzfBJCCPMQeXQpTXwlblimODQCuQ4mzkzTv0dXyB750f\n126: OGN02HtkpBOZzzvUARTR10JQoSe2/5PIwQ==\n127: -----END EC PRIVATE KEY-----'\n128: end", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~target_ssl_proxy.rb\n# Target line: 123\n\n    118: BBYEFKIQC3A2SDpxcdfn0YLKineDNq/BMB8GA1UdIwQYMBaAFKIQC3A2SDpxcdfn\n    119: 0YLKineDNq/BMAwGA1UdEwQFMAMBAf8wCgYIKoZIzj0EAwIDSQAwRgIhALs4vy+O\n    120: M3jcqgA4fSW/oKw6UJxp+M6a+nGMX+UJR3YgAiEAvvl39QRVAiv84hdoCuyON0lJ\n    121: zqGNhIPGq2ULqXKK8BY=\n    122: -----END CERTIFICATE-----'\n>>> 123:   private_key '-----BEGIN EC PRIVATE KEY-----\n    124: MHcCAQEEIObtRo8tkUqoMjeHhsOh2ouPpXCgBcP+EDxZCB/tws15oAoGCCqGSM49\n    125: AwEHoUQDQgAEHGzpcRJ4XzfBJCCPMQeXQpTXwlblimODQCuQ4mzkzTv0dXyB750f\n    126: OGN02HtkpBOZzzvUARTR10JQoSe2/5PIwQ==\n    127: -----END EC PRIVATE KEY-----'\n    128: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-webplayer-attributes-default.rb", "content": "default[:webplayer][:user] = \"root\"", "line": 12, "detection_span": [7, 17], "with_context": "\n# Number of days before pulling a new copy from files.ihrdev.com\ndefault[:webplayer][:geo_freshness] = 60\n\ndefault[:webplayer][:packages] = %w{ libxslt-devel python27-debuginfo python27-libs python27-tools python27-devel python27 python27-test }\n\n12: default[:webplayer][:user] = \"root\"\ncase node[:platform]\nwhen \"debian\"\ndefault[:webplayer][:group] = \"nogroup\"\nwhen \"centos\"\ndefault[:webplayer][:group] = \"nobody\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-webplayer-attributes-default.rb\n# Target line: 12\n\n      7: # Number of days before pulling a new copy from files.ihrdev.com\n      8: default[:webplayer][:geo_freshness] = 60\n      9: \n     10: default[:webplayer][:packages] = %w{ libxslt-devel python27-debuginfo python27-libs python27-tools python27-devel python27 python27-test }\n     11: \n>>>  12: default[:webplayer][:user] = \"root\"\n     13: case node[:platform]\n     14: when \"debian\"\n     15:   default[:webplayer][:group] = \"nogroup\"\n     16: when \"centos\"\n     17:   default[:webplayer][:group] = \"nobody\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-nagios-api-attributes-default.rb", "content": "default[:nagiosapi][:user] = \"nobody\"", "line": 8, "detection_span": [3, 13], "with_context": "\ndefault[:nagiosapi][:repo] = \"git@github.com:xb95/nagios-api.git\"\ndefault[:nagiosapi][:rev] = \"HEAD\"\n\ndefault[:nagiosapi][:path] = \"/data/www/nagios-api\"\n\n8: default[:nagiosapi][:user] = \"nobody\"\ncase node[:platform_family]\nwhen \"rhel\"\ndefault[:nagiosapi][:group] = \"nobody\"\nwhen \"debian\"\ndefault[:nagiosapi][:group] = \"nogroup\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-nagios-api-attributes-default.rb\n# Target line: 8\n\n      3: default[:nagiosapi][:repo] = \"git@github.com:xb95/nagios-api.git\"\n      4: default[:nagiosapi][:rev] = \"HEAD\"\n      5: \n      6: default[:nagiosapi][:path] = \"/data/www/nagios-api\"\n      7: \n>>>   8: default[:nagiosapi][:user] = \"nobody\"\n      9: case node[:platform_family]\n     10: when \"rhel\"\n     11:   default[:nagiosapi][:group] = \"nobody\"\n     12: when \"debian\"\n     13:   default[:nagiosapi][:group] = \"nogroup\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "FriendsOfCake_vagrant-chef-cookbooks-php-recipes-apt_repository.rb", "content": "key \"E5267A6C\"", "line": 2, "detection_span": [1, 7], "with_context": "\napt_repository \"php\" do\n2:   key \"E5267A6C\"\nuri \"ppa:ondrej/php\"\ndistribution node[\"lsb\"][\"codename\"]\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: FriendsOfCake_vagrant-chef-cookbooks-php-recipes-apt_repository.rb\n# Target line: 2\n\n      1: apt_repository \"php\" do\n>>>   2:   key \"E5267A6C\"\n      3:   uri \"ppa:ondrej/php\"\n      4:   distribution node[\"lsb\"][\"codename\"]\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "laradji_zabbix-recipes-database.rb", "content": "root_username       = 'postgres'", "line": 37, "detection_span": [32, 42], "with_context": "\nprovider = Chef::Provider::ZabbixDatabaseMySql\nwhen 'postgres'\nunless node['postgresql']['password']['postgres']\nnode.normal['postgresql']['password']['postgres'] = secure_password\nend\n37:   root_username       = 'postgres'\nroot_password       = node['postgresql']['password']['postgres']\nprovider = Chef::Provider::ZabbixDatabasePostgres\nwhen 'oracle'\n# No oracle database installation or configuration currently done\n# This recipe expects a fully configured Oracle DB with a Zabbix", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: laradji_zabbix-recipes-database.rb\n# Target line: 37\n\n     32:   provider = Chef::Provider::ZabbixDatabaseMySql\n     33: when 'postgres'\n     34:   unless node['postgresql']['password']['postgres']\n     35:     node.normal['postgresql']['password']['postgres'] = secure_password\n     36:   end\n>>>  37:   root_username       = 'postgres'\n     38:   root_password       = node['postgresql']['password']['postgres']\n     39:   provider = Chef::Provider::ZabbixDatabasePostgres\n     40: when 'oracle'\n     41:   # No oracle database installation or configuration currently done\n     42:   # This recipe expects a fully configured Oracle DB with a Zabbix\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-enable_full_keyboard_access_for_all_controls.rb", "content": "key 'AppleKeyboardUIMode'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Enable full keyboard access for all controls\" do\ndomain 'NSGlobalDomain'\n3:   key 'AppleKeyboardUIMode'\ninteger 3\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-enable_full_keyboard_access_for_all_controls.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Enable full keyboard access for all controls\" do\n      2:   domain 'NSGlobalDomain'\n>>>   3:   key 'AppleKeyboardUIMode'\n      4:   integer 3\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb", "content": "'superuser' => 'pivotal',", "line": 30, "detection_span": [25, 35], "with_context": "\nend\n\napp_settings = {\n'chef' => {\n'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n30:     'superuser' => 'pivotal',\n'key_path' => '/etc/opscode/webui_priv.pem'\n},\n'doorkeeper' => {\n'administrators' => node['private_chef']['oc_id']['administrators'] || []\n},", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: sidxz_chef-server-devl-omnibus-files-private-chef-cookbooks-private-chef-recipes-oc_id.rb\n# Target line: 30\n\n     25: end\n     26: \n     27: app_settings = {\n     28:   'chef' => {\n     29:     'endpoint' => \"https://#{node['private_chef']['lb_internal']['vip']}\",\n>>>  30:     'superuser' => 'pivotal',\n     31:     'key_path' => '/etc/opscode/webui_priv.pem'\n     32:   },\n     33:   'doorkeeper' => {\n     34:     'administrators' => node['private_chef']['oc_id']['administrators'] || []\n     35:   },\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "AYCHIT_Asf-chef-cookbooks-user-attributes-default.rb", "content": "default['user']['home_root']      = \"/home\"", "line": 24, "detection_span": [19, 29], "with_context": "\n# limitations under the License.\n#\n\ncase platform\nwhen 'debian','ubuntu','redhat','centos','amazon','scientific','fedora','freebsd','suse'\n24:   default['user']['home_root']      = \"/home\"\ndefault['user']['default_shell']  = \"/bin/bash\"\nwhen 'openbsd'\ndefault['user']['home_root']      = \"/home\"\ndefault['user']['default_shell']  = \"/bin/ksh\"\nwhen 'mac_os_x', 'mac_os_x_server'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: AYCHIT_Asf-chef-cookbooks-user-attributes-default.rb\n# Target line: 24\n\n     19: # limitations under the License.\n     20: #\n     21: \n     22: case platform\n     23: when 'debian','ubuntu','redhat','centos','amazon','scientific','fedora','freebsd','suse'\n>>>  24:   default['user']['home_root']      = \"/home\"\n     25:   default['user']['default_shell']  = \"/bin/bash\"\n     26: when 'openbsd'\n     27:   default['user']['home_root']      = \"/home\"\n     28:   default['user']['default_shell']  = \"/bin/ksh\"\n     29: when 'mac_os_x', 'mac_os_x_server'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_glance-recipes-replicator.rb", "content": "user \"glance\"", "line": 30, "detection_span": [25, 35], "with_context": "\nexecute \"enable glance login\" do\ncommand \"usermod -s /bin/sh glance\"\nend\n\ndsh_group \"glance\" do\n30:     user \"glance\"\nadmin_user \"glance\"\nend\n\npackage \"glance-image-sync\" do\naction node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_glance-recipes-replicator.rb\n# Target line: 30\n\n     25:   execute \"enable glance login\" do\n     26:     command \"usermod -s /bin/sh glance\"\n     27:   end\n     28:  \n     29:   dsh_group \"glance\" do\n>>>  30:     user \"glance\"\n     31:     admin_user \"glance\"\n     32:   end\n     33: \n     34:   package \"glance-image-sync\" do\n     35:     action node[\"osops\"][\"do_package_upgrades\"] == true ? :upgrade : :install\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Soluciones_ey-cloud-recipes-cookbooks-collectd-libraries-collectd.rb", "content": "arg[key] = case value", "line": 76, "detection_span": [71, 81], "with_context": "\nif arg.is_a?(Hash)\nraise ArgumentError unless arg.key?(:warning) && arg.key?(:failure)\n\narg.each_pair do |key, value|\nif value.is_a?(String)\n76:               arg[key] = case value\nwhen /^([\\d\\.]+)kb/i; $1.to_f * 1024\nwhen /^([\\d\\.]+)mb/i; $1.to_f * 1048576\nwhen /^([\\d\\.]+)gb/i; $1.to_f * 1073741824\nelse value\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-collectd-libraries-collectd.rb\n# Target line: 76\n\n     71:         if arg.is_a?(Hash)\n     72:           raise ArgumentError unless arg.key?(:warning) && arg.key?(:failure)\n     73:           \n     74:           arg.each_pair do |key, value|\n     75:             if value.is_a?(String)\n>>>  76:               arg[key] = case value\n     77:                 when /^([\\d\\.]+)kb/i; $1.to_f * 1024\n     78:                 when /^([\\d\\.]+)mb/i; $1.to_f * 1048576\n     79:                 when /^([\\d\\.]+)gb/i; $1.to_f * 1073741824 \n     80:                 else value\n     81:               end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-rabbitmq-attributes-default.rb", "content": "default['rabbitmq']['default_user'] = 'guest'", "line": 38, "detection_span": [33, 43], "with_context": "\ndefault['rabbitmq']['config'] = \"/etc/rabbitmq/rabbitmq\"\ndefault['rabbitmq']['erlang_cookie_path'] = '/var/lib/rabbitmq/.erlang.cookie'\ndefault['rabbitmq']['dir'] = '/etc/rabbitmq'\n\n# rabbitmq.config defaults\n38: default['rabbitmq']['default_user'] = 'guest'\ndefault['rabbitmq']['default_pass'] = 'guest'\n\n#clustering\ndefault['rabbitmq']['cluster'] = false\ndefault['rabbitmq']['cluster_disk_nodes'] = []", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-rabbitmq-attributes-default.rb\n# Target line: 38\n\n     33: default['rabbitmq']['config'] = \"/etc/rabbitmq/rabbitmq\"\n     34: default['rabbitmq']['erlang_cookie_path'] = '/var/lib/rabbitmq/.erlang.cookie'\n     35: default['rabbitmq']['dir'] = '/etc/rabbitmq'\n     36: \n     37: # rabbitmq.config defaults\n>>>  38: default['rabbitmq']['default_user'] = 'guest'\n     39: default['rabbitmq']['default_pass'] = 'guest'\n     40: \n     41: #clustering\n     42: default['rabbitmq']['cluster'] = false\n     43: default['rabbitmq']['cluster_disk_nodes'] = []\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-splunk_handler-attributes-default.rb", "content": "default['chef_client']['handler']['splunk']['password'] = nil", "line": 13, "detection_span": [8, 18], "with_context": "\n# License:: Apache License 2.0\n#\n\n\ndefault['chef_client']['handler']['splunk']['username'] = nil\n13: default['chef_client']['handler']['splunk']['password'] = nil\ndefault['chef_client']['handler']['splunk']['host'] = nil\ndefault['chef_client']['handler']['splunk']['port'] = '8089'\ndefault['chef_client']['handler']['splunk']['index'] = 'main'\ndefault['chef_client']['handler']['splunk']['scheme'] = 'https'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-splunk_handler-attributes-default.rb\n# Target line: 13\n\n      8: # License:: Apache License 2.0\n      9: #\n     10: \n     11: \n     12: default['chef_client']['handler']['splunk']['username'] = nil\n>>>  13: default['chef_client']['handler']['splunk']['password'] = nil\n     14: default['chef_client']['handler']['splunk']['host'] = nil\n     15: default['chef_client']['handler']['splunk']['port'] = '8089'\n     16: default['chef_client']['handler']['splunk']['index'] = 'main'\n     17: default['chef_client']['handler']['splunk']['scheme'] = 'https'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_magentostack-recipes-magento_install.rb", "content": "svn_username MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_username')", "line": 150, "detection_span": [145, 155], "with_context": "\n145:   # Run the checkout into /var/www/html/magento\n146:   magento_dir = \"#{node['apache']['docroot_dir']}/magento\"\n147:   subversion magento_dir do\nrepository MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_repository')\nrevision MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_revision')\n150:     svn_username MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_username')\nsvn_password MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_password')\nsvn_arguments MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_arguments')\nsvn_info_args MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_info_args')\ntimeout MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_timeout')\naction :sync", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_magentostack-recipes-magento_install.rb\n# Target line: 150\n\n    145:   # Run the checkout into /var/www/html/magento\n    146:   magento_dir = \"#{node['apache']['docroot_dir']}/magento\"\n    147:   subversion magento_dir do\n    148:     repository MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_repository')\n    149:     revision MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_revision')\n>>> 150:     svn_username MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_username')\n    151:     svn_password MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_password')\n    152:     svn_arguments MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_arguments')\n    153:     svn_info_args MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_info_args')\n    154:     timeout MagentostackUtil.get_runstate_or_attr(node, 'magentostack', 'svn_timeout')\n    155:     action :sync\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "DrRayWang_Chef-Base-cookbooks-bcpc-recipes-cobalt.rb", "content": "key \"gridcentric.key\"", "line": 42, "detection_span": [37, 47], "with_context": "\n\napt_repository \"vms\" do\nuri node['bcpc']['repos']['gridcentric'] % [node['bcpc']['vms_key'], 'vms']\ndistribution \"gridcentric\"\ncomponents [\"multiverse\"]\n42:         key \"gridcentric.key\"\nend\n\npackage \"cobalt-novaclient\" do\naction :upgrade\noptions \"-o APT::Install-Recommends=0 -o Dpkg::Options::='--force-confnew'\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: DrRayWang_Chef-Base-cookbooks-bcpc-recipes-cobalt.rb\n# Target line: 42\n\n     37: \n     38:     apt_repository \"vms\" do\n     39:         uri node['bcpc']['repos']['gridcentric'] % [node['bcpc']['vms_key'], 'vms']\n     40:         distribution \"gridcentric\"\n     41:         components [\"multiverse\"]\n>>>  42:         key \"gridcentric.key\"\n     43:     end\n     44: \n     45:     package \"cobalt-novaclient\" do\n     46:         action :upgrade\n     47:         options \"-o APT::Install-Recommends=0 -o Dpkg::Options::='--force-confnew'\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-imos_devel-attributes-default.rb", "content": "default['imos_devel']['user']                          = \"vagrant\"", "line": 18, "detection_span": [13, 23], "with_context": "\n\n# Base directory for sources\ndefault['imos_devel']['src']                           = \"/vagrant/src\"\n\n# User and home directory to use for development\n18: default['imos_devel']['user']                          = \"vagrant\"\ndefault['imos_devel']['homedir']                       = \"/home/vagrant\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-imos_devel-attributes-default.rb\n# Target line: 18\n\n     13: \n     14: # Base directory for sources\n     15: default['imos_devel']['src']                           = \"/vagrant/src\"\n     16: \n     17: # User and home directory to use for development\n>>>  18: default['imos_devel']['user']                          = \"vagrant\"\n     19: default['imos_devel']['homedir']                       = \"/home/vagrant\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['password'] = nil #  /.*/", "line": 65, "detection_span": [60, 70], "with_context": "\ndefault['yum']['main']['metadata_expire'] = nil # /^\\d+$/\ndefault['yum']['main']['mirrorlist_expire'] = nil # /^\\d+$/\ndefault['yum']['main']['multilib_policy'] = nil # %w{ all best }\ndefault['yum']['main']['obsoletes'] = nil  # [TrueClass, FalseClass]\ndefault['yum']['main']['overwrite_groups'] = nil # [TrueClass, FalseClass]\n65: default['yum']['main']['password'] = nil #  /.*/\ndefault['yum']['main']['path'] = '/etc/yum.conf' #  /.*/\ndefault['yum']['main']['persistdir'] = nil # /.*/\ndefault['yum']['main']['pluginconfpath'] = nil #  /.*/\ndefault['yum']['main']['pluginpath'] = nil #  /.*/\ndefault['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-yum-attributes-main.rb\n# Target line: 65\n\n     60: default['yum']['main']['metadata_expire'] = nil # /^\\d+$/\n     61: default['yum']['main']['mirrorlist_expire'] = nil # /^\\d+$/\n     62: default['yum']['main']['multilib_policy'] = nil # %w{ all best }\n     63: default['yum']['main']['obsoletes'] = nil  # [TrueClass, FalseClass]\n     64: default['yum']['main']['overwrite_groups'] = nil # [TrueClass, FalseClass]\n>>>  65: default['yum']['main']['password'] = nil #  /.*/\n     66: default['yum']['main']['path'] = '/etc/yum.conf' #  /.*/\n     67: default['yum']['main']['persistdir'] = nil # /.*/\n     68: default['yum']['main']['pluginconfpath'] = nil #  /.*/\n     69: default['yum']['main']['pluginpath'] = nil #  /.*/\n     70: default['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-etl_jobs-attributes-default.rb", "content": "default[:enrichment][:log][:sudo_user] = \"amqp-consumer\"", "line": 6, "detection_span": [1, 11], "with_context": "\ndefault[:enrichment][:appdir] = \"/data/apps/enrichment\"\ndefault[:enrichment][:log][:source] = \"/data/log/enrichment-consumer/\"\ndefault[:enrichment][:log][:dest] = \"iad-ss-nfs101-v600.ihr:/data/exports/files.ihrdev.com/Enrichment\"\ndefault[:enrichment][:log][:retention] = \"14\" # days\ndefault[:enrichment][:log][:user] = \"ihr-deployer\"\n6: default[:enrichment][:log][:sudo_user] = \"amqp-consumer\"\ndefault[:playlog][:deploy_path] = \"/data/jobs/playlog\"\ndefault[:playlog][:repo] = \"git@github.com:iheartradio/playlog.git\"\ndefault[:playlog][:reference] = \"0246f36d0c9c2a47d4fdd97942b0c4ebbb24b21d\"\ndefault[:db_sync_tools][:deploy_path] = \"/data/jobs/db-sync-tools\"\ndefault[:db_sync_tools][:repo] = \"git@github.com:iheartradio/amp-tools\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-etl_jobs-attributes-default.rb\n# Target line: 6\n\n      1: default[:enrichment][:appdir] = \"/data/apps/enrichment\"\n      2: default[:enrichment][:log][:source] = \"/data/log/enrichment-consumer/\"\n      3: default[:enrichment][:log][:dest] = \"iad-ss-nfs101-v600.ihr:/data/exports/files.ihrdev.com/Enrichment\"\n      4: default[:enrichment][:log][:retention] = \"14\" # days\n      5: default[:enrichment][:log][:user] = \"ihr-deployer\"\n>>>   6: default[:enrichment][:log][:sudo_user] = \"amqp-consumer\"\n      7: default[:playlog][:deploy_path] = \"/data/jobs/playlog\"\n      8: default[:playlog][:repo] = \"git@github.com:iheartradio/playlog.git\"\n      9: default[:playlog][:reference] = \"0246f36d0c9c2a47d4fdd97942b0c4ebbb24b21d\"\n     10: default[:db_sync_tools][:deploy_path] = \"/data/jobs/db-sync-tools\"\n     11: default[:db_sync_tools][:repo] = \"git@github.com:iheartradio/amp-tools\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-mysql-attributes-server.rb", "content": "default['mysql']['tunable']['key_buffer']           = \"256M\"", "line": 41, "detection_span": [36, 46], "with_context": "\ndefault['mysql']['ebs_vol_dev'] = \"/dev/sdi\"\ndefault['mysql']['ebs_vol_size'] = 50\nend\n\ndefault['mysql']['tunable']['back_log']             = \"128\"\n41: default['mysql']['tunable']['key_buffer']           = \"256M\"\ndefault['mysql']['tunable']['max_allowed_packet']   = \"16M\"\ndefault['mysql']['tunable']['max_connections']      = \"800\"\ndefault['mysql']['tunable']['max_heap_table_size']  = \"32M\"\ndefault['mysql']['tunable']['myisam_recover']       = \"BACKUP\"\ndefault['mysql']['tunable']['net_read_timeout']     = \"30\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: eaton_vagrant-chef-dlamp-cookbooks-site-cookbooks-mysql-attributes-server.rb\n# Target line: 41\n\n     36:   default['mysql']['ebs_vol_dev'] = \"/dev/sdi\"\n     37:   default['mysql']['ebs_vol_size'] = 50\n     38: end\n     39: \n     40: default['mysql']['tunable']['back_log']             = \"128\"\n>>>  41: default['mysql']['tunable']['key_buffer']           = \"256M\"\n     42: default['mysql']['tunable']['max_allowed_packet']   = \"16M\"\n     43: default['mysql']['tunable']['max_connections']      = \"800\"\n     44: default['mysql']['tunable']['max_heap_table_size']  = \"32M\"\n     45: default['mysql']['tunable']['myisam_recover']       = \"BACKUP\"\n     46: default['mysql']['tunable']['net_read_timeout']     = \"30\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_swift-recipes-storage-common.rb", "content": "user \"swift\"", "line": 44, "detection_span": [39, 49], "with_context": "\naction :create\nmode \"0700\"\nend\n\ndsh_group \"swift-storage\" do\n44:   user \"swift\"\nnetwork \"swift\"\nnotifies :create, \"template[/etc/sudoers.d/swift]\", :immediately\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_swift-recipes-storage-common.rb\n# Target line: 44\n\n     39:   action :create\n     40:   mode \"0700\"\n     41: end\n     42: \n     43: dsh_group \"swift-storage\" do\n>>>  44:   user \"swift\"\n     45:   network \"swift\"\n     46:   notifies :create, \"template[/etc/sudoers.d/swift]\", :immediately\n     47: end\n     48: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-hbase-cookbooks-statsd-attributes-default.rb", "content": "default[:statsd][:user]            = \"statsd\"", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault[:statsd][:home_dir]          = \"/usr/local/share/statsd\"\ndefault[:statsd][:conf_dir]          = \"/etc/statsd\"\ndefault[:statsd][:log_dir]           = \"/var/log/statsd\"\ndefault[:statsd][:pid_dir]           = \"/var/run/statsd\"\n\n11: default[:statsd][:user]            = \"statsd\"\ndefault[:users ]['statsd' ][:uid]  = 310\ndefault[:groups]['statsd' ][:gid]  = 310\n\ndefault[:statsd][:run_state]   = :start\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-hbase-cookbooks-statsd-attributes-default.rb\n# Target line: 11\n\n      6: default[:statsd][:home_dir]          = \"/usr/local/share/statsd\"\n      7: default[:statsd][:conf_dir]          = \"/etc/statsd\"\n      8: default[:statsd][:log_dir]           = \"/var/log/statsd\"\n      9: default[:statsd][:pid_dir]           = \"/var/run/statsd\"\n     10: \n>>>  11: default[:statsd][:user]            = \"statsd\"\n     12: default[:users ]['statsd' ][:uid]  = 310\n     13: default[:groups]['statsd' ][:gid]  = 310\n     14: \n     15: default[:statsd][:run_state]   = :start\n     16: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb", "content": "user 'dd-agent'", "line": 37, "detection_span": [32, 42], "with_context": "\n\"/usr/bin/find #{instance['directory']}/#{queue} -type f\"\nend\nend\n\nsudo 'dd-agent-find-postfix' do\n37:   user 'dd-agent'\nnopasswd true\ncommands postfix_commands.flatten.uniq\nonly_if { postfix_instances.any? }\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb\n# Target line: 37\n\n     32:     \"/usr/bin/find #{instance['directory']}/#{queue} -type f\"\n     33:   end\n     34: end\n     35: \n     36: sudo 'dd-agent-find-postfix' do\n>>>  37:   user 'dd-agent'\n     38:   nopasswd true\n     39:   commands postfix_commands.flatten.uniq\n     40:   only_if { postfix_instances.any? }\n     41: end\n     42: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-postgresql-resources-user.rb", "content": "superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"", "line": 36, "detection_span": [31, 41], "with_context": "\nproperty :createrole, :kind_of => [TrueClass, FalseClass], :default => false\nproperty :replication, :kind_of => [TrueClass, FalseClass], :default => false\n\naction :create do\npassword = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\n36:   superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\ncreatedb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\ncreaterole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\nreplication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n\nif !cluster.users.include?(new_resource.user)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-postgresql-resources-user.rb\n# Target line: 36\n\n     31: property :createrole, :kind_of => [TrueClass, FalseClass], :default => false\n     32: property :replication, :kind_of => [TrueClass, FalseClass], :default => false\n     33: \n     34: action :create do\n     35:   password = new_resource.password ? \"ENCRYPTED PASSWORD '#{new_resource.password.shellescape}'\" : \"\"\n>>>  36:   superuser = new_resource.superuser ? \"SUPERUSER\" : \"NOSUPERUSER\"\n     37:   createdb = new_resource.createdb ? \"CREATEDB\" : \"NOCREATEDB\"\n     38:   createrole = new_resource.createrole ? \"CREATEROLE\" : \"NOCREATEROLE\"\n     39:   replication = new_resource.replication ? \"REPLICATION\" : \"NOREPLICATION\"\n     40: \n     41:   if !cluster.users.include?(new_resource.user)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-mysql-recipes-default.rb", "content": "key \"CD2EFD2A\"", "line": 6, "detection_span": [1, 11], "with_context": "\n\nif (node.mysql.use_percona || node.mysql.add_percona_repo) && node.apt.master_chef_add_apt_repo\n\nadd_apt_repository \"percona_repo\" do\nurl \"http://repo.percona.com/apt\"\n6:     key \"CD2EFD2A\"\nkey_server \"keys.gnupg.net\"\nend\n\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-mysql-recipes-default.rb\n# Target line: 6\n\n      1: \n      2: if (node.mysql.use_percona || node.mysql.add_percona_repo) && node.apt.master_chef_add_apt_repo\n      3: \n      4:   add_apt_repository \"percona_repo\" do\n      5:     url \"http://repo.percona.com/apt\"\n>>>   6:     key \"CD2EFD2A\"\n      7:     key_server \"keys.gnupg.net\"\n      8:   end\n      9: \n     10: end\n     11: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb", "content": "user_name 'test-admin'", "line": 21, "detection_span": [16, 26], "with_context": "\nwith_chef_server 'https://127.0.0.1:8443',\nclient_name: 'pivotal',\nsigning_key_filename: '/etc/opscode/pivotal.pem' do\n\nchef_user 'test-admin' do\n21:     user_name 'test-admin'\ndisplay_name 'test-admin'\nadmin true\nemail 'test-admin@chef.io'\npassword 'password123!'\nsource_key_path '/shared/keys/test.pem'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: chef-partners_omnibus-marketplace-shared-recipes-setup-chef-client-test.rb\n# Target line: 21\n\n     16: with_chef_server 'https://127.0.0.1:8443',\n     17:   client_name: 'pivotal',\n     18:   signing_key_filename: '/etc/opscode/pivotal.pem' do\n     19: \n     20:   chef_user 'test-admin' do\n>>>  21:     user_name 'test-admin'\n     22:     display_name 'test-admin'\n     23:     admin true\n     24:     email 'test-admin@chef.io'\n     25:     password 'password123!'\n     26:     source_key_path '/shared/keys/test.pem'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-add_a_context_menu_item_for_showing_the_web_inspector_in_web_views.rb", "content": "key 'WebKitDeveloperExtras'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Add a context menu item for showing the Web Inspector in web views\" do\ndomain 'NSGlobalDomain'\n3:   key 'WebKitDeveloperExtras'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-add_a_context_menu_item_for_showing_the_web_inspector_in_web_views.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Add a context menu item for showing the Web Inspector in web views\" do\n      2:   domain 'NSGlobalDomain'\n>>>   3:   key 'WebKitDeveloperExtras'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-apt-attributes-default.rb", "content": "default['apt']['cache_bypass'] = {}", "line": 29, "detection_span": [24, 34], "with_context": "\ndefault['apt']['cacher_ssl_support'] = false\ndefault['apt']['caching_server'] = false\ndefault['apt']['compiletime'] = false\ndefault['apt']['compile_time_update'] = false\ndefault['apt']['key_proxy'] = ''\n29: default['apt']['cache_bypass'] = {}\ndefault['apt']['periodic_update_min_delay'] = 86_400\ndefault['apt']['launchpad_api_version'] = '1.0'\ndefault['apt']['unattended_upgrades']['enable'] = false\ndefault['apt']['unattended_upgrades']['update_package_lists'] = true\n# this needs a good default", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-apt-attributes-default.rb\n# Target line: 29\n\n     24: default['apt']['cacher_ssl_support'] = false\n     25: default['apt']['caching_server'] = false\n     26: default['apt']['compiletime'] = false\n     27: default['apt']['compile_time_update'] = false\n     28: default['apt']['key_proxy'] = ''\n>>>  29: default['apt']['cache_bypass'] = {}\n     30: default['apt']['periodic_update_min_delay'] = 86_400\n     31: default['apt']['launchpad_api_version'] = '1.0'\n     32: default['apt']['unattended_upgrades']['enable'] = false\n     33: default['apt']['unattended_upgrades']['update_package_lists'] = true\n     34: # this needs a good default\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb", "content": "key 'NewWindowTarget'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\ndomain 'com.apple.finder'\n3:   key 'NewWindowTarget'\nstring \"PfHm\"\nend\n\nosxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\ndomain 'com.apple.finder'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_new_finder_windows_shows_homefolder.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'NewWindowTarget'\n      4:   string \"PfHm\"\n      5: end\n      6: \n      7: osxdefaults_defaults \"Finder: New Finder window shows the homefolder 1/2\" do\n      8:   domain 'com.apple.finder'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "pinterest_it-cpe-cookbooks-cpe_smartcard-attributes-default.rb", "content": "'oneCardPerUser' => nil,", "line": 17, "detection_span": [12, 22], "with_context": "\n#\n\ndefault['cpe_smartcard'] = {\n'allowSmartCard' => nil,\n'checkCertificateTrust' => nil,\n17:   'oneCardPerUser' => nil,\n'UserPairing' => nil,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pinterest_it-cpe-cookbooks-cpe_smartcard-attributes-default.rb\n# Target line: 17\n\n     12: #\n     13: \n     14: default['cpe_smartcard'] = {\n     15:   'allowSmartCard' => nil,\n     16:   'checkCertificateTrust' => nil,\n>>>  17:   'oneCardPerUser' => nil,\n     18:   'UserPairing' => nil,\n     19: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "jonmthomson_cookbooks-windows-providers-certificate.rb", "content": "password = \", \\\"#{@new_resource.pfx_password}\\\"\" if isPfx", "line": 37, "detection_span": [32, 42], "with_context": "\n\naction :create do\n# We can do everything in a powershell script resource\nfile = win_friendly_path(@new_resource.source)\nisPfx = file.downcase.end_with?('pfx')\n37:   password = \", \\\"#{@new_resource.pfx_password}\\\"\" if isPfx\npersistKeySet = ', ([System.Security.Cryptography.X509Certificates.X509KeyStorageFlags]::PersistKeySet)' if isPfx\n\ncodeScript = <<-EOH\n$store = New-Object System.Security.Cryptography.X509Certificates.X509Store \"#{@new_resource.store_name}\", ([System.Security.Cryptography.X509Certificates.StoreLocation]::#{@location})\n$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \"#{file}\"#{password}#{persistKeySet}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jonmthomson_cookbooks-windows-providers-certificate.rb\n# Target line: 37\n\n     32: \n     33: action :create do\n     34:   # We can do everything in a powershell script resource\n     35:   file = win_friendly_path(@new_resource.source)\n     36:   isPfx = file.downcase.end_with?('pfx')\n>>>  37:   password = \", \\\"#{@new_resource.pfx_password}\\\"\" if isPfx\n     38:   persistKeySet = ', ([System.Security.Cryptography.X509Certificates.X509KeyStorageFlags]::PersistKeySet)' if isPfx\n     39: \n     40:   codeScript = <<-EOH\n     41:     $store = New-Object System.Security.Cryptography.X509Certificates.X509Store \"#{@new_resource.store_name}\", ([System.Security.Cryptography.X509Certificates.StoreLocation]::#{@location})\n     42:     $cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 \"#{file}\"#{password}#{persistKeySet}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_pythonstack-recipes-default_unless.rb", "content": "node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_admin'] = 'demo@demo.com'", "line": 47, "detection_span": [42, 52], "with_context": "\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['docroot'] = \"/var/www/#{site_name}/#{port}\"\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['monitoring_hostname'] = site_name\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['customlog'] =\n\"#{node[node[stackname]['webserver']]['log_dir']}/#{site_name}-#{port}-access.log combined\"\nif node[stackname]['webserver'] == 'apache'\n47:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_admin'] = 'demo@demo.com'\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['template'] = 'apache2/sites/example.com.erb'\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_name'] = site_name\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['allow_override'] = ['All']\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['loglevel'] = 'warn'\nnode.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['script_name'] = 'wsgi.py'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_pythonstack-recipes-default_unless.rb\n# Target line: 47\n\n     42:     node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['docroot'] = \"/var/www/#{site_name}/#{port}\"\n     43:     node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['monitoring_hostname'] = site_name\n     44:     node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['customlog'] =\n     45:       \"#{node[node[stackname]['webserver']]['log_dir']}/#{site_name}-#{port}-access.log combined\"\n     46:     if node[stackname]['webserver'] == 'apache'\n>>>  47:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_admin'] = 'demo@demo.com'\n     48:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['template'] = 'apache2/sites/example.com.erb'\n     49:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['server_name'] = site_name\n     50:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['allow_override'] = ['All']\n     51:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['loglevel'] = 'warn'\n     52:       node.default_unless[stackname][node[stackname]['webserver']]['sites'][port][site_name]['script_name'] = 'wsgi.py'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_keystone-providers-credentials.rb", "content": "tenant_key = \"name\"", "line": 39, "detection_span": [34, 44], "with_context": "\nheaders = build_headers(new_resource.auth_token)\n\n# lookup tenant_uuid\nChef::Log.debug(\"Looking up Tenant_UUID for Tenant_Name: #{new_resource.tenant_name}\")\ntenant_container = \"tenants\"\n39:   tenant_key = \"name\"\ntenant_path = \"/#{new_resource.api_ver}/tenants\"\ntenant_uuid, tenant_error = find_value(http, tenant_path, headers, tenant_container, tenant_key, new_resource.tenant_name, 'id')\nChef::Log.error(\"There was an error looking up Tenant '#{new_resource.tenant_name}'\") if tenant_error\n\n# lookup user_uuid", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_keystone-providers-credentials.rb\n# Target line: 39\n\n     34:   headers = build_headers(new_resource.auth_token)\n     35: \n     36:   # lookup tenant_uuid\n     37:   Chef::Log.debug(\"Looking up Tenant_UUID for Tenant_Name: #{new_resource.tenant_name}\")\n     38:   tenant_container = \"tenants\"\n>>>  39:   tenant_key = \"name\"\n     40:   tenant_path = \"/#{new_resource.api_ver}/tenants\"\n     41:   tenant_uuid, tenant_error = find_value(http, tenant_path, headers, tenant_container, tenant_key, new_resource.tenant_name, 'id')\n     42:   Chef::Log.error(\"There was an error looking up Tenant '#{new_resource.tenant_name}'\") if tenant_error\n     43: \n     44:   # lookup user_uuid\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "pinterest_it-cpe-cookbooks-cpe_screensaver-attributes-default.rb", "content": "'askForPassword' => nil,", "line": 15, "detection_span": [10, 20], "with_context": "\n# This source code is licensed under the Apache 2.0 license found in the\n# LICENSE file in the root directory of this source tree.\n#\n\ndefault['cpe_screensaver'] = {\n15:   'askForPassword' => nil,\n'askForPasswordDelay' => nil,\n'idleTime' => nil,\n}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pinterest_it-cpe-cookbooks-cpe_screensaver-attributes-default.rb\n# Target line: 15\n\n     10: # This source code is licensed under the Apache 2.0 license found in the\n     11: # LICENSE file in the root directory of this source tree.\n     12: #\n     13: \n     14: default['cpe_screensaver'] = {\n>>>  15:   'askForPassword' => nil,\n     16:   'askForPasswordDelay' => nil,\n     17:   'idleTime' => nil,\n     18: }\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "guntukukamal_chef-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']       = 'wwwrun'", "line": 57, "detection_span": [52, 62], "with_context": "\ndefault['nginx']['dir']          = '/usr/local/etc/nginx'\ndefault['nginx']['script_dir']   = '/usr/local/sbin'\ndefault['nginx']['binary']       = '/usr/local/sbin/nginx'\ndefault['nginx']['default_root'] = '/usr/local/www/nginx-dist'\nwhen 'suse'\n57:   default['nginx']['user']       = 'wwwrun'\ndefault['nginx']['group']      = 'www'\nelse # debian probably\ndefault['nginx']['user']       = 'www-data'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guntukukamal_chef-cookbooks-nginx-attributes-default.rb\n# Target line: 57\n\n     52:   default['nginx']['dir']          = '/usr/local/etc/nginx'\n     53:   default['nginx']['script_dir']   = '/usr/local/sbin'\n     54:   default['nginx']['binary']       = '/usr/local/sbin/nginx'\n     55:   default['nginx']['default_root'] = '/usr/local/www/nginx-dist'\n     56: when 'suse'\n>>>  57:   default['nginx']['user']       = 'wwwrun'\n     58:   default['nginx']['group']      = 'www'\n     59: else # debian probably\n     60:   default['nginx']['user']       = 'www-data'\n     61: end\n     62: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-gnocchi_conf.rb", "content": "conf['keystone_authtoken']['username'] = 'gnocchi'", "line": 5, "detection_span": [1, 10], "with_context": "\ndefault['openstack']['telemetry_metric']['conf_secrets'] = {}\n\ndefault['openstack']['telemetry_metric']['conf'].tap do |conf|\n# [keystone_authtoken] section\n5:   conf['keystone_authtoken']['username'] = 'gnocchi'\nconf['keystone_authtoken']['project_name'] = 'service'\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-gnocchi_conf.rb\n# Target line: 5\n\n      1: default['openstack']['telemetry_metric']['conf_secrets'] = {}\n      2: \n      3: default['openstack']['telemetry_metric']['conf'].tap do |conf|\n      4:   # [keystone_authtoken] section\n>>>   5:   conf['keystone_authtoken']['username'] = 'gnocchi'\n      6:   conf['keystone_authtoken']['project_name'] = 'service'\n      7:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n      8:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n      9:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     10:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb", "content": "default[:kafka][:ftp_loader][:user] = 'root'", "line": 88, "detection_span": [83, 93], "with_context": "\n\ndefault[:kafka][:ftp_loader][:code_dir] = '/usr/local/share/kafka-contrib/current/'\ndefault[:kafka][:ftp_loader][:conf_dir] = '/usr/local/share/kafka-contrib/shared/config/'\ndefault[:kafka][:ftp_loader][:scripts_directory] = '/usr/local/share/kafka-contrib/current/scripts'\ndefault[:kafka][:ftp_loader][:command] = \"bundle exec ruby #{default[:kafka][:ftp_loader][:scripts_directory]}/ftp2s3.rb\"\n88: default[:kafka][:ftp_loader][:user] = 'root'\n\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb\n# Target line: 88\n\n     83: \n     84: default[:kafka][:ftp_loader][:code_dir] = '/usr/local/share/kafka-contrib/current/'\n     85: default[:kafka][:ftp_loader][:conf_dir] = '/usr/local/share/kafka-contrib/shared/config/'\n     86: default[:kafka][:ftp_loader][:scripts_directory] = '/usr/local/share/kafka-contrib/current/scripts'\n     87: default[:kafka][:ftp_loader][:command] = \"bundle exec ruby #{default[:kafka][:ftp_loader][:scripts_directory]}/ftp2s3.rb\"\n>>>  88: default[:kafka][:ftp_loader][:user] = 'root'\n     89: \n     90: \n     91: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb", "content": "conf_secrets['DEFAULT']['stack_domain_admin_password'] =", "line": 91, "detection_span": [86, 96], "with_context": "\ndb_uri('orchestration', db_user, db_pass)\nconf_secrets['keystone_authtoken']['password'] =\nget_password 'service', 'openstack-orchestration'\nconf_secrets['trustee']['password'] =\nget_password 'service', 'openstack-orchestration'\n91:   conf_secrets['DEFAULT']['stack_domain_admin_password'] =\nget_password 'user', stack_domain_admin\nend\n\n# merge all config options and secrets to be used in the heat.conf\nheat_conf_options = merge_config_options 'orchestration'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb\n# Target line: 91\n\n     86:     db_uri('orchestration', db_user, db_pass)\n     87:   conf_secrets['keystone_authtoken']['password'] =\n     88:     get_password 'service', 'openstack-orchestration'\n     89:   conf_secrets['trustee']['password'] =\n     90:     get_password 'service', 'openstack-orchestration'\n>>>  91:   conf_secrets['DEFAULT']['stack_domain_admin_password'] =\n     92:     get_password 'user', stack_domain_admin\n     93: end\n     94: \n     95: # merge all config options and secrets to be used in the heat.conf\n     96: heat_conf_options = merge_config_options 'orchestration'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-php-attributes-default.rb", "content": "default['php']['fpm_user']      = 'nobody'", "line": 29, "detection_span": [24, 34], "with_context": "\n\ncase node[\"platform\"]\nwhen \"centos\", \"redhat\", \"fedora\"\ndefault['php']['conf_dir']      = '/etc'\ndefault['php']['ext_conf_dir']  = '/etc/php.d'\n29:   default['php']['fpm_user']      = 'nobody'\ndefault['php']['fpm_group']     = 'nobody'\ndefault['php']['ext_dir']       = \"/usr/#{lib_dir}/php/modules\"\nwhen \"debian\", \"ubuntu\"\ndefault['php']['conf_dir']      = '/etc/php5/cli'\ndefault['php']['ext_conf_dir']  = '/etc/php5/conf.d'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-php-attributes-default.rb\n# Target line: 29\n\n     24: \n     25: case node[\"platform\"]\n     26: when \"centos\", \"redhat\", \"fedora\"\n     27:   default['php']['conf_dir']      = '/etc'\n     28:   default['php']['ext_conf_dir']  = '/etc/php.d'\n>>>  29:   default['php']['fpm_user']      = 'nobody'\n     30:   default['php']['fpm_group']     = 'nobody'\n     31:   default['php']['ext_dir']       = \"/usr/#{lib_dir}/php/modules\"\n     32: when \"debian\", \"ubuntu\"\n     33:   default['php']['conf_dir']      = '/etc/php5/cli'\n     34:   default['php']['ext_conf_dir']  = '/etc/php5/conf.d'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "FriendsOfCake_vagrant-chef-cookbooks-percona-attributes-default.rb", "content": "default['mysql']['key_buffer']              = \"1G\"", "line": 7, "detection_span": [2, 12], "with_context": "\ndefault['mysql']['server_root_password']    = 'password'\ndefault['mysql']['server_repl_password']    = 'password'\ndefault['mysql']['bind_address']            = '0.0.0.0'\ndefault['mysql']['datadir']                 = \"/var/lib/mysql\"\n\n7: default['mysql']['key_buffer']              = \"1G\"\ndefault['mysql']['max_connections']         = \"450\"\ndefault['mysql']['tmpdir']                  = \"/tmp\"\ndefault['mysql']['query_cache_limit']       = \"20M\"\ndefault['mysql']['query_cache_size']        = \"512M\"\ndefault['mysql']['server_id']               = 1", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: FriendsOfCake_vagrant-chef-cookbooks-percona-attributes-default.rb\n# Target line: 7\n\n      2: default['mysql']['server_root_password']    = 'password'\n      3: default['mysql']['server_repl_password']    = 'password'\n      4: default['mysql']['bind_address']            = '0.0.0.0'\n      5: default['mysql']['datadir']                 = \"/var/lib/mysql\"\n      6: \n>>>   7: default['mysql']['key_buffer']              = \"1G\"\n      8: default['mysql']['max_connections']         = \"450\"\n      9: default['mysql']['tmpdir']                  = \"/tmp\"\n     10: default['mysql']['query_cache_limit']       = \"20M\"\n     11: default['mysql']['query_cache_size']        = \"512M\"\n     12: default['mysql']['server_id']               = 1\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-attributes-default.rb", "content": "default[:jenkins_integration][:smtp][:password] = ''", "line": 84, "detection_span": [79, 89], "with_context": "\n#\ndefault[:jenkins_integration][:smtp][:from]     = 'Mr. Jenkins <jenkins@example.com>'\ndefault[:jenkins_integration][:smtp][:server]   = 'smtp.example.com'\ndefault[:jenkins_integration][:smtp][:port]     = '25'\ndefault[:jenkins_integration][:smtp][:username] = ''\n84: default[:jenkins_integration][:smtp][:password] = ''\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-attributes-default.rb\n# Target line: 84\n\n     79: # \n     80: default[:jenkins_integration][:smtp][:from]     = 'Mr. Jenkins <jenkins@example.com>'\n     81: default[:jenkins_integration][:smtp][:server]   = 'smtp.example.com'\n     82: default[:jenkins_integration][:smtp][:port]     = '25'\n     83: default[:jenkins_integration][:smtp][:username] = ''\n>>>  84: default[:jenkins_integration][:smtp][:password] = ''\n     85: \n     86: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb", "content": "params[:svn_username] = nil", "line": 60, "detection_span": [55, 65], "with_context": "\nsvn_args = \"--no-auth-cache --non-interactive\"\nenable_submodules = false\nelse\nscm_prov = Chef::Provider::Git\nsvn_args = nil\n60:     params[:svn_username] = nil\nparams[:svn_password] = nil\nenable_submodules = true\nend\n\nlog \"  Capistrano deployment will use #{scm_prov} for initialization\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-definitions-repo_capistranize.rb\n# Target line: 60\n\n     55:     svn_args = \"--no-auth-cache --non-interactive\"\n     56:     enable_submodules = false\n     57:   else\n     58:     scm_prov = Chef::Provider::Git\n     59:     svn_args = nil\n>>>  60:     params[:svn_username] = nil\n     61:     params[:svn_password] = nil\n     62:     enable_submodules = true\n     63:   end\n     64: \n     65:   log \"  Capistrano deployment will use #{scm_prov} for initialization\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-repo-attributes-default.rb", "content": "set_unless[:repo][:default][:storage_account_secret] = \"\"", "line": 16, "detection_span": [11, 21], "with_context": "\nset_unless[:repo][:default][:svn_username] = \"\"\nset_unless[:repo][:default][:svn_password] = \"\"\nset_unless[:repo][:default][:git_ssh_key] = \"\"\nset_unless[:repo][:default][:storage_account_provider] = \"S3\"\nset_unless[:repo][:default][:storage_account_id] = \"\"\n16: set_unless[:repo][:default][:storage_account_secret] = \"\"\nset_unless[:repo][:default][:container] = \"\"\nset_unless[:repo][:default][:prefix] = \"\"\nset_unless[:repo][:default][:environment]= {}\nset_unless[:repo][:default][:symlinks]= {}\nset_unless[:repo][:default][:purge_before_symlink] = %w{}", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-repo-attributes-default.rb\n# Target line: 16\n\n     11: set_unless[:repo][:default][:svn_username] = \"\"\n     12: set_unless[:repo][:default][:svn_password] = \"\"\n     13: set_unless[:repo][:default][:git_ssh_key] = \"\"\n     14: set_unless[:repo][:default][:storage_account_provider] = \"S3\"\n     15: set_unless[:repo][:default][:storage_account_id] = \"\"\n>>>  16: set_unless[:repo][:default][:storage_account_secret] = \"\"\n     17: set_unless[:repo][:default][:container] = \"\"\n     18: set_unless[:repo][:default][:prefix] = \"\"\n     19: set_unless[:repo][:default][:environment]= {}\n     20: set_unless[:repo][:default][:symlinks]= {}\n     21: set_unless[:repo][:default][:purge_before_symlink] = %w{}\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-redis-cookbooks-elasticsearch-attributes-default.rb", "content": "default[:elasticsearch ][:user]                   = 'elasticsearch'", "line": 20, "detection_span": [15, 25], "with_context": "\n\n#\n# User\n#\n\n20: default[:elasticsearch ][:user]                   = 'elasticsearch'\ndefault[:users ]['elasticsearch'][:uid]           = 61021\ndefault[:groups]['elasticsearch'][:gid]           = 61021\n\n#\n# Install", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-redis-cookbooks-elasticsearch-attributes-default.rb\n# Target line: 20\n\n     15: \n     16: #\n     17: # User\n     18: #\n     19: \n>>>  20: default[:elasticsearch ][:user]                   = 'elasticsearch'\n     21: default[:users ]['elasticsearch'][:uid]           = 61021\n     22: default[:groups]['elasticsearch'][:gid]           = 61021\n     23: \n     24: #\n     25: # Install\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "danielladd_Chef-Testing-cookbooks-database-libraries-provider_database_mysql_user.rb", "content": "password = filtered = \"PASSWORD '#{$1}'\"", "line": 62, "detection_span": [57, 67], "with_context": "\ndef action_grant\nbegin\n# does password look like MySQL hex digest?\n# (begins with *, followed by 40 hexadecimal characters)\nif (/(\\A\\*[0-9A-F]{40}\\z)/i).match(@new_resource.password) then\n62:               password = filtered = \"PASSWORD '#{$1}'\"\nelse\npassword = \"'#{@new_resource.password}'\"\nfiltered = '[FILTERED]'\nend\ngrant_statement = \"GRANT #{@new_resource.privileges.join(', ')} ON #{@new_resource.database_name && @new_resource.database_name != '*' ? \"`#{@new_resource.database_name}`\" : '*'}.#{@new_resource.table && @new_resource.table != '*' ? \"`#{@new_resource.table}`\" : '*'} TO `#{@new_resource.username}`@`#{@new_resource.host}` IDENTIFIED BY \"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-database-libraries-provider_database_mysql_user.rb\n# Target line: 62\n\n     57:         def action_grant\n     58:           begin\n     59:             # does password look like MySQL hex digest?\n     60:             # (begins with *, followed by 40 hexadecimal characters)\n     61:             if (/(\\A\\*[0-9A-F]{40}\\z)/i).match(@new_resource.password) then\n>>>  62:               password = filtered = \"PASSWORD '#{$1}'\"\n     63:             else\n     64:               password = \"'#{@new_resource.password}'\"\n     65:               filtered = '[FILTERED]'\n     66:             end\n     67:             grant_statement = \"GRANT #{@new_resource.privileges.join(', ')} ON #{@new_resource.database_name && @new_resource.database_name != '*' ? \"`#{@new_resource.database_name}`\" : '*'}.#{@new_resource.table && @new_resource.table != '*' ? \"`#{@new_resource.table}`\" : '*'} TO `#{@new_resource.username}`@`#{@new_resource.host}` IDENTIFIED BY \"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "cookbooks_ss-chef-rvm-attributes-default.rb", "content": "default['rvm']['user_home_root']  = '/Users'", "line": 74, "detection_span": [69, 79], "with_context": "\nwhen \"debian\",\"ubuntu\",\"suse\"\nnode.set['rvm']['install_pkgs']   = %w{sed grep tar gzip bzip2 bash curl git-core}\ndefault['rvm']['user_home_root']  = '/home'\nwhen \"mac_os_x\", \"mac_os_x_server\"\nnode.set['rvm']['install_pkgs']   = %w{git}\n74:   default['rvm']['user_home_root']  = '/Users'\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ss-chef-rvm-attributes-default.rb\n# Target line: 74\n\n     69: when \"debian\",\"ubuntu\",\"suse\"\n     70:   node.set['rvm']['install_pkgs']   = %w{sed grep tar gzip bzip2 bash curl git-core}\n     71:   default['rvm']['user_home_root']  = '/home'\n     72: when \"mac_os_x\", \"mac_os_x_server\"\n     73:   node.set['rvm']['install_pkgs']   = %w{git}\n>>>  74:   default['rvm']['user_home_root']  = '/Users'\n     75: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb", "content": "default['nginx']['user']         = 'www'", "line": 55, "detection_span": [50, 60], "with_context": "\nwhen 'gentoo'\ndefault['nginx']['user']       = 'nginx'\ndefault['nginx']['init_style'] = 'init'\nwhen 'freebsd'\ndefault['nginx']['package_name'] = 'www/nginx'\n55:   default['nginx']['user']         = 'www'\ndefault['nginx']['dir']          = '/usr/local/etc/nginx'\ndefault['nginx']['script_dir']   = '/usr/local/sbin'\ndefault['nginx']['binary']       = '/usr/local/sbin/nginx'\ndefault['nginx']['default_root'] = '/usr/local/www/nginx-dist'\nwhen 'suse'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: havk64_chef-zero-playground-cookbooks-nginx-attributes-default.rb\n# Target line: 55\n\n     50: when 'gentoo'\n     51:   default['nginx']['user']       = 'nginx'\n     52:   default['nginx']['init_style'] = 'init'\n     53: when 'freebsd'\n     54:   default['nginx']['package_name'] = 'www/nginx'\n>>>  55:   default['nginx']['user']         = 'www'\n     56:   default['nginx']['dir']          = '/usr/local/etc/nginx'\n     57:   default['nginx']['script_dir']   = '/usr/local/sbin'\n     58:   default['nginx']['binary']       = '/usr/local/sbin/nginx'\n     59:   default['nginx']['default_root'] = '/usr/local/www/nginx-dist'\n     60: when 'suse'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_nodestack-recipes-demo.rb", "content": "proxy_pass: 'http://127.0.0.1:8000',", "line": 56, "detection_span": [51, 61], "with_context": "\nnode.set['nodestack']['nginx']['sites'][port][site]['cookbook']     = 'nodestack'\nnode.set['nodestack']['nginx']['sites'][port][site]['template']     = 'nginx/nodestack-demo.conf.erb'\nnode.set['nodestack']['nginx']['sites'][port][site]['variables'] = {\nserver_name: 'nodestack-demo.com',\nserver_aliases: [''],\n56:   proxy_pass: 'http://127.0.0.1:8000',\nerrorlog: \"#{node['nginx']['log_dir']}/#{site}-error.log debug\",\naccesslog: \"#{node['nginx']['log_dir']}/#{site}-access.log combined\"\n}\n\n# monitoring. nodestack::nginx also add's monitoring for the nginx site.", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-recipes-demo.rb\n# Target line: 56\n\n     51: node.set['nodestack']['nginx']['sites'][port][site]['cookbook']     = 'nodestack'\n     52: node.set['nodestack']['nginx']['sites'][port][site]['template']     = 'nginx/nodestack-demo.conf.erb'\n     53: node.set['nodestack']['nginx']['sites'][port][site]['variables'] = {\n     54:   server_name: 'nodestack-demo.com',\n     55:   server_aliases: [''],\n>>>  56:   proxy_pass: 'http://127.0.0.1:8000',\n     57:   errorlog: \"#{node['nginx']['log_dir']}/#{site}-error.log debug\",\n     58:   accesslog: \"#{node['nginx']['log_dir']}/#{site}-access.log combined\"\n     59: }\n     60: \n     61: # monitoring. nodestack::nginx also add's monitoring for the nginx site.\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-opsworks_initial_setup-attributes-default.rb", "content": "default[:opsworks_agent][:user] = 'aws'", "line": 24, "detection_span": [19, 29], "with_context": "\n# this values must match the ones respective ones in the agent configuration\ndefault[:opsworks_agent][:base_dir] = '/opt/aws/opsworks'\ndefault[:opsworks_agent][:current_dir] = \"#{node[:opsworks_agent][:base_dir]}/current\"\ndefault[:opsworks_agent][:shared_dir] = '/var/lib/aws/opsworks'\ndefault[:opsworks_agent][:log_dir] = '/var/log/aws/opsworks'\n24: default[:opsworks_agent][:user] = 'aws'\ndefault[:opsworks_agent][:group] = 'aws'\n\ndefault[:opsworks][:ruby_stack] = 'ruby'\ndefault[:opsworks][:ruby_version] = '1.9.3'\ndefault[:opsworks][:run_cookbook_tests] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-opsworks_initial_setup-attributes-default.rb\n# Target line: 24\n\n     19: # this values must match the ones respective ones in the agent configuration\n     20: default[:opsworks_agent][:base_dir] = '/opt/aws/opsworks'\n     21: default[:opsworks_agent][:current_dir] = \"#{node[:opsworks_agent][:base_dir]}/current\"\n     22: default[:opsworks_agent][:shared_dir] = '/var/lib/aws/opsworks'\n     23: default[:opsworks_agent][:log_dir] = '/var/log/aws/opsworks'\n>>>  24: default[:opsworks_agent][:user] = 'aws'\n     25: default[:opsworks_agent][:group] = 'aws'\n     26: \n     27: default[:opsworks][:ruby_stack] = 'ruby'\n     28: default[:opsworks][:ruby_version] = '1.9.3'\n     29: default[:opsworks][:run_cookbook_tests] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "Soluciones_ey-cloud-recipes-cookbooks-datadog-recipes-default.rb", "content": "user \"deploy\"", "line": 13, "detection_span": [8, 18], "with_context": "\n\n# stop the agent before the install if it is already on there\n\n\nexecute \"monit-stop-dd\" do\n13:  user \"deploy\"\ncwd \"/\"\ncommand \"monit stop datadog_wrapper; sleep 30\"\nonly_if \" pgrep 'datadog_wrapper' > /dev/null\"\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Soluciones_ey-cloud-recipes-cookbooks-datadog-recipes-default.rb\n# Target line: 13\n\n      8: \n      9: # stop the agent before the install if it is already on there\n     10: \n     11: \n     12: execute \"monit-stop-dd\" do\n>>>  13:  user \"deploy\"\n     14:  cwd \"/\"\n     15:  command \"monit stop datadog_wrapper; sleep 30\"\n     16:  only_if \" pgrep 'datadog_wrapper' > /dev/null\"\n     17: end\n     18: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "gwalbran_chef-cookbooks-talend-attributes-job.rb", "content": "\"Metadata_Username\" => \"admin\",", "line": 24, "detection_span": [19, 29], "with_context": "\ndefault['talend']['working']     = \"#{node['talend']['base_dir']}/data\"\ndefault['talend']['rubbish_dir'] = \"#{node['talend']['base_dir']}/rubbish\"\n\ndefault['talend']['mocked_config_regexps'] = {\n\".*_Server$\"        => \"localhost\",\n24:   \"Metadata_Username\" => \"admin\",\n\"Metadata_Password\" => \"admin\",\n\"Metadata_URL\"      => \"http://localhost:8080/geonetwork\"\n}\n\ndefault['talend']['max_parallel_jobs'] = node['cpu']['total'] ? node['cpu']['total'].to_i : 2", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: gwalbran_chef-cookbooks-talend-attributes-job.rb\n# Target line: 24\n\n     19: default['talend']['working']     = \"#{node['talend']['base_dir']}/data\"\n     20: default['talend']['rubbish_dir'] = \"#{node['talend']['base_dir']}/rubbish\"\n     21: \n     22: default['talend']['mocked_config_regexps'] = {\n     23:   \".*_Server$\"        => \"localhost\",\n>>>  24:   \"Metadata_Username\" => \"admin\",\n     25:   \"Metadata_Password\" => \"admin\",\n     26:   \"Metadata_URL\"      => \"http://localhost:8080/geonetwork\"\n     27: }\n     28: \n     29: default['talend']['max_parallel_jobs'] = node['cpu']['total'] ? node['cpu']['total'].to_i : 2\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-windows-resources-certificate.rb", "content": "cert_script = '$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2'", "line": 109, "detection_span": [104, 114], "with_context": "\n104:   def cert_location\n@location ||= new_resource.user_store ? 'CurrentUser' : 'LocalMachine'\n106:   end\n107:\n108:   def cert_script(persist)\n109:     cert_script = '$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2'\nfile = win_friendly_path(new_resource.source)\ncert_script << \" \\\"#{file}\\\"\"\nif ::File.extname(file.downcase) == '.pfx'\ncert_script << \", \\\"#{new_resource.pfx_password}\\\"\"\nif persist && new_resource.user_store", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-windows-resources-certificate.rb\n# Target line: 109\n\n    104:   def cert_location\n    105:     @location ||= new_resource.user_store ? 'CurrentUser' : 'LocalMachine'\n    106:   end\n    107: \n    108:   def cert_script(persist)\n>>> 109:     cert_script = '$cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2'\n    110:     file = win_friendly_path(new_resource.source)\n    111:     cert_script << \" \\\"#{file}\\\"\"\n    112:     if ::File.extname(file.downcase) == '.pfx'\n    113:       cert_script << \", \\\"#{new_resource.pfx_password}\\\"\"\n    114:       if persist && new_resource.user_store\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "train"}
