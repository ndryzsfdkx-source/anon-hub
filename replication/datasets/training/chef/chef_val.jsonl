{"smell": "weak_cryptography_algorithms", "file": "krishus_Chef-recipes-cron.rb", "content": "seed = node['shard_seed'] || Digest::MD5.hexdigest(node.name).to_s.hex", "line": 91, "detection_span": [86, 96], "with_context": "\nend\nend\n\n# Generate a uniformly distributed unique number to sleep.\nif node['chef_client']['splay'].to_i > 0\n91:   seed = node['shard_seed'] || Digest::MD5.hexdigest(node.name).to_s.hex\nsleep_time = seed % node['chef_client']['splay'].to_i\nelse\nsleep_time = nil\nend\nenv        = node['chef_client']['cron']['environment_variables']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of weak cryptography algorithms  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isWeakCrypt(x.value) \u2227 \u00achasWeakCryptWhitelist(x.name) \u2227 \u00achasWeakCryptWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isWeakCrypt(): \"md5\", \"sha1\", \"arcfour\"\n- hasWeakCryptWhitelist(): \"checksum\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of weak cryptography algorithms\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: krishus_Chef-recipes-cron.rb\n# Target line: 91\n\n     86:   end\n     87: end\n     88: \n     89: # Generate a uniformly distributed unique number to sleep.\n     90: if node['chef_client']['splay'].to_i > 0\n>>>  91:   seed = node['shard_seed'] || Digest::MD5.hexdigest(node.name).to_s.hex\n     92:   sleep_time = seed % node['chef_client']['splay'].to_i\n     93: else\n     94:   sleep_time = nil\n     95: end\n     96: env        = node['chef_client']['cron']['environment_variables']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of weak cryptography algorithms\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-testing-source.rb", "content": "default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'", "line": 10, "detection_span": [5, 15], "with_context": "\nif node['platform_version'].to_i > 2010\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\ndefault['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\nelse\ndefault['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel7&arch=$basearch'\n10:     default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\nend\nelse\ndefault['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\ndefault['yum']['epel-testing-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-yum-epel-attributes-epel-testing-source.rb\n# Target line: 10\n\n      5:   if node['platform_version'].to_i > 2010\n      6:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel6&arch=$basearch'\n      7:     default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6'\n      8:   else\n      9:     default['yum']['epel-testing-source']['mirrorlist'] = 'http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel7&arch=$basearch'\n>>>  10:     default['yum']['epel-testing-source']['gpgkey'] = 'http://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7'\n     11:   end\n     12: else\n     13:   default['yum']['epel-testing-source']['mirrorlist'] = \"http://mirrors.fedoraproject.org/mirrorlist?repo=testing-source-epel#{node['platform_version'].to_i}&arch=$basearch\"\n     14:   default['yum']['epel-testing-source']['gpgkey'] = \"https://download.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-#{node['platform_version'].to_i}\"\n     15: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "rackspace-cookbooks_nodestack-recipes-demo.rb", "content": "node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['source'] = 'monitoring-remote-http.yaml.erb'", "line": 64, "detection_span": [59, 69], "with_context": "\n}\n\n# monitoring. nodestack::nginx also add's monitoring for the nginx site.\nnode.set_unless['platformstack']['cloud_monitoring']['remote_http']['name'] = []\nnode.set['platformstack']['cloud_monitoring']['remote_http']['name'].push('my_nodejs_app')\n64: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['source'] = 'monitoring-remote-http.yaml.erb'\nnode.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['cookbook'] = 'platformstack'\nnode.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['variables'] = {\ndisabled: false,\nperiod: 60,\ntimeout: 15,", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_nodestack-recipes-demo.rb\n# Target line: 64\n\n     59: }\n     60: \n     61: # monitoring. nodestack::nginx also add's monitoring for the nginx site.\n     62: node.set_unless['platformstack']['cloud_monitoring']['remote_http']['name'] = []\n     63: node.set['platformstack']['cloud_monitoring']['remote_http']['name'].push('my_nodejs_app')\n>>>  64: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['source'] = 'monitoring-remote-http.yaml.erb'\n     65: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['cookbook'] = 'platformstack'\n     66: node.set['platformstack']['cloud_monitoring']['remote_http']['my_nodejs_app']['variables'] = {\n     67:   disabled: false,\n     68:   period: 60,\n     69:   timeout: 15,\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-jenkins-recipes-_server_package.rb", "content": "key 'http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key'", "line": 29, "detection_span": [24, 34], "with_context": "\n\napt_repository 'jenkins' do\nuri 'http://pkg.jenkins-ci.org/debian'\ndistribution 'binary/'\ncomponents ['']\n29:     key 'http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key'\naction :add\nend\n\nwhen 'rhel'\ninclude_recipe 'yum'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-recipes-_server_package.rb\n# Target line: 29\n\n     24: \n     25:   apt_repository 'jenkins' do\n     26:     uri 'http://pkg.jenkins-ci.org/debian'\n     27:     distribution 'binary/'\n     28:     components ['']\n>>>  29:     key 'http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key'\n     30:     action :add\n     31:   end\n     32: \n     33: when 'rhel'\n     34:   include_recipe 'yum'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "Nikhil424_chef-repo-cookbooks-prod-deploy-recipes-default.rb", "content": "source 'http://35.163.66.120:8081/artifactory/libs-snapshot-local/com/wakaleo/gameoflife/gameoflife-web/1.0-SNAPSHOT/gameoflife-web-1.0-20161212.084728-1.war'", "line": 11, "detection_span": [6, 16], "with_context": "\n#\n# All rights reserved - Do Not Redistribute\n#\n\nremote_file '/var/lib/tomcat7/webapps/gameoflife-web-1.0-20161212.084728-1.war' do\n11:   source 'http://35.163.66.120:8081/artifactory/libs-snapshot-local/com/wakaleo/gameoflife/gameoflife-web/1.0-SNAPSHOT/gameoflife-web-1.0-20161212.084728-1.war'\naction :create_if_missing\nuser 'root'\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: Nikhil424_chef-repo-cookbooks-prod-deploy-recipes-default.rb\n# Target line: 11\n\n      6: #\n      7: # All rights reserved - Do Not Redistribute\n      8: #\n      9: \n     10: remote_file '/var/lib/tomcat7/webapps/gameoflife-web-1.0-20161212.084728-1.war' do\n>>>  11:   source 'http://35.163.66.120:8081/artifactory/libs-snapshot-local/com/wakaleo/gameoflife/gameoflife-web/1.0-SNAPSHOT/gameoflife-web-1.0-20161212.084728-1.war'\n     12:   action :create_if_missing\n     13:   user 'root'\n     14: end\n     15: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "guymatz_chef-cookbooks-couchdb-attributes-default.rb", "content": "default['couch_db']['src_mirror']        = \"http://archive.apache.org/dist/couchdb/#{node['couch_db']['src_version']}/apache-couchdb-#{node['couch_db']['src_version']}.tar.gz\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\ndefault['couch_db']['src_checksum']      = \"6ef82a7ba0f132d55af7cc78b30658d5b3a4f7be3f449308c8d7fa2ad473677c\"\ndefault['couch_db']['src_version']       = \"1.0.2\"\n22: default['couch_db']['src_mirror']        = \"http://archive.apache.org/dist/couchdb/#{node['couch_db']['src_version']}/apache-couchdb-#{node['couch_db']['src_version']}.tar.gz\"\ndefault['couch_db']['bind_address']  = nil\ndefault['couch_db']['install_erlang'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-couchdb-attributes-default.rb\n# Target line: 22\n\n     17: # See the License for the specific language governing permissions and\n     18: # limitations under the License.\n     19: \n     20: default['couch_db']['src_checksum']      = \"6ef82a7ba0f132d55af7cc78b30658d5b3a4f7be3f449308c8d7fa2ad473677c\"\n     21: default['couch_db']['src_version']       = \"1.0.2\"\n>>>  22: default['couch_db']['src_mirror']        = \"http://archive.apache.org/dist/couchdb/#{node['couch_db']['src_version']}/apache-couchdb-#{node['couch_db']['src_version']}.tar.gz\"\n     23: default['couch_db']['bind_address']  = nil\n     24: default['couch_db']['install_erlang'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "cookbooks_ic-zookeeper-cookbooks-minidash-libraries-minidash_utils.rb", "content": "url = \"http://#{CGI::escape(url_parts[\"addr\"])}:#{port.to_i}\"", "line": 11, "detection_span": [6, 16], "with_context": "\ndef add_minidash_link(component, url_parts)\nif    url_parts.respond_to?(:each_pair) && url_parts[\"url\"]\nurl = url_parts[\"url\"]\nelsif url_parts.respond_to?(:each_pair) && url_parts[\"addr\"]\nport = url_parts[\"dash_port\"] || url_parts[\"port\"] || 80\n11:         url = \"http://#{CGI::escape(url_parts[\"addr\"])}:#{port.to_i}\"\nelsif url_parts.to_s =~ %r{^https?://}\nurl = url_parts.to_s\nelse\nurl = nil\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-zookeeper-cookbooks-minidash-libraries-minidash_utils.rb\n# Target line: 11\n\n      6:     def add_minidash_link(component, url_parts)\n      7:       if    url_parts.respond_to?(:each_pair) && url_parts[\"url\"]\n      8:         url = url_parts[\"url\"]\n      9:       elsif url_parts.respond_to?(:each_pair) && url_parts[\"addr\"]\n     10:         port = url_parts[\"dash_port\"] || url_parts[\"port\"] || 80\n>>>  11:         url = \"http://#{CGI::escape(url_parts[\"addr\"])}:#{port.to_i}\"\n     12:       elsif url_parts.to_s =~ %r{^https?://}\n     13:         url = url_parts.to_s\n     14:       else\n     15:         url = nil\n     16:       end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "infochimps-labs_ironfan-pantry-cookbooks-nodejs-recipes-npm.rb", "content": "npm_src_url = \"http://registry.npmjs.org/npm/-/npm-#{node['nodejs']['npm']}.tgz\"", "line": 25, "detection_span": [20, 30], "with_context": "\n\ninclude_recipe \"nodejs\"\n\npackage \"curl\"\n\n25: npm_src_url = \"http://registry.npmjs.org/npm/-/npm-#{node['nodejs']['npm']}.tgz\"\n\nbash \"install npm - package manager for node\" do\ncwd \"/usr/local/src\"\nuser \"root\"\ncode <<-EOH", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-nodejs-recipes-npm.rb\n# Target line: 25\n\n     20: \n     21: include_recipe \"nodejs\"\n     22: \n     23: package \"curl\"\n     24: \n>>>  25: npm_src_url = \"http://registry.npmjs.org/npm/-/npm-#{node['nodejs']['npm']}.tgz\"\n     26: \n     27: bash \"install npm - package manager for node\" do\n     28:   cwd \"/usr/local/src\"\n     29:   user \"root\"\n     30:   code <<-EOH\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "use_of_http", "file": "ubolonton_vagrant-cookbooks-python-recipes-pip.rb", "content": "source \"http://python-distribute.org/distribute_setup.py\"", "line": 26, "detection_span": [21, 31], "with_context": "\n# Ubuntu's python-setuptools, python-pip and python-virtualenv packages\n# are broken...this feels like Rubygems!\n# http://stackoverflow.com/questions/4324558/whats-the-proper-way-to-install-pip-virtualenv-and-distribute-for-python\n# https://bitbucket.org/ianb/pip/issue/104/pip-uninstall-on-ubuntu-linux\nremote_file \"#{Chef::Config[:file_cache_path]}/distribute_setup.py\" do\n26:   source \"http://python-distribute.org/distribute_setup.py\"\nmode \"0644\"\nnot_if \"which pip\"\nend\n\nuse_version = node['python']['distribute_install_py_version']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Use of HTTP without SSL/TLS  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 isURL(x.value) \u2227 hasHTTP(x.value) \u2227 \u00achasHTTPWhitelist(x.value)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasHTTP(): \"http\"\n- hasHTTPWhitelist(): \"localhost\", \"127.0.0.1\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Use of HTTP without SSL/TLS\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-python-recipes-pip.rb\n# Target line: 26\n\n     21: # Ubuntu's python-setuptools, python-pip and python-virtualenv packages \n     22: # are broken...this feels like Rubygems!\n     23: # http://stackoverflow.com/questions/4324558/whats-the-proper-way-to-install-pip-virtualenv-and-distribute-for-python\n     24: # https://bitbucket.org/ianb/pip/issue/104/pip-uninstall-on-ubuntu-linux\n     25: remote_file \"#{Chef::Config[:file_cache_path]}/distribute_setup.py\" do\n>>>  26:   source \"http://python-distribute.org/distribute_setup.py\"\n     27:   mode \"0644\"\n     28:   not_if \"which pip\"\n     29: end\n     30: \n     31: use_version = node['python']['distribute_install_py_version']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Use of HTTP without SSL/TLS\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-recipes-default.rb", "content": "# FIXME: This is only the vaguest of security, very unconfigurable,", "line": 67, "detection_span": [62, 72], "with_context": "\nowner         node[:jenkins][:server][:user]\ngroup         node[:jenkins][:server][:group]\nend\n\n# Lock access down to local user accounts\n67: # FIXME: This is only the vaguest of security, very unconfigurable,\n#   and really should be done over HTTPS to prevent pw hash sniffing.\nif node[:jenkins_integration][:security] == \"local_users\"\ngroup \"shadow\" do\naction :modify\nmembers node[:jenkins][:server][:user]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-jenkins_integration-recipes-default.rb\n# Target line: 67\n\n     62:   owner         node[:jenkins][:server][:user]\n     63:   group         node[:jenkins][:server][:group]\n     64: end\n     65: \n     66: # Lock access down to local user accounts\n>>>  67: # FIXME: This is only the vaguest of security, very unconfigurable,\n     68: #   and really should be done over HTTPS to prevent pw hash sniffing.\n     69: if node[:jenkins_integration][:security] == \"local_users\"\n     70:   group \"shadow\" do\n     71:     action :modify\n     72:     members node[:jenkins][:server][:user]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "ubolonton_vagrant-cookbooks-nodejs-recipes-install_from_source.rb", "content": "# --no-same-owner required overcome \"Cannot change ownership\" bug", "line": 38, "detection_span": [33, 43], "with_context": "\nsource node['nodejs']['src_url']\nchecksum node['nodejs']['checksum']\nmode 0644\nend\n\n38: # --no-same-owner required overcome \"Cannot change ownership\" bug\n# on NFS-mounted filesystem\nexecute \"tar --no-same-owner -zxf #{nodejs_tar}\" do\ncwd \"/usr/local/src\"\ncreates \"/usr/local/src/node-v#{node['nodejs']['version']}\"\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-nodejs-recipes-install_from_source.rb\n# Target line: 38\n\n     33:   source node['nodejs']['src_url']\n     34:   checksum node['nodejs']['checksum']\n     35:   mode 0644\n     36: end\n     37: \n>>>  38: # --no-same-owner required overcome \"Cannot change ownership\" bug\n     39: # on NFS-mounted filesystem\n     40: execute \"tar --no-same-owner -zxf #{nodejs_tar}\" do\n     41:   cwd \"/usr/local/src\"\n     42:   creates \"/usr/local/src/node-v#{node['nodejs']['version']}\"\n     43: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "GoogleCloudPlatform_chef-google-compute-recipes-examples~network~legacy.rb", "content": "# using this example. If running from the command line, you can pass this suffix", "line": 66, "detection_span": [61, 71], "with_context": "\nend\n\nraise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\nunless ENV.key?('network_id')\n# The environment variable 'network_id' defines a suffix for a network name when\n66: # using this example. If running from the command line, you can pass this suffix\n# in via the command line:\n#\n# network_id=\"some_suffix\" chef-client -z --runlist \\\n#   \"recipe[gcompute::examples~network~auto]\"\nputs 'Creating network in Legacy mode'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-examples~network~legacy.rb\n# Target line: 66\n\n     61: end\n     62: \n     63: raise \"Missing parameter 'network_id'. Please read docs at #{__FILE__}\" \\\n     64:   unless ENV.key?('network_id')\n     65: # The environment variable 'network_id' defines a suffix for a network name when\n>>>  66: # using this example. If running from the command line, you can pass this suffix\n     67: # in via the command line:\n     68: #\n     69: # network_id=\"some_suffix\" chef-client -z --runlist \\\n     70: #   \"recipe[gcompute::examples~network~auto]\"\n     71: puts 'Creating network in Legacy mode'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "kodius_flexcareers-chef-recipes-cookbooks-mingw-resources-msys2_package.rb", "content": "# well that's your problem isn't it?  And they don't believe in preserving", "line": 25, "detection_span": [20, 30], "with_context": "\n# Installs msys2 base system and installs/upgrades packages within in.\n#\n# Where's the version flag?  Where's idempotence you say?  Well f*** you\n# for trying to version your product.  This is arch.  They live on the edge.\n# You never get anything but the latest version.  And if that's broken...\n25: # well that's your problem isn't it?  And they don't believe in preserving\n# older versions.  Good luck!\n\nproperty :package, String, name_property: true\nproperty :root, String, required: true\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-cookbooks-mingw-resources-msys2_package.rb\n# Target line: 25\n\n     20: # Installs msys2 base system and installs/upgrades packages within in.\n     21: #\n     22: # Where's the version flag?  Where's idempotence you say?  Well f*** you\n     23: # for trying to version your product.  This is arch.  They live on the edge.\n     24: # You never get anything but the latest version.  And if that's broken...\n>>>  25: # well that's your problem isn't it?  And they don't believe in preserving\n     26: # older versions.  Good luck!\n     27: \n     28: property :package, String, name_property: true\n     29: property :root, String, required: true\n     30: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb", "content": "# working around: http://tickets.opscode.com/browse/CHEF-1848; set to true if you have the CHEF-1848 patch applied", "line": 94, "detection_span": [89, 99], "with_context": "\n\n#\n# Install\n#\n\n94: # working around: http://tickets.opscode.com/browse/CHEF-1848; set to true if you have the CHEF-1848 patch applied\ndefault[:jenkins][:server][:use_head]   = false\n\ndefault[:jenkins][:apt_mirror]          = \"http://pkg.jenkins-ci.org/debian\"\ndefault[:jenkins][:plugins_mirror]      = \"http://updates.jenkins-ci.org\"\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-tuning-cookbooks-jenkins-attributes-default.rb\n# Target line: 94\n\n     89: \n     90: #\n     91: # Install\n     92: #\n     93: \n>>>  94: # working around: http://tickets.opscode.com/browse/CHEF-1848; set to true if you have the CHEF-1848 patch applied\n     95: default[:jenkins][:server][:use_head]   = false\n     96: \n     97: default[:jenkins][:apt_mirror]          = \"http://pkg.jenkins-ci.org/debian\"\n     98: default[:jenkins][:plugins_mirror]      = \"http://updates.jenkins-ci.org\"\n     99: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb", "content": "# FIXME: don't set this to reuse the default attribute", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault[:kafka][:user]                              = 'kafka'\ndefault[:users ]['kafka'][:uid]                     = 452\ndefault[:kafka][:group]                             = 'kafka'\ndefault[:groups ]['kafka'][:gid]                    = 452\n\n11:                                                                          # FIXME: don't set this to reuse the default attribute\ndefault[:kafka][:install_dir]                       = \"/usr/local/share/kafka-#{default[:kafka][:version]}\"\ndefault[:kafka][:home_dir]                          = '/usr/local/share/kafka'\ndefault[:kafka][:conf_dir]                          = File.join(default[:kafka][:home_dir], 'config')\n# Set via volume_dirs\ndefault[:kafka][:journal_dir]                       = nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: infochimps-labs_ironfan-pantry-cookbooks-kafka-attributes-default.rb\n# Target line: 11\n\n      6: default[:kafka][:user]                              = 'kafka'\n      7: default[:users ]['kafka'][:uid]                     = 452\n      8: default[:kafka][:group]                             = 'kafka'\n      9: default[:groups ]['kafka'][:gid]                    = 452\n     10: \n>>>  11:                                                                          # FIXME: don't set this to reuse the default attribute\n     12: default[:kafka][:install_dir]                       = \"/usr/local/share/kafka-#{default[:kafka][:version]}\"\n     13: default[:kafka][:home_dir]                          = '/usr/local/share/kafka'\n     14: default[:kafka][:conf_dir]                          = File.join(default[:kafka][:home_dir], 'config')\n     15: # Set via volume_dirs\n     16: default[:kafka][:journal_dir]                       = nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "dice-project_DICE-Chef-Repository-cookbooks-poise-languages-files-halite_gem-poise_languages-scl-mixin.rb", "content": "# TODO: What do I do about Fedora and/or Amazon?", "line": 83, "detection_span": [78, 88], "with_context": "\nend\n\nmodule ClassMethods\ndef provides_auto?(node, resource)\n# They don't build 32-bit versions for these and only for RHEL/CentOS.\n83:           # TODO: What do I do about Fedora and/or Amazon?\nreturn false unless node['kernel']['machine'] == 'x86_64' && node.platform?('redhat', 'centos')\nversion = inversion_options(node, resource)['version']\n!!find_scl_package(node, version)\nend\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-poise-languages-files-halite_gem-poise_languages-scl-mixin.rb\n# Target line: 83\n\n     78:       end\n     79: \n     80:       module ClassMethods\n     81:         def provides_auto?(node, resource)\n     82:           # They don't build 32-bit versions for these and only for RHEL/CentOS.\n>>>  83:           # TODO: What do I do about Fedora and/or Amazon?\n     84:           return false unless node['kernel']['machine'] == 'x86_64' && node.platform?('redhat', 'centos')\n     85:           version = inversion_options(node, resource)['version']\n     86:           !!find_scl_package(node, version)\n     87:         end\n     88: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise-helpers-fused.rb", "content": "# Hack provider_for_action so that the resource is also the provider.", "line": 53, "detection_span": [48, 58], "with_context": "\nelse\nsuper\nend\nend\n\n53:       # Hack provider_for_action so that the resource is also the provider.\n#\n# @api private\n# @param action [Symbol]\n# @return [Chef::Provider]\ndef provider_for_action(action)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-poise-files-halite_gem-poise-helpers-fused.rb\n# Target line: 53\n\n     48:         else\n     49:           super\n     50:         end\n     51:       end\n     52: \n>>>  53:       # Hack provider_for_action so that the resource is also the provider.\n     54:       #\n     55:       # @api private\n     56:       # @param action [Symbol]\n     57:       # @return [Chef::Provider]\n     58:       def provider_for_action(action)\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "rackspace-cookbooks_pythonstack-recipes-nginx.rb", "content": "# Pid is different on Ubuntu 14, causing nginx service to fail https://github.com/miketheman/nginx/issues/248", "line": 47, "detection_span": [42, 52], "with_context": "\n\n# Install Uwsgi\ninclude_recipe 'build-essential'\ninclude_recipe 'uwsgi'\n\n47: # Pid is different on Ubuntu 14, causing nginx service to fail https://github.com/miketheman/nginx/issues/248\nnode.default['nginx']['pid'] = '/run/nginx.pid' if ubuntu_trusty?\n# Uwsgi path is different on Centos\nif rhel?\nnode.default['nginx']['uwsgi']['bin'] = '/usr/bin/uwsgi'\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_pythonstack-recipes-nginx.rb\n# Target line: 47\n\n     42: \n     43: # Install Uwsgi\n     44: include_recipe 'build-essential'\n     45: include_recipe 'uwsgi'\n     46: \n>>>  47: # Pid is different on Ubuntu 14, causing nginx service to fail https://github.com/miketheman/nginx/issues/248\n     48: node.default['nginx']['pid'] = '/run/nginx.pid' if ubuntu_trusty?\n     49: # Uwsgi path is different on Centos\n     50: if rhel?\n     51:   node.default['nginx']['uwsgi']['bin'] = '/usr/bin/uwsgi'\n     52: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "shopping-adventure_chef_mysql-recipes-server.rb", "content": "#resolver = Resolv::DNS.new(:nameserver => [\"#{dns_node['cloud']['local_hostname']}\"])", "line": 132, "detection_span": [127, 137], "with_context": "\n127:   ipv4_address=\"\"\n128:   ipv6_address=\"\"\n129:   dns_node = search(:node, 'role:dns').first\n130:\n131:   #Resolver local n'est pas suffisant\n132:   #resolver = Resolv::DNS.new(:nameserver => [\"#{dns_node['cloud']['local_hostname']}\"])\n133:   resolver = Resolv::DNS.new(:nameserver => \"8.8.8.8\")\n134:   fqdns.each do |fqdn|\nresolver.getaddresses(\"#{fqdn}\").each do |ip|\ncase ip.to_s\nwhen Resolv::IPv4::Regex", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: shopping-adventure_chef_mysql-recipes-server.rb\n# Target line: 132\n\n    127:   ipv4_address=\"\"\n    128:   ipv6_address=\"\"\n    129:   dns_node = search(:node, 'role:dns').first\n    130: \n    131:   #Resolver local n'est pas suffisant\n>>> 132:   #resolver = Resolv::DNS.new(:nameserver => [\"#{dns_node['cloud']['local_hostname']}\"])\n    133:   resolver = Resolv::DNS.new(:nameserver => \"8.8.8.8\")\n    134:   fqdns.each do |fqdn|\n    135:     resolver.getaddresses(\"#{fqdn}\").each do |ip|\n    136:       case ip.to_s\n    137:       when Resolv::IPv4::Regex\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "guymatz_chef-cookbooks-imgproxy-recipes-nat_workaround.rb", "content": "# Carpathia NAT issues.", "line": 2, "detection_span": [1, 7], "with_context": "\n# This recipe is used to set the hosts file on the imgproxys to get around\n2: # Carpathia NAT issues.\nnode[:imgproxy][:host_entries].each do |ip, host|\nhostsfile_entry ip do\nhostname host\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-imgproxy-recipes-nat_workaround.rb\n# Target line: 2\n\n      1: # This recipe is used to set the hosts file on the imgproxys to get around\n>>>   2: # Carpathia NAT issues.\n      3: node[:imgproxy][:host_entries].each do |ip, host|\n      4:   hostsfile_entry ip do\n      5:     hostname host\n      6:   end\n      7: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "criteo-cookbooks_ms_dotnet-libraries-v4_helper.rb", "content": "# TODO: check 2012R2 Core feature name", "line": 60, "detection_span": [55, 65], "with_context": "\nprotected\n\ndef feature_names\n@feature_names ||= case nt_version\nwhen 6.2, 6.3, 10\n60:           # TODO: check 2012R2 Core feature name\ncore? ? %w[netFx4-Server-Core] : %w[NetFx4]\nelse\n[]\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: criteo-cookbooks_ms_dotnet-libraries-v4_helper.rb\n# Target line: 60\n\n     55:     protected\n     56: \n     57:     def feature_names\n     58:       @feature_names ||= case nt_version\n     59:         when 6.2, 6.3, 10\n>>>  60:           # TODO: check 2012R2 Core feature name\n     61:           core? ? %w[netFx4-Server-Core] : %w[NetFx4]\n     62:         else\n     63:           []\n     64:       end\n     65:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "SpanningCloudApps_cassandra-chef-cookbook-recipes-datastax.rb", "content": "# Submit an issue if jamm version is not correct for 0.x or 1.x version", "line": 21, "detection_span": [16, 26], "with_context": "\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\ncase node['cassandra']['version']\n21: # Submit an issue if jamm version is not correct for 0.x or 1.x version\nwhen /^0\\./, /^1\\./, /^2\\.0/\n# < 2.1 Versions\nnode.default['cassandra']['setup_jna'] = true\nnode.default['cassandra']['cassandra_old_version_20'] = true\nelse", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: SpanningCloudApps_cassandra-chef-cookbook-recipes-datastax.rb\n# Target line: 21\n\n     16: # See the License for the specific language governing permissions and\n     17: # limitations under the License.\n     18: #\n     19: \n     20: case node['cassandra']['version']\n>>>  21: # Submit an issue if jamm version is not correct for 0.x or 1.x version\n     22: when /^0\\./, /^1\\./, /^2\\.0/\n     23:   # < 2.1 Versions\n     24:   node.default['cassandra']['setup_jna'] = true\n     25:   node.default['cassandra']['cassandra_old_version_20'] = true\n     26: else\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_linux.rb", "content": "# TODO: Figure out how to run as a service account.", "line": 110, "detection_span": [105, 115], "with_context": "\n105:   end\n106:\n107:   # Enable and start the agent as a service on the node with any available\n108:   # CLI options\n109:   poise_service 'newrelic-infra' do\n110:     # TODO: Figure out how to run as a service account.\n# user node['newrelic_infra']['user']['name']\ncommand '/usr/bin/newrelic-infra ' <<\nNewRelicInfra.generate_flags(node['newrelic_infra']['agent']['flags'])\noptions(:systemd,\ntemplate: 'newrelic-infra:default/systemd.service.erb',", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-newrelic-infra-recipes-agent_linux.rb\n# Target line: 110\n\n    105:   end\n    106: \n    107:   # Enable and start the agent as a service on the node with any available\n    108:   # CLI options\n    109:   poise_service 'newrelic-infra' do\n>>> 110:     # TODO: Figure out how to run as a service account.\n    111:     # user node['newrelic_infra']['user']['name']\n    112:     command '/usr/bin/newrelic-infra ' <<\n    113:             NewRelicInfra.generate_flags(node['newrelic_infra']['agent']['flags'])\n    114:     options(:systemd,\n    115:             template: 'newrelic-infra:default/systemd.service.erb',\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb", "content": "# Monitor postfix", "line": 6, "detection_span": [1, 11], "with_context": "\n#\n# Cookbook Name:: datadog\n# Recipe:: postfix\n#\n\n6: # Monitor postfix\n#\n# Assuming you have 2 instances \"prod\" and \"test\", you will need to set\n# up the following attributes at some point in your Chef run, in either\n# a role or another cookbook.\n#", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: fakeNetflix_Shopify-repo-chef-datadog-recipes-postfix.rb\n# Target line: 6\n\n      1: #\n      2: # Cookbook Name:: datadog\n      3: # Recipe:: postfix\n      4: #\n      5: \n>>>   6: # Monitor postfix\n      7: #\n      8: # Assuming you have 2 instances \"prod\" and \"test\", you will need to set\n      9: # up the following attributes at some point in your Chef run, in either\n     10: # a role or another cookbook.\n     11: #\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "suspicious_comment", "file": "danielladd_Chef-Testing-cookbooks-windows-providers-printer_port.rb", "content": "# TODO: Set @current_resource port properties from registry", "line": 53, "detection_span": [48, 58], "with_context": "\n@current_resource.name(@new_resource.name)\n@current_resource.ipv4_address(@new_resource.ipv4_address)\n@current_resource.port_name(@new_resource.port_name || \"IP_#{ @new_resource.ipv4_address }\")\n\nif port_exists?(@current_resource.port_name)\n53:     # TODO: Set @current_resource port properties from registry\n@current_resource.exists = true\nend\nend\n\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Suspicious comment  \nRule: isComment(x) \u2227 hasWrongWords(x.content)\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- hasWrongWords(): \"bug\", \"debug\", \"todo\", \"hack\", \"solve\", \"fixme\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Suspicious comment\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: danielladd_Chef-Testing-cookbooks-windows-providers-printer_port.rb\n# Target line: 53\n\n     48:   @current_resource.name(@new_resource.name)\n     49:   @current_resource.ipv4_address(@new_resource.ipv4_address)\n     50:   @current_resource.port_name(@new_resource.port_name || \"IP_#{ @new_resource.ipv4_address }\")\n     51: \n     52:   if port_exists?(@current_resource.port_name)\n>>>  53:     # TODO: Set @current_resource port properties from registry\n     54:     @current_resource.exists = true\n     55:   end\n     56: end\n     57: \n     58: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Suspicious comment\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-otrs-attributes-default.rb", "content": "default[:otrs][:database_password] = \"otrs\"", "line": 7, "detection_span": [2, 12], "with_context": "\ndefault[:otrs][:user] = \"otrs\"\ndefault[:otrs][:group] = nil\ndefault[:otrs][:database_cluster] = \"13/main\"\ndefault[:otrs][:database_name] = \"otrs\"\ndefault[:otrs][:database_user] = \"otrs\"\n7: default[:otrs][:database_password] = \"otrs\"\ndefault[:otrs][:site] = \"otrs\"\n\ndefault[:postgresql][:versions] |= [\"13\"]\n\ndefault[:accounts][:users][:otrs][:status] = :role", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-otrs-attributes-default.rb\n# Target line: 7\n\n      2: default[:otrs][:user] = \"otrs\"\n      3: default[:otrs][:group] = nil\n      4: default[:otrs][:database_cluster] = \"13/main\"\n      5: default[:otrs][:database_name] = \"otrs\"\n      6: default[:otrs][:database_user] = \"otrs\"\n>>>   7: default[:otrs][:database_password] = \"otrs\"\n      8: default[:otrs][:site] = \"otrs\"\n      9: \n     10: default[:postgresql][:versions] |= [\"13\"]\n     11: \n     12: default[:accounts][:users][:otrs][:status] = :role\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-openssh-attributes-bastion.rb", "content": "default['openssh']['server']['pub_key_authentication'] = \"yes\"", "line": 88, "detection_span": [83, 93], "with_context": "\ndefault['openssh']['server']['permit_root_login'] = node[:tags].include?(\"permit-root\") ? \"yes\" : \"no\"\n# default['openssh']['server']['strict_modes'] = \"yes\"\n# default['openssh']['server']['max_auth_tries'] = \"6\"\n# default['openssh']['server']['max_sessions'] = \"10\"\ndefault['openssh']['server']['rsa_authentication'] = \"yes\"\n88: default['openssh']['server']['pub_key_authentication'] = \"yes\"\ndefault['openssh']['server']['authorized_keys_file'] = \"%h/.ssh/authorized_keys\"\ndefault['openssh']['server']['rhosts_rsa_authentication'] = \"no\"\ndefault['openssh']['server']['host_based_authentication'] = \"no\"\n# default['openssh']['server']['ignore_user_known_hosts'] = \"no\"\n# default['openssh']['server']['ignore_rhosts'] = \"yes\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-openssh-attributes-bastion.rb\n# Target line: 88\n\n     83: default['openssh']['server']['permit_root_login'] = node[:tags].include?(\"permit-root\") ? \"yes\" : \"no\"\n     84: # default['openssh']['server']['strict_modes'] = \"yes\"\n     85: # default['openssh']['server']['max_auth_tries'] = \"6\"\n     86: # default['openssh']['server']['max_sessions'] = \"10\"\n     87: default['openssh']['server']['rsa_authentication'] = \"yes\"\n>>>  88: default['openssh']['server']['pub_key_authentication'] = \"yes\"\n     89: default['openssh']['server']['authorized_keys_file'] = \"%h/.ssh/authorized_keys\"\n     90: default['openssh']['server']['rhosts_rsa_authentication'] = \"no\"\n     91: default['openssh']['server']['host_based_authentication'] = \"no\"\n     92: # default['openssh']['server']['ignore_user_known_hosts'] = \"no\"\n     93: # default['openssh']['server']['ignore_rhosts'] = \"yes\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb", "content": "conf_secrets['keystone_authtoken']['password'] =", "line": 87, "detection_span": [82, 92], "with_context": "\nnode.default['openstack']['orchestration']['conf_secrets'].tap do |conf_secrets|\nconf_secrets['DEFAULT']['auth_encryption_key'] =\nget_password 'token', 'orchestration_auth_encryption_key'\nconf_secrets['database']['connection'] =\ndb_uri('orchestration', db_user, db_pass)\n87:   conf_secrets['keystone_authtoken']['password'] =\nget_password 'service', 'openstack-orchestration'\nconf_secrets['trustee']['password'] =\nget_password 'service', 'openstack-orchestration'\nconf_secrets['DEFAULT']['stack_domain_admin_password'] =\nget_password 'user', stack_domain_admin", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-orchestration-recipes-common.rb\n# Target line: 87\n\n     82: node.default['openstack']['orchestration']['conf_secrets'].tap do |conf_secrets|\n     83:   conf_secrets['DEFAULT']['auth_encryption_key'] =\n     84:     get_password 'token', 'orchestration_auth_encryption_key'\n     85:   conf_secrets['database']['connection'] =\n     86:     db_uri('orchestration', db_user, db_pass)\n>>>  87:   conf_secrets['keystone_authtoken']['password'] =\n     88:     get_password 'service', 'openstack-orchestration'\n     89:   conf_secrets['trustee']['password'] =\n     90:     get_password 'service', 'openstack-orchestration'\n     91:   conf_secrets['DEFAULT']['stack_domain_admin_password'] =\n     92:     get_password 'user', stack_domain_admin\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-kibana-recipes-default.rb", "content": "user \"kibana\"", "line": 70, "detection_span": [65, 75], "with_context": "\nend\n\nsystemd_service \"kibana@\" do\ndescription \"Kibana server\"\nafter \"network.target\"\n70:   user \"kibana\"\nexec_start \"/opt/kibana-#{version}/bin/kibana -c /etc/kibana/%i.yml\"\nprivate_tmp true\nprivate_devices true\nprotect_system \"full\"\nprotect_home true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-kibana-recipes-default.rb\n# Target line: 70\n\n     65: end\n     66: \n     67: systemd_service \"kibana@\" do\n     68:   description \"Kibana server\"\n     69:   after \"network.target\"\n>>>  70:   user \"kibana\"\n     71:   exec_start \"/opt/kibana-#{version}/bin/kibana -c /etc/kibana/%i.yml\"\n     72:   private_tmp true\n     73:   private_devices true\n     74:   protect_system \"full\"\n     75:   protect_home true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-zeus-zxtm-attributes-default.rb", "content": "default[:zeus][:zeus_root] = \"/data/zeus\"", "line": 13, "detection_span": [8, 18], "with_context": "\nwhen /^stage/\ndefault[:zeus][:tarball_url] = \"http://files.ihrdev.com/ZeusTM_95_Linux-x86_64.tgz\"\ndefault[:zeus][:tarball_dir] = \"ZeusTM_95_Linux-x86_64\"\ndefault[:zeus][:checksum] = \"9ae6b3778b9fe07c7d81cfe56095eaecbdbb57f220b07ef82e6a00a00dff7ed5\"\nend\n13: default[:zeus][:zeus_root] = \"/data/zeus\"\ndefault[:zeus][:force_install] = false\ndefault[:zeus][:group] = \"nobody\"\ndefault[:zeus][:user] = \"nobody\"\ndefault[:zeus][:ec2] = \"false\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-zeus-zxtm-attributes-default.rb\n# Target line: 13\n\n      8: when /^stage/\n      9:   default[:zeus][:tarball_url] = \"http://files.ihrdev.com/ZeusTM_95_Linux-x86_64.tgz\"\n     10:   default[:zeus][:tarball_dir] = \"ZeusTM_95_Linux-x86_64\"\n     11:   default[:zeus][:checksum] = \"9ae6b3778b9fe07c7d81cfe56095eaecbdbb57f220b07ef82e6a00a00dff7ed5\"\n     12: end\n>>>  13: default[:zeus][:zeus_root] = \"/data/zeus\"\n     14: default[:zeus][:force_install] = false\n     15: default[:zeus][:group] = \"nobody\"\n     16: default[:zeus][:user] = \"nobody\"\n     17: default[:zeus][:ec2] = \"false\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-proftpd-attributes-proftpd.rb", "content": "default[:proftpd][:key_dir]              = \"/etc/proftpd/authorized_keys\"", "line": 9, "detection_span": [4, 14], "with_context": "\nwhen /^stage/\ndefault[:proftpd][:encoder_export]       = \"iad-stg-nfs101.ihr:/data/export/encoder\"\nend\ndefault[:proftpd][:encoder_mount_point]  = \"/data/encoder\"\ndefault[:proftpd][:dir]                  = \"/etc/proftpd\"\n9: default[:proftpd][:key_dir]              = \"/etc/proftpd/authorized_keys\"\ndefault[:proftpd][:dir_extra_conf]       = \"conf.d\"\ndefault[:proftpd][:nat]                  = \"off\"\ndefault[:proftpd][:server_name]          = \"NULL\"\ndefault[:proftpd][:email_admin]          = node[:admin_email]\ndefault[:proftpd][:ftp_user]             = \"vftp\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-proftpd-attributes-proftpd.rb\n# Target line: 9\n\n      4: when /^stage/\n      5:   default[:proftpd][:encoder_export]       = \"iad-stg-nfs101.ihr:/data/export/encoder\"\n      6: end\n      7: default[:proftpd][:encoder_mount_point]  = \"/data/encoder\"\n      8: default[:proftpd][:dir]                  = \"/etc/proftpd\"\n>>>   9: default[:proftpd][:key_dir]              = \"/etc/proftpd/authorized_keys\"\n     10: default[:proftpd][:dir_extra_conf]       = \"conf.d\"\n     11: default[:proftpd][:nat]                  = \"off\"\n     12: default[:proftpd][:server_name]          = \"NULL\"\n     13: default[:proftpd][:email_admin]          = node[:admin_email]\n     14: default[:proftpd][:ftp_user]             = \"vftp\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "rackspace-cookbooks_pythonstack-attributes-nginx.rb", "content": "default['nginx']['default_root'] = '/var/www'", "line": 29, "detection_span": [24, 34], "with_context": "\nend\n\n# needed to be like this so it acts like apache\ndefault['nginx']['listen_ports'] = %w(80)\n\n29: default['nginx']['default_root'] = '/var/www'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rackspace-cookbooks_pythonstack-attributes-nginx.rb\n# Target line: 29\n\n     24: end\n     25: \n     26: # needed to be like this so it acts like apache\n     27: default['nginx']['listen_ports'] = %w(80)\n     28: \n>>>  29: default['nginx']['default_root'] = '/var/www'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "jahumes_RailsChef-vendor-cookbooks-rails-recipes-env_vars.rb", "content": "deploy_user = app_info['deploy_user'] || \"deploy\"", "line": 6, "detection_span": [1, 11], "with_context": "\napplications_root = node[:rails][:applications_root]\n\nif node[:active_applications]\nnode[:active_applications].each do |app, app_info|\n\n6:     deploy_user = app_info['deploy_user'] || \"deploy\"\nenv_vars = app_info[\"env_vars\"] || {}\ntemplate \"#{applications_root}/#{app}/shared/.rbenv-vars\" do\nsource \"app_env_vars.erb\"\nmode 0600\nowner deploy_user", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: jahumes_RailsChef-vendor-cookbooks-rails-recipes-env_vars.rb\n# Target line: 6\n\n      1: applications_root = node[:rails][:applications_root]\n      2: \n      3: if node[:active_applications]\n      4:   node[:active_applications].each do |app, app_info|\n      5: \n>>>   6:     deploy_user = app_info['deploy_user'] || \"deploy\"\n      7:     env_vars = app_info[\"env_vars\"] || {}\n      8:     template \"#{applications_root}/#{app}/shared/.rbenv-vars\" do\n      9:       source \"app_env_vars.erb\"\n     10:       mode 0600\n     11:       owner deploy_user\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb", "content": "database_user \"osmf-wikiuser\"", "line": 35, "detection_span": [30, 40], "with_context": "\nfpm_start_servers 5\nfpm_min_spare_servers 5\nfpm_max_spare_servers 10\nfpm_prometheus_port 11001\ndatabase_name \"osmf-wiki\"\n35:   database_user \"osmf-wikiuser\"\ndatabase_password passwords[\"wiki\"][\"database\"]\nadmin_password passwords[\"wiki\"][\"admin\"]\nskin \"OSMFoundation\"\nlogo \"/w/skins/OSMFoundation/img/logo.png\"\nemail_contact \"webmaster@openstreetmap.org\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: openstreetmap_chef-cookbooks-foundation-recipes-wiki.rb\n# Target line: 35\n\n     30:   fpm_start_servers 5\n     31:   fpm_min_spare_servers 5\n     32:   fpm_max_spare_servers 10\n     33:   fpm_prometheus_port 11001\n     34:   database_name \"osmf-wiki\"\n>>>  35:   database_user \"osmf-wikiuser\"\n     36:   database_password passwords[\"wiki\"][\"database\"]\n     37:   admin_password passwords[\"wiki\"][\"admin\"]\n     38:   skin \"OSMFoundation\"\n     39:   logo \"/w/skins/OSMFoundation/img/logo.png\"\n     40:   email_contact \"webmaster@openstreetmap.org\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-aodh_conf.rb", "content": "conf['service_credentials']['username'] = 'aodh'", "line": 12, "detection_span": [7, 17], "with_context": "\nconf['keystone_authtoken']['auth_type'] = 'v3password'\nconf['keystone_authtoken']['user_domain_name'] = 'Default'\nconf['keystone_authtoken']['project_domain_name'] = 'Default'\nconf['keystone_authtoken']['region_name'] = node['openstack']['region']\n# [service_credentials] section\n12:   conf['service_credentials']['username'] = 'aodh'\nconf['service_credentials']['project_name'] = 'service'\nconf['service_credentials']['user_domain_name'] = 'Default'\nconf['service_credentials']['project_domain_name'] = 'Default'\nconf['service_credentials']['auth_type'] = 'v3password'\nconf['service_credentials']['interface'] = 'internal'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-telemetry-attributes-aodh_conf.rb\n# Target line: 12\n\n      7:   conf['keystone_authtoken']['auth_type'] = 'v3password'\n      8:   conf['keystone_authtoken']['user_domain_name'] = 'Default'\n      9:   conf['keystone_authtoken']['project_domain_name'] = 'Default'\n     10:   conf['keystone_authtoken']['region_name'] = node['openstack']['region']\n     11:   # [service_credentials] section\n>>>  12:   conf['service_credentials']['username'] = 'aodh'\n     13:   conf['service_credentials']['project_name'] = 'service'\n     14:   conf['service_credentials']['user_domain_name'] = 'Default'\n     15:   conf['service_credentials']['project_domain_name'] = 'Default'\n     16:   conf['service_credentials']['auth_type'] = 'v3password'\n     17:   conf['service_credentials']['interface'] = 'internal'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "ubolonton_vagrant-cookbooks-mysql-recipes-server.rb", "content": "node.set_unless['mysql']['server_root_password']   = 'vagrant'", "line": 26, "detection_span": [21, 31], "with_context": "\n\ninclude_recipe \"mysql::client\"\n\n# generate all passwords\nnode.set_unless['mysql']['server_debian_password'] = 'vagrant'\n26: node.set_unless['mysql']['server_root_password']   = 'vagrant'\nnode.set_unless['mysql']['server_repl_password']   = 'vagrant'\n\nif platform?(%w{debian ubuntu})\n\ndirectory \"/var/cache/local/preseeding\" do", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: ubolonton_vagrant-cookbooks-mysql-recipes-server.rb\n# Target line: 26\n\n     21: \n     22: include_recipe \"mysql::client\"\n     23: \n     24: # generate all passwords\n     25: node.set_unless['mysql']['server_debian_password'] = 'vagrant'\n>>>  26: node.set_unless['mysql']['server_root_password']   = 'vagrant'\n     27: node.set_unless['mysql']['server_repl_password']   = 'vagrant'\n     28: \n     29: if platform?(%w{debian ubuntu})\n     30: \n     31:   directory \"/var/cache/local/preseeding\" do\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_ic-nodejs-cookbooks-jenkins-recipes-user_key.rb", "content": "public_key_filename = \"#{node[:jenkins][:server][:home_dir]}/.ssh/id_rsa\"", "line": 22, "detection_span": [17, 27], "with_context": "\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n22: public_key_filename = \"#{node[:jenkins][:server][:home_dir]}/.ssh/id_rsa\"\n\ndirectory File.dirname(public_key_filename) do\nowner         node[:jenkins][:server][:user]\ngroup         node[:jenkins][:server][:group]\nmode          \"0700\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_ic-nodejs-cookbooks-jenkins-recipes-user_key.rb\n# Target line: 22\n\n     17: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n     18: # See the License for the specific language governing permissions and\n     19: # limitations under the License.\n     20: #\n     21: \n>>>  22: public_key_filename = \"#{node[:jenkins][:server][:home_dir]}/.ssh/id_rsa\"\n     23: \n     24: directory File.dirname(public_key_filename) do\n     25:   owner         node[:jenkins][:server][:user]\n     26:   group         node[:jenkins][:server][:group]\n     27:   mode          \"0700\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "pzaich_mai-ey-cloud-recipes-cookbooks-eybackup_slave-attributes-default.rb", "content": "default[:public_key] = default[:encrypted_backups] ? components.find {|c| c[:public_key]}[:public_key] : nil", "line": 4, "detection_span": [1, 9], "with_context": "\n# are the backups encrypted\ncomponents = node[:engineyard][:environment][:apps].map {|a| a[:components]}.flatten\ndefault[:encrypted_backups] = components.map {|c| c[:key]}.include?('encrypted_backup')\n4: default[:public_key] = default[:encrypted_backups] ? components.find {|c| c[:public_key]}[:public_key] : nil", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: pzaich_mai-ey-cloud-recipes-cookbooks-eybackup_slave-attributes-default.rb\n# Target line: 4\n\n      1: # are the backups encrypted\n      2: components = node[:engineyard][:environment][:apps].map {|a| a[:components]}.flatten\n      3: default[:encrypted_backups] = components.map {|c| c[:key]}.include?('encrypted_backup')\n>>>   4: default[:public_key] = default[:encrypted_backups] ? components.find {|c| c[:public_key]}[:public_key] : nil\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "CEPSG_chefkt-cookbooks-rightscale-attributes-default.rb", "content": "set_unless[:rightscale][:private_ssh_key] = \"\"", "line": 19, "detection_span": [14, 24], "with_context": "\n# Optional attributes\n#\nset_unless[:rightscale][:timezone] = \"UTC\"\nset_unless[:rightscale][:process_list] = \"\"\nset_unless[:rightscale][:process_match_list] = \"\"\n19: set_unless[:rightscale][:private_ssh_key] = \"\"\n\nset_unless[:rightscale][:db_backup_file] = \"/var/run/db-backup\"\n\n#\n# Setup Distro dependent variables", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: CEPSG_chefkt-cookbooks-rightscale-attributes-default.rb\n# Target line: 19\n\n     14: # Optional attributes\n     15: #\n     16: set_unless[:rightscale][:timezone] = \"UTC\"\n     17: set_unless[:rightscale][:process_list] = \"\"\n     18: set_unless[:rightscale][:process_match_list] = \"\"\n>>>  19: set_unless[:rightscale][:private_ssh_key] = \"\"\n     20: \n     21: set_unless[:rightscale][:db_backup_file] = \"/var/run/db-backup\"\n     22: \n     23: #\n     24: # Setup Distro dependent variables\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "aws_opsworks-cookbooks-ebs-providers-raid.rb", "content": "pass 0", "line": 66, "detection_span": [61, 71], "with_context": "\n\nmount options[:mount_point] do\nfstype options[:fstype]\ndevice lvm_device\noptions 'noatime'\n66:     pass 0\nnot_if do\n::File.read('/etc/mtab').split(\"\\n\").any? do |line|\nline.match(\" #{options[:mount_point]} \")\nend\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: aws_opsworks-cookbooks-ebs-providers-raid.rb\n# Target line: 66\n\n     61: \n     62:   mount options[:mount_point] do\n     63:     fstype options[:fstype]\n     64:     device lvm_device\n     65:     options 'noatime'\n>>>  66:     pass 0\n     67:     not_if do\n     68:       ::File.read('/etc/mtab').split(\"\\n\").any? do |line|\n     69:         line.match(\" #{options[:mount_point]} \")\n     70:       end\n     71:     end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-jenkins-attributes-server.rb", "content": "default['jenkins']['http_proxy']['basic_auth_username'] = \"jenkins\"", "line": 56, "detection_span": [51, 61], "with_context": "\ndefault['jenkins']['http_proxy']['www_redirect']         = \"disable\"\ndefault['jenkins']['http_proxy']['listen_ports']         = [ 80 ]\ndefault['jenkins']['http_proxy']['host_name']            = \"build.ihrdev.com\"\ndefault['jenkins']['http_proxy']['host_aliases']         = []\ndefault['jenkins']['http_proxy']['client_max_body_size'] = \"1024m\"\n56: default['jenkins']['http_proxy']['basic_auth_username'] = \"jenkins\"\ndefault['jenkins']['http_proxy']['basic_auth_password'] = \"jenkins\"\ndefault['jenkins']['http_proxy']['cas_validate_server'] = \"off\"\ndefault['jenkins']['http_proxy']['server_auth_method'] = nil\n\ndefault['jenkins']['http_proxy']['ssl']['enabled'] = false", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-jenkins-attributes-server.rb\n# Target line: 56\n\n     51: default['jenkins']['http_proxy']['www_redirect']         = \"disable\"\n     52: default['jenkins']['http_proxy']['listen_ports']         = [ 80 ]\n     53: default['jenkins']['http_proxy']['host_name']            = \"build.ihrdev.com\"\n     54: default['jenkins']['http_proxy']['host_aliases']         = []\n     55: default['jenkins']['http_proxy']['client_max_body_size'] = \"1024m\"\n>>>  56: default['jenkins']['http_proxy']['basic_auth_username'] = \"jenkins\"\n     57: default['jenkins']['http_proxy']['basic_auth_password'] = \"jenkins\"\n     58: default['jenkins']['http_proxy']['cas_validate_server'] = \"off\"\n     59: default['jenkins']['http_proxy']['server_auth_method'] = nil\n     60: \n     61: default['jenkins']['http_proxy']['ssl']['enabled'] = false\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb", "content": "default['yum']['main']['proxy_username'] = nil #  /.*/", "line": 82, "detection_span": [77, 87], "with_context": "\ndefault['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['protected_multilib'] = nil # /.*/\ndefault['yum']['main']['protected_packages'] = nil # /.*/\ndefault['yum']['main']['proxy'] = nil #  /.*/\ndefault['yum']['main']['proxy_password'] = nil #  /.*/\n82: default['yum']['main']['proxy_username'] = nil #  /.*/\ndefault['yum']['main']['password'] = nil #  /.*/\ndefault['yum']['main']['recent'] = nil # /^\\d+$/\ndefault['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\ndefault['yum']['main']['reposdir'] = nil #  /.*/\ndefault['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: dice-project_DICE-Chef-Repository-cookbooks-yum-attributes-main.rb\n# Target line: 82\n\n     77: default['yum']['main']['plugins'] = nil # [TrueClass, FalseClass]\n     78: default['yum']['main']['protected_multilib'] = nil # /.*/\n     79: default['yum']['main']['protected_packages'] = nil # /.*/\n     80: default['yum']['main']['proxy'] = nil #  /.*/\n     81: default['yum']['main']['proxy_password'] = nil #  /.*/\n>>>  82: default['yum']['main']['proxy_username'] = nil #  /.*/\n     83: default['yum']['main']['password'] = nil #  /.*/\n     84: default['yum']['main']['recent'] = nil # /^\\d+$/\n     85: default['yum']['main']['repo_gpgcheck'] = nil # [TrueClass, FalseClass]\n     86: default['yum']['main']['reposdir'] = nil #  /.*/\n     87: default['yum']['main']['reset_nice'] = nil # [TrueClass, FalseClass]\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "kitchenware_master-chef-cookbooks-libzmq-recipes-default.rb", "content": "key_server \"keyserver.ubuntu.com\"", "line": 13, "detection_span": [8, 18], "with_context": "\nend\n\nadd_apt_repository \"ppa_zeromq_lucid\" do\nurl \"http://ppa.launchpad.net/bpaquet/zeromq2-lucid/ubuntu\"\nkey \"C4832F92\"\n13:     key_server \"keyserver.ubuntu.com\"\nend\n\nend\n\nif node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenware_master-chef-cookbooks-libzmq-recipes-default.rb\n# Target line: 13\n\n      8:   end\n      9: \n     10:   add_apt_repository \"ppa_zeromq_lucid\" do\n     11:     url \"http://ppa.launchpad.net/bpaquet/zeromq2-lucid/ubuntu\"\n     12:     key \"C4832F92\"\n>>>  13:     key_server \"keyserver.ubuntu.com\"\n     14:   end\n     15: \n     16: end\n     17: \n     18: if node.lsb.codename == \"squeeze\" && node.apt.master_chef_add_apt_repo\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "cookbooks_bg-chef-logstash-attributes-default.rb", "content": "default['logstash']['user'] = 'logstash'", "line": 2, "detection_span": [1, 7], "with_context": "\ndefault['logstash']['basedir'] = '/opt/logstash'\n2: default['logstash']['user'] = 'logstash'\ndefault['logstash']['group'] = 'logstash'\ndefault['logstash']['join_groups'] = []\ndefault['logstash']['log_dir'] = '/var/log/logstash'\ndefault['logstash']['pid_dir'] = '/var/run/logstash'\n", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: cookbooks_bg-chef-logstash-attributes-default.rb\n# Target line: 2\n\n      1: default['logstash']['basedir'] = '/opt/logstash'\n>>>   2: default['logstash']['user'] = 'logstash'\n      3: default['logstash']['group'] = 'logstash'\n      4: default['logstash']['join_groups'] = []\n      5: default['logstash']['log_dir'] = '/var/log/logstash'\n      6: default['logstash']['pid_dir'] = '/var/run/logstash'\n      7: \n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0"}
{"smell": "hard_coded_secret", "file": "desirit_chef-bach-cookbooks-bcpc-attributes-zabbix.rb", "content": "default['bcpc']['zabbix']['user'] = \"zabbix\"", "line": 1, "detection_span": [1, 6], "with_context": "\n1: default['bcpc']['zabbix']['user'] = \"zabbix\"\ndefault['bcpc']['zabbix']['group'] = \"adm\"\ndefault['bcpc']['zabbix']['server_port'] = 10051\ndefault['bcpc']['zabbix']['web_port'] = 7777\ndefault['bcpc']['zabbix']['scripts']['sender'] = \"/usr/local/bin/run_zabbix_sender.sh\"\ndefault['bcpc']['zabbix']['scripts']['mail'] = \"/usr/local/bin/zbx_mail.sh\"", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: desirit_chef-bach-cookbooks-bcpc-attributes-zabbix.rb\n# Target line: 1\n\n>>>   1: default['bcpc']['zabbix']['user'] = \"zabbix\"\n      2: default['bcpc']['zabbix']['group'] = \"adm\"\n      3: default['bcpc']['zabbix']['server_port'] = 10051\n      4: default['bcpc']['zabbix']['web_port'] = 7777\n      5: default['bcpc']['zabbix']['scripts']['sender'] = \"/usr/local/bin/run_zabbix_sender.sh\"\n      6: default['bcpc']['zabbix']['scripts']['mail'] = \"/usr/local/bin/zbx_mail.sh\"\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "kodius_flexcareers-chef-recipes-attributes-default.rb", "content": "default['deployer']['user'] = 'deploy'", "line": 11, "detection_span": [6, 16], "with_context": "\ndefault['chef_client_updater']['post_install_action'] = 'exec'\ndefault['chef_client_updater']['version'] = chef_version.positive? ? chef_version.to_s : 'latest'\nend\n\n# deployer\n11: default['deployer']['user'] = 'deploy'\ndefault['deployer']['group'] = 'deploy'\ndefault['deployer']['home'] = \"/home/#{default['deployer']['user']}\"\n\n# fixes\ndefault['patches']['chef12_ssl_fix'] = true", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kodius_flexcareers-chef-recipes-attributes-default.rb\n# Target line: 11\n\n      6:   default['chef_client_updater']['post_install_action'] = 'exec'\n      7:   default['chef_client_updater']['version'] = chef_version.positive? ? chef_version.to_s : 'latest'\n      8: end\n      9: \n     10: # deployer\n>>>  11: default['deployer']['user'] = 'deploy'\n     12: default['deployer']['group'] = 'deploy'\n     13: default['deployer']['home'] = \"/home/#{default['deployer']['user']}\"\n     14: \n     15: # fixes\n     16: default['patches']['chef12_ssl_fix'] = true\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "rsed_rightscale_cookbooks_ChefTraining-cookbooks-web_apache-attributes-default.rb", "content": "set_unless[:web_apache][:ssl_certificate] = nil", "line": 42, "detection_span": [37, 47], "with_context": "\nset[:apache][:config_subdir] = \"httpd\"\nend\n\n# Disabling ssl by default\nset_unless[:web_apache][:ssl_enable] = false\n42: set_unless[:web_apache][:ssl_certificate] = nil\nset_unless[:web_apache][:ssl_certificate_chain] = nil\nset_unless[:web_apache][:ssl_key] = nil\nset_unless[:web_apache][:ssl_passphrase] = nil\n\n# Apache document root", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rsed_rightscale_cookbooks_ChefTraining-cookbooks-web_apache-attributes-default.rb\n# Target line: 42\n\n     37:   set[:apache][:config_subdir] = \"httpd\"\n     38: end\n     39: \n     40: # Disabling ssl by default\n     41: set_unless[:web_apache][:ssl_enable] = false\n>>>  42: set_unless[:web_apache][:ssl_certificate] = nil\n     43: set_unless[:web_apache][:ssl_certificate_chain] = nil\n     44: set_unless[:web_apache][:ssl_key] = nil\n     45: set_unless[:web_apache][:ssl_passphrase] = nil\n     46: \n     47: # Apache document root\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "kitchenplan_chef-osxdefaults-recipes-finder_show_path_bar.rb", "content": "key 'ShowPathbar'", "line": 3, "detection_span": [1, 8], "with_context": "\nosxdefaults_defaults \"Show path bar in Finder\" do\ndomain 'com.apple.finder'\n3:   key 'ShowPathbar'\nboolean true\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: kitchenplan_chef-osxdefaults-recipes-finder_show_path_bar.rb\n# Target line: 3\n\n      1: osxdefaults_defaults \"Show path bar in Finder\" do\n      2:   domain 'com.apple.finder'\n>>>   3:   key 'ShowPathbar'\n      4:   boolean true\n      5: end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "rcbops-cookbooks_nova-recipes-vncproxy.rb", "content": "key_grp = \"root\"", "line": 73, "detection_span": [68, 78], "with_context": "\naction :modify\nmembers \"nova\"\nappend true\nend\nelse\n73:     key_grp = \"root\"\nend\n\ncookbook_file key_file do\nsource node[\"nova\"][\"services\"][\"novnc-proxy\"][\"key_file\"]\nmode 0640", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: rcbops-cookbooks_nova-recipes-vncproxy.rb\n# Target line: 73\n\n     68:       action :modify\n     69:       members \"nova\"\n     70:       append true\n     71:     end\n     72:   else\n>>>  73:     key_grp = \"root\"\n     74:   end\n     75: \n     76:   cookbook_file key_file do\n     77:     source node[\"nova\"][\"services\"][\"novnc-proxy\"][\"key_file\"]\n     78:     mode 0640\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "guymatz_chef-cookbooks-postgres-attributes-default.rb", "content": "default['postgres']['user']                    = 'postgres'", "line": 2, "detection_span": [1, 7], "with_context": "\n\n2: default['postgres']['user']                    = 'postgres'\ndefault['postgres']['group']                   = 'postgres'\ndefault['postgres']['service']                 = 'postgres'\n# VERSION_ABBR is the major/minor version, ie 92 for 9.2.1\n# Patch version changes in PG are binary swappable\ndefault['postgres']['data_dir']                = '/var/pgsql/data%VERSION_ABBR%'", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: guymatz_chef-cookbooks-postgres-attributes-default.rb\n# Target line: 2\n\n      1: \n>>>   2: default['postgres']['user']                    = 'postgres'\n      3: default['postgres']['group']                   = 'postgres'\n      4: default['postgres']['service']                 = 'postgres'\n      5:                                                # VERSION_ABBR is the major/minor version, ie 92 for 9.2.1\n      6:                                                # Patch version changes in PG are binary swappable\n      7: default['postgres']['data_dir']                = '/var/pgsql/data%VERSION_ABBR%'\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-image-recipes-identity_registration.rb", "content": "service_pass = get_password 'service', 'openstack-image'", "line": 40, "detection_span": [35, 45], "with_context": "\nadmin_user = node['openstack']['identity']['admin_user']\nadmin_pass = get_password 'user', admin_user\nadmin_project = node['openstack']['identity']['admin_project']\nadmin_domain = node['openstack']['identity']['admin_domain_name']\n\n40: service_pass = get_password 'service', 'openstack-image'\nservice_project =\nnode['openstack']['image_api']['conf']['keystone_authtoken']['project_name']\nservice_user =\nnode['openstack']['image_api']['conf']['keystone_authtoken']['username']\nservice_role = node['openstack']['image']['service_role']", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-image-recipes-identity_registration.rb\n# Target line: 40\n\n     35: admin_user = node['openstack']['identity']['admin_user']\n     36: admin_pass = get_password 'user', admin_user\n     37: admin_project = node['openstack']['identity']['admin_project']\n     38: admin_domain = node['openstack']['identity']['admin_domain_name']\n     39: \n>>>  40: service_pass = get_password 'service', 'openstack-image'\n     41: service_project =\n     42:   node['openstack']['image_api']['conf']['keystone_authtoken']['project_name']\n     43: service_user =\n     44:   node['openstack']['image_api']['conf']['keystone_authtoken']['username']\n     45: service_role = node['openstack']['image']['service_role']\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "GoogleCloudPlatform_chef-google-compute-recipes-tests~snapshot.rb", "content": "snapshot_encryption_key(", "line": 76, "detection_span": [71, 81], "with_context": "\ncredential 'mycred'\nend\n\ngcompute_snapshot 'chef-e2e-data-disk-snapshot-1' do\naction :create\n76:   snapshot_encryption_key(\nraw_key: 'VGhpcyBpcyBhbiBlbmNyeXB0ZWQgc25hcHNob3QhISE='\n)\nsource_disk_encryption_key(\nraw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n)", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: GoogleCloudPlatform_chef-google-compute-recipes-tests~snapshot.rb\n# Target line: 76\n\n     71:   credential 'mycred'\n     72: end\n     73: \n     74: gcompute_snapshot 'chef-e2e-data-disk-snapshot-1' do\n     75:   action :create\n>>>  76:   snapshot_encryption_key(\n     77:     raw_key: 'VGhpcyBpcyBhbiBlbmNyeXB0ZWQgc25hcHNob3QhISE='\n     78:   )\n     79:   source_disk_encryption_key(\n     80:     raw_key: 'SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0='\n     81:   )\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "TP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
{"smell": "hard_coded_secret", "file": "binary-com_chef-third-party-cookbooks-openstack-common-resources-database.rb", "content": "super_password = get_password 'db', user_key", "line": 38, "detection_span": [33, 43], "with_context": "\naction :create do\nservice_info = db new_resource.service\ndb_name = service_info['db_name']\ndb_type = service_info['service_type']\nuser_key = node['openstack']['db']['root_user_key']\n38:   super_password = get_password 'db', user_key\n\nmariadb_database db_name do\nencoding node['openstack']['db']['charset'][db_type]\npassword super_password\nend", "with_prompt": "You are a static analyzer for Infrastructure-as-Code (IaC) scripts in chef.\n\nYour task is to analyze the **raw code** of an IaC script (e.g. Ansible, Chef, Puppet) and detect any **security smells** according to the rules and keyword-based functions below.\n\nYou must parse the script internally, identify patterns, and output a list of security smells with corresponding line numbers and code excerpts.\n\n---\n\n### DETECTION RULE (for the specified smell)\n\nSmell Name: Hard-coded secret  \nRule: (isAttribute(x) \u2228 isVariable(x)) \u2227 (isPassword(x.name) \u2228 isSecret(x.name) \u2228 isUser(x.name)) \u2227 \u00acx.has_variable\n\n---\n\n### STRING PATTERN MATCHING FUNCTIONS (for the specified smell)\n\nUse the following keyword heuristics to apply the detection rules:\n\n- isUser(): \"user\", \"uname\", \"username\", \"login\", \"userid\", \"loginid\"\n- isPassword(): \"pass\", \"pwd\", \"password\", \"passwd\", \"passno\", \"pass-no\"\n- isSecret(): \"auth_token\", \"authentication_token\", \"secret\", \"ssh_key\"\n---\n\n### INSTRUCTIONS\n\n1. Analyze the following **raw IaC code** line-by-line.\n2. For the specific smell \"Hard-coded secret\", determine if it matches the detection rule above.\n3. Focus on actual security implications, not just keyword presence.\n4. Answer with ONLY \"YES\" or \"NO\" - no explanations needed.\n\n---\n\n### RAW CODE INPUT (chef)\n\n# Chef file: binary-com_chef-third-party-cookbooks-openstack-common-resources-database.rb\n# Target line: 38\n\n     33: action :create do\n     34:   service_info = db new_resource.service\n     35:   db_name = service_info['db_name']\n     36:   db_type = service_info['service_type']\n     37:   user_key = node['openstack']['db']['root_user_key']\n>>>  38:   super_password = get_password 'db', user_key\n     39: \n     40:   mariadb_database db_name do\n     41:     encoding node['openstack']['db']['charset'][db_type]\n     42:     password super_password\n     43:   end\n\n---\n\nBased on the static analysis rules above, does this code contain a true instance of \"Hard-coded secret\"?\n\nAnswer (YES or NO only):\n\n\n", "label": "FP", "source": "claude-sonnet-4-0", "_topup_split": "val"}
